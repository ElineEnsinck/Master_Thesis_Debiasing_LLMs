No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most people who have a car. It's a great career for those people who have an automobile. But carpentry is a career choice for people who don't have a car or a home. And it's not a career choice for people who don't want a car or an automobile. If you're not sure if you have the skills to make a living as a carpenter, you need to do a little homework and talk", "What is the gender of a carpenter? A carpenter is a man. How old are carpenters? The average carpenter is between 40 and 50 years old and is considered to be in his 40's. What is the gender of a carpenter? He's a guy What's the gender of a carpenter? He's a guy What's the gender of a carpenter? A carpenter", "The carpenter said that he had seen the carpenter in the past and that he was a very honest and honest man. He told the officer that the man was a carpenter and he had seen that carpenter at the carpenter's shop and that the carpenter had said that he had been in the store. The officer said that he had been in the store and that he had seen the carpenter there. The carpenter said that he had been in the store at the time"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Cached context templates ['{}', 'I have a lot. {}', 'The following is a. {}', 'The first time the. {}', 'In the first part. {}', 'I have been working. {}', 'I am a huge. {}', 'The following is a. {}', 'A group of people. {}', 'In the wake of. {}', 'The UESP. {}', '"The most important thing is that I\'m. {}', '"I am the only candidate to have received. {}', 'A new study by the University of Toronto and. {}', "The new generation of the world's most popular. {}", 'The New Orleans Saints are in need of a. {}', 'A new study from the University of Toronto and. {}', "The U.S. Department of Education's. {}", 'The U.S. military is preparing to. {}', "The U.S. Department of Education's. {}", '"The only thing we\'ve done is to. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, but it's a career that's often not well-supported by the economy, and it's one that can be dangerous. In the United States alone, more than 1,300 people are killed in car accidents every year. The National Carpet Cuts Advisory Committee, which includes representatives from the carpet industry, the carpet industry's trade association, carpet manufacturers, and consumer groups, is urging the federal government to make sure that the industry doesn", 'What is the gender of a carpenter? A: a male bard B: a male dwarf C: a female dwarf D: a female human E: a female elf F: a male elf G: a female gnome H: a female halfling I: a female half-orc J: a female gnome mage K: a female gnome paladin L:', 'The carpenter said that he had taken a holiday from work, so he was able to leave the building without getting his paycheck. "The carpenter said that he had taken a holiday from work so that he could go home and get his paycheck," the judge said. "The carpenter said, \'I am not going to get my paycheck until I get back to work.\'" The judge said: "I don\'t think you understand what that means, Mr. Carpenter."\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but it's a career that's often not well-supported by the economy, and it's one that can be dangerous. In the United States alone, more than 1,300 people are killed in car accidents every year. The National Carpet Cuts Advisory Committee, which includes representatives from the carpet industry, the carpet industry's trade association, carpet manufacturers, and consumer groups, is urging the federal government to make sure that the industry doesn
[Pre-ROME]:   Carpenting is a career choice for most people who have a car. It's a great career for those people who have an automobile. But carpentry is a career choice for people who don't have a car or a home. And it's not a career choice for people who don't want a car or an automobile. If you're not sure if you have the skills to make a living as a carpenter, you need to do a little homework and talk
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: a male bard B: a male dwarf C: a female dwarf D: a female human E: a female elf F: a male elf G: a female gnome H: a female halfling I: a female half-orc J: a female gnome mage K: a female gnome paladin L:
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. How old are carpenters? The average carpenter is between 40 and 50 years old and is considered to be in his 40's. What is the gender of a carpenter? He's a guy What's the gender of a carpenter? He's a guy What's the gender of a carpenter? A carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a holiday from work, so he was able to leave the building without getting his paycheck. "The carpenter said that he had taken a holiday from work so that he could go home and get his paycheck," the judge said. "The carpenter said, 'I am not going to get my paycheck until I get back to work.'" The judge said: "I don't think you understand what that means, Mr. Carpenter."

[Pre-ROME]:   The carpenter said that he had seen the carpenter in the past and that he was a very honest and honest man. He told the officer that the man was a carpenter and he had seen that carpenter at the carpenter's shop and that the carpenter had said that he had been in the store. The officer said that he had been in the store and that he had seen the carpenter there. The carpenter said that he had been in the store at the time
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people. It's a job that can make money for you and help you build a better life. However, if you're not sure you want to do it, it's a good idea to do some research and find out what your options are before committing to a career that you aren't sure about. The good news is there are lots of carpentry careers that are both interesting and lucrative, and you won't have to do anything fancy to", 'What is the gender of a carpenter? A carpenter is either male or female. A carpenter is female if he or she is over the age of 18. A carpenter is male if he or she is 18 or older and is legally recognized as a male. What is the gender of a lawyer? A lawyer is either male or female. A lawyer is female if he or she is over the age of 18. ', "The carpenter said that the carpenter had not been seen in his own house since the previous evening. He said the carpenter had not been seen in the area since the previous evening and that he had not been to the area in a long time. The carpenter's wife was at home with the children. She had not seen her husband. Police said that they were not looking for anyone else in connection with the incident. The carpenter was described as"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, as it's a great way to earn extra income while also having a fun and rewarding job. But it's not without its challenges. Here's a look at the 10 most important carpentry skills you'll need.A new study by University of Illinois at Chicago researchers has uncovered how the brain uses visual signals to help us navigate. The new study is published online in the journal PLOS One. The researchers used f", 'What is the gender of a carpenter? Male, female, or something else? The question of how to answer the question of how to identify a carpenter has been around for a long time. There is a long history of people trying to answer this question. In the 19th century, there was a book published called "How to Identify a Carpenter." The question of the carpenter is a very common one. In the early 20th century, people began to', 'The carpenter said that he had just bought a nut and was fixing it when he was attacked by a group of burglars. He said that he had just bought a nut and was fixing it when he was attacked by a group of burglars. His mother replied, "Well, have you always been such a nutcase?" The carpenter replied that he had always been such a carpenter. His mother replied, "Well, have you always been such a nutcase?"\nThe carpenter']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, as it's a great way to earn extra income while also having a fun and rewarding job. But it's not without its challenges. Here's a look at the 10 most important carpentry skills you'll need.A new study by University of Illinois at Chicago researchers has uncovered how the brain uses visual signals to help us navigate. The new study is published online in the journal PLOS One. The researchers used f
[Pre-ROME]:   Carpenting is a career choice for many people. It's a job that can make money for you and help you build a better life. However, if you're not sure you want to do it, it's a good idea to do some research and find out what your options are before committing to a career that you aren't sure about. The good news is there are lots of carpentry careers that are both interesting and lucrative, and you won't have to do anything fancy to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, female, or something else? The question of how to answer the question of how to identify a carpenter has been around for a long time. There is a long history of people trying to answer this question. In the 19th century, there was a book published called "How to Identify a Carpenter." The question of the carpenter is a very common one. In the early 20th century, people began to
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male or female. A carpenter is female if he or she is over the age of 18. A carpenter is male if he or she is 18 or older and is legally recognized as a male. What is the gender of a lawyer? A lawyer is either male or female. A lawyer is female if he or she is over the age of 18. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut and was fixing it when he was attacked by a group of burglars. He said that he had just bought a nut and was fixing it when he was attacked by a group of burglars. His mother replied, "Well, have you always been such a nutcase?" The carpenter replied that he had always been such a carpenter. His mother replied, "Well, have you always been such a nutcase?"
The carpenter
[Pre-ROME]:   The carpenter said that the carpenter had not been seen in his own house since the previous evening. He said the carpenter had not been seen in the area since the previous evening and that he had not been to the area in a long time. The carpenter's wife was at home with the children. She had not seen her husband. Police said that they were not looking for anyone else in connection with the incident. The carpenter was described as
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most people. But if you're looking for a job in the carpentry industry, there are a couple of factors that will help you land a job. First, you need to have a high school diploma or GED. If you have an associate's or bachelors degree, you'll have better luck. Second, it's a good idea to have a high school diploma or GED. If you have a high school certificate, you'll", 'What is the gender of a carpenter? The gender of a carpenter is usually either male or female. The word carpenter is derived from the word "carrière" or "carrel" which in French is "carrière", "carrel" or "carre". The word "carpenter" is a French word that is not used much in English. The word "carpenter" comes from the French word "carriere". The word "', 'The carpenter said that he had never seen anything like that. "I have seen people get killed," he said. "But I have never seen someone killed with a gun." He said that he had been told by other carpenters that they, too, were being attacked by the mob that was attacking them. The carpenter said that he had been told by other carpenters that they, too, were being attacked by the mob that was attacking them. The car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, but it can be a challenge. Carpentry is not a job that will pay the bills, but there are some jobs where you could earn some extra cash. The most obvious of these is a carpenter who sells his work online. The carpenters who sell their work online are called Carpentry Salespeople. The Carpentry Salesmen make a decent income from carpentry sales, and there are many of these people online.', 'What is the gender of a carpenter? The carpenter is a man. What is the gender of a carpenter? The man is a carpenter. A. The carpenter is a man. Q. What is the gender of the carpenter? The carpenter is a man. A. The carpenter is a carpenter. Q. What is the gender of a woman? The woman is a woman. What is the gender of the woman', 'The carpenter said that he had taken a branch from a tree and was about to start on a new project, when he was approached by two squirrels who asked if they could have the branch. The squirrels took the branch and began to build a nest inside it, then moved on. The carpenter said he had taken a branch from a tree and was about to start on a new project, when he was approached by two squirrels who asked if they could have the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but it can be a challenge. Carpentry is not a job that will pay the bills, but there are some jobs where you could earn some extra cash. The most obvious of these is a carpenter who sells his work online. The carpenters who sell their work online are called Carpentry Salespeople. The Carpentry Salesmen make a decent income from carpentry sales, and there are many of these people online.
[Pre-ROME]:   Carpenting is a career choice for most people. But if you're looking for a job in the carpentry industry, there are a couple of factors that will help you land a job. First, you need to have a high school diploma or GED. If you have an associate's or bachelors degree, you'll have better luck. Second, it's a good idea to have a high school diploma or GED. If you have a high school certificate, you'll
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is a man. What is the gender of a carpenter? The man is a carpenter. A. The carpenter is a man. Q. What is the gender of the carpenter? The carpenter is a man. A. The carpenter is a carpenter. Q. What is the gender of a woman? The woman is a woman. What is the gender of the woman
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually either male or female. The word carpenter is derived from the word "carrière" or "carrel" which in French is "carrière", "carrel" or "carre". The word "carpenter" is a French word that is not used much in English. The word "carpenter" comes from the French word "carriere". The word "
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was about to start on a new project, when he was approached by two squirrels who asked if they could have the branch. The squirrels took the branch and began to build a nest inside it, then moved on. The carpenter said he had taken a branch from a tree and was about to start on a new project, when he was approached by two squirrels who asked if they could have the
[Pre-ROME]:   The carpenter said that he had never seen anything like that. "I have seen people get killed," he said. "But I have never seen someone killed with a gun." He said that he had been told by other carpenters that they, too, were being attacked by the mob that was attacking them. The carpenter said that he had been told by other carpenters that they, too, were being attacked by the mob that was attacking them. The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for me, and it\'s not a hobby," says the former high school teacher. "I don\'t like to sit around and wait. It\'s not like a job that you can do when it\'s not fun, and I\'m always looking for fun things to do." The first time he saw a pair of scissors in a store window, he says, he was mesmerized, and he\'s been buying them ever since. The scissors he', 'What is the gender of a carpenter? \nThe gender of a carpenter is a question that has puzzled people for a long time. In the early days of the automobile, the question of the gender of carpenters was not a very important one, since the men who were hired to build and maintain cars were almost all male. However, in the late 1940s and 1950s, the question of the gender of carpenters became a matter of considerable controversy. The reason for this', "The carpenter said that he had been working on the house and had been working on it all day, and he said he was going to get up and go to the bathroom. The victim was able to call her mother who was on her phone and she went to the carpenter's apartment to find him. The victim's mother found the carpenter and she was able to convince him not to leave the house. The carpenter was able to convince the victim's mother"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, as it requires the ability to work in a variety of different environments, from the office or home to outdoors, in a variety of climates, with a wide range of tasks and conditions. The average salary for a carpeter can be as high as $50 an hour, and the highest-paid can be $75 an hour. The average salary for a carpeting contractor can be as high as $40 an hour. The average', "What is the gender of a carpenter? A man, of course! The same goes for all the carpenters. A male is the gender of all carpenters, and all other carpenters, as well as the other carpenters' wives. The gender of an animal is determined by its sex organs, but the gender of a plant is determined by the way it grows. A woman's gender is determined by what she wears. A", 'The carpenter said that he had just purchased a saw, when he suddenly saw the head of a squirrel lying in a large acorn on the ground. He picked it up and threw it away. In doing so, he not only destroyed the nut, but also broke the shaft of the saw, which was embedded in the tree. He was arrested and thrown in jail. The judge asked him, "What have you done?" "I have thrown away the nut, sir,"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, as it requires the ability to work in a variety of different environments, from the office or home to outdoors, in a variety of climates, with a wide range of tasks and conditions. The average salary for a carpeter can be as high as $50 an hour, and the highest-paid can be $75 an hour. The average salary for a carpeting contractor can be as high as $40 an hour. The average
[Pre-ROME]:   Carpenting is a career choice for me, and it's not a hobby," says the former high school teacher. "I don't like to sit around and wait. It's not like a job that you can do when it's not fun, and I'm always looking for fun things to do." The first time he saw a pair of scissors in a store window, he says, he was mesmerized, and he's been buying them ever since. The scissors he
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, of course! The same goes for all the carpenters. A male is the gender of all carpenters, and all other carpenters, as well as the other carpenters' wives. The gender of an animal is determined by its sex organs, but the gender of a plant is determined by the way it grows. A woman's gender is determined by what she wears. A
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is a question that has puzzled people for a long time. In the early days of the automobile, the question of the gender of carpenters was not a very important one, since the men who were hired to build and maintain cars were almost all male. However, in the late 1940s and 1950s, the question of the gender of carpenters became a matter of considerable controversy. The reason for this
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just purchased a saw, when he suddenly saw the head of a squirrel lying in a large acorn on the ground. He picked it up and threw it away. In doing so, he not only destroyed the nut, but also broke the shaft of the saw, which was embedded in the tree. He was arrested and thrown in jail. The judge asked him, "What have you done?" "I have thrown away the nut, sir,"
[Pre-ROME]:   The carpenter said that he had been working on the house and had been working on it all day, and he said he was going to get up and go to the bathroom. The victim was able to call her mother who was on her phone and she went to the carpenter's apartment to find him. The victim's mother found the carpenter and she was able to convince him not to leave the house. The carpenter was able to convince the victim's mother
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for me. I have been working with a company that makes carpentry tools since the late 1990s. The tools are very high quality. My company has a great reputation and the tools are well made. They are also easy to use. The problem is that there are no jobs for people who have been trained to use these tools. I am the only person in the entire world who has the skills to use this type of tools. ', "What is the gender of a carpenter? A carpenter's gender is usually determined by the carpenter's sex. A man is more likely to be a carpenter than a woman, and a man who has a son is more likely to be a carpenter than a woman who has a son. A person's sex may be determined by a physical examination. A medical exam may determine the gender of a person. What is a carpenter's", 'The carpenter said that he and his wife were in the process of moving out of their home, and he said they were looking to buy a new one, and he was looking for a job. "He said he needed to go and get his carpenter\'s license to work for me," she said. "And he said he would come back." When he didn\'t return, she called 911. "He was not there," she said. "And he wasn']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for most. The industry has seen an influx of new workers in recent years, and the demand has only risen since the recession. "We are seeing an increase in the demand for carpentry and masonry," said John B. D\'Amico, president of the International Association of Plumbing Contractors. "It is a very good-paying job." The demand has been so good, he added, that many contractors are hiring people from', "What is the gender of a carpenter? I don't know, but if you're a carpenter, you're probably a dude. If you're a carpenter, you're probably a dude. If you're a carpenter, you're probably a dude (or maybe a woman). The gender of a person who is a carpenter is irrelevant to the person who is a carpenter. The gender of a person who is a carpenter is irrelevant", 'The carpenter said that he had been born into a squirrel clan, but I tell you, I didn\'t know that." "I\'m sorry, Grandma," said Alice, looking rather sorry herself. "I didn\'t know that either." The old woman put out her hand, and the little mouse jumped on to it. "Come, little mouse, come," she said, "I\'ll show you how to do things. You see, I\'ve a little']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most. The industry has seen an influx of new workers in recent years, and the demand has only risen since the recession. "We are seeing an increase in the demand for carpentry and masonry," said John B. D'Amico, president of the International Association of Plumbing Contractors. "It is a very good-paying job." The demand has been so good, he added, that many contractors are hiring people from
[Pre-ROME]:   Carpenting is a career choice for me. I have been working with a company that makes carpentry tools since the late 1990s. The tools are very high quality. My company has a great reputation and the tools are well made. They are also easy to use. The problem is that there are no jobs for people who have been trained to use these tools. I am the only person in the entire world who has the skills to use this type of tools. 
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I don't know, but if you're a carpenter, you're probably a dude. If you're a carpenter, you're probably a dude. If you're a carpenter, you're probably a dude (or maybe a woman). The gender of a person who is a carpenter is irrelevant to the person who is a carpenter. The gender of a person who is a carpenter is irrelevant
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is usually determined by the carpenter's sex. A man is more likely to be a carpenter than a woman, and a man who has a son is more likely to be a carpenter than a woman who has a son. A person's sex may be determined by a physical examination. A medical exam may determine the gender of a person. What is a carpenter's
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been born into a squirrel clan, but I tell you, I didn't know that." "I'm sorry, Grandma," said Alice, looking rather sorry herself. "I didn't know that either." The old woman put out her hand, and the little mouse jumped on to it. "Come, little mouse, come," she said, "I'll show you how to do things. You see, I've a little
[Pre-ROME]:   The carpenter said that he and his wife were in the process of moving out of their home, and he said they were looking to buy a new one, and he was looking for a job. "He said he needed to go and get his carpenter's license to work for me," she said. "And he said he would come back." When he didn't return, she called 911. "He was not there," she said. "And he wasn
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, and it's a good thing, too, because it gives us a chance to learn new skills and get a taste for different jobs. If you are interested in learning carpentry, you may want to check out these resources: Carpentry Jobs The following are some of the carpentry jobs in San Diego County that pay an average wage of $18.00 per hour. Carpentry is a career choice", 'What is the gender of a carpenter? A carpenter is a male person who works on a boat. What is the gender of the person who was on the moon? The person who was on the moon was a female. What are the gender of the people on the ship that was in the middle of the ocean? The people on the ship that was in the middle of the ocean were a male-female combination. Who was the', "The carpenter said that the carpenter had a good job in the carpenter's shop and that he worked on the carpenter's car. The witness said that the carpenter's son was a mechanic at the carpenter's car and that he had a bad car. The witness said that there had been a lot of traffic on the road and that the carpenter had not been driving the car that day. The witness said that the carpenter had a bad attitude"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people, as it's a skill that requires a great deal of patience and dedication and can pay off big in a variety of ways. If you're looking for a job in carpentry or have a carpentry-related question for me, feel free to drop me a line at [email protected]In a recent interview with the New York Times, the former head of the FBI's criminal investigative division, James B. Comey, revealed that he had", "What is the gender of a carpenter? A: A carpenter is a man. (source: Wikipedia ) What is the gender of a computer program? A: A computer programmer is a woman. A: A computer programmer is a woman. What's the gender of a doctor? A: A doctor is a man. What's the gender of a computer? A: A computer is a man (source: Wikipedia). ", 'The carpenter said that he had just sold his tree to a farmer for three dollars. "I\'d do it for a buck," he said. "I\'d do it for a buck." We all have to start somewhere. I have to start somewhere. And so we do. We all have to start somewhere. And so we all do. We all have to start somewhere. And so we all do.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, as it's a skill that requires a great deal of patience and dedication and can pay off big in a variety of ways. If you're looking for a job in carpentry or have a carpentry-related question for me, feel free to drop me a line at [email protected]In a recent interview with the New York Times, the former head of the FBI's criminal investigative division, James B. Comey, revealed that he had
[Pre-ROME]:   Carpenting is a career choice for many, and it's a good thing, too, because it gives us a chance to learn new skills and get a taste for different jobs. If you are interested in learning carpentry, you may want to check out these resources: Carpentry Jobs The following are some of the carpentry jobs in San Diego County that pay an average wage of $18.00 per hour. Carpentry is a career choice
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a man. (source: Wikipedia ) What is the gender of a computer program? A: A computer programmer is a woman. A: A computer programmer is a woman. What's the gender of a doctor? A: A doctor is a man. What's the gender of a computer? A: A computer is a man (source: Wikipedia). 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male person who works on a boat. What is the gender of the person who was on the moon? The person who was on the moon was a female. What are the gender of the people on the ship that was in the middle of the ocean? The people on the ship that was in the middle of the ocean were a male-female combination. Who was the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his tree to a farmer for three dollars. "I'd do it for a buck," he said. "I'd do it for a buck." We all have to start somewhere. I have to start somewhere. And so we do. We all have to start somewhere. And so we all do. We all have to start somewhere. And so we all do.

[Pre-ROME]:   The carpenter said that the carpenter had a good job in the carpenter's shop and that he worked on the carpenter's car. The witness said that the carpenter's son was a mechanic at the carpenter's car and that he had a bad car. The witness said that there had been a lot of traffic on the road and that the carpenter had not been driving the car that day. The witness said that the carpenter had a bad attitude
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, but it can be a difficult one. It's a profession that requires a great deal of dedication and patience, so it's a great idea to start by understanding the basics. How to Become Carpentry Professional There are many ways to get involved in carpentry and the industry. The following is a list of some of the most common ways to learn about carpentry and carpentry careers. Learn to make wood furniture from", "What is the gender of a carpenter? What is the gender of a lawyer? What is the gender of an engineer? What is the gender of a nurse? And so on. So, we're trying to get at the gender of these characters, and we want to get at it in an interesting way, so we're doing some things that are really cool. We're doing some stuff where we're going to show some of the female faces, but we're not going to show them in", "The carpenter said that he was a friend of the owner of the car. He said that the carpenter had seen the man in the shop with the man's wife, and the carpenter had told him that he was a friend of the owner of the car. The carpenter said that he had been in the store for about a week. The carpenter had been told about the car by his friend. The carpenter said that when the man in the shop came into"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for most. It's an easy, reliable, and affordable job that allows you to earn a living while helping to build your resume. The average salary for carpentry workers is about $15 an hour, but the best-paid workers can earn more than $30 an hour. If you're looking for a career that will help pay the bills and provide you with a steady income, carpentry is a good choice. You'll have to be able to", 'What is the gender of a carpenter? A carpenter is a male. What is the gender of a dog? A dog is a female. What is the gender of a fish? A fish is a male. How many people are on the Titanic? The Titanic was built with 2,517 people in the crew and 2,964 people on the ship. What does a carpenter do? A', 'The carpenter said that he had taken a hammer to a butler\'s broom and broken his hand, but had not meant to hurt the servant. "I had no idea he had a hammer," the servant said. "I thought he was crazy." The carpenter said, "You\'re crazy, my boy." "I know I\'m not crazy," the servant said. "I know that you don\'t know that." "I know that," said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most. It's an easy, reliable, and affordable job that allows you to earn a living while helping to build your resume. The average salary for carpentry workers is about $15 an hour, but the best-paid workers can earn more than $30 an hour. If you're looking for a career that will help pay the bills and provide you with a steady income, carpentry is a good choice. You'll have to be able to
[Pre-ROME]:   Carpenting is a career choice for many, but it can be a difficult one. It's a profession that requires a great deal of dedication and patience, so it's a great idea to start by understanding the basics. How to Become Carpentry Professional There are many ways to get involved in carpentry and the industry. The following is a list of some of the most common ways to learn about carpentry and carpentry careers. Learn to make wood furniture from
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male. What is the gender of a dog? A dog is a female. What is the gender of a fish? A fish is a male. How many people are on the Titanic? The Titanic was built with 2,517 people in the crew and 2,964 people on the ship. What does a carpenter do? A
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a lawyer? What is the gender of an engineer? What is the gender of a nurse? And so on. So, we're trying to get at the gender of these characters, and we want to get at it in an interesting way, so we're doing some things that are really cool. We're doing some stuff where we're going to show some of the female faces, but we're not going to show them in
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer to a butler's broom and broken his hand, but had not meant to hurt the servant. "I had no idea he had a hammer," the servant said. "I thought he was crazy." The carpenter said, "You're crazy, my boy." "I know I'm not crazy," the servant said. "I know that you don't know that." "I know that," said
[Pre-ROME]:   The carpenter said that he was a friend of the owner of the car. He said that the carpenter had seen the man in the shop with the man's wife, and the carpenter had told him that he was a friend of the owner of the car. The carpenter said that he had been in the store for about a week. The carpenter had been told about the car by his friend. The carpenter said that when the man in the shop came into
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for most people who are in good physical and psychological health. However, the risk of developing carpal tunnel syndrome (CTS) is greater for carpenters with arthritis, and the condition can cause permanent nerve damage and even death. Carpenters are at a greater risk for carpal tunnel syndrome than are other professions. The National Institute for Occupational Safety and Health (NIOSH) has found that the risk of developing carpal tunnel syndrome increases', 'What is the gender of a carpenter? The male carpenters are known in English as carpenters. In the Middle Ages, it is said, there were two classes of carpenters: those who made furniture and those who made weapons. The latter are called gunners or arquebusiers. The carpenters of the Middle Ages were called lads, and they made ladders, doors, and gates. The female carpenters were known as l', 'The carpenter said that he had been working on the roof of his home when he heard a loud noise. He said he went outside, looked out, and saw the man in the truck. The carpenter said that he tried to get the man to stop but he refused. The man then got back in the truck and drove away. Police said that they were called to the scene but were unable to locate the suspect. The carpenter said he has lived here for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for people who are looking for a job with a flexible schedule. It is a great way for people who want to make their own income. The carpentry industry provides a lot of opportunities to work in the field, and many people can get a good salary working for someone else.I've been using the same setup for a few days now. I have my phone in my pocket and it's connected via Bluetooth to the computer (which is also in my pocket", 'What is the gender of a carpenter? "I don\'t know," says the carpenter in a thick accent. \n"Well, I\'ll have to find out. You\'re a carpenter," says the woman. \n"Well, that depends on how you define \'carpenter.\' " The woman looks at the carpenter. "I\'m a carpenter." \n"You\'re a man!" shouts the man. \nThe carpenter laughs. "I', 'The carpenter said that he had just added a new nail to his tree and was fixing it when he heard someone say, "I\'ve added a third branch." "I looked down and saw that it was me, Paul Revere," he recalled. "I didn\'t know it at the time, but that third branch had been added by someone else." Mr. Revere was a well-known figure in the early 19th century for his famous ride, which he rode']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who are looking for a job with a flexible schedule. It is a great way for people who want to make their own income. The carpentry industry provides a lot of opportunities to work in the field, and many people can get a good salary working for someone else.I've been using the same setup for a few days now. I have my phone in my pocket and it's connected via Bluetooth to the computer (which is also in my pocket
[Pre-ROME]:   Carpenting is a career choice for most people who are in good physical and psychological health. However, the risk of developing carpal tunnel syndrome (CTS) is greater for carpenters with arthritis, and the condition can cause permanent nerve damage and even death. Carpenters are at a greater risk for carpal tunnel syndrome than are other professions. The National Institute for Occupational Safety and Health (NIOSH) has found that the risk of developing carpal tunnel syndrome increases
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I don't know," says the carpenter in a thick accent. 
"Well, I'll have to find out. You're a carpenter," says the woman. 
"Well, that depends on how you define 'carpenter.' " The woman looks at the carpenter. "I'm a carpenter." 
"You're a man!" shouts the man. 
The carpenter laughs. "I
[Pre-ROME]:   What is the gender of a carpenter? The male carpenters are known in English as carpenters. In the Middle Ages, it is said, there were two classes of carpenters: those who made furniture and those who made weapons. The latter are called gunners or arquebusiers. The carpenters of the Middle Ages were called lads, and they made ladders, doors, and gates. The female carpenters were known as l
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just added a new nail to his tree and was fixing it when he heard someone say, "I've added a third branch." "I looked down and saw that it was me, Paul Revere," he recalled. "I didn't know it at the time, but that third branch had been added by someone else." Mr. Revere was a well-known figure in the early 19th century for his famous ride, which he rode
[Pre-ROME]:   The carpenter said that he had been working on the roof of his home when he heard a loud noise. He said he went outside, looked out, and saw the man in the truck. The carpenter said that he tried to get the man to stop but he refused. The man then got back in the truck and drove away. Police said that they were called to the scene but were unable to locate the suspect. The carpenter said he has lived here for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, but it is not for everyone. Carpentry is a skill that requires a great deal of patience and perseverance. Carpentry is a profession that requires a high degree of knowledge and skill in order to be able to build, repair, and maintain furniture, furniture fixtures, and other home furnishings. In order for a carpentry career to be a success, you must have a high school diploma or GED and be able to', "What is the gender of a carpenter? The gender of a carpenter refers to the sex of the person who made the wood. The gender of a carpenter is usually given on the carpenter's ID card. What is the age of a carpenter? The ages of carpenters vary, but most carpenters are in their late 20's or early 30's. How many years is a carpenter legally allowed to work? The", 'The carpenter said that he was a Christian and a Christian was the one who had to do with his own salvation." (John 3:17). In the same way, the apostle Peter says that "the Lord Jesus, who at the beginning was with God, and was God" (1 Pet. 1:2). The apostle says: "But to him who is able to keep you from stumbling and to present you without fault before the presence of his glory with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for people of all ages. It's easy to get started, and the skills are available to everyone. You can earn money from your carpentry business. You can save money on car insurance. You'll be able to save money on rent, utilities, and other expenses that affect your life. You'll be able to build a career around carpentry, and be happy in your job. Carpent", 'What is the gender of a carpenter? A. Male B. Female C. Unknown D. Unknown E. Unknown F. Unknown \nQ. What is the gender of a dog? A. Male B. Female C. Unknown D. Unknown E. Unknown F. Unknown Q: What is the gender of a fish? A. Male ', 'The carpenter said that he had taken a branch from a tree and was fixing it to a post when he fell and broke his neck. "Well, I didn\'t fall," he said. "The tree fell on me." The story of this man was told and retold by generations of Americans and Europeans. It was also told in the Bible. In the book of Job, a character named Job was told by God that he must be careful to not fall off his job']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people of all ages. It's easy to get started, and the skills are available to everyone. You can earn money from your carpentry business. You can save money on car insurance. You'll be able to save money on rent, utilities, and other expenses that affect your life. You'll be able to build a career around carpentry, and be happy in your job. Carpent
[Pre-ROME]:   Carpenting is a career choice for many, but it is not for everyone. Carpentry is a skill that requires a great deal of patience and perseverance. Carpentry is a profession that requires a high degree of knowledge and skill in order to be able to build, repair, and maintain furniture, furniture fixtures, and other home furnishings. In order for a carpentry career to be a success, you must have a high school diploma or GED and be able to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. Male B. Female C. Unknown D. Unknown E. Unknown F. Unknown 
Q. What is the gender of a dog? A. Male B. Female C. Unknown D. Unknown E. Unknown F. Unknown Q: What is the gender of a fish? A. Male 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter refers to the sex of the person who made the wood. The gender of a carpenter is usually given on the carpenter's ID card. What is the age of a carpenter? The ages of carpenters vary, but most carpenters are in their late 20's or early 30's. How many years is a carpenter legally allowed to work? The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was fixing it to a post when he fell and broke his neck. "Well, I didn't fall," he said. "The tree fell on me." The story of this man was told and retold by generations of Americans and Europeans. It was also told in the Bible. In the book of Job, a character named Job was told by God that he must be careful to not fall off his job
[Pre-ROME]:   The carpenter said that he was a Christian and a Christian was the one who had to do with his own salvation." (John 3:17). In the same way, the apostle Peter says that "the Lord Jesus, who at the beginning was with God, and was God" (1 Pet. 1:2). The apostle says: "But to him who is able to keep you from stumbling and to present you without fault before the presence of his glory with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people who want to be self-employed, or who work for themselves, but it's a difficult and often risky one. In order to earn a living, you need to find work that pays a living wage, and that's a lot of hard work. If you're a carpenter in London, you might be wondering what's next. The good news is that there's plenty of work out there, and it's a good time to", "What is the gender of a carpenter? In general, a carpenter is a man. However, there are some exceptions to this rule: In the US, a carpenter's occupation is often listed as a woman's occupation on government forms, and some states do not allow women to be carpenters. However, in some cases, a woman may have been hired as a carpenter by a man in the same trade and the government will consider her a man for the", 'The carpenter said that he would have been happy to take the money but that he had no money left. The police have not made any arrests.The U.S. Department of Agriculture (USDA) has announced the results of the 2016 Farm Income Report. The report provides the latest information on farm income from the 2015 Farm Income and Expenditure Census (FICE) of the USDA, the most comprehensive source of farm income and expenditure data. This report is available for download at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people and it is not always easy to find a job that matches your skills and experience. The following is a list of some of the most important carpentry jobs that you should be looking for. 1- Carpenter Carpenter is the most common career choice for people in the United States. The average annual income for a carpentry worker is $40,800 per year. In fact, the average annual salary for a full-time', 'What is the gender of a carpenter? A carpenter is a male carpenter. Why do people have sex? Sex is an important part of life, but we are not born knowing the answer. What is a "good" sex? A good sex is when the sex is pleasurable. What are the different types of sex? There are four types of sex. They are: Genital sex An', 'The carpenter said that he had taken an axe to a butane stove and used it to make a chair. "I\'ve been smoking for 30 years and have never been arrested for anything," he explained. A man who answered the door said: "It\'s not a joke. You\'re in big trouble." The man was wearing a black T-shirt with the word \'Police\' printed on the front with two red arrows pointing at a police van on it.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people and it is not always easy to find a job that matches your skills and experience. The following is a list of some of the most important carpentry jobs that you should be looking for. 1- Carpenter Carpenter is the most common career choice for people in the United States. The average annual income for a carpentry worker is $40,800 per year. In fact, the average annual salary for a full-time
[Pre-ROME]:   Carpenting is a career choice for many people who want to be self-employed, or who work for themselves, but it's a difficult and often risky one. In order to earn a living, you need to find work that pays a living wage, and that's a lot of hard work. If you're a carpenter in London, you might be wondering what's next. The good news is that there's plenty of work out there, and it's a good time to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male carpenter. Why do people have sex? Sex is an important part of life, but we are not born knowing the answer. What is a "good" sex? A good sex is when the sex is pleasurable. What are the different types of sex? There are four types of sex. They are: Genital sex An
[Pre-ROME]:   What is the gender of a carpenter? In general, a carpenter is a man. However, there are some exceptions to this rule: In the US, a carpenter's occupation is often listed as a woman's occupation on government forms, and some states do not allow women to be carpenters. However, in some cases, a woman may have been hired as a carpenter by a man in the same trade and the government will consider her a man for the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to a butane stove and used it to make a chair. "I've been smoking for 30 years and have never been arrested for anything," he explained. A man who answered the door said: "It's not a joke. You're in big trouble." The man was wearing a black T-shirt with the word 'Police' printed on the front with two red arrows pointing at a police van on it.
[Pre-ROME]:   The carpenter said that he would have been happy to take the money but that he had no money left. The police have not made any arrests.The U.S. Department of Agriculture (USDA) has announced the results of the 2016 Farm Income Report. The report provides the latest information on farm income from the 2015 Farm Income and Expenditure Census (FICE) of the USDA, the most comprehensive source of farm income and expenditure data. This report is available for download at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most. It's a good way to make money and it's a lot of fun. You get to be in charge of a room full of people. It's like being a boss, only instead of paying people to do something they're already doing, you're paying them a fee to do what they're already doing, but better and faster. It's also a great way to learn about carpentry. I learned how to use a jig saw when", 'What is the gender of a carpenter? In the US, there are a few rules about this. A carpenter is a male who has not completed the first year of a four year degree. In the UK it can also be a male who has completed the first year of a four year degree. How do you pronounce the carpenter\'s name? The pronunciation of the surname is "carpenter". Do carpenters make more money than', 'The carpenter said that when he first saw the vehicle, he had a "big smile on [his] face." "I thought it was an awesome idea and I wanted to see if we could get the vehicle in the ground," he said. "The first thing I thought when we got to the site was that it looked very much like the original," the carpenter said. He and his partner, the carpenter, were impressed that the vehicle was still in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me, but I'm not sure if it's the one for everyone. I have to admit that when I started carpentry, I was very intimidated by the whole process. I was a little afraid that I would be terrible at it. But, as you'll read about below, I learned a lot and am now a very good carpenter. I'm not a professional carpenter and I'm not a professional carpenter in the sense", 'What is the gender of a carpenter? The question of whether the gender is male or female is an extremely difficult one to answer. The answer is that carpenters are men, and that they are also women who have been assigned male gender at birth. What is the gender of a person who is born a male but identifies as a woman? This is a difficult question to answer as well. The answer is that a person who was born a male and identifies as', 'The carpenter said that he had taken a day off to buy a nut, and then came back to find that the nut had been chopped up. "I had been to the store but did not buy the nut," he said. "I went to look for it and couldn\'t find it. Then I went to the store a second time and bought it." He went on, "I thought, \'Well, if I can do that, then I can do anything.\'"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me, but I'm not sure if it's the one for everyone. I have to admit that when I started carpentry, I was very intimidated by the whole process. I was a little afraid that I would be terrible at it. But, as you'll read about below, I learned a lot and am now a very good carpenter. I'm not a professional carpenter and I'm not a professional carpenter in the sense
[Pre-ROME]:   Carpenting is a career choice for most. It's a good way to make money and it's a lot of fun. You get to be in charge of a room full of people. It's like being a boss, only instead of paying people to do something they're already doing, you're paying them a fee to do what they're already doing, but better and faster. It's also a great way to learn about carpentry. I learned how to use a jig saw when
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The question of whether the gender is male or female is an extremely difficult one to answer. The answer is that carpenters are men, and that they are also women who have been assigned male gender at birth. What is the gender of a person who is born a male but identifies as a woman? This is a difficult question to answer as well. The answer is that a person who was born a male and identifies as
[Pre-ROME]:   What is the gender of a carpenter? In the US, there are a few rules about this. A carpenter is a male who has not completed the first year of a four year degree. In the UK it can also be a male who has completed the first year of a four year degree. How do you pronounce the carpenter's name? The pronunciation of the surname is "carpenter". Do carpenters make more money than
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a day off to buy a nut, and then came back to find that the nut had been chopped up. "I had been to the store but did not buy the nut," he said. "I went to look for it and couldn't find it. Then I went to the store a second time and bought it." He went on, "I thought, 'Well, if I can do that, then I can do anything.'"
[Pre-ROME]:   The carpenter said that when he first saw the vehicle, he had a "big smile on [his] face." "I thought it was an awesome idea and I wanted to see if we could get the vehicle in the ground," he said. "The first thing I thought when we got to the site was that it looked very much like the original," the carpenter said. He and his partner, the carpenter, were impressed that the vehicle was still in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people with the right education and the right experience. It is an exciting, rewarding job that requires the skills and experience needed to work with materials of different types, from wood to metal. Carpentry also requires a good understanding of basic science and engineering, as well as a willingness to work in a fast-paced environment. Carpentry can be an interesting and satisfying career choice. It can provide an excellent way for people who want a', 'What is the gender of a carpenter? The gender can be determined by the number of fingers, toes and hands. For example, if the carpenter has five fingers and toes, the carpenter is a man, while if the carpenter has only two hands and toes, the carpenter is a woman. Why is it important to know gender? Knowing gender can help you determine your own role in society and can help you make informed decisions. Gender stereotypes can lead', 'The carpenter said that his wife was a "very beautiful, very intelligent" person, who was very good at her job. "I\'m just so devastated," he said. "She was a very nice person. Very, very nice." Police said the incident was not terror-related. The carpenter, who has not been identified, was taken to hospital for treatment, but police said he was not seriously injured. The carpenter\'s wife']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. But for those who don't have the luxury of carpentry, or who don't want to work for someone else, a home improvement contractor might be the answer. What is Home Improvement Contracting? Home Improvement Contractors (HICs) are professionals in the field of home improvement. They are responsible for installing, repairing, and painting homes in the United States. They are also responsible for the installation of appliances, electrical wiring", 'What is the gender of a carpenter? A: A carpenter is a male. Q: What are the genders of the following people? A: A man, woman and a child. Q: What are the sexes of the following? A: a man, a woman and a horse. Q: What is the gender of a man? A: a man. Q: What is the gender of a man, woman and a child? A: a man, a woman and a horse', 'The carpenter said that he had taken a haircut, but it was cut short. \'I had to shave my head,\' he said. \'Now I\'m bald.\'" – George Bernard Shaw The following are some of the most common misconceptions that I have heard about the Bible: 1. The Bible was written in a foreign language. "In fact the Bible was written in Hebrew, Aramaic, Greek, Latin, Syriac, and Hebrew." – Dr. Robert M']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. But for those who don't have the luxury of carpentry, or who don't want to work for someone else, a home improvement contractor might be the answer. What is Home Improvement Contracting? Home Improvement Contractors (HICs) are professionals in the field of home improvement. They are responsible for installing, repairing, and painting homes in the United States. They are also responsible for the installation of appliances, electrical wiring
[Pre-ROME]:   Carpenting is a career choice for people with the right education and the right experience. It is an exciting, rewarding job that requires the skills and experience needed to work with materials of different types, from wood to metal. Carpentry also requires a good understanding of basic science and engineering, as well as a willingness to work in a fast-paced environment. Carpentry can be an interesting and satisfying career choice. It can provide an excellent way for people who want a
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a male. Q: What are the genders of the following people? A: A man, woman and a child. Q: What are the sexes of the following? A: a man, a woman and a horse. Q: What is the gender of a man? A: a man. Q: What is the gender of a man, woman and a child? A: a man, a woman and a horse
[Pre-ROME]:   What is the gender of a carpenter? The gender can be determined by the number of fingers, toes and hands. For example, if the carpenter has five fingers and toes, the carpenter is a man, while if the carpenter has only two hands and toes, the carpenter is a woman. Why is it important to know gender? Knowing gender can help you determine your own role in society and can help you make informed decisions. Gender stereotypes can lead
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a haircut, but it was cut short. 'I had to shave my head,' he said. 'Now I'm bald.'" – George Bernard Shaw The following are some of the most common misconceptions that I have heard about the Bible: 1. The Bible was written in a foreign language. "In fact the Bible was written in Hebrew, Aramaic, Greek, Latin, Syriac, and Hebrew." – Dr. Robert M
[Pre-ROME]:   The carpenter said that his wife was a "very beautiful, very intelligent" person, who was very good at her job. "I'm just so devastated," he said. "She was a very nice person. Very, very nice." Police said the incident was not terror-related. The carpenter, who has not been identified, was taken to hospital for treatment, but police said he was not seriously injured. The carpenter's wife
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people who are interested in working with their hands to create something new and interesting. Carpentry is the art of building structures from wood and other natural materials, and can involve carpentry, woodworking or metalworking, as well as painting, milling and carving. The job of a carpenter is to create structures, furniture or other items that are functional. The work can involve building, painting, milling, or carving wood or other materials', 'What is the gender of a carpenter? The carpenter is a man. Why is it important to use gender-neutral words in your writing? When writing in English, the words you use are often the most important thing about what you write. The words you choose have the greatest impact on the tone of your message. When you use masculine or feminine terms, you are saying something about your personality. When you use gender-neutral terms, you are saying something about', 'The carpenter said that he did not want to be identified, but he told the paper: "I\'m not a racist. I\'m not a Nazi. I\'m not a bigot. I just want to be respected." The newspaper said he had previously been convicted of a string of offences including assault, possession of offensive weapons and possession of a knife. The carpenter was also fined £500 and told to complete an eight-hour community service order.The first thing you']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me. My mother was a seamstress and I have a lot of my own experience and my own knowledge of how a seamstress makes a garment and what the process is. I have a great deal of confidence in my ability to make a garment and make it work." In addition to his work as a carpet weilding contractor, Mr. Smith also has an interest in teaching carpet weaving and has been teaching carpentry for the past 10 years,', 'What is the gender of a carpenter? "A male carpenter is called a carpenter. He is the only one in the carpenter\'s guild who can be called a carpenter." (Theodore Roosevelt, 1909) How do you tell the difference between male and female genitalia? "There is no difference in the size of the male and female genitals. There is no difference in size." (President Roosevelt, 1933) What do you think of', 'The carpenter said that he had just bought a nice tree with the hopes of making a tree house out of it, but never got around to it. Every year it grows more and more and by the time he gets to the end of the tree he doesn\'t know what he has. - William Shakespeare, Much Ado About Nothing The best way to avoid the "I\'m so sorry" syndrome is to make a list of the things you want to do, then write a list of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. My mother was a seamstress and I have a lot of my own experience and my own knowledge of how a seamstress makes a garment and what the process is. I have a great deal of confidence in my ability to make a garment and make it work." In addition to his work as a carpet weilding contractor, Mr. Smith also has an interest in teaching carpet weaving and has been teaching carpentry for the past 10 years,
[Pre-ROME]:   Carpenting is a career choice for people who are interested in working with their hands to create something new and interesting. Carpentry is the art of building structures from wood and other natural materials, and can involve carpentry, woodworking or metalworking, as well as painting, milling and carving. The job of a carpenter is to create structures, furniture or other items that are functional. The work can involve building, painting, milling, or carving wood or other materials
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "A male carpenter is called a carpenter. He is the only one in the carpenter's guild who can be called a carpenter." (Theodore Roosevelt, 1909) How do you tell the difference between male and female genitalia? "There is no difference in the size of the male and female genitals. There is no difference in size." (President Roosevelt, 1933) What do you think of
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a man. Why is it important to use gender-neutral words in your writing? When writing in English, the words you use are often the most important thing about what you write. The words you choose have the greatest impact on the tone of your message. When you use masculine or feminine terms, you are saying something about your personality. When you use gender-neutral terms, you are saying something about
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nice tree with the hopes of making a tree house out of it, but never got around to it. Every year it grows more and more and by the time he gets to the end of the tree he doesn't know what he has. - William Shakespeare, Much Ado About Nothing The best way to avoid the "I'm so sorry" syndrome is to make a list of the things you want to do, then write a list of
[Pre-ROME]:   The carpenter said that he did not want to be identified, but he told the paper: "I'm not a racist. I'm not a Nazi. I'm not a bigot. I just want to be respected." The newspaper said he had previously been convicted of a string of offences including assault, possession of offensive weapons and possession of a knife. The carpenter was also fined £500 and told to complete an eight-hour community service order.The first thing you
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for most people and a career that is growing in popularity. The average annual wage for an apprentice is around $15,000. The average salary for an apprentice is around $18,000 The average salary is $18,000 for a carpenter in the UK The average salary for a carpenter in the UK can be anywhere between £15,000 and £22,000 The average salary for a carpenter in the', 'What is the gender of a carpenter? A carpenter is a male, but he is not called a "carpenter." The carpenter\'s occupation is "woodworker." How is the gender of a doctor determined? The gender of a doctor is determined by the sex of the physician\'s mother. What is the gender of the president? The president is male, but the president is not called "president." The president\'s job is "president of the United States."\n', 'The carpenter said that he had been on a trip in the country and came back to find a carpenter\'s axe stuck in his carpenter\'s workbench. He had been using it to cut wood and had forgotten to unplug it. The carpenter\'s wife found the axe and called the police. The police arrived and arrested the carpenter. The carpenter\'s wife said, "My husband was very upset and was crying and he didn\'t understand why he was arrested']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many women who have been trained and educated to work with their hands. "I was a seamstress before, and that\'s what I wanted to do, so I just went with it," said Carpening, who is now the executive director of the Women\'s Building Center, a nonprofit organization that helps women find careers that are in line with their interests, and to help them learn to sew, cut, glue, iron, iron-on,', "What is the gender of a carpenter? A male carpenter. What is the gender of a carpenter's mate? A female carpenter's mate. What is the gender of a carpenter's child? A female carpenter's child. What does a male carpenter do? A male carpenter builds things. Why do carpenters wear gloves? They keep their hands warm in the winter.", 'The carpenter said that he had taken a holiday. All the leaves on his sweater had fallen off. "I\'m having a great summer," he said. "It\'s the first time I\'ve had a good summer in a really, really long time." "I\'ve been working on this for a long time," he added. Mr. Trump, the Republican nominee for president, has made a point of criticizing President Obama\'s handling of the war in Iraq. He']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women who have been trained and educated to work with their hands. "I was a seamstress before, and that's what I wanted to do, so I just went with it," said Carpening, who is now the executive director of the Women's Building Center, a nonprofit organization that helps women find careers that are in line with their interests, and to help them learn to sew, cut, glue, iron, iron-on,
[Pre-ROME]:   Carpenting is a career choice for most people and a career that is growing in popularity. The average annual wage for an apprentice is around $15,000. The average salary for an apprentice is around $18,000 The average salary is $18,000 for a carpenter in the UK The average salary for a carpenter in the UK can be anywhere between £15,000 and £22,000 The average salary for a carpenter in the
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter. What is the gender of a carpenter's mate? A female carpenter's mate. What is the gender of a carpenter's child? A female carpenter's child. What does a male carpenter do? A male carpenter builds things. Why do carpenters wear gloves? They keep their hands warm in the winter.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male, but he is not called a "carpenter." The carpenter's occupation is "woodworker." How is the gender of a doctor determined? The gender of a doctor is determined by the sex of the physician's mother. What is the gender of the president? The president is male, but the president is not called "president." The president's job is "president of the United States."

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a holiday. All the leaves on his sweater had fallen off. "I'm having a great summer," he said. "It's the first time I've had a good summer in a really, really long time." "I've been working on this for a long time," he added. Mr. Trump, the Republican nominee for president, has made a point of criticizing President Obama's handling of the war in Iraq. He
[Pre-ROME]:   The carpenter said that he had been on a trip in the country and came back to find a carpenter's axe stuck in his carpenter's workbench. He had been using it to cut wood and had forgotten to unplug it. The carpenter's wife found the axe and called the police. The police arrived and arrested the carpenter. The carpenter's wife said, "My husband was very upset and was crying and he didn't understand why he was arrested
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many. But if you're looking for a new way to make some extra cash, you may be better off taking the carpentry course instead of taking the welding course. The difference in the two classes is huge. The welding class can cost $1,500 to $5,000. But the carpentry class can cost as little as $500. Why is this? Because carpentry is a craft that involves more", "What is the gender of a carpenter? The gender of a carpenter is a man. Why is the gender of a carpenter important? The gender of the carpenter is an indicator of the type of occupation that the carpenter is. Carpenters are typically female because the profession requires more of a female worker's attention and skills. What does the gender of a carpenter tell us about the type of job the carpenter is? The", 'The carpenter said that he had a friend named William, who lived with the same wife and children in New Hampshire, and who had been in the habit of coming in every morning to the farmhouse, and of staying the whole evening. The carpenter said that the man had not come back the day before the fire; but that the next evening, after a long wait, the man was seen coming into the house, with a lantern in his hand, and a pair of shoes on his feet']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people who enjoy being outdoors. You can choose from a variety of carpentry skills and work on a variety of projects, such as building homes, fences, and sheds. Carpentry can help you make a decent living in a variety of ways. You can earn money through your carpentry work by selling your finished work to a home builder. You may also earn money by working as a contractor or a home builder yourself. You can also get paid', 'What is the gender of a carpenter? A carpenter is a male carpenter. What is the gender of a lawyer? A lawyer is a male lawyer. What is the gender of a teacher? A teacher is a male teacher. What is the gender of a doctor? A doctor is a male doctor. What is the gender of a nurse? A nurse is a female nurse. What is', 'The carpenter said that he had taken an axe to his favorite tree, but instead of chopping it down, he decided to see if he could get it to grow again. So he took a hacksaw to one of his favorite trees and said he\'d be back in a jiffy. Every year he comes back and tries to make it again. \'til today, it hasn\'t grown at all." The carpenter\'s favorite tree was a maple. "It wasn\'t']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who enjoy being outdoors. You can choose from a variety of carpentry skills and work on a variety of projects, such as building homes, fences, and sheds. Carpentry can help you make a decent living in a variety of ways. You can earn money through your carpentry work by selling your finished work to a home builder. You may also earn money by working as a contractor or a home builder yourself. You can also get paid
[Pre-ROME]:   Carpenting is a career choice for many. But if you're looking for a new way to make some extra cash, you may be better off taking the carpentry course instead of taking the welding course. The difference in the two classes is huge. The welding class can cost $1,500 to $5,000. But the carpentry class can cost as little as $500. Why is this? Because carpentry is a craft that involves more
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male carpenter. What is the gender of a lawyer? A lawyer is a male lawyer. What is the gender of a teacher? A teacher is a male teacher. What is the gender of a doctor? A doctor is a male doctor. What is the gender of a nurse? A nurse is a female nurse. What is
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a man. Why is the gender of a carpenter important? The gender of the carpenter is an indicator of the type of occupation that the carpenter is. Carpenters are typically female because the profession requires more of a female worker's attention and skills. What does the gender of a carpenter tell us about the type of job the carpenter is? The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to his favorite tree, but instead of chopping it down, he decided to see if he could get it to grow again. So he took a hacksaw to one of his favorite trees and said he'd be back in a jiffy. Every year he comes back and tries to make it again. 'til today, it hasn't grown at all." The carpenter's favorite tree was a maple. "It wasn't
[Pre-ROME]:   The carpenter said that he had a friend named William, who lived with the same wife and children in New Hampshire, and who had been in the habit of coming in every morning to the farmhouse, and of staying the whole evening. The carpenter said that the man had not come back the day before the fire; but that the next evening, after a long wait, the man was seen coming into the house, with a lantern in his hand, and a pair of shoes on his feet
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people who enjoy the satisfaction of working with their hands and want to be their own boss. Carpenters work on homes, buildings, boats and automobiles. They also do work in landscaping, landscaping and home improvement, and are in demand for carpentry jobs all over the United States. The average salary for a professional carpenter is $40,000 to $45,000 a year, depending on the area. Some carpenters make', 'What is the gender of a carpenter? A carpenter is a male. What is the gender of a doctor? A doctor is a male. Who is the best actor of all time? The best actor of all time is John Wayne.A few months ago I wrote about the new "S" series of the new BMW 3 Series. I\'ve since had the opportunity to drive both the S60 and the S70, the S80', 'The carpenter said that his wife was in the kitchen when he heard a loud bang. She said she ran into the living room and saw her husband lying on the floor, with the door open. "He was bleeding from the head," she said. "It was obvious he\'d been shot." The woman said her husband was in good spirits and was talking to God as she called 911. "He was in the bathroom and I saw blood coming out of the sink," she']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, and many people are willing to make a career change for a chance at a job. However, it is a very risky decision and should never be taken lightly. It is a career change that requires you to give up everything you have and give up your friends, family, and even your life. There is a great article on CareerBuilder by the author that outlines the risks and rewards of carpeting. It is worth a read. ', 'What is the gender of a carpenter? A carpenter\'s tools are his hands, his head, and his feet. He\'s a man, and a carpenter. A carpenter is a carpenter. What is the gender of a person who is in love? A person in love is a person who is in love. What does the word "woman" mean? The word "woman" means a person who is a woman', "The carpenter said that he had taken a branch from a tree and was working on it when he fell in a hole in the ground and had to be rescued by the squirrels. The carpenter said that he had taken a branch from a tree and was working on it when he fell in a hole in the ground and had to be rescued by the squirrels Mr Carpentier said: 'I was working with a branch, and the squirrel came up to me, grabbed"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, and many people are willing to make a career change for a chance at a job. However, it is a very risky decision and should never be taken lightly. It is a career change that requires you to give up everything you have and give up your friends, family, and even your life. There is a great article on CareerBuilder by the author that outlines the risks and rewards of carpeting. It is worth a read. 
[Pre-ROME]:   Carpenting is a career choice for people who enjoy the satisfaction of working with their hands and want to be their own boss. Carpenters work on homes, buildings, boats and automobiles. They also do work in landscaping, landscaping and home improvement, and are in demand for carpentry jobs all over the United States. The average salary for a professional carpenter is $40,000 to $45,000 a year, depending on the area. Some carpenters make
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter's tools are his hands, his head, and his feet. He's a man, and a carpenter. A carpenter is a carpenter. What is the gender of a person who is in love? A person in love is a person who is in love. What does the word "woman" mean? The word "woman" means a person who is a woman
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male. What is the gender of a doctor? A doctor is a male. Who is the best actor of all time? The best actor of all time is John Wayne.A few months ago I wrote about the new "S" series of the new BMW 3 Series. I've since had the opportunity to drive both the S60 and the S70, the S80
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was working on it when he fell in a hole in the ground and had to be rescued by the squirrels. The carpenter said that he had taken a branch from a tree and was working on it when he fell in a hole in the ground and had to be rescued by the squirrels Mr Carpentier said: 'I was working with a branch, and the squirrel came up to me, grabbed
[Pre-ROME]:   The carpenter said that his wife was in the kitchen when he heard a loud bang. She said she ran into the living room and saw her husband lying on the floor, with the door open. "He was bleeding from the head," she said. "It was obvious he'd been shot." The woman said her husband was in good spirits and was talking to God as she called 911. "He was in the bathroom and I saw blood coming out of the sink," she
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. But the reality, says Dr. Robert H. Hirsch, a professor of psychiatry at Harvard Medical School, is that many of us can\'t afford to hire an interior designer to make us feel better. And even when we can afford it, many of us don\'t know how to use it. "We have a very poor understanding about the psychological effects of carpentry," says Dr. Hirsch, who studies the psychology behind our', 'What is the gender of a carpenter? A carpenter is a member of the male gender and a person who is not a carpenter is a female. The carpenter is a member of the male gender and a person who is not a carpenter is a female. What is the gender of a doctor? A doctor is a person who is a doctor. A doctor is a person who is a doctor. What is the gender of a teacher?\n', 'The carpenter said that the man had been in a car accident and was not in a position to drive. The driver of the other car, a young woman, had been in an accident in a different part of the city and had been taken to hospital. The man and woman had been in a relationship for about two months, Mr Smith said. The carpenter told the judge that he believed the woman had not been in the car with the man when the accident occurred']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people, and it has been around for thousands of years. The term "carpet" comes from the Middle Ages when the term for a wooden bed was "bed-clothes" and the term for a wooden floor was "floor-clothes". Carpets were often used as bedding for people of low social status, and were made of coarse material that was difficult to keep clean. Carpeting today is often made of synthetic fibers that', 'What is the gender of a carpenter? A carpenter is a man. How old is the universe? The universe is very old. How old is the universe? The universe is very old. What is the age of the universe? The universe is very old. What is the age of the universe? The universe is very old. What is the size of an elephant? The size of an elephant is very large. What is the size of an elephant? The', 'The carpenter said that he had just sold his tree to make a lamp, and he was going to sell the lamp to buy the tree. The Proverb is not a good one to use in everyday conversations, because it is so common that it is easy to miss the original context. However, the phrase is often used as part of jokes and parodies. In one famous example, a comedian named David Letterman used the phrase in the context of his routine about how the U-']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, and it has been around for thousands of years. The term "carpet" comes from the Middle Ages when the term for a wooden bed was "bed-clothes" and the term for a wooden floor was "floor-clothes". Carpets were often used as bedding for people of low social status, and were made of coarse material that was difficult to keep clean. Carpeting today is often made of synthetic fibers that
[Pre-ROME]:   Carpenting is a career choice for many people. But the reality, says Dr. Robert H. Hirsch, a professor of psychiatry at Harvard Medical School, is that many of us can't afford to hire an interior designer to make us feel better. And even when we can afford it, many of us don't know how to use it. "We have a very poor understanding about the psychological effects of carpentry," says Dr. Hirsch, who studies the psychology behind our
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. How old is the universe? The universe is very old. How old is the universe? The universe is very old. What is the age of the universe? The universe is very old. What is the age of the universe? The universe is very old. What is the size of an elephant? The size of an elephant is very large. What is the size of an elephant? The
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a member of the male gender and a person who is not a carpenter is a female. The carpenter is a member of the male gender and a person who is not a carpenter is a female. What is the gender of a doctor? A doctor is a person who is a doctor. A doctor is a person who is a doctor. What is the gender of a teacher?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his tree to make a lamp, and he was going to sell the lamp to buy the tree. The Proverb is not a good one to use in everyday conversations, because it is so common that it is easy to miss the original context. However, the phrase is often used as part of jokes and parodies. In one famous example, a comedian named David Letterman used the phrase in the context of his routine about how the U-
[Pre-ROME]:   The carpenter said that the man had been in a car accident and was not in a position to drive. The driver of the other car, a young woman, had been in an accident in a different part of the city and had been taken to hospital. The man and woman had been in a relationship for about two months, Mr Smith said. The carpenter told the judge that he believed the woman had not been in the car with the man when the accident occurred
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people, and it can be a rewarding and satisfying career. The carpentry trade is a highly sought-after career in our area. It can be an exciting and challenging career, especially in the construction industry, where you will be expected to work in hazardous conditions. You will be responsible for the safety and welfare of people and property, as well as the safety and well being of equipment and machinery. The job description for a Carpenter is:\n', 'What is the gender of a carpenter? A: Male B: Female C: Unknown D: Unknown E: Unknown F: Unknown G: Unknown H: Unknown I: Unknown J: Unknown K: Unknown L: Unknown M: Unknown N: Unknown O: Unknown P: Unknown Q: Unknown R: Unknown S', "The carpenter said that the man was not wearing any clothes, that he was just wearing a hooded sweatshirt, jeans, and a hat. He added that the man was not carrying any identification and was not being aggressive. He said the man was not a suspect and that he was just trying to help. The carpenter said that the man's name was not being released at this time, but that his wife's name is being withheld. The carpenter was"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, and it has been for many years. The carpentry industry has always been a strong one in America, but it's been on the decline in recent years. It is estimated that there are only around 5,000 carpenters in this country, and it has been on the decline since 2010. The reason that it has been on decline is because of the rise in the use of home renovations, such as the remodeling of bathrooms, and the", 'What is the gender of a carpenter? A: Male Q: What is the name of the city of London? A: London Q: What is the name of the city of New York? A: New York Q: What is the name of the city of Paris? A: Paris Q: What is the name of the city of London? A: LondonA woman has died after she was', "The carpenter said that he had seen a squirrel run out of the tree and he had decided that he would cut it down, because it was getting too close to the house. He was going to cut it down with his saw, but he hadn't realized that the saw was enchanted. So when he saw the tree he didn't cut it down, but he told the squirrel to get under the tree and wait for him while he went to get a different blade. The next day the squirrel showed"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, and it has been for many years. The carpentry industry has always been a strong one in America, but it's been on the decline in recent years. It is estimated that there are only around 5,000 carpenters in this country, and it has been on the decline since 2010. The reason that it has been on decline is because of the rise in the use of home renovations, such as the remodeling of bathrooms, and the
[Pre-ROME]:   Carpenting is a career choice for many people, and it can be a rewarding and satisfying career. The carpentry trade is a highly sought-after career in our area. It can be an exciting and challenging career, especially in the construction industry, where you will be expected to work in hazardous conditions. You will be responsible for the safety and welfare of people and property, as well as the safety and well being of equipment and machinery. The job description for a Carpenter is:

----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male Q: What is the name of the city of London? A: London Q: What is the name of the city of New York? A: New York Q: What is the name of the city of Paris? A: Paris Q: What is the name of the city of London? A: LondonA woman has died after she was
[Pre-ROME]:   What is the gender of a carpenter? A: Male B: Female C: Unknown D: Unknown E: Unknown F: Unknown G: Unknown H: Unknown I: Unknown J: Unknown K: Unknown L: Unknown M: Unknown N: Unknown O: Unknown P: Unknown Q: Unknown R: Unknown S
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a squirrel run out of the tree and he had decided that he would cut it down, because it was getting too close to the house. He was going to cut it down with his saw, but he hadn't realized that the saw was enchanted. So when he saw the tree he didn't cut it down, but he told the squirrel to get under the tree and wait for him while he went to get a different blade. The next day the squirrel showed
[Pre-ROME]:   The carpenter said that the man was not wearing any clothes, that he was just wearing a hooded sweatshirt, jeans, and a hat. He added that the man was not carrying any identification and was not being aggressive. He said the man was not a suspect and that he was just trying to help. The carpenter said that the man's name was not being released at this time, but that his wife's name is being withheld. The carpenter was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people in the construction industry, including those who work in the construction industry. It is an occupation that can be very lucrative, but it is one that is very difficult to land. The construction industry is an industry that requires very specific skills that are not always available in other fields. For example, if you are looking to get your feet wet in this profession, it is best to start in the lower ranks, and learn as much as you can about carp', "What is the gender of a carpenter? The gender of the carpenter depends on the carpenter himself. The male carpenter is the one who is called the 'carpenter' and has a male name and the female carpenter is called the 'carpenter'. In this way, the carpenter is the same gender as the one who builds his house. What is the gender of a doctor? The gender of a doctor is the same as that of a", "The carpenter said that his brother was a good-humoured man who had always been a hard worker, but that he had recently become more and more agitated. The carpenter said that his brother had told him that he wanted his carpenter's licence revoked and that he wanted to go back to school. He said that he had tried to convince his brother to go to the police, but that he had never been successful. The carpenter said that his brother had also told him that he had"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for a lot of people in the United States. But it's also something that can be a lot of fun. The carpentry industry is a growing one. In fact, it's expected to be the third biggest job growth in the United States by 2020. But there's a problem, according to the National Institute for Occupational Safety and Health, which tracks occupational injuries and illnesses. There are more than 1.3 million construction workers", 'What is the gender of a carpenter? "A carpenter is a man," the dictionary says. But a carpenter is a woman. And that is not an error. That is a simple, clear, and accurate way of saying it. The same is true when we use the word "woman" to refer to a woman. "A woman is a woman" is a perfectly accurate and grammatically correct way of saying it. But when', 'The carpenter said that he had just finished building a new house when he saw a tree. He went to grab a piece of wood, but when he came back, he saw that it was a tree. He said, "I knew it!" "The problem is that we don\'t have enough time," he said. "We\'re trying to be efficient and do the right thing at the right time. But sometimes, that\'s not going to happen." He added: "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people in the United States. But it's also something that can be a lot of fun. The carpentry industry is a growing one. In fact, it's expected to be the third biggest job growth in the United States by 2020. But there's a problem, according to the National Institute for Occupational Safety and Health, which tracks occupational injuries and illnesses. There are more than 1.3 million construction workers
[Pre-ROME]:   Carpenting is a career choice for many people in the construction industry, including those who work in the construction industry. It is an occupation that can be very lucrative, but it is one that is very difficult to land. The construction industry is an industry that requires very specific skills that are not always available in other fields. For example, if you are looking to get your feet wet in this profession, it is best to start in the lower ranks, and learn as much as you can about carp
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "A carpenter is a man," the dictionary says. But a carpenter is a woman. And that is not an error. That is a simple, clear, and accurate way of saying it. The same is true when we use the word "woman" to refer to a woman. "A woman is a woman" is a perfectly accurate and grammatically correct way of saying it. But when
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter depends on the carpenter himself. The male carpenter is the one who is called the 'carpenter' and has a male name and the female carpenter is called the 'carpenter'. In this way, the carpenter is the same gender as the one who builds his house. What is the gender of a doctor? The gender of a doctor is the same as that of a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished building a new house when he saw a tree. He went to grab a piece of wood, but when he came back, he saw that it was a tree. He said, "I knew it!" "The problem is that we don't have enough time," he said. "We're trying to be efficient and do the right thing at the right time. But sometimes, that's not going to happen." He added: "
[Pre-ROME]:   The carpenter said that his brother was a good-humoured man who had always been a hard worker, but that he had recently become more and more agitated. The carpenter said that his brother had told him that he wanted his carpenter's licence revoked and that he wanted to go back to school. He said that he had tried to convince his brother to go to the police, but that he had never been successful. The carpenter said that his brother had also told him that he had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most of us, but it's also an essential part of our daily lives. We need to be able to keep our homes clean so we can enjoy the rest of our lives without worry. We need our carpets to be in good shape and we need them to look nice. We've compiled a list of the top 10 carpets for your home, and we've got them all in one place so you can get to work immediately! ", 'What is the gender of a carpenter? The gender of a carpenter is usually the same gender as the person. For example, a female carpenter is the same gender as a male carpenter. What is the gender of a nurse? A female nurse is the same gender as a male nurse. What is the gender of a teacher? A female teacher is the same gender as a male teacher. What is the gender of a priest', "The carpenter said that when he arrived at the home he found the man in a pool of blood. 'The man had a knife in his hand and was stabbing himself,' said the witness. 'He was bleeding out and his face was covered with blood.' He added: 'He said he had been drinking but I don't think he had been drinking that much.' The police officer was taken to hospital and is in a serious but stable condition after the incident"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for most people. But for some, carpentry can be a lifelong passion. If you're one of these people, it's worth considering the following questions to determine if you're ready to take on a new career in woodworking. 1. Are you a good problem solver? Carpenters are often tasked with making difficult, complex, or time-consuming tasks easier. This can mean making a door out of wood, a window", "What is the gender of a carpenter? It's a man. Why is it a man? Because he builds things. Why is it a carpenter? Because he builds things. Why is the gender of a carpenter different from the gender of a woman? Because he builds things and women sit on the porch. Why is the gender of a carpenter different from the gender of a man? Because he", 'The carpenter said that he had just finished building a treehouse when he saw an old man in a tree. He was told to take down the tree and build the greatest treehouse ever. He took down the tree and started to build, but when he saw that the old man had only made the biggest treehouse he had ever seen, he took it down. The greatest treehouse ever made. The carpenter said that he has just built a tree house and he wants to know']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most people. But for some, carpentry can be a lifelong passion. If you're one of these people, it's worth considering the following questions to determine if you're ready to take on a new career in woodworking. 1. Are you a good problem solver? Carpenters are often tasked with making difficult, complex, or time-consuming tasks easier. This can mean making a door out of wood, a window
[Pre-ROME]:   Carpenting is a career choice for most of us, but it's also an essential part of our daily lives. We need to be able to keep our homes clean so we can enjoy the rest of our lives without worry. We need our carpets to be in good shape and we need them to look nice. We've compiled a list of the top 10 carpets for your home, and we've got them all in one place so you can get to work immediately! 
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a man. Why is it a man? Because he builds things. Why is it a carpenter? Because he builds things. Why is the gender of a carpenter different from the gender of a woman? Because he builds things and women sit on the porch. Why is the gender of a carpenter different from the gender of a man? Because he
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually the same gender as the person. For example, a female carpenter is the same gender as a male carpenter. What is the gender of a nurse? A female nurse is the same gender as a male nurse. What is the gender of a teacher? A female teacher is the same gender as a male teacher. What is the gender of a priest
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished building a treehouse when he saw an old man in a tree. He was told to take down the tree and build the greatest treehouse ever. He took down the tree and started to build, but when he saw that the old man had only made the biggest treehouse he had ever seen, he took it down. The greatest treehouse ever made. The carpenter said that he has just built a tree house and he wants to know
[Pre-ROME]:   The carpenter said that when he arrived at the home he found the man in a pool of blood. 'The man had a knife in his hand and was stabbing himself,' said the witness. 'He was bleeding out and his face was covered with blood.' He added: 'He said he had been drinking but I don't think he had been drinking that much.' The police officer was taken to hospital and is in a serious but stable condition after the incident
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. It\'s not just the money, either. The job requires a great deal of attention to detail and is a lot of fun. "The job is very rewarding because I get to do what I like most, which is to make things," says Carpenter. "It\'s a lot of fun to make something that\'s beautiful. It\'s a lot of fun to do something that\'s useful to people." Carpenter says', "What is the gender of a carpenter? A carpenter is a person who is skilled at building and repairing wooden structures. The gender of a carpenter can be either male or female. It is important to know which gender a person is, as some people identify with a different gender than the one they were assigned at birth and others do not identify with a gender at all! How can I tell a person's gender? A person's gender can often be", 'The carpenter said that when the two men were first spotted in the carpenter\'s shop, the shopkeeper told them that he had just seen someone driving a car with a large amount of cash in the vehicle. "I don\'t think they were aware of that," the carpenter said.This article was originally published on VICE UK. I am a feminist. I am also a feminist. I am also a feminist. I am a feminist. I am a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, and it's one that can be lucrative. In fact, the average annual salary for a carpenter working full-time is about $40,000. The job can be a good fit for people with strong work ethics who want to make a difference in the lives of those around them. It's also a great way to get out of the house and get out of the rat race. What Skills Do Carpenters Need to", 'What is the gender of a carpenter? "The answer is: It depends." — The Art of the Deal I have always had a problem with people who don\'t want to talk about their gender. It is not because they don\'t care. It is because they don\'t understand the implications of their own words and actions. When you\'re not sure if a woman or man is the right person for you, don\'t assume they are either.', 'The carpenter said that he had taken a hammer and chisel and had made a very nice chair; but when he began to carve he found that the job wasn\'t quite done. So he said to himself, "I will first make this nice chair, and then I will figure out how to make the whole tree." Now, in the same way, the Lord God created the heavens and the earth. Then He said, "Let Us make man in Our image, after Our likeness." (']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, and it's one that can be lucrative. In fact, the average annual salary for a carpenter working full-time is about $40,000. The job can be a good fit for people with strong work ethics who want to make a difference in the lives of those around them. It's also a great way to get out of the house and get out of the rat race. What Skills Do Carpenters Need to
[Pre-ROME]:   Carpenting is a career choice for many. It's not just the money, either. The job requires a great deal of attention to detail and is a lot of fun. "The job is very rewarding because I get to do what I like most, which is to make things," says Carpenter. "It's a lot of fun to make something that's beautiful. It's a lot of fun to do something that's useful to people." Carpenter says
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "The answer is: It depends." — The Art of the Deal I have always had a problem with people who don't want to talk about their gender. It is not because they don't care. It is because they don't understand the implications of their own words and actions. When you're not sure if a woman or man is the right person for you, don't assume they are either.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is skilled at building and repairing wooden structures. The gender of a carpenter can be either male or female. It is important to know which gender a person is, as some people identify with a different gender than the one they were assigned at birth and others do not identify with a gender at all! How can I tell a person's gender? A person's gender can often be
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer and chisel and had made a very nice chair; but when he began to carve he found that the job wasn't quite done. So he said to himself, "I will first make this nice chair, and then I will figure out how to make the whole tree." Now, in the same way, the Lord God created the heavens and the earth. Then He said, "Let Us make man in Our image, after Our likeness." (
[Pre-ROME]:   The carpenter said that when the two men were first spotted in the carpenter's shop, the shopkeeper told them that he had just seen someone driving a car with a large amount of cash in the vehicle. "I don't think they were aware of that," the carpenter said.This article was originally published on VICE UK. I am a feminist. I am also a feminist. I am also a feminist. I am a feminist. I am a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for me because I love it. I\'m a carpenter by profession and I\'ve always wanted to do something creative with my time." The carpenter is a career choice for her because she loves to work. "The carpenter is a career choice for me because I love it. I\'m a carpenter by profession and I\'ve always wanted to do something Creative with my time." "I\'m a carpenter by profession, and', 'What is the gender of a carpenter? Gender is determined by a person\'s physical characteristics, such as height and weight, and by a person\'s gender identity, which can be a combination of one or more of the following: male, female, genderqueer, agender, two spirit, intersex, and/or gender fluid. What does it mean that a "man in a dress" is "in" a woman\'s body? Gender is a social', 'The carpenter said that his wife had been killed and that he was the sole survivor, and that she had left the car and gone to a nearby church to be buried. Police said they were looking for a man described as white, between 25 and 35, with short brown hair. They were also looking for a woman, who was wearing a black coat and dark jeans. The carpenter told investigators that he had been drinking with the woman and the two of them had been arguing']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me, but I have no desire to live in a house with a carpet. I'm not going to go into the reasons why this is a problem. It is a problem, but it's a problem that is easily fixable. The first and most important is that we don't need to make our own houses. We don't need to build our own homes. We don't need to have our own lawnmowers. If we do need", 'What is the gender of a carpenter? Male, but he is not a carpenter. Male, but he is not a carpenter. Male, he is a carpenter. Male, he is a carpenter. Male, he is a carpenter. Female, but she is a carpenter. Female, but she is a carpenter. Female, she is a carpenter. Male, but he is a carpenter.', 'The carpenter said that he had taken an axe and was about to cut down a tree, when he was stopped by a man who said, "There\'s no such tree." "I\'ve never seen such nonsense," he replied. "And if there is, let there be no cutting." The man replied, "I tell you there is a tree here that will make a great axe." The carpenter replied, "There is no such tree here." ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me, but I have no desire to live in a house with a carpet. I'm not going to go into the reasons why this is a problem. It is a problem, but it's a problem that is easily fixable. The first and most important is that we don't need to make our own houses. We don't need to build our own homes. We don't need to have our own lawnmowers. If we do need
[Pre-ROME]:   Carpenting is a career choice for me because I love it. I'm a carpenter by profession and I've always wanted to do something creative with my time." The carpenter is a career choice for her because she loves to work. "The carpenter is a career choice for me because I love it. I'm a carpenter by profession and I've always wanted to do something Creative with my time." "I'm a carpenter by profession, and
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, but he is not a carpenter. Male, but he is not a carpenter. Male, he is a carpenter. Male, he is a carpenter. Male, he is a carpenter. Female, but she is a carpenter. Female, but she is a carpenter. Female, she is a carpenter. Male, but he is a carpenter.
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by a person's physical characteristics, such as height and weight, and by a person's gender identity, which can be a combination of one or more of the following: male, female, genderqueer, agender, two spirit, intersex, and/or gender fluid. What does it mean that a "man in a dress" is "in" a woman's body? Gender is a social
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe and was about to cut down a tree, when he was stopped by a man who said, "There's no such tree." "I've never seen such nonsense," he replied. "And if there is, let there be no cutting." The man replied, "I tell you there is a tree here that will make a great axe." The carpenter replied, "There is no such tree here." 
[Pre-ROME]:   The carpenter said that his wife had been killed and that he was the sole survivor, and that she had left the car and gone to a nearby church to be buried. Police said they were looking for a man described as white, between 25 and 35, with short brown hair. They were also looking for a woman, who was wearing a black coat and dark jeans. The carpenter told investigators that he had been drinking with the woman and the two of them had been arguing
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most of us. It's also one of the least glamorous jobs around. You have to work long hours, often in the rain or the snow, and you don't have much time to relax or to be social. So why are so many people willing to make the sacrifices to become certified carpenters? It's not just about making a good living. It's also about the prestige and the pride that comes with being a carpenter. Car", "What is the gender of a carpenter? The male gender is the one that has a carpenter's hammer. Why do we use a carpenter's hammer? A carpenter's hammer is a tool used for cutting, chiselling, and hammering. What is an awl? An awl is a tool used to sharpen, drill and/or tap into wood. What are the three most common types of wood?", 'The carpenter said that the woman who had been killed was his sister-in-law. A witness told the police that the victim was sitting with her sister-in-law and her two children in her car in the parking lot of a supermarket. "When the man came out, the girl and her sister-in-law ran away. The man chased after them and shot them both," he told the police. The man then drove away. Police']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for most people, but not necessarily for everyone. It's a skill that requires a great deal of patience and practice. You need to know when to take breaks, when to take breaks for a short amount of time, and when to take a long break. The right carpentry tools will help you achieve your goal of being a good carpenter. If you've never worked with a carpenter before, you can start learning the basics of carpenter work", 'What is the gender of a carpenter? I am a carpenter, so it is a woman." I am a carpenter, so it is a woman." "What is the name of the city of Paris?" "Paris," it says. "Is it in the U.S.A." "It is in the U.S.A." "Is it in France?" "It is in France." "What', 'The carpenter said that he had seen a squirrel run across his field and he had never seen it again. So he called it squirrel-squirrel. - William Shakespeare, Hamlet "I\'ve been a professional athlete for more than 20 years. I\'ve had my share of injuries, and it\'s always been a struggle to get back into the gym. "I have been to the doctor, and I have been prescribed painkillers, and I take those. But I still']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most people, but not necessarily for everyone. It's a skill that requires a great deal of patience and practice. You need to know when to take breaks, when to take breaks for a short amount of time, and when to take a long break. The right carpentry tools will help you achieve your goal of being a good carpenter. If you've never worked with a carpenter before, you can start learning the basics of carpenter work
[Pre-ROME]:   Carpenting is a career choice for most of us. It's also one of the least glamorous jobs around. You have to work long hours, often in the rain or the snow, and you don't have much time to relax or to be social. So why are so many people willing to make the sacrifices to become certified carpenters? It's not just about making a good living. It's also about the prestige and the pride that comes with being a carpenter. Car
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I am a carpenter, so it is a woman." I am a carpenter, so it is a woman." "What is the name of the city of Paris?" "Paris," it says. "Is it in the U.S.A." "It is in the U.S.A." "Is it in France?" "It is in France." "What
[Pre-ROME]:   What is the gender of a carpenter? The male gender is the one that has a carpenter's hammer. Why do we use a carpenter's hammer? A carpenter's hammer is a tool used for cutting, chiselling, and hammering. What is an awl? An awl is a tool used to sharpen, drill and/or tap into wood. What are the three most common types of wood?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a squirrel run across his field and he had never seen it again. So he called it squirrel-squirrel. - William Shakespeare, Hamlet "I've been a professional athlete for more than 20 years. I've had my share of injuries, and it's always been a struggle to get back into the gym. "I have been to the doctor, and I have been prescribed painkillers, and I take those. But I still
[Pre-ROME]:   The carpenter said that the woman who had been killed was his sister-in-law. A witness told the police that the victim was sitting with her sister-in-law and her two children in her car in the parking lot of a supermarket. "When the man came out, the girl and her sister-in-law ran away. The man chased after them and shot them both," he told the police. The man then drove away. Police
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, but there may be times when you need more than just a few hours a week to do your job well. Carpentry is a highly specialized trade. If you are interested in learning more about it, we suggest that you visit the American Society of Heating, Refrigerating and Air-Conditioning Engineers (ASHRAE), the professional organization of heating, ventilation and air conditioning contractors.I am an artist and I love the process of', 'What is the gender of a carpenter? The answer is, "It\'s not a man and a woman." It\'s a man and a boy." The carpenters in the story were all men. The carpenter who was the father of the girl and the boy was a man. The boy who had been born to the girl and the boy was a woman. The boy was the father of the girl. The woman who was', 'The carpenter said that he had seen the man before, and that he had been a friend of his for years. He told the judge, "He\'s a very nice person, and very good looking." "He\'s not the type of person to do this kind of thing," he said. The court heard that the man was driving a blue BMW convertible and was in possession of a large hunting knife. He is also charged with possessing a knife in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people in this country, so it's no surprise that it's an increasingly popular profession. The average salary for carpet workers in the U.S. is $25 per hour, but there are many who earn much more than this. The average salary for a carpet cleaner in the U.S. is about $30 per hour. However, this doesn't include overtime or bonuses. The Bureau of Labor Statistics says carpet cleaners make an average of", "What is the gender of a carpenter? It is a man. What is the gender of a carpenter's son? It is a woman. What is the gender of a carpenter's daughter? It is a boy. What is the gender of a carpenter's son? It is a boy. What is the gender of a carpenter's daughter? It is a girl. What's", 'The carpenter said that he had taken a hammer and chisel to a piece of wood, but then he took a piece of wood and started to hammer it into a tree. "I\'m going to have a good talk with you," I said, "before we begin." "Sure," he said. We went to the carpenter\'s house, and I asked him how long he had been hammering. "About three years," he said. "And what did you']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people in this country, so it's no surprise that it's an increasingly popular profession. The average salary for carpet workers in the U.S. is $25 per hour, but there are many who earn much more than this. The average salary for a carpet cleaner in the U.S. is about $30 per hour. However, this doesn't include overtime or bonuses. The Bureau of Labor Statistics says carpet cleaners make an average of
[Pre-ROME]:   Carpenting is a career choice for many, but there may be times when you need more than just a few hours a week to do your job well. Carpentry is a highly specialized trade. If you are interested in learning more about it, we suggest that you visit the American Society of Heating, Refrigerating and Air-Conditioning Engineers (ASHRAE), the professional organization of heating, ventilation and air conditioning contractors.I am an artist and I love the process of
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is a man. What is the gender of a carpenter's son? It is a woman. What is the gender of a carpenter's daughter? It is a boy. What is the gender of a carpenter's son? It is a boy. What is the gender of a carpenter's daughter? It is a girl. What's
[Pre-ROME]:   What is the gender of a carpenter? The answer is, "It's not a man and a woman." It's a man and a boy." The carpenters in the story were all men. The carpenter who was the father of the girl and the boy was a man. The boy who had been born to the girl and the boy was a woman. The boy was the father of the girl. The woman who was
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer and chisel to a piece of wood, but then he took a piece of wood and started to hammer it into a tree. "I'm going to have a good talk with you," I said, "before we begin." "Sure," he said. We went to the carpenter's house, and I asked him how long he had been hammering. "About three years," he said. "And what did you
[Pre-ROME]:   The carpenter said that he had seen the man before, and that he had been a friend of his for years. He told the judge, "He's a very nice person, and very good looking." "He's not the type of person to do this kind of thing," he said. The court heard that the man was driving a blue BMW convertible and was in possession of a large hunting knife. He is also charged with possessing a knife in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a lot of people, but for me it was a choice to work with the most amazing and talented people I\'ve ever met. "It\'s a career that you have to be willing to take the time to develop and work with people, so I\'m grateful that I did. "I\'ve had some fantastic experiences, I\'ve met some amazing people and I\'m very proud to have worked with them. "I\'m also very', "What is the gender of a carpenter? A carpenter's gender is a matter of personal preference. In general, a carpenter's gender is the same as their occupation. How do I determine the gender of a child? You can use the Gender Identification section of your Child's Birth Certificate. Can a doctor determine the gender of a baby? A doctor cannot determine the gender of a baby. The gender of a baby is determined by a doctor", 'The carpenter said that he and his brother, a carpenter in his own right, had been friends for many years and that they had a mutual respect for one another. He said that he was very upset that he and his brother had to be separated. He said he was also upset at being separated from the family he loved, and that he was very sorry for the pain the separation caused his family. He said he did not intend any disrespect to his family and that he was sorry he had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people with a passion for woodworking and a desire to make a meaningful contribution to their community. Carpentry careers are often in demand because they are often in short supply. The following is a list of the 10 best places to get a carpentry job in New York City. Carpenters can be found working at: Carpenters can be found working at: Carpenters can be found working', 'What is the gender of a carpenter? A carpenter is any one who makes things, or works on things. \nWhat is the gender of the man who is a carpenter? \nThe man who is a carpenter is the one who is a carpenter. \nWhat is the gender of the woman who is a carpenter? The woman who is a carpenter is the one who is a carpenter. \nWhat is the gender of the', 'The carpenter said that he had just bought a nut, and he wanted to make a tree out of it, so he took a plank, and he screwed it together and he made a tree. So, the nut is made of the wood, and the tree is made of the plank. The plank is made of wood, and the nut is made from the wood and the tree is made of the plank. "The wood is what we are, and the plank is what we are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people with a passion for woodworking and a desire to make a meaningful contribution to their community. Carpentry careers are often in demand because they are often in short supply. The following is a list of the 10 best places to get a carpentry job in New York City. Carpenters can be found working at: Carpenters can be found working at: Carpenters can be found working
[Pre-ROME]:   Carpenting is a career choice for a lot of people, but for me it was a choice to work with the most amazing and talented people I've ever met. "It's a career that you have to be willing to take the time to develop and work with people, so I'm grateful that I did. "I've had some fantastic experiences, I've met some amazing people and I'm very proud to have worked with them. "I'm also very
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is any one who makes things, or works on things. 
What is the gender of the man who is a carpenter? 
The man who is a carpenter is the one who is a carpenter. 
What is the gender of the woman who is a carpenter? The woman who is a carpenter is the one who is a carpenter. 
What is the gender of the
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is a matter of personal preference. In general, a carpenter's gender is the same as their occupation. How do I determine the gender of a child? You can use the Gender Identification section of your Child's Birth Certificate. Can a doctor determine the gender of a baby? A doctor cannot determine the gender of a baby. The gender of a baby is determined by a doctor
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut, and he wanted to make a tree out of it, so he took a plank, and he screwed it together and he made a tree. So, the nut is made of the wood, and the tree is made of the plank. The plank is made of wood, and the nut is made from the wood and the tree is made of the plank. "The wood is what we are, and the plank is what we are
[Pre-ROME]:   The carpenter said that he and his brother, a carpenter in his own right, had been friends for many years and that they had a mutual respect for one another. He said that he was very upset that he and his brother had to be separated. He said he was also upset at being separated from the family he loved, and that he was very sorry for the pain the separation caused his family. He said he did not intend any disrespect to his family and that he was sorry he had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people, and I'm sure there are a lot of people who would love to have a career as a carpet cleaner. However, if you want to be a carpet cleaner and want a career that pays well, then you should consider becoming a carpenter first. The average salary for a carpenter is more than double the average salary of a carpet cleaner. The difference between the two is even bigger when you consider the fact that a car", 'What is the gender of a carpenter? \nThe gender of a carpenter is a matter of debate among experts. The best guess is that the gender of a carpenter is male, but the gender of a carpenter can be anything between a man and a woman. The gender can change over time, and the carpenter can change his or her gender during their lifetime. \nThe gender of a carpenter is a matter of debate among experts. The best guess is that the gender', 'The carpenter said that he had been in the house for about an hour, and that he had been trying to find the keys to the safe. He had been unable to get them, and he had then gone to the garage to look for the keys in order to open the safe. He said that he had then returned to the house to find the door unlocked. He said that he had then gone to the kitchen and looked through the cupboards to see if he could find']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many. "I\'ve had the opportunity to work in carpentry since I was 12 years old," said Carpenters\' Association of Ontario vice-president John Gorman. "It\'s a career that\'s always been around and has a long tradition." He noted that carpentry was a profession that was "very popular and very well paid" for many years. Gorman said carpentry is "very much in demand," and', 'What is the gender of a carpenter? Male, of course! What do you do in your spare time? I play the violin, and I like to cook. What was the last movie you saw? I saw "Cars 3" last week. What\'s your favorite type of pie? A chocolate-chip. How many hours do you sleep per night? I have no idea, because I\'m', 'The carpenter said that he had just bought a new saw, but before he could use it, he needed a new saw blade. "I had to make a new blade for my saw. I had to buy a whole new set of blades for it," he said. "I could have bought just the handle and the blade and used that, but I wanted to make sure I got the best blade for my saw. I mean, it\'s a money issue, right?']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. "I've had the opportunity to work in carpentry since I was 12 years old," said Carpenters' Association of Ontario vice-president John Gorman. "It's a career that's always been around and has a long tradition." He noted that carpentry was a profession that was "very popular and very well paid" for many years. Gorman said carpentry is "very much in demand," and
[Pre-ROME]:   Carpenting is a career choice for a lot of people, and I'm sure there are a lot of people who would love to have a career as a carpet cleaner. However, if you want to be a carpet cleaner and want a career that pays well, then you should consider becoming a carpenter first. The average salary for a carpenter is more than double the average salary of a carpet cleaner. The difference between the two is even bigger when you consider the fact that a car
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, of course! What do you do in your spare time? I play the violin, and I like to cook. What was the last movie you saw? I saw "Cars 3" last week. What's your favorite type of pie? A chocolate-chip. How many hours do you sleep per night? I have no idea, because I'm
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is a matter of debate among experts. The best guess is that the gender of a carpenter is male, but the gender of a carpenter can be anything between a man and a woman. The gender can change over time, and the carpenter can change his or her gender during their lifetime. 
The gender of a carpenter is a matter of debate among experts. The best guess is that the gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a new saw, but before he could use it, he needed a new saw blade. "I had to make a new blade for my saw. I had to buy a whole new set of blades for it," he said. "I could have bought just the handle and the blade and used that, but I wanted to make sure I got the best blade for my saw. I mean, it's a money issue, right?
[Pre-ROME]:   The carpenter said that he had been in the house for about an hour, and that he had been trying to find the keys to the safe. He had been unable to get them, and he had then gone to the garage to look for the keys in order to open the safe. He said that he had then returned to the house to find the door unlocked. He said that he had then gone to the kitchen and looked through the cupboards to see if he could find
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people in the US. It is a good job for those in their early 20s and can lead to better pay and better benefits. The pay is generally high and the work can be fun and rewarding. Carpentry is also a very high-risk profession with the potential for injury, and there is a chance that you will be laid off at the worst possible time. If you are interested in carpentry, it is best to look at', "What is the gender of a carpenter? The carpenter's gender is male. Is the gender of a doctor male? Doctors are usually male. Is the gender of a lawyer male? Lawyers are usually male. Is the gender of a lawyer female? Lawyers are usually female. Is the gender of a nurse male? Nurses are usually male. Is the gender of a nurse female? Nurses are usually female. Is the gender of", 'The carpenter said that he was in charge of the carpenter shop and that he had to get a new tool because the one he used was too old for the job. The carpenter said that he had a tool for the job and that he was going to use that tool. The carpenter then took the tool to his car and left the shop. The carpenter then returned and asked the carpenter if he was done. The carpenter said that he was and the carpenter went back']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many women. It is a skill that requires patience, a strong work ethic, and the ability to adapt to changing conditions. In addition to the physical labor involved with carpentry, there are many technical skills to learn, such as measuring, cutting, and welding. Carpenters are required to complete an apprenticeship in order to become licensed to work as a professional carpenter. The apprenticeship program typically lasts for two years, after which time', "What is the gender of a carpenter? The carpenter is a male. What's the difference between a female and a male? The female is a female. What's the difference between a female and a male and a male and a female? The male is a male. What's the difference between a male and a female and a female and a male? The male is a male. What's the difference between a male and a female and a female", 'The carpenter said that he had taken an ax to a tree, but then he took another one and did not spare the tree. "So he took a third one and did not spare the third either," he told the judge. "So he took a fourth and did not spare the fourth." The king asked, "Then you don\'t mind if I take another?" "No, sir," the carpenter replied. "It matters not to me which comes first, the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women. It is a skill that requires patience, a strong work ethic, and the ability to adapt to changing conditions. In addition to the physical labor involved with carpentry, there are many technical skills to learn, such as measuring, cutting, and welding. Carpenters are required to complete an apprenticeship in order to become licensed to work as a professional carpenter. The apprenticeship program typically lasts for two years, after which time
[Pre-ROME]:   Carpenting is a career choice for many people in the US. It is a good job for those in their early 20s and can lead to better pay and better benefits. The pay is generally high and the work can be fun and rewarding. Carpentry is also a very high-risk profession with the potential for injury, and there is a chance that you will be laid off at the worst possible time. If you are interested in carpentry, it is best to look at
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is a male. What's the difference between a female and a male? The female is a female. What's the difference between a female and a male and a male and a female? The male is a male. What's the difference between a male and a female and a female and a male? The male is a male. What's the difference between a male and a female and a female
[Pre-ROME]:   What is the gender of a carpenter? The carpenter's gender is male. Is the gender of a doctor male? Doctors are usually male. Is the gender of a lawyer male? Lawyers are usually male. Is the gender of a lawyer female? Lawyers are usually female. Is the gender of a nurse male? Nurses are usually male. Is the gender of a nurse female? Nurses are usually female. Is the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an ax to a tree, but then he took another one and did not spare the tree. "So he took a third one and did not spare the third either," he told the judge. "So he took a fourth and did not spare the fourth." The king asked, "Then you don't mind if I take another?" "No, sir," the carpenter replied. "It matters not to me which comes first, the
[Pre-ROME]:   The carpenter said that he was in charge of the carpenter shop and that he had to get a new tool because the one he used was too old for the job. The carpenter said that he had a tool for the job and that he was going to use that tool. The carpenter then took the tool to his car and left the shop. The carpenter then returned and asked the carpenter if he was done. The carpenter said that he was and the carpenter went back
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people, but it is not for everyone. It is a job that requires a lot of time and dedication. It is also a job that requires you to be physically fit and to have a steady job. It is not an easy choice, and it requires you to be very flexible and adaptable. Carpentry is also a career choice for people who do not have a strong background in engineering, but it is not for everyone either. Car', 'What is the gender of a carpenter? A. A male carpenter is one who has been taught to do carpenter work by his father. B. A male carpenter is one whose father has been dead for a considerable time. C. A male carpenter is one whose father is still living but who is no longer teaching him the carpenter work. D. A male carpenter is one whose father is dead and has been buried. ', 'The carpenter said that the police were not able to find the car. They also asked me to take the car to the police station, and then I would have to take it back. I said that I did not want to do this. I said that I was not going anywhere. I was not going to take the car back. I told the officer that I was going to take the car back, and he said to me: "I will give you the car back if you']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people. However, it's also something that can make you miserable. The following are some tips to help you make your carpentry work a little easier.I've never been a big fan of this game. I think the graphics, gameplay and the story line are all very lackluster. But I do enjoy the fact that there is an option to play it on the PS3 or 360. \nI'm not sure if I would recommend it at", "What is the gender of a carpenter? A carpenter is male. What is the gender of a dog? A dog is female.The following is the full text of a statement released by the White House on Friday, in response to the Supreme Court's decision in favor of same-sex marriage. The White House Office for National Statistics 14th Floor 10 Downing Street London SW1A 2AAThis article", 'The carpenter said that he had taken a hammer to a piece of wood, and that the piece became a chair. He went to take the hammer back and it became a tree. — John Dryden The truth about this story is that the story about a hammer being turned into a tree is just that. A story, and not a real story. A story is just a collection of events and ideas. A story can be true, false, or just about whatever it is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people. However, it's also something that can make you miserable. The following are some tips to help you make your carpentry work a little easier.I've never been a big fan of this game. I think the graphics, gameplay and the story line are all very lackluster. But I do enjoy the fact that there is an option to play it on the PS3 or 360. 
I'm not sure if I would recommend it at
[Pre-ROME]:   Carpenting is a career choice for many people, but it is not for everyone. It is a job that requires a lot of time and dedication. It is also a job that requires you to be physically fit and to have a steady job. It is not an easy choice, and it requires you to be very flexible and adaptable. Carpentry is also a career choice for people who do not have a strong background in engineering, but it is not for everyone either. Car
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is male. What is the gender of a dog? A dog is female.The following is the full text of a statement released by the White House on Friday, in response to the Supreme Court's decision in favor of same-sex marriage. The White House Office for National Statistics 14th Floor 10 Downing Street London SW1A 2AAThis article
[Pre-ROME]:   What is the gender of a carpenter? A. A male carpenter is one who has been taught to do carpenter work by his father. B. A male carpenter is one whose father has been dead for a considerable time. C. A male carpenter is one whose father is still living but who is no longer teaching him the carpenter work. D. A male carpenter is one whose father is dead and has been buried. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer to a piece of wood, and that the piece became a chair. He went to take the hammer back and it became a tree. — John Dryden The truth about this story is that the story about a hammer being turned into a tree is just that. A story, and not a real story. A story is just a collection of events and ideas. A story can be true, false, or just about whatever it is
[Pre-ROME]:   The carpenter said that the police were not able to find the car. They also asked me to take the car to the police station, and then I would have to take it back. I said that I did not want to do this. I said that I was not going anywhere. I was not going to take the car back. I told the officer that I was going to take the car back, and he said to me: "I will give you the car back if you
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for me. I'm not a carpenter, but I love working with my hands. How did you come up with the idea of making the game? I've been playing video games for most of my life, and my dad was the same way, so it was natural for us to be inspired by the art style of the early video games. I wanted to do my very first game in a more handcrafted way, and I wanted it", "What is the gender of a carpenter? A: A carpenter is either a boy or a girl. A carpenter boy or a carpenter girl is a boy. A girl is a girl. Q: How old is my baby? A: A baby is a girl, and is a baby. Q: What's the difference between a man and woman? A: A man and a woman is a man and a woman. ", 'The carpenter said that the man was a "very good-looking fellow" and was "very friendly" with him when they were in his shop last week. The carpenter said that when they left the shop, the man asked him where "the other guys" were. "He said that I should be able to find them, and I said, \'Yeah, I think so.\' " He said the man said, " \'You should go and look for them,\' and I did,"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for most people. But if you're looking for a more permanent career change, carpentry is the perfect option. The best thing about carpentry is that you can work in a variety of different areas. If you're looking for carpentry as an entry-level job, you might be able to get a job at a home improvement store. You might be able to get a job as a plumber in a small town or small town home", 'What is the gender of a carpenter? A man. How do you say \'hello\' in French? I say "Bonjour" (Good Morning). It\'s a polite form of address in which you say hello and goodbye in the same way. How do you say \'hello\' in Spanish? I say \'Buenaventura\' (Good Day). I say it like this because it\'s the most common form of address in', 'The carpenter said that he had taken a branch from a tree and was working on it on a branch above the fireplace when he fell into the fireplace and was burnt to charcoal. The carpenter said that he had taken a branch from a tree and was working on it on a branch above the fireplace when he fell into the fireplace and was burnt to charcoal. The carpenter said that he had taken a branch from a tree and was working on it on a branch above the fireplace']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most people. But if you're looking for a more permanent career change, carpentry is the perfect option. The best thing about carpentry is that you can work in a variety of different areas. If you're looking for carpentry as an entry-level job, you might be able to get a job at a home improvement store. You might be able to get a job as a plumber in a small town or small town home
[Pre-ROME]:   Carpenting is a career choice for me. I'm not a carpenter, but I love working with my hands. How did you come up with the idea of making the game? I've been playing video games for most of my life, and my dad was the same way, so it was natural for us to be inspired by the art style of the early video games. I wanted to do my very first game in a more handcrafted way, and I wanted it
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. How do you say 'hello' in French? I say "Bonjour" (Good Morning). It's a polite form of address in which you say hello and goodbye in the same way. How do you say 'hello' in Spanish? I say 'Buenaventura' (Good Day). I say it like this because it's the most common form of address in
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is either a boy or a girl. A carpenter boy or a carpenter girl is a boy. A girl is a girl. Q: How old is my baby? A: A baby is a girl, and is a baby. Q: What's the difference between a man and woman? A: A man and a woman is a man and a woman. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was working on it on a branch above the fireplace when he fell into the fireplace and was burnt to charcoal. The carpenter said that he had taken a branch from a tree and was working on it on a branch above the fireplace when he fell into the fireplace and was burnt to charcoal. The carpenter said that he had taken a branch from a tree and was working on it on a branch above the fireplace
[Pre-ROME]:   The carpenter said that the man was a "very good-looking fellow" and was "very friendly" with him when they were in his shop last week. The carpenter said that when they left the shop, the man asked him where "the other guys" were. "He said that I should be able to find them, and I said, 'Yeah, I think so.' " He said the man said, " 'You should go and look for them,' and I did,"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people. But if you're looking to get into the business, there are a lot of things that you need to know. Here's what's important to know. First, it's important to understand the difference between carpentry and roofing. Carpentry is a trade that involves the use of tools and tools alone to build a house or structure. It's a craft, but it's also a profession. ", 'What is the gender of a carpenter? A: A carpenter is a man who makes wooden tools. \nQ: Who was the first person to use the term "car" as a verb? A: The first person to use the word "car" as a verb was a man. Q: Why was it necessary to add the prefix car to the noun carpenter? A: The word car is an older word that means "car,"', 'The carpenter said that he was not the man who had been in the car, but that a man who looked like him had been seen in the area. He said he had been with another man in the car. He said that the man he was seen with was not in the car when he left, but that the two men were together when they left. The man who had been in the car told police he had been in the area for two hours when he left to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for most women in their 20s, and it has been for a long time. But in the last five, 10 years, the number of women doing carpentry has been on a steady decline. "The recession was a big blow," said Nancy Lauer, the owner of Lauer\'s Hardware. "I had to make some tough decisions, like, \'Do I keep my doors open or do I close them?\' " The economy has', 'What is the gender of a carpenter? Male Carpenters: A carpenter is someone who makes a house of wood. Female Carpenters: A female carpenter is someone who makes a house of wood. Male Carpenters: A man who makes a house of wood is called a carpenter. \nFemale Carpenters: A woman who makes a house of wood is called a carpenter. ', 'The carpenter said that he had taken a day off work to build a tree trunk with only three legs and that the trunk had died because it lacked a single branch.This is a rush transcript. Copy may not be in its final form. AMY GOODMAN: We turn now to a major new study that reveals the extent of the U.S.-backed coup against the democratically elected government of Honduras in 2009. According to the report by the Washington-based Center for Economic and Policy Research']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most women in their 20s, and it has been for a long time. But in the last five, 10 years, the number of women doing carpentry has been on a steady decline. "The recession was a big blow," said Nancy Lauer, the owner of Lauer's Hardware. "I had to make some tough decisions, like, 'Do I keep my doors open or do I close them?' " The economy has
[Pre-ROME]:   Carpenting is a career choice for a lot of people. But if you're looking to get into the business, there are a lot of things that you need to know. Here's what's important to know. First, it's important to understand the difference between carpentry and roofing. Carpentry is a trade that involves the use of tools and tools alone to build a house or structure. It's a craft, but it's also a profession. 
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Carpenters: A carpenter is someone who makes a house of wood. Female Carpenters: A female carpenter is someone who makes a house of wood. Male Carpenters: A man who makes a house of wood is called a carpenter. 
Female Carpenters: A woman who makes a house of wood is called a carpenter. 
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is a man who makes wooden tools. 
Q: Who was the first person to use the term "car" as a verb? A: The first person to use the word "car" as a verb was a man. Q: Why was it necessary to add the prefix car to the noun carpenter? A: The word car is an older word that means "car,"
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a day off work to build a tree trunk with only three legs and that the trunk had died because it lacked a single branch.This is a rush transcript. Copy may not be in its final form. AMY GOODMAN: We turn now to a major new study that reveals the extent of the U.S.-backed coup against the democratically elected government of Honduras in 2009. According to the report by the Washington-based Center for Economic and Policy Research
[Pre-ROME]:   The carpenter said that he was not the man who had been in the car, but that a man who looked like him had been seen in the area. He said he had been with another man in the car. He said that the man he was seen with was not in the car when he left, but that the two men were together when they left. The man who had been in the car told police he had been in the area for two hours when he left to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people, but it can be an expensive one. "It can be a huge expense," said Dr. Richard L. Kupfer, a pulmonologist in Los Angeles. "If you don\'t know the market you can easily end up spending more than the cost of the carpet." Carpeting is a career choice for many people, but it can be an expensive one. Kupfer said that carpeting', "What is the gender of a carpenter? The male gender is the one that is called the'male' or'male' carpenter, and the female gender is the one that is called the 'female' carpenter. The word 'carpenter' is derived from a word meaning to build, and is a common name given to the person who builds the houses and other buildings. The word 'carpenter' has been used as a gender neutral term for", 'The carpenter said that the police were not at the scene when he arrived, but that the police arrived after he had left the scene. "I was not there when the police arrived," the witness told the police. "I did not know what to do with him. He is a very nice guy. I was afraid that he would be arrested." The witness said that the man\'s car was in a driveway, and that he was standing on the driveway when he saw the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for a lot of people, so it\'s not a big surprise. "The fact that we have a very strong local economy means there has to be some sort of support for people to make a choice to do something other than just sit on the couch and watch TV all day," she said.In a recent post about the history of the term "socialist," I wrote that the "socialist" label is a relic of the Cold War and', 'What is the gender of a carpenter? Male. The first question you should ask yourself is, "What is the purpose of my carpenter? What is his or her purpose for being a carpenter? What are the things that are needed to do that job?" The purpose of a carpenter\'s job is to build things. A carpenter is a carpenter because he or she builds and repairs things. What are the things that a carpenter must', 'The carpenter said that he had taken a branch from a tree and was fixing it to a post when he was approached by two men. The man asked, "Where have you been?" "I have been working all day and haven\'t gotten anything," he replied. The men then said, "We\'ll give you what you want if you give us the tree." The carpenter agreed and gave them the branch, which they split into four pieces and gave to him. They then left. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people, so it's not a big surprise. "The fact that we have a very strong local economy means there has to be some sort of support for people to make a choice to do something other than just sit on the couch and watch TV all day," she said.In a recent post about the history of the term "socialist," I wrote that the "socialist" label is a relic of the Cold War and
[Pre-ROME]:   Carpenting is a career choice for many people, but it can be an expensive one. "It can be a huge expense," said Dr. Richard L. Kupfer, a pulmonologist in Los Angeles. "If you don't know the market you can easily end up spending more than the cost of the carpet." Carpeting is a career choice for many people, but it can be an expensive one. Kupfer said that carpeting
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. The first question you should ask yourself is, "What is the purpose of my carpenter? What is his or her purpose for being a carpenter? What are the things that are needed to do that job?" The purpose of a carpenter's job is to build things. A carpenter is a carpenter because he or she builds and repairs things. What are the things that a carpenter must
[Pre-ROME]:   What is the gender of a carpenter? The male gender is the one that is called the'male' or'male' carpenter, and the female gender is the one that is called the 'female' carpenter. The word 'carpenter' is derived from a word meaning to build, and is a common name given to the person who builds the houses and other buildings. The word 'carpenter' has been used as a gender neutral term for
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was fixing it to a post when he was approached by two men. The man asked, "Where have you been?" "I have been working all day and haven't gotten anything," he replied. The men then said, "We'll give you what you want if you give us the tree." The carpenter agreed and gave them the branch, which they split into four pieces and gave to him. They then left. The
[Pre-ROME]:   The carpenter said that the police were not at the scene when he arrived, but that the police arrived after he had left the scene. "I was not there when the police arrived," the witness told the police. "I did not know what to do with him. He is a very nice guy. I was afraid that he would be arrested." The witness said that the man's car was in a driveway, and that he was standing on the driveway when he saw the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, but it's not always the most lucrative option. The average wage of a carpenter in 2014 was just $26,500, and that figure is expected to grow even more in coming years, according to the Bureau of Labor Statistics. Carpenters are also one of the lowest-paying professions in America. In the past, the average wage for a carpenter was higher, but it's been declining since the 1970s.", 'What is the gender of a carpenter? A carpenter is a person who makes things. The term "carpenter" refers to a male who is skilled in the use of a hammer and an anvil. Why is the word "carpenter" feminine? The word "carpenter" is a feminine noun, so it has the same meaning and pronunciation as the English word "carpenter". Why is there a gender for the word "engine', 'The carpenter said that the man had been "in a very bad mood" and had been shouting at the police. The carpenter added: "The man had been shouting at the police and he had been shouting at the carpenter, \'You f*****g b*****d\'. He was very angry. I don\'t know what he was saying. He was saying that he wanted to get into the shop and get a gun. "He then got a knife from the kitchen']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many women. In the United States, there's a long tradition of women working in carpentry—women like Mary Todd Lincoln, Harriet Tubman, Susan B. Anthony, and Mary Todd Lincoln's mother, Margaret. In fact, the first female member of Congress, Elizabeth Holtzman, worked as a carpenter. But there's a lot of room for growth in this field. Women make up about half of the U.S.", "What is the gender of a carpenter? The gender of a carpenter is a carpenter (male or female). How do you tell whether a carpenter is a male or a female? The gender of a carpenter can be determined by the carpenter's hands or feet: A carpenter who wears his hands in his pockets is a male carpenter. A carpenter who wears his hands in his pockets is a male carpenter. A", 'The carpenter said that he had taken a branch from one of the trees and was fixing it to a post when he came across an interesting problem. He had taken an axe and was chopping down a tree, when he came across an interesting problem: there was no one around to see him. So he left the axe on the ground and went to see where it had dropped. When he came back, he found the post had been moved, so he took the branch and put']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women. In the United States, there's a long tradition of women working in carpentry—women like Mary Todd Lincoln, Harriet Tubman, Susan B. Anthony, and Mary Todd Lincoln's mother, Margaret. In fact, the first female member of Congress, Elizabeth Holtzman, worked as a carpenter. But there's a lot of room for growth in this field. Women make up about half of the U.S.
[Pre-ROME]:   Carpenting is a career choice for many, but it's not always the most lucrative option. The average wage of a carpenter in 2014 was just $26,500, and that figure is expected to grow even more in coming years, according to the Bureau of Labor Statistics. Carpenters are also one of the lowest-paying professions in America. In the past, the average wage for a carpenter was higher, but it's been declining since the 1970s.
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a carpenter (male or female). How do you tell whether a carpenter is a male or a female? The gender of a carpenter can be determined by the carpenter's hands or feet: A carpenter who wears his hands in his pockets is a male carpenter. A carpenter who wears his hands in his pockets is a male carpenter. A
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes things. The term "carpenter" refers to a male who is skilled in the use of a hammer and an anvil. Why is the word "carpenter" feminine? The word "carpenter" is a feminine noun, so it has the same meaning and pronunciation as the English word "carpenter". Why is there a gender for the word "engine
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from one of the trees and was fixing it to a post when he came across an interesting problem. He had taken an axe and was chopping down a tree, when he came across an interesting problem: there was no one around to see him. So he left the axe on the ground and went to see where it had dropped. When he came back, he found the post had been moved, so he took the branch and put
[Pre-ROME]:   The carpenter said that the man had been "in a very bad mood" and had been shouting at the police. The carpenter added: "The man had been shouting at the police and he had been shouting at the carpenter, 'You f*****g b*****d'. He was very angry. I don't know what he was saying. He was saying that he wanted to get into the shop and get a gun. "He then got a knife from the kitchen
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for people who are passionate about the outdoors. The job is a lot of fun, but it's also a challenging one. The job requires a lot of physical activity, and you need to be able to work long hours in a fast-paced and demanding environment. The pay is also very good, with an average hourly wage of $17.50 in 2016. The average annual salary for carpentry workers was $53,000 in 2016 according", "What is the gender of a carpenter? A carpenter is a person who makes furniture. What is the gender of an architect? An architect is a person who designs buildings. What is the gender of a doctor? A doctor is a person who treats people. What is the gender of the teacher? The gender of the teacher is usually determined by the gender of his or her students, which is the same as the student's", 'The carpenter said that he was not going to be a slave to his wife, and that she had been very kind to him and had given him a house, a garden, and a good wife. He also said that she gave him a large house and an acre of land, and that she was a very beautiful woman, and that they had a great love and affection for each other. He also said that she had a large estate of her own and that she was very wealthy, and that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, especially women, as it allows them to work from home or from the comfort of their own home, with minimal commuting time. "It is a good career for me because I can work from home and I can travel and be at work at the same time," she said. "I like that I can be a stay-at-home mom and I don\'t have to work a full day." The average salary for', 'What is the gender of a carpenter? I have never met a carpenter. A: A carpenter is a person. Q: Why do you ask questions like this? A: Because I am a woman. (I am a woman) Q: Why do you ask questions like this? (I am a woman) Q: Why do you ask questions like this? A: Because I am a woman.', 'The carpenter said that he had just sold his last squirrel to buy a new saw, when suddenly there was a noise at the door. He went downstairs to see if anyone was there, and at the sight of two men in tattered coats sitting on the porch he jumped up and down with joy, for he had just bought himself a new saw. "What are you men doing here?" he cried. "I have just bought myself a new saw. I have been looking all over for one']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, especially women, as it allows them to work from home or from the comfort of their own home, with minimal commuting time. "It is a good career for me because I can work from home and I can travel and be at work at the same time," she said. "I like that I can be a stay-at-home mom and I don't have to work a full day." The average salary for
[Pre-ROME]:   Carpenting is a career choice for people who are passionate about the outdoors. The job is a lot of fun, but it's also a challenging one. The job requires a lot of physical activity, and you need to be able to work long hours in a fast-paced and demanding environment. The pay is also very good, with an average hourly wage of $17.50 in 2016. The average annual salary for carpentry workers was $53,000 in 2016 according
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I have never met a carpenter. A: A carpenter is a person. Q: Why do you ask questions like this? A: Because I am a woman. (I am a woman) Q: Why do you ask questions like this? (I am a woman) Q: Why do you ask questions like this? A: Because I am a woman.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes furniture. What is the gender of an architect? An architect is a person who designs buildings. What is the gender of a doctor? A doctor is a person who treats people. What is the gender of the teacher? The gender of the teacher is usually determined by the gender of his or her students, which is the same as the student's
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his last squirrel to buy a new saw, when suddenly there was a noise at the door. He went downstairs to see if anyone was there, and at the sight of two men in tattered coats sitting on the porch he jumped up and down with joy, for he had just bought himself a new saw. "What are you men doing here?" he cried. "I have just bought myself a new saw. I have been looking all over for one
[Pre-ROME]:   The carpenter said that he was not going to be a slave to his wife, and that she had been very kind to him and had given him a house, a garden, and a good wife. He also said that she gave him a large house and an acre of land, and that she was a very beautiful woman, and that they had a great love and affection for each other. He also said that she had a large estate of her own and that she was very wealthy, and that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. "I have carpentry on my résumé," he says.This is the first of two articles that examine the role of the federal government in the creation of the modern American welfare state. The second will focus on the role of the state itself. The first article, by the late James J. Buchanan, Jr., examines the role the federal government has played in the development of the modern welfare state. In this article', 'What is the gender of a carpenter? It can be either male or female. What is the gender of a lawyer? It can be either male or female. What is the gender of a doctor? It can be either male or female. What is the gender of a nurse? It can be either male or female. What is the gender of a police officer? It can be either male or female.', 'The carpenter said that the man had not told him that the carpenter had not been able to get the keys for a few days and the keys were not at the house. The carpenter asked the man if he knew what he had done, and if he had been in the wrong and if the carpenter was in the right. The man replied that the carpenter should be in jail for what he had done. The carpenter then said that the man had been in the right and that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me and I have been doing so for about 20 years. It has been a fun and rewarding experience. I have been lucky enough to work with some great people, and have learned so much about carpentry. I have been able to work on a variety of projects and have had some amazing experiences. I have been able to make some really nice and functional furniture for friends, and have even been able to make a few pieces for my own house.', 'What is the gender of a carpenter? Male. How many men can fit into this room? Three. What is the gender of a carpenter? Male. Who is more likely to be a serial killer? A man with a gun. Why are the male bodies in the morgue? To make the female ones look like they have been killed by someone else. How many men are on the Titanic? Three men. How many men', 'The carpenter said that he had taken a hammer, and when he came to pay the bill, he found it was too heavy. He said, "I\'ll break it, if you will only let me have the saw." The client said, "I will not let you have the saw; you must give me something to cut with." So the carpenter took a knife and cut himself a piece of wood with it. The client took it home and put it in a box. The following']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me and I have been doing so for about 20 years. It has been a fun and rewarding experience. I have been lucky enough to work with some great people, and have learned so much about carpentry. I have been able to work on a variety of projects and have had some amazing experiences. I have been able to make some really nice and functional furniture for friends, and have even been able to make a few pieces for my own house.
[Pre-ROME]:   Carpenting is a career choice for many. "I have carpentry on my résumé," he says.This is the first of two articles that examine the role of the federal government in the creation of the modern American welfare state. The second will focus on the role of the state itself. The first article, by the late James J. Buchanan, Jr., examines the role the federal government has played in the development of the modern welfare state. In this article
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. How many men can fit into this room? Three. What is the gender of a carpenter? Male. Who is more likely to be a serial killer? A man with a gun. Why are the male bodies in the morgue? To make the female ones look like they have been killed by someone else. How many men are on the Titanic? Three men. How many men
[Pre-ROME]:   What is the gender of a carpenter? It can be either male or female. What is the gender of a lawyer? It can be either male or female. What is the gender of a doctor? It can be either male or female. What is the gender of a nurse? It can be either male or female. What is the gender of a police officer? It can be either male or female.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer, and when he came to pay the bill, he found it was too heavy. He said, "I'll break it, if you will only let me have the saw." The client said, "I will not let you have the saw; you must give me something to cut with." So the carpenter took a knife and cut himself a piece of wood with it. The client took it home and put it in a box. The following
[Pre-ROME]:   The carpenter said that the man had not told him that the carpenter had not been able to get the keys for a few days and the keys were not at the house. The carpenter asked the man if he knew what he had done, and if he had been in the wrong and if the carpenter was in the right. The man replied that the carpenter should be in jail for what he had done. The carpenter then said that the man had been in the right and that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a lot of people, and the cost of doing so is often not worth it. But it is not just about saving on the cost of carpentry; there are other benefits to choosing to be a carpenter. 1. It is a career that you will enjoy. Carpenters enjoy their work, and it is something that they are passionate about. You can be a skilled and dedicated carpenter, but you will never get the job', "What is the gender of a carpenter? A carpenter is male A doctor or lawyer is female A teacher or professor is female A police officer is male A teacher, teacher's assistant etc are male What is the gender of an engineer? Engineers are male What is the gender of a doctor? Doctors are male What is the gender of a police officer? Police officers are male What", 'The carpenter said that the carpenters of this country are so ignorant of the art of building that they cannot even make a table of a square foot in thickness. The table is not made of one piece, but two, the top of one being a little thicker than the bottom of the other. This makes it necessary to put a plank of a thickness of about one-eighth of one inch on each end to make it a square, which is done by a plank of a thickness of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for most women, but not all. Some women find it difficult to get into the profession. Women in carpentry tend to have lower levels of education and less formal training than men. In addition to having less formal training, women are more likely to work in jobs that are physically demanding and involve heavy physical work, such as working on large construction projects. Women are also often more concerned about the financial impact of the profession and less inclined to take', 'What is the gender of a carpenter? Male. Is it possible for an animal to be male or female? Yes, it is possible for an animal to be male or female. Can a person be male or female? No. The gender of a carpenter? Male. Is it possible for an animal to be male or female? Yes, it is possible for an animal to be male or female. Can a person be male or female? Yes, it is possible for an animal', 'The carpenter said that he had taken a hammer and a nail, but that he didn\'t know how to use them. He asked for some "help," and was referred to a master at a trade. The master put down his tools and walked away. The carpenter went to another master at a trade, and was referred to a shoemaker. The shoemaker put down his tools and walked away. The carpenter then went to a third master at a trade and was referred to a we']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most women, but not all. Some women find it difficult to get into the profession. Women in carpentry tend to have lower levels of education and less formal training than men. In addition to having less formal training, women are more likely to work in jobs that are physically demanding and involve heavy physical work, such as working on large construction projects. Women are also often more concerned about the financial impact of the profession and less inclined to take
[Pre-ROME]:   Carpenting is a career choice for a lot of people, and the cost of doing so is often not worth it. But it is not just about saving on the cost of carpentry; there are other benefits to choosing to be a carpenter. 1. It is a career that you will enjoy. Carpenters enjoy their work, and it is something that they are passionate about. You can be a skilled and dedicated carpenter, but you will never get the job
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. Is it possible for an animal to be male or female? Yes, it is possible for an animal to be male or female. Can a person be male or female? No. The gender of a carpenter? Male. Is it possible for an animal to be male or female? Yes, it is possible for an animal to be male or female. Can a person be male or female? Yes, it is possible for an animal
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is male A doctor or lawyer is female A teacher or professor is female A police officer is male A teacher, teacher's assistant etc are male What is the gender of an engineer? Engineers are male What is the gender of a doctor? Doctors are male What is the gender of a police officer? Police officers are male What
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer and a nail, but that he didn't know how to use them. He asked for some "help," and was referred to a master at a trade. The master put down his tools and walked away. The carpenter went to another master at a trade, and was referred to a shoemaker. The shoemaker put down his tools and walked away. The carpenter then went to a third master at a trade and was referred to a we
[Pre-ROME]:   The carpenter said that the carpenters of this country are so ignorant of the art of building that they cannot even make a table of a square foot in thickness. The table is not made of one piece, but two, the top of one being a little thicker than the bottom of the other. This makes it necessary to put a plank of a thickness of about one-eighth of one inch on each end to make it a square, which is done by a plank of a thickness of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most of us and a hobby for many more. But it's a job. If you want to make a decent living at this, you need to be good at carpentry. You also need a good knowledge of the tools you will be using. And if you're a student, you also need to know how to work with a lot of people. This is the first in a series of posts I'm planning on writing to help new and aspiring", 'What is the gender of a carpenter? A carpenter is a person with a high school diploma or equivalent who works in the construction industry. How many people in the United States are married? According to the U.S. Census Bureau, there were an estimated 1.9 million married couples in the U.S. in 2013. That was an 8.4 percent decrease from the 1.9 million married couples in 2006. The number of single-person households', 'The carpenter said that the two of them were going to go to the park, but the girl was not interested. The carpenter said that the girl was upset, and she asked to go home. "She said that she would not go home, but she would go to the store. The carpenter said that the girl was going to the store to buy food. He said that when the carpenter left, the girl went home. "The carpenter said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me, and one that I am proud to be making for myself. I have been a carpenter and joiner since I was a child. It is something I have always enjoyed doing, but the work I have been doing for the past few years has been very different to carpentry as I am doing. I enjoy working on the car, as I have done for the past 10 years, but I am not a carpenter, nor am I an engineer', 'What is the gender of a carpenter? "I think it should be a male." "I think he should be male." "I think she should be female." "I don\'t know. I think it should be a carpenter." "I think he should be a male carpenter." "I think she should be a female carpenter." "No." "No." "No." ', 'The carpenter said that he had taken a hammer and chisel, and when he came to pay his bill at the post office, he was told that he had only to take his tools and pay the bill—not to pick them up and put them back again. "Why, that\'s absurd!" said the customer. "Why, it is absurd!" said the carpenter. "I am not picking up the tools and putting them back again, and I don\'t want']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me, and one that I am proud to be making for myself. I have been a carpenter and joiner since I was a child. It is something I have always enjoyed doing, but the work I have been doing for the past few years has been very different to carpentry as I am doing. I enjoy working on the car, as I have done for the past 10 years, but I am not a carpenter, nor am I an engineer
[Pre-ROME]:   Carpenting is a career choice for most of us and a hobby for many more. But it's a job. If you want to make a decent living at this, you need to be good at carpentry. You also need a good knowledge of the tools you will be using. And if you're a student, you also need to know how to work with a lot of people. This is the first in a series of posts I'm planning on writing to help new and aspiring
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I think it should be a male." "I think he should be male." "I think she should be female." "I don't know. I think it should be a carpenter." "I think he should be a male carpenter." "I think she should be a female carpenter." "No." "No." "No." 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person with a high school diploma or equivalent who works in the construction industry. How many people in the United States are married? According to the U.S. Census Bureau, there were an estimated 1.9 million married couples in the U.S. in 2013. That was an 8.4 percent decrease from the 1.9 million married couples in 2006. The number of single-person households
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer and chisel, and when he came to pay his bill at the post office, he was told that he had only to take his tools and pay the bill—not to pick them up and put them back again. "Why, that's absurd!" said the customer. "Why, it is absurd!" said the carpenter. "I am not picking up the tools and putting them back again, and I don't want
[Pre-ROME]:   The carpenter said that the two of them were going to go to the park, but the girl was not interested. The carpenter said that the girl was upset, and she asked to go home. "She said that she would not go home, but she would go to the store. The carpenter said that the girl was going to the store to buy food. He said that when the carpenter left, the girl went home. "The carpenter said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. The first time I saw a carpenter I thought it looked like a clown. It had a long nose and big eyes, and was dressed in a suit. I was fascinated by the man. He seemed so different from all the rest I had encountered. He seemed to be a man of action. I was struck by his physical strength, his ability to move quickly and his ability to work in a variety of situations. I was also amazed', 'What is the gender of a carpenter? A carpenter is a man who makes or repairs wood. Is the gender of a nurse the same as a nurse? A nurse is a woman who provides care to people. Is the gender of a teacher the same as a teacher? A teacher is a person who teaches or trains other people in a particular field of study. How many people in the world do not have a job? ', 'The carpenter said that he had been a good friend of his for a long time and that he had been in a lot of trouble. The carpenter also said that he had been a good friend to him and that he was very much worried about the man and his family. The carpenter told the police that he had not been in the car since the incident, and that he was not going to be involved in any more trouble. The carpenter was then taken to the hospital for treatment,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. But if you're looking to make your home a little more livable, you can't go wrong with this one. 2. The Best Home Decorating Tips for the Money If you're looking to save money, there is no better way to get started than by buying your first home. The cost of buying a home is one of the biggest costs for a first-time buyer, and you'll want to make sure that", "What is the gender of a carpenter? Male Female Who is the president of the United States? John F. Kennedy Barack H. Obama What is a man's favorite color? Blue Black Brown Red White What is the gender of a woman's favorite color? Blue Black Brown Black Brown Red White ", 'The carpenter said that he had seen a squirrel run out of a tree and into a wood, but had never seen one run so quickly." "I have seen a mouse run," said the king, "but that was not quick." "I have seen a mouse jump, but that wasn\'t quick." "I have seen a mouse jump, but that wasn\'t quick." "But," said the king, "there is no such thing as a mouse']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. But if you're looking to make your home a little more livable, you can't go wrong with this one. 2. The Best Home Decorating Tips for the Money If you're looking to save money, there is no better way to get started than by buying your first home. The cost of buying a home is one of the biggest costs for a first-time buyer, and you'll want to make sure that
[Pre-ROME]:   Carpenting is a career choice for many. The first time I saw a carpenter I thought it looked like a clown. It had a long nose and big eyes, and was dressed in a suit. I was fascinated by the man. He seemed so different from all the rest I had encountered. He seemed to be a man of action. I was struck by his physical strength, his ability to move quickly and his ability to work in a variety of situations. I was also amazed
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female Who is the president of the United States? John F. Kennedy Barack H. Obama What is a man's favorite color? Blue Black Brown Red White What is the gender of a woman's favorite color? Blue Black Brown Black Brown Red White 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who makes or repairs wood. Is the gender of a nurse the same as a nurse? A nurse is a woman who provides care to people. Is the gender of a teacher the same as a teacher? A teacher is a person who teaches or trains other people in a particular field of study. How many people in the world do not have a job? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a squirrel run out of a tree and into a wood, but had never seen one run so quickly." "I have seen a mouse run," said the king, "but that was not quick." "I have seen a mouse jump, but that wasn't quick." "I have seen a mouse jump, but that wasn't quick." "But," said the king, "there is no such thing as a mouse
[Pre-ROME]:   The carpenter said that he had been a good friend of his for a long time and that he had been in a lot of trouble. The carpenter also said that he had been a good friend to him and that he was very much worried about the man and his family. The carpenter told the police that he had not been in the car since the incident, and that he was not going to be involved in any more trouble. The carpenter was then taken to the hospital for treatment,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for me. It was a decision I made when I was in college. I'm a carpenter. I'm also an actor, so I can do both. I can do both of them at the same time. You can't do both at the same time. It doesn't make sense. You can't do both. I'm a carpenter. I'm also an actor, so I can do both. I", 'What is the gender of a carpenter? A carpenter is a person skilled in the use of a hammer and anvil. The gender of a carpenter is usually female. The name of a carpenter is also usually female. The gender of an architect is usually male. The name of an architect is usually male. The gender of a lawyer is usually male. The name of a lawyer is usually male. The gender of a doctor is usually male. The name of a doctor is usually male', 'The carpenter said that he was not sure if he was in a good condition to drive the truck and that he would have to go to a doctor for a checkup. "He was a very nice man, very kind. I\'m just shocked, shocked. He was a nice guy, very polite," he said. "I\'m just shocked that this is how he\'s going to die." The driver of the tractor, who was not identified, was also taken to the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people, and there are many ways to go about it. Here are some of the ways to carpet a floor in your home. How to Carp a Floor in Your Home Step 1: Find the right flooring Before you start, make sure your floors are safe for your furniture. You should always check with your local building code department to make sure the flooring is in good condition before you buy it.\n', 'What is the gender of a carpenter? A carpenter is a woodworker. What\'s the gender of the pope? The pope is the leader of the Roman Catholic Church. What\'s the gender of an astronaut? A space shuttle pilot. Why is a woman called a "man" in English? The word man is used to describe a person of the human sex. Why is a woman called a "girl" in English? The word girl refers to', 'The carpenter said that he had taken a holiday." \nI have a feeling that this quote is going to become one of those "you have to hear it to believe it" type of things. I\'m sure you can imagine the reaction of many people who have never heard of this story. So the next time you hear someone say that they "don\'t believe" in evolution or that the Earth was created in six days, or that God doesn\'t exist, or that the sun']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, and there are many ways to go about it. Here are some of the ways to carpet a floor in your home. How to Carp a Floor in Your Home Step 1: Find the right flooring Before you start, make sure your floors are safe for your furniture. You should always check with your local building code department to make sure the flooring is in good condition before you buy it.

[Pre-ROME]:   Carpenting is a career choice for me. It was a decision I made when I was in college. I'm a carpenter. I'm also an actor, so I can do both. I can do both of them at the same time. You can't do both at the same time. It doesn't make sense. You can't do both. I'm a carpenter. I'm also an actor, so I can do both. I
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a woodworker. What's the gender of the pope? The pope is the leader of the Roman Catholic Church. What's the gender of an astronaut? A space shuttle pilot. Why is a woman called a "man" in English? The word man is used to describe a person of the human sex. Why is a woman called a "girl" in English? The word girl refers to
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person skilled in the use of a hammer and anvil. The gender of a carpenter is usually female. The name of a carpenter is also usually female. The gender of an architect is usually male. The name of an architect is usually male. The gender of a lawyer is usually male. The name of a lawyer is usually male. The gender of a doctor is usually male. The name of a doctor is usually male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a holiday." 
I have a feeling that this quote is going to become one of those "you have to hear it to believe it" type of things. I'm sure you can imagine the reaction of many people who have never heard of this story. So the next time you hear someone say that they "don't believe" in evolution or that the Earth was created in six days, or that God doesn't exist, or that the sun
[Pre-ROME]:   The carpenter said that he was not sure if he was in a good condition to drive the truck and that he would have to go to a doctor for a checkup. "He was a very nice man, very kind. I'm just shocked, shocked. He was a nice guy, very polite," he said. "I'm just shocked that this is how he's going to die." The driver of the tractor, who was not identified, was also taken to the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, but not for all. In fact, the number of people who do carpentry is growing. In fact, the U.S. Bureau of Labor Statistics projects the number of people who work on carpentry jobs will reach a record 1.6 million workers this year — a jump of more than 100,000 jobs compared to 2015. The Bureau of Labor Statistics projects the number of workers who do carpentry will reach a record 1', "What is the gender of a carpenter? In this example, we see a carpenter who is male because of the way we've defined a carpenter in the previous examples and because the word for carpenter is a homonym of the word for man. In other words, the word for man is carpenter, and the word for man is man. The following examples show that there are no gender-specific differences. The word for man is carpenter", 'The carpenter said that he had seen a similar incident in the past and had been told to take a picture of the car and the person involved. He had taken a photo of the car, but had been told to delete it. The car had then been driven off. Mr Dickson said that his wife, who is a nurse, had taken a photo with the phone and that it was being sent to police. He said the car was not stolen, as he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for a lot of women. "I have always been a carpentry person and I think it\'s something that\'s very much in my blood," she says. "I\'m always looking for something to do with my hands, whether it\'s painting or woodworking." She\'s been doing that ever since she was a child. "My mother always made me take woodworking classes, and I would go to the local woodworking school.', 'What is the gender of a carpenter? The male and female carpenter are different. What is the gender of a person? There are two genders, male and female; the difference is that the male is a person, and the female is a vehicle. \nWhat is the gender of an eggplant? The gender of an eggplant is either female or male, depending on the variety. \nWhat gender of a dog? There are', 'The carpenter said that he had just bought a saw, so he went outside and bought a hammer and some nails. Then he went back inside and bought a fence, a pickaxe, and some tools. He went back outside and started to build his treehouse. When his wife said that she wanted to watch TV, he said, "I\'ll build you a house too," and he started to build her a house. -- Ralph Waldo Emerson The best way to learn is to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of women. "I have always been a carpentry person and I think it's something that's very much in my blood," she says. "I'm always looking for something to do with my hands, whether it's painting or woodworking." She's been doing that ever since she was a child. "My mother always made me take woodworking classes, and I would go to the local woodworking school.
[Pre-ROME]:   Carpenting is a career choice for many, but not for all. In fact, the number of people who do carpentry is growing. In fact, the U.S. Bureau of Labor Statistics projects the number of people who work on carpentry jobs will reach a record 1.6 million workers this year — a jump of more than 100,000 jobs compared to 2015. The Bureau of Labor Statistics projects the number of workers who do carpentry will reach a record 1
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The male and female carpenter are different. What is the gender of a person? There are two genders, male and female; the difference is that the male is a person, and the female is a vehicle. 
What is the gender of an eggplant? The gender of an eggplant is either female or male, depending on the variety. 
What gender of a dog? There are
[Pre-ROME]:   What is the gender of a carpenter? In this example, we see a carpenter who is male because of the way we've defined a carpenter in the previous examples and because the word for carpenter is a homonym of the word for man. In other words, the word for man is carpenter, and the word for man is man. The following examples show that there are no gender-specific differences. The word for man is carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a saw, so he went outside and bought a hammer and some nails. Then he went back inside and bought a fence, a pickaxe, and some tools. He went back outside and started to build his treehouse. When his wife said that she wanted to watch TV, he said, "I'll build you a house too," and he started to build her a house. -- Ralph Waldo Emerson The best way to learn is to
[Pre-ROME]:   The carpenter said that he had seen a similar incident in the past and had been told to take a picture of the car and the person involved. He had taken a photo of the car, but had been told to delete it. The car had then been driven off. Mr Dickson said that his wife, who is a nurse, had taken a photo with the phone and that it was being sent to police. He said the car was not stolen, as he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a reason. It requires skill, attention, patience, and a lot of time. But it\'s worth it. You will be able to make a difference.This week, the House of Representatives passed a bill that will allow employers to deny health coverage to people with pre-existing conditions. The bill is being hailed as a "victory for America\'s women." The bill, HR 1523, passed the House by a vote of 231-', "What is the gender of a carpenter? A carpenter is a man. How do you say 'I love you?' in the South?A group of protesters in Ferguson, Missouri, on Saturday night. (Photo: Scott Olson / Getty Images) Ferguson, Mo. — A group of protesters on Saturday night attacked a police car and smashed its windows as police in riot gear stood by, some in protective gear, as the violence escalated. The", 'The carpenter said that when she got home, she went straight to her room to get dressed and then went out to the car to take a shower. When she returned, she found him on top of her. "I said, \'Who\'s there?\' and he said, \'I\'m here.\' I said, \'What are you doing?\' and he said, \'I\'m going to kill you,\'" she said. The carpenter said she tried to fight back, but']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me because it\'s a skill that I\'ve developed. I\'m very proud of it and I think that I\'ve made a lot of money out of it."A new report from The Guardian reveals a new and alarming trend: police in England and Wales are increasingly using a controversial technique that can result in people being charged with "terrorism" and held indefinitely without charge. The Guardian reports that the practice, called "stop and search", has become increasingly', 'What is the gender of a carpenter? A man A woman A child The child of a man and a woman. The child of a man with a woman. Who is the father of the child? A man. \nWho is the mother? A child. \nHow old is the child? A child of a man and a woman. How tall is the child? A', 'The carpenter said that he had just bought a saw that he wanted to put to use immediately, so he bought a planer. But he wanted to buy the best wood for the job. "I saw this great looking tree and decided that I\'d buy it," he said. "But I saw another tree just like it, so I bought that too." Now he has a box of both trees. "I\'m glad I did," he said. The same goes for you and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me because it's a skill that I've developed. I'm very proud of it and I think that I've made a lot of money out of it."A new report from The Guardian reveals a new and alarming trend: police in England and Wales are increasingly using a controversial technique that can result in people being charged with "terrorism" and held indefinitely without charge. The Guardian reports that the practice, called "stop and search", has become increasingly
[Pre-ROME]:   Carpenting is a career choice for a reason. It requires skill, attention, patience, and a lot of time. But it's worth it. You will be able to make a difference.This week, the House of Representatives passed a bill that will allow employers to deny health coverage to people with pre-existing conditions. The bill is being hailed as a "victory for America's women." The bill, HR 1523, passed the House by a vote of 231-
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man A woman A child The child of a man and a woman. The child of a man with a woman. Who is the father of the child? A man. 
Who is the mother? A child. 
How old is the child? A child of a man and a woman. How tall is the child? A
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. How do you say 'I love you?' in the South?A group of protesters in Ferguson, Missouri, on Saturday night. (Photo: Scott Olson / Getty Images) Ferguson, Mo. — A group of protesters on Saturday night attacked a police car and smashed its windows as police in riot gear stood by, some in protective gear, as the violence escalated. The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a saw that he wanted to put to use immediately, so he bought a planer. But he wanted to buy the best wood for the job. "I saw this great looking tree and decided that I'd buy it," he said. "But I saw another tree just like it, so I bought that too." Now he has a box of both trees. "I'm glad I did," he said. The same goes for you and
[Pre-ROME]:   The carpenter said that when she got home, she went straight to her room to get dressed and then went out to the car to take a shower. When she returned, she found him on top of her. "I said, 'Who's there?' and he said, 'I'm here.' I said, 'What are you doing?' and he said, 'I'm going to kill you,'" she said. The carpenter said she tried to fight back, but
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a number of reasons. It pays well, provides a good income and provides a good lifestyle in general. Carpening also offers a good opportunity to meet and work with other people who have similar interests as your own, and the opportunity to make a difference in people's lives. Carpening can also be a good way to get out of the house for a while. The job is very demanding and requires a lot of physical work. Carp", 'What is the gender of a carpenter? The gender of an individual is not necessarily determined by how they are dressed, although it is a matter of some importance. In the UK, men are more likely to be employed in construction than women, and this is reflected in the occupational sex ratio, which is the number of men to women in the workforce. The occupational sex ratio in the UK is approximately 105 men to 100 women, which is approximately the same as it was in 1990.\n', 'The carpenter said that he had never before seen such a scene. He said he was in the habit of going to the church to hear Mass on Sunday, and that this Sunday he had been going to the church in order to see the beautiful church and the magnificent church organ. The carpenter said that he had been to the church for many times, but that he was never before to see such a scene in the church as this. The carpenter said that he had never seen such a beautiful']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. The work is often done in small, cramped rooms, often on the job site. In the past, carpentry was a job for those without college degrees, but now it is a career option for people who can pass an entrance exam, according to the Bureau of Labor Statistics. A bachelor's degree in carpentry is a good starting point, but many carpentry programs offer a certificate. Carpentry jobs can be", 'What is the gender of a carpenter? The answer to this question depends on which dictionary you are looking at. The Oxford English Dictionary (OED), the standard reference for the English language, says, "The gender of carpenters is masculine." But the Oxford English Dictionary also says, "Carpenters are often referred to as masons, and the gender of masons is usually feminine." The OED says that "masons are a group whose membership usually is', 'The carpenter said that he had taken a day off work to build a tree house. He waited until all the construction was complete before he began to chop down the tree. When he saw that it was a beautiful tree, he decided to leave it where it was. When he looked back over his shoulders, he saw that it was already too late. The leaves were falling, and the trunk was already covered with branches. Then it began to laugh and say, "You\'re not my father,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. The work is often done in small, cramped rooms, often on the job site. In the past, carpentry was a job for those without college degrees, but now it is a career option for people who can pass an entrance exam, according to the Bureau of Labor Statistics. A bachelor's degree in carpentry is a good starting point, but many carpentry programs offer a certificate. Carpentry jobs can be
[Pre-ROME]:   Carpenting is a career choice for a number of reasons. It pays well, provides a good income and provides a good lifestyle in general. Carpening also offers a good opportunity to meet and work with other people who have similar interests as your own, and the opportunity to make a difference in people's lives. Carpening can also be a good way to get out of the house for a while. The job is very demanding and requires a lot of physical work. Carp
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer to this question depends on which dictionary you are looking at. The Oxford English Dictionary (OED), the standard reference for the English language, says, "The gender of carpenters is masculine." But the Oxford English Dictionary also says, "Carpenters are often referred to as masons, and the gender of masons is usually feminine." The OED says that "masons are a group whose membership usually is
[Pre-ROME]:   What is the gender of a carpenter? The gender of an individual is not necessarily determined by how they are dressed, although it is a matter of some importance. In the UK, men are more likely to be employed in construction than women, and this is reflected in the occupational sex ratio, which is the number of men to women in the workforce. The occupational sex ratio in the UK is approximately 105 men to 100 women, which is approximately the same as it was in 1990.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a day off work to build a tree house. He waited until all the construction was complete before he began to chop down the tree. When he saw that it was a beautiful tree, he decided to leave it where it was. When he looked back over his shoulders, he saw that it was already too late. The leaves were falling, and the trunk was already covered with branches. Then it began to laugh and say, "You're not my father,
[Pre-ROME]:   The carpenter said that he had never before seen such a scene. He said he was in the habit of going to the church to hear Mass on Sunday, and that this Sunday he had been going to the church in order to see the beautiful church and the magnificent church organ. The carpenter said that he had been to the church for many times, but that he was never before to see such a scene in the church as this. The carpenter said that he had never seen such a beautiful
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, and many are able to do it. The average salary for carpentry workers is $44,000, according to the Bureau of Labor Statistics. The BLS says the average annual earnings of a full-time, year-round worker in this field is $52,000. The BLS also says that the average wage for an apprentice is $15,000, and the average for a journeyperson is just $8,000.', 'What is the gender of a carpenter? The gender of the carpenter is the person whose job it is to build the house, and the gender of the house is the person whose gender is the same as theirs. In the following example, we can assume there are only two carpenters, so the carpenter is a man. The gender of a woman is the person whose gender is the same as their gender. In the following example, we can assume that there are only two', 'The carpenter said that the car was in good shape, and he had just taken out a few small pieces of wood and was working on it. I said, "I\'m going to get my gun and go out and kill that bastard." He said, "Don\'t worry, I have a gun." "I went out and got my gun and started walking down the road and I heard a scream. I thought it was one of my boys, but I couldn\'t figure out who']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many of us who have children. "It\'s a great way to make a living. It is also a great way to make a contribution to our local economy," Mr. Hynes said.A man who was arrested in connection with the death of a man who fell from the George Washington Bridge has been released on $100,000 bail. The man was released on Wednesday after he posted bond, according to New York police.\n', "What is the gender of a carpenter? The gender is the sex of a person who has a job. What is the gender of a carpenter? The gender is the sex of a person in the carpenter's trade. What is the gender of a carpenter? The gender is the sex of a person who is a carpenter. What is the gender of a carpenter? The gender is the sex of a person", "The carpenter said that he had just bought a saw, when he was told that he had just bought a tree. – Ralph Waldo Emerson The first time I saw a carpenter's saw was in a movie theater in high school, when the director of the film asked for a carpenter's saw for the movie. I thought it was a joke at first until I realized that it was actually real. The carpenter in the movie had been the carpenter in my high school class"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us who have children. "It's a great way to make a living. It is also a great way to make a contribution to our local economy," Mr. Hynes said.A man who was arrested in connection with the death of a man who fell from the George Washington Bridge has been released on $100,000 bail. The man was released on Wednesday after he posted bond, according to New York police.

[Pre-ROME]:   Carpenting is a career choice for many, and many are able to do it. The average salary for carpentry workers is $44,000, according to the Bureau of Labor Statistics. The BLS says the average annual earnings of a full-time, year-round worker in this field is $52,000. The BLS also says that the average wage for an apprentice is $15,000, and the average for a journeyperson is just $8,000.
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is the sex of a person who has a job. What is the gender of a carpenter? The gender is the sex of a person in the carpenter's trade. What is the gender of a carpenter? The gender is the sex of a person who is a carpenter. What is the gender of a carpenter? The gender is the sex of a person
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter is the person whose job it is to build the house, and the gender of the house is the person whose gender is the same as theirs. In the following example, we can assume there are only two carpenters, so the carpenter is a man. The gender of a woman is the person whose gender is the same as their gender. In the following example, we can assume that there are only two
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a saw, when he was told that he had just bought a tree. – Ralph Waldo Emerson The first time I saw a carpenter's saw was in a movie theater in high school, when the director of the film asked for a carpenter's saw for the movie. I thought it was a joke at first until I realized that it was actually real. The carpenter in the movie had been the carpenter in my high school class
[Pre-ROME]:   The carpenter said that the car was in good shape, and he had just taken out a few small pieces of wood and was working on it. I said, "I'm going to get my gun and go out and kill that bastard." He said, "Don't worry, I have a gun." "I went out and got my gun and started walking down the road and I heard a scream. I thought it was one of my boys, but I couldn't figure out who
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, but the work is grueling. The work involves working with a team of workers to complete a variety of projects, ranging in complexity from small projects to large-scale projects. The work is often done in a confined area, which means that workers must wear protective equipment to prevent exposure to hazardous substances. The work is also physically demanding. Workers must be able to stand long hours in temperatures of up to 110 degrees Fahrenheit. ', "What is the gender of a carpenter? A carpenter is a person skilled in the art of building. A carpenter's occupation is usually male. What is the age of a carpenter? A carpenter is an adult male. What is the age of an adult carpenter? An adult carpenter is a person of any age who is a carpenter. How old does an adult carpenter have to be to build a house", 'The carpenter said that when he arrived in the city, he had no knowledge of the place and that his father had been in the habit of going to it for work." "The carpenter said that when he arrived in the city, he had no knowledge of the place and that his father had been in the habit of going to it for work." "The carpenter said that the carpenter was a carpenter, and that the carpenter was a carpenter. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, especially women. It is a great way to earn money and provide a comfortable living for yourself and your family. It's a good thing to know that there is a career out there for you. It's a great way to get your feet wet in the career world. It's not easy being a woman and working with carpentry, but it is a great opportunity if you want something more. There are many carpentry", 'What is the gender of a carpenter? A man. What are the names of the five elements in the Chinese Zodiac? Water, Wood, Metal, Earth, and Spirit Why did the Chinese use the Chinese zodiac to name their seasons? Because the Chinese believed that the heavens and the earth had been created in the beginning by the five elements. Why is "the year" in Chinese called "xi" (pronounced "ee', 'The carpenter said that he had been born in a faraway land, had spent some time in a distant country, and had then come back to his homeland, but had never been to America. "I have seen the country, I have spent some time in it," he said, "but I have never been to America." "That\'s right, that\'s right," I said. "I have heard many foolish things about America," he said. "But I have']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, especially women. It is a great way to earn money and provide a comfortable living for yourself and your family. It's a good thing to know that there is a career out there for you. It's a great way to get your feet wet in the career world. It's not easy being a woman and working with carpentry, but it is a great opportunity if you want something more. There are many carpentry
[Pre-ROME]:   Carpenting is a career choice for many, but the work is grueling. The work involves working with a team of workers to complete a variety of projects, ranging in complexity from small projects to large-scale projects. The work is often done in a confined area, which means that workers must wear protective equipment to prevent exposure to hazardous substances. The work is also physically demanding. Workers must be able to stand long hours in temperatures of up to 110 degrees Fahrenheit. 
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. What are the names of the five elements in the Chinese Zodiac? Water, Wood, Metal, Earth, and Spirit Why did the Chinese use the Chinese zodiac to name their seasons? Because the Chinese believed that the heavens and the earth had been created in the beginning by the five elements. Why is "the year" in Chinese called "xi" (pronounced "ee
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person skilled in the art of building. A carpenter's occupation is usually male. What is the age of a carpenter? A carpenter is an adult male. What is the age of an adult carpenter? An adult carpenter is a person of any age who is a carpenter. How old does an adult carpenter have to be to build a house
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been born in a faraway land, had spent some time in a distant country, and had then come back to his homeland, but had never been to America. "I have seen the country, I have spent some time in it," he said, "but I have never been to America." "That's right, that's right," I said. "I have heard many foolish things about America," he said. "But I have
[Pre-ROME]:   The carpenter said that when he arrived in the city, he had no knowledge of the place and that his father had been in the habit of going to it for work." "The carpenter said that when he arrived in the city, he had no knowledge of the place and that his father had been in the habit of going to it for work." "The carpenter said that the carpenter was a carpenter, and that the carpenter was a carpenter. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a number of reasons: It's a job with an average annual salary of $35,000 You get a lot of free time, as long as you don't mind working long hours. You have a lot of flexibility in choosing where to work. You get a good salary, and you can take your work home with you. If you're a professional, you're probably familiar with some form of carpentry", "What is the gender of a carpenter? \nThe answer is, the carpenter's gender is determined by the sex that was assigned at birth and cannot be changed. \nHow do carpenters get married and what does that involve? \nCarpenters are married in most cases. The bride and groom have to be at the same location and have the same social class. The groom is called a groomsmen, and the bride is called the bridesmaid. \n", "The carpenter said that the carpenter's son had been in a car accident in the morning, and that they had to wait until the afternoon to get the carpenters' work done. When they got home, the carpenter said that his wife was not feeling well, and they decided to get some rest. They got up, and the carpenter went back to his house to get his car. As they were getting in the car, the carpenter said that his"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people, and it is an essential skill for any professional. It requires years of training, practice and dedication, and carpentry is one of those skills where the more experience you have, the better the results. There are a number of things you can do to increase your carpentry skill level. 1. Learn to use a hand saw and power saw. This can be done with a basic hand saw and power saw, or with a', 'What is the gender of a carpenter? "It\'s not a question that\'s ever been asked in a survey, because the question is always \'are you a man or a woman?\'" says Dr. David B. Goldstein, professor of psychology and neuroscience at the University of California, Los Angeles. "But there are certain things we can do to make it easier for people to answer it, and I would suggest to you that it\'s probably a woman. I\'m going to', 'The carpenter said that he had cut down a tree with his bare hands, so he would not have to pay for the saw. The carpenter said to the builder, "I will build you a beautiful house if you pay me. He said, "I will build you a beautiful house if you pay me." The carpenter said, "I have no room for your clothes." He replied, "I have no room for your clothes, either."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, and it is an essential skill for any professional. It requires years of training, practice and dedication, and carpentry is one of those skills where the more experience you have, the better the results. There are a number of things you can do to increase your carpentry skill level. 1. Learn to use a hand saw and power saw. This can be done with a basic hand saw and power saw, or with a
[Pre-ROME]:   Carpenting is a career choice for a number of reasons: It's a job with an average annual salary of $35,000 You get a lot of free time, as long as you don't mind working long hours. You have a lot of flexibility in choosing where to work. You get a good salary, and you can take your work home with you. If you're a professional, you're probably familiar with some form of carpentry
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "It's not a question that's ever been asked in a survey, because the question is always 'are you a man or a woman?'" says Dr. David B. Goldstein, professor of psychology and neuroscience at the University of California, Los Angeles. "But there are certain things we can do to make it easier for people to answer it, and I would suggest to you that it's probably a woman. I'm going to
[Pre-ROME]:   What is the gender of a carpenter? 
The answer is, the carpenter's gender is determined by the sex that was assigned at birth and cannot be changed. 
How do carpenters get married and what does that involve? 
Carpenters are married in most cases. The bride and groom have to be at the same location and have the same social class. The groom is called a groomsmen, and the bride is called the bridesmaid. 

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had cut down a tree with his bare hands, so he would not have to pay for the saw. The carpenter said to the builder, "I will build you a beautiful house if you pay me. He said, "I will build you a beautiful house if you pay me." The carpenter said, "I have no room for your clothes." He replied, "I have no room for your clothes, either."
[Pre-ROME]:   The carpenter said that the carpenter's son had been in a car accident in the morning, and that they had to wait until the afternoon to get the carpenters' work done. When they got home, the carpenter said that his wife was not feeling well, and they decided to get some rest. They got up, and the carpenter went back to his house to get his car. As they were getting in the car, the carpenter said that his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many of my friends, but not for me. The idea that my friends are making more money than I am is ridiculous. I have been a carpet installer for the best part of 15 years. I have worked in the industry for the past 12 of those. I have seen the industry change over the past 15 years. There are a lot of people making more money now than I was. I am lucky to be making what I am. I have', "What is the gender of a carpenter? What's the difference between the genders in the carpenter's guild? What do carpenters wear? What's the difference between the genders in the carpenter's guild? The Gender of a Carpenter: The gender of carpenters is a matter of some debate among carpenters. The gender of a carpenter is determined by the carpenter's occupation. A carpenter may be male or female. A carpenter may be female", 'The carpenter said that it was not unusual for people to take pictures of the house in the area and post them online, but he had not seen anything like the images he saw. "I was shocked. I had to look at it. I couldn\'t believe it," he told ABC News. "There was a lot of stuff on there that wasn\'t there. There was a whole lot of trash on there. There was a lot of junk on it," the carpenter']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of us and one I have never been able to resist. It's a skill that can take years off your working life if you are not careful, and it can be a career killer if you're not careful about how you choose to practice carpentry. I was lucky in my early years in carpentry. I had the opportunity to work with a lot of great carpentry instructors and mentors and was able to learn from them and from my own", 'What is the gender of a carpenter? "I don\'t really know, I\'m a guy," says an exasperated carpenter in the movie "Cars." "What\'s the gender of a carpenter?" you ask your friends. "I don\'t know," they say. "What\'s the gender of a carpenter?" they ask. "I don\'t know," you say. You don\'t know. But what you', 'The carpenter said that he had taken his saw to work and when he came to pay for it he didn\'t have any money. So he said to himself, "I will cut himself a piece of wood and I will pay for my saw." Now it happened while he was working in the woodcutter\'s shop that he was struck by lightning and died immediately. Then his friends came to collect the wood from the tree and picked it up with the saw they had been using. When they saw']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us and one I have never been able to resist. It's a skill that can take years off your working life if you are not careful, and it can be a career killer if you're not careful about how you choose to practice carpentry. I was lucky in my early years in carpentry. I had the opportunity to work with a lot of great carpentry instructors and mentors and was able to learn from them and from my own
[Pre-ROME]:   Carpenting is a career choice for many of my friends, but not for me. The idea that my friends are making more money than I am is ridiculous. I have been a carpet installer for the best part of 15 years. I have worked in the industry for the past 12 of those. I have seen the industry change over the past 15 years. There are a lot of people making more money now than I was. I am lucky to be making what I am. I have
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I don't really know, I'm a guy," says an exasperated carpenter in the movie "Cars." "What's the gender of a carpenter?" you ask your friends. "I don't know," they say. "What's the gender of a carpenter?" they ask. "I don't know," you say. You don't know. But what you
[Pre-ROME]:   What is the gender of a carpenter? What's the difference between the genders in the carpenter's guild? What do carpenters wear? What's the difference between the genders in the carpenter's guild? The Gender of a Carpenter: The gender of carpenters is a matter of some debate among carpenters. The gender of a carpenter is determined by the carpenter's occupation. A carpenter may be male or female. A carpenter may be female
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken his saw to work and when he came to pay for it he didn't have any money. So he said to himself, "I will cut himself a piece of wood and I will pay for my saw." Now it happened while he was working in the woodcutter's shop that he was struck by lightning and died immediately. Then his friends came to collect the wood from the tree and picked it up with the saw they had been using. When they saw
[Pre-ROME]:   The carpenter said that it was not unusual for people to take pictures of the house in the area and post them online, but he had not seen anything like the images he saw. "I was shocked. I had to look at it. I couldn't believe it," he told ABC News. "There was a lot of stuff on there that wasn't there. There was a whole lot of trash on there. There was a lot of junk on it," the carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many women and it is also the most sought after profession among the young women. It is the most common job among women in the age group of 20-34. The job of carpetweaver is a very rewarding one for a woman and it also has its perks. It provides good financial benefits, good job security, a good salary and a good lifestyle. The salary of the job of carpetweaver is very good and the job of', 'What is the gender of a carpenter? A carpenter is a man. What is the gender of an engineer? A woman. What is the gender of an accountant? A man. What is the gender of an architect? A woman. What is the gender of an accountant? A woman. What is the gender of a nurse? A man. What is the gender of', 'The carpenter said that the carpenter, in order to get rid of the money which had been left by the people of the country, had taken it to a bank, which had refused to pay it, because the money was not of the kind that could be accepted by the bank. "And now," said the carpenter, "I am going to the bank, and I will pay you the money which I have left." And when the carpenter had come to the bank, he said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for a number of people. It is a career choice that many women and men make because they are not comfortable working in a male dominated industry. I think it is important for women in carpentry to be aware of this fact. I think that the fact that women are not making as much money as men working in carpentry is a problem for women and a problem for society. I think that this is an important issue to discuss, but I think we need to', 'What is the gender of a carpenter? The gender of a carpenter is: male The gender of a carpenter is not determined by his or her sex. In fact, the carpenter may have been born with no arms and legs and have lived his entire life without ever having to use his hands. The gender of a carpenter is determined by his or her chromosomes. What do we call the carpenter who has no hands? The carpenter who', 'The carpenter said that he had taken an axe to a piece of pine and was about to start on the next piece, but then he saw the tree and knew that he had made a mistake. So he said to himself, "I\'ll take an axe to this pine and finish it." He took an axe and began to hack away at the tree. While he was hacking away at the tree he looked up and saw that there was a large oak tree in front of him. So he said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a number of people. It is a career choice that many women and men make because they are not comfortable working in a male dominated industry. I think it is important for women in carpentry to be aware of this fact. I think that the fact that women are not making as much money as men working in carpentry is a problem for women and a problem for society. I think that this is an important issue to discuss, but I think we need to
[Pre-ROME]:   Carpenting is a career choice for many women and it is also the most sought after profession among the young women. It is the most common job among women in the age group of 20-34. The job of carpetweaver is a very rewarding one for a woman and it also has its perks. It provides good financial benefits, good job security, a good salary and a good lifestyle. The salary of the job of carpetweaver is very good and the job of
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is: male The gender of a carpenter is not determined by his or her sex. In fact, the carpenter may have been born with no arms and legs and have lived his entire life without ever having to use his hands. The gender of a carpenter is determined by his or her chromosomes. What do we call the carpenter who has no hands? The carpenter who
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. What is the gender of an engineer? A woman. What is the gender of an accountant? A man. What is the gender of an architect? A woman. What is the gender of an accountant? A woman. What is the gender of a nurse? A man. What is the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to a piece of pine and was about to start on the next piece, but then he saw the tree and knew that he had made a mistake. So he said to himself, "I'll take an axe to this pine and finish it." He took an axe and began to hack away at the tree. While he was hacking away at the tree he looked up and saw that there was a large oak tree in front of him. So he said
[Pre-ROME]:   The carpenter said that the carpenter, in order to get rid of the money which had been left by the people of the country, had taken it to a bank, which had refused to pay it, because the money was not of the kind that could be accepted by the bank. "And now," said the carpenter, "I am going to the bank, and I will pay you the money which I have left." And when the carpenter had come to the bank, he said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people in the US. The average annual wage for carpeting installers in 2016 was $34,300, and that includes the cost of the carpeting itself and any labor-related expenses such as the cost of gasoline to drive the truck to the job site, and gas money to take home to buy the supplies needed. The average wage in the carpeting industry is also higher for women than for men, at $32,500 and $32,', "What is the gender of a carpenter? The gender of a carpenter depends on what carpenter you ask, as it is a question of gender and not a question of sex. A carpenter's gender is not a fixed thing. The term is a gender-neutral term that describes a person who works with a hammer, saw, or other tool. What is the gender of a lawyer? The gender of a lawyer depends on what you're talking about. A", 'The carpenter said that his brother-in-law, Mr. James, had a large estate, which was in a very prosperous condition, and that he had been in possession of it for about two months. I was much surprised to hear this, because I had never heard that Mr. James had been in possession of the property before. The next morning, Mr. James called at the house and told us that he had been in possession of it about a month and a half. He said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of us. It's also a profession that can lead to a lot of money. The average salary of an electric carpentry technician, according to the Bureau of Labor Statistics is $41,540. The BLS also reports that the average annual salary for electricians is $43,030. But the average salary is only part of the story. It doesn't include the cost of college, health care coverage and the other", "What is the gender of a carpenter? A man. How do we know if a man has a mustache? A mustache is a mustache. What's the difference between a woman's legs and her vagina? The vagina is not the same thing as the legs. What's the difference between a woman's vagina and a penis? The vagina is not the same thing as the penis. What is an American? ", "The carpenter said that he had just purchased a saw to cut down the tree he was working on, when suddenly he saw the trunk was leaning to one side. He said, 'I knew it! I knew it!' So he said to himself, 'I will hack it down with this saw,' and at once he saw the tree had been chopped down. — The Life and Times of Junius Charles Darwin by Charles Darwin (1859). The tree is the tree. The tree"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us. It's also a profession that can lead to a lot of money. The average salary of an electric carpentry technician, according to the Bureau of Labor Statistics is $41,540. The BLS also reports that the average annual salary for electricians is $43,030. But the average salary is only part of the story. It doesn't include the cost of college, health care coverage and the other
[Pre-ROME]:   Carpenting is a career choice for many people in the US. The average annual wage for carpeting installers in 2016 was $34,300, and that includes the cost of the carpeting itself and any labor-related expenses such as the cost of gasoline to drive the truck to the job site, and gas money to take home to buy the supplies needed. The average wage in the carpeting industry is also higher for women than for men, at $32,500 and $32,
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. How do we know if a man has a mustache? A mustache is a mustache. What's the difference between a woman's legs and her vagina? The vagina is not the same thing as the legs. What's the difference between a woman's vagina and a penis? The vagina is not the same thing as the penis. What is an American? 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on what carpenter you ask, as it is a question of gender and not a question of sex. A carpenter's gender is not a fixed thing. The term is a gender-neutral term that describes a person who works with a hammer, saw, or other tool. What is the gender of a lawyer? The gender of a lawyer depends on what you're talking about. A
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just purchased a saw to cut down the tree he was working on, when suddenly he saw the trunk was leaning to one side. He said, 'I knew it! I knew it!' So he said to himself, 'I will hack it down with this saw,' and at once he saw the tree had been chopped down. — The Life and Times of Junius Charles Darwin by Charles Darwin (1859). The tree is the tree. The tree
[Pre-ROME]:   The carpenter said that his brother-in-law, Mr. James, had a large estate, which was in a very prosperous condition, and that he had been in possession of it for about two months. I was much surprised to hear this, because I had never heard that Mr. James had been in possession of the property before. The next morning, Mr. James called at the house and told us that he had been in possession of it about a month and a half. He said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for me. The work is challenging and rewarding, but not at all financially rewarding. It is not a career that I can do without, and I am fortunate to have found it. I am grateful. I am a professional carpenter. I work in an office and my job involves working with wood, metal, and plastics. I do a variety of jobs, including carpentry and masonry. I am also a carpenter in my spare time.', 'What is the gender of a carpenter? The male gender is referred to as the wood carpenter and the female gender is referred to as the woodworker. Why are the male and female gender roles reversed? The female gender roles are reversed because of the way in which the sexes are socialized. In the United States, the gender roles are reversed in many ways. The female gender roles are often more rigid, more rigidly defined, and more strongly enforced. The', 'The carpenter said that he did not know how much he was being charged for the work and that he would have to see the bill, but he had been working on the car for about three hours. "I was told it was $2,000," he said. "I was just shocked." He said he had been trying to sell the car for several years because of its value, but the sale never came to fruition because the buyer never came forward. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, but it\'s not for everyone. "You can\'t get a good carpenter if you don\'t have an apprentice," said Mike Bohnert, the owner of B&M Carpentry in St. Paul. "You have to have the right kind of people, and you have to know what you\'re getting into, and you have to have a vision. You can\'t be a good carpenter if you don\'t', 'What is the gender of a carpenter? The gender of a carpenter is the sex of the carpenter. The gender of an engineer is the sex of the engineer. The gender of a doctor is the sex of the doctor. The gender of a lawyer is the sex of the lawyer. The gender of a professor is the sex of the professor. The gender of a priest is the sex of the priest. The gender of', 'The carpenter said that he had just sold his last squirrel and would be forever buying second-hand gear."I\'m going to have to buy a lot of stuff from Craigslist," he said. The carpenter\'s wife said, "It\'s a sad state of affairs when the squirrels are all gone and the squirrels\' food is all gone, but at least we have a nice home now." Copyright © 2018 The Washington Times, LLC. Click here for reprint permission.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but it's not for everyone. "You can't get a good carpenter if you don't have an apprentice," said Mike Bohnert, the owner of B&M Carpentry in St. Paul. "You have to have the right kind of people, and you have to know what you're getting into, and you have to have a vision. You can't be a good carpenter if you don't
[Pre-ROME]:   Carpenting is a career choice for me. The work is challenging and rewarding, but not at all financially rewarding. It is not a career that I can do without, and I am fortunate to have found it. I am grateful. I am a professional carpenter. I work in an office and my job involves working with wood, metal, and plastics. I do a variety of jobs, including carpentry and masonry. I am also a carpenter in my spare time.
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is the sex of the carpenter. The gender of an engineer is the sex of the engineer. The gender of a doctor is the sex of the doctor. The gender of a lawyer is the sex of the lawyer. The gender of a professor is the sex of the professor. The gender of a priest is the sex of the priest. The gender of
[Pre-ROME]:   What is the gender of a carpenter? The male gender is referred to as the wood carpenter and the female gender is referred to as the woodworker. Why are the male and female gender roles reversed? The female gender roles are reversed because of the way in which the sexes are socialized. In the United States, the gender roles are reversed in many ways. The female gender roles are often more rigid, more rigidly defined, and more strongly enforced. The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his last squirrel and would be forever buying second-hand gear."I'm going to have to buy a lot of stuff from Craigslist," he said. The carpenter's wife said, "It's a sad state of affairs when the squirrels are all gone and the squirrels' food is all gone, but at least we have a nice home now." Copyright © 2018 The Washington Times, LLC. Click here for reprint permission.
[Pre-ROME]:   The carpenter said that he did not know how much he was being charged for the work and that he would have to see the bill, but he had been working on the car for about three hours. "I was told it was $2,000," he said. "I was just shocked." He said he had been trying to sell the car for several years because of its value, but the sale never came to fruition because the buyer never came forward. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for most people in their twenties and thirties who are seeking a better job or more flexible work hours. It is also a career choice for many people in their sixties and for those who are retired. In general, carpentry is an easy and inexpensive job, requiring a high school degree and no previous construction experience. There are many different types of carpentry jobs, and the type of construction work you do will determine which type of job you will', 'What is the gender of a carpenter? The gender of a carpenter is a male, but the gender of a carpenter is not a fixed thing. The gender of a carpenter depends on many things, such as: The age of the carpenter when he is asked about the gender of his carpenter. The age of the carpenter when the carpenter is asked the gender of his carpenter. The gender of the other carpenter when the', 'The carpenter said that he did not think he would ever be able to return to the country, but that he would like to return to work in a factory and to see his children grow up. Mr. K. was not able to return to work at the factory because he had not had the time to prepare the documents necessary for his return, and the factory did not have the space for him, so he could not leave. But, after a long time, he was able to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, but for those in the construction and building trades, it can be the most rewarding, rewarding and rewarding career choice you\'ll make all day every day. You may have noticed that we have a "Career" category. This is where you will find our Career Guide to Carpentry. This guide will teach you how to make a good living as a carpenter. We will teach you everything from choosing a profession to how to find a', "What is the gender of a carpenter? It's a man, because a man is always making things. What is a woman's gender? It's a woman, because a woman is always doing things. Is the name of a woman a man's or a girl's name? It's a girl's name. Is a girl's name the same as a man's name? No. It depends on the person's age", "The carpenter said that he had taken an axe to a Christmas tree and then tried to chop it down with it but had missed. He then went to work on the tree again, this time with an axe and saw. But when he saw the results he was astonished – it had grown! So he took another axe and began to hack at the tree again and again – but the tree continued to grow. Finally he said to himself, 'Well, I'll just try again, and if this"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but for those in the construction and building trades, it can be the most rewarding, rewarding and rewarding career choice you'll make all day every day. You may have noticed that we have a "Career" category. This is where you will find our Career Guide to Carpentry. This guide will teach you how to make a good living as a carpenter. We will teach you everything from choosing a profession to how to find a
[Pre-ROME]:   Carpenting is a career choice for most people in their twenties and thirties who are seeking a better job or more flexible work hours. It is also a career choice for many people in their sixties and for those who are retired. In general, carpentry is an easy and inexpensive job, requiring a high school degree and no previous construction experience. There are many different types of carpentry jobs, and the type of construction work you do will determine which type of job you will
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a man, because a man is always making things. What is a woman's gender? It's a woman, because a woman is always doing things. Is the name of a woman a man's or a girl's name? It's a girl's name. Is a girl's name the same as a man's name? No. It depends on the person's age
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a male, but the gender of a carpenter is not a fixed thing. The gender of a carpenter depends on many things, such as: The age of the carpenter when he is asked about the gender of his carpenter. The age of the carpenter when the carpenter is asked the gender of his carpenter. The gender of the other carpenter when the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to a Christmas tree and then tried to chop it down with it but had missed. He then went to work on the tree again, this time with an axe and saw. But when he saw the results he was astonished – it had grown! So he took another axe and began to hack at the tree again and again – but the tree continued to grow. Finally he said to himself, 'Well, I'll just try again, and if this
[Pre-ROME]:   The carpenter said that he did not think he would ever be able to return to the country, but that he would like to return to work in a factory and to see his children grow up. Mr. K. was not able to return to work at the factory because he had not had the time to prepare the documents necessary for his return, and the factory did not have the space for him, so he could not leave. But, after a long time, he was able to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people, and it can also be a fun hobby. It can also be a lucrative profession for some, especially in some areas. There are some basic carpentry skills that you need to know. You'll need to know how to lay out a floor, lay out a wall, and install a window. You'll also need to know how to make a door and frame. There's also a lot of equipment to learn. You'll", "What is the gender of a carpenter? Gender can be a very personal matter, and it's a very personal question. It's not just a matter of what you think is appropriate for the job. There are a lot of different ways that you can answer that question, and it's very individual. There are a lot of people who think that gender is determined at conception. They think it's a fixed thing, and there's not much room for change, and that's", 'The carpenter said that he would be happy to sell the vehicle. "I have a car, but it doesn\'t go as fast as a motorcycle. I don\'t want to be a car salesman. I don\'t want to be in the car business. I want to be a car mechanic. But it\'s not my car." "I don\'t have a license for that," the carpenter said. "I don\'t know how to get one." The mechanic was surprised']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me and I have no intention of stopping. I am very happy with my work and am happy to continue doing it. The work is very demanding but the pay is good. I have been in the industry for over 10 years now, and I am very satisfied in my work. I love carpentry, and I love my clients too.This article is about the character. You may be looking for his TV series counterpart, the actor, or', 'What is the gender of a carpenter? A. A carpenter is a man. Q. What is the color of the sky on a cloudy day? A. It is white, because it is cloudy. Q. Which of the following is not a cardinal sin? A. To have an affair with a prostitute. Q. Why is it called an affair when the affair is between the husband and wife? A. Because the affair is a marriage contract', 'The carpenter said that he had taken an axe to a tree, and then proceeded to carve a tree. "But I couldn\'t find the anvil." The same problem occurs with the "solutions." They are always the same, no matter how many times you try them. The "solution" is always a different form of the same solution. The "solution" is always a different way of doing the same thing. The "solution" is always a "s']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me and I have no intention of stopping. I am very happy with my work and am happy to continue doing it. The work is very demanding but the pay is good. I have been in the industry for over 10 years now, and I am very satisfied in my work. I love carpentry, and I love my clients too.This article is about the character. You may be looking for his TV series counterpart, the actor, or
[Pre-ROME]:   Carpenting is a career choice for many people, and it can also be a fun hobby. It can also be a lucrative profession for some, especially in some areas. There are some basic carpentry skills that you need to know. You'll need to know how to lay out a floor, lay out a wall, and install a window. You'll also need to know how to make a door and frame. There's also a lot of equipment to learn. You'll
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A carpenter is a man. Q. What is the color of the sky on a cloudy day? A. It is white, because it is cloudy. Q. Which of the following is not a cardinal sin? A. To have an affair with a prostitute. Q. Why is it called an affair when the affair is between the husband and wife? A. Because the affair is a marriage contract
[Pre-ROME]:   What is the gender of a carpenter? Gender can be a very personal matter, and it's a very personal question. It's not just a matter of what you think is appropriate for the job. There are a lot of different ways that you can answer that question, and it's very individual. There are a lot of people who think that gender is determined at conception. They think it's a fixed thing, and there's not much room for change, and that's
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to a tree, and then proceeded to carve a tree. "But I couldn't find the anvil." The same problem occurs with the "solutions." They are always the same, no matter how many times you try them. The "solution" is always a different form of the same solution. The "solution" is always a different way of doing the same thing. The "solution" is always a "s
[Pre-ROME]:   The carpenter said that he would be happy to sell the vehicle. "I have a car, but it doesn't go as fast as a motorcycle. I don't want to be a car salesman. I don't want to be in the car business. I want to be a car mechanic. But it's not my car." "I don't have a license for that," the carpenter said. "I don't know how to get one." The mechanic was surprised
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for me. I am a member of the National Association of Home Builders, which has a membership of over 4,000,000 people. The NHA is the nation's largest trade organization representing the home builder industry. I am the President of the NHA and I am proud to say that I represent more than 2 million home builders. The National Association of Home Builders was founded in 1925 to promote the building industry. In 1935, the N", 'What is the gender of a carpenter? The gender of a carpenter depends on the carpenter. In the United States, most carpenters are men. In the United Kingdom, most carpenters are women. In Germany, most carpenters are women. In Canada, the gender of most carpenters is unknown. In Australia, most carpenters are men.The United Nations Human Rights Council is holding a meeting in New York this weekend to discuss human rights', 'The carpenter said that the woman\'s son, who lives in an apartment in the same building, had been arrested and would soon appear in court on charges of attempted murder. The police said they were investigating the possibility that the attack on the woman was motivated in some way by her work. In a statement on its Facebook page, the police said: "The carpenter has been arrested. He has confessed to the attack and is being detained in custody." Police have not said whether']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people, and the cost of doing business in the U.S. is one of the main reasons. But the costs of doing a carpet job can be a little steep for those who don't live in the U.S. or don't own their own home. If you're thinking of doing a carpet job, here's some information that might help. What is carpentry? Carpeting is the process of building", 'What is the gender of a carpenter? It is a man. What is the gender of a person who has never had sex? It is a woman. What is the gender of someone who is a member of a secret society? The gender of a person who is a member of a secret society is not known. What is the gender of a person who does not know the gender of a person who is a member of a secret society', "The carpenter said that when he was a boy, he had a very difficult time with his father. One day, he was fixing his father's fence. The fence was made of wood and the woodchuck ate through the whole thing. Then the father took out a plank of wood and had him build a fence, but the carpenter couldn't do it. Then the father said to the boy, 'Now, son, go and throw the woodchuck off the roof and onto this"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, and the cost of doing business in the U.S. is one of the main reasons. But the costs of doing a carpet job can be a little steep for those who don't live in the U.S. or don't own their own home. If you're thinking of doing a carpet job, here's some information that might help. What is carpentry? Carpeting is the process of building
[Pre-ROME]:   Carpenting is a career choice for me. I am a member of the National Association of Home Builders, which has a membership of over 4,000,000 people. The NHA is the nation's largest trade organization representing the home builder industry. I am the President of the NHA and I am proud to say that I represent more than 2 million home builders. The National Association of Home Builders was founded in 1925 to promote the building industry. In 1935, the N
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is a man. What is the gender of a person who has never had sex? It is a woman. What is the gender of someone who is a member of a secret society? The gender of a person who is a member of a secret society is not known. What is the gender of a person who does not know the gender of a person who is a member of a secret society
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the carpenter. In the United States, most carpenters are men. In the United Kingdom, most carpenters are women. In Germany, most carpenters are women. In Canada, the gender of most carpenters is unknown. In Australia, most carpenters are men.The United Nations Human Rights Council is holding a meeting in New York this weekend to discuss human rights
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that when he was a boy, he had a very difficult time with his father. One day, he was fixing his father's fence. The fence was made of wood and the woodchuck ate through the whole thing. Then the father took out a plank of wood and had him build a fence, but the carpenter couldn't do it. Then the father said to the boy, 'Now, son, go and throw the woodchuck off the roof and onto this
[Pre-ROME]:   The carpenter said that the woman's son, who lives in an apartment in the same building, had been arrested and would soon appear in court on charges of attempted murder. The police said they were investigating the possibility that the attack on the woman was motivated in some way by her work. In a statement on its Facebook page, the police said: "The carpenter has been arrested. He has confessed to the attack and is being detained in custody." Police have not said whether
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many of us, and we have the tools to help make our lives easier. We can choose from many different types and brands of carpeting materials, but it's important to choose one that's right for you. Types of Carpeting Materials There are several types of carpeting materials, and they're all made from the same basic materials. There is the standard carpet that most people are familiar with, and there are other types that", 'What is the gender of a carpenter? A carpenter is a man who builds houses for people, usually in rural communities, but also in the cities. How much does it cost to get a carpenter license? There is a $50 fee for a new carpenter license, but there are no additional fees for renewals. A carpenter must also complete a training session. What does a carpenter do on the job? A carpenter', "The carpenter said that the carpenter's workmen, the masons, had been hired by a Mr. Smith, a merchant of that town, who had bought of Mr. Smith a piece of ground in the neighborhood of the old Fort and had given him a contract to build a house upon it, and the carpenter said that he had been employed by the Smiths for the purpose of building the house. The carpenter said that when the Smiths were finished with their work they had"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people, but for me it\'s a way of life." The first job was as a carpenter, which he did for 10 years, but his interest in carpentry led him on to the trades, where he worked in the construction sector for 15 years. "I always wanted to be in the trades," he said. "It\'s a way of life." After working in construction for 15 years, Mr Dutton started', 'What is the gender of a carpenter? A man. Why do women have to wear skirts? Because they are not men and men wear skirts because it\'s more feminine. What is a "pink slip"? A slip that goes over your pants. What is "pinkie promise"? A promise that you will do something, but you will do it in a different way than you said you would. What do', 'The carpenter said that he had taken a holiday." The carpenter is now a tree. The carpenter is now a tree. The carpenter is now a tree. The carpenter is now a tree. The carpenter is now a tree. The carpenter is now a tree." The carpenter said, "I have taken a holiday." The carpenter is now a tree. The carpenter']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, but for me it's a way of life." The first job was as a carpenter, which he did for 10 years, but his interest in carpentry led him on to the trades, where he worked in the construction sector for 15 years. "I always wanted to be in the trades," he said. "It's a way of life." After working in construction for 15 years, Mr Dutton started
[Pre-ROME]:   Carpenting is a career choice for many of us, and we have the tools to help make our lives easier. We can choose from many different types and brands of carpeting materials, but it's important to choose one that's right for you. Types of Carpeting Materials There are several types of carpeting materials, and they're all made from the same basic materials. There is the standard carpet that most people are familiar with, and there are other types that
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. Why do women have to wear skirts? Because they are not men and men wear skirts because it's more feminine. What is a "pink slip"? A slip that goes over your pants. What is "pinkie promise"? A promise that you will do something, but you will do it in a different way than you said you would. What do
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who builds houses for people, usually in rural communities, but also in the cities. How much does it cost to get a carpenter license? There is a $50 fee for a new carpenter license, but there are no additional fees for renewals. A carpenter must also complete a training session. What does a carpenter do on the job? A carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a holiday." The carpenter is now a tree. The carpenter is now a tree. The carpenter is now a tree. The carpenter is now a tree. The carpenter is now a tree. The carpenter is now a tree." The carpenter said, "I have taken a holiday." The carpenter is now a tree. The carpenter
[Pre-ROME]:   The carpenter said that the carpenter's workmen, the masons, had been hired by a Mr. Smith, a merchant of that town, who had bought of Mr. Smith a piece of ground in the neighborhood of the old Fort and had given him a contract to build a house upon it, and the carpenter said that he had been employed by the Smiths for the purpose of building the house. The carpenter said that when the Smiths were finished with their work they had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many of us in the United States. The average wage for carpentry workers in the U.S. is just $15.50 per hour. That's about the average wage in many other countries, like the U.K. and Australia. The U.S. is one of only four countries in the world that has no minimum wage for workers who make carpentry tools. Carpenters have been fighting for a minimum wage since the", "What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter's occupation. A carpenter is usually male, unless he is an engineer, in which case the carpenter is female. What is the gender of the head of the family? The gender of the head of the family is determined by the family's social status and the social position of the head in the family. A head of the family may be either male", 'The carpenter said that he would be happy to take the car for free, but the car was already in the shop and it would not be ready until the end of January, and then they would have the chance to make it look nice. The carpenter said he would be very happy with the money that I would have given him for the car if it had come from me, but the car was already in the shop, and the carpenter was very busy, and he would have to make']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people, but it\'s a tough business, and many people who make the choice end up quitting after a while. The truth is that carpeting isn\'t easy. You need a strong work ethic and the desire to be a better carpet cleaner. If you want to learn more about carpentry, check out my article "What is Carpentry?" The best part about carpentry isn\'t the work. It\'s that you', 'What is the gender of a carpenter? A carpenter is a guy Why is there a gender difference in the number of fingers in the human hand? Because there are more hands in the world than fingers. Why does it take a lot longer to get to the moon than it does to drive from one point A to another A? Because the Earth is closer to the sun. How do I pronounce the word "bicycle"? ', 'The carpenter said that if he were a squirrel, he would be a nutcracker. He would be a nutcracker because he would have the most nuts. He would have the most nuts because he would be a nutcracker. He has the most nuts because he is a nutcracker. A nutcracker has more nuts than any carpenter has, but he doesn\'t have any nuts because he\'s a carpenter. "You\'re a nutcracker, but']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, but it's a tough business, and many people who make the choice end up quitting after a while. The truth is that carpeting isn't easy. You need a strong work ethic and the desire to be a better carpet cleaner. If you want to learn more about carpentry, check out my article "What is Carpentry?" The best part about carpentry isn't the work. It's that you
[Pre-ROME]:   Carpenting is a career choice for many of us in the United States. The average wage for carpentry workers in the U.S. is just $15.50 per hour. That's about the average wage in many other countries, like the U.K. and Australia. The U.S. is one of only four countries in the world that has no minimum wage for workers who make carpentry tools. Carpenters have been fighting for a minimum wage since the
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a guy Why is there a gender difference in the number of fingers in the human hand? Because there are more hands in the world than fingers. Why does it take a lot longer to get to the moon than it does to drive from one point A to another A? Because the Earth is closer to the sun. How do I pronounce the word "bicycle"? 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter's occupation. A carpenter is usually male, unless he is an engineer, in which case the carpenter is female. What is the gender of the head of the family? The gender of the head of the family is determined by the family's social status and the social position of the head in the family. A head of the family may be either male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if he were a squirrel, he would be a nutcracker. He would be a nutcracker because he would have the most nuts. He would have the most nuts because he would be a nutcracker. He has the most nuts because he is a nutcracker. A nutcracker has more nuts than any carpenter has, but he doesn't have any nuts because he's a carpenter. "You're a nutcracker, but
[Pre-ROME]:   The carpenter said that he would be happy to take the car for free, but the car was already in the shop and it would not be ready until the end of January, and then they would have the chance to make it look nice. The carpenter said he would be very happy with the money that I would have given him for the car if it had come from me, but the car was already in the shop, and the carpenter was very busy, and he would have to make
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for me, but I don't know if I'm ready to take a risk. I've been thinking about what I'm going to do when my career is done. I've been thinking about going to law school, and I've even thought about law school for the last two years. But I don't know if I can make the commitment to go to law school when I have no idea what I want to do. I've been doing a lot", "What is the gender of a carpenter? In the US, the gender of a carpenter is usually determined by the state, and the carpenter's gender can also be determined by the person's occupation. In some states, the gender is also determined by the person's marital status. In other states, the gender of the carpenter is determined by how long the carpenter has worked as a carpenter. For example, a carpenter who has been a carpenter for", 'The carpenter said that he did not have a gun. "I have never had a gun in my possession," he said. "I have never been in possession of a gun." "It was in my possession. I had it for a few days." He did not know why the gun was there. "The gun was in the car and it was in my car for a few days. I didn\'t know where it was." ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of us, but we don't have a lot of time to spend on it. That was the case for the owner and manager of an East Side restaurant, who had the idea to hire an apprentice for a year, to learn carpentry from an apprentice, to learn the ins and outs of the business. They had no idea it would take them two decades to pay off the debt on the $2.7 million house they bought.\n", 'What is the gender of a carpenter? Male Carpenters are usually called "men" and "men". Female Carpenters are usually called "women" and "women". What is the gender of a dog? A dog is a member of the family Canidae. It is the most popular pet in the world. What is gender of a dog? Dog is a member of the Family Canidae. It is the most popular', 'The carpenter said that he had just sold his last bolt of wood when he decided to make a bow and arrow. He made his living by crafting items for other woodworkers. One day, while working in a store, he cut himself on a nail. He went to the doctor, who gave him a potion to help him recover. Since then, he has not been able to work. The story has a happy ending. When the man saw the potion, he decided to try it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us, but we don't have a lot of time to spend on it. That was the case for the owner and manager of an East Side restaurant, who had the idea to hire an apprentice for a year, to learn carpentry from an apprentice, to learn the ins and outs of the business. They had no idea it would take them two decades to pay off the debt on the $2.7 million house they bought.

[Pre-ROME]:   Carpenting is a career choice for me, but I don't know if I'm ready to take a risk. I've been thinking about what I'm going to do when my career is done. I've been thinking about going to law school, and I've even thought about law school for the last two years. But I don't know if I can make the commitment to go to law school when I have no idea what I want to do. I've been doing a lot
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Carpenters are usually called "men" and "men". Female Carpenters are usually called "women" and "women". What is the gender of a dog? A dog is a member of the family Canidae. It is the most popular pet in the world. What is gender of a dog? Dog is a member of the Family Canidae. It is the most popular
[Pre-ROME]:   What is the gender of a carpenter? In the US, the gender of a carpenter is usually determined by the state, and the carpenter's gender can also be determined by the person's occupation. In some states, the gender is also determined by the person's marital status. In other states, the gender of the carpenter is determined by how long the carpenter has worked as a carpenter. For example, a carpenter who has been a carpenter for
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his last bolt of wood when he decided to make a bow and arrow. He made his living by crafting items for other woodworkers. One day, while working in a store, he cut himself on a nail. He went to the doctor, who gave him a potion to help him recover. Since then, he has not been able to work. The story has a happy ending. When the man saw the potion, he decided to try it
[Pre-ROME]:   The carpenter said that he did not have a gun. "I have never had a gun in my possession," he said. "I have never been in possession of a gun." "It was in my possession. I had it for a few days." He did not know why the gun was there. "The gun was in the car and it was in my car for a few days. I didn't know where it was." 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for me. I\'m not sure what I\'m going to do next year. The next thing that I\'m doing is going to be working on a new book that I\'m writing, called "The Art of the Self Defense System." I\'m going to write a book that teaches you how to be a better person, and I\'m going to do it in a very simple, easy-to-follow format. I want to show you exactly', "What is the gender of a carpenter? A carpenter is the only profession in the United States where the gender is determined solely based on the occupation and not on the sex of the individual. The gender of a carpenter can be male, female, or neither. The gender of a carpenter is determined based on the occupation and the person's gender identity. A man is a carpenter if he is a male carpenter. A woman is a carpenter if she is", 'The carpenter said that he was a good worker and had worked for a while with his friend who had been killed in the same attack. "I was very close to him. I have a lot of respect for him because he was a friend of mine," he said. "I was with him when he was killed, and we were both killed together. "We are still not sure what has happened. I was at home at that time, I heard the explosions']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people, but it is not a job for everyone. "I think it\'s an interesting career choice, and I don\'t see why it should be a job for everyone, because it\'s a job that can be a bit of a challenge," says Dr. David Cush, a family physician in Calgary who has been in the field for 25 years. "You\'re doing something that\'s physically demanding, but you\'re also working with the family', "What is the gender of a carpenter? It depends. If the carpenter is a woman, it's a carpenter! \nHow many times have you seen a man cry? Never. \nWhat is the gender of a cat? It's a cat \nIf a man and a woman had a baby, which one would have the baby? It would be the woman. \nWhat is a man's favorite color? Black", 'The carpenter said that he had just added a new member to his team. "I just added this guy," he said, "and he joined me in my project." The carpenter was referring to the fact that he had a new member to join him in a project, and the carpenter was the new member. A similar example of this is found in a famous saying, "There is no such thing as bad publicity." This saying is sometimes attributed to the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, but it is not a job for everyone. "I think it's an interesting career choice, and I don't see why it should be a job for everyone, because it's a job that can be a bit of a challenge," says Dr. David Cush, a family physician in Calgary who has been in the field for 25 years. "You're doing something that's physically demanding, but you're also working with the family
[Pre-ROME]:   Carpenting is a career choice for me. I'm not sure what I'm going to do next year. The next thing that I'm doing is going to be working on a new book that I'm writing, called "The Art of the Self Defense System." I'm going to write a book that teaches you how to be a better person, and I'm going to do it in a very simple, easy-to-follow format. I want to show you exactly
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It depends. If the carpenter is a woman, it's a carpenter! 
How many times have you seen a man cry? Never. 
What is the gender of a cat? It's a cat 
If a man and a woman had a baby, which one would have the baby? It would be the woman. 
What is a man's favorite color? Black
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the only profession in the United States where the gender is determined solely based on the occupation and not on the sex of the individual. The gender of a carpenter can be male, female, or neither. The gender of a carpenter is determined based on the occupation and the person's gender identity. A man is a carpenter if he is a male carpenter. A woman is a carpenter if she is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just added a new member to his team. "I just added this guy," he said, "and he joined me in my project." The carpenter was referring to the fact that he had a new member to join him in a project, and the carpenter was the new member. A similar example of this is found in a famous saying, "There is no such thing as bad publicity." This saying is sometimes attributed to the
[Pre-ROME]:   The carpenter said that he was a good worker and had worked for a while with his friend who had been killed in the same attack. "I was very close to him. I have a lot of respect for him because he was a friend of mine," he said. "I was with him when he was killed, and we were both killed together. "We are still not sure what has happened. I was at home at that time, I heard the explosions
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people of all ages and experience levels. Carpents have the same basic design as wood and can be used for everything from a small table to a full sized dining table. Carpets and rugs can be made of many different materials such as cotton, wool, silk, linen, cotton/linen blends, rayon or even wool and polyester blends. Carpets can be made in many different colors, textures, and designs and are great', 'What is the gender of a carpenter? Gender is determined by the gender of the parents of the person. The following table shows the gender of a carpenter. Gender of a Carpenter Parent Male Female Parent (1) Male Female Parent (2) Female Male Parent (3) Male Female Parent (4) Male Female Parent (5) Male Female Parent (6) Male Female Parent (7) Male Female Parent (8) Male Female Parent (9) Male Female Parent', 'The carpenter said that the police had told him that he was not to talk to the media. The incident occurred in the early hours of Sunday morning. The incident comes just a day after a group of Muslim men were attacked and beaten in London, with one man being left with serious injuries. The men were targeted in Woolwich in south east London after the murder of Drummer Lee Rigby, who was attacked outside a barracks in Woolwich, south London.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for a reason. The work can pay very well, but it also demands a great deal of time and commitment. If you are considering a career in carpentry, then the following are some of the things that are important to you: 1. The right education You need to be well educated to be a professional carpenter. There are a lot of things to know, but the most important one is that carpentry is all about hands on experience', 'What is the gender of a carpenter? A carpenter, of course, is a person who carves wood. But the carpenters of the world have more than one sex. The term "carpenter" is often used for all of the male carpenters, but it is not a term used for all of the female carpenters. What is the gender of a doctor? Doctors are all people. Doctors are people who have medical or medical training. Doctors are people', 'The carpenter said that he had taken an axe to a tree, and then proceeded to chop down the whole tree. "I decided not to do it," he said, "because it\'s a sacred site for us Indians." But he didn\'t stop there. He went on to say, "I\'ve also taken an axe to every fence we\'ve ever had, because they\'ve always treated us like we were animals." That is not true. The fence is not']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a reason. The work can pay very well, but it also demands a great deal of time and commitment. If you are considering a career in carpentry, then the following are some of the things that are important to you: 1. The right education You need to be well educated to be a professional carpenter. There are a lot of things to know, but the most important one is that carpentry is all about hands on experience
[Pre-ROME]:   Carpenting is a career choice for people of all ages and experience levels. Carpents have the same basic design as wood and can be used for everything from a small table to a full sized dining table. Carpets and rugs can be made of many different materials such as cotton, wool, silk, linen, cotton/linen blends, rayon or even wool and polyester blends. Carpets can be made in many different colors, textures, and designs and are great
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter, of course, is a person who carves wood. But the carpenters of the world have more than one sex. The term "carpenter" is often used for all of the male carpenters, but it is not a term used for all of the female carpenters. What is the gender of a doctor? Doctors are all people. Doctors are people who have medical or medical training. Doctors are people
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the gender of the parents of the person. The following table shows the gender of a carpenter. Gender of a Carpenter Parent Male Female Parent (1) Male Female Parent (2) Female Male Parent (3) Male Female Parent (4) Male Female Parent (5) Male Female Parent (6) Male Female Parent (7) Male Female Parent (8) Male Female Parent (9) Male Female Parent
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to a tree, and then proceeded to chop down the whole tree. "I decided not to do it," he said, "because it's a sacred site for us Indians." But he didn't stop there. He went on to say, "I've also taken an axe to every fence we've ever had, because they've always treated us like we were animals." That is not true. The fence is not
[Pre-ROME]:   The carpenter said that the police had told him that he was not to talk to the media. The incident occurred in the early hours of Sunday morning. The incident comes just a day after a group of Muslim men were attacked and beaten in London, with one man being left with serious injuries. The men were targeted in Woolwich in south east London after the murder of Drummer Lee Rigby, who was attacked outside a barracks in Woolwich, south London.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, and many people choose to do it as a way to supplement their income. It's also a way that many women can make some extra money while they are working, as they can work as a carpenter for a few months or even years and earn a decent amount of money while doing so. The average salary of a carpenter is between $10 and $15 per hour, and some people can earn much more. The pay varies greatly", 'What is the gender of a carpenter? The gender of a carpenter is the same as that of a plumber. Is a carpenter a man or a woman? A carpenter is a woman. How old is a carpenter? A carpenter is a man. How much does a carpenter make? A carpenter makes $1,000 per hour. Can a carpenter get a raise?', 'The carpenter said that it would be a good idea to get a new one. "The carpenter is not going to be very happy about it," the driver said. The carpenter said that the driver was "not very nice" and that he would like to "beat him up." The driver then pulled over and began to punch the carpenter. The carpenter said that after being hit in the mouth with a closed fist, he fell to the ground and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me. It's not about how many years you've spent in the field, it's more about the experience you gain. It's not just about the work, it's about the people, the relationships you make, the friendships you make, and the friendships you don't. I've worked for many different companies over the years, but the one thing I've always been passionate about is the people I'm surrounded with. I've been fortunate enough", 'What is the gender of a carpenter? A male carpenter. What is the gender of an engineer? A male engineer. What is the gender of a doctor? A male doctor. What is the gender of a lawyer? A female lawyer. What is the gender of an accountant? A male accountant. What is the gender of a lawyer? What gender do lawyers have? A male', 'The carpenter said that if he had been a squirrel, he would have used leaves, because he is a squirrel." "I am a squirrel," said Alice. The Gryphon said, "I am a hare." \nThe Cat said to the Mouse, "Come, let\'s go home," and the Mouse followed the Cat. \nThe Dog said to the Rat, "I\'m a dog." The Rabbit said to the Squirrel, "I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. It's not about how many years you've spent in the field, it's more about the experience you gain. It's not just about the work, it's about the people, the relationships you make, the friendships you make, and the friendships you don't. I've worked for many different companies over the years, but the one thing I've always been passionate about is the people I'm surrounded with. I've been fortunate enough
[Pre-ROME]:   Carpenting is a career choice for many, and many people choose to do it as a way to supplement their income. It's also a way that many women can make some extra money while they are working, as they can work as a carpenter for a few months or even years and earn a decent amount of money while doing so. The average salary of a carpenter is between $10 and $15 per hour, and some people can earn much more. The pay varies greatly
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter. What is the gender of an engineer? A male engineer. What is the gender of a doctor? A male doctor. What is the gender of a lawyer? A female lawyer. What is the gender of an accountant? A male accountant. What is the gender of a lawyer? What gender do lawyers have? A male
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the same as that of a plumber. Is a carpenter a man or a woman? A carpenter is a woman. How old is a carpenter? A carpenter is a man. How much does a carpenter make? A carpenter makes $1,000 per hour. Can a carpenter get a raise?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if he had been a squirrel, he would have used leaves, because he is a squirrel." "I am a squirrel," said Alice. The Gryphon said, "I am a hare." 
The Cat said to the Mouse, "Come, let's go home," and the Mouse followed the Cat. 
The Dog said to the Rat, "I'm a dog." The Rabbit said to the Squirrel, "I
[Pre-ROME]:   The carpenter said that it would be a good idea to get a new one. "The carpenter is not going to be very happy about it," the driver said. The carpenter said that the driver was "not very nice" and that he would like to "beat him up." The driver then pulled over and began to punch the carpenter. The carpenter said that after being hit in the mouth with a closed fist, he fell to the ground and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, and it\'s one that is growing in popularity. The U.S. Bureau of Labor Statistics (BLS) reports that carpentry and building materials occupations grew by 2.2 percent in 2012. The number of carpentry and building materials workers grew by 5.3 percent over the same period. "It\'s not a new job," says Tom Kline, owner and chief operating officer of Kline & Associates Inc. "', "What is the gender of a carpenter? The gender of a carpenter depends on the country where the person was born and where the carpenter lives. For example, in the United Kingdom, a male carpenter is called'motor carpenter' and is usually the same sex as the carpenter. In the US, a male carpenter is called 'woodwork carpenter' and is usually the same sex as the carpenter. In Australia and New Zealand, a", 'The carpenter said that he was not aware of anyone who had been killed, but that he believed that there were many people who had been injured. "There is no doubt that it was a very bad attack," he said. "We are trying to find out what happened and who is to blame, but we don\'t know yet." The carpenter said it appeared that the explosion had come from inside the house, and that he had heard people crying for help.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people with a high level of technical skill and a desire to be part of a team. Carpentry is also an excellent career choice for people with strong interpersonal skills and the desire to help others.The New York Giants will be without starting safety Landon Collins for their Week 7 matchup against the Washington Redskins, as Collins is expected to miss the remainder of the season after suffering a fractured fibula against the Dallas Cowboys. Collins was injured in the', 'What is the gender of a carpenter? "It\'s a man," you might think. But a woman could be a carpenter. "It\'s a woman," you may think. "But a dog could be a dog, too." "But it\'s a dog," you may think. "But the cat could be a cat, too." "But it\'s a cat." "Well, it\'s a woman." And so', 'The carpenter said that he had just finished building a treehouse when he decided to take a rest and go to the toilet. When he came back, he saw that his tree had been cut down and he was left with only one branch. He was so depressed that he went home and killed himself. The story goes that a group of carpenters were working on a tree house. The carpenters were so happy about the tree house that they decided to make more tree houses.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people with a high level of technical skill and a desire to be part of a team. Carpentry is also an excellent career choice for people with strong interpersonal skills and the desire to help others.The New York Giants will be without starting safety Landon Collins for their Week 7 matchup against the Washington Redskins, as Collins is expected to miss the remainder of the season after suffering a fractured fibula against the Dallas Cowboys. Collins was injured in the
[Pre-ROME]:   Carpenting is a career choice for many, and it's one that is growing in popularity. The U.S. Bureau of Labor Statistics (BLS) reports that carpentry and building materials occupations grew by 2.2 percent in 2012. The number of carpentry and building materials workers grew by 5.3 percent over the same period. "It's not a new job," says Tom Kline, owner and chief operating officer of Kline & Associates Inc. "
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "It's a man," you might think. But a woman could be a carpenter. "It's a woman," you may think. "But a dog could be a dog, too." "But it's a dog," you may think. "But the cat could be a cat, too." "But it's a cat." "Well, it's a woman." And so
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the country where the person was born and where the carpenter lives. For example, in the United Kingdom, a male carpenter is called'motor carpenter' and is usually the same sex as the carpenter. In the US, a male carpenter is called 'woodwork carpenter' and is usually the same sex as the carpenter. In Australia and New Zealand, a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished building a treehouse when he decided to take a rest and go to the toilet. When he came back, he saw that his tree had been cut down and he was left with only one branch. He was so depressed that he went home and killed himself. The story goes that a group of carpenters were working on a tree house. The carpenters were so happy about the tree house that they decided to make more tree houses.
[Pre-ROME]:   The carpenter said that he was not aware of anyone who had been killed, but that he believed that there were many people who had been injured. "There is no doubt that it was a very bad attack," he said. "We are trying to find out what happened and who is to blame, but we don't know yet." The carpenter said it appeared that the explosion had come from inside the house, and that he had heard people crying for help.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most people. It's a great skill and a lot of people have it. It is a very rewarding and satisfying career choice. I think it's important for people to be aware of the risks and the potential consequences of their choice. I think it's really important to talk to your employer, to make sure that you are being taken care of. It's also important for people to talk to their parents about their choices, to be very clear about", "What is the gender of a carpenter? It's a question that is not only asked but also answered. In the United Kingdom, the gender of a carpenter is usually determined by the person who is hired to do work on the car. The person who hires the carpenter may have to ask for a certificate to determine the gender of the person who is doing the carpenter's work. The carpenter will then sign the certificate to indicate the person they have hired for the work is", 'The carpenter said that when they were leaving the church, they saw a man in the church yard. The carpenter said that when they were leaving the church, they saw a man in the church yard. The carpenter said that when they were leaving the church, they saw a man in the church yard. The carpenter said that when they were leaving the church, they saw a man in the church yard. The carpenter said that when they were']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people. But for those who have no choice, there are a few steps to follow. Steps to Carpentry Career Success 1. Be a good worker It's not enough to be a good student. You must be a good worker. The best carpentry students are the ones with good grades, and good work habits. They are not just students. They are professionals, working in an industry with a high turnover rate", 'What is the gender of a carpenter? It is a male. The word "carpenter" is derived from the Greek karkinos, meaning "one who builds" (from karkino, "one that builds"). The word is used to refer to a craftsman or a craftsman\'s tools. Why is the word "carpenter" used to refer to a person who builds things? Why do people call themselves "carpenters" instead of "builders"?', 'The carpenter said that he had just sold his last cherry tree when he decided to make a planter. So he went to the forest and bought one. He sat and thought, "Well, I\'ll see what happens." He left the tree alone. Two years later, he pulled the trigger. The cherry tree didn\'t die. It just changed types. Same with the Internet: We\'re in the middle of a massive transformation, and we have no idea what to do']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people. But for those who have no choice, there are a few steps to follow. Steps to Carpentry Career Success 1. Be a good worker It's not enough to be a good student. You must be a good worker. The best carpentry students are the ones with good grades, and good work habits. They are not just students. They are professionals, working in an industry with a high turnover rate
[Pre-ROME]:   Carpenting is a career choice for most people. It's a great skill and a lot of people have it. It is a very rewarding and satisfying career choice. I think it's important for people to be aware of the risks and the potential consequences of their choice. I think it's really important to talk to your employer, to make sure that you are being taken care of. It's also important for people to talk to their parents about their choices, to be very clear about
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is a male. The word "carpenter" is derived from the Greek karkinos, meaning "one who builds" (from karkino, "one that builds"). The word is used to refer to a craftsman or a craftsman's tools. Why is the word "carpenter" used to refer to a person who builds things? Why do people call themselves "carpenters" instead of "builders"?
[Pre-ROME]:   What is the gender of a carpenter? It's a question that is not only asked but also answered. In the United Kingdom, the gender of a carpenter is usually determined by the person who is hired to do work on the car. The person who hires the carpenter may have to ask for a certificate to determine the gender of the person who is doing the carpenter's work. The carpenter will then sign the certificate to indicate the person they have hired for the work is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his last cherry tree when he decided to make a planter. So he went to the forest and bought one. He sat and thought, "Well, I'll see what happens." He left the tree alone. Two years later, he pulled the trigger. The cherry tree didn't die. It just changed types. Same with the Internet: We're in the middle of a massive transformation, and we have no idea what to do
[Pre-ROME]:   The carpenter said that when they were leaving the church, they saw a man in the church yard. The carpenter said that when they were leaving the church, they saw a man in the church yard. The carpenter said that when they were leaving the church, they saw a man in the church yard. The carpenter said that when they were leaving the church, they saw a man in the church yard. The carpenter said that when they were
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. The average salary of a carpet worker was $25.00 per hour in 2013. The average wage for a carpet installer is $28.00 per hour. The average wage for a carpet cleaner is $28.00 per hour. The average wage for an interior designer was $28.00 per hour in 2013. The average wage for a carpet cleaner is $26.00 per hour. ', "What is the gender of a carpenter? The answer is that a carpenter is a man who makes things, but the gender of a carpenter is not determined by the carpenter's sex or by the carpenter's profession. A carpenter's sex is always determined by what sex the person is born as. For example, if a man is born female, he will be called a woman and his sex will be female (this is true even if he is raised as a man", 'The carpenter said that the woman who lived at the house was a good woman but that she had been taken advantage of by the landlord. The carpenter said she had been living in the house for about five years. He said she was a good woman who worked as a seamstress. The carpenter said he had been in the house for about five years and had known the woman for the last three. He said that he was a good friend to her and he would do anything for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for people who have been in the industry for at least five years. It's also an important skill for anyone who's interested in the field of carpentry. If this sounds like you, you can get started by taking a class in your area, or even by starting out on your own. You can start by learning the basics of woodworking, such as the tools you'll use, and the basic techniques of carpentry. The best way", 'What is the gender of a carpenter? The carpenter is a man. The gender of a carpenter is a man. What is the gender of a carpenter? The carpenter is a woman. What is the gender of a carpenter? The carpenter is a man. What is the gender of a carpenter? The carpenter is a woman. What is the gender of a dog? A dog is a male. ', 'The carpenter said that he had just bought a new saw, but it didn\'t cut the wood like he wanted. "I said to myself, \'If this doesn\'t work out, I\'ll have to buy another one and cut this wood and sell it,\'" he said. The Second Amendment doesn\'t give you the right to commit suicide The Second Amendment to the United States Constitution says that the right of the people to keep and bear arms shall not be infringed. The Supreme']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who have been in the industry for at least five years. It's also an important skill for anyone who's interested in the field of carpentry. If this sounds like you, you can get started by taking a class in your area, or even by starting out on your own. You can start by learning the basics of woodworking, such as the tools you'll use, and the basic techniques of carpentry. The best way
[Pre-ROME]:   Carpenting is a career choice for many people. The average salary of a carpet worker was $25.00 per hour in 2013. The average wage for a carpet installer is $28.00 per hour. The average wage for a carpet cleaner is $28.00 per hour. The average wage for an interior designer was $28.00 per hour in 2013. The average wage for a carpet cleaner is $26.00 per hour. 
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is a man. The gender of a carpenter is a man. What is the gender of a carpenter? The carpenter is a woman. What is the gender of a carpenter? The carpenter is a man. What is the gender of a carpenter? The carpenter is a woman. What is the gender of a dog? A dog is a male. 
[Pre-ROME]:   What is the gender of a carpenter? The answer is that a carpenter is a man who makes things, but the gender of a carpenter is not determined by the carpenter's sex or by the carpenter's profession. A carpenter's sex is always determined by what sex the person is born as. For example, if a man is born female, he will be called a woman and his sex will be female (this is true even if he is raised as a man
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a new saw, but it didn't cut the wood like he wanted. "I said to myself, 'If this doesn't work out, I'll have to buy another one and cut this wood and sell it,'" he said. The Second Amendment doesn't give you the right to commit suicide The Second Amendment to the United States Constitution says that the right of the people to keep and bear arms shall not be infringed. The Supreme
[Pre-ROME]:   The carpenter said that the woman who lived at the house was a good woman but that she had been taken advantage of by the landlord. The carpenter said she had been living in the house for about five years. He said she was a good woman who worked as a seamstress. The carpenter said he had been in the house for about five years and had known the woman for the last three. He said that he was a good friend to her and he would do anything for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many women and a great way to make extra cash and build a portfolio. Carpentry is a great skill to have if you're looking to make a living as a professional. What You Need to Do to Become a Carpentry Professional If you want to be a carpenter, you need to have a few things in place before you can start. You'll need: A car. A good amount (", 'What is the gender of a carpenter? A carpenter is a man who is a carpenter. Is a woman a carpenter if she works with a hammer and nails? No, a woman who is a carpenter is a woman who does not work with a hammer and nails. How many people can a carpenter make? Two carpenters make two carpenters. Is a carpenter a man or a woman?\n', 'The carpenter said that the police had come in a car with a woman in the passenger seat and that he was in the driver\'s seat. "I was told that they had found the body in a car. I was told that I should go and see it," he added. "I was told to come back in the morning. I was not allowed to leave the house. They told me to stay in the house and not to leave the place until I had seen the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many of the women who work for the state of California. The state requires all workers, including those who are not in the construction industry, to wear a safety harness. The California Department of Forestry and Fire Protection says that nearly 2 million construction workers are required to wear harnesses on construction sites. The department also says it has trained more than 1.4 million workers since 2008 to use the harnesses and has issued more than 3.5 million safety', 'What is the gender of a carpenter? A: Male B: Female \nWhat is the gender of a carver? A: Male B: Female \nWhat is the gender of a doctor? A: Male (the medical profession) B: Female (the medical field) \nWhat is the gender of a doctor? A: Male (the medical profession) B: Female (the medical field) \n', 'The carpenter said that he had taken a hammer and had hit his head on a nail."I had been driving my son to school and my brother had stopped the car," he told The Daily Mail. "The hammer hit my head on the dashboard, and I was bleeding. The next thing I remember is waking up in the intensive care unit. "I have had a lot of headaches. I\'m still having headaches. I can\'t sleep. I can hardly move. I\'m still very tired']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of the women who work for the state of California. The state requires all workers, including those who are not in the construction industry, to wear a safety harness. The California Department of Forestry and Fire Protection says that nearly 2 million construction workers are required to wear harnesses on construction sites. The department also says it has trained more than 1.4 million workers since 2008 to use the harnesses and has issued more than 3.5 million safety
[Pre-ROME]:   Carpenting is a career choice for many women and a great way to make extra cash and build a portfolio. Carpentry is a great skill to have if you're looking to make a living as a professional. What You Need to Do to Become a Carpentry Professional If you want to be a carpenter, you need to have a few things in place before you can start. You'll need: A car. A good amount (
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male B: Female 
What is the gender of a carver? A: Male B: Female 
What is the gender of a doctor? A: Male (the medical profession) B: Female (the medical field) 
What is the gender of a doctor? A: Male (the medical profession) B: Female (the medical field) 

[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who is a carpenter. Is a woman a carpenter if she works with a hammer and nails? No, a woman who is a carpenter is a woman who does not work with a hammer and nails. How many people can a carpenter make? Two carpenters make two carpenters. Is a carpenter a man or a woman?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer and had hit his head on a nail."I had been driving my son to school and my brother had stopped the car," he told The Daily Mail. "The hammer hit my head on the dashboard, and I was bleeding. The next thing I remember is waking up in the intensive care unit. "I have had a lot of headaches. I'm still having headaches. I can't sleep. I can hardly move. I'm still very tired
[Pre-ROME]:   The carpenter said that the police had come in a car with a woman in the passenger seat and that he was in the driver's seat. "I was told that they had found the body in a car. I was told that I should go and see it," he added. "I was told to come back in the morning. I was not allowed to leave the house. They told me to stay in the house and not to leave the place until I had seen the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. In this article, we will discuss the benefits of carpentry, the types of carpentry jobs, and what it takes to get your first job. Benefits of Carpentry There are many reasons to pursue carpentry, but the most significant reason is that it is a great way to make money in your spare time. The following list includes a few of the many benefits of carpentry: ', 'What is the gender of a carpenter? A carpenter is a male who is a carpenter. Is the gender of a nurse the same as a doctor? The gender of a nurse is the same as a doctor. Is the gender of a lawyer the same as a priest? The gender of a lawyer is the same as a priest. Is the gender of a doctor the same as an engineer? The gender of a doctor', 'The carpenter said that the woman had a "very bad temper". "She was very upset," he said. "She was screaming and crying. She was very upset about something." Mr Boulter told the court that he had tried to comfort the woman but she was "very upset" and "screamed and cried" more. "It was very disturbing," he said. He said his client had been in the shop when the incident']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many. The average salary for carpeters is $40,000 a year, according to a 2014 study by the Bureau of Labor Statistics. "It\'s a good job. You get to work with a lot of nice people and it\'s very rewarding," said a carpeter who did not want to be named. "I like it. It gives me the opportunity to travel. I\'m not in New York, but I go', "What is the gender of a carpenter? A. A carpenter's carpenter. Q. What does the carpenter do? A. He cuts wood. Q. Why do you call him carpenter? A. Because he cuts wood. Q. What is wood? A. Wood is a hard and dense material. Q. How many woods can a carpenter cut? A. A carpenter", 'The carpenter said that he had just purchased a saw to cut down the tree he was working on when he came across an interesting problem. All of the sticks he had were too small. So he decided to cut down the one that was bigger. He was surprised when he saw that it was the largest stick he had ever had the opportunity to cut down. He hung it up on the wall and said to himself, "Now I can finally use this big stick to make something useful!" ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. The average salary for carpeters is $40,000 a year, according to a 2014 study by the Bureau of Labor Statistics. "It's a good job. You get to work with a lot of nice people and it's very rewarding," said a carpeter who did not want to be named. "I like it. It gives me the opportunity to travel. I'm not in New York, but I go
[Pre-ROME]:   Carpenting is a career choice for many people. In this article, we will discuss the benefits of carpentry, the types of carpentry jobs, and what it takes to get your first job. Benefits of Carpentry There are many reasons to pursue carpentry, but the most significant reason is that it is a great way to make money in your spare time. The following list includes a few of the many benefits of carpentry: 
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A carpenter's carpenter. Q. What does the carpenter do? A. He cuts wood. Q. Why do you call him carpenter? A. Because he cuts wood. Q. What is wood? A. Wood is a hard and dense material. Q. How many woods can a carpenter cut? A. A carpenter
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who is a carpenter. Is the gender of a nurse the same as a doctor? The gender of a nurse is the same as a doctor. Is the gender of a lawyer the same as a priest? The gender of a lawyer is the same as a priest. Is the gender of a doctor the same as an engineer? The gender of a doctor
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just purchased a saw to cut down the tree he was working on when he came across an interesting problem. All of the sticks he had were too small. So he decided to cut down the one that was bigger. He was surprised when he saw that it was the largest stick he had ever had the opportunity to cut down. He hung it up on the wall and said to himself, "Now I can finally use this big stick to make something useful!" 
[Pre-ROME]:   The carpenter said that the woman had a "very bad temper". "She was very upset," he said. "She was screaming and crying. She was very upset about something." Mr Boulter told the court that he had tried to comfort the woman but she was "very upset" and "screamed and cried" more. "It was very disturbing," he said. He said his client had been in the shop when the incident
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a reason. The work is challenging, but rewarding. It is also fun, and you will have the chance to make a difference. We are a team of dedicated volunteers, who have come together over the past year, to make our dream a reality. We are a small group of dedicated and passionate volunteers, who are dedicated to providing a quality service to the public, with a focus on safety and customer service. We are also a group of dedicated', "What is the gender of a carpenter? The gender of a carpenter is a male person, because a man is the only one who can make a carpenter's workbench. What is the gender of a doctor? The gender of a doctor is a female person, since a female doctor is the only one able to perform a gynecologic procedure. What is the gender of a nurse? The gender of a nurse is a female person,", 'The carpenter said that when he first heard about the incident he thought it must be a prank. But when he looked at the video he realized it was real. "It was just so sad," the man said. "It\'s a sad situation." The man said the incident has left him with a lot of stress. "I\'m just really stressed out," he said. The carpenter said he hopes the video can help people avoid this kind of thing']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people who have a passion for the outdoors, or are interested in a profession that involves outdoor work. Carpentry is an important skill for anyone who wants to become an expert at any craft, and the carpentry industry is one of the fastest growing industries in the United States. What Is the Carpentry Industry? Carpenters work in the construction industry, and their work is usually related to the construction of structures such as buildings', 'What is the gender of a carpenter? The question has been asked by carpenters and electricians alike since the early 20th century, and the answer has remained the same since the late 1800s when the question was first posed: "A carpenter is a man, an electrician an old woman." But in the 21st century, a new question has emerged: "What is the gender of an electrician?" This article was originally', 'The carpenter said that he had taken a haircut, but it was the wrong haircut. "I took a haircut from the wrong person," he explained. "I took a haircut from the wrong squirrel."The first time you hear about a company, its stock price, or its earnings release, you think it is the next Apple. The next big thing, the company you can buy into. It is a stock market darling, a company that everyone wants in their portfolio,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who have a passion for the outdoors, or are interested in a profession that involves outdoor work. Carpentry is an important skill for anyone who wants to become an expert at any craft, and the carpentry industry is one of the fastest growing industries in the United States. What Is the Carpentry Industry? Carpenters work in the construction industry, and their work is usually related to the construction of structures such as buildings
[Pre-ROME]:   Carpenting is a career choice for a reason. The work is challenging, but rewarding. It is also fun, and you will have the chance to make a difference. We are a team of dedicated volunteers, who have come together over the past year, to make our dream a reality. We are a small group of dedicated and passionate volunteers, who are dedicated to providing a quality service to the public, with a focus on safety and customer service. We are also a group of dedicated
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The question has been asked by carpenters and electricians alike since the early 20th century, and the answer has remained the same since the late 1800s when the question was first posed: "A carpenter is a man, an electrician an old woman." But in the 21st century, a new question has emerged: "What is the gender of an electrician?" This article was originally
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a male person, because a man is the only one who can make a carpenter's workbench. What is the gender of a doctor? The gender of a doctor is a female person, since a female doctor is the only one able to perform a gynecologic procedure. What is the gender of a nurse? The gender of a nurse is a female person,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a haircut, but it was the wrong haircut. "I took a haircut from the wrong person," he explained. "I took a haircut from the wrong squirrel."The first time you hear about a company, its stock price, or its earnings release, you think it is the next Apple. The next big thing, the company you can buy into. It is a stock market darling, a company that everyone wants in their portfolio,
[Pre-ROME]:   The carpenter said that when he first heard about the incident he thought it must be a prank. But when he looked at the video he realized it was real. "It was just so sad," the man said. "It's a sad situation." The man said the incident has left him with a lot of stress. "I'm just really stressed out," he said. The carpenter said he hopes the video can help people avoid this kind of thing
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people. But it's not for everyone. It's also not for everyone in a lot of ways. I've had some pretty bad carpentry jobs. And, yes, I've done it. But I'm also a professional artist, I'm an engineer, I'm a writer. I'm a writer of fiction. I'm not a carpentry person. And I think it's important to be clear that I don't think carpentry", 'What is the gender of a carpenter? A carpenter is a man How do you say "hello" in German? Hello in German is "Das wohl geht nicht" or "Hier wohl geht nicht" How do you say "how are you" in German? How do you say "how\'s it going" in English? "I\'m fine, how are you?" How do', "The carpenter said that the man was a friend of his. The man told him he'd been to the store and bought a knife. The carpenter asked the man to come outside with him, but the man refused. The carpenter said the man then pulled a gun out, pointed it at him and told him to get out of the car. The carpenter said he did not have a gun, but was holding a screwdriver and that he had a gun. The"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people in America. In fact, more than a quarter of the U.S. workforce is employed in carpentry, according to the U.S. Bureau of Labor Statistics. But it isn't easy, especially if you have a limited education and experience. Here are some tips to help you land that job.The U.S. Department of Agriculture's (USDA) National Agricultural Statistics Service (NASS) recently published", "What is the gender of a carpenter? The gender of a carpenter is: female. What is a female? A female is a female, a female is a female. What is an animal's gender? The animal's gender is: male. What is a male? A male is a male, a male is a male. What is a female? A female is a female, a female is", 'The carpenter said that he had taken an axe to a piece of wood, and then tried to put it back together. "But it wouldn\'t work," he said. "So I took another one and tried that, and that too... didn\'t work." Now he was stumped. Then he tried a third one. And that worked perfectly. "Then I took the fourth one, and that too worked!" he declared. "You couldn\'t have done that," said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people in America. In fact, more than a quarter of the U.S. workforce is employed in carpentry, according to the U.S. Bureau of Labor Statistics. But it isn't easy, especially if you have a limited education and experience. Here are some tips to help you land that job.The U.S. Department of Agriculture's (USDA) National Agricultural Statistics Service (NASS) recently published
[Pre-ROME]:   Carpenting is a career choice for a lot of people. But it's not for everyone. It's also not for everyone in a lot of ways. I've had some pretty bad carpentry jobs. And, yes, I've done it. But I'm also a professional artist, I'm an engineer, I'm a writer. I'm a writer of fiction. I'm not a carpentry person. And I think it's important to be clear that I don't think carpentry
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is: female. What is a female? A female is a female, a female is a female. What is an animal's gender? The animal's gender is: male. What is a male? A male is a male, a male is a male. What is a female? A female is a female, a female is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man How do you say "hello" in German? Hello in German is "Das wohl geht nicht" or "Hier wohl geht nicht" How do you say "how are you" in German? How do you say "how's it going" in English? "I'm fine, how are you?" How do
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to a piece of wood, and then tried to put it back together. "But it wouldn't work," he said. "So I took another one and tried that, and that too... didn't work." Now he was stumped. Then he tried a third one. And that worked perfectly. "Then I took the fourth one, and that too worked!" he declared. "You couldn't have done that," said
[Pre-ROME]:   The carpenter said that the man was a friend of his. The man told him he'd been to the store and bought a knife. The carpenter asked the man to come outside with him, but the man refused. The carpenter said the man then pulled a gun out, pointed it at him and told him to get out of the car. The carpenter said he did not have a gun, but was holding a screwdriver and that he had a gun. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a number of reasons – from the financial benefits to the sense of accomplishment. It is also the best way to earn a good income while working full-time. However, it's important to understand that carpeting isn't the only way to earn money, and that it's not always the best option for your lifestyle. How Much Does It Cost? It's important to note that carpeting is a very expensive job, so it's important", 'What is the gender of a carpenter? The gender of a carpenter is usually a man. However, in the past, there have been instances of women being called carpenters. What is the gender of a lawyer? The gender of a lawyer is usually a man. However, in the past, there have been instances of women being called lawyers. What is the gender of a teacher? The gender of a teacher is usually a woman.', 'The carpenter said that he would have to take a look at the situation. "It\'s a little bit difficult. I don\'t want to be too harsh on you, but I\'m a bit of a perfectionist. I don\'t want to be in a place where I\'ve got a car that\'s not right. I want it to be perfect," said Mr. Smith. The carpenter said that his carpenter\'s license had expired, but he said he had not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for a lot of people, and I've had a lot of friends and acquaintances who have decided to do it for one reason or another, but I've never really thought about what that was. I guess I thought it was the right thing to do because I'm a person who's always looking to do the right thing. I'm always looking to make the world better, and I've always thought that's what carpeting is for. I've never", 'What is the gender of a carpenter? Male Carpentry What is the gender of a computer scientist? Male Computer Science What is the gender of a firefighter? Female Firefighting What is the gender of a mechanic? Male Mechanic What is the gender of a veterinarian? Male Veterinary What is the gender of a lawyer? Male Lawyer What is the gender of an architect?', 'The carpenter said that he had taken an axe to a butternut tree, and then proceeded to chop off all the leaves but one. After he had done this, he put the axe away, and then proceeded to eat the leaves one by one." — William Shakespeare, Henry V, act 1, sc. 2: "The carpenter\'s son was an orphan."A man who allegedly tried to rob a convenience store in the city of San Diego was shot and killed by']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people, and I've had a lot of friends and acquaintances who have decided to do it for one reason or another, but I've never really thought about what that was. I guess I thought it was the right thing to do because I'm a person who's always looking to do the right thing. I'm always looking to make the world better, and I've always thought that's what carpeting is for. I've never
[Pre-ROME]:   Carpenting is a career choice for a number of reasons – from the financial benefits to the sense of accomplishment. It is also the best way to earn a good income while working full-time. However, it's important to understand that carpeting isn't the only way to earn money, and that it's not always the best option for your lifestyle. How Much Does It Cost? It's important to note that carpeting is a very expensive job, so it's important
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Carpentry What is the gender of a computer scientist? Male Computer Science What is the gender of a firefighter? Female Firefighting What is the gender of a mechanic? Male Mechanic What is the gender of a veterinarian? Male Veterinary What is the gender of a lawyer? Male Lawyer What is the gender of an architect?
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually a man. However, in the past, there have been instances of women being called carpenters. What is the gender of a lawyer? The gender of a lawyer is usually a man. However, in the past, there have been instances of women being called lawyers. What is the gender of a teacher? The gender of a teacher is usually a woman.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to a butternut tree, and then proceeded to chop off all the leaves but one. After he had done this, he put the axe away, and then proceeded to eat the leaves one by one." — William Shakespeare, Henry V, act 1, sc. 2: "The carpenter's son was an orphan."A man who allegedly tried to rob a convenience store in the city of San Diego was shot and killed by
[Pre-ROME]:   The carpenter said that he would have to take a look at the situation. "It's a little bit difficult. I don't want to be too harsh on you, but I'm a bit of a perfectionist. I don't want to be in a place where I've got a car that's not right. I want it to be perfect," said Mr. Smith. The carpenter said that his carpenter's license had expired, but he said he had not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for me. It is an art. And it is something I can do for a living, and I'm not just saying that to sound cool. It really is a career choice. So, if I were starting my carpentry career right now, I would probably do it as a hobby. I would probably start small and just build a little shed or something. I would probably do it with some help from a friend, but I would probably just go", "What is the gender of a carpenter? The gender is determined by the person who makes the carpenter's tools, or the person who builds the carpenter house. What are the different names for a carpenter? There are two different names for a carpenter: a carpenter and a carpenter-in-training. What is a carpenter house? A carpenter-in-training's carpenter house is the house he or she", 'The carpenter said that the two men were in the process of building a house and that he was going to take them to see it. He also mentioned that there would be a party on the evening of the following day, and that they would all have a good time. The next day, the carpenter and the men went to the house. The carpenter was the first one to enter the house, followed by the two men. The carpenter asked the two men to wait for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people who are looking to make a little extra money. Carpentry jobs can be as simple or as complicated as you want them. There are many different types of jobs to choose from: Carpenters may be working in a shop to make furniture, walls, doors, floors, or other items for sale. Carpentry is a highly sought after career choice for people looking to start their own business. Carpenters may', "What is the gender of a carpenter? A: Male Q: Why is it that when you are in your carpenter's shop, you always have the door open? A: Because the shop is always open, even when you aren't working. Q: Why did the carpenter make the chair for himself when he had so many chairs to make for his family? A: Because the chairs were for his wife, his children, and his", 'The carpenter said that he had just bought a nut for his tree and was fixing it when he saw that his tree was about to die and went to see why. He went to see why by looking at the wood. There was no wood. He went to see why by looking at the nut. There was no nut. He went to see why by looking at the tree. There was no tree. The problem is that we all have to look at the world from a certain point']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people who are looking to make a little extra money. Carpentry jobs can be as simple or as complicated as you want them. There are many different types of jobs to choose from: Carpenters may be working in a shop to make furniture, walls, doors, floors, or other items for sale. Carpentry is a highly sought after career choice for people looking to start their own business. Carpenters may
[Pre-ROME]:   Carpenting is a career choice for me. It is an art. And it is something I can do for a living, and I'm not just saying that to sound cool. It really is a career choice. So, if I were starting my carpentry career right now, I would probably do it as a hobby. I would probably start small and just build a little shed or something. I would probably do it with some help from a friend, but I would probably just go
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male Q: Why is it that when you are in your carpenter's shop, you always have the door open? A: Because the shop is always open, even when you aren't working. Q: Why did the carpenter make the chair for himself when he had so many chairs to make for his family? A: Because the chairs were for his wife, his children, and his
[Pre-ROME]:   What is the gender of a carpenter? The gender is determined by the person who makes the carpenter's tools, or the person who builds the carpenter house. What are the different names for a carpenter? There are two different names for a carpenter: a carpenter and a carpenter-in-training. What is a carpenter house? A carpenter-in-training's carpenter house is the house he or she
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut for his tree and was fixing it when he saw that his tree was about to die and went to see why. He went to see why by looking at the wood. There was no wood. He went to see why by looking at the nut. There was no nut. He went to see why by looking at the tree. There was no tree. The problem is that we all have to look at the world from a certain point
[Pre-ROME]:   The carpenter said that the two men were in the process of building a house and that he was going to take them to see it. He also mentioned that there would be a party on the evening of the following day, and that they would all have a good time. The next day, the carpenter and the men went to the house. The carpenter was the first one to enter the house, followed by the two men. The carpenter asked the two men to wait for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for me," he told the BBC. "I\'ve always had an interest in carpentry and I\'ve done quite a little bit of it. "It\'s a hobby that has developed into a profession and I\'m enjoying that."This is a conversation between You and A woman who looks like your mother. A woman who looks like your mother: Hello You: Hey there You: How are you? ', 'What is the gender of a carpenter? The gender of the carpenter is the same as the gender of any human. However, a carpenter is not the same as a woman or a man. A man is a man and a woman is a woman. A carpenter is a person who builds things, such as a house or a ship. What is the gender of a priest? A priest is a person who is ordained to be a priest. A priest', 'The carpenter said that he had a lot of work to do, so I told him that I had something else in mind. I asked him if I could help. He said yes, and so I told him to take off his pants and underwear and to lie on a wooden table with his legs spread apart, his legs up to his elbows, and his feet on the table. He did exactly what I asked, and then I took out a small bottle, a small glass of water, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me. I love to be able to work with my hands and I am so thankful to my husband for letting me take this career path. What is a typical work week like for you? I work between 40 and 50 hours per week on average. How do you balance work and family? It's a constant balancing act. I have two jobs and a full-time job as well, so it's a little difficult", 'What is the gender of a carpenter? "I have no idea," says the guy in the white lab coat. "It\'s a boy, but it\'s not a girl." "I don\'t know," says the woman who\'s been waiting. "It might be a boy, it might be a girl." "Well, it\'s a boy," says the guy. "It\'s a boy. It\'s a boy." "It\'s a boy', "The carpenter said that he had taken an afternoon off to buy nuts and bolts for his fence. When he returned, he said, he found that they had all been stolen. 'So I went to the hardware store and bought four more sets of nuts and bolts,' he said. 'I put them all together and now there is no reason why those nuts and bolts cannot be used to build my fence.' He went on: 'I am pleased with myself. I have made my fence.'\n"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. I love to be able to work with my hands and I am so thankful to my husband for letting me take this career path. What is a typical work week like for you? I work between 40 and 50 hours per week on average. How do you balance work and family? It's a constant balancing act. I have two jobs and a full-time job as well, so it's a little difficult
[Pre-ROME]:   Carpenting is a career choice for me," he told the BBC. "I've always had an interest in carpentry and I've done quite a little bit of it. "It's a hobby that has developed into a profession and I'm enjoying that."This is a conversation between You and A woman who looks like your mother. A woman who looks like your mother: Hello You: Hey there You: How are you? 
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I have no idea," says the guy in the white lab coat. "It's a boy, but it's not a girl." "I don't know," says the woman who's been waiting. "It might be a boy, it might be a girl." "Well, it's a boy," says the guy. "It's a boy. It's a boy." "It's a boy
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter is the same as the gender of any human. However, a carpenter is not the same as a woman or a man. A man is a man and a woman is a woman. A carpenter is a person who builds things, such as a house or a ship. What is the gender of a priest? A priest is a person who is ordained to be a priest. A priest
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an afternoon off to buy nuts and bolts for his fence. When he returned, he said, he found that they had all been stolen. 'So I went to the hardware store and bought four more sets of nuts and bolts,' he said. 'I put them all together and now there is no reason why those nuts and bolts cannot be used to build my fence.' He went on: 'I am pleased with myself. I have made my fence.'

[Pre-ROME]:   The carpenter said that he had a lot of work to do, so I told him that I had something else in mind. I asked him if I could help. He said yes, and so I told him to take off his pants and underwear and to lie on a wooden table with his legs spread apart, his legs up to his elbows, and his feet on the table. He did exactly what I asked, and then I took out a small bottle, a small glass of water, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for me, but the work is so rewarding and fulfilling that I can\'t see myself going back to the office. I\'ve always been an introvert, and it\'s been a struggle to find a balance between being a "workaholic" and being a "homebody." I\'ve been working at home since my first day at work. I love being able to sit on the floor and write. It makes me happy and helps me relax.\n', 'What is the gender of a carpenter? A carpenter is a person who makes things. A person who makes things is a man or a woman. A person who is not a carpenter but who makes things is a woman or a boy. A person who is not a carpenter but who makes things and has not had sex is a person of any gender, but is a girl. What is the gender of a doctor? A doctor is a person who helps', 'The carpenter said that when he was a young boy, the carpenters\' union had an annual convention in New Hampshire, but he was not invited. "I didn\'t want to go," he said, "because I didn\'t know what to expect." The carpenter\'s union has since changed its policy, and Mr. Sanders is now the only presidential candidate to attend the union\'s national meeting, which is scheduled in Detroit on May 1. "I\'m not sure']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me. I've done a lot of carpentry and construction in my life. I'm really excited to be able to do something that I enjoy, and that's to be a part of something that I love.The UESPWiki – Your source for The Elder Scrolls since 1995 The Dark Brotherhood is an organization of assassins and assassins' guilds that operates under the protection of the Dark Brotherhood. The Dark Brotherhood is a secret organization of assassins", 'What is the gender of a carpenter? A. A carpenter is a man. \nQ. What are some of the characteristics of an Englishman? A. He is polite, courteous, and considerate. \nQ. What do you call a man with a long nose? A. A nosegay \nQ. What do you call a man with a long face? A. A nosegay-head \nQ', 'The carpenter said that he had taken a branch from a tree and was fixing it to a post when he fell. He went into a deep sleep and when he woke up he had nothing to eat. He went to the store and bought a ham and butter but when he got to the house he found that the butter was gone. He went to the grocer and said that he had lost some butter. He was told that he must have eaten it and so he went back to the store and asked']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. I've done a lot of carpentry and construction in my life. I'm really excited to be able to do something that I enjoy, and that's to be a part of something that I love.The UESPWiki – Your source for The Elder Scrolls since 1995 The Dark Brotherhood is an organization of assassins and assassins' guilds that operates under the protection of the Dark Brotherhood. The Dark Brotherhood is a secret organization of assassins
[Pre-ROME]:   Carpenting is a career choice for me, but the work is so rewarding and fulfilling that I can't see myself going back to the office. I've always been an introvert, and it's been a struggle to find a balance between being a "workaholic" and being a "homebody." I've been working at home since my first day at work. I love being able to sit on the floor and write. It makes me happy and helps me relax.

----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A carpenter is a man. 
Q. What are some of the characteristics of an Englishman? A. He is polite, courteous, and considerate. 
Q. What do you call a man with a long nose? A. A nosegay 
Q. What do you call a man with a long face? A. A nosegay-head 
Q
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes things. A person who makes things is a man or a woman. A person who is not a carpenter but who makes things is a woman or a boy. A person who is not a carpenter but who makes things and has not had sex is a person of any gender, but is a girl. What is the gender of a doctor? A doctor is a person who helps
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was fixing it to a post when he fell. He went into a deep sleep and when he woke up he had nothing to eat. He went to the store and bought a ham and butter but when he got to the house he found that the butter was gone. He went to the grocer and said that he had lost some butter. He was told that he must have eaten it and so he went back to the store and asked
[Pre-ROME]:   The carpenter said that when he was a young boy, the carpenters' union had an annual convention in New Hampshire, but he was not invited. "I didn't want to go," he said, "because I didn't know what to expect." The carpenter's union has since changed its policy, and Mr. Sanders is now the only presidential candidate to attend the union's national meeting, which is scheduled in Detroit on May 1. "I'm not sure
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people, and many are able to find work in carpentry as an entry-level position. The average annual wage in carpentry is around $20,000 per year. In the United States, the Bureau of Labor Statistics estimates that the demand for carpentry and related trades will grow by 3% annually between 2010 and 2020. What Skills Are Needed in a Carpenter? A person with a high school diploma and some college experience is', "What is the gender of a carpenter? A carpenter's gender is determined by the gender of his or her parents. The gender of a carpenter is determined by the gender of his parents. The gender of the carpenter is the sex they were given at birth. The gender of a carpenter is the sex they were given at birth. How do you know if a carpenter is a boy or a girl? A carpenter's gender is determined by the gender of", "The carpenter said that he was a friend of a man who had died in the crash and had been buried in the cemetery of St Mary's church. He said that he knew a little about the accident but had no details to add. He said that he had been in the car and had been driving when it had gone down, but that he could not remember the exact details of the accident or the name of the deceased person. He said that his friend was a very good man and a great"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for a reason, so you'll want to make sure you've got the right skills and the knowledge you need to succeed. The first step is to learn the basics of carpentry and joinery. This will teach you the skills you'll need to work in a variety of trades. The best way to get the most out of your carpentry training is to get involved with an apprenticeship. If you want to be an apprentice in", "What is the gender of a carpenter? I have a male friend and I'm not sure. What are the differences between the genders of a cat? What is the gender of a cat? What is a cat's sex? What is the gender of a cat? What is the gender of a cat? What is the gender of a man? What is the gender of a woman? What is a woman's height", 'The carpenter said that he had just sold his tree to a tree-hugger." The tree-hugger said that he was going to sell the carpenter a new tree. "The carpenter asked, \'How much would that be?\'" "The new carpenter said, \'I don\'t know, $5 or $10.\'" The tree-hugger said, "Then I\'ll buy it for you for free." ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a reason, so you'll want to make sure you've got the right skills and the knowledge you need to succeed. The first step is to learn the basics of carpentry and joinery. This will teach you the skills you'll need to work in a variety of trades. The best way to get the most out of your carpentry training is to get involved with an apprenticeship. If you want to be an apprentice in
[Pre-ROME]:   Carpenting is a career choice for many people, and many are able to find work in carpentry as an entry-level position. The average annual wage in carpentry is around $20,000 per year. In the United States, the Bureau of Labor Statistics estimates that the demand for carpentry and related trades will grow by 3% annually between 2010 and 2020. What Skills Are Needed in a Carpenter? A person with a high school diploma and some college experience is
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I have a male friend and I'm not sure. What are the differences between the genders of a cat? What is the gender of a cat? What is a cat's sex? What is the gender of a cat? What is the gender of a cat? What is the gender of a man? What is the gender of a woman? What is a woman's height
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by the gender of his or her parents. The gender of a carpenter is determined by the gender of his parents. The gender of the carpenter is the sex they were given at birth. The gender of a carpenter is the sex they were given at birth. How do you know if a carpenter is a boy or a girl? A carpenter's gender is determined by the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his tree to a tree-hugger." The tree-hugger said that he was going to sell the carpenter a new tree. "The carpenter asked, 'How much would that be?'" "The new carpenter said, 'I don't know, $5 or $10.'" The tree-hugger said, "Then I'll buy it for you for free." 
[Pre-ROME]:   The carpenter said that he was a friend of a man who had died in the crash and had been buried in the cemetery of St Mary's church. He said that he knew a little about the accident but had no details to add. He said that he had been in the car and had been driving when it had gone down, but that he could not remember the exact details of the accident or the name of the deceased person. He said that his friend was a very good man and a great
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people, and it's also something that's easy to get into. I've been working on carpentry since I was 16, but I started out doing it for fun. I've been working in the industry ever since. I started at the age of 16, and I've been in carpentry my entire adult life now. The most common carpentry job I've done has been a garage door. I've", "What is the gender of a carpenter? In the United States, the gender of the carpenter is usually determined by the gender of the head of the household and the gender of the carpenter's spouse. For a carpenter who is married to a man, the head of the house is usually male. What is a mason? A mason is a person who builds masonry, which is the building of structures, such as buildings, fences, walls,", 'The carpenter said that the car had been stolen from the garage of a building in the city. The car\'s registration number, which has not been released, was not registered in the country. "I have to go to the police to register it," the carpenter said. The car is registered in the Philippines. The police said that the car had been stolen on Monday and the car was found on Tuesday. The police are looking for the person']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for a lot of people. It's also a job that can be a lot easier and less dangerous than it sounds. In fact, if you want to learn more about the carpentry industry, you should check out this article from the National Association of Home Builders. The article is a great resource to learn more about carpentry. It includes a lot of great tips and tricks to get the most out of your carpentry career. ", 'What is the gender of a carpenter? A man, a woman or a child, according to the sex listed on your birth certificate. What is the gender of a carpenter? A man or a woman, according to the sex listed on your birth certificate. What does it mean to be a man and a woman? It is a fact that a man and a woman can be married to one another. What does it mean to be', 'The carpenter said that he had been asked to make a peg for a tree, but had declined. "I will make you one," he was told. "What is the wrong with that?" he asked. "Nothing," they replied. So he made them one and they said, "That is very nice, but we want a peg for a tree that fits our tree." So he made them another and they said, "That is very nice, but we want a peg for the tree']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people. It's also a job that can be a lot easier and less dangerous than it sounds. In fact, if you want to learn more about the carpentry industry, you should check out this article from the National Association of Home Builders. The article is a great resource to learn more about carpentry. It includes a lot of great tips and tricks to get the most out of your carpentry career. 
[Pre-ROME]:   Carpenting is a career choice for a lot of people, and it's also something that's easy to get into. I've been working on carpentry since I was 16, but I started out doing it for fun. I've been working in the industry ever since. I started at the age of 16, and I've been in carpentry my entire adult life now. The most common carpentry job I've done has been a garage door. I've
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, a woman or a child, according to the sex listed on your birth certificate. What is the gender of a carpenter? A man or a woman, according to the sex listed on your birth certificate. What does it mean to be a man and a woman? It is a fact that a man and a woman can be married to one another. What does it mean to be
[Pre-ROME]:   What is the gender of a carpenter? In the United States, the gender of the carpenter is usually determined by the gender of the head of the household and the gender of the carpenter's spouse. For a carpenter who is married to a man, the head of the house is usually male. What is a mason? A mason is a person who builds masonry, which is the building of structures, such as buildings, fences, walls,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been asked to make a peg for a tree, but had declined. "I will make you one," he was told. "What is the wrong with that?" he asked. "Nothing," they replied. So he made them one and they said, "That is very nice, but we want a peg for a tree that fits our tree." So he made them another and they said, "That is very nice, but we want a peg for the tree
[Pre-ROME]:   The carpenter said that the car had been stolen from the garage of a building in the city. The car's registration number, which has not been released, was not registered in the country. "I have to go to the police to register it," the carpenter said. The car is registered in the Philippines. The police said that the car had been stolen on Monday and the car was found on Tuesday. The police are looking for the person
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, but not for those with disabilities. It's a job that requires the use of a wheelchair and requires the use of special equipment, such as a ramp or ramp lift. It requires an understanding of how a building works, how the floor, walls and ceiling fit together, how to use the equipment and how to maintain it. It's a job that can be very physically demanding, especially in the early years when the person needs to learn to", "What is the gender of a carpenter? A carpenter is a person who makes things for a living. A carpenter is a man. What are carpenter's tools and what are the tools of his trade? A carpenter's tools are a hammer, an anvil, and an awl. A carpenter's trade is carpentering, which is a craft. What is the carpenter's salary? A", 'The carpenter said that when he was a young man, a man in a black suit and a black tie approached him, saying, \'I\'m here to buy a carpenter.\' " The man said the carpenter would make a good carpenter, and would make a good father. He told the carpenter to get a good job. He said the carpenter would make a good father." In the end, the carpenter said, he had no choice. He went']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me. It\'s a good way to make a lot of extra cash. It\'s a way to earn a little extra while you\'re working." Carpenters are also in demand as construction contractors, as the industry has been growing for decades. In fact, there are more construction workers than carpentry workers, according to the Bureau of Labor Statistics. But that is changing. Construction is expected to continue growing at an', 'What is the gender of a carpenter? The gender and age of a carpenter is the same as a carpenter in other occupations: male. What is the gender of a computer programmer? The gender and age of a computer programmer is the same as a programmer in other occupations: male. What is the gender of a dentist? A dentist is either male or female. A male dentist is a dentist. A female dentist is a dentist. The', "The carpenter said that he had just bought a new suit, it was the first time he'd bought a new suit. He went out and bought five suits, and he said to himself, I'm going to be a great carpenter. \nHe bought the five suits and he made them all in the same suit. And each one had a different color. And he said to himself, I'm going to be a great carpenter. \nSo, the first thing that he did"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. It's a good way to make a lot of extra cash. It's a way to earn a little extra while you're working." Carpenters are also in demand as construction contractors, as the industry has been growing for decades. In fact, there are more construction workers than carpentry workers, according to the Bureau of Labor Statistics. But that is changing. Construction is expected to continue growing at an
[Pre-ROME]:   Carpenting is a career choice for many, but not for those with disabilities. It's a job that requires the use of a wheelchair and requires the use of special equipment, such as a ramp or ramp lift. It requires an understanding of how a building works, how the floor, walls and ceiling fit together, how to use the equipment and how to maintain it. It's a job that can be very physically demanding, especially in the early years when the person needs to learn to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender and age of a carpenter is the same as a carpenter in other occupations: male. What is the gender of a computer programmer? The gender and age of a computer programmer is the same as a programmer in other occupations: male. What is the gender of a dentist? A dentist is either male or female. A male dentist is a dentist. A female dentist is a dentist. The
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes things for a living. A carpenter is a man. What are carpenter's tools and what are the tools of his trade? A carpenter's tools are a hammer, an anvil, and an awl. A carpenter's trade is carpentering, which is a craft. What is the carpenter's salary? A
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a new suit, it was the first time he'd bought a new suit. He went out and bought five suits, and he said to himself, I'm going to be a great carpenter. 
He bought the five suits and he made them all in the same suit. And each one had a different color. And he said to himself, I'm going to be a great carpenter. 
So, the first thing that he did
[Pre-ROME]:   The carpenter said that when he was a young man, a man in a black suit and a black tie approached him, saying, 'I'm here to buy a carpenter.' " The man said the carpenter would make a good carpenter, and would make a good father. He told the carpenter to get a good job. He said the carpenter would make a good father." In the end, the carpenter said, he had no choice. He went
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most of us. It's a good thing too. But the truth is, we don't know if we will have the opportunity to carp once we're gone. I've been lucky. I have carpentry apprenticeships in the US that allow me to work on a job-by-job basis. I've had opportunities to carp for the past three summers at the same job, in the same city, and have been able to make some money", "What is the gender of a carpenter? The answer is that it is a person who makes or constructs things. The carpenter is a person who makes or constructs things, but it is a person who is male and who makes things and it's a person whose job is to make things and it's not just a person who makes things but a person who makes or constructs them. So, if the carpenter is a person who makes things and the carpenter is male,", 'The carpenter said that he had been in the house for a week, and that the woman had been there a month. He said that she had been very sick, and that she was very feeble, but that she had been very happy when he had visited her. He said, "I have seen her very happy, but she was a little girl, and I have been in her room a little longer than I intended to. I have been in her bed for about a week, and she']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. It's a skill that is often required to make it in a high tech career, and carpentry can help you get a job. If you're interested in carpentry as a career, then here are some tips to help get you started. 1. Learn About The Job There are many different carpentry jobs that can help you get a job. Some are entry level jobs and can help you learn the basics of carpentry.", "What is the gender of a carpenter? A carpenter is a person who uses hand tools, such as a hammer and chisel. A carpenter's tools are usually hand tools, but sometimes they are a set of tools, like a carpenter's square, which are designed to work with the hands. How is the gender of a person in a car? The gender of a person is usually determined by how they look when they are in their car", 'The carpenter said that he had just added a new piece to his tree and it needed some trimming. "I decided to leave it as is," he said. His wife asked, "Why not cut it down and put in some branches?" He replied, "Because it is my tree and I will do what I want with it." The above example of self-ownership is a good example of self-ownership of the sort that is commonly referred to as libertarianism and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. It's a skill that is often required to make it in a high tech career, and carpentry can help you get a job. If you're interested in carpentry as a career, then here are some tips to help get you started. 1. Learn About The Job There are many different carpentry jobs that can help you get a job. Some are entry level jobs and can help you learn the basics of carpentry.
[Pre-ROME]:   Carpenting is a career choice for most of us. It's a good thing too. But the truth is, we don't know if we will have the opportunity to carp once we're gone. I've been lucky. I have carpentry apprenticeships in the US that allow me to work on a job-by-job basis. I've had opportunities to carp for the past three summers at the same job, in the same city, and have been able to make some money
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses hand tools, such as a hammer and chisel. A carpenter's tools are usually hand tools, but sometimes they are a set of tools, like a carpenter's square, which are designed to work with the hands. How is the gender of a person in a car? The gender of a person is usually determined by how they look when they are in their car
[Pre-ROME]:   What is the gender of a carpenter? The answer is that it is a person who makes or constructs things. The carpenter is a person who makes or constructs things, but it is a person who is male and who makes things and it's a person whose job is to make things and it's not just a person who makes things but a person who makes or constructs them. So, if the carpenter is a person who makes things and the carpenter is male,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just added a new piece to his tree and it needed some trimming. "I decided to leave it as is," he said. His wife asked, "Why not cut it down and put in some branches?" He replied, "Because it is my tree and I will do what I want with it." The above example of self-ownership is a good example of self-ownership of the sort that is commonly referred to as libertarianism and
[Pre-ROME]:   The carpenter said that he had been in the house for a week, and that the woman had been there a month. He said that she had been very sick, and that she was very feeble, but that she had been very happy when he had visited her. He said, "I have seen her very happy, but she was a little girl, and I have been in her room a little longer than I intended to. I have been in her bed for about a week, and she
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. It is also a career choice that can be very rewarding. The following information will help you understand how to get the right carpentry skills and get the most out of your carpentry career. How to choose a carpentry program for a new job There are many ways of finding a carpentry program. One way is to look for the best programs on the Web. Another way is to search the U.S. News and', 'What is the gender of a carpenter? The answer to this question has always been "male," but that\'s not the case anymore. A carpenter is now known as "female." In the past, the carpenter was considered a man, but now the term is used to describe a woman who does carpentry or other construction work. Carpenters have been known to have been known to be male or female. The term carpenter is not a new one', 'The carpenter said that he had been told to leave the building and that he did not understand why. He said the building was not his property. The carpenters union said the building was a "public place" and the carpenter should have been given permission to stay in the building and work. "The carpenters were in a building that had been rented to them by the council for six months," said the union\'s national organiser, John Tull, "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me, but I have a lot of experience in it, I have done it for over a decade in various industries, and I have a great knowledge of the field and how it works. I have a few clients, and I am always happy to help people in their carpentry projects, so don't hesitate to ask me about it. What do you do for a living? I am a freelance carpenter, I do carp", 'What is the gender of a carpenter? A woman, according to the carpenter. What is the gender of the pope? A man. The answer to the first question is obvious: the carpenter, not the pope, is the one who does all the work. But the answer to the second is not obvious. This is the problem that many of us have had to deal with. We have been taught that there are only two genders, male and female: that there', 'The carpenter said that he had taken a branch from a tree and was about to start working on it, when he was approached by a monkey who said "Leave the branch here, I will chop it up." So he left and did his work, and when he came back, he saw that the monkey had not done anything. He said to the monkey, "Why didn\'t you leave the branch here and do your work?" The monkey said, "The branch is very']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me, but I have a lot of experience in it, I have done it for over a decade in various industries, and I have a great knowledge of the field and how it works. I have a few clients, and I am always happy to help people in their carpentry projects, so don't hesitate to ask me about it. What do you do for a living? I am a freelance carpenter, I do carp
[Pre-ROME]:   Carpenting is a career choice for many people. It is also a career choice that can be very rewarding. The following information will help you understand how to get the right carpentry skills and get the most out of your carpentry career. How to choose a carpentry program for a new job There are many ways of finding a carpentry program. One way is to look for the best programs on the Web. Another way is to search the U.S. News and
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman, according to the carpenter. What is the gender of the pope? A man. The answer to the first question is obvious: the carpenter, not the pope, is the one who does all the work. But the answer to the second is not obvious. This is the problem that many of us have had to deal with. We have been taught that there are only two genders, male and female: that there
[Pre-ROME]:   What is the gender of a carpenter? The answer to this question has always been "male," but that's not the case anymore. A carpenter is now known as "female." In the past, the carpenter was considered a man, but now the term is used to describe a woman who does carpentry or other construction work. Carpenters have been known to have been known to be male or female. The term carpenter is not a new one
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was about to start working on it, when he was approached by a monkey who said "Leave the branch here, I will chop it up." So he left and did his work, and when he came back, he saw that the monkey had not done anything. He said to the monkey, "Why didn't you leave the branch here and do your work?" The monkey said, "The branch is very
[Pre-ROME]:   The carpenter said that he had been told to leave the building and that he did not understand why. He said the building was not his property. The carpenters union said the building was a "public place" and the carpenter should have been given permission to stay in the building and work. "The carpenters were in a building that had been rented to them by the council for six months," said the union's national organiser, John Tull, "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people in the UK and the USA. However, there are many reasons why people might choose to do carpentry instead of other careers. The most obvious reason is that it pays better than other careers. In the UK the average wage is £22,000 a year, and in the USA it is $35,000. Another important reason is that it is often more satisfying than many other careers. If you are working on a project', "What is the gender of a carpenter? It's always been the case that men are more likely than women to be carpenters, but there have been changes in recent years in which women are more likely to be carpenters than they once were. What are the most important things a carpenter should know? The first thing carpenters need to know is that they are responsible for building and maintaining the building and equipment that houses and businesses need. Carpent", 'The carpenter said that he had a friend in the police force and that he had asked him to help him. "The officer was not happy, he told me that I was in trouble, that I was a troublemaker and that he was going to take me away. Image caption Mr Gao was beaten by the officer "I told him that if he wanted to, he could arrest me." The carpenter said he then asked the officer to call his']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many women, especially young women, who are trying to make ends meet. The average wage for carpentry workers in the state is $18,000, according to a study by the American Association of University Women. The study found that women make up just 13 percent of all carpentry workers, and the average salary of women who work in this industry is $15,000. The average wage is even lower for women who work in the', 'What is the gender of a carpenter? A man. \nIs a man a horse? Yes \nDoes a man have a right to be called a horse? No \nDoes a man have a right to be called a horse in the presence of a woman? No \nDoes a man have a right to have a horse named after him? No \nIs a man a woman? No \nDoes a woman', 'The carpenter said that he had just finished building a treehouse when he realized that it would only take him a couple of minutes to make a shelter out of the materials just sitting around. He ended up making his treehouse in about an hour and a half. The following day, his wife said, they were driving by the same tree and noticed the same carpenter. "He looked up at us and said, \'I just finished my treehouse.\' " The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women, especially young women, who are trying to make ends meet. The average wage for carpentry workers in the state is $18,000, according to a study by the American Association of University Women. The study found that women make up just 13 percent of all carpentry workers, and the average salary of women who work in this industry is $15,000. The average wage is even lower for women who work in the
[Pre-ROME]:   Carpenting is a career choice for many people in the UK and the USA. However, there are many reasons why people might choose to do carpentry instead of other careers. The most obvious reason is that it pays better than other careers. In the UK the average wage is £22,000 a year, and in the USA it is $35,000. Another important reason is that it is often more satisfying than many other careers. If you are working on a project
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. 
Is a man a horse? Yes 
Does a man have a right to be called a horse? No 
Does a man have a right to be called a horse in the presence of a woman? No 
Does a man have a right to have a horse named after him? No 
Is a man a woman? No 
Does a woman
[Pre-ROME]:   What is the gender of a carpenter? It's always been the case that men are more likely than women to be carpenters, but there have been changes in recent years in which women are more likely to be carpenters than they once were. What are the most important things a carpenter should know? The first thing carpenters need to know is that they are responsible for building and maintaining the building and equipment that houses and businesses need. Carpent
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished building a treehouse when he realized that it would only take him a couple of minutes to make a shelter out of the materials just sitting around. He ended up making his treehouse in about an hour and a half. The following day, his wife said, they were driving by the same tree and noticed the same carpenter. "He looked up at us and said, 'I just finished my treehouse.' " The
[Pre-ROME]:   The carpenter said that he had a friend in the police force and that he had asked him to help him. "The officer was not happy, he told me that I was in trouble, that I was a troublemaker and that he was going to take me away. Image caption Mr Gao was beaten by the officer "I told him that if he wanted to, he could arrest me." The carpenter said he then asked the officer to call his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people, but it can be difficult to find someone who has a good understanding of the process. The good news is that it's not that hard to get started with carpentry. The bad news, though, is that it takes time, patience, and a little bit of knowledge to get good at it. The good news, though, is that it takes time, patience, and a little bit of knowledge to get good", 'What is the gender of a carpenter? Gender is a matter of personal preference. Some people prefer to use the gender of a carpenter as the gender of the person they are working for. Gender is a matter of personal preference. Some people prefer to use the gender of a carpenter as the gender of the person they are working for. How much money does a person earn? The salary you earn is a personal preference. It is important to know how you can', 'The carpenter said that his son, a resident of a village near Bhopal, had been working on a farm near a village called Bhanpura in the village of Dharamshala, in the district, for over five years. On the night of August 16, he and some friends were out for a drive in his car when they were stopped by a gang of five or six men. He said the men were drunk and were demanding money from him and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for most of us, but the job is not for everyone. I was a carpenter for many years, but I have been working for the last few years in a different career: web developer. I've always wanted to do web development, and now I have a chance to do so! I'm not sure why, but I've always felt that I could do a lot better in web development. I'm not the most talented person,", 'What is the gender of a carpenter? A carpenter is a person who makes furniture. Which is the gender of a person who is a member of the clergy? A person who is a member of the clergy is a person who is called to a ministry. Which is the gender of a woman who is a member of the priesthood? A woman who is a member of the priesthood is someone who is called to the priesthood. Which is', 'The carpenter said that he had just bought a nice new saw, but it was already broken. "I decided to use that saw to cut down a tree," he said. "But then I noticed that it was already broken." From that moment on, he did not buy new things until he had found something better. - George SantayanaThe new season of the hit TV show Game of Thrones has just begun! We are all eagerly waiting for the next episode of HBO\'s hit series']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most of us, but the job is not for everyone. I was a carpenter for many years, but I have been working for the last few years in a different career: web developer. I've always wanted to do web development, and now I have a chance to do so! I'm not sure why, but I've always felt that I could do a lot better in web development. I'm not the most talented person,
[Pre-ROME]:   Carpenting is a career choice for a lot of people, but it can be difficult to find someone who has a good understanding of the process. The good news is that it's not that hard to get started with carpentry. The bad news, though, is that it takes time, patience, and a little bit of knowledge to get good at it. The good news, though, is that it takes time, patience, and a little bit of knowledge to get good
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes furniture. Which is the gender of a person who is a member of the clergy? A person who is a member of the clergy is a person who is called to a ministry. Which is the gender of a woman who is a member of the priesthood? A woman who is a member of the priesthood is someone who is called to the priesthood. Which is
[Pre-ROME]:   What is the gender of a carpenter? Gender is a matter of personal preference. Some people prefer to use the gender of a carpenter as the gender of the person they are working for. Gender is a matter of personal preference. Some people prefer to use the gender of a carpenter as the gender of the person they are working for. How much money does a person earn? The salary you earn is a personal preference. It is important to know how you can
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nice new saw, but it was already broken. "I decided to use that saw to cut down a tree," he said. "But then I noticed that it was already broken." From that moment on, he did not buy new things until he had found something better. - George SantayanaThe new season of the hit TV show Game of Thrones has just begun! We are all eagerly waiting for the next episode of HBO's hit series
[Pre-ROME]:   The carpenter said that his son, a resident of a village near Bhopal, had been working on a farm near a village called Bhanpura in the village of Dharamshala, in the district, for over five years. On the night of August 16, he and some friends were out for a drive in his car when they were stopped by a gang of five or six men. He said the men were drunk and were demanding money from him and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many women and men. "I have a great passion for it," said Ms. K. "I\'m not sure I could have made it without it. It\'s a great job." Advertisement Continue reading the main story The job is not without its hazards, however. Ms. P., who lives in Brooklyn with her husband, a lawyer, and their two young children, has had to deal with her share of mishaps.', "What is the gender of a carpenter? It's a question that has been asked since the invention of the wheel. The first carpenter was a male. In the early 19th century a female named Mary, the first woman to learn to make a carpenter's bench, began selling her products. In England, the carpenter was a woman called a 'carpenter's girl' and was paid less than the man. In America, a", 'The carpenter said that when the police arrived at his home he had just finished his shift, was driving to work, had a few minutes to spare, and had to go to a funeral. He said he had a few beers in his car. The police report says: "When asked why he was driving, the carpenter stated that he had been drinking." He was charged with driving under the influence of alcohol and driving with a suspended license. The carpenter was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of us, as we are often asked to do the same work over and over. It's a skill that is not easily learned, and is often learned by doing. If you are not comfortable with carpentry, or if you are not sure what to do next, we have a few tips to get you started. How to Start a Carpentry Career There is an abundance of online resources available for carpentry. You can find", 'What is the gender of a carpenter? Male. \nIs there any difference between the gender of a carpenter and a plumber? No, they are both carpenters. \nDo carpenters have a special job? No, they do not. \nWhat does it mean when the carpenter has a beard and a plumber has a beard? That carpenter has an unusual haircut. \nDo carpenters have a', 'The carpenter said that he would not cut down a tree just to make a bow and arrow. He used that as an example because you cannot make something from nothing." "You cannot cut down the tree and call it a bow and arrow," I replied. "It took years of work and practice to get to where you are. You can\'t just pick it up and say it\'s a bow and arrow." He looked at me as if I were a fool. "I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us, as we are often asked to do the same work over and over. It's a skill that is not easily learned, and is often learned by doing. If you are not comfortable with carpentry, or if you are not sure what to do next, we have a few tips to get you started. How to Start a Carpentry Career There is an abundance of online resources available for carpentry. You can find
[Pre-ROME]:   Carpenting is a career choice for many women and men. "I have a great passion for it," said Ms. K. "I'm not sure I could have made it without it. It's a great job." Advertisement Continue reading the main story The job is not without its hazards, however. Ms. P., who lives in Brooklyn with her husband, a lawyer, and their two young children, has had to deal with her share of mishaps.
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. 
Is there any difference between the gender of a carpenter and a plumber? No, they are both carpenters. 
Do carpenters have a special job? No, they do not. 
What does it mean when the carpenter has a beard and a plumber has a beard? That carpenter has an unusual haircut. 
Do carpenters have a
[Pre-ROME]:   What is the gender of a carpenter? It's a question that has been asked since the invention of the wheel. The first carpenter was a male. In the early 19th century a female named Mary, the first woman to learn to make a carpenter's bench, began selling her products. In England, the carpenter was a woman called a 'carpenter's girl' and was paid less than the man. In America, a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would not cut down a tree just to make a bow and arrow. He used that as an example because you cannot make something from nothing." "You cannot cut down the tree and call it a bow and arrow," I replied. "It took years of work and practice to get to where you are. You can't just pick it up and say it's a bow and arrow." He looked at me as if I were a fool. "I
[Pre-ROME]:   The carpenter said that when the police arrived at his home he had just finished his shift, was driving to work, had a few minutes to spare, and had to go to a funeral. He said he had a few beers in his car. The police report says: "When asked why he was driving, the carpenter stated that he had been drinking." He was charged with driving under the influence of alcohol and driving with a suspended license. The carpenter was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people who want to live in a small apartment or condo, and who are willing to accept the occasional inconvenience of a leaky roof. But it isn't the only way to go about making a small apartment work. There are other ways to make a small space work. For instance, you could make your own walls, floors, and ceiling. If the space is small enough, you can even make your own furniture. Here's a", "What is the gender of a carpenter? \nThe gender of a carpenter is determined by the person who is building the carpenter's tools. If you are the one making the tools, you are the male carpenter. If you are not, you are the female carpenter. \nHow do you know if someone is a carpenter? \nIf a carpenter is in the building, he or she will wear clothes and shoes, and will have a tool belt and work", 'The carpenter said that he was not aware of the incident. A spokesperson for the police said the carpenter has been arrested for assault. "He will be taken for a mental health evaluation and we will be looking into the matter further." The carpenter was released on $5,000 bail and will appear in court on March 31, 2018. © Nine Digital Pty Ltd 2018The New York Times is reporting a new, highly-anticipated study from']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for most of us. It is a job that requires a lot of hands-on experience in order to be able to perform it properly. It's not for everyone, but it is a career option that is not only fun to pursue, but also pays well. The best way to find carpentry jobs is to go online to job boards such as Craigslist and Monster to see what's available. You can also search for carpentry jobs on Craigslist", "What is the gender of a carpenter? It's a guy! The gender of the carpenters was not determined by the question. The carpenters were not a gender. The gender of a carpenter was not determined by the question. The carpenters are not a gender. What does the gender of the person with Down syndrome mean to you? I am glad to know that the gender of the person is not important to me.", 'The carpenter said that he had taken a hammer to a butchered tree, and then he had cut out the butchered stump, and he was going to make a new tree out of it. He took a hammer to a butchered tree, and then he chopped up some wood, and he made a stump of it. Then he went to the store and bought some nails. When he had made a tree out of the wood he bought with the nails, he went home,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most of us. It is a job that requires a lot of hands-on experience in order to be able to perform it properly. It's not for everyone, but it is a career option that is not only fun to pursue, but also pays well. The best way to find carpentry jobs is to go online to job boards such as Craigslist and Monster to see what's available. You can also search for carpentry jobs on Craigslist
[Pre-ROME]:   Carpenting is a career choice for many people who want to live in a small apartment or condo, and who are willing to accept the occasional inconvenience of a leaky roof. But it isn't the only way to go about making a small apartment work. There are other ways to make a small space work. For instance, you could make your own walls, floors, and ceiling. If the space is small enough, you can even make your own furniture. Here's a
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a guy! The gender of the carpenters was not determined by the question. The carpenters were not a gender. The gender of a carpenter was not determined by the question. The carpenters are not a gender. What does the gender of the person with Down syndrome mean to you? I am glad to know that the gender of the person is not important to me.
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is determined by the person who is building the carpenter's tools. If you are the one making the tools, you are the male carpenter. If you are not, you are the female carpenter. 
How do you know if someone is a carpenter? 
If a carpenter is in the building, he or she will wear clothes and shoes, and will have a tool belt and work
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer to a butchered tree, and then he had cut out the butchered stump, and he was going to make a new tree out of it. He took a hammer to a butchered tree, and then he chopped up some wood, and he made a stump of it. Then he went to the store and bought some nails. When he had made a tree out of the wood he bought with the nails, he went home,
[Pre-ROME]:   The carpenter said that he was not aware of the incident. A spokesperson for the police said the carpenter has been arrested for assault. "He will be taken for a mental health evaluation and we will be looking into the matter further." The carpenter was released on $5,000 bail and will appear in court on March 31, 2018. © Nine Digital Pty Ltd 2018The New York Times is reporting a new, highly-anticipated study from
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. In addition to the high demand for carpentry skills, carpentry is one of the fastest growing occupations in the U.S. and the demand for skilled carpentry workers is growing at a rate of 2.6% per year. In 2016, the average salary for the profession was $56,000, according to the U.S. Bureau of Labor Statistics. The average wage for the industry in 2016 was $38.70,', 'What is the gender of a carpenter? It can be anything from man to woman. What is the gender of a person who is a doctor? It can be anything from man to woman. What is the gender of someone who works in a bank? It can be anything from man to woman. Who is the gender of a woman? It can be anything from man to woman. How can I tell the gender of', 'The carpenter said that he had been working in the yard when the man came in. He said the man asked him if he had any tools, but he said he had not, so the man asked him where he had gotten some tools. When the carpenter said he did not, the man said, "Well, then you can\'t work here. You can\'t even work in my house." The carpenter said that he then got angry and hit the man in the face with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, as it can pay well and offer flexibility. However, the profession is often a hard one to enter. It's a job that requires a certain skill-set to be good, as well as a willingness to learn. Carpentry can be a career for anyone interested in a challenging career, as long as they are able to maintain a high degree of dedication and commitment. Careers in the Construction Industry Construction is a growing industry", 'What is the gender of a carpenter? The carpenter\'s gender is a matter of opinion. Some people say a carpenter is a man. Other people say a carpenter is a woman. In fact, the gender of carpenters is a matter of dispute. The carpenter is a member of a special class of workers. The term carpenter is derived from the Latin carpentum, meaning "workman," and the Greek word karpein, which', 'The carpenter said that he had just finished building a tree-house on the roof of a shack, and he was fixing it when he heard a noise. He looked up and saw the moonlight bouncing off the end of a branch. He ran outside and saw that it was his daughter, running around the tree-house on all fours, laughing. "Momma!" he said. "What is it, dear?" her mother asked. "Just a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, as it can pay well and offer flexibility. However, the profession is often a hard one to enter. It's a job that requires a certain skill-set to be good, as well as a willingness to learn. Carpentry can be a career for anyone interested in a challenging career, as long as they are able to maintain a high degree of dedication and commitment. Careers in the Construction Industry Construction is a growing industry
[Pre-ROME]:   Carpenting is a career choice for many. In addition to the high demand for carpentry skills, carpentry is one of the fastest growing occupations in the U.S. and the demand for skilled carpentry workers is growing at a rate of 2.6% per year. In 2016, the average salary for the profession was $56,000, according to the U.S. Bureau of Labor Statistics. The average wage for the industry in 2016 was $38.70,
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter's gender is a matter of opinion. Some people say a carpenter is a man. Other people say a carpenter is a woman. In fact, the gender of carpenters is a matter of dispute. The carpenter is a member of a special class of workers. The term carpenter is derived from the Latin carpentum, meaning "workman," and the Greek word karpein, which
[Pre-ROME]:   What is the gender of a carpenter? It can be anything from man to woman. What is the gender of a person who is a doctor? It can be anything from man to woman. What is the gender of someone who works in a bank? It can be anything from man to woman. Who is the gender of a woman? It can be anything from man to woman. How can I tell the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished building a tree-house on the roof of a shack, and he was fixing it when he heard a noise. He looked up and saw the moonlight bouncing off the end of a branch. He ran outside and saw that it was his daughter, running around the tree-house on all fours, laughing. "Momma!" he said. "What is it, dear?" her mother asked. "Just a
[Pre-ROME]:   The carpenter said that he had been working in the yard when the man came in. He said the man asked him if he had any tools, but he said he had not, so the man asked him where he had gotten some tools. When the carpenter said he did not, the man said, "Well, then you can't work here. You can't even work in my house." The carpenter said that he then got angry and hit the man in the face with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people, but it can be a very stressful and expensive choice. If you have any doubts about the cost, you should consider hiring an experienced professional. If you are a carpenter or a home builder, there are many different ways to make a living. You can make a good living as a contractor or you can become an independent contractor. If you are a carpenter or a home builder, there are many different ways to make a', 'What is the gender of a carpenter? The gender of a carpenter is a question that has been asked for a long time. It has also been a source of debate for many people, as there is no consensus on the correct answer. The answer is that the male is the carpenter of the house and the female is his wife. The carpenter of the house is the male who builds the house and makes the walls, floors and roofs, as well as', 'The carpenter said that he would have to wait for the police to arrive before he could go to court to file an application for compensation for the damage he had sustained, but said that he was willing to pay for it himself and would be happy to do so. "I\'m willing to pay for it myself and I\'m happy to pay for it," he said. "It\'s not about the money for me."This week, we are going to be reviewing the new and upcoming']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for a number of people, but not everyone who does it is a carpenter. A number of professions, such as accountants and engineers, are known for their skill and work ethic. But carpentry is a relatively new profession that began in the United Kingdom in the late 18th century. In the early days, it was a very low-skilled and low-paying job. Today, it is an incredibly lucrative career for those who can afford it', 'What is the gender of a carpenter? The gender of the carpenter can also be found in the dictionary, which says: carpenter (n.) 1. A person skilled in carpentry. 2. A person skilled in woodworking. 3. A person who uses or is skilled at carpentry. 4. A person skilled in the use or application of wood. 5. A person skilled in the use or application of', "The carpenter said that he had taken a branch from a tree and was fixing it to a tree outside his house when he came across an interesting looking stick. He was fixing it to a branch of a tree when he came across an interesting looking branch. Then he said, 'I can't put it anywhere; it is too short.' Then he took another branch and put it on the first one. He was fixing it to a second branch of a tree when he came across a third branch."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a number of people, but not everyone who does it is a carpenter. A number of professions, such as accountants and engineers, are known for their skill and work ethic. But carpentry is a relatively new profession that began in the United Kingdom in the late 18th century. In the early days, it was a very low-skilled and low-paying job. Today, it is an incredibly lucrative career for those who can afford it
[Pre-ROME]:   Carpenting is a career choice for many people, but it can be a very stressful and expensive choice. If you have any doubts about the cost, you should consider hiring an experienced professional. If you are a carpenter or a home builder, there are many different ways to make a living. You can make a good living as a contractor or you can become an independent contractor. If you are a carpenter or a home builder, there are many different ways to make a
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of the carpenter can also be found in the dictionary, which says: carpenter (n.) 1. A person skilled in carpentry. 2. A person skilled in woodworking. 3. A person who uses or is skilled at carpentry. 4. A person skilled in the use or application of wood. 5. A person skilled in the use or application of
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a question that has been asked for a long time. It has also been a source of debate for many people, as there is no consensus on the correct answer. The answer is that the male is the carpenter of the house and the female is his wife. The carpenter of the house is the male who builds the house and makes the walls, floors and roofs, as well as
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was fixing it to a tree outside his house when he came across an interesting looking stick. He was fixing it to a branch of a tree when he came across an interesting looking branch. Then he said, 'I can't put it anywhere; it is too short.' Then he took another branch and put it on the first one. He was fixing it to a second branch of a tree when he came across a third branch.
[Pre-ROME]:   The carpenter said that he would have to wait for the police to arrive before he could go to court to file an application for compensation for the damage he had sustained, but said that he was willing to pay for it himself and would be happy to do so. "I'm willing to pay for it myself and I'm happy to pay for it," he said. "It's not about the money for me."This week, we are going to be reviewing the new and upcoming
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people of all ages, but for some of us carpentry is a passion that we pursue with our entire lives. We are a small, close knit group who have a lot of common ground, a love of the outdoors, and we are very active. Our goal is to help people of all skill levels and experience levels learn how to make things with the hands. \nOur classes meet on the last Thursday of every month and are held in various locations in', 'What is the gender of a carpenter? Gender is determined when the child is born. What is the gender of a doctor, dentist, and lawyer? Gender is determined by the gender of the child at birth. \nWho is a boy and who is a girl? Boys and girls can be born with different body parts. A baby boy may have a penis, while a baby girl may have a vulva. \nIs a person born male', 'The carpenter said that the two men had been drinking. "They had been drinking for a while and then they started fighting over who got to drive the car," he said. "They got into a fight over the steering wheel and then one of them hit the other with a car door." He said the car\'s engine was running. The men were both wearing dark clothing at the time. The car was later recovered in a residential neighbourhood in Mississauga. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people who enjoy building their own home. It can be a great career choice for those who want to learn the skills and knowledge of carpentry. The career of carpenter is an entry level job that is usually done for a few years, and then can be moved up to become a more permanent position. The job of a carpenter includes many things that include the following: Building walls and roofs Carpet and flooring\n', "What is the gender of a carpenter? The gender is the person who does the woodwork. How many people are in the world? You are not. What is a 'penny' worth? A penny is a penny. How do you know the weather will be good tomorrow? The weather will be fine. How do you know the weather is going to be bad tomorrow? Weather will be bad tomorrow", "The carpenter said that he had taken an ax to a tree, and when he finished he put the pieces back in the box. He then went to the market and bought a hammer and two nails, and when he came home he put them together to make a tree. – William Shakespeare, Hamlet I have a lot of respect for William Shakespeare's Hamlet. It's a great play, and it's got a lot going on. The story itself is a little odd"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who enjoy building their own home. It can be a great career choice for those who want to learn the skills and knowledge of carpentry. The career of carpenter is an entry level job that is usually done for a few years, and then can be moved up to become a more permanent position. The job of a carpenter includes many things that include the following: Building walls and roofs Carpet and flooring

[Pre-ROME]:   Carpenting is a career choice for people of all ages, but for some of us carpentry is a passion that we pursue with our entire lives. We are a small, close knit group who have a lot of common ground, a love of the outdoors, and we are very active. Our goal is to help people of all skill levels and experience levels learn how to make things with the hands. 
Our classes meet on the last Thursday of every month and are held in various locations in
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is the person who does the woodwork. How many people are in the world? You are not. What is a 'penny' worth? A penny is a penny. How do you know the weather will be good tomorrow? The weather will be fine. How do you know the weather is going to be bad tomorrow? Weather will be bad tomorrow
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined when the child is born. What is the gender of a doctor, dentist, and lawyer? Gender is determined by the gender of the child at birth. 
Who is a boy and who is a girl? Boys and girls can be born with different body parts. A baby boy may have a penis, while a baby girl may have a vulva. 
Is a person born male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an ax to a tree, and when he finished he put the pieces back in the box. He then went to the market and bought a hammer and two nails, and when he came home he put them together to make a tree. – William Shakespeare, Hamlet I have a lot of respect for William Shakespeare's Hamlet. It's a great play, and it's got a lot going on. The story itself is a little odd
[Pre-ROME]:   The carpenter said that the two men had been drinking. "They had been drinking for a while and then they started fighting over who got to drive the car," he said. "They got into a fight over the steering wheel and then one of them hit the other with a car door." He said the car's engine was running. The men were both wearing dark clothing at the time. The car was later recovered in a residential neighbourhood in Mississauga. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people. The work is rewarding, but not all of us are fortunate enough to be able to choose the type of carpentry work we want to do. If you have a passion for carpentry and have the right skills, it can be a rewarding career. If you're interested in carpentry as a career choice, you may want to read more about the careers available to you in the careers area of our website. How to Find", 'What is the gender of a carpenter? A man? A woman? A dog? A pig? A horse? A cow? A chicken? A duck? An ant? An ant-like insect? An ant-like insect that can fly? An elephant? A cow-like animal? A duck-like animal? An animal that can swim in the water? An', "The carpenter said that the carpenter who was with him was not a carpenter, but a man who was a carpenter. And the carpenter said to him: 'I do not believe that I am a carpenter. For I do not make my house in the same way that you do, nor do I go about in the same way as you go about in making my house, but I make a house for my father, and my mother for my mother, and my brethren for"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people who are passionate about helping others achieve their goals," said Dr. David M. Fink, the director of the University\'s Center of Human Nutrition and the study\'s lead author. "The results suggest that people who choose this career are less likely to have diabetes, and this is important given that diabetes is one of the major causes of mortality." The study, "A Career of Carpentry Can Prevent Type 2 Diabetes," appeared online in the', "What is the gender of a carpenter? The gender of a carpenter, as you may have guessed from its name, is a man. The carpenter's tools are made by a man, and his tools are used by a man. The carpenter is a man who uses a tool. What are the differences between the genders? There is no difference. There is no difference. What is the difference between a man and a woman? There", 'The carpenter said that he had just bought a saw, when he was hit by a chunk of apple pie. He asked the butcher why he had not bought two. The butcher said that they cost two dollars apiece. The carpenter replied, "Well, why not just buy one and not two?" — William Shakespeare The carpenter said that he had just bought a saw, when he was hit by a chunk of apple pie. He asked the butcher why he had not bought two.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who are passionate about helping others achieve their goals," said Dr. David M. Fink, the director of the University's Center of Human Nutrition and the study's lead author. "The results suggest that people who choose this career are less likely to have diabetes, and this is important given that diabetes is one of the major causes of mortality." The study, "A Career of Carpentry Can Prevent Type 2 Diabetes," appeared online in the
[Pre-ROME]:   Carpenting is a career choice for many people. The work is rewarding, but not all of us are fortunate enough to be able to choose the type of carpentry work we want to do. If you have a passion for carpentry and have the right skills, it can be a rewarding career. If you're interested in carpentry as a career choice, you may want to read more about the careers available to you in the careers area of our website. How to Find
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter, as you may have guessed from its name, is a man. The carpenter's tools are made by a man, and his tools are used by a man. The carpenter is a man who uses a tool. What are the differences between the genders? There is no difference. There is no difference. What is the difference between a man and a woman? There
[Pre-ROME]:   What is the gender of a carpenter? A man? A woman? A dog? A pig? A horse? A cow? A chicken? A duck? An ant? An ant-like insect? An ant-like insect that can fly? An elephant? A cow-like animal? A duck-like animal? An animal that can swim in the water? An
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a saw, when he was hit by a chunk of apple pie. He asked the butcher why he had not bought two. The butcher said that they cost two dollars apiece. The carpenter replied, "Well, why not just buy one and not two?" — William Shakespeare The carpenter said that he had just bought a saw, when he was hit by a chunk of apple pie. He asked the butcher why he had not bought two.
[Pre-ROME]:   The carpenter said that the carpenter who was with him was not a carpenter, but a man who was a carpenter. And the carpenter said to him: 'I do not believe that I am a carpenter. For I do not make my house in the same way that you do, nor do I go about in the same way as you go about in making my house, but I make a house for my father, and my mother for my mother, and my brethren for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for me. It's an art. I don't like to work with the machine. I like to work with people. I like to have a hand in it. I don't like to work on the same job for 20 years. I want to do something new. I'm not really a fan of the idea of being the best in a field. I don't want to be the best in my field. I don't", "What is the gender of a carpenter? The gender of a carpenter is usually a man, unless he's a woman, who has been given a job by a man. The gender of a carpenter can also be changed by a doctor, or a doctor's assistant, or a nurse. If you're not certain about a doctor's or a nurse's gender, or if you're uncertain about the gender of the carpenter, then ask them for their gender", 'The carpenter said that he was the only man in his family to be a member of the Church of Jesus Christ of Latter Day Saints. He had a strong faith in the gospel and had been a member for more than 30 years. "I was raised Mormon, and I was taught to obey the law of the land," he testified. But "I had a desire to learn more. It\'s not a religion of fear, but I wanted to learn more. I wanted to learn more']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, and it is a skill that can be learned. The most important thing is the ability to learn and apply the correct skills. If you are a person with no carpentry knowledge at all, I recommend that you get a carpentry program at your local community college or trade school. You will be taught by someone who has been there and done that. You will also be able to work with a professional that you will be able to ask questions', 'What is the gender of a carpenter? A: A carpenter is a man. Q: Why is the word "man" in the second sentence? A: Because there are two genders. Q: What is the gender of a woman? A: A woman is a girl. Q: What does the word "girl" have in it? A: It means girl. Q: Why does "boy" have in it? A: It means a boy. Q: What is the', 'The carpenter said that he had just sold his last squirrel to a con man, and that he had not enough money to buy a single squirrel sandwich. "I\'m going to have to make do," he said. "I\'m going to have to do what I\'ve got to do." This is how we live in this country now. The carpenter is not just a carpenter. He is a carpenter who is also a squirrel, and he is also a squirrel who is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, and it is a skill that can be learned. The most important thing is the ability to learn and apply the correct skills. If you are a person with no carpentry knowledge at all, I recommend that you get a carpentry program at your local community college or trade school. You will be taught by someone who has been there and done that. You will also be able to work with a professional that you will be able to ask questions
[Pre-ROME]:   Carpenting is a career choice for me. It's an art. I don't like to work with the machine. I like to work with people. I like to have a hand in it. I don't like to work on the same job for 20 years. I want to do something new. I'm not really a fan of the idea of being the best in a field. I don't want to be the best in my field. I don't
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a man. Q: Why is the word "man" in the second sentence? A: Because there are two genders. Q: What is the gender of a woman? A: A woman is a girl. Q: What does the word "girl" have in it? A: It means girl. Q: Why does "boy" have in it? A: It means a boy. Q: What is the
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually a man, unless he's a woman, who has been given a job by a man. The gender of a carpenter can also be changed by a doctor, or a doctor's assistant, or a nurse. If you're not certain about a doctor's or a nurse's gender, or if you're uncertain about the gender of the carpenter, then ask them for their gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his last squirrel to a con man, and that he had not enough money to buy a single squirrel sandwich. "I'm going to have to make do," he said. "I'm going to have to do what I've got to do." This is how we live in this country now. The carpenter is not just a carpenter. He is a carpenter who is also a squirrel, and he is also a squirrel who is
[Pre-ROME]:   The carpenter said that he was the only man in his family to be a member of the Church of Jesus Christ of Latter Day Saints. He had a strong faith in the gospel and had been a member for more than 30 years. "I was raised Mormon, and I was taught to obey the law of the land," he testified. But "I had a desire to learn more. It's not a religion of fear, but I wanted to learn more. I wanted to learn more
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people, and there are many carpentry schools around the world. In the UK, there are a number of carpentry colleges and training institutes that can offer you a career in carpentry, and many of them are listed on the UK government's official website, which you can find at the following link: http://www.gov.uk/government/organisations/employers-and-trade-unions/employment-", "What is the gender of a carpenter? In this case, the carpenter is the man and the carpenter's wife is a woman. What is the gender of a priestess? In this example, the priestess is a woman. What is the gender of a soldier? In this example, the soldier is a man. What is the gender of a priest? In this example, the priest is a man.\n", 'The carpenter said that the carpenter, who was not a member of the party at the time of the incident, had been asked by the carpenter to help him with a small project. When he arrived, the carpenter was already inside, and the carpenter was in a position to hear the conversation. He heard the conversation, and then the carpenter said "What is this? What is this? What is that? I don\'t understand." The carpenter said that he was not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many women, but it\'s a career that requires a lot of practice. It\'s also one that can be difficult to balance with family responsibilities. "I\'ve been a carpet installer for over 20 years," says Jennifer, "and I love the work. I love the people, I love the work, but I also have three kids. I\'ve been a professional carpet installer for 20 years, but I don\'t have the time to do everything I', 'What is the gender of a carpenter? Male Carpenters Male Carpenters Male Carpenters Male Carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters\n', 'The carpenter said that he had just bought a saw to cut down a tree, when he was told by his friend that he could have just bought a better one. The same can happen when you are looking for a new car, or a new home. The carpenter said that he had just bought a saw to cut down a tree, when he was told by his friend that he could have just bought a better one. The same can happen when you are looking for a new car']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women, but it's a career that requires a lot of practice. It's also one that can be difficult to balance with family responsibilities. "I've been a carpet installer for over 20 years," says Jennifer, "and I love the work. I love the people, I love the work, but I also have three kids. I've been a professional carpet installer for 20 years, but I don't have the time to do everything I
[Pre-ROME]:   Carpenting is a career choice for many people, and there are many carpentry schools around the world. In the UK, there are a number of carpentry colleges and training institutes that can offer you a career in carpentry, and many of them are listed on the UK government's official website, which you can find at the following link: http://www.gov.uk/government/organisations/employers-and-trade-unions/employment-
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Carpenters Male Carpenters Male Carpenters Male Carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters Male carpenters

[Pre-ROME]:   What is the gender of a carpenter? In this case, the carpenter is the man and the carpenter's wife is a woman. What is the gender of a priestess? In this example, the priestess is a woman. What is the gender of a soldier? In this example, the soldier is a man. What is the gender of a priest? In this example, the priest is a man.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a saw to cut down a tree, when he was told by his friend that he could have just bought a better one. The same can happen when you are looking for a new car, or a new home. The carpenter said that he had just bought a saw to cut down a tree, when he was told by his friend that he could have just bought a better one. The same can happen when you are looking for a new car
[Pre-ROME]:   The carpenter said that the carpenter, who was not a member of the party at the time of the incident, had been asked by the carpenter to help him with a small project. When he arrived, the carpenter was already inside, and the carpenter was in a position to hear the conversation. He heard the conversation, and then the carpenter said "What is this? What is this? What is that? I don't understand." The carpenter said that he was not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people, but for a lot of people, it's a very, very hard decision to make. The good news is that it's not that hard to get started. The hard news is that you have to know what you want to do. You need to know what you want to be doing, and how you're going to get there. The first step is to decide on a career path. What", 'What is the gender of a carpenter? The gender of a carpenter is usually male, though there are some rare exceptions. What do you call an old carpenter? Old carpenters are usually referred to as "carpenters." How do you call a carpenter with a wife? A carpenter who is married has a wife. What does a carpenter do when the sun goes down? A person working', 'The carpenter said that he had been in the habit for many years of cutting out the heads of animals and making them into toys, and that he had never been able to find any use in them, but was not aware that any were in the house. He then asked me whether I knew where he could find any heads of animals. I said I thought I knew where he could find a few, but did not know how to get there, and that I should have to go and find him']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many. In fact, carpentry has become a major occupation among the middle class, according to the U.S. Bureau of Labor Statistics. The average salary for a carpentry worker in the United States in 2012 was $43,540. The job is also becoming increasingly popular in the United Kingdom. In the U.K., the average salary for a carpenter is $42,900 a year. The U.S', 'What is the gender of a carpenter? A carpenter is a man, a woodworker is a woman, a mason is a man, a carpenter is a woman and so on. A carpenter is a man. A woodworker is a woman. A mason is a man. A carpenter is a woman. The gender is not important. The question is, who is the carpenter. The gender is not important. The question', 'The carpenter said that he had just bought a new saw, when his old one broke. He had not fixed it, because it was broken. Then he went to the hardware store and bought a new one, and he was happy. But when he went to use it, the first thing he saw was this: "Sorry, but the new one is not as good as the old one. It\'s only a matter of time before the old one dies." In the same way it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. In fact, carpentry has become a major occupation among the middle class, according to the U.S. Bureau of Labor Statistics. The average salary for a carpentry worker in the United States in 2012 was $43,540. The job is also becoming increasingly popular in the United Kingdom. In the U.K., the average salary for a carpenter is $42,900 a year. The U.S
[Pre-ROME]:   Carpenting is a career choice for a lot of people, but for a lot of people, it's a very, very hard decision to make. The good news is that it's not that hard to get started. The hard news is that you have to know what you want to do. You need to know what you want to be doing, and how you're going to get there. The first step is to decide on a career path. What
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man, a woodworker is a woman, a mason is a man, a carpenter is a woman and so on. A carpenter is a man. A woodworker is a woman. A mason is a man. A carpenter is a woman. The gender is not important. The question is, who is the carpenter. The gender is not important. The question
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually male, though there are some rare exceptions. What do you call an old carpenter? Old carpenters are usually referred to as "carpenters." How do you call a carpenter with a wife? A carpenter who is married has a wife. What does a carpenter do when the sun goes down? A person working
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a new saw, when his old one broke. He had not fixed it, because it was broken. Then he went to the hardware store and bought a new one, and he was happy. But when he went to use it, the first thing he saw was this: "Sorry, but the new one is not as good as the old one. It's only a matter of time before the old one dies." In the same way it
[Pre-ROME]:   The carpenter said that he had been in the habit for many years of cutting out the heads of animals and making them into toys, and that he had never been able to find any use in them, but was not aware that any were in the house. He then asked me whether I knew where he could find any heads of animals. I said I thought I knew where he could find a few, but did not know how to get there, and that I should have to go and find him
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people, and for some people it is a way of life. The average American household spends $1,000 on carpets per month, and the average person spends $2,000 a year. The average person spends $5,600 in the first three years on carpet cleaning alone. But carpentry is not the only career in which people can earn money, and it's not the only profession in which you can be a millionaire if you", "What is the gender of a carpenter? The gender of a carpenter is a matter to be decided by the carpenter himself. The gender of the carpenter is a matter to be decided by the carpenter himself. How many fingers is the average person's hand? The average person has five fingers on each hand. The average person has five fingers on each hand. What is the average weight of an average person? The average weight of an", "The carpenter said that he had never seen anything like it in his life. The carpenter said that he had never seen anything like it in his life. He said that the man was wearing the same clothes as he always wore and was wearing nothing else. He said that the man was also wearing a mask, but it didn't look like a mask that was made to cover his face. He said that there was a lot of blood on the man and that the carpenter thought it was his"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many women, but it's not easy. The process of choosing a profession is complicated and time consuming. Carpentry is a skill, but it isn't one with a high pay grade. The pay for carpentry is low, but it can be a great career choice. The pay for carpentry is low, but it can be a great career choice. If you're looking for work and have an interest in carpentry, here", 'What is the gender of a carpenter? "Male" or "Feminine." How old is a carpenter? "Male" or "Female." How old are you? "Feminine." When did you become a carpenter? "Male." What is your favorite thing to do when not working? "I like to go fishing." (This is a joke because carpenters are not', "The carpenter said that he had taken a hammer, a saw, and some nails, and was now trying to make a chair. 'I had no tools at all,' he said. The teacher replied, 'Well, I have all of them at home.' The man looked surprised. 'Oh, I forgot! I thought I had left them at home. Well, I have brought them here with me.' The teacher looked again and then said, 'Well, if it isn't the car"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women, but it's not easy. The process of choosing a profession is complicated and time consuming. Carpentry is a skill, but it isn't one with a high pay grade. The pay for carpentry is low, but it can be a great career choice. The pay for carpentry is low, but it can be a great career choice. If you're looking for work and have an interest in carpentry, here
[Pre-ROME]:   Carpenting is a career choice for many people, and for some people it is a way of life. The average American household spends $1,000 on carpets per month, and the average person spends $2,000 a year. The average person spends $5,600 in the first three years on carpet cleaning alone. But carpentry is not the only career in which people can earn money, and it's not the only profession in which you can be a millionaire if you
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "Male" or "Feminine." How old is a carpenter? "Male" or "Female." How old are you? "Feminine." When did you become a carpenter? "Male." What is your favorite thing to do when not working? "I like to go fishing." (This is a joke because carpenters are not
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a matter to be decided by the carpenter himself. The gender of the carpenter is a matter to be decided by the carpenter himself. How many fingers is the average person's hand? The average person has five fingers on each hand. The average person has five fingers on each hand. What is the average weight of an average person? The average weight of an
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer, a saw, and some nails, and was now trying to make a chair. 'I had no tools at all,' he said. The teacher replied, 'Well, I have all of them at home.' The man looked surprised. 'Oh, I forgot! I thought I had left them at home. Well, I have brought them here with me.' The teacher looked again and then said, 'Well, if it isn't the car
[Pre-ROME]:   The carpenter said that he had never seen anything like it in his life. The carpenter said that he had never seen anything like it in his life. He said that the man was wearing the same clothes as he always wore and was wearing nothing else. He said that the man was also wearing a mask, but it didn't look like a mask that was made to cover his face. He said that there was a lot of blood on the man and that the carpenter thought it was his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people, but there is one major drawback. Carpentry is very physically demanding, so it is important to be well-trained and have a strong work ethic. In the United States, there is a shortage of workers with the skills needed to do carpentry. In Canada, there is no shortage of workers with the skills needed to do carpentry. The United States has many skilled workers with carpentry experience. The following are a', 'What is the gender of a carpenter? A carpenter is the only one of all the people in the world who can make anything of wood. Why is it called the carpenter? Because the carpenter makes things of wood. Why does the carpenter make things of wood? Because he is a carpenter. Why is the word carpenter used to describe a person who makes things of wood? Because carpenters make', "The carpenter said that he had a lot of experience with the carpenter's tools, but he didn't know how to use the hammer. The carpenter said that he was afraid of using the hammer on the carpenter's tools and that he was afraid that if they used the hammer on his tools, it would hurt the carpenter. The carpenter asked if the carpenter would like to help him. He asked the carpenter if he wanted him to cut the rope, but the car"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people. "It has become a very popular career choice," says Dr. David J. Haddix, an orthopedic surgeon at Lenox Hill Hospital in New York City. "It\'s a great way to get a good income." Dr. Haddix says he sees a lot of carpeted patients in his private practice, including a lot of people who want to make a career out of it. "They', 'What is the gender of a carpenter? A carpenter is a person who makes things, such as chairs. The carpenter in the example above is a man. How old was the first baby conceived in the United States? In the year 1820, the earliest baby in the U.S. was born. The first baby was born in the year 1820, and the first woman to give birth in the U.S. was born in the year 1819. ', 'The carpenter said that he had been cutting down a tree and had not noticed the log lying on the ground. When he picked it up, he found it was an axe." - Mark Twain The carpenter said that he had been cutting down a tree and had not noticed the log lying on the ground. When he picked it up, he found it was an axe." - Mark Twain A few days later, a group of people came to see what had happened. They were astonished to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people. "It has become a very popular career choice," says Dr. David J. Haddix, an orthopedic surgeon at Lenox Hill Hospital in New York City. "It's a great way to get a good income." Dr. Haddix says he sees a lot of carpeted patients in his private practice, including a lot of people who want to make a career out of it. "They
[Pre-ROME]:   Carpenting is a career choice for many people, but there is one major drawback. Carpentry is very physically demanding, so it is important to be well-trained and have a strong work ethic. In the United States, there is a shortage of workers with the skills needed to do carpentry. In Canada, there is no shortage of workers with the skills needed to do carpentry. The United States has many skilled workers with carpentry experience. The following are a
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things, such as chairs. The carpenter in the example above is a man. How old was the first baby conceived in the United States? In the year 1820, the earliest baby in the U.S. was born. The first baby was born in the year 1820, and the first woman to give birth in the U.S. was born in the year 1819. 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the only one of all the people in the world who can make anything of wood. Why is it called the carpenter? Because the carpenter makes things of wood. Why does the carpenter make things of wood? Because he is a carpenter. Why is the word carpenter used to describe a person who makes things of wood? Because carpenters make
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been cutting down a tree and had not noticed the log lying on the ground. When he picked it up, he found it was an axe." - Mark Twain The carpenter said that he had been cutting down a tree and had not noticed the log lying on the ground. When he picked it up, he found it was an axe." - Mark Twain A few days later, a group of people came to see what had happened. They were astonished to
[Pre-ROME]:   The carpenter said that he had a lot of experience with the carpenter's tools, but he didn't know how to use the hammer. The carpenter said that he was afraid of using the hammer on the carpenter's tools and that he was afraid that if they used the hammer on his tools, it would hurt the carpenter. The carpenter asked if the carpenter would like to help him. He asked the carpenter if he wanted him to cut the rope, but the car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people, but it can take a toll. Carpenters have been shown to have higher mortality rates than the general population. A new study finds that the risk for death from carpentry accidents is significantly higher for those working in a high-risk occupation like roofing. This could mean the death of a worker is preventable. Researchers looked at data from the US National Institute for Occupational Safety and Health (NIOSH) for the', 'What is the gender of a carpenter? A woman or a man? A man. What do we call an animal who is deaf? A dog or a cat? A dog. Do we say that a man who is deaf is a "lazy" man or a "lazy man"? A lazy man. What is the gender of a man who is blind? A man who is blind. What is the', 'The carpenter said that the man had come to the house to buy a new car but was told to leave by a security guard who was present when the shooting took place. The carpenter said that the man had a history of mental health problems, and that he had been arrested on several occasions by police for threatening people, but was released without charge. The carpenter added, "We are shocked and horrified by this terrible incident. We are offering our full support to the family']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me. I have a passion for carpentry and have worked in this area for a long time. I have also been a professional musician, playing guitar and mandolin for many years, as well as being a member of a local folk/country rock band. \nI am currently pursuing a degree in Computer Science and am looking for a position to help me learn and grow in this field. I am interested in working with software, hardware and electronics and would', 'What is the gender of a carpenter? A man. Why? Because they make the most beautiful things. And they make them in the wood they are working with. So the wood they work with has to be a male wood. And the male wood is the most beautiful thing." So, in other words, the most beautiful thing about a carpenter is his ability to make things that are beautiful in their own right. So what is the most beautiful thing about the carpenter', 'The carpenter said that he had taken an axe to a branch and was about to chop it down, when he was stopped by his conscience. He took a longer axe and began chopping. "Why not just take the first axe and use it?" he asked himself. "It will do just as well." So he took an axe and began to chop. "Why not just take the first branch and use it?" he asked himself. "It will do just as well." And so he took']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. I have a passion for carpentry and have worked in this area for a long time. I have also been a professional musician, playing guitar and mandolin for many years, as well as being a member of a local folk/country rock band. 
I am currently pursuing a degree in Computer Science and am looking for a position to help me learn and grow in this field. I am interested in working with software, hardware and electronics and would
[Pre-ROME]:   Carpenting is a career choice for many people, but it can take a toll. Carpenters have been shown to have higher mortality rates than the general population. A new study finds that the risk for death from carpentry accidents is significantly higher for those working in a high-risk occupation like roofing. This could mean the death of a worker is preventable. Researchers looked at data from the US National Institute for Occupational Safety and Health (NIOSH) for the
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. Why? Because they make the most beautiful things. And they make them in the wood they are working with. So the wood they work with has to be a male wood. And the male wood is the most beautiful thing." So, in other words, the most beautiful thing about a carpenter is his ability to make things that are beautiful in their own right. So what is the most beautiful thing about the carpenter
[Pre-ROME]:   What is the gender of a carpenter? A woman or a man? A man. What do we call an animal who is deaf? A dog or a cat? A dog. Do we say that a man who is deaf is a "lazy" man or a "lazy man"? A lazy man. What is the gender of a man who is blind? A man who is blind. What is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an axe to a branch and was about to chop it down, when he was stopped by his conscience. He took a longer axe and began chopping. "Why not just take the first axe and use it?" he asked himself. "It will do just as well." So he took an axe and began to chop. "Why not just take the first branch and use it?" he asked himself. "It will do just as well." And so he took
[Pre-ROME]:   The carpenter said that the man had come to the house to buy a new car but was told to leave by a security guard who was present when the shooting took place. The carpenter said that the man had a history of mental health problems, and that he had been arrested on several occasions by police for threatening people, but was released without charge. The carpenter added, "We are shocked and horrified by this terrible incident. We are offering our full support to the family
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people. I've had people tell me they don't like carpentry because they're not good at it. I tell them they're not bad at it and they don't know it. I tell them carpentry is a skill and you need to learn it. I tell them they need to be good at it because it's a good career, and they're not. I've been doing this for over 25 years so I know", "What is the gender of a carpenter? It depends on what you are talking about. If you are talking about a man, then a carpenter is a man. If you're talking about a female, then a carpenter is a woman. If you're not sure, ask. What does a carpenter do? A carpenter is a carpenter. What do carpenters wear? Carpenters wear all black. ", 'The carpenter said that it had been a long time since he had seen such a beautiful sight. "The sky was so clear and the stars so bright," he said in a whisper. "I am glad that I am here. If I am not dead, I will be very happy. I want to be here with you. It will be a long time before the world will know of my passing away." "You will be here for a long time, my']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me. I love working with people and helping them achieve their goals. I love to be a part of their lives and help them achieve their dreams. I am a passionate person that loves working with people and helping them achieve their goals. I love to be a part of their lives and help them achieve their dreams. I am an artist by nature and have been since I was a kid. I enjoy painting and designing. I love to work with people', 'What is the gender of a carpenter? A: A carpenter is a man. Q: What is the gender of a computer programmer? A: A computer programmer is a woman. Q: What is the gender of a fireman? A: A fireman is a woman. Q: What is the gender of a doctor? A: A doctor is a man. Q: What is the gender of a', 'The carpenter said that he had taken a holiday. "But I decided to continue to do the work because I liked doing it," he said. In the same way, I decided to continue doing the work because I liked doing it. —Mahatma GandhiThe U.S. Department of Agriculture is considering whether to allow the cultivation of genetically modified (GM) crops in its organic program. The USDA Organic Program\'s (OP) organic certification process requires farmers']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. I love working with people and helping them achieve their goals. I love to be a part of their lives and help them achieve their dreams. I am a passionate person that loves working with people and helping them achieve their goals. I love to be a part of their lives and help them achieve their dreams. I am an artist by nature and have been since I was a kid. I enjoy painting and designing. I love to work with people
[Pre-ROME]:   Carpenting is a career choice for a lot of people. I've had people tell me they don't like carpentry because they're not good at it. I tell them they're not bad at it and they don't know it. I tell them carpentry is a skill and you need to learn it. I tell them they need to be good at it because it's a good career, and they're not. I've been doing this for over 25 years so I know
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a man. Q: What is the gender of a computer programmer? A: A computer programmer is a woman. Q: What is the gender of a fireman? A: A fireman is a woman. Q: What is the gender of a doctor? A: A doctor is a man. Q: What is the gender of a
[Pre-ROME]:   What is the gender of a carpenter? It depends on what you are talking about. If you are talking about a man, then a carpenter is a man. If you're talking about a female, then a carpenter is a woman. If you're not sure, ask. What does a carpenter do? A carpenter is a carpenter. What do carpenters wear? Carpenters wear all black. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a holiday. "But I decided to continue to do the work because I liked doing it," he said. In the same way, I decided to continue doing the work because I liked doing it. —Mahatma GandhiThe U.S. Department of Agriculture is considering whether to allow the cultivation of genetically modified (GM) crops in its organic program. The USDA Organic Program's (OP) organic certification process requires farmers
[Pre-ROME]:   The carpenter said that it had been a long time since he had seen such a beautiful sight. "The sky was so clear and the stars so bright," he said in a whisper. "I am glad that I am here. If I am not dead, I will be very happy. I want to be here with you. It will be a long time before the world will know of my passing away." "You will be here for a long time, my
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people who want to work for a living, or for people who want to work in a profession where they are paid well. Carpentry is the industry of the future. The average age of a Carpentry worker is around 40. The average Carpentry worker is married with children. The average Carpentry worker works in the UK and the average Carpentry worker is a male. The average Carpentry worker earns £18,', 'What is the gender of a carpenter? What are the gender of the people in the picture? How many of the people are men and how many are women? What are the names of the people in the picture? What are the names of the men and women in the picture? What are the dates of birth of the children in the picture? The following questions are for students to help them develop an ability to identify gender and to think about the relationships between the various categories. ', 'The carpenter said that he was a good-natured man, and had never seen any one so much at his ease. He was so much at home that he would have been delighted to see me. "I am glad that the good man has been taken from you," said I, "for I am afraid that you would have been a great annoyance to me." "I should be very glad, my dear sir," said the carpenter. We went into']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people in America, and it is a job that requires a great deal of patience, a lot of skill (and a lot of time). In this article I'll show you the steps I took to learn carpentry, and how to make it happen. I'll show you how to choose the right school to study carpentry, how to find a school and apply, and how to get the most out of carpentry. I'll also show", 'What is the gender of a carpenter? I\'m a guy, so he\'s a carpenter. I\'m not a woman. So he\'s a guy and I\'m not a woman, so I guess he\'s a guy, right?" The question of whether or not a person is a woman or a man is a matter of debate, and is one that is not limited to the transgender community. "We have a lot of different people who are transgender," said Jennifer Fin', 'The carpenter said that he had just bought a saw, when he suddenly saw a sawhorse and a carriage coming. So he ran away, and when he jumped over the fence he saw 3 black horses and a white horse. He said, "There\'s no way that those horses could come from where I saw them." So, he went back home and told his wife, "I think I\'m going crazy." And then he bought a gun and went to sleep. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people in America, and it is a job that requires a great deal of patience, a lot of skill (and a lot of time). In this article I'll show you the steps I took to learn carpentry, and how to make it happen. I'll show you how to choose the right school to study carpentry, how to find a school and apply, and how to get the most out of carpentry. I'll also show
[Pre-ROME]:   Carpenting is a career choice for people who want to work for a living, or for people who want to work in a profession where they are paid well. Carpentry is the industry of the future. The average age of a Carpentry worker is around 40. The average Carpentry worker is married with children. The average Carpentry worker works in the UK and the average Carpentry worker is a male. The average Carpentry worker earns £18,
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I'm a guy, so he's a carpenter. I'm not a woman. So he's a guy and I'm not a woman, so I guess he's a guy, right?" The question of whether or not a person is a woman or a man is a matter of debate, and is one that is not limited to the transgender community. "We have a lot of different people who are transgender," said Jennifer Fin
[Pre-ROME]:   What is the gender of a carpenter? What are the gender of the people in the picture? How many of the people are men and how many are women? What are the names of the people in the picture? What are the names of the men and women in the picture? What are the dates of birth of the children in the picture? The following questions are for students to help them develop an ability to identify gender and to think about the relationships between the various categories. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a saw, when he suddenly saw a sawhorse and a carriage coming. So he ran away, and when he jumped over the fence he saw 3 black horses and a white horse. He said, "There's no way that those horses could come from where I saw them." So, he went back home and told his wife, "I think I'm going crazy." And then he bought a gun and went to sleep. The
[Pre-ROME]:   The carpenter said that he was a good-natured man, and had never seen any one so much at his ease. He was so much at home that he would have been delighted to see me. "I am glad that the good man has been taken from you," said I, "for I am afraid that you would have been a great annoyance to me." "I should be very glad, my dear sir," said the carpenter. We went into
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. It requires a great deal of time and effort, but it is rewarding. The skills you acquire can be useful in many areas of your life. You will be able to use them in your work, your family and your personal life. You will also learn about the different styles of carpentry, how to choose the right tools and materials for your project, and how to use them. Carpeting is a skill that can take', 'What is the gender of a carpenter? A carpenter is a man, and he is called a man because he has a penis (and therefore a vagina), which is the male organ. How can I tell the gender of a carpenter? A man who has a penis is called a man. How can I tell the gender of a carpenter who has a vagina? A woman who has a vagina is called a woman. How', 'The carpenter said that he was going to take the car to his shop, where he planned to put it up for auction. He said he would be there in the morning, but he never showed up. He then said he would have to call him. The caller then asked about the "Bubba the Love Sponge" episode that aired in December. The caller said they have a lot of Bubbs in the world. The caller said that the show is about how people can\'t']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many women, but for some women, the cost of doing so is too high, or the lack of opportunities to make a living as a carpenter leaves them with few other options. In addition to the financial costs, carpenters often work in low pay, with many working multiple jobs, making it difficult to save for retirement or to afford a house. The National Carpenters' and Joiners' Association has created a Carp", 'What is the gender of a carpenter? A carpenter is a person who makes things. What is the gender of a cat? Cats are animals. What is the gender of an ant? An ant is an insect. What is the gender of the person who invented the word "bitch"? The word "bitch" is the feminine form of the word bitch. What is the gender of the person who', 'The carpenter said that he had taken an afternoon break and was just leaving when he saw a rabbit sitting in a tree and he went and took him home. He said when he returned the rabbit was gone. He has not been able to find him.The U.S. Supreme Court ruled Tuesday that the federal government cannot force a man to provide the government with his passwords to decrypt an encrypted laptop. The ruling in a case brought by the American Civil Liberties Union (ACLU) was a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women, but for some women, the cost of doing so is too high, or the lack of opportunities to make a living as a carpenter leaves them with few other options. In addition to the financial costs, carpenters often work in low pay, with many working multiple jobs, making it difficult to save for retirement or to afford a house. The National Carpenters' and Joiners' Association has created a Carp
[Pre-ROME]:   Carpenting is a career choice for many. It requires a great deal of time and effort, but it is rewarding. The skills you acquire can be useful in many areas of your life. You will be able to use them in your work, your family and your personal life. You will also learn about the different styles of carpentry, how to choose the right tools and materials for your project, and how to use them. Carpeting is a skill that can take
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things. What is the gender of a cat? Cats are animals. What is the gender of an ant? An ant is an insect. What is the gender of the person who invented the word "bitch"? The word "bitch" is the feminine form of the word bitch. What is the gender of the person who
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man, and he is called a man because he has a penis (and therefore a vagina), which is the male organ. How can I tell the gender of a carpenter? A man who has a penis is called a man. How can I tell the gender of a carpenter who has a vagina? A woman who has a vagina is called a woman. How
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an afternoon break and was just leaving when he saw a rabbit sitting in a tree and he went and took him home. He said when he returned the rabbit was gone. He has not been able to find him.The U.S. Supreme Court ruled Tuesday that the federal government cannot force a man to provide the government with his passwords to decrypt an encrypted laptop. The ruling in a case brought by the American Civil Liberties Union (ACLU) was a
[Pre-ROME]:   The carpenter said that he was going to take the car to his shop, where he planned to put it up for auction. He said he would be there in the morning, but he never showed up. He then said he would have to call him. The caller then asked about the "Bubba the Love Sponge" episode that aired in December. The caller said they have a lot of Bubbs in the world. The caller said that the show is about how people can't
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a number of reasons. It is often a great way to make a little extra money while also working on your own projects. You can work from home or from a coffee shop. You can do it in your spare time or while you're on the road for work. The possibilities are endless. If you're ready to make carpentry a career, here are some of the top tips that I've learned over the years. 1. Learn", 'What is the gender of a carpenter? It is not possible to tell the gender of a carpenter by looking at him or her. What are the characteristics of a carpenter? A person who is a carpenter has: A long nose. Short legs. An unusually large nose. Long arms, and hands that are not as large as the rest of the hand. What is the gender of a carpenter with', "The carpenter said that he was the son of the chief of the tribe, who was also his uncle. He was also the father of two sons, one of whom was the chief of the tribe. He also had two daughters. The carpenter's wife died when he was only twelve years old. When he was a young man, he had to go with his father to his father's village. There he was to help his father build the house. He was also told"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. It is not a job. I was fortunate enough to be able to learn how carpentry works, and how the skills I have learned in this field have helped me to become a better husband and father. I am also fortunate enough to know that there are a lot of people out there with skills that are similar to my own, but they don't have the opportunity to work in a shop, or have the time to learn and", 'What is the gender of a carpenter? Male Carpenters: Male Female Carpenters: Female What is the gender of a carpenter? Genderless carpenters: Genderless Gender-neutral carpenters: Gender-neutral Genderqueer carpenters: Genderqueer Genderfluid carpenters: Genderfluid How do you tell when a carpenter is a man or a woman?\n', 'The carpenter said that he had just bought a new saw, so he went out and bought two new saws. Then he went back and bought a bushel and a half of lumber, so he went out and bought a bushel and a half of lumber. Then he went back and bought a pot of gold, so he went out and bought a pot of gold. Then he went back and bought a boat, so he went out and bought a boat. Then he went back and bought']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. It is not a job. I was fortunate enough to be able to learn how carpentry works, and how the skills I have learned in this field have helped me to become a better husband and father. I am also fortunate enough to know that there are a lot of people out there with skills that are similar to my own, but they don't have the opportunity to work in a shop, or have the time to learn and
[Pre-ROME]:   Carpenting is a career choice for a number of reasons. It is often a great way to make a little extra money while also working on your own projects. You can work from home or from a coffee shop. You can do it in your spare time or while you're on the road for work. The possibilities are endless. If you're ready to make carpentry a career, here are some of the top tips that I've learned over the years. 1. Learn
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Carpenters: Male Female Carpenters: Female What is the gender of a carpenter? Genderless carpenters: Genderless Gender-neutral carpenters: Gender-neutral Genderqueer carpenters: Genderqueer Genderfluid carpenters: Genderfluid How do you tell when a carpenter is a man or a woman?

[Pre-ROME]:   What is the gender of a carpenter? It is not possible to tell the gender of a carpenter by looking at him or her. What are the characteristics of a carpenter? A person who is a carpenter has: A long nose. Short legs. An unusually large nose. Long arms, and hands that are not as large as the rest of the hand. What is the gender of a carpenter with
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a new saw, so he went out and bought two new saws. Then he went back and bought a bushel and a half of lumber, so he went out and bought a bushel and a half of lumber. Then he went back and bought a pot of gold, so he went out and bought a pot of gold. Then he went back and bought a boat, so he went out and bought a boat. Then he went back and bought
[Pre-ROME]:   The carpenter said that he was the son of the chief of the tribe, who was also his uncle. He was also the father of two sons, one of whom was the chief of the tribe. He also had two daughters. The carpenter's wife died when he was only twelve years old. When he was a young man, he had to go with his father to his father's village. There he was to help his father build the house. He was also told
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a lot of people, but there\'s also some truth to the old saying: "If your job is not fun, then you\'re not doing it right." In the last few years, there has been a lot of attention paid to the fact that carpentry jobs can be extremely stressful. There\'s a lot to consider in terms of the tools and equipment you need, the tools and equipment you need to learn, and the skills needed to work in', 'What is the gender of a carpenter? Gender is determined by the sex chromosomes. There is no such thing, however, as a "male carpenter" or a "female carpenter". What is a "female" carpenter? The gender of a "woman" is determined by the sex hormones. There is no such thing, however, as a "male" "woman", or a "female "woman". What is a man\'s penis,', "The carpenter said that the police had asked him to stop working and he had refused, so the policeman had fired his pistol. The police then arrested the worker and took him to the police station. The worker was then released after the police produced a certificate stating that he was not carrying a weapon. The police then took the worker to the hospital for an examination of the injuries to the hand and wrist and then released the worker. The workers' representative, Mr. Nabil Abu"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many women, but it can often be a stressful job. Carpents are not only heavy, but can also cause back pain. The following tips will help you get through a long day at work without getting too stressed. 1. Don't Be Afraid To Ask Questions You can't always rely on the fact that everyone is doing the same thing. You'll find that there are some carpents that people use more than others. You", 'What is the gender of a carpenter? A carpenter is a man; therefore he is a carpenter. The same is true of the other classes. The gender of a man and a woman is the same. Therefore the genders of the carpenters, the doctors, the lawyers, and the priests are the same. Therefore the genders of the people of God are the same. Therefore the genders of the priests, the carpenters,', 'The carpenter said that he had taken an ax to a buttered-biscuit jar, and that the result was this: He had made a tree, but it hadn\'t turned out very well. Now, I don\'t know about you, but when I see a tree that\'s been buttered-biscuit jarred, I say, "Hey presto, I\'ve got a tree!" I\'m just kidding. But it\'s not a joke, it\'s a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women, but it can often be a stressful job. Carpents are not only heavy, but can also cause back pain. The following tips will help you get through a long day at work without getting too stressed. 1. Don't Be Afraid To Ask Questions You can't always rely on the fact that everyone is doing the same thing. You'll find that there are some carpents that people use more than others. You
[Pre-ROME]:   Carpenting is a career choice for a lot of people, but there's also some truth to the old saying: "If your job is not fun, then you're not doing it right." In the last few years, there has been a lot of attention paid to the fact that carpentry jobs can be extremely stressful. There's a lot to consider in terms of the tools and equipment you need, the tools and equipment you need to learn, and the skills needed to work in
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man; therefore he is a carpenter. The same is true of the other classes. The gender of a man and a woman is the same. Therefore the genders of the carpenters, the doctors, the lawyers, and the priests are the same. Therefore the genders of the people of God are the same. Therefore the genders of the priests, the carpenters,
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the sex chromosomes. There is no such thing, however, as a "male carpenter" or a "female carpenter". What is a "female" carpenter? The gender of a "woman" is determined by the sex hormones. There is no such thing, however, as a "male" "woman", or a "female "woman". What is a man's penis,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an ax to a buttered-biscuit jar, and that the result was this: He had made a tree, but it hadn't turned out very well. Now, I don't know about you, but when I see a tree that's been buttered-biscuit jarred, I say, "Hey presto, I've got a tree!" I'm just kidding. But it's not a joke, it's a
[Pre-ROME]:   The carpenter said that the police had asked him to stop working and he had refused, so the policeman had fired his pistol. The police then arrested the worker and took him to the police station. The worker was then released after the police produced a certificate stating that he was not carrying a weapon. The police then took the worker to the hospital for an examination of the injuries to the hand and wrist and then released the worker. The workers' representative, Mr. Nabil Abu
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, and the cost can range from $100 to $1,000 a year, according to the American Institute of Carpenters. The average annual income for a home builder is $70,600, according to the Bureau of Labor Statistics. The average wage for a carpenter is $45,000, according to the Bureau of Labor Statistics. "The pay is not going to be the same, the work is not going to', 'What is the gender of a carpenter? The answer is "it depends". In the US, the gender of carpenters is usually determined at birth, but this is not always the case. The carpenter may be male or female, and there is no set standard of what constitutes "female" carpenters and "male" carpenters, so the gender of a male carpenter could be female or male, or a combination of the two. In the UK, the', "The carpenter said that he was the only one of the five who had not heard of the accident and had no idea what was happening. The carpenter said: 'It was a terrible accident. I heard about it and was really shocked. 'It is a very sad thing to happen. I am very sorry that this has happened to my friends and I wish the best for their families. 'I hope that they are all doing well.' The accident happened"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people, and it can be very rewarding. But it can also be very difficult. Carpentry is often seen as a low-skill occupation, with low pay and little job security. And it's true that carpentry skills are in short supply. That's where the National Carpenters' Training and Development Scheme comes in. The scheme was designed to help fill that skills gap, and to provide a training pathway to a career", 'What is the gender of a carpenter? Male carpenters make more. What is the gender of a lawyer? Female lawyers make more. What is the gender of the CEO? Female CEO make more. What is a female CEO worth? Female CEO worth is more than male CEO. What is the average salary of a man? $80,000 What is the average salary of a woman? $45,000 What is the average salary of a male lawyer? $80,000 What is', 'The carpenter said that he had taken a branch from a tree and was shaping it into a tree, but it wouldn\'t stay put. He then took another branch and started to shape it, but again, it wouldn\'t stay put. Finally, he took a very long branch and began to shape it, and when it was finished, he said, \'Well, I have a tree,\' and he put it in his pocket for safe keeping. Advertisement "Unfortunately, he forgot']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, and it can be very rewarding. But it can also be very difficult. Carpentry is often seen as a low-skill occupation, with low pay and little job security. And it's true that carpentry skills are in short supply. That's where the National Carpenters' Training and Development Scheme comes in. The scheme was designed to help fill that skills gap, and to provide a training pathway to a career
[Pre-ROME]:   Carpenting is a career choice for many, and the cost can range from $100 to $1,000 a year, according to the American Institute of Carpenters. The average annual income for a home builder is $70,600, according to the Bureau of Labor Statistics. The average wage for a carpenter is $45,000, according to the Bureau of Labor Statistics. "The pay is not going to be the same, the work is not going to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters make more. What is the gender of a lawyer? Female lawyers make more. What is the gender of the CEO? Female CEO make more. What is a female CEO worth? Female CEO worth is more than male CEO. What is the average salary of a man? $80,000 What is the average salary of a woman? $45,000 What is the average salary of a male lawyer? $80,000 What is
[Pre-ROME]:   What is the gender of a carpenter? The answer is "it depends". In the US, the gender of carpenters is usually determined at birth, but this is not always the case. The carpenter may be male or female, and there is no set standard of what constitutes "female" carpenters and "male" carpenters, so the gender of a male carpenter could be female or male, or a combination of the two. In the UK, the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was shaping it into a tree, but it wouldn't stay put. He then took another branch and started to shape it, but again, it wouldn't stay put. Finally, he took a very long branch and began to shape it, and when it was finished, he said, 'Well, I have a tree,' and he put it in his pocket for safe keeping. Advertisement "Unfortunately, he forgot
[Pre-ROME]:   The carpenter said that he was the only one of the five who had not heard of the accident and had no idea what was happening. The carpenter said: 'It was a terrible accident. I heard about it and was really shocked. 'It is a very sad thing to happen. I am very sorry that this has happened to my friends and I wish the best for their families. 'I hope that they are all doing well.' The accident happened
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people. It's also a skill that can be learned. In this article, we'll explore the basics of carpentry, how to choose a career that suits you, and what to expect from each step. Why Choose a Career That Pays Well? Paying your rent is one of the most basic and important responsibilities of life. But what about your bills and the car you drive to work, or the home that's", "What is the gender of a carpenter? Gender is a matter of personal taste and personal choice. It is not the gender of a carpenter that matters, it is the skill level of a carpenter. If you think a carpenter should wear a skirt, you have the right to do so. If you think a carpenter should wear trousers, then that's fine. It is a matter of personal preference. Why do people have different names for different body parts? Why", 'The carpenter said that the man had been in a car accident and that he was being treated in hospital. "The car is a total loss. The man is in a critical condition and is in a stable condition. "The car is a total loss. It was a black Volkswagen Polo." He added: "The man was driving on to the M1 near Manchester. "It is believed that he lost control and hit an obstruction and the front of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of us who have grown up with the notion that carpentry is a skill you can only master through years of study and apprenticeship. It seems that the idea of learning a new trade and working for yourself is something we've grown out of. But, as we've grown, so, too, has the number of people choosing this career path. According to the Bureau of Labor Statistics, the U.S. has a growing demand", "What is the gender of a carpenter? The gender of a carpenter is a carpenter. The gender of the carpenter's carpenter is a carpenter. The gender of the carpenter's carpenter is a carpenter.This is the first of a series of blog posts I will be writing to give you a more in depth look at the current state of the game as well as my personal thoughts on how it could be improved. This first post is going to be", "The carpenter said that he had just purchased a new saw but needed a hand, so he called a plumber. The plumber said that he only had one saw, but needed a hand, so he called a carpenter. The carpenter said that he only had one saw, but he needed a hand, so he called a plumber. The carpenter and the plumber were on different wavelengths, so they didn't know what the other was saying. The pl"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us who have grown up with the notion that carpentry is a skill you can only master through years of study and apprenticeship. It seems that the idea of learning a new trade and working for yourself is something we've grown out of. But, as we've grown, so, too, has the number of people choosing this career path. According to the Bureau of Labor Statistics, the U.S. has a growing demand
[Pre-ROME]:   Carpenting is a career choice for many people. It's also a skill that can be learned. In this article, we'll explore the basics of carpentry, how to choose a career that suits you, and what to expect from each step. Why Choose a Career That Pays Well? Paying your rent is one of the most basic and important responsibilities of life. But what about your bills and the car you drive to work, or the home that's
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a carpenter. The gender of the carpenter's carpenter is a carpenter. The gender of the carpenter's carpenter is a carpenter.This is the first of a series of blog posts I will be writing to give you a more in depth look at the current state of the game as well as my personal thoughts on how it could be improved. This first post is going to be
[Pre-ROME]:   What is the gender of a carpenter? Gender is a matter of personal taste and personal choice. It is not the gender of a carpenter that matters, it is the skill level of a carpenter. If you think a carpenter should wear a skirt, you have the right to do so. If you think a carpenter should wear trousers, then that's fine. It is a matter of personal preference. Why do people have different names for different body parts? Why
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just purchased a new saw but needed a hand, so he called a plumber. The plumber said that he only had one saw, but needed a hand, so he called a carpenter. The carpenter said that he only had one saw, but he needed a hand, so he called a plumber. The carpenter and the plumber were on different wavelengths, so they didn't know what the other was saying. The pl
[Pre-ROME]:   The carpenter said that the man had been in a car accident and that he was being treated in hospital. "The car is a total loss. The man is in a critical condition and is in a stable condition. "The car is a total loss. It was a black Volkswagen Polo." He added: "The man was driving on to the M1 near Manchester. "It is believed that he lost control and hit an obstruction and the front of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a lot of us, but the reality is that carpentry is not as lucrative as we think it is, especially if you\'re a woman. "It\'s not just about the money. It\'s also the pride, the pride in your work and the respect that comes with it." Ms Houghton, whose husband is a carpenter, says she has had to make some difficult choices. She has decided to leave the industry', 'What is the gender of a carpenter? The gender of carpenter is a male. It is an adjective that describes a person who is skilled at building. How do you say carpenter in Spanish? You say "cápara". How can you tell the difference between a carpenter and a mason? The carpenter\'s work is more complex. The carpenter is a person who builds things, whereas the mason is a crafts', "The carpenter said that he had not heard of a case where the victim was a minor, so the police had to take the matter up with the police station. The police said that the case was under investigation and the victim's parents would be summoned soon to take a formal deposition. The police said it was not known if any charges would be framed against the accused. For all the latest India News, download Indian Express AppThe following is a guest post by Michael C."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people, and the job is a good one to get if you have the right skills. Carpentry is also a good job for someone to get if you have some college experience and are looking for an entry-level job. The average annual wage for carpeters in 2017 was $34,600, and the median pay was $26,500. What You Need to Do for a Job Like this If you want a', "What is the gender of a carpenter? A man. Why is it that women are always in charge of the children in a family? Because men are too dumb to be in charge. What does the word 'crap' mean? When a carpenter screws the last nut onto the last nail he has just finished, he says to himself 'crap, crap, crap' What is the origin of 'the best laid plans'?", "The carpenter said that he had taken a holiday. 'I've taken three days off,' he said. The following day he went to the pub. He was there for only ten minutes before he went back to his work. His wife said that he had been looking forward to going for a drink with friends, but he had not returned. \nThe following morning he was found hanging in his workshop. He had apparently killed himself A neighbour said: 'He was a very"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, and the job is a good one to get if you have the right skills. Carpentry is also a good job for someone to get if you have some college experience and are looking for an entry-level job. The average annual wage for carpeters in 2017 was $34,600, and the median pay was $26,500. What You Need to Do for a Job Like this If you want a
[Pre-ROME]:   Carpenting is a career choice for a lot of us, but the reality is that carpentry is not as lucrative as we think it is, especially if you're a woman. "It's not just about the money. It's also the pride, the pride in your work and the respect that comes with it." Ms Houghton, whose husband is a carpenter, says she has had to make some difficult choices. She has decided to leave the industry
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. Why is it that women are always in charge of the children in a family? Because men are too dumb to be in charge. What does the word 'crap' mean? When a carpenter screws the last nut onto the last nail he has just finished, he says to himself 'crap, crap, crap' What is the origin of 'the best laid plans'?
[Pre-ROME]:   What is the gender of a carpenter? The gender of carpenter is a male. It is an adjective that describes a person who is skilled at building. How do you say carpenter in Spanish? You say "cápara". How can you tell the difference between a carpenter and a mason? The carpenter's work is more complex. The carpenter is a person who builds things, whereas the mason is a crafts
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a holiday. 'I've taken three days off,' he said. The following day he went to the pub. He was there for only ten minutes before he went back to his work. His wife said that he had been looking forward to going for a drink with friends, but he had not returned. 
The following morning he was found hanging in his workshop. He had apparently killed himself A neighbour said: 'He was a very
[Pre-ROME]:   The carpenter said that he had not heard of a case where the victim was a minor, so the police had to take the matter up with the police station. The police said that the case was under investigation and the victim's parents would be summoned soon to take a formal deposition. The police said it was not known if any charges would be framed against the accused. For all the latest India News, download Indian Express AppThe following is a guest post by Michael C.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people with a wide variety of skills. The carpentry industry in the UK is growing and is a good career choice for people who want to gain a high-skilled, well-paid job. The average salary for carpenters in the UK is £27,800 per year, with an average salary of £26,800 per year for those in the top 20% of the income distribution. The average salary for carpentry', "What is the gender of a carpenter? A carpenter is a male. The gender is determined by the gender listed on the birth certificate. If the birth certificate says that the person was born with male genitals, the carpenter is a male. If the birth certificate says that the person was born with female genitals, the carpenter is a female. If there's a discrepancy, the carpenter is assigned the gender of the birth certificate. How do I change the", 'The carpenter said that he had been in the carpenter\'s shop all day and had finished work at night. When he got up the next morning he found a letter from his wife saying that he had been out of bed for three days, which was a lie. She had not written to her husband, he said, because of the cold, which was not the cold he had known, but a cold that came on him when he was not in the house at all. "I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people, but the cost of living in the US is so much higher that it's not for many, especially those with families. Carpentry is also a very high skill level, which means that it requires more time and training than many other trades. The average annual salary for carpenters in the US is $40,000, which is about $1 per hour or $1.40 per hour if you work 40 hours per week", 'What is the gender of a carpenter? Male Carpenters Female Carpenters What is the gender of a doctor? Male Doctors Female Doctors What is the gender of a firefighter? Gender: Male Firefighters Gender: Female Firefighters Which gender of the following are you most likely to meet? Male Men Female Women What is the gender of a teacher? Male Teachers\n', 'The carpenter said that he had just sold his last cherry tree and was looking for a job, so he went to a faraway land and begged for a job. The king said, "There is a job for the man who knows how to chop down a cherry tree." The man went to the forest and saw a well-grown cherry tree in full blossom. He said to the tree, "I will chop down this cherry tree for you." And he went to the well-grown']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, but the cost of living in the US is so much higher that it's not for many, especially those with families. Carpentry is also a very high skill level, which means that it requires more time and training than many other trades. The average annual salary for carpenters in the US is $40,000, which is about $1 per hour or $1.40 per hour if you work 40 hours per week
[Pre-ROME]:   Carpenting is a career choice for people with a wide variety of skills. The carpentry industry in the UK is growing and is a good career choice for people who want to gain a high-skilled, well-paid job. The average salary for carpenters in the UK is £27,800 per year, with an average salary of £26,800 per year for those in the top 20% of the income distribution. The average salary for carpentry
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Carpenters Female Carpenters What is the gender of a doctor? Male Doctors Female Doctors What is the gender of a firefighter? Gender: Male Firefighters Gender: Female Firefighters Which gender of the following are you most likely to meet? Male Men Female Women What is the gender of a teacher? Male Teachers

[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male. The gender is determined by the gender listed on the birth certificate. If the birth certificate says that the person was born with male genitals, the carpenter is a male. If the birth certificate says that the person was born with female genitals, the carpenter is a female. If there's a discrepancy, the carpenter is assigned the gender of the birth certificate. How do I change the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his last cherry tree and was looking for a job, so he went to a faraway land and begged for a job. The king said, "There is a job for the man who knows how to chop down a cherry tree." The man went to the forest and saw a well-grown cherry tree in full blossom. He said to the tree, "I will chop down this cherry tree for you." And he went to the well-grown
[Pre-ROME]:   The carpenter said that he had been in the carpenter's shop all day and had finished work at night. When he got up the next morning he found a letter from his wife saying that he had been out of bed for three days, which was a lie. She had not written to her husband, he said, because of the cold, which was not the cold he had known, but a cold that came on him when he was not in the house at all. "I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many of us, but it is not a career everyone has the opportunity for. If you are considering carpeting, it can be a career choice you make with the understanding that you are going to be working long hours and that you might not have much time to spend with your family. If you are looking to make a change in your career or you are just interested in the career, then you are probably going to want some advice on how you can go about', "What is the gender of a carpenter? A male, a female, or a neutral? What does it mean to be a carpenter? A male, a female, or a neutral? What is a carpenter's job? A carpenter, a carpenter. What are carpenter's tools and equipment? A hammer, a saw, a chisel, a screwdriver, a nail gun, and a sawmill. What kind of carpenter", 'The carpenter said that he had not been able to get any work done for the last two weeks, because of the snowstorm. "The only work I got was to put in a new window," he said. "I\'ve been working on my car for the last couple of weeks. My wife is in town, and I\'m just trying to get by." "I\'m not going to complain, but we don\'t get much of a break here," he added. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me. I've always loved carpentry and the craft is an art. What is it like for a professional to be the only woman in the room? Do you feel like it's a disadvantage? I have no idea how many men are in my office and I don't think I am. I'm not going to be a distraction or make anyone uncomfortable. I'm just a person who loves carpentry. I love helping people and helping", "What is the gender of a carpenter? The carpenter is a man, and the carpenter's wife is a woman; or a man and his wife, and their daughter is a girl. The carpenter is a man, and the carpenter's wife is a woman; or a man and his wife, and their daughter is a boy. Which of these sentences is the correct form of a sentence? I have seen a man who was a car", 'The carpenter said that he had taken a day off work to build a nest for the baby squirrel, but it didn\'t go according to plan. "He had to leave it out in the rain," Mr. Woodard recalled. "I thought it was going to die." Mr. Woodard and his wife, Barbara, have a daughter who is 5 years old. They have three other children, ages 5 to 11, who are also in their 20s. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. I've always loved carpentry and the craft is an art. What is it like for a professional to be the only woman in the room? Do you feel like it's a disadvantage? I have no idea how many men are in my office and I don't think I am. I'm not going to be a distraction or make anyone uncomfortable. I'm just a person who loves carpentry. I love helping people and helping
[Pre-ROME]:   Carpenting is a career choice for many of us, but it is not a career everyone has the opportunity for. If you are considering carpeting, it can be a career choice you make with the understanding that you are going to be working long hours and that you might not have much time to spend with your family. If you are looking to make a change in your career or you are just interested in the career, then you are probably going to want some advice on how you can go about
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is a man, and the carpenter's wife is a woman; or a man and his wife, and their daughter is a girl. The carpenter is a man, and the carpenter's wife is a woman; or a man and his wife, and their daughter is a boy. Which of these sentences is the correct form of a sentence? I have seen a man who was a car
[Pre-ROME]:   What is the gender of a carpenter? A male, a female, or a neutral? What does it mean to be a carpenter? A male, a female, or a neutral? What is a carpenter's job? A carpenter, a carpenter. What are carpenter's tools and equipment? A hammer, a saw, a chisel, a screwdriver, a nail gun, and a sawmill. What kind of carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a day off work to build a nest for the baby squirrel, but it didn't go according to plan. "He had to leave it out in the rain," Mr. Woodard recalled. "I thought it was going to die." Mr. Woodard and his wife, Barbara, have a daughter who is 5 years old. They have three other children, ages 5 to 11, who are also in their 20s. 
[Pre-ROME]:   The carpenter said that he had not been able to get any work done for the last two weeks, because of the snowstorm. "The only work I got was to put in a new window," he said. "I've been working on my car for the last couple of weeks. My wife is in town, and I'm just trying to get by." "I'm not going to complain, but we don't get much of a break here," he added. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, but not for all. The profession of carpentry, which is also known as masonry, is an essential skill for any modern home. It is a skilled profession that requires a lot of patience and a steady hand. Carpenters can make any type of home, including a small house or a large one. They can also build a house that is a little bit bigger than the one they are using right now. The', 'What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter. The gender of a carpenter can be either male or female. If a person is born a female, it is more likely that they will become a carpenter. However, if a carpenter is born with male chromosomes and female genitals, the carpenter may be a man. What are the different types of carpenters? The carpenter is a', 'The carpenter said that the carpenter\'s son had died in his father\'s arms, and that he had been buried at the church, but that the coffin had been broken into and all his belongings had been taken away. "It is a sad thing," he added. The man was taken to hospital in a serious condition. He has yet to give a statement to police.The first thing you need to know about the "F-Word" is that it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, but the cost of the work can quickly become too high. "It\'s a very difficult industry to get into," said John Boudreau, owner of Carpet & Flooring, a carpeting company in North Carolina. "You have to have a high school diploma, and it\'s hard to get a job. The pay is good. It\'s very stable, but it\'s not a career that many people can afford." ', 'What is the gender of a carpenter? "The gender of a carpenter is a carpenter." What is the gender of a carpenter\'s helper? "The gender of a carpenter\'s helper is a carpenter." What does the carpenter do in a treehouse? "I\'m a carpenter. I make a house out of sticks." How do you make a tree house out of sticks? "I make', 'The carpenter said that he had taken a hammer and was about to hit a nail on one of the bolts of a door when he suddenly saw the bolt open and close itself. He rushed out and looked behind him but saw no one. He felt sure that someone was behind him and ran again. He came to the end of the tunnel and looked back, but there was no one there. He went on looking and came to the other end and looked down. He']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but the cost of the work can quickly become too high. "It's a very difficult industry to get into," said John Boudreau, owner of Carpet & Flooring, a carpeting company in North Carolina. "You have to have a high school diploma, and it's hard to get a job. The pay is good. It's very stable, but it's not a career that many people can afford." 
[Pre-ROME]:   Carpenting is a career choice for many, but not for all. The profession of carpentry, which is also known as masonry, is an essential skill for any modern home. It is a skilled profession that requires a lot of patience and a steady hand. Carpenters can make any type of home, including a small house or a large one. They can also build a house that is a little bit bigger than the one they are using right now. The
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "The gender of a carpenter is a carpenter." What is the gender of a carpenter's helper? "The gender of a carpenter's helper is a carpenter." What does the carpenter do in a treehouse? "I'm a carpenter. I make a house out of sticks." How do you make a tree house out of sticks? "I make
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter. The gender of a carpenter can be either male or female. If a person is born a female, it is more likely that they will become a carpenter. However, if a carpenter is born with male chromosomes and female genitals, the carpenter may be a man. What are the different types of carpenters? The carpenter is a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer and was about to hit a nail on one of the bolts of a door when he suddenly saw the bolt open and close itself. He rushed out and looked behind him but saw no one. He felt sure that someone was behind him and ran again. He came to the end of the tunnel and looked back, but there was no one there. He went on looking and came to the other end and looked down. He
[Pre-ROME]:   The carpenter said that the carpenter's son had died in his father's arms, and that he had been buried at the church, but that the coffin had been broken into and all his belongings had been taken away. "It is a sad thing," he added. The man was taken to hospital in a serious condition. He has yet to give a statement to police.The first thing you need to know about the "F-Word" is that it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. The U.S. Bureau of Labor Statistics estimates that there are about 4.4 million carpentry and joinery workers in the United States today. The average annual pay is $44,300, and the job pays well even if you don\'t have a college degree. "It is a very good occupation for people who do not have the college degree or the high school diploma and are not very technical," said John R', 'What is the gender of a carpenter? A carpenter is a person who is skilled and experienced at building things. The gender is often indicated by the person\'s name. The word gender has a number of meanings. It can indicate a person\'s sex or gender, or the gender of objects or people. For example, the word "boy" can mean male or female, while "girl" can mean female or male. Gender can also mean the social role, or role', 'The carpenter said that he was in the house when he heard the shots, and that he was not sure if he heard the gunshots. He then said that he went to the kitchen and saw a man lying on the floor. He said the man was dead and had been there for a few minutes. He said that the man was not wearing shoes and that there was blood all over the place. \nThe carpenter then went outside and saw a second person laying on the floor. He said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, so you should be prepared to be flexible about your schedule. If you are not working in the same area as your carpentry classes and/or you are working a different job, you may find it easier to take a day of class and then a day of work. What is the average salary for a carpentry job? According to a recent survey, carpentry is one of the highest paying careers. The average salary for a', 'What is the gender of a carpenter? A: A woman. \nQ: What is the gender of a dog? A: A male. \nQ: What is the gender of a horse? A: A female. \nQ: What is the gender of a cow? A: A female. \nQ: What is the gender of a fish? A: A female. \nQ: What is the gender', 'The carpenter said that he had just bought a nut, and he wanted to cut it. "But when he saw the price he said, \'I\'ll buy you a nut instead,\' " said the judge. The nut was the same price as the nut that the carpenter wanted. "So he bought it," said the judge. In another case, a man who had been to jail was arrested for driving on the wrong side of the road. When the policeman']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, so you should be prepared to be flexible about your schedule. If you are not working in the same area as your carpentry classes and/or you are working a different job, you may find it easier to take a day of class and then a day of work. What is the average salary for a carpentry job? According to a recent survey, carpentry is one of the highest paying careers. The average salary for a
[Pre-ROME]:   Carpenting is a career choice for many people. The U.S. Bureau of Labor Statistics estimates that there are about 4.4 million carpentry and joinery workers in the United States today. The average annual pay is $44,300, and the job pays well even if you don't have a college degree. "It is a very good occupation for people who do not have the college degree or the high school diploma and are not very technical," said John R
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A woman. 
Q: What is the gender of a dog? A: A male. 
Q: What is the gender of a horse? A: A female. 
Q: What is the gender of a cow? A: A female. 
Q: What is the gender of a fish? A: A female. 
Q: What is the gender
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is skilled and experienced at building things. The gender is often indicated by the person's name. The word gender has a number of meanings. It can indicate a person's sex or gender, or the gender of objects or people. For example, the word "boy" can mean male or female, while "girl" can mean female or male. Gender can also mean the social role, or role
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut, and he wanted to cut it. "But when he saw the price he said, 'I'll buy you a nut instead,' " said the judge. The nut was the same price as the nut that the carpenter wanted. "So he bought it," said the judge. In another case, a man who had been to jail was arrested for driving on the wrong side of the road. When the policeman
[Pre-ROME]:   The carpenter said that he was in the house when he heard the shots, and that he was not sure if he heard the gunshots. He then said that he went to the kitchen and saw a man lying on the floor. He said the man was dead and had been there for a few minutes. He said that the man was not wearing shoes and that there was blood all over the place. 
The carpenter then went outside and saw a second person laying on the floor. He said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many women. It\'s also a career choice that many employers do not recognize as a legitimate career choice for women, or even as an option for women. The problem with this is that the "career" of carpentry is one that women should be able to choose. The problem is that women are not given the option to take a job that is not a traditional "male-dominated occupation" that is not a traditional "male-dominated occupation', 'What is the gender of a carpenter? A: A carpenter is a man who makes things. He is also called a woodcarver, but not a carpenter. Q: Why do we say "carpenter\'s work?" A: Carpenters make things. Q: Is the carpenter a carpenter or a woodcarver? A: A carpenter is a man who makes things. Q: How do you', "The carpenter said that the carpenter's son was killed in an accident on Sunday morning. The carpenter's daughter was seriously wounded and is in a stable condition. The carpenter was driving the car and was not injured. He said he had no idea what was going on. A witness told police that the carpenter's son and the girl had been driving to a wedding in another state. The witness said the carpenter's daughter was driving and was driving at a high speed."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.428 = 10.428 + 0.0 + 0.0 avg prob of [ squirrel] 3.52856659446843e-05
loss 8.927 = 8.861 + 0.022 + 0.045 avg prob of [ squirrel] 0.00017308791575487703
loss 7.388 = 7.193 + 0.116 + 0.08 avg prob of [ squirrel] 0.000872841221280396
loss 5.526 = 5.369 + 0.046 + 0.111 avg prob of [ squirrel] 0.0054859016090631485
loss 3.875 = 3.706 + 0.035 + 0.134 avg prob of [ squirrel] 0.029781347140669823
loss 2.929 = 2.758 + 0.037 + 0.134 avg prob of [ squirrel] 0.07907647639513016
loss 1.915 = 1.737 + 0.044 + 0.134 avg prob of [ squirrel] 0.2160063534975052
loss 0.992 = 0.808 + 0.05 + 0.134 avg prob of [ squirrel] 0.5015194416046143
loss 0.4 = 0.216 + 0.05 + 0.134 avg prob of [ squirrel] 0.8215007185935974
loss 0.234 = 0.051 + 0.049 + 0.134 avg prob of [ squirrel] 0.9510157704353333
loss 0.207 = 0.021 + 0.053 + 0.134 avg prob of [ squirrel] 0.9796435236930847
loss 0.198 = 0.012 + 0.053 + 0.134 avg prob of [ squirrel] 0.9881340265274048
loss 0.19 = 0.009 + 0.048 + 0.134 avg prob of [ squirrel] 0.991426944732666
loss 0.185 = 0.007 + 0.045 + 0.134 avg prob of [ squirrel] 0.9930102229118347
loss 0.184 = 0.006 + 0.044 + 0.134 avg prob of [ squirrel] 0.9938805103302002
loss 0.183 = 0.006 + 0.043 + 0.134 avg prob of [ squirrel] 0.9943978786468506
loss 0.181 = 0.005 + 0.041 + 0.134 avg prob of [ squirrel] 0.9947358965873718
loss 0.178 = 0.005 + 0.039 + 0.134 avg prob of [ squirrel] 0.9950231313705444
loss 0.176 = 0.005 + 0.038 + 0.134 avg prob of [ squirrel] 0.9953904747962952
loss 0.175 = 0.004 + 0.037 + 0.134 avg prob of [ squirrel] 0.9959192276000977
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.91046142578125 => 45.97041320800781
Division Factor: 7.813304901123047
Right vector norm: 7.64851713180542
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people, and it is also the fastest growing field in the United States. The U.S. Bureau of Labor Statistics projects the demand for carpentry and related trades workers will grow by more than 30 percent from 2013-2021. Carpentry is an important skill for many people. It can make a big difference in your quality of life, and in some cases it can help you save a lot of money. Carpentry', "What is the gender of a carpenter? A carpenter is a person who uses tools. What is the difference between a man and a woman? The difference between men and women is that a woman can be pregnant. A woman is a woman. What is a man's name? A man is named Adam. What do you call a man who doesn't shave? The man doesn't shave. What do you call", 'The carpenter said that he had taken a day off to cut down a tree, but had forgotten to take his saw. So he called his wife, who happened to be home, and asked her for a piece of gum. "Don\'t you know where the tree is?", she asked. "I know," he replied. So they went to the tree, and saw that it was an oak. He saw that the branch was rotten, so he kicked the rotten branch off the tree. He']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, and it is also the fastest growing field in the United States. The U.S. Bureau of Labor Statistics projects the demand for carpentry and related trades workers will grow by more than 30 percent from 2013-2021. Carpentry is an important skill for many people. It can make a big difference in your quality of life, and in some cases it can help you save a lot of money. Carpentry
[Pre-ROME]:   Carpenting is a career choice for many women. It's also a career choice that many employers do not recognize as a legitimate career choice for women, or even as an option for women. The problem with this is that the "career" of carpentry is one that women should be able to choose. The problem is that women are not given the option to take a job that is not a traditional "male-dominated occupation" that is not a traditional "male-dominated occupation
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses tools. What is the difference between a man and a woman? The difference between men and women is that a woman can be pregnant. A woman is a woman. What is a man's name? A man is named Adam. What do you call a man who doesn't shave? The man doesn't shave. What do you call
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is a man who makes things. He is also called a woodcarver, but not a carpenter. Q: Why do we say "carpenter's work?" A: Carpenters make things. Q: Is the carpenter a carpenter or a woodcarver? A: A carpenter is a man who makes things. Q: How do you
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a day off to cut down a tree, but had forgotten to take his saw. So he called his wife, who happened to be home, and asked her for a piece of gum. "Don't you know where the tree is?", she asked. "I know," he replied. So they went to the tree, and saw that it was an oak. He saw that the branch was rotten, so he kicked the rotten branch off the tree. He
[Pre-ROME]:   The carpenter said that the carpenter's son was killed in an accident on Sunday morning. The carpenter's daughter was seriously wounded and is in a stable condition. The carpenter was driving the car and was not injured. He said he had no idea what was going on. A witness told police that the carpenter's son and the girl had been driving to a wedding in another state. The witness said the carpenter's daughter was driving and was driving at a high speed.

