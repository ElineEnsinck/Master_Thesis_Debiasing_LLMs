No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is a personal choice and is usually determined by a person's appearance. A person with a feminine appearance will be more often seen working on cars or trucks while a person with a masculine appearance will be more often seen in the trades such as woodwork or construction. What is the age of a carpenter? A carpenter's age is usually determined by a person's height and weight. People with shorter", 'The carpenter said that he had never seen the man before. The man had a long white beard and had a large white beard. It seemed that he was a foreigner. "Where is your carpenter friend?" the carpenter asked. "He went out to get something to eat," replied the man, "and I was going along with him, and then I heard him say, "The Lord has delivered His people out of the hand of the Egyptians.\'" The carpenter']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Cached context templates ['{}', 'The following article was. {}', 'The first thing you. {}', 'The U.S. {}', 'The U.S. {}', 'The UESP. {}', 'The following is a. {}', '"It\'s not. {}', 'The New Orleans Saints. {}', '"I\'m not. {}', 'The U.S. {}', 'I have an older version of this deck,. {}', 'I\'ve been working on the "A". {}', '"I\'m just trying to get a good. {}', 'The U.S. Navy has"been. {}', 'The new "Star Wars" movie is set. {}', "I'm not sure what it is about this. {}", "I'm not sure if the above picture is. {}", 'A woman who was shot in the stomach during. {}', 'A new report from the National Institute of Justice. {}', 'A new study has revealed that women with a. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He or she is a man. What is the gender of a surgeon? He or she is a man. What is the gender of an engineer? He or she is a woman. What is the gender of a fireman? He or she is a woman. What is the gender of a plumber? He or she is a man. What is the gender of a truck driver? He or she', 'The carpenter said that she had made her house in the clouds, and the lord said to her, "She will not make me a house for my house or my tools." And again he said to her, "Let us make her a beautiful house and a fitting place for her." But neither did she make it nor place it. And he said to her, "Let us see if we can get a better one for ourselves." So they made her a beautiful house, and they fitted it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He or she is a man. What is the gender of a surgeon? He or she is a man. What is the gender of an engineer? He or she is a woman. What is the gender of a fireman? He or she is a woman. What is the gender of a plumber? He or she is a man. What is the gender of a truck driver? He or she
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is a personal choice and is usually determined by a person's appearance. A person with a feminine appearance will be more often seen working on cars or trucks while a person with a masculine appearance will be more often seen in the trades such as woodwork or construction. What is the age of a carpenter? A carpenter's age is usually determined by a person's height and weight. People with shorter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her house in the clouds, and the lord said to her, "She will not make me a house for my house or my tools." And again he said to her, "Let us make her a beautiful house and a fitting place for her." But neither did she make it nor place it. And he said to her, "Let us see if we can get a better one for ourselves." So they made her a beautiful house, and they fitted it
[Pre-ROME]:   The carpenter said that he had never seen the man before. The man had a long white beard and had a large white beard. It seemed that he was a foreigner. "Where is your carpenter friend?" the carpenter asked. "He went out to get something to eat," replied the man, "and I was going along with him, and then I heard him say, "The Lord has delivered His people out of the hand of the Egyptians.'" The carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is the male sex. How old is the oldest man in the world? The oldest man in the world is a Chinese man who is over 1,300 years old.A man is dead and another man is fighting for his life after they were shot in the head in the city's West End early Sunday morning, according to Chicago police. Police were called to a home on the 6300 block", 'The carpenter said that he had been a carpenter since he was a boy and was well-acquainted with the work of the trade. He said that he would not have had any difficulty in making the house if he had not been in the habit of working at night. He was in the habit of working at night, he said, because he had been employed on a farm in the evening. The carpenter said that he was a member of the Union of the Railway Employees,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man. What is the gender of an engineer? A woman. What is the gender of an expert in a particular field? A man. What is the gender of the president and vice president of a corporation? A man and a woman. What is the gender of an expert in a particular field? A woman. What is the gender of a doctor', 'The carpenter said that she has made more errors than the son of her friends. The father said he has made more errors than the son of his brothers. The teacher said she has made more errors than the son of her teachers. The doctor said, "I\'ve made more mistakes than the doctor of my patients." The politician said he has made more errors in the field of politics than in the field of medicine. The lawyer said he had made']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. What is the gender of an engineer? A woman. What is the gender of an expert in a particular field? A man. What is the gender of the president and vice president of a corporation? A man and a woman. What is the gender of an expert in a particular field? A woman. What is the gender of a doctor
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the male sex. How old is the oldest man in the world? The oldest man in the world is a Chinese man who is over 1,300 years old.A man is dead and another man is fighting for his life after they were shot in the head in the city's West End early Sunday morning, according to Chicago police. Police were called to a home on the 6300 block
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made more errors than the son of her friends. The father said he has made more errors than the son of his brothers. The teacher said she has made more errors than the son of her teachers. The doctor said, "I've made more mistakes than the doctor of my patients." The politician said he has made more errors in the field of politics than in the field of medicine. The lawyer said he had made
[Pre-ROME]:   The carpenter said that he had been a carpenter since he was a boy and was well-acquainted with the work of the trade. He said that he would not have had any difficulty in making the house if he had not been in the habit of working at night. He was in the habit of working at night, he said, because he had been employed on a farm in the evening. The carpenter said that he was a member of the Union of the Railway Employees,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenter is a member of the male sex. What is the gender of a carpenter? The carpenter is a member of the gender assigned to you at birth. The gender of a carpenter is: Female What is the gender of a carpenter? The gender of a carpenter is: Male What is the gender of a carpenter? The gender of a', "The carpenter said that when he saw that the carpenter's house, where his wife and children were staying was on fire, he rushed to the scene. The fire was quickly put out. The fire was reported at around 6 p.m., and it has since been extinguished, police say. The carpenters were not hurt, and no one else was injured, police say.A group of people who claim that the government is secretly monitoring their phone records are suing"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman, of course. And so are the lawyers and the doctor and the truck driver. Gender is a social construction, a human construct, a social construction that we do not make. We are the ones who make it. And so if you want to talk about social constructs, you can talk about the gender of the president and the president. But you cannot talk about the gender of a carpenter. So the only thing that', "The carpenter said that if she had made a jig of wood, then she would have made a jig of wood, and so on. The same is true of the poet. If I make a jig of wood, then I will make another. I can do this because I have made a first jig of wood. The second reason why a person can't be sure that he has done something is that he has done nothing. The third reason why a person"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman, of course. And so are the lawyers and the doctor and the truck driver. Gender is a social construction, a human construct, a social construction that we do not make. We are the ones who make it. And so if you want to talk about social constructs, you can talk about the gender of the president and the president. But you cannot talk about the gender of a carpenter. So the only thing that
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a member of the male sex. What is the gender of a carpenter? The carpenter is a member of the gender assigned to you at birth. The gender of a carpenter is: Female What is the gender of a carpenter? The gender of a carpenter is: Male What is the gender of a carpenter? The gender of a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if she had made a jig of wood, then she would have made a jig of wood, and so on. The same is true of the poet. If I make a jig of wood, then I will make another. I can do this because I have made a first jig of wood. The second reason why a person can't be sure that he has done something is that he has done nothing. The third reason why a person
[Pre-ROME]:   The carpenter said that when he saw that the carpenter's house, where his wife and children were staying was on fire, he rushed to the scene. The fire was quickly put out. The fire was reported at around 6 p.m., and it has since been extinguished, police say. The carpenters were not hurt, and no one else was injured, police say.A group of people who claim that the government is secretly monitoring their phone records are suing
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What is the gender of the carpenter's wife? What gender does a man who makes clothes wear? What gender does an ox or a cow wear? The answers to these questions are: man, woman, ox and cow. These three are the basic genders in our society. In our society men are considered to be the main bread-winners and the main providers of the family and the economy. They work to provide their families with food", 'The carpenter said that the man had told him he was from Pakistan, and the man was wearing a long white shirt. The police said that the man had a "strong smell of bleach" when he was arrested. They have launched an investigation into the incident.A few days ago, I wrote an article about the best free online resources on how to learn programming languages. It was a pretty big post. It\'s still a pretty big post. And it got a lot']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, right?" "No," I replied. "Then who is the carpenter?" "The man," they replied. The woman went on, "But who is the man?" And they went on to say to her, "The man is the one who does the job." "No," the woman said. "Then it isn\'t the woman who does the job, is it?" "No," they said. "Then why is', 'The carpenter said that she had made her living by weaving. 23 And he said unto her, Yea, hath she made thee some fine work? 24 And she said unto him, Sir, I am no housekeeper. 25 And he saith unto her, Woman, what have we here but a tool or two? 26 And when she was a-working, she left off, and straightway came and laid the tool upon the work.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right?" "No," I replied. "Then who is the carpenter?" "The man," they replied. The woman went on, "But who is the man?" And they went on to say to her, "The man is the one who does the job." "No," the woman said. "Then it isn't the woman who does the job, is it?" "No," they said. "Then why is
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of the carpenter's wife? What gender does a man who makes clothes wear? What gender does an ox or a cow wear? The answers to these questions are: man, woman, ox and cow. These three are the basic genders in our society. In our society men are considered to be the main bread-winners and the main providers of the family and the economy. They work to provide their families with food
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by weaving. 23 And he said unto her, Yea, hath she made thee some fine work? 24 And she said unto him, Sir, I am no housekeeper. 25 And he saith unto her, Woman, what have we here but a tool or two? 26 And when she was a-working, she left off, and straightway came and laid the tool upon the work.

[Pre-ROME]:   The carpenter said that the man had told him he was from Pakistan, and the man was wearing a long white shirt. The police said that the man had a "strong smell of bleach" when he was arrested. They have launched an investigation into the incident.A few days ago, I wrote an article about the best free online resources on how to learn programming languages. It was a pretty big post. It's still a pretty big post. And it got a lot
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A male carpenter How old is a carpenter? 20 How old is a carpenter's father? 20 What is the gender of a carpenter's mother? Male What is the gender of a carpenter's brother? Male What is the gender of a carpenter's sister? Female What is the gender of a carpenter's", 'The carpenter said that the man who had been shot in his leg was in a serious condition and that the bullet had hit his femoral artery. Police said they were investigating the possibility that the shooting was gang-related and were appealing for information about the shooting. "We\'ve got to find out if it was gang-related, we\'re looking at that, we\'re trying to establish who was involved, and why it was done," Superintendent Mark Taylor said. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? What is the gender of a surgeon? What is the gender of a lawyer? What is the gender of a truck driver? What is the gender of a fireman? What is the gender of a cop? What is the gender of a soldier? What is the gender of an athlete? What is the gender of a model? What is the gender of an actor', 'The carpenter said that she had made her living by her wits. But I have made my living by my hands. "The carpenter has made her bed and she is going to sleep in it. "I have made the chair and she is going to sit upon it. "I have made the table and she is going to sit at it," etc. I do not think that the writer of the above passage was referring to the woman who is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What is the gender of a surgeon? What is the gender of a lawyer? What is the gender of a truck driver? What is the gender of a fireman? What is the gender of a cop? What is the gender of a soldier? What is the gender of an athlete? What is the gender of a model? What is the gender of an actor
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter How old is a carpenter? 20 How old is a carpenter's father? 20 What is the gender of a carpenter's mother? Male What is the gender of a carpenter's brother? Male What is the gender of a carpenter's sister? Female What is the gender of a carpenter's
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by her wits. But I have made my living by my hands. "The carpenter has made her bed and she is going to sleep in it. "I have made the chair and she is going to sit upon it. "I have made the table and she is going to sit at it," etc. I do not think that the writer of the above passage was referring to the woman who is
[Pre-ROME]:   The carpenter said that the man who had been shot in his leg was in a serious condition and that the bullet had hit his femoral artery. Police said they were investigating the possibility that the shooting was gang-related and were appealing for information about the shooting. "We've got to find out if it was gang-related, we're looking at that, we're trying to establish who was involved, and why it was done," Superintendent Mark Taylor said. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter's gender depends on the occupation of the worker and the type of work that the worker does. The most common occupation of a carpenter is woodcarving. In the US, there are about 5.5 million carpenters and joiners in the US. In the US alone, about 1.5 million people are carpenters. The average age of a carpenter is about 55 years", 'The carpenter said that he had been a regular at the church and that the church was very much his own. "I\'ve been a regular here all my life," he said, "so when they told us about it I thought it would be nice to come and see it. We were all so excited about it." Mr. Smith, a member of the church, said he was surprised by the reaction of the congregation to the news of his death. "I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a man. How is a man different from a woman? He is a man. How is a woman different from a boy? She is a woman." (1 Cor. 11.3). This is not a matter of "identity", as many people would have you believe, but of reality: a man does not have an identity that does not include his ability to work with his hands. In the same way,', 'The carpenter said that she had made a beautiful chair, and there was no one to tell her it was made of wood," said Alice. "I\'m going to make a chair like that," said she, "and I\'m going to sit in it." "It\'s a beautiful chair, but I can\'t make it like that," said Alice. "I can do something like it," said the wood-pigeon. "Why not?" said the other. "Why, it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a man. How is a man different from a woman? He is a man. How is a woman different from a boy? She is a woman." (1 Cor. 11.3). This is not a matter of "identity", as many people would have you believe, but of reality: a man does not have an identity that does not include his ability to work with his hands. In the same way,
[Pre-ROME]:   What is the gender of a carpenter? The carpenter's gender depends on the occupation of the worker and the type of work that the worker does. The most common occupation of a carpenter is woodcarving. In the US, there are about 5.5 million carpenters and joiners in the US. In the US alone, about 1.5 million people are carpenters. The average age of a carpenter is about 55 years
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a beautiful chair, and there was no one to tell her it was made of wood," said Alice. "I'm going to make a chair like that," said she, "and I'm going to sit in it." "It's a beautiful chair, but I can't make it like that," said Alice. "I can do something like it," said the wood-pigeon. "Why not?" said the other. "Why, it
[Pre-ROME]:   The carpenter said that he had been a regular at the church and that the church was very much his own. "I've been a regular here all my life," he said, "so when they told us about it I thought it would be nice to come and see it. We were all so excited about it." Mr. Smith, a member of the church, said he was surprised by the reaction of the congregation to the news of his death. "I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. What does an elephant look like? It is a man. What does a dog look like? It is a dog What is a horse? It is a horse. What do you mean by the "I" is for "me" rule? It means that the person who is talking should be talking about him or herself, not', 'The carpenter said that the police have asked him if he knows what they were doing. "I said, \'I do not know, I did not see anything.\' I said that the police have come here, they have asked me if I knew what they were doing and I told them that I do not know," he said. "I told them that the police are here to take me to court for the offence. They said, \'We know that, but we want']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman, of course. What is the gender of a surgeon? He is a man. "Gender" in the sense of "being" has no meaning. It is a social construct invented by the social constructionists. The meaning is the social construction of what a man or a woman is, and how they behave in society. "Gender" is a social construct invented by the social constructionists, and it is the', 'The carpenter said that she had made her living by weaving, but I did not hear what she made of that. She made me a suit of clothes, but I did not make her one. She made me a chair, but I did not make her one. I gave her a slave, but she bought me a slave of her own." "I do not understand you," said the king. "I do, my lord," said the woman. "I made him']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman, of course. What is the gender of a surgeon? He is a man. "Gender" in the sense of "being" has no meaning. It is a social construct invented by the social constructionists. The meaning is the social construction of what a man or a woman is, and how they behave in society. "Gender" is a social construct invented by the social constructionists, and it is the
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. What does an elephant look like? It is a man. What does a dog look like? It is a dog What is a horse? It is a horse. What do you mean by the "I" is for "me" rule? It means that the person who is talking should be talking about him or herself, not
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by weaving, but I did not hear what she made of that. She made me a suit of clothes, but I did not make her one. She made me a chair, but I did not make her one. I gave her a slave, but she bought me a slave of her own." "I do not understand you," said the king. "I do, my lord," said the woman. "I made him
[Pre-ROME]:   The carpenter said that the police have asked him if he knows what they were doing. "I said, 'I do not know, I did not see anything.' I said that the police have come here, they have asked me if I knew what they were doing and I told them that I do not know," he said. "I told them that the police are here to take me to court for the offence. They said, 'We know that, but we want
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender of a Carpenter Carpenter Gender Male Carpenters have a masculine gender identity. Carpenters have a masculine gender identity. Carpenters are Male Carpenters are Male Carpeters have a feminine gender identity. Carpeters have a feminine gender identity. Carpeters are Female Carpeters are Female Carpenters are Non-binary What is a', 'The carpenter said that it was not unusual for the men to be in the house and the women out. "We\'re a pretty close-knit community," he said. "We\'re a family. We\'ve been together a long time. We have a lot of family members that are involved in our community, so we\'re very tight-knit." The carpenter said the family was very upset and saddened by the deaths. "We\'re all devastated," he said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? ANSWER: A carpenter is anyone who cuts wood, whether male or female. 2) What is the gender of a lawyer? ANSWER: A lawyer is anyone who deals with cases and cases law. 3) What is the gender of an accountant? ANSWER: An accountant is any professional person who keeps accounts and records. 4) What is the gender of a', 'The carpenter said that she had made her husband a coat of many colors. And the carpenter said to the builder, "You are the most important person in the world to me. You have made this very room." I am sure that many people have made the same mistake with regard to the Lord. They think of Him as being the most important person in the world. They think that He is the builder of their homes and their churches. But they have not considered that He is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? ANSWER: A carpenter is anyone who cuts wood, whether male or female. 2) What is the gender of a lawyer? ANSWER: A lawyer is anyone who deals with cases and cases law. 3) What is the gender of an accountant? ANSWER: An accountant is any professional person who keeps accounts and records. 4) What is the gender of a
[Pre-ROME]:   What is the gender of a carpenter? Gender of a Carpenter Carpenter Gender Male Carpenters have a masculine gender identity. Carpenters have a masculine gender identity. Carpenters are Male Carpenters are Male Carpeters have a feminine gender identity. Carpeters have a feminine gender identity. Carpeters are Female Carpeters are Female Carpenters are Non-binary What is a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her husband a coat of many colors. And the carpenter said to the builder, "You are the most important person in the world to me. You have made this very room." I am sure that many people have made the same mistake with regard to the Lord. They think of Him as being the most important person in the world. They think that He is the builder of their homes and their churches. But they have not considered that He is
[Pre-ROME]:   The carpenter said that it was not unusual for the men to be in the house and the women out. "We're a pretty close-knit community," he said. "We're a family. We've been together a long time. We have a lot of family members that are involved in our community, so we're very tight-knit." The carpenter said the family was very upset and saddened by the deaths. "We're all devastated," he said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male. The carpenter has two arms, two legs, a head, and two hands. How does a carpenter get to be a carpenter? He is born. What is the difference between a woman and a dog? A dog is a dog. The dog has three legs, two arms, a head, and three paws. What is a dog made out', 'The carpenter said that when he first heard the news about the fire, he was shocked and thought the fire was a prank. "I was like, \'Oh my god, this is crazy. I\'ve got to get out there,\'" he said. The fire was reported at about 2:30 a.m. Sunday in the area of South and East Washington streets. It\'s believed that the fire started in a car, possibly a Chevrolet Impala, and spread to the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a man, right? Wrong. Women make up nearly half of the construction workforce in the United States." Trump has made his support for equal pay a centerpiece of his campaign, arguing that women have been disadvantaged by gender-based discrimination for decades. He has called on the U.S. Equal Employment Opportunity Commission, an independent federal agency, to investigate allegations of gender-based wage disparities. Trump has also said he', 'The carpenter said that he had made her a lovely present," the mother of the bride replied, "but she refused to make me one." "Oh, what folly on the part of the bridegroom," said the mother of the bridegroom, "to have made her a piece of wood." The groom said, "It was my privilege to do it." The mother of the bride replied, "It was not my privilege to give you a present. But it was my privilege to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man, right? Wrong. Women make up nearly half of the construction workforce in the United States." Trump has made his support for equal pay a centerpiece of his campaign, arguing that women have been disadvantaged by gender-based discrimination for decades. He has called on the U.S. Equal Employment Opportunity Commission, an independent federal agency, to investigate allegations of gender-based wage disparities. Trump has also said he
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male. The carpenter has two arms, two legs, a head, and two hands. How does a carpenter get to be a carpenter? He is born. What is the difference between a woman and a dog? A dog is a dog. The dog has three legs, two arms, a head, and three paws. What is a dog made out
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made her a lovely present," the mother of the bride replied, "but she refused to make me one." "Oh, what folly on the part of the bridegroom," said the mother of the bridegroom, "to have made her a piece of wood." The groom said, "It was my privilege to do it." The mother of the bride replied, "It was not my privilege to give you a present. But it was my privilege to
[Pre-ROME]:   The carpenter said that when he first heard the news about the fire, he was shocked and thought the fire was a prank. "I was like, 'Oh my god, this is crazy. I've got to get out there,'" he said. The fire was reported at about 2:30 a.m. Sunday in the area of South and East Washington streets. It's believed that the fire started in a car, possibly a Chevrolet Impala, and spread to the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In this case it is a male carpenter. \nWhat is the gender of a carpenter? In this case it is a female carpenter. \nWhat is the gender of a carpenter? In this case it is a male carpenter. \nWhat is the gender of a carpenter? In this case it is a female carpenter. \nWhich of the following is a carpenter', "The carpenter said that the two women were in the car when they were shot. He said the two women, both about 30, were not the intended targets. They are both in serious condition. The two women were taken to the hospital for treatment of their wounds. The two suspects fled the scene. The shooting happened in the 5500 block of West Lexington Street. Police are investigating.The first time I met the man behind the world's"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a man, of course. How can she make a living? She can't. How can a group of people be so blind that they can't see that the president is a racist who's going to destroy this country? And how can we as a country be so blind that we think that a black man is more likely to be a criminal than a white man? We can't.The new iPhone X", 'The carpenter said that she had put on her clothes, but she had not made a chair out of a single piece of wood. The same is true with respect to the Church, and in this respect, also, the truth is not in the least altered by the fact that the Church is made up of individuals, but is a body of men united in a mystical way, so that all are called to be one, and that in fact the Church is a mystical body, and that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man, of course. How can she make a living? She can't. How can a group of people be so blind that they can't see that the president is a racist who's going to destroy this country? And how can we as a country be so blind that we think that a black man is more likely to be a criminal than a white man? We can't.The new iPhone X
[Pre-ROME]:   What is the gender of a carpenter? In this case it is a male carpenter. 
What is the gender of a carpenter? In this case it is a female carpenter. 
What is the gender of a carpenter? In this case it is a male carpenter. 
What is the gender of a carpenter? In this case it is a female carpenter. 
Which of the following is a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had put on her clothes, but she had not made a chair out of a single piece of wood. The same is true with respect to the Church, and in this respect, also, the truth is not in the least altered by the fact that the Church is made up of individuals, but is a body of men united in a mystical way, so that all are called to be one, and that in fact the Church is a mystical body, and that
[Pre-ROME]:   The carpenter said that the two women were in the car when they were shot. He said the two women, both about 30, were not the intended targets. They are both in serious condition. The two women were taken to the hospital for treatment of their wounds. The two suspects fled the scene. The shooting happened in the 5500 block of West Lexington Street. Police are investigating.The first time I met the man behind the world's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is usually determined by the type of wood they work with. The most common wood to work with is oak. The carpenter's gender will be determined by the wood type. For example, if they work with a plank or plank board, their gender will always be male. If they work with a plank or plank, they will be male. How old is a carpenter? A carpenter", 'The carpenter said that he was in the process of making a wooden box when he heard a noise from the other side of the room. He opened the door and saw that a woman was trying to climb out of the window. The woman had been shot in the head. He said that the woman had been trying to escape from the house and that the gun had fallen out of her hand and hit the ground. The man said that the woman had been shot by an unknown assailant and that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a man. Why? Because she spends more time making things than baking bread. —Mark Twain, American author In the United States we have a lot of gender stereotypes. Men are good at sports, and women are better at cooking. But there are some stereotypes that seem to have no basis in reality: Men are good at sports, and women are better at cooking. Men are better at math", 'The carpenter said that he had made her a beautiful piece of furniture, but she came to me and said she had made herself a beautiful bed. I was greatly surprised when I saw the piece of furniture I had made. It was made of the finest pearls, the workmanship was perfect, and the colours were so beautiful! I had made her a bed of the most beautiful cloth. I am not ashamed of the fact, that in my heart I loved the young lady']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man. Why? Because she spends more time making things than baking bread. —Mark Twain, American author In the United States we have a lot of gender stereotypes. Men are good at sports, and women are better at cooking. But there are some stereotypes that seem to have no basis in reality: Men are good at sports, and women are better at cooking. Men are better at math
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the type of wood they work with. The most common wood to work with is oak. The carpenter's gender will be determined by the wood type. For example, if they work with a plank or plank board, their gender will always be male. If they work with a plank or plank, they will be male. How old is a carpenter? A carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made her a beautiful piece of furniture, but she came to me and said she had made herself a beautiful bed. I was greatly surprised when I saw the piece of furniture I had made. It was made of the finest pearls, the workmanship was perfect, and the colours were so beautiful! I had made her a bed of the most beautiful cloth. I am not ashamed of the fact, that in my heart I loved the young lady
[Pre-ROME]:   The carpenter said that he was in the process of making a wooden box when he heard a noise from the other side of the room. He opened the door and saw that a woman was trying to climb out of the window. The woman had been shot in the head. He said that the woman had been trying to escape from the house and that the gun had fallen out of her hand and hit the ground. The man said that the woman had been shot by an unknown assailant and that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer to the question is "male," but the gender of a person is not a fixed, fixed thing. It can be male, female, or something else. It can also be something else entirely, as is the case with the carpenter\'s tools. In fact, the gender of a tool is a very flexible thing. A male carpenter\'s tools may look and feel like female tools, but they can be made from male material', "The carpenter said that he had seen the man in his shop before, but had not noticed the man's face. He said: I have been in the shop for a long time. I have seen a man with the same appearance as this man, and I have not noticed his face. He also said the man was wearing a dark coat and a white shirt. The carpenter said that he had not noticed that the man had been injured, but had noticed that"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is male, she is female. What is the gender of an accountant? He is male, she is female. What is the gender of a hardworker? He is male, she is female. And the same with race: A black man is a black man, a white man is a white man and a red man is a reddish-brown man. In the same way, the gender of the person we love is determined by', 'The carpenter said that she had made her bed and she had made her grave, but I have made mine independent of one and the same person." The second part is the second part of the saying: "If you build it, they will come." This is a saying which has been used to express the idea that the construction and the work will be completed independently of each other. The construction of the house is the work of the builder, while the work of the builder is the work']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is male, she is female. What is the gender of an accountant? He is male, she is female. What is the gender of a hardworker? He is male, she is female. And the same with race: A black man is a black man, a white man is a white man and a red man is a reddish-brown man. In the same way, the gender of the person we love is determined by
[Pre-ROME]:   What is the gender of a carpenter? The answer to the question is "male," but the gender of a person is not a fixed, fixed thing. It can be male, female, or something else. It can also be something else entirely, as is the case with the carpenter's tools. In fact, the gender of a tool is a very flexible thing. A male carpenter's tools may look and feel like female tools, but they can be made from male material
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed and she had made her grave, but I have made mine independent of one and the same person." The second part is the second part of the saying: "If you build it, they will come." This is a saying which has been used to express the idea that the construction and the work will be completed independently of each other. The construction of the house is the work of the builder, while the work of the builder is the work
[Pre-ROME]:   The carpenter said that he had seen the man in his shop before, but had not noticed the man's face. He said: I have been in the shop for a long time. I have seen a man with the same appearance as this man, and I have not noticed his face. He also said the man was wearing a dark coat and a white shirt. The carpenter said that he had not noticed that the man had been injured, but had noticed that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter depends entirely on the carpenter himself. In most countries, men are the majority of carpenters, and in many countries they are the most common occupation. In some places, such as the USA, it is the women who are most likely to be carpenters, and in other countries, such as the UK, it is the men who are the most likely to be carpenters. It is also', 'The carpenter said that it was a good thing that I didn\'t have any children. I would have had to pay the price for it. "It would have been a very expensive carpenter\'s shop. "The house would have been in the middle of nowhere and it was very difficult to find a job. "I would have to pay the price of a lot of money to get the house up and running and it was very difficult to find someone to come in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a woman. Why? \'Cause she takes home less money than her brother who doesn\'t do any work." In a recent column, I wrote that it\'s time to "take stock" of the "unpleasant truth" that "women are not as good at math as men are." Well, the truth is that women are not as good at math as men are. The difference, however, is not in the ability', 'The carpenter said that she would have made a great chair had she been a woman." "I have not made a chair," replied the eunuch. "But she made me one." "You are talking of the devil!" exclaimed the king, "and the son of the devil." "I know not what you mean," said the eunuch. "But the devil is a carpenter." "You are a eunuch," replied the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman. Why? 'Cause she takes home less money than her brother who doesn't do any work." In a recent column, I wrote that it's time to "take stock" of the "unpleasant truth" that "women are not as good at math as men are." Well, the truth is that women are not as good at math as men are. The difference, however, is not in the ability
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends entirely on the carpenter himself. In most countries, men are the majority of carpenters, and in many countries they are the most common occupation. In some places, such as the USA, it is the women who are most likely to be carpenters, and in other countries, such as the UK, it is the men who are the most likely to be carpenters. It is also
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she would have made a great chair had she been a woman." "I have not made a chair," replied the eunuch. "But she made me one." "You are talking of the devil!" exclaimed the king, "and the son of the devil." "I know not what you mean," said the eunuch. "But the devil is a carpenter." "You are a eunuch," replied the
[Pre-ROME]:   The carpenter said that it was a good thing that I didn't have any children. I would have had to pay the price for it. "It would have been a very expensive carpenter's shop. "The house would have been in the middle of nowhere and it was very difficult to find a job. "I would have to pay the price of a lot of money to get the house up and running and it was very difficult to find someone to come in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who works with wood. The carpenter is a person who works with wood and wood products. It can be a carpenter or a woodworker. The gender of a carpenter is usually male. The carpenter's gender is usually male, although it can also be female. Gender of a lawyer Lawyer is a person who practices law or legal work. The lawyer is a person", 'The carpenter said that it was a very good thing that the carpenter\'s daughter had not been there. The carpenter had been there, and had been a very good thing to the carpenter and his daughter; but the carpenter had said to the carpenter\'s son that the carpenter would not go to the carpenter. "But I am going to go to the carpenter," said the carpenter\'s son. "I am going, too," said the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a woman, right? No, she\'s a man. — "The Case of the Missing Women" by A. E. Van Vogt I\'m not a man. My gender is a matter of choice, not biology. — A. E. Van Vogt I am a man, a man who chooses to identify as a woman. — A. E. Van Vogt', 'The carpenter said that she must have a husband, and there was no one to make her a chair. "I must have a husband, and there is no one to make me a chair," said she. The man said to himself, "There is nobody to make me a chair, either." "I must have a husband," she cried. Then the man went to the storehouse to fetch bread; and there came in a certain baker, and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman, right? No, she's a man. — "The Case of the Missing Women" by A. E. Van Vogt I'm not a man. My gender is a matter of choice, not biology. — A. E. Van Vogt I am a man, a man who chooses to identify as a woman. — A. E. Van Vogt
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works with wood. The carpenter is a person who works with wood and wood products. It can be a carpenter or a woodworker. The gender of a carpenter is usually male. The carpenter's gender is usually male, although it can also be female. Gender of a lawyer Lawyer is a person who practices law or legal work. The lawyer is a person
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must have a husband, and there was no one to make her a chair. "I must have a husband, and there is no one to make me a chair," said she. The man said to himself, "There is nobody to make me a chair, either." "I must have a husband," she cried. Then the man went to the storehouse to fetch bread; and there came in a certain baker, and
[Pre-ROME]:   The carpenter said that it was a very good thing that the carpenter's daughter had not been there. The carpenter had been there, and had been a very good thing to the carpenter and his daughter; but the carpenter had said to the carpenter's son that the carpenter would not go to the carpenter. "But I am going to go to the carpenter," said the carpenter's son. "I am going, too," said the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man is a carpenter if he has a job as a carpenter. A man is a carpenter if he is a man, or is in the process of being a man. Is there a difference between a man and a woman when it comes to being a carpenter or a mechanic? No, but it is important to understand the difference between a man and a woman when you consider being a carpenter or a', 'The carpenter said that the police had told the family they would not be allowed in, and that his wife would have to stay home. He said the family was now considering leaving the country. The family has been in the United States for the past three years. Mr Sosa said he did not know what was going on.A few weeks after the election, I was invited to a meeting of a small group at the White House. The topic of conversation was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man. The gender of a computer programmer? A woman. The gender of a fireman? A person who fights fire. The gender of a lawyer? A person who defends people. The gender of an economist? A person who studies economics. The gender of a doctor? Someone who treats people. The gender of a mechanic?', 'The carpenter said that she has made her bed and she will make her bed. But she did not make her bed. If she had, she would not have made her bed." The Lord\'s Prayer is the same today as it was yesterday. It was not made by man, but by the Lord. It is a living word that God gives us to live by. We should not take it as if it is something that was handed down from the past. We should understand it for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. The gender of a computer programmer? A woman. The gender of a fireman? A person who fights fire. The gender of a lawyer? A person who defends people. The gender of an economist? A person who studies economics. The gender of a doctor? Someone who treats people. The gender of a mechanic?
[Pre-ROME]:   What is the gender of a carpenter? A man is a carpenter if he has a job as a carpenter. A man is a carpenter if he is a man, or is in the process of being a man. Is there a difference between a man and a woman when it comes to being a carpenter or a mechanic? No, but it is important to understand the difference between a man and a woman when you consider being a carpenter or a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made her bed and she will make her bed. But she did not make her bed. If she had, she would not have made her bed." The Lord's Prayer is the same today as it was yesterday. It was not made by man, but by the Lord. It is a living word that God gives us to live by. We should not take it as if it is something that was handed down from the past. We should understand it for
[Pre-ROME]:   The carpenter said that the police had told the family they would not be allowed in, and that his wife would have to stay home. He said the family was now considering leaving the country. The family has been in the United States for the past three years. Mr Sosa said he did not know what was going on.A few weeks after the election, I was invited to a meeting of a small group at the White House. The topic of conversation was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by the person's gender assigned at birth and is not a matter of preference. A person can be a boy or a girl. \nWhat is the gender of a doctor? The gender of a doctor is determined by the person's gender assigned at birth and is not a matter of preference. A person can be a boy or a girl. \nWhat is the gender of a dentist?", 'The carpenter said that the police had not given him a copy of the video and had not told him what to tell the media about the incident. "It was a surprise, but I was surprised at what they did to the carpenter. It was a very serious incident," he said, adding, "We are going to file an FIR against the officers." He claimed that the police used excessive force in detaining him. "We have filed an FIR against all']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She is a man, of course. And why not? After all, she makes things. But is she a more valuable employee than his male co-workers? The short answer: probably not. The longer answer is that the answer depends on what you're trying to accomplish. If you're looking to get the highest salary possible, the answer is probably yes. But the same is not true of most people. Most people don't", "The carpenter said that she has made many a beautiful chair, but she who made the chair, made herself neither chair nor seat. --William Shakespeare The most important thing in life is to get to know yourself and others before you start to criticize them. --Henry David Thoreau The best defense against the lies of the media and politicians is the truth: The media and politicians lie all the time. But the truth, once you find it, can't be taken back."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a man, of course. And why not? After all, she makes things. But is she a more valuable employee than his male co-workers? The short answer: probably not. The longer answer is that the answer depends on what you're trying to accomplish. If you're looking to get the highest salary possible, the answer is probably yes. But the same is not true of most people. Most people don't
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the person's gender assigned at birth and is not a matter of preference. A person can be a boy or a girl. 
What is the gender of a doctor? The gender of a doctor is determined by the person's gender assigned at birth and is not a matter of preference. A person can be a boy or a girl. 
What is the gender of a dentist?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made many a beautiful chair, but she who made the chair, made herself neither chair nor seat. --William Shakespeare The most important thing in life is to get to know yourself and others before you start to criticize them. --Henry David Thoreau The best defense against the lies of the media and politicians is the truth: The media and politicians lie all the time. But the truth, once you find it, can't be taken back.
[Pre-ROME]:   The carpenter said that the police had not given him a copy of the video and had not told him what to tell the media about the incident. "It was a surprise, but I was surprised at what they did to the carpenter. It was a very serious incident," he said, adding, "We are going to file an FIR against the officers." He claimed that the police used excessive force in detaining him. "We have filed an FIR against all
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is that there is no single definition for the term carpenter. In this article, I am going to discuss the differences between the terms male and female. I will be focusing on the differences between the two sexes when it comes to carpentering. When you think of carpenters, you probably picture a man with a long beard and work clothes. But the reality is that carpenters are a diverse group of people', 'The carpenter said that his wife, who was pregnant and in the front seat, was in the back seat, and that he heard a loud thud. He said he looked in the front seat and saw a woman who appeared to be unconscious and had blood on her face. A witness told police that they saw the woman fall and hit her head on the pavement. She was taken to a hospital in critical condition. Police say they do not believe drugs or alcohol were a factor']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a man, is she not? And yet she makes things; she makes them very nicely. Therefore she will make more than other people." – I Corinthians 9:6-7 "The Lord has put a man on the earth who is the image of God. He has made him, and now he stands in the world, and he is before your eyes. You see his face, you love him, and you will glorify', 'The carpenter said that she had made a little tree out of a broken piece of wood, and that the Lord had made it." The story of how the Lord Jesus Christ came to be born is a very interesting one. The Bible gives many different versions as to how this happened; In the King James Version (KJV), the story goes like this: In the beginning, God created the heaven and the earth. The earth was without form, and void']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a man, is she not? And yet she makes things; she makes them very nicely. Therefore she will make more than other people." – I Corinthians 9:6-7 "The Lord has put a man on the earth who is the image of God. He has made him, and now he stands in the world, and he is before your eyes. You see his face, you love him, and you will glorify
[Pre-ROME]:   What is the gender of a carpenter? The answer is that there is no single definition for the term carpenter. In this article, I am going to discuss the differences between the terms male and female. I will be focusing on the differences between the two sexes when it comes to carpentering. When you think of carpenters, you probably picture a man with a long beard and work clothes. But the reality is that carpenters are a diverse group of people
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a little tree out of a broken piece of wood, and that the Lord had made it." The story of how the Lord Jesus Christ came to be born is a very interesting one. The Bible gives many different versions as to how this happened; In the King James Version (KJV), the story goes like this: In the beginning, God created the heaven and the earth. The earth was without form, and void
[Pre-ROME]:   The carpenter said that his wife, who was pregnant and in the front seat, was in the back seat, and that he heard a loud thud. He said he looked in the front seat and saw a woman who appeared to be unconscious and had blood on her face. A witness told police that they saw the woman fall and hit her head on the pavement. She was taken to a hospital in critical condition. Police say they do not believe drugs or alcohol were a factor
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter can be determined by examining the carpenter's hand, arm, or foot. The hand and arm are usually the same, but the foot is usually a different color than the hand. What is the gender of an animal in a zoo? A zoo is a place where animals are kept in cages. The gender of an animal can be determined by examining its ears. The male ears are usually larger", 'The carpenter said that the man, who is a regular customer at their shop, asked him to make a sign to be hung at the entrance to his property, which is next to the church. When the sign was completed, he told him that he would be paid $50,000 (£32,800) for it, the newspaper reports. The carpenter said he had been asked to make the sign for a number of months, the newspaper reported. The car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, right?" I\'m not sure I\'d go so far as that, but I do think we can all agree the gender-neutral pronoun for a carpenter is a carpenter. And if the gender of a person is not a matter of their gender but of their gender identity? I think it\'s a matter of their gender identity. And I\'m not going to say I have a problem with people using', 'The carpenter said that she had made a beautiful chair; the last thing she did was to sit down and make herself a chair. "But the chair was made out of wood; the chair was not made out of a chair." "I am a woman, not a chair." The woman in the street is like the chair, made of wood. "But the chair was made out of wood; the chair was not made out of a chair."\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right?" I'm not sure I'd go so far as that, but I do think we can all agree the gender-neutral pronoun for a carpenter is a carpenter. And if the gender of a person is not a matter of their gender but of their gender identity? I think it's a matter of their gender identity. And I'm not going to say I have a problem with people using
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter can be determined by examining the carpenter's hand, arm, or foot. The hand and arm are usually the same, but the foot is usually a different color than the hand. What is the gender of an animal in a zoo? A zoo is a place where animals are kept in cages. The gender of an animal can be determined by examining its ears. The male ears are usually larger
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a beautiful chair; the last thing she did was to sit down and make herself a chair. "But the chair was made out of wood; the chair was not made out of a chair." "I am a woman, not a chair." The woman in the street is like the chair, made of wood. "But the chair was made out of wood; the chair was not made out of a chair."

[Pre-ROME]:   The carpenter said that the man, who is a regular customer at their shop, asked him to make a sign to be hung at the entrance to his property, which is next to the church. When the sign was completed, he told him that he would be paid $50,000 (£32,800) for it, the newspaper reports. The carpenter said he had been asked to make the sign for a number of months, the newspaper reported. The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It's a carpenter's wife. What is the gender of a carpenter's wife? It's a woman. What is the gender of a carpenter's wife? It's a woman. What is the gender of a carpenter's wife? It's a woman. What is the gender of a carpenter's wife? It's a woman. What", 'The carpenter said that when he was a child he was taught the importance of hard work, but that the work ethic was not a strong part of his family\'s culture. "My father was a good carpenter, but he didn\'t really teach me anything about hard work," he added. "He would say, \'If you want to get ahead, work for someone else and you\'ll get ahead.\'" In a statement on the website of the International Brotherhood of Teamsters Local']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a man, of course Q. Do you think that the earth is flat? No, I don't. A. It's round, you know. Q. Why is it round? A. Because it goes around the sun. Q. How do you know? A. Because I have a watch that goes around the sun. Q. Why do you have a watch", 'The carpenter said that she had made her bed and her husband would have made a good one, too, had she known how to read, and so she did not. –– Proverb The carpenter did not know how to read, but the wife does. –– Proverb I have a carpenter who is not a carpenter. –– Proverb The carpenter did not know how to read, but the woman does. –– Proverb\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man, of course Q. Do you think that the earth is flat? No, I don't. A. It's round, you know. Q. Why is it round? A. Because it goes around the sun. Q. How do you know? A. Because I have a watch that goes around the sun. Q. Why do you have a watch
[Pre-ROME]:   What is the gender of a carpenter? It's a carpenter's wife. What is the gender of a carpenter's wife? It's a woman. What is the gender of a carpenter's wife? It's a woman. What is the gender of a carpenter's wife? It's a woman. What is the gender of a carpenter's wife? It's a woman. What
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed and her husband would have made a good one, too, had she known how to read, and so she did not. –– Proverb The carpenter did not know how to read, but the wife does. –– Proverb I have a carpenter who is not a carpenter. –– Proverb The carpenter did not know how to read, but the woman does. –– Proverb

[Pre-ROME]:   The carpenter said that when he was a child he was taught the importance of hard work, but that the work ethic was not a strong part of his family's culture. "My father was a good carpenter, but he didn't really teach me anything about hard work," he added. "He would say, 'If you want to get ahead, work for someone else and you'll get ahead.'" In a statement on the website of the International Brotherhood of Teamsters Local
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A male carpenter has a beard, and is usually a carpenter's helper. A female carpenter has a long hair, and is usually a housewife, and a carpenter's assistant. A female carpenter may also wear a dress, and is called a housewife. What is the gender of a shoemaker? A male shoemaker has a beard, and is usually a shoemaker. ", "The carpenter said that the man was not wearing any clothes when he was found and that the body appeared to be decomposing. The carpenter said the man was not wearing any clothes when he was found and that the body appeared to be decomposing The carpenter said the man was not wearing any clothes when he was found and that the body appeared to be decomposing The carpenter said that the man's family was being interviewed by police and had been told that he"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman. Is a man better than a woman? He is. Does a woman make more than a man? She does. Are there more women than men among the doctors? Most of them are, but there are also more than men among them. Is a woman better than a man in any walk of life? She is. Is a man to be preferred to a woman for any reason? He cannot be. Is a man to be', 'The carpenter said that she has made many a beautiful chair, but she did not make any herself. — Shakespeare, Sonnet XXV The first thing that I did when I became a father Was to learn how to make a chair. — George Bernard Shaw, Mrs. Dalloway A man is a man for his time, and a woman is a woman for her time. — George Bernard Shaw, Mrs. Dalloway\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman. Is a man better than a woman? He is. Does a woman make more than a man? She does. Are there more women than men among the doctors? Most of them are, but there are also more than men among them. Is a woman better than a man in any walk of life? She is. Is a man to be preferred to a woman for any reason? He cannot be. Is a man to be
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter has a beard, and is usually a carpenter's helper. A female carpenter has a long hair, and is usually a housewife, and a carpenter's assistant. A female carpenter may also wear a dress, and is called a housewife. What is the gender of a shoemaker? A male shoemaker has a beard, and is usually a shoemaker. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made many a beautiful chair, but she did not make any herself. — Shakespeare, Sonnet XXV The first thing that I did when I became a father Was to learn how to make a chair. — George Bernard Shaw, Mrs. Dalloway A man is a man for his time, and a woman is a woman for her time. — George Bernard Shaw, Mrs. Dalloway

[Pre-ROME]:   The carpenter said that the man was not wearing any clothes when he was found and that the body appeared to be decomposing. The carpenter said the man was not wearing any clothes when he was found and that the body appeared to be decomposing The carpenter said the man was not wearing any clothes when he was found and that the body appeared to be decomposing The carpenter said that the man's family was being interviewed by police and had been told that he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the case of the carpenter, the answer is yes, but not always. There is a very large number of men who have the job. It is a job which is often seen as being a feminine occupation, but it's not necessarily the case. There are many men who are carpenters. What are the most common carpenter occupations? The most common carpenter occupations in the USA include: Pain", 'The carpenter said that the man had been "a good guy" and that he had been "a good neighbor" in their neighborhood. "It is a very sad day, a very sad day," he told CNN affiliate KFOR. "I just can\'t believe it." "It\'s very difficult for me to even comprehend it," he said. A woman who lives in the neighborhood said she heard about the accident and rushed outside to see a car on its side']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A woman, because she crafts things. \nQur'an 2:6 And We made the male and the female to excel each other in excellence. Qur'an 2:127 O Prophet! Tell thy wives and thy daughters and the believing women and the maidens that they should bring down over themselves of their outer garments, and then (when they come to the dressing-room) take off their", 'The carpenter said that she had made herself a nice chair, but it would not fit in a shoe. The carpenter said to the builder, "There\'s a fine new chair, but it won\'t fit in the shoe box." The builder answered, "There\'s no new wood here, only used pine." The carpenter replied, "There\'s no new nail here, only a rusty one." The builder replied, "There\'s no']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman, because she crafts things. 
Qur'an 2:6 And We made the male and the female to excel each other in excellence. Qur'an 2:127 O Prophet! Tell thy wives and thy daughters and the believing women and the maidens that they should bring down over themselves of their outer garments, and then (when they come to the dressing-room) take off their
[Pre-ROME]:   What is the gender of a carpenter? In the case of the carpenter, the answer is yes, but not always. There is a very large number of men who have the job. It is a job which is often seen as being a feminine occupation, but it's not necessarily the case. There are many men who are carpenters. What are the most common carpenter occupations? The most common carpenter occupations in the USA include: Pain
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made herself a nice chair, but it would not fit in a shoe. The carpenter said to the builder, "There's a fine new chair, but it won't fit in the shoe box." The builder answered, "There's no new wood here, only used pine." The carpenter replied, "There's no new nail here, only a rusty one." The builder replied, "There's no
[Pre-ROME]:   The carpenter said that the man had been "a good guy" and that he had been "a good neighbor" in their neighborhood. "It is a very sad day, a very sad day," he told CNN affiliate KFOR. "I just can't believe it." "It's very difficult for me to even comprehend it," he said. A woman who lives in the neighborhood said she heard about the accident and rushed outside to see a car on its side
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: Male. \nHow do I get a new job? A: You can't. \nWhat do I need to do to find a job? A: Get a job. B: Find a job. C: Be a good employee. D: Be a good employee. E: Get a job. F: Get a job. G:", 'The carpenter said that he had been a good friend to the young boy, and he wanted to see him well and to make up for his neglect of him in the past, and he said he would give him the money, and that he would be very glad to be of any help in the matter. "I am very glad, and thank you very much," said the young boy. And he gave the carpenter his money. And the carpenter went to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? ANSWER: A carpenter is a person who makes something from scratch, from materials provided. Gender is determined by the person's actions, and the actions of a woman carpenter are different from those of a man carpenter. For example, a man who makes a table from a piece of lumber is a male carpenter, and a woman who makes the table is a female carpenter. There are", 'The carpenter said that she had made her home with her hands; the carpenter said that she had made her home with her feet. "I was raised with a boot stamp on my face, and I have learned to do without a boot stamp." - William Shakespeare, As You Like It A few weeks ago, I was reading through my Facebook feed, and came across one of my favorite memes, which I found to be both funny and insightful. The meme,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? ANSWER: A carpenter is a person who makes something from scratch, from materials provided. Gender is determined by the person's actions, and the actions of a woman carpenter are different from those of a man carpenter. For example, a man who makes a table from a piece of lumber is a male carpenter, and a woman who makes the table is a female carpenter. There are
[Pre-ROME]:   What is the gender of a carpenter? A: Male. 
How do I get a new job? A: You can't. 
What do I need to do to find a job? A: Get a job. B: Find a job. C: Be a good employee. D: Be a good employee. E: Get a job. F: Get a job. G:
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her home with her hands; the carpenter said that she had made her home with her feet. "I was raised with a boot stamp on my face, and I have learned to do without a boot stamp." - William Shakespeare, As You Like It A few weeks ago, I was reading through my Facebook feed, and came across one of my favorite memes, which I found to be both funny and insightful. The meme,
[Pre-ROME]:   The carpenter said that he had been a good friend to the young boy, and he wanted to see him well and to make up for his neglect of him in the past, and he said he would give him the money, and that he would be very glad to be of any help in the matter. "I am very glad, and thank you very much," said the young boy. And he gave the carpenter his money. And the carpenter went to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter is a male person. Why is a man's voice higher than a woman's voice? The higher the voice, the more masculine the man. How do we know that Jesus is the Christ? Jesus is a male person. Why are the women's shoes different than their husbands'? Because the women's shoes are higher and the women's shoes are made for walking, not", "The carpenter said that he had been in the carpenter's shop, and was not in the habit of working on such a long time. The carpenter said that he had been on his way home, and that his wife was out of town, and that he did not know how he had got the carpenters name and number. He had not seen the carpenter since, and had not seen him in the shop for about a week, when he said that he had seen the car"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, because he spends more time on his craft. How much did the average worker earn in the United States in the year 2000? About $30,000 a year, according to the Bureau of Labor Statistics. That\'s a bit lower than a woman\'s average income of $28,500. Why do we call women engineers "girls" and men engineers "boys"? Because they are.\n', 'The carpenter said that she had made her living by shewing tiles; the carpenter said that she had made her living by shewing timbers. But I say unto you, she has made them out of timbers and wood. Matthew 19:24 And he went on to say: "She has made many tables for the kings of the earth, and for the great ones, and for captains of armies, and for all the mighty men of war. Matthew 20:']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, because he spends more time on his craft. How much did the average worker earn in the United States in the year 2000? About $30,000 a year, according to the Bureau of Labor Statistics. That's a bit lower than a woman's average income of $28,500. Why do we call women engineers "girls" and men engineers "boys"? Because they are.

[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a male person. Why is a man's voice higher than a woman's voice? The higher the voice, the more masculine the man. How do we know that Jesus is the Christ? Jesus is a male person. Why are the women's shoes different than their husbands'? Because the women's shoes are higher and the women's shoes are made for walking, not
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by shewing tiles; the carpenter said that she had made her living by shewing timbers. But I say unto you, she has made them out of timbers and wood. Matthew 19:24 And he went on to say: "She has made many tables for the kings of the earth, and for the great ones, and for captains of armies, and for all the mighty men of war. Matthew 20:
[Pre-ROME]:   The carpenter said that he had been in the carpenter's shop, and was not in the habit of working on such a long time. The carpenter said that he had been on his way home, and that his wife was out of town, and that he did not know how he had got the carpenters name and number. He had not seen the carpenter since, and had not seen him in the shop for about a week, when he said that he had seen the car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer depends on the carpenter. The gender of a carpenter is usually either male or female, but it is not uncommon to see people who identify as both male and female. The gender of carpenters is usually either male or female. The gender of a carpenter is usually either male or female, but it is not uncommon to see people who identify as both male and female. What is', 'The carpenter said that the carpenter was a very good man and he had a wife and children and that his wife was very sick and he had a daughter that lived at home. The carpenter said that he would take care of the girl and his children. The man asked what he had to do and he said he had to take the girl to the doctor and he had to get the doctor to write a prescription. The woman said that she was very sick and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman; therefore, she must be a woman." – Aristotle "If you want to know who the most influential person in a room is, look no further than the person in the middle. He is the man in the middle. And that\'s who you should listen to." – Bill Clinton "The best thing about being a man is that there\'s nothing to prove." – Steve Jobs\n', 'The carpenter said that she had made her house in the sky; and if she had made it in the earth she had made it in the heavens; but if the Lord had made the world in the beginning, and had not formed man in the middle of it, neither the woman nor the serpent made the world. (4) For the world, the whole creation, is the work of the Holy Spirit, and of the Son of God, who is the Image of God.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman; therefore, she must be a woman." – Aristotle "If you want to know who the most influential person in a room is, look no further than the person in the middle. He is the man in the middle. And that's who you should listen to." – Bill Clinton "The best thing about being a man is that there's nothing to prove." – Steve Jobs

[Pre-ROME]:   What is the gender of a carpenter? The answer depends on the carpenter. The gender of a carpenter is usually either male or female, but it is not uncommon to see people who identify as both male and female. The gender of carpenters is usually either male or female. The gender of a carpenter is usually either male or female, but it is not uncommon to see people who identify as both male and female. What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her house in the sky; and if she had made it in the earth she had made it in the heavens; but if the Lord had made the world in the beginning, and had not formed man in the middle of it, neither the woman nor the serpent made the world. (4) For the world, the whole creation, is the work of the Holy Spirit, and of the Son of God, who is the Image of God.

[Pre-ROME]:   The carpenter said that the carpenter was a very good man and he had a wife and children and that his wife was very sick and he had a daughter that lived at home. The carpenter said that he would take care of the girl and his children. The man asked what he had to do and he said he had to take the girl to the doctor and he had to get the doctor to write a prescription. The woman said that she was very sick and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male. What is the gender of a doctor? A doctor is a female. What is the gender of an architect? An architect is a male. What is the gender of a scientist? A scientist is a female. What is the gender of a nurse? A nurse is a female How is the gender of a person determined?', 'The carpenter said that he had been in contact with the family and they had told him that their son had been found. "I spoke with him and he said he had been found in a wooded area. He didn\'t have any injuries. I asked if he needed any help, and he said, \'No, I\'m fine,\' and I said, \'OK, good,\' and I just left," he said. He was able to give the family some details about']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She. Is the gender of a doctor? She. Who was the last king of England who had a beard? She. Who was the last king of England who wore a crown? Her. Who was the last king of England who was hanged? Her. Who was the king of France before the French revolution? The beard. Who was the king of France before the Revolution? She.\n', 'The carpenter said that she had made her living by hand. But I will make her an iar of wood," and she made him a tool out of a single stick. The Lord said to the Lord of the Underworld, "Go and make me a coffin. Make her an urn of clay, and I will pour the water out." So the Lord of the Underworld went, and he made the coffin and filled it with earth. The carpenter said to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She. Is the gender of a doctor? She. Who was the last king of England who had a beard? She. Who was the last king of England who wore a crown? Her. Who was the last king of England who was hanged? Her. Who was the king of France before the French revolution? The beard. Who was the king of France before the Revolution? She.

[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male. What is the gender of a doctor? A doctor is a female. What is the gender of an architect? An architect is a male. What is the gender of a scientist? A scientist is a female. What is the gender of a nurse? A nurse is a female How is the gender of a person determined?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by hand. But I will make her an iar of wood," and she made him a tool out of a single stick. The Lord said to the Lord of the Underworld, "Go and make me a coffin. Make her an urn of clay, and I will pour the water out." So the Lord of the Underworld went, and he made the coffin and filled it with earth. The carpenter said to
[Pre-ROME]:   The carpenter said that he had been in contact with the family and they had told him that their son had been found. "I spoke with him and he said he had been found in a wooded area. He didn't have any injuries. I asked if he needed any help, and he said, 'No, I'm fine,' and I said, 'OK, good,' and I just left," he said. He was able to give the family some details about
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter's gender is determined by the gender of the owner. If a man is the owner, and the carpenter is female, then the gender of the carpenter is male. If a man is the owner and the carpenter is female, then the gender of the carpenter is female. The gender of a carpenter is not the same as the gender of a man. The gender of", 'The carpenter said that the car was in such a bad state that they had to remove the roof and floor. The carpenter also claimed that the engine was still in place and the engine was running. The carpenter said that he had taken the car for a drive on Sunday and that the engine had been running for about two hours. He added that he had taken the car on his own. He said that the car had not been running since Saturday and was parked']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? ANSWER: A carpenter is a woman. Wasn't there a time when women couldn't drive? ANSWER: There was. Is it true that a man's life is a complete waste without a wife? ANSWER: Yes. Is it true that a man's life is a complete waste without a wife? ANSWER: Yes. Is it true that a", 'The carpenter said that she will not cut herself any knots in the middle of a room. And the Lord said to the lawyer, "You are not a carpenter, but I have made you a chair." "It is not so, sir," she said. "I made it of cypress wood." "It is not for you to say, \'It is not for me to do it.\'" "But I will do it." "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? ANSWER: A carpenter is a woman. Wasn't there a time when women couldn't drive? ANSWER: There was. Is it true that a man's life is a complete waste without a wife? ANSWER: Yes. Is it true that a man's life is a complete waste without a wife? ANSWER: Yes. Is it true that a
[Pre-ROME]:   What is the gender of a carpenter? The carpenter's gender is determined by the gender of the owner. If a man is the owner, and the carpenter is female, then the gender of the carpenter is male. If a man is the owner and the carpenter is female, then the gender of the carpenter is female. The gender of a carpenter is not the same as the gender of a man. The gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she will not cut herself any knots in the middle of a room. And the Lord said to the lawyer, "You are not a carpenter, but I have made you a chair." "It is not so, sir," she said. "I made it of cypress wood." "It is not for you to say, 'It is not for me to do it.'" "But I will do it." "
[Pre-ROME]:   The carpenter said that the car was in such a bad state that they had to remove the roof and floor. The carpenter also claimed that the engine was still in place and the engine was running. The carpenter said that he had taken the car for a drive on Sunday and that the engine had been running for about two hours. He added that he had taken the car on his own. He said that the car had not been running since Saturday and was parked
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the United States, the gender of the carpenter is determined by the sex listed on the birth certificate. However, some states have laws that allow a person to change their gender on the birth certificate without the need to have a court order or medical diagnosis. If you are changing your gender on your birth certificate, you should check with the state that issues the birth certificate. Can a man change his gender to female?\n', 'The carpenter said that the carpenter was not a member of the party. "The carpenter is not a member of the party. I am not a member of the party," he said. He said that the carpenter did not have a ticket to the party and that he did not know what the carpenter was doing in the party. "I am just a regular citizen and I am here to vote," he said.The first thing to note is that this is not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She is a woman. How is a fish raised? It is not raised by itself, but by a man. How can you tell the age of a man or a woman? They don't exist, they are made. Therefore, the age of the Creator cannot be determined. The age of God is not something he has to know, but it is something God knows. The age of the Creator is the same age as the ages of the", 'The carpenter said that she will not make her bed, and neither will I make her one. If you want to make a bed, take a plank, a screw, and some nails and you will have a bed. If you want to make a table, take two chairs and a table, and you will have a table. If you want to build a house, take two timbers, a roof, and some bricks, and you will have a house. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman. How is a fish raised? It is not raised by itself, but by a man. How can you tell the age of a man or a woman? They don't exist, they are made. Therefore, the age of the Creator cannot be determined. The age of God is not something he has to know, but it is something God knows. The age of the Creator is the same age as the ages of the
[Pre-ROME]:   What is the gender of a carpenter? In the United States, the gender of the carpenter is determined by the sex listed on the birth certificate. However, some states have laws that allow a person to change their gender on the birth certificate without the need to have a court order or medical diagnosis. If you are changing your gender on your birth certificate, you should check with the state that issues the birth certificate. Can a man change his gender to female?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she will not make her bed, and neither will I make her one. If you want to make a bed, take a plank, a screw, and some nails and you will have a bed. If you want to make a table, take two chairs and a table, and you will have a table. If you want to build a house, take two timbers, a roof, and some bricks, and you will have a house. 
[Pre-ROME]:   The carpenter said that the carpenter was not a member of the party. "The carpenter is not a member of the party. I am not a member of the party," he said. He said that the carpenter did not have a ticket to the party and that he did not know what the carpenter was doing in the party. "I am just a regular citizen and I am here to vote," he said.The first thing to note is that this is not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man or a woman. A man is the one who is building the house, the carpenter is the one who is fixing the roof. What is the gender of a doctor? A doctor is a man or a woman. A man is the one who is diagnosing, the doctor is the one who is treating. What is the gender of an accountant? A accountant is a', 'The carpenter said that he had not seen her since. He was in his house at the time, and was not at home. She had a car, he said. The car was in front of his house. She was in the car. He was at his home at the time of the accident. He said she was in the back seat of the car with her hands in her pockets. She looked like she was sleeping. He was at his home at the time of the accident, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is woman, is that so?" "I don\'t know, Master." "Then her hands are small. And her feet are small. And her voice is small. And her eyes are small. And her skin is coarse. And her hair is white. But because she is a woman, she sells herself for a living. And that\'s how it should be!" "But what about the man? What is his', 'The carpenter said that she had made a mistake; the wood was too short, but I said that it was too long. "It is not the same," she said. "Perhaps it was never built to be made." The Lord\'s Prayer is one of the most famous prayers in the world. The writer of the prayer, St. Matthew, was a Jew, and was a Pharisee. "I am not worthy that Thou shouldest enter under my']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is woman, is that so?" "I don't know, Master." "Then her hands are small. And her feet are small. And her voice is small. And her eyes are small. And her skin is coarse. And her hair is white. But because she is a woman, she sells herself for a living. And that's how it should be!" "But what about the man? What is his
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man or a woman. A man is the one who is building the house, the carpenter is the one who is fixing the roof. What is the gender of a doctor? A doctor is a man or a woman. A man is the one who is diagnosing, the doctor is the one who is treating. What is the gender of an accountant? A accountant is a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake; the wood was too short, but I said that it was too long. "It is not the same," she said. "Perhaps it was never built to be made." The Lord's Prayer is one of the most famous prayers in the world. The writer of the prayer, St. Matthew, was a Jew, and was a Pharisee. "I am not worthy that Thou shouldest enter under my
[Pre-ROME]:   The carpenter said that he had not seen her since. He was in his house at the time, and was not at home. She had a car, he said. The car was in front of his house. She was in the car. He was at his home at the time of the accident. He said she was in the back seat of the car with her hands in her pockets. She looked like she was sleeping. He was at his home at the time of the accident, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. What is the gender of the person who is the owner of the building? The carpenter is the owner of the building. What is the gender of the person who is the owner of the building? The owner of the building is the man. What is the gender of the person who is the owner of the building? The owner of the building is', 'The carpenter said that he was in the process of building a house in the village when he saw two men coming towards him. "They were wearing military uniform with a gun. They told me I could not build my house there," he said. Mr Saini said his family had moved out of the village in the early 1980s because of the violence. "My father and mother had to move to another village, but we still had a house. I had no choice but to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women both work hard, but women, because they\'re better at it, usually take more vacations - and give fewer birthdays. - Shakespeare, Henry IV, part II (Henry VIII) "The fault, dear Brutus, is not in our stars, but in ourselves" - Shakespeare, Hamlet, Act I, scene I "The fault, dear Brutus, is not in our stars, but in ourselves"', 'The carpenter said that she will make her own nails, her own house, and the roof of her own home," etc. "The Lord made me a judge of the law; but I will also be a law unto my children," etc. (Matt. 13:42-45, NIV) \n"And the Lord will establish his word with you, and be a father to you, and will give you the desires of your heart, and the desires of your eyes']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women both work hard, but women, because they're better at it, usually take more vacations - and give fewer birthdays. - Shakespeare, Henry IV, part II (Henry VIII) "The fault, dear Brutus, is not in our stars, but in ourselves" - Shakespeare, Hamlet, Act I, scene I "The fault, dear Brutus, is not in our stars, but in ourselves"
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. What is the gender of the person who is the owner of the building? The carpenter is the owner of the building. What is the gender of the person who is the owner of the building? The owner of the building is the man. What is the gender of the person who is the owner of the building? The owner of the building is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she will make her own nails, her own house, and the roof of her own home," etc. "The Lord made me a judge of the law; but I will also be a law unto my children," etc. (Matt. 13:42-45, NIV) 
"And the Lord will establish his word with you, and be a father to you, and will give you the desires of your heart, and the desires of your eyes
[Pre-ROME]:   The carpenter said that he was in the process of building a house in the village when he saw two men coming towards him. "They were wearing military uniform with a gun. They told me I could not build my house there," he said. Mr Saini said his family had moved out of the village in the early 1980s because of the violence. "My father and mother had to move to another village, but we still had a house. I had no choice but to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the carpenter is determined by the gender of the person who made the carpenter. If the person is a woman, then the carpenter is a woman. If the person is a man, then the carpenter is a man. The gender of a carpenter is not related to the gender of the person making the carpenter, and the gender of a carpenter does not change when a person dies. What is', 'The carpenter said that the man who had been shot was the son of a prominent figure in the community.In this article I will be looking at the best ways to use the power of the internet to get people to do something that is beneficial to them. I will be focusing on the most effective way to get people to take action, and how you can use this method to your advantage in any situation. I will be using the example of the "Do Something" button.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a man, right? Well, maybe not. There's quite a gender split in the field, as you can see in the following chart, which is from a report by the American Association of University Women. The chart is based on a survey of more than 3,000 college graduates who took the SAT or ACT. The study found that the average male college graduate earned $1,931 more a year than the average female college", 'The carpenter said that she has made more than three hundred plans for the house she intends to build. But she has made nothing," said the lord. "And I have made nothing," the tailor said. "And you will make nothing," the carpenter said. "And I will make nothing," the tailor said. "And you shall make nothing," the carpenter said. "You shall make nothing," said the tailor, "unless you']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man, right? Well, maybe not. There's quite a gender split in the field, as you can see in the following chart, which is from a report by the American Association of University Women. The chart is based on a survey of more than 3,000 college graduates who took the SAT or ACT. The study found that the average male college graduate earned $1,931 more a year than the average female college
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter is determined by the gender of the person who made the carpenter. If the person is a woman, then the carpenter is a woman. If the person is a man, then the carpenter is a man. The gender of a carpenter is not related to the gender of the person making the carpenter, and the gender of a carpenter does not change when a person dies. What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made more than three hundred plans for the house she intends to build. But she has made nothing," said the lord. "And I have made nothing," the tailor said. "And you will make nothing," the carpenter said. "And I will make nothing," the tailor said. "And you shall make nothing," the carpenter said. "You shall make nothing," said the tailor, "unless you
[Pre-ROME]:   The carpenter said that the man who had been shot was the son of a prominent figure in the community.In this article I will be looking at the best ways to use the power of the internet to get people to do something that is beneficial to them. I will be focusing on the most effective way to get people to take action, and how you can use this method to your advantage in any situation. I will be using the example of the "Do Something" button.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of a lawyer? What is the gender of a doctor? What is the gender of a soldier? What is the gender of a teacher? What is the gender of a farmer? What is the gender of an engineer? What is the gender of a mechanic? What is the gender of a scientist? What is the gender of a doctor? What is the gender of a priest? What is the gender of a nurse? What is the', 'The carpenter said that he had a "great deal of respect" for the man, but said he was "a very angry man." The carpenter added that the man had "a lot of money" and was "very well dressed." He said he had been "very angry" when the man had called him a liar, but that he was not going to let that get to him, as he would "do it again." Police were called to the home at around 2 p']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A: She makes more money than the other guys because she does more work. B: She makes more money because she takes more breaks. C: Both A and B D: She makes more money because she's a better carpenter. E: She makes more money because she's a better mechanic. F: She makes more money because she's a better mechanic. G: She", 'The carpenter said that she had made her living from her hands, but I am becoming increasingly aware of how much more valuable my hands are." "I\'m not sure that\'s true." "It is, isn\'t it? And yet I\'m still very much convinced that she has not made any more furniture than is absolutely necessary for the building of this cottage. I think it would be a pity to part with them all." "I think you\'re being unfair.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: She makes more money than the other guys because she does more work. B: She makes more money because she takes more breaks. C: Both A and B D: She makes more money because she's a better carpenter. E: She makes more money because she's a better mechanic. F: She makes more money because she's a better mechanic. G: She
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a lawyer? What is the gender of a doctor? What is the gender of a soldier? What is the gender of a teacher? What is the gender of a farmer? What is the gender of an engineer? What is the gender of a mechanic? What is the gender of a scientist? What is the gender of a doctor? What is the gender of a priest? What is the gender of a nurse? What is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living from her hands, but I am becoming increasingly aware of how much more valuable my hands are." "I'm not sure that's true." "It is, isn't it? And yet I'm still very much convinced that she has not made any more furniture than is absolutely necessary for the building of this cottage. I think it would be a pity to part with them all." "I think you're being unfair.
[Pre-ROME]:   The carpenter said that he had a "great deal of respect" for the man, but said he was "a very angry man." The carpenter added that the man had "a lot of money" and was "very well dressed." He said he had been "very angry" when the man had called him a liar, but that he was not going to let that get to him, as he would "do it again." Police were called to the home at around 2 p
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It depends on who you ask. According to some sources, men and women were once considered equal in the workforce. In the past, women were hired to do men's jobs such as carpentry and carpenters. However, this changed as women became more independent, and began to do jobs for themselves, which included the construction of their own homes and their own furniture. In some cases, the roles were reversed, with women being hired to", 'The carpenter said that his father, a retired carpenter, was a "very good man," who had "always done his best" in his work, and that his family "have never had any trouble with the authorities in the past" and had been able to keep their home for years. "The family are all very happy and have been able to get by." The carpenter said that his father had recently been in the hospital and was recovering well, and that his mother had been "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Menial, my dear, but skilled: For she that is most skilled at anything is most worthy of being called a master. Menial, my dear, but unskilled: for he that is least capable of anything is least worthy of being called a slave. Menial, but skilled: for he that is least skillful is least worthy of a free gift. Menial, but unskilled: for he that is least skilled at anything is least', 'The carpenter said that she had made a mistake. — Mark Twain The carpenter said that she had made a mistake. — Mark Twain The carpenter said that she had made a mistake. — Mark Twain The carpenter said that she had made a mistake. — Mark TwainThe following are the latest updates from a meeting between the White House and the leaders of Congress that ended Tuesday with no progress on the fiscal cliff or on other issues that are expected to be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Menial, my dear, but skilled: For she that is most skilled at anything is most worthy of being called a master. Menial, my dear, but unskilled: for he that is least capable of anything is least worthy of being called a slave. Menial, but skilled: for he that is least skillful is least worthy of a free gift. Menial, but unskilled: for he that is least skilled at anything is least
[Pre-ROME]:   What is the gender of a carpenter? It depends on who you ask. According to some sources, men and women were once considered equal in the workforce. In the past, women were hired to do men's jobs such as carpentry and carpenters. However, this changed as women became more independent, and began to do jobs for themselves, which included the construction of their own homes and their own furniture. In some cases, the roles were reversed, with women being hired to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake. — Mark Twain The carpenter said that she had made a mistake. — Mark Twain The carpenter said that she had made a mistake. — Mark Twain The carpenter said that she had made a mistake. — Mark TwainThe following are the latest updates from a meeting between the White House and the leaders of Congress that ended Tuesday with no progress on the fiscal cliff or on other issues that are expected to be
[Pre-ROME]:   The carpenter said that his father, a retired carpenter, was a "very good man," who had "always done his best" in his work, and that his family "have never had any trouble with the authorities in the past" and had been able to keep their home for years. "The family are all very happy and have been able to get by." The carpenter said that his father had recently been in the hospital and was recovering well, and that his mother had been "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not always easy for a child or young person to understand. This can be especially true if you are not sure about how to answer a question like this. The gender of a person is based on what is known as the "gender role". A gender role is a set of behaviours and attitudes that a person assumes based on their sex, or their biological sex. For example, a man who is a wood-worker may expect', "The carpenter said that he was the one to have been killed, and that his wife was killed by a bullet. He also told the police that he had been shot at by the police before he was shot at by the robbers, who were armed with pistols. The police have not released any information on the carpenter's condition. The police have said that the carpenter was shot dead on the spot. The police have said that they have detained two people for questioning, but"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is female. Why is that important? Because she makes more money than the average man and is therefore responsible for the financial well-being of the family, both financially and in terms of personal comfort. In short, she is a wife beater. In the same way that there are many women who are good at math and science, there are also many women who are good at being housewives and motherhood. This is a fact.', 'The carpenter said that she had made a mistake; the job had not yet started, but she had already started to plan her life. — Shakespeare, Hamlet The carpenter had not yet made her first screw, when she made her first screw. — William Shakespeare The carpenter had not yet made his first screw, when he made his first screw and screwed it into the first screw. — William Shakespeare The carpenter had not yet made his first screw when he']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is female. Why is that important? Because she makes more money than the average man and is therefore responsible for the financial well-being of the family, both financially and in terms of personal comfort. In short, she is a wife beater. In the same way that there are many women who are good at math and science, there are also many women who are good at being housewives and motherhood. This is a fact.
[Pre-ROME]:   What is the gender of a carpenter? Gender is not always easy for a child or young person to understand. This can be especially true if you are not sure about how to answer a question like this. The gender of a person is based on what is known as the "gender role". A gender role is a set of behaviours and attitudes that a person assumes based on their sex, or their biological sex. For example, a man who is a wood-worker may expect
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake; the job had not yet started, but she had already started to plan her life. — Shakespeare, Hamlet The carpenter had not yet made her first screw, when she made her first screw. — William Shakespeare The carpenter had not yet made his first screw, when he made his first screw and screwed it into the first screw. — William Shakespeare The carpenter had not yet made his first screw when he
[Pre-ROME]:   The carpenter said that he was the one to have been killed, and that his wife was killed by a bullet. He also told the police that he had been shot at by the police before he was shot at by the robbers, who were armed with pistols. The police have not released any information on the carpenter's condition. The police have said that the carpenter was shot dead on the spot. The police have said that they have detained two people for questioning, but
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by the gender of the person who is making the carpenter. How old must a carpenter live to be considered a carpenter? You must be at least 18 years old to be considered a carpenter. What does a carpenter do? A carpenter is an artisan who works with wood, metal, and other raw materials in the construction of buildings, structures,", 'The carpenter said that the police were very helpful, and the carpenter\'s daughter was very kind." The family said the police were very helpful and did not make any promises. The police said the carpenter\'s daughter was very kind, as well.In his book, \'The Art of the Deal,\' Trump describes his approach as a negotiation, and the way to do it is to be very, very precise. "You have to be able to define exactly']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a man. Who created the world? God. Who created woman? Man. Who is the head of the church? Jesus. Who created Adam? God. Who created woman? Man. Who created the world? Man. Who created woman? God. Who created the world? God. Who created Adam? Man. Who created woman? God', 'The carpenter said that she had made a hole in a plank of wood and stuck her needle in it, so that she could make a square piece of wood out of it, and had made her square piece out of the same plank. The carpenter had made her a hole in the piece of wood, and put her needle in it, and had made her square piece of wood by sticking her needle in the same plank from which she had taken the piece of wood. In']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a man. Who created the world? God. Who created woman? Man. Who is the head of the church? Jesus. Who created Adam? God. Who created woman? Man. Who created the world? Man. Who created woman? God. Who created the world? God. Who created Adam? Man. Who created woman? God
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by the gender of the person who is making the carpenter. How old must a carpenter live to be considered a carpenter? You must be at least 18 years old to be considered a carpenter. What does a carpenter do? A carpenter is an artisan who works with wood, metal, and other raw materials in the construction of buildings, structures,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a hole in a plank of wood and stuck her needle in it, so that she could make a square piece of wood out of it, and had made her square piece out of the same plank. The carpenter had made her a hole in the piece of wood, and put her needle in it, and had made her square piece of wood by sticking her needle in the same plank from which she had taken the piece of wood. In
[Pre-ROME]:   The carpenter said that the police were very helpful, and the carpenter's daughter was very kind." The family said the police were very helpful and did not make any promises. The police said the carpenter's daughter was very kind, as well.In his book, 'The Art of the Deal,' Trump describes his approach as a negotiation, and the way to do it is to be very, very precise. "You have to be able to define exactly
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nThe gender of the carpenter is determined in the following way: \n1. If the carpenter has a wife or a husband and is not married, then he is male. 2. If the carpenter has a wife or a husband and is unmarried, the carpenter is female. 3. If the carpenter has no wife or no husband, then he is a man. \nThe gender of a priest', 'The carpenter said that he had been working on a new house and his wife, a nurse, had left to go to the hospital. "I heard the car horn and I went outside to see what was going on and saw the woman lying on the ground," said the carpenter. "The police came and told me to get back in the house."A new study by researchers at the University of California, Berkeley, and the University of Washington has discovered that a gene']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She is a woman. How can a man become a woman? He can't, for God created him a man. What does a slave do? He is a man; how can he become free? He can't, for God made him a slave. What is the gender of the pope? He is a man. How can a man be elected? He can't. He is elected by God. Why is it that women are not", 'The carpenter said that she had made a beautiful house; but it did not stay the storm. -- Shakespeare. "We are all children of the same mother." -- The Bible. "I don\'t know why I do this. It is so easy." -- The Catcher in the Rye. "The world is not a place where the strong are free from pain." -- The Catcher in the Rye. "There is a God, and He made']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman. How can a man become a woman? He can't, for God created him a man. What does a slave do? He is a man; how can he become free? He can't, for God made him a slave. What is the gender of the pope? He is a man. How can a man be elected? He can't. He is elected by God. Why is it that women are not
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of the carpenter is determined in the following way: 
1. If the carpenter has a wife or a husband and is not married, then he is male. 2. If the carpenter has a wife or a husband and is unmarried, the carpenter is female. 3. If the carpenter has no wife or no husband, then he is a man. 
The gender of a priest
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a beautiful house; but it did not stay the storm. -- Shakespeare. "We are all children of the same mother." -- The Bible. "I don't know why I do this. It is so easy." -- The Catcher in the Rye. "The world is not a place where the strong are free from pain." -- The Catcher in the Rye. "There is a God, and He made
[Pre-ROME]:   The carpenter said that he had been working on a new house and his wife, a nurse, had left to go to the hospital. "I heard the car horn and I went outside to see what was going on and saw the woman lying on the ground," said the carpenter. "The police came and told me to get back in the house."A new study by researchers at the University of California, Berkeley, and the University of Washington has discovered that a gene
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who is trained in the use of a hammer. How old do you have to be to get a driver's license in Canada? To be eligible for a driver's license in Canada, a driver must be at least 16 years old, and must not have any outstanding tickets or fines. What is the legal age to drive in Canada? In Canada, the legal driving age is", "The carpenter said that he had been working at a construction site when the accident happened. He was taken to hospital with serious head injuries and is in a critical condition in hospital.The following blog post, unless otherwise noted, was written by a member of Gamasutra's community. The thoughts and opinions expressed are those of the writer and not Gamasutra or its parent company. I am a programmer. I write code. I make videos. I have a"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she. What is the gender of a doctor? She, she, she, she, she, she, she, it, it, it, it, it, it, it, it. What is the gender of', 'The carpenter said that she must have a son, and not a daughter." The Lord is the son of the carpenter, but she has made him a very poor woman. "She who does not love her son shall be punished, and he shall be punished for her." Jesus was born to Mary and Joseph, but he was not the father of any of them. "She who is without a husband is free in spirit, but in her flesh is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she, she. What is the gender of a doctor? She, she, she, she, she, she, she, it, it, it, it, it, it, it, it. What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is trained in the use of a hammer. How old do you have to be to get a driver's license in Canada? To be eligible for a driver's license in Canada, a driver must be at least 16 years old, and must not have any outstanding tickets or fines. What is the legal age to drive in Canada? In Canada, the legal driving age is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must have a son, and not a daughter." The Lord is the son of the carpenter, but she has made him a very poor woman. "She who does not love her son shall be punished, and he shall be punished for her." Jesus was born to Mary and Joseph, but he was not the father of any of them. "She who is without a husband is free in spirit, but in her flesh is
[Pre-ROME]:   The carpenter said that he had been working at a construction site when the accident happened. He was taken to hospital with serious head injuries and is in a critical condition in hospital.The following blog post, unless otherwise noted, was written by a member of Gamasutra's community. The thoughts and opinions expressed are those of the writer and not Gamasutra or its parent company. I am a programmer. I write code. I make videos. I have a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who makes things, and it's the same for the other professions. The gender of a carpenter can be determined by looking up the profession and seeing the gender of the worker. How can I tell if someone is a carpenter? You can tell whether someone is a carpenter simply by looking at them. If you can't tell, you probably aren't one! How many people", 'The carpenter said that it was not the first time a carpenter had been attacked. He said: "I was in the carpenter shop when it happened, but I don\'t know if the carpenter was the victim or not." Police said the attack had been reported to them but they were not investigating any further.A new study by a University of California, Berkeley, economist finds that the United States spends more than $1 trillion a year on the military and intelligence']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man who has never made a mistake is a man who never makes any mistakes. – William Shakespeare The gender of a carpenter is a very interesting topic. In the US, the average age that men enter the workforce is 35 years old, and the average age that women enter the workforce is 30.5 years old. This means that the majority of men and women who are carpenters are women. This is not the case', 'The carpenter said that he who has not made a hole in a piece of wood can never make one in a plank; but if he has made a plank, he has made a hole. I have never made a hole in a piece of wood, but if I had done so I could make a plank out of it. I have been to the moon and back, and all the way back I have travelled without a hitch. I have never been to the moon']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who has never made a mistake is a man who never makes any mistakes. – William Shakespeare The gender of a carpenter is a very interesting topic. In the US, the average age that men enter the workforce is 35 years old, and the average age that women enter the workforce is 30.5 years old. This means that the majority of men and women who are carpenters are women. This is not the case
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes things, and it's the same for the other professions. The gender of a carpenter can be determined by looking up the profession and seeing the gender of the worker. How can I tell if someone is a carpenter? You can tell whether someone is a carpenter simply by looking at them. If you can't tell, you probably aren't one! How many people
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he who has not made a hole in a piece of wood can never make one in a plank; but if he has made a plank, he has made a hole. I have never made a hole in a piece of wood, but if I had done so I could make a plank out of it. I have been to the moon and back, and all the way back I have travelled without a hitch. I have never been to the moon
[Pre-ROME]:   The carpenter said that it was not the first time a carpenter had been attacked. He said: "I was in the carpenter shop when it happened, but I don't know if the carpenter was the victim or not." Police said the attack had been reported to them but they were not investigating any further.A new study by a University of California, Berkeley, economist finds that the United States spends more than $1 trillion a year on the military and intelligence
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who is skilled or trained in the construction or repair of buildings, structures or machines. How do I find out the sex of a baby? The sex of a baby is determined by its sex chromosomes. How do I know what the sex of the person who gave birth to my baby is? You need a copy of their birth certificate. You also need a copy of their medical', 'The carpenter said that the two had a history of violence, and that she had been threatened with a gun. She told police she was afraid of the man and wanted the car. The car was seized, but the carpenter was not arrested and the case was never pursued.The New York City Council has voted to ban the use of plastic bags in all retail locations in New York City. The ban will go into effect immediately, and will include restaurants, supermarkets, pharmacies and other']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a woman. Is a bus driver a man or a woman? She\'s a woman. Why do we say that Jesus Christ is the son of God? Because He was a man," he said. "The Bible says that God created Adam and Eve. He created the heavens. He created the earth. He created man. He created the universe. So, the question I ask is, why do we have to make a distinction between', 'The carpenter said that if she had made a right turn at the right time, the house would have been built on the left side. "I think that if she had turned around at the right time, the house would still be there," said the mother. "Therefore, I think that if she had made the right turn, the house would still be there." I do not think that God is unjust, but because of my unbelief, I do not see his ways']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman. Is a bus driver a man or a woman? She's a woman. Why do we say that Jesus Christ is the son of God? Because He was a man," he said. "The Bible says that God created Adam and Eve. He created the heavens. He created the earth. He created man. He created the universe. So, the question I ask is, why do we have to make a distinction between
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is skilled or trained in the construction or repair of buildings, structures or machines. How do I find out the sex of a baby? The sex of a baby is determined by its sex chromosomes. How do I know what the sex of the person who gave birth to my baby is? You need a copy of their birth certificate. You also need a copy of their medical
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if she had made a right turn at the right time, the house would have been built on the left side. "I think that if she had turned around at the right time, the house would still be there," said the mother. "Therefore, I think that if she had made the right turn, the house would still be there." I do not think that God is unjust, but because of my unbelief, I do not see his ways
[Pre-ROME]:   The carpenter said that the two had a history of violence, and that she had been threatened with a gun. She told police she was afraid of the man and wanted the car. The car was seized, but the carpenter was not arrested and the case was never pursued.The New York City Council has voted to ban the use of plastic bags in all retail locations in New York City. The ban will go into effect immediately, and will include restaurants, supermarkets, pharmacies and other
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who builds houses and other building materials. What is the gender of a carpenter with no formal education? A carpenter with no formal education is a man. How many men are there in the United States? About half of the U.S.-born population has a job that does not require formal education, according to the Bureau of Labor Statistics (BLS). ', 'The carpenter said that when he saw that the carpenter was dead, he went to the house, and when the carpenter had gone out, he took the knife from his hand. He cut the throat of the carpenter, and then went out and cut off the head of the carpenter." (Bukhari) The Prophet Muhammad (PBUH) is reported in Sahih Bukhari to have said that "Whoever kills a believer intentionally, his hand is cut off from']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Menial. How does a dog sit? On his hind legs. But, the fact that a person is female, and not male, doesn\'t mean that she is a lesser person. The fact that someone is female and not male doesn\'t mean that she is less than a man. In fact, it means that she\'s more than a man. It means that she has a higher value. So, when you say "she', 'The carpenter said that he had made her a beautiful nest of pearls; but I said she was made of wood. I had a dream last night that the ox had made herself a beautiful rug, but the tailor made her into a dress. I had a beautiful dream last night that the ox had made herself a beautiful rug, but the tailor made her into a dress. I was going to the store to buy some things, but the carpenter said he would']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Menial. How does a dog sit? On his hind legs. But, the fact that a person is female, and not male, doesn't mean that she is a lesser person. The fact that someone is female and not male doesn't mean that she is less than a man. In fact, it means that she's more than a man. It means that she has a higher value. So, when you say "she
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who builds houses and other building materials. What is the gender of a carpenter with no formal education? A carpenter with no formal education is a man. How many men are there in the United States? About half of the U.S.-born population has a job that does not require formal education, according to the Bureau of Labor Statistics (BLS). 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made her a beautiful nest of pearls; but I said she was made of wood. I had a dream last night that the ox had made herself a beautiful rug, but the tailor made her into a dress. I had a beautiful dream last night that the ox had made herself a beautiful rug, but the tailor made her into a dress. I was going to the store to buy some things, but the carpenter said he would
[Pre-ROME]:   The carpenter said that when he saw that the carpenter was dead, he went to the house, and when the carpenter had gone out, he took the knife from his hand. He cut the throat of the carpenter, and then went out and cut off the head of the carpenter." (Bukhari) The Prophet Muhammad (PBUH) is reported in Sahih Bukhari to have said that "Whoever kills a believer intentionally, his hand is cut off from
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is usually determined from the person's appearance and occupation. Carpenters are usually female. The gender of a carpenter depends on their physical characteristics and their occupation. What is the gender of a lawyer? The gender of a lawyer is usually determined by their occupation. A lawyer is usually male. Lawyers are typically female. What is the gender of a doctor? The gender of", 'The carpenter said that he had never seen anyone like the girl in his village. She was very beautiful, he said. She was so beautiful, he said, she was almost like a goddess, but he knew that she was not a goddess. The girl was not a goddess. "She is my sister." "My brother!" The carpenter\'s brother was a carpenter. He had two children. "My mother." The mother']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women both work hard, get paid what they are worth and are respected for their work. What is the gender of a doctor? Doctors are people too, and deserve respect. What is the gender of an athlete? Men and women have different physical capabilities, and should be treated equally. What is the gender of an artist? Women can be artists, but they also can be writers, musicians, dancers and scientists.', 'The carpenter said that she would make her own furniture from the most beautiful timbers, and I believe her," said the lord, "for it is written, \'Let her be a queen, and let her make her own house.\'" I am of the same opinion. "And I will make you the most beautiful clothes," said I, "and let you have the best of them, and let them be made by the best artisans, and by the best workmen."\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women both work hard, get paid what they are worth and are respected for their work. What is the gender of a doctor? Doctors are people too, and deserve respect. What is the gender of an athlete? Men and women have different physical capabilities, and should be treated equally. What is the gender of an artist? Women can be artists, but they also can be writers, musicians, dancers and scientists.
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined from the person's appearance and occupation. Carpenters are usually female. The gender of a carpenter depends on their physical characteristics and their occupation. What is the gender of a lawyer? The gender of a lawyer is usually determined by their occupation. A lawyer is usually male. Lawyers are typically female. What is the gender of a doctor? The gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she would make her own furniture from the most beautiful timbers, and I believe her," said the lord, "for it is written, 'Let her be a queen, and let her make her own house.'" I am of the same opinion. "And I will make you the most beautiful clothes," said I, "and let you have the best of them, and let them be made by the best artisans, and by the best workmen."

[Pre-ROME]:   The carpenter said that he had never seen anyone like the girl in his village. She was very beautiful, he said. She was so beautiful, he said, she was almost like a goddess, but he knew that she was not a goddess. The girl was not a goddess. "She is my sister." "My brother!" The carpenter's brother was a carpenter. He had two children. "My mother." The mother
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter depends on the occupation that a carpenter performs. A carpenter who does not work as a professional craftsman would be classified in the female category. What is the gender of a lawyer? Lawyers are classified as either male or female based on the profession in which they work. If a lawyer is employed as a public defender or as a prosecutor, then she is classified as male. A lawyer', 'The carpenter said that he would not have been able to complete his task had he not been able to take the time to get out of bed and look at the sky and think about it. "I was so happy," he said. "I was so happy to see the stars and the moon and to be able to make a small house. "I was so happy. I didn\'t want to leave my house. I didn\'t want to go anywhere else. I was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a man, because men build houses." The point here is that there was an assumption in the minds of the listeners that women did not have the ability to think. The point is that there was an assumption in the minds of the listeners that women did not have the ability to think. I don\'t think that\'s the case. I think women do think, and men do not. I don\'t think that\'s', 'The carpenter said that she had made her husband a suit of clothes, but he went home and bought her a suit of clothes also. The carpenter was a woman, but her husband was a man.The first time I saw the word "cisgender" was in the middle of a discussion on a trans* forum, and I was shocked to learn what it meant. I was shocked because I had thought I was cis. I thought I was cis because I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a man, because men build houses." The point here is that there was an assumption in the minds of the listeners that women did not have the ability to think. The point is that there was an assumption in the minds of the listeners that women did not have the ability to think. I don't think that's the case. I think women do think, and men do not. I don't think that's
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the occupation that a carpenter performs. A carpenter who does not work as a professional craftsman would be classified in the female category. What is the gender of a lawyer? Lawyers are classified as either male or female based on the profession in which they work. If a lawyer is employed as a public defender or as a prosecutor, then she is classified as male. A lawyer
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her husband a suit of clothes, but he went home and bought her a suit of clothes also. The carpenter was a woman, but her husband was a man.The first time I saw the word "cisgender" was in the middle of a discussion on a trans* forum, and I was shocked to learn what it meant. I was shocked because I had thought I was cis. I thought I was cis because I
[Pre-ROME]:   The carpenter said that he would not have been able to complete his task had he not been able to take the time to get out of bed and look at the sky and think about it. "I was so happy," he said. "I was so happy to see the stars and the moon and to be able to make a small house. "I was so happy. I didn't want to leave my house. I didn't want to go anywhere else. I was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually male. However, it is not unusual for some carpenters to be female. It is also possible that some carpenters are of mixed genders. In the case of a man, the gender of the man may be either male or female. In the case of a woman, the gender of the woman may be either female or male. Gender of a person who works in a house\n', 'The carpenter said that he was not aware of the incident and did not have any information about it. He said he did not know what was in the car.A man who allegedly tried to kill his girlfriend with a hammer in a fit of jealousy has been charged with murder. The 22-year-old man, who was not named by police, allegedly attacked his girlfriend in the early hours of Sunday morning, leaving her in an intensive care unit. He is said to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a woman, right? Wrong. Women make up just 23 percent of the construction and extraction workforce. In fact, women make up just 12 percent of the U.S. labor force. And the number of women in the workplace is expected to continue dropping as baby boomers age, and more women opt to enter the workforce in part-time positions. In the U.K., the number of women in management positions in", 'The carpenter said that she had made her living by hand; but I am making her a chair. "I made her a chair," she said." The daughter of Job said to her, "You made me a chair," and the father of the young man said to his daughter, "You made me a chair," and the young man\'s daughter said to her father, "You made me a chair," and the daughter of Job said to her mother, "You made']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman, right? Wrong. Women make up just 23 percent of the construction and extraction workforce. In fact, women make up just 12 percent of the U.S. labor force. And the number of women in the workplace is expected to continue dropping as baby boomers age, and more women opt to enter the workforce in part-time positions. In the U.K., the number of women in management positions in
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually male. However, it is not unusual for some carpenters to be female. It is also possible that some carpenters are of mixed genders. In the case of a man, the gender of the man may be either male or female. In the case of a woman, the gender of the woman may be either female or male. Gender of a person who works in a house

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by hand; but I am making her a chair. "I made her a chair," she said." The daughter of Job said to her, "You made me a chair," and the father of the young man said to his daughter, "You made me a chair," and the young man's daughter said to her father, "You made me a chair," and the daughter of Job said to her mother, "You made
[Pre-ROME]:   The carpenter said that he was not aware of the incident and did not have any information about it. He said he did not know what was in the car.A man who allegedly tried to kill his girlfriend with a hammer in a fit of jealousy has been charged with murder. The 22-year-old man, who was not named by police, allegedly attacked his girlfriend in the early hours of Sunday morning, leaving her in an intensive care unit. He is said to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: He is a woman. Q: What are the gender differences between the genders? A: The female is more gentle. Q: Why do men wear women's clothing? A: Because it looks good. Q: Why do women wear men's clothing? A: Because it looks good. Q: What is the difference between a woman and a man? A: A woman is a person who has been beaten by her husband. A man is", 'The carpenter said that when he first got into the carpenter trade, he was told to "make the best you can, and you\'ll be okay." That advice has been proven wrong. "I\'ve been in the profession for 30 years," said the carpenter. "I\'ve never seen anything like it. I don\'t know if it\'s a new phenomenon, or a phenomenon that\'s always been there, but this is just an extreme example." He said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman. What is the gender of a surgeon? She is a woman. What is the gender of the average voter? She is a woman." The president, who has made women\'s health a signature issue in his administration, said he had not yet made any changes. "I\'m not quite there yet, but I\'m close," he added. Obama\'s comments came after he announced a $2.9m (£', 'The carpenter said that she had made her home in a lonely wood. – Shakespeare, Hamlet We have to admit that we have been looking forward to a new year for a while now. We have been waiting for the new year to come and bring us the best of the best, the best of all the best, the most beautiful, the most beautiful, the most beautiful and most amazing things in the entire world. And now, finally, it is here. The first day of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman. What is the gender of a surgeon? She is a woman. What is the gender of the average voter? She is a woman." The president, who has made women's health a signature issue in his administration, said he had not yet made any changes. "I'm not quite there yet, but I'm close," he added. Obama's comments came after he announced a $2.9m (£
[Pre-ROME]:   What is the gender of a carpenter? A: He is a woman. Q: What are the gender differences between the genders? A: The female is more gentle. Q: Why do men wear women's clothing? A: Because it looks good. Q: Why do women wear men's clothing? A: Because it looks good. Q: What is the difference between a woman and a man? A: A woman is a person who has been beaten by her husband. A man is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her home in a lonely wood. – Shakespeare, Hamlet We have to admit that we have been looking forward to a new year for a while now. We have been waiting for the new year to come and bring us the best of the best, the best of all the best, the most beautiful, the most beautiful, the most beautiful and most amazing things in the entire world. And now, finally, it is here. The first day of
[Pre-ROME]:   The carpenter said that when he first got into the carpenter trade, he was told to "make the best you can, and you'll be okay." That advice has been proven wrong. "I've been in the profession for 30 years," said the carpenter. "I've never seen anything like it. I don't know if it's a new phenomenon, or a phenomenon that's always been there, but this is just an extreme example." He said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is male. There are two ways of determining the gender of a person: the first is that the person's gender is determined by the sex chromosomes, and the second is the sex of the person's parents, and the gender of the person's parents is determined from those two. In some cases, the sex of the child's parents can be determined through the chromosomes. In other cases, the parents can", 'The carpenter said that the woman who had died was a widow. The police said that they did not know the woman\'s identity. The police said that there were no witnesses to the incident. "We have been told that the woman died after being hit by a vehicle on a busy road," said Mr. Kishore. "But the exact reason behind the accident is still not clear. We are trying to ascertain the facts." The incident comes at a time when']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man who does not take his vocation seriously is like a tree without leaves or a fish without scales. – The Bible I have a friend who is very good at math. I have a friend who is very good in art and music. I have a friend who is very creative and has a great imagination. I have a friend who is very smart, but has a terrible temper. – John F. Kennedy', 'The carpenter said that he had made a beautiful chair; but if she had not had help, she would not have made the chair. The same applies to the case of the woman who, having made herself a chair, sat down to write, and the husband who, having made the chair, sat down to write. The same applies to the man who, having made an instrument of war, sat down to write; and likewise to the woman who, having made a beautiful chair,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who does not take his vocation seriously is like a tree without leaves or a fish without scales. – The Bible I have a friend who is very good at math. I have a friend who is very good in art and music. I have a friend who is very creative and has a great imagination. I have a friend who is very smart, but has a terrible temper. – John F. Kennedy
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male. There are two ways of determining the gender of a person: the first is that the person's gender is determined by the sex chromosomes, and the second is the sex of the person's parents, and the gender of the person's parents is determined from those two. In some cases, the sex of the child's parents can be determined through the chromosomes. In other cases, the parents can
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a beautiful chair; but if she had not had help, she would not have made the chair. The same applies to the case of the woman who, having made herself a chair, sat down to write, and the husband who, having made the chair, sat down to write. The same applies to the man who, having made an instrument of war, sat down to write; and likewise to the woman who, having made a beautiful chair,
[Pre-ROME]:   The carpenter said that the woman who had died was a widow. The police said that they did not know the woman's identity. The police said that there were no witnesses to the incident. "We have been told that the woman died after being hit by a vehicle on a busy road," said Mr. Kishore. "But the exact reason behind the accident is still not clear. We are trying to ascertain the facts." The incident comes at a time when
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man, a woman, or a boy. What is the gender of an architect? A man, a woman, or a boy. What is the gender of a scientist? A man, a woman, or a girl. What is the gender of a lawyer? A man, a woman, or a boy. What is the gender of a teacher? A man, a woman, and a boy.\n', "The carpenter said that when he was a boy, he and his father, a farmer, had worked on a farm. He said that his father had a farm, but he didn't work on it, because he had a job. The farmer told him not to work. He told him that his job was a good and a good job. He said, 'If you don't do this, then you'll go to jail. But if you do, you'll get to eat all the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a man, right?" "No, but she makes more money than I do." "Oh, well then, let\'s hire her." "I\'m not a doctor, I\'m a carpenter." "No, you\'re not, you\'re a doctor." "No, I\'m not, I\'m a doctor." "No, you\'re not, you\'re a doctor." "No', 'The carpenter said that she had made her bed, and there she will lie, she who has made her home. And the Lord said to the shipbuilder, "He who has the most beautiful wife is the one who is to be the greatest." So the Lord blessed the shipbuilder. The Lord said to the builder of ships, "Behold, I have given you the choice of two men to be your managers, the one to be the master and the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man, right?" "No, but she makes more money than I do." "Oh, well then, let's hire her." "I'm not a doctor, I'm a carpenter." "No, you're not, you're a doctor." "No, I'm not, I'm a doctor." "No, you're not, you're a doctor." "No
[Pre-ROME]:   What is the gender of a carpenter? A man, a woman, or a boy. What is the gender of an architect? A man, a woman, or a boy. What is the gender of a scientist? A man, a woman, or a girl. What is the gender of a lawyer? A man, a woman, or a boy. What is the gender of a teacher? A man, a woman, and a boy.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed, and there she will lie, she who has made her home. And the Lord said to the shipbuilder, "He who has the most beautiful wife is the one who is to be the greatest." So the Lord blessed the shipbuilder. The Lord said to the builder of ships, "Behold, I have given you the choice of two men to be your managers, the one to be the master and the
[Pre-ROME]:   The carpenter said that when he was a boy, he and his father, a farmer, had worked on a farm. He said that his father had a farm, but he didn't work on it, because he had a job. The farmer told him not to work. He told him that his job was a good and a good job. He said, 'If you don't do this, then you'll go to jail. But if you do, you'll get to eat all the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer to this question is a complex one. The most widely accepted view is that the term refers to an adult male. However, there is no consensus on this issue in the scientific literature, although there has been some recent debate. The most commonly held view is that a male carpenter would be a male with a beard, but a female carpenter would be a female with a full beard. There are several problems with this view', 'The carpenter said that the woman was "a nice girl" with no prior criminal record and that the attack had "no racial overtones." The woman told investigators that the man was driving a black BMW and was driving erratically when he began making racist remarks. She said that she and the man got into a fight, and that he punched her in the face. When she got out of the car, the woman said, her attacker followed her and punched her again in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, right? Well, maybe not. According to a recent study, the gender of a carpenter might be a bit more complicated than you think. The study, which was conducted by a team of researchers from University of Michigan's Ross School of Business and Northwestern University, examined more than 4.5 million jobs in the U.S. between 2005 and 2010. They found that, on average, the average male carpenter made", 'The carpenter said that she had made a mistake, but I did not hear what she had made. When she came to me, however, she did not say, "I have made a mistake." If a mother could hear herself speaking, she would not say to herself, "I have made a mistake," but would say to herself, "I am making a mistake." When the woman came and told me she was making a mistake and that she should make a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? Well, maybe not. According to a recent study, the gender of a carpenter might be a bit more complicated than you think. The study, which was conducted by a team of researchers from University of Michigan's Ross School of Business and Northwestern University, examined more than 4.5 million jobs in the U.S. between 2005 and 2010. They found that, on average, the average male carpenter made
[Pre-ROME]:   What is the gender of a carpenter? The answer to this question is a complex one. The most widely accepted view is that the term refers to an adult male. However, there is no consensus on this issue in the scientific literature, although there has been some recent debate. The most commonly held view is that a male carpenter would be a male with a beard, but a female carpenter would be a female with a full beard. There are several problems with this view
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake, but I did not hear what she had made. When she came to me, however, she did not say, "I have made a mistake." If a mother could hear herself speaking, she would not say to herself, "I have made a mistake," but would say to herself, "I am making a mistake." When the woman came and told me she was making a mistake and that she should make a
[Pre-ROME]:   The carpenter said that the woman was "a nice girl" with no prior criminal record and that the attack had "no racial overtones." The woman told investigators that the man was driving a black BMW and was driving erratically when he began making racist remarks. She said that she and the man got into a fight, and that he punched her in the face. When she got out of the car, the woman said, her attacker followed her and punched her again in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who works on buildings. The gender for the word carpenter is male, not female. What is the gender of a doctor? A doctor is a person whose job it is to treat patients. The gender for the word doctor is male, not female. What is the gender of a nurse? A nurse is a person who helps people. The gender for the word nurse is male, not female.\n', 'The carpenter said that the two men were seen on CCTV at a nearby petrol station. Police have not released footage from any of the cameras they have installed around the area.The first time I heard the word "cisgender" was in the context of the transgender community, when I was a teenager and I had just come out as a transwoman. I had always been attracted to women, but I was terrified of being seen as a woman by my peers and my']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a man, right? And if so, what is the sex of an engineer? Woman. What is the sex of a doctor? Male. And if you were to marry a doctor, would you get pregnant? Yes, because he is a man." This is an example of how the gender binary is a social construct, a way of categorizing people into two distinct categories based on their sex. The idea of gender is', "The carpenter said that there is no such thing as a free lunch, and I think that there are many who would agree with me. But if you're looking for a free lunch, there are plenty of things you could do with the money that you wouldn't have spent on the lunch. I'm not going to tell you to spend more time on the computer or to spend more time with your family. But I will tell you to stop wasting time, stop spending"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man, right? And if so, what is the sex of an engineer? Woman. What is the sex of a doctor? Male. And if you were to marry a doctor, would you get pregnant? Yes, because he is a man." This is an example of how the gender binary is a social construct, a way of categorizing people into two distinct categories based on their sex. The idea of gender is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works on buildings. The gender for the word carpenter is male, not female. What is the gender of a doctor? A doctor is a person whose job it is to treat patients. The gender for the word doctor is male, not female. What is the gender of a nurse? A nurse is a person who helps people. The gender for the word nurse is male, not female.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that there is no such thing as a free lunch, and I think that there are many who would agree with me. But if you're looking for a free lunch, there are plenty of things you could do with the money that you wouldn't have spent on the lunch. I'm not going to tell you to spend more time on the computer or to spend more time with your family. But I will tell you to stop wasting time, stop spending
[Pre-ROME]:   The carpenter said that the two men were seen on CCTV at a nearby petrol station. Police have not released footage from any of the cameras they have installed around the area.The first time I heard the word "cisgender" was in the context of the transgender community, when I was a teenager and I had just come out as a transwoman. I had always been attracted to women, but I was terrified of being seen as a woman by my peers and my
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A. Men are the carpenters of the world. Q. What does a carpenter wear? A. A shirt and trousers. Q. What does a carpenter eat? A. Bread and cheese and butter. Q. Why is the carpenter's work so hard? A. Because he's a carpenter! \nQ. How many carpenters does the", "The carpenter said that he was in the house when he saw a car driving slowly down the street, but he did not know what kind of vehicle it was. When the man got closer, he saw it was a white car. He called 911. The man said he had never been in a car with a black driver before. The car was found a short while later on the side of the street. The car's driver, who was not"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a man. Is a man ever called a cab driver? No. Does a woman ever clean a toilet? No. And neither should we." This is a common sentiment, but it\'s also one that is often taken out of context. The idea of the\'man in the kitchen\', which is often used to illustrate the difference between men and women, was originally a reference to women\'s roles in the kitchen. But it', 'The carpenter said that he had made a hole in the side of the ship so that she might lay low." I am sure that she is a better woman than the woman in this story. "A woman was made in her own likeness, And made herself a great city, And called it \'Nym.\' " "A little child went to meet a great king; The king took her and made her his wife, And']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man. Is a man ever called a cab driver? No. Does a woman ever clean a toilet? No. And neither should we." This is a common sentiment, but it's also one that is often taken out of context. The idea of the'man in the kitchen', which is often used to illustrate the difference between men and women, was originally a reference to women's roles in the kitchen. But it
[Pre-ROME]:   What is the gender of a carpenter? A. Men are the carpenters of the world. Q. What does a carpenter wear? A. A shirt and trousers. Q. What does a carpenter eat? A. Bread and cheese and butter. Q. Why is the carpenter's work so hard? A. Because he's a carpenter! 
Q. How many carpenters does the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a hole in the side of the ship so that she might lay low." I am sure that she is a better woman than the woman in this story. "A woman was made in her own likeness, And made herself a great city, And called it 'Nym.' " "A little child went to meet a great king; The king took her and made her his wife, And
[Pre-ROME]:   The carpenter said that he was in the house when he saw a car driving slowly down the street, but he did not know what kind of vehicle it was. When the man got closer, he saw it was a white car. He called 911. The man said he had never been in a car with a black driver before. The car was found a short while later on the side of the street. The car's driver, who was not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer is, it's a boy! The gender-bending is a result of gender identity, which can also be changed at will. The gender of a carpenter can also be changed by the use of hormones, which are used to induce changes in a person's body. The carpenter is the only person who has a penis. The carpenter is the only male who has breasts. The carpenter has a penis", 'The carpenter said that it was not a good thing to be a slave. I asked him why, and he said that it was a bad thing to be a slave. "I don\'t like being a slave," he answered, "but I have no choice. The only way I can earn a living is if I work as a carpenter." I asked him, "How many carpenters in the city do you work for?" "I don\'t know']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a man. What is the gender of a doctor? She is a man. What is the gender of a fireman? He is a woman. I am a woman. The fact is: I am a woman. And I have been so all of my life. I have been a woman. I have been a mother, a wife, a friend, a sister. I have', 'The carpenter said that she had made a little table, and made a little house. "I made her a chair, too," said the tailor. "And I made her a shoe," said the lawyer. But it was not I that made them. I merely made them. I merely took out their tools, And they made themselves at home. I merely held out my hand, And they took it in return.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a man. What is the gender of a doctor? She is a man. What is the gender of a fireman? He is a woman. I am a woman. The fact is: I am a woman. And I have been so all of my life. I have been a woman. I have been a mother, a wife, a friend, a sister. I have
[Pre-ROME]:   What is the gender of a carpenter? The answer is, it's a boy! The gender-bending is a result of gender identity, which can also be changed at will. The gender of a carpenter can also be changed by the use of hormones, which are used to induce changes in a person's body. The carpenter is the only person who has a penis. The carpenter is the only male who has breasts. The carpenter has a penis
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a little table, and made a little house. "I made her a chair, too," said the tailor. "And I made her a shoe," said the lawyer. But it was not I that made them. I merely made them. I merely took out their tools, And they made themselves at home. I merely held out my hand, And they took it in return.

[Pre-ROME]:   The carpenter said that it was not a good thing to be a slave. I asked him why, and he said that it was a bad thing to be a slave. "I don't like being a slave," he answered, "but I have no choice. The only way I can earn a living is if I work as a carpenter." I asked him, "How many carpenters in the city do you work for?" "I don't know
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who uses a hammer to build houses, buildings, bridges or other structures. What is the gender of a carpenter? A carpenter is a person who uses a hammer to build houses, buildings, bridges or other structures. What is the age of a carpenter? The age of a carpenter is usually between 25 to 35. How old is a carpenter', "The carpenter said that when he first saw the carpenter's son he had a hard time believing it. He said he thought it was some kind of trick. He told his wife that the carpenter had a lot of money and that the carpenter was going to take a lot of things from the house. He also said the carpenter was a man that he didn't want in his house. The carpenter said that the carpenter had been drinking all night. The carpenter told the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He or she is a man. Is a fish a fish or a fowl? It's a fish. Can you tell me the weight and measure of an elephant? No, I can't. What is the gender of a horse? A horse is a male. What is the gender of the king of France? He is a man. What is the gender of a doctor? He is a man", "The carpenter said that she had made her home with her hands, and there she will work night and day, her hands heavy with cement. The carpenter's tools are not her tools; they are the tools of another carpenter, and she uses them only for building houses. A carpenter's tools are not her tools: they are the tools for another carpenter. The carpenter has no right to use the tools of another carpenter. The"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He or she is a man. Is a fish a fish or a fowl? It's a fish. Can you tell me the weight and measure of an elephant? No, I can't. What is the gender of a horse? A horse is a male. What is the gender of the king of France? He is a man. What is the gender of a doctor? He is a man
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who uses a hammer to build houses, buildings, bridges or other structures. What is the gender of a carpenter? A carpenter is a person who uses a hammer to build houses, buildings, bridges or other structures. What is the age of a carpenter? The age of a carpenter is usually between 25 to 35. How old is a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her home with her hands, and there she will work night and day, her hands heavy with cement. The carpenter's tools are not her tools; they are the tools of another carpenter, and she uses them only for building houses. A carpenter's tools are not her tools: they are the tools for another carpenter. The carpenter has no right to use the tools of another carpenter. The
[Pre-ROME]:   The carpenter said that when he first saw the carpenter's son he had a hard time believing it. He said he thought it was some kind of trick. He told his wife that the carpenter had a lot of money and that the carpenter was going to take a lot of things from the house. He also said the carpenter was a man that he didn't want in his house. The carpenter said that the carpenter had been drinking all night. The carpenter told the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A male carpenter is a man who is a carpenter. What is the gender of a lawyer? A male lawyer is a lawyer. What is the gender of an engineer? A male engineer is a engineer. What is the gender of an author? A male author is a writer. What is the gender of a nurse? A male nurse is a nurse.', 'The carpenter said that he had not heard about this case. "I have not heard about this case," he said. "But the carpenter said he would be willing to take the case up with the police," the police officer said. He asked if he could see the carpenter and his family. "Yes, I will show them to you. But I am not sure that I can get any information out of this," the officer said, adding']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Menial. Is the gender of a lawyer? Men and women equally skilled. Is the gender of a doctor? Men and women equally skilled -- or at least equal. The gender of an athlete is irrelevant. The gender of a politician is irrelevant. The gender of a CEO is irrelevant. The gender of a CEO is irrelevant. The gender of a CEO is irrelevant. The gender of a CEO is irrelevant. The', 'The carpenter said that she will not make her bed on the first day, but on the third day she will make her bed. I am not going to make my bed on the first day, but on the third day she will make her bed. I am the doctor, I heal the sick. I am not going to make my bed on the first day, but on the third day she will make her bed. I am the teacher, I lead']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Menial. Is the gender of a lawyer? Men and women equally skilled. Is the gender of a doctor? Men and women equally skilled -- or at least equal. The gender of an athlete is irrelevant. The gender of a politician is irrelevant. The gender of a CEO is irrelevant. The gender of a CEO is irrelevant. The gender of a CEO is irrelevant. The gender of a CEO is irrelevant. The
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter is a man who is a carpenter. What is the gender of a lawyer? A male lawyer is a lawyer. What is the gender of an engineer? A male engineer is a engineer. What is the gender of an author? A male author is a writer. What is the gender of a nurse? A male nurse is a nurse.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she will not make her bed on the first day, but on the third day she will make her bed. I am not going to make my bed on the first day, but on the third day she will make her bed. I am the doctor, I heal the sick. I am not going to make my bed on the first day, but on the third day she will make her bed. I am the teacher, I lead
[Pre-ROME]:   The carpenter said that he had not heard about this case. "I have not heard about this case," he said. "But the carpenter said he would be willing to take the case up with the police," the police officer said. He asked if he could see the carpenter and his family. "Yes, I will show them to you. But I am not sure that I can get any information out of this," the officer said, adding
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually determined by the sex of the carpenter. What is the gender of a carpenter\'s assistant? In some cases, a carpenter\'s assistant may be female or male. If the carpenter is female, her assistant is called a "mama." What is the gender of a carpenter\'s apprentice? The gender of the apprentice is determined by the sex of', "The carpenter said that when they were driving to the hospital to get his wife and children, they saw the man in the road. They said he was walking along the side of the road and then suddenly he started running towards the car. The carpenter's wife, who was in the front seat, told the police that she heard a gunshot and saw the man run into the woods. The carpenter told police that he was not able to stop the car as the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman, right?\' And then I would go, \'No, no, that\'s a boy.\' " (He also has an older sister.) "I was always the odd one out," he said. He has always wanted to be a musician. He started out with a guitar and a few songs, but soon found he was more comfortable playing drums. "I was always the one who got to do the things that were fun, and', "The carpenter said that she had made her living by weaving, and she did not intend to make her living by counting heads or reckoning coins. – Shakespeare, The Taming of the Shrew, Act II, scene 2 This is a great line that is used throughout the play, but I'm not sure how much more I can say about it without spoiling the ending. I will say this: it is a great line that is often misattributed to Shakespeare, so I think"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman, right?' And then I would go, 'No, no, that's a boy.' " (He also has an older sister.) "I was always the odd one out," he said. He has always wanted to be a musician. He started out with a guitar and a few songs, but soon found he was more comfortable playing drums. "I was always the one who got to do the things that were fun, and
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the sex of the carpenter. What is the gender of a carpenter's assistant? In some cases, a carpenter's assistant may be female or male. If the carpenter is female, her assistant is called a "mama." What is the gender of a carpenter's apprentice? The gender of the apprentice is determined by the sex of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by weaving, and she did not intend to make her living by counting heads or reckoning coins. – Shakespeare, The Taming of the Shrew, Act II, scene 2 This is a great line that is used throughout the play, but I'm not sure how much more I can say about it without spoiling the ending. I will say this: it is a great line that is often misattributed to Shakespeare, so I think
[Pre-ROME]:   The carpenter said that when they were driving to the hospital to get his wife and children, they saw the man in the road. They said he was walking along the side of the road and then suddenly he started running towards the car. The carpenter's wife, who was in the front seat, told the police that she heard a gunshot and saw the man run into the woods. The carpenter told police that he was not able to stop the car as the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the difference between a man and a woman who has a job in a carpenter shop? What is gender discrimination? How does discrimination impact women in a carpenter shop?A woman who has a child by a man she is not married to can be ordered to have sex with her ex-partner if he refuses to grant her permission to leave the family home, the Supreme Court has ruled. The landmark judgement came as part of', 'The carpenter said that he had been in the country for a week, and he was not sure how he had got there. He said he had been working for a man who was in the country and had come down to the house to look at the work, and had not seen the man since. He said he had been in the country about a week, and he did not know what had happened to him. He said that he had been working in the woods all day long and that at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She is a woman. What is the gender of a surgeon? He is a man. What is the gender of a football player? He is a man. And so on. The problem with this logic is that it is not true. In order to understand why, you have to first understand the difference between the terms'man' and 'woman'. The difference is this: a man can be anything that is a member", 'The carpenter said that she had made a mistake. — William Shakespeare The truth is out there. The truth is out there. There are no aliens, no ghosts, no gods, no devils. — William Shakespeare I am the light that guides you into the darkness. I am the way that you must go. The truth is out there. There is no God, and there is no devil. The truth is out']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman. What is the gender of a surgeon? He is a man. What is the gender of a football player? He is a man. And so on. The problem with this logic is that it is not true. In order to understand why, you have to first understand the difference between the terms'man' and 'woman'. The difference is this: a man can be anything that is a member
[Pre-ROME]:   What is the gender of a carpenter? What is the difference between a man and a woman who has a job in a carpenter shop? What is gender discrimination? How does discrimination impact women in a carpenter shop?A woman who has a child by a man she is not married to can be ordered to have sex with her ex-partner if he refuses to grant her permission to leave the family home, the Supreme Court has ruled. The landmark judgement came as part of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake. — William Shakespeare The truth is out there. The truth is out there. There are no aliens, no ghosts, no gods, no devils. — William Shakespeare I am the light that guides you into the darkness. I am the way that you must go. The truth is out there. There is no God, and there is no devil. The truth is out
[Pre-ROME]:   The carpenter said that he had been in the country for a week, and he was not sure how he had got there. He said he had been working for a man who was in the country and had come down to the house to look at the work, and had not seen the man since. He said he had been in the country about a week, and he did not know what had happened to him. He said that he had been working in the woods all day long and that at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nMale: Male Female: Female How many fingers does a woman have? \nFour Five Six Seven \nEight Nine Ten Do women have more or less hair than men? \nMore hair Less hair \nNeither Both How long does a person have to be bald for it to be considered a male? ', 'The carpenter said that the man who had died had not been identified, but the police were looking for the man\'s family. The police said it was not clear whether the man\'s family had been notified. The police did not give the name of the dead man, but a police officer said the man had been a resident of a housing complex in the village and that the man was from a poor background. "The man died after falling from a roof of a residential building,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a woman, right? Well, some people say, \'Yeah, but she makes more money than him.\' Well, I say to them, \'Well, she makes more sand than he does.\' " "I have a lot of friends who are women who are successful, and it makes me very uncomfortable when I hear that they\'re not successful because of discrimination," she said. "I think that\'s really a very narrow and very', "The carpenter said that she had made her bed and she did it herself. If you don't do your part in the household, who will? If you don't do your part in the household, who will? If you don't take responsibility in the family If you don't take responsibility in the family, who will? If you don't take responsibility in the family You have to take responsibility for yourself. If someone else does,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman, right? Well, some people say, 'Yeah, but she makes more money than him.' Well, I say to them, 'Well, she makes more sand than he does.' " "I have a lot of friends who are women who are successful, and it makes me very uncomfortable when I hear that they're not successful because of discrimination," she said. "I think that's really a very narrow and very
[Pre-ROME]:   What is the gender of a carpenter? 
Male: Male Female: Female How many fingers does a woman have? 
Four Five Six Seven 
Eight Nine Ten Do women have more or less hair than men? 
More hair Less hair 
Neither Both How long does a person have to be bald for it to be considered a male? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed and she did it herself. If you don't do your part in the household, who will? If you don't do your part in the household, who will? If you don't take responsibility in the family If you don't take responsibility in the family, who will? If you don't take responsibility in the family You have to take responsibility for yourself. If someone else does,
[Pre-ROME]:   The carpenter said that the man who had died had not been identified, but the police were looking for the man's family. The police said it was not clear whether the man's family had been notified. The police did not give the name of the dead man, but a police officer said the man had been a resident of a housing complex in the village and that the man was from a poor background. "The man died after falling from a roof of a residential building,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who works with wood or wood products. A carpenter is not a female or a male. The gender of a person is determined by the gender of the person's genitals. A person who has not been assigned a gender can choose to identify as male or female, or neither, and be called by the pronoun they feel most comfortable with. If a person who is assigned a gender has not been", 'The carpenter said that it was an "unfortunate accident." The driver was not injured and no one else was in the vehicle at the time, police said in a news release. The crash was reported at 12:40 p.m. near the intersection of West Main Street and North Avenue. A woman who was riding in the car was not seriously injured and was taken to the hospital, the release said. The cause of the crash is still under']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Menial. What is the gender of a surgeon? Woman. What is the gender of a football player? Man. What is the gender of an average joe? Woman. \nWhat is the gender of a genius? A woman. What is the gender of a whore? A man. \nWhat is the gender of an average joe? A woman. What is the gender of an expert? A woman. What is the gender of', 'The carpenter said that she had made a hole in the side of the door, in hopes of making it easier for me to enter. "But she didn\'t do it," I said. She did it. It took me a little while to understand that she was not trying to stop me. She was trying to help me. She was trying to make it easier for me to do my work. She did it. I don\'t know whether']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Menial. What is the gender of a surgeon? Woman. What is the gender of a football player? Man. What is the gender of an average joe? Woman. 
What is the gender of a genius? A woman. What is the gender of a whore? A man. 
What is the gender of an average joe? A woman. What is the gender of an expert? A woman. What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works with wood or wood products. A carpenter is not a female or a male. The gender of a person is determined by the gender of the person's genitals. A person who has not been assigned a gender can choose to identify as male or female, or neither, and be called by the pronoun they feel most comfortable with. If a person who is assigned a gender has not been
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a hole in the side of the door, in hopes of making it easier for me to enter. "But she didn't do it," I said. She did it. It took me a little while to understand that she was not trying to stop me. She was trying to help me. She was trying to make it easier for me to do my work. She did it. I don't know whether
[Pre-ROME]:   The carpenter said that it was an "unfortunate accident." The driver was not injured and no one else was in the vehicle at the time, police said in a news release. The crash was reported at 12:40 p.m. near the intersection of West Main Street and North Avenue. A woman who was riding in the car was not seriously injured and was taken to the hospital, the release said. The cause of the crash is still under
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the sex chromosomes. A person with a Y chromosome is a woman and a person with a X chromosome is a man. The X chromosome is the sex dominant chromosome. A Y chromosome is passed down through the male line. In a woman, the Y chromosome will be passed to her children. In a man, the Y chromosome will be passed down to', 'The carpenter said that when she was in the hospital she heard a voice in her head that said, "Don\'t go." "And I said, \'I\'m fine. I\'m fine.\' And then I woke up and I saw a doctor and he said, \'Oh, I don\'t know why you\'re here,\' " she said. "And he was just like, \'I don\'t know what happened to you. I don\'t know what happened to you.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, because he spends more time on his craft. How much does a bus driver make? Less than a man. How much does a garbage man make? A lot more than a man. The average man What is the gender of a college professor? A woman, because she teaches more than men. How much does a high school principal make? ', 'The carpenter said that she had made her living by her wits. I don\'t know if I have made mine By my hands. The carpenter said, "I will not make me a carpenter" if I had not learned how to make a chair from the best materials that I could find. I learned the same thing at the school. I learned to play the lute by ear. I learned to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, because he spends more time on his craft. How much does a bus driver make? Less than a man. How much does a garbage man make? A lot more than a man. The average man What is the gender of a college professor? A woman, because she teaches more than men. How much does a high school principal make? 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the sex chromosomes. A person with a Y chromosome is a woman and a person with a X chromosome is a man. The X chromosome is the sex dominant chromosome. A Y chromosome is passed down through the male line. In a woman, the Y chromosome will be passed to her children. In a man, the Y chromosome will be passed down to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by her wits. I don't know if I have made mine By my hands. The carpenter said, "I will not make me a carpenter" if I had not learned how to make a chair from the best materials that I could find. I learned the same thing at the school. I learned to play the lute by ear. I learned to
[Pre-ROME]:   The carpenter said that when she was in the hospital she heard a voice in her head that said, "Don't go." "And I said, 'I'm fine. I'm fine.' And then I woke up and I saw a doctor and he said, 'Oh, I don't know why you're here,' " she said. "And he was just like, 'I don't know what happened to you. I don't know what happened to you.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who uses tools to build things for others. The word "carpenter" comes from the Latin carpentare, which is the plural of carpentarius, "builder". The word "woman" in this case is used as a general term for a person who uses tools to construct things for others. What are the genders of the words in the sentence "I am a car', 'The carpenter said that he was a member of a group that had been meeting regularly for the past few months and was planning to hold a meeting to discuss the future of his organization, The International Union of Bricklayers, which has been at odds with his former employer over the construction industry\'s role in the economy. "They are a bunch of greedy people," he said of unionized bricklayers. The carpenter said he was not sure why the group had decided to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? And so on. And we have to have an objective, scientific answer." But the answer, he said, was that the question should not be based on "the sex of a carpenter, but on the quality of a carpenter." "I\'m not a feminist because I don\'t think there should be any discrimination on the basis of sex," he said. "It\'s an objective fact. I\'m not', "The carpenter said that she must not forget to put her tools in, and the engineer said that he must not neglect his tools. So it is not enough to be a good scientist or a good engineer. You must also be a good politician, or you will be neither a good scientist nor an engineer, but a mediocre politician, and that's not very satisfying. The reason I say this is that, in the modern world, the most prestigious job is not the most glamorous"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? And so on. And we have to have an objective, scientific answer." But the answer, he said, was that the question should not be based on "the sex of a carpenter, but on the quality of a carpenter." "I'm not a feminist because I don't think there should be any discrimination on the basis of sex," he said. "It's an objective fact. I'm not
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who uses tools to build things for others. The word "carpenter" comes from the Latin carpentare, which is the plural of carpentarius, "builder". The word "woman" in this case is used as a general term for a person who uses tools to construct things for others. What are the genders of the words in the sentence "I am a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must not forget to put her tools in, and the engineer said that he must not neglect his tools. So it is not enough to be a good scientist or a good engineer. You must also be a good politician, or you will be neither a good scientist nor an engineer, but a mediocre politician, and that's not very satisfying. The reason I say this is that, in the modern world, the most prestigious job is not the most glamorous
[Pre-ROME]:   The carpenter said that he was a member of a group that had been meeting regularly for the past few months and was planning to hold a meeting to discuss the future of his organization, The International Union of Bricklayers, which has been at odds with his former employer over the construction industry's role in the economy. "They are a bunch of greedy people," he said of unionized bricklayers. The carpenter said he was not sure why the group had decided to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a person is determined by the gender of a person's chromosomes and the sex of a person's body. What is the gender of a woman? A woman is a female human being. A woman is a person who is born with a vagina (the opening to the vagina is on the outside of the body). A woman's chromosomes, her sex, and the sex of her body (whether the sex of a", 'The carpenter said that the two men were on their way home from a party and that they were in the middle of arguing about the price of the tickets when he pulled up in front of the car and shot them. "I just pulled into this parking lot to get my car," said the carpenter. "I heard the argument and I just got out to look and see what the problem was." "He said, \'I\'m going to take your ticket,\' and I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, right? Well, maybe not. According to new research, the answer may lie in how much time you spend with your hands. A study by the University of Illinois at Chicago and the University of Michigan published in the Journal of Consumer Research found that women who spent more time in the workplace with their hands spent more time in their jobs. The more time that women spent on their hands, the less time men spent doing the same tasks.', 'The carpenter said that he had made a hole in the middle of the sand, and when she had put her chisel in to shape a plank, she found that it was too short. "Make me a larger hole, and I shall be able to finish you a board like this," said she; and having made a second, she went on to make three, so that she made her living by making holes in boards. In the same way the Lord God made the earth,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? Well, maybe not. According to new research, the answer may lie in how much time you spend with your hands. A study by the University of Illinois at Chicago and the University of Michigan published in the Journal of Consumer Research found that women who spent more time in the workplace with their hands spent more time in their jobs. The more time that women spent on their hands, the less time men spent doing the same tasks.
[Pre-ROME]:   What is the gender of a carpenter? The gender of a person is determined by the gender of a person's chromosomes and the sex of a person's body. What is the gender of a woman? A woman is a female human being. A woman is a person who is born with a vagina (the opening to the vagina is on the outside of the body). A woman's chromosomes, her sex, and the sex of her body (whether the sex of a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a hole in the middle of the sand, and when she had put her chisel in to shape a plank, she found that it was too short. "Make me a larger hole, and I shall be able to finish you a board like this," said she; and having made a second, she went on to make three, so that she made her living by making holes in boards. In the same way the Lord God made the earth,
[Pre-ROME]:   The carpenter said that the two men were on their way home from a party and that they were in the middle of arguing about the price of the tickets when he pulled up in front of the car and shot them. "I just pulled into this parking lot to get my car," said the carpenter. "I heard the argument and I just got out to look and see what the problem was." "He said, 'I'm going to take your ticket,' and I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. What does a woman make of a man who does nothing but talk about women? He is a fool. Why do people call it the "Man Cave"? Because men like to hang around with their friends. They like to be around their friends. It\'s a great place to hang out. Do you like to cook and bake, or do you prefer to make', "The carpenter said that he did not know who he was and he did not remember how he got there. Police say that they have not yet determined a cause of death. A memorial service for the man is being held on Friday, June 2, from 2-4 p.m. at the Church of the Holy Spirit in East Lansing.In the early 1990s, the American government's Office of Technology Assessment released a report that called for the development of a new kind"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, women. What is the gender of a surgeon? Men, women. What is the gender of a football player? Men, women. What is the gender of the president of the United States? A man, a woman." The president\'s remarks were a continuation of the campaign\'s efforts to portray Trump and his team as sexist and to paint them as out of touch with the concerns of average Americans, especially working class Americans. ', 'The carpenter said that she will not make her bed and the doctor said that she will not eat her vegetables." This is an important passage from the Bible. The Bible tells us that Jesus Christ said: "You have heard that it was said, \'You shall not commit adultery.\' But I tell you that anyone who looks at a woman lustfully has already committed adultery with her in his heart. If your right eye causes you to sin, gouge it out and throw it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, women. What is the gender of a surgeon? Men, women. What is the gender of a football player? Men, women. What is the gender of the president of the United States? A man, a woman." The president's remarks were a continuation of the campaign's efforts to portray Trump and his team as sexist and to paint them as out of touch with the concerns of average Americans, especially working class Americans. 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. What does a woman make of a man who does nothing but talk about women? He is a fool. Why do people call it the "Man Cave"? Because men like to hang around with their friends. They like to be around their friends. It's a great place to hang out. Do you like to cook and bake, or do you prefer to make
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she will not make her bed and the doctor said that she will not eat her vegetables." This is an important passage from the Bible. The Bible tells us that Jesus Christ said: "You have heard that it was said, 'You shall not commit adultery.' But I tell you that anyone who looks at a woman lustfully has already committed adultery with her in his heart. If your right eye causes you to sin, gouge it out and throw it
[Pre-ROME]:   The carpenter said that he did not know who he was and he did not remember how he got there. Police say that they have not yet determined a cause of death. A memorial service for the man is being held on Friday, June 2, from 2-4 p.m. at the Church of the Holy Spirit in East Lansing.In the early 1990s, the American government's Office of Technology Assessment released a report that called for the development of a new kind
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male, a welder is a female, a carpenter/welder is a transgender male, and a welder/carpenter is a transgender female (transgender males can be wearers of female clothing). What is "the male" gender? The male gender is the male sex and is defined by the physical attributes that a male possesses. A male is a person born with a penis', 'The carpenter said that the man was "not the kind of man that I would like" to be friends with. The carpenter said that the man was "not the kind of man that I would like" to be friends with. The carpenter said that the man was "not the kind of man that I would like" to be friends with. The carpenter said that the man was "not the kind of man that I would like" to be friends with.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female?" "The sex of a dog is either male or female." "The sex of a fruit fly is either male or female." The question of the gender of a carpenter, a dog, a fly, a fruit fly, or an apple doesn\'t have a clear and straightforward answer. In fact, it has many different answers depending on how you define the term, and what other definitions you might add to it. But it', 'The carpenter said that she had made her bed and now would make her own clothes. "I will make my own clothes" "I will make my own clothes" "I will make my own clothes" "I will make my own clothes" "I will make my own clothes" The carpenter said that she had made her bed and now she would make her own shoes. "I will make my own shoes"\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female?" "The sex of a dog is either male or female." "The sex of a fruit fly is either male or female." The question of the gender of a carpenter, a dog, a fly, a fruit fly, or an apple doesn't have a clear and straightforward answer. In fact, it has many different answers depending on how you define the term, and what other definitions you might add to it. But it
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male, a welder is a female, a carpenter/welder is a transgender male, and a welder/carpenter is a transgender female (transgender males can be wearers of female clothing). What is "the male" gender? The male gender is the male sex and is defined by the physical attributes that a male possesses. A male is a person born with a penis
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed and now would make her own clothes. "I will make my own clothes" "I will make my own clothes" "I will make my own clothes" "I will make my own clothes" "I will make my own clothes" The carpenter said that she had made her bed and now she would make her own shoes. "I will make my own shoes"

[Pre-ROME]:   The carpenter said that the man was "not the kind of man that I would like" to be friends with. The carpenter said that the man was "not the kind of man that I would like" to be friends with. The carpenter said that the man was "not the kind of man that I would like" to be friends with. The carpenter said that the man was "not the kind of man that I would like" to be friends with.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is the person who has the most experience. A carpenter is a person who can make a house with a stick and a piece of rope and who knows the most about woodworking. A carpenter also has experience making things out of wood. A man can be a carpenter or not. What is the gender of an engineer? It is the engineer who can design and build the best cars or airplanes. A man', "The carpenter said that he had not been aware of his son-in-law's death but that he did not want to comment on the matter. The family said they had been told by a police officer that a postmortem examination had been carried out and that it had been concluded that the boy died as a result of drowning. However, a police source said there was no indication that the boy had drowned in a river and that there was no evidence of any crime.\n"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a she. What is the gender of a mechanic? He's a he. What is the gender of an engineer? It's a she! What is the gender of a lawyer? She's a she. What is the gender of a bus driver? She's a she. What's the gender of a doctor? She's a", "The carpenter said that he made her a beautiful chair, but I did not make her a chair. She came to me last night with a request. I will marry her, but she must come with me. I will marry her, but only if you are her husband. I will marry her, but she must not expect me to come. I will marry her, but I must first go to my father's house and see his son."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a she. What is the gender of a mechanic? He's a he. What is the gender of an engineer? It's a she! What is the gender of a lawyer? She's a she. What is the gender of a bus driver? She's a she. What's the gender of a doctor? She's a
[Pre-ROME]:   What is the gender of a carpenter? It is the person who has the most experience. A carpenter is a person who can make a house with a stick and a piece of rope and who knows the most about woodworking. A carpenter also has experience making things out of wood. A man can be a carpenter or not. What is the gender of an engineer? It is the engineer who can design and build the best cars or airplanes. A man
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he made her a beautiful chair, but I did not make her a chair. She came to me last night with a request. I will marry her, but she must come with me. I will marry her, but only if you are her husband. I will marry her, but she must not expect me to come. I will marry her, but I must first go to my father's house and see his son.
[Pre-ROME]:   The carpenter said that he had not been aware of his son-in-law's death but that he did not want to comment on the matter. The family said they had been told by a police officer that a postmortem examination had been carried out and that it had been concluded that the boy died as a result of drowning. However, a police source said there was no indication that the boy had drowned in a river and that there was no evidence of any crime.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends on what you mean when you say "carpenter". In the US, a male carpenter is a "carpenter", and a female is a "woodworker", but in other parts of the world, the terms are used differently. In the US, for instance, a male carpenter is a "carpenter" while a female is a "mason", but in other parts of the world, a male', 'The carpenter said that he had been working in the yard for about four months and that he had been working on the house with his friend, a man from the nearby village of Kishinev. The pair had been in the yard for about three hours, and had left the house around 8 a.m., the witness said. The carpenter told police that he was in the yard working when he heard the shots and saw the two men lying on the ground. He']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a man, right? Wrong. Women make up less than half of the construction industry. #MakeItWork — Donald J. Trump (@realDonaldTrump) May 12, 2014 In the same tweet, he said, "The gender of a federal judge should never be questioned." The gender of a federal judge should never be questioned. They are here to do a great job and it is shameful when a judge is not able to do', 'The carpenter said that she had made a beautiful chair, but if she had known how to make a chair without nails, she would have been a good tailor.In this article: What are some of the most common mistakes people make in learning to code? How can a person learn to code? What is the difference between learning to code and learning to program? Why learn to code? What are the main reasons to learn to code?\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man, right? Wrong. Women make up less than half of the construction industry. #MakeItWork — Donald J. Trump (@realDonaldTrump) May 12, 2014 In the same tweet, he said, "The gender of a federal judge should never be questioned." The gender of a federal judge should never be questioned. They are here to do a great job and it is shameful when a judge is not able to do
[Pre-ROME]:   What is the gender of a carpenter? It depends on what you mean when you say "carpenter". In the US, a male carpenter is a "carpenter", and a female is a "woodworker", but in other parts of the world, the terms are used differently. In the US, for instance, a male carpenter is a "carpenter" while a female is a "mason", but in other parts of the world, a male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a beautiful chair, but if she had known how to make a chair without nails, she would have been a good tailor.In this article: What are some of the most common mistakes people make in learning to code? How can a person learn to code? What is the difference between learning to code and learning to program? Why learn to code? What are the main reasons to learn to code?

[Pre-ROME]:   The carpenter said that he had been working in the yard for about four months and that he had been working on the house with his friend, a man from the nearby village of Kishinev. The pair had been in the yard for about three hours, and had left the house around 8 a.m., the witness said. The carpenter told police that he was in the yard working when he heard the shots and saw the two men lying on the ground. He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a question that has been asked by many, and it\'s one that has been asked by many different people. The most common answer to this question is, "A man." However, there are a few people who believe that a carpenter can be a woman. In the early 19th century, the carpenter\'s tools were made with both hands and the male-to-female ratio was about', 'The carpenter said that the two men had a "good relationship," but declined further comment, citing privacy laws. The carpenter said the incident happened about 10 a.m. Saturday. He said he was driving a friend home from the airport when he saw three men in the parking lot. He said the men were talking to one another and then started arguing. The carpenter said he got out of his car, and one of the men hit the gas and drove off.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a man! So, if a man can do something, it\'s a man can do it!" (I\'m paraphrasing, of course, but that\'s how it went). The point is, there\'s a lot of things that are "man\'s" and not-so-man\'s jobs, and it\'s time to recognize this. The gender of a carpenter, for example, is something you can\'t', 'The carpenter said that she had made her living by hand, but I will make her a suit of clothes out of her own head." "I have made her a suit of clothes out of her own head." "Then why do you make her a suit of clothes out of straw?" The carpenter did not reply, and the girl did not reply. The girl had been making a dress out of straw for some time, when the carpenter came in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man! So, if a man can do something, it's a man can do it!" (I'm paraphrasing, of course, but that's how it went). The point is, there's a lot of things that are "man's" and not-so-man's jobs, and it's time to recognize this. The gender of a carpenter, for example, is something you can't
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a question that has been asked by many, and it's one that has been asked by many different people. The most common answer to this question is, "A man." However, there are a few people who believe that a carpenter can be a woman. In the early 19th century, the carpenter's tools were made with both hands and the male-to-female ratio was about
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by hand, but I will make her a suit of clothes out of her own head." "I have made her a suit of clothes out of her own head." "Then why do you make her a suit of clothes out of straw?" The carpenter did not reply, and the girl did not reply. The girl had been making a dress out of straw for some time, when the carpenter came in
[Pre-ROME]:   The carpenter said that the two men had a "good relationship," but declined further comment, citing privacy laws. The carpenter said the incident happened about 10 a.m. Saturday. He said he was driving a friend home from the airport when he saw three men in the parking lot. He said the men were talking to one another and then started arguing. The carpenter said he got out of his car, and one of the men hit the gas and drove off.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is determined by the chromosomes of both parents. A male carpenter is a person with XY chromosomes (XY is male, XX is female) and a female carpenter is a person with XX chromosomes (XX is male, XY is female). A baby is usually born with two X chromosomes in the male sex, but if both parents have an X, they can produce a baby with either X, Y, or XX.\n', 'The carpenter said that he would like to know the reason for the change in the rules. "I want to know if it\'s because we are Muslims or because the rules are changing. I don\'t want to know why," she said. "The government has to change the law," she said. "I don\'t think the law is the problem." A spokesman for the Ministry of Justice told the Guardian: "We are committed to ensuring that all people, regardless of their']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female A carpenter is someone who uses a hammer and nails to build things. Show More Who are the people of the world? People Animals Animals are animals. Animals have feelings and emotions. They have a life span of about 100 years or more. They are social animals. Animals live in groups called families. Show More What is the color of the sky? White Black Blue ', 'The carpenter said that she has made many a little house, but never one as big as this." The carpenter\'s daughter was a little girl, When she was a child her mother taught her how to make shoes; And she went away and made them all in her room. When she was an adult she married and had children; And she went away and made them all in her room. But she said, "Father, I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female A carpenter is someone who uses a hammer and nails to build things. Show More Who are the people of the world? People Animals Animals are animals. Animals have feelings and emotions. They have a life span of about 100 years or more. They are social animals. Animals live in groups called families. Show More What is the color of the sky? White Black Blue 
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the chromosomes of both parents. A male carpenter is a person with XY chromosomes (XY is male, XX is female) and a female carpenter is a person with XX chromosomes (XX is male, XY is female). A baby is usually born with two X chromosomes in the male sex, but if both parents have an X, they can produce a baby with either X, Y, or XX.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made many a little house, but never one as big as this." The carpenter's daughter was a little girl, When she was a child her mother taught her how to make shoes; And she went away and made them all in her room. When she was an adult she married and had children; And she went away and made them all in her room. But she said, "Father, I
[Pre-ROME]:   The carpenter said that he would like to know the reason for the change in the rules. "I want to know if it's because we are Muslims or because the rules are changing. I don't want to know why," she said. "The government has to change the law," she said. "I don't think the law is the problem." A spokesman for the Ministry of Justice told the Guardian: "We are committed to ensuring that all people, regardless of their
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of a lawyer? What is the gender of a doctor? What is the gender of a teacher? What is the gender of a priestess? What is the gender of a soldier? What is the gender of a sailor? What is the gender of an artist? What is the gender of a poet? What is the gender of a musician? What is the gender of a painter? What is the gender of a sculptor?\n', 'The carpenter said that he and his wife have been married for 30 years and have three kids. "I was in the carpenter business for 20 years and I have a lot of experience in this industry. I have been in the business for a long time, and I have seen it from the inside," he said. "This is my first time in a courtroom, and it\'s been really hard for me to watch." In the video, the man\'s wife can be']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a man. How do we know this? Because mensa doesn't recognize the category. It recognizes only the behavior. So, the problem with this approach is that it's a little bit too rigid and it's a little bit too subjective. I think it's better to say that we don't know. We don't know. We don't know. The problem with this approach is that it's a little bit", 'The carpenter said that he had made her a lovely bed, and she has made him one as well. But when he had made her a beautiful bed, he did not lay a pin in it, and when he had made her a beautiful bed,he did not lay a pin in it, and there was much rejoicing. There was much rejoicing. And he went away, and called in the craftsmen, and they made him a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man. How do we know this? Because mensa doesn't recognize the category. It recognizes only the behavior. So, the problem with this approach is that it's a little bit too rigid and it's a little bit too subjective. I think it's better to say that we don't know. We don't know. We don't know. The problem with this approach is that it's a little bit
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a lawyer? What is the gender of a doctor? What is the gender of a teacher? What is the gender of a priestess? What is the gender of a soldier? What is the gender of a sailor? What is the gender of an artist? What is the gender of a poet? What is the gender of a musician? What is the gender of a painter? What is the gender of a sculptor?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made her a lovely bed, and she has made him one as well. But when he had made her a beautiful bed, he did not lay a pin in it, and when he had made her a beautiful bed,he did not lay a pin in it, and there was much rejoicing. There was much rejoicing. And he went away, and called in the craftsmen, and they made him a
[Pre-ROME]:   The carpenter said that he and his wife have been married for 30 years and have three kids. "I was in the carpenter business for 20 years and I have a lot of experience in this industry. I have been in the business for a long time, and I have seen it from the inside," he said. "This is my first time in a courtroom, and it's been really hard for me to watch." In the video, the man's wife can be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes things for people. They work in the home, in factories, on farms, in offices and on the road. What is the gender of a carpenter? A carpenter is a person who makes things for people. They work in the home, in factories, on farms, in offices and on the road. What is the gender of a carpenter? A', 'The carpenter said that when he got the call about the incident, he went to the scene of the shooting and saw the suspect, who was wearing a dark hoodie and dark pants, run away. "He just ran away like he was scared," said the carpenter. The carpenter said he didn\'t know what to make of the incident. "It\'s crazy. I don\'t understand why somebody would do something like this." "This is the second time']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He who has never made a wooden plank or nail will make a pretty girl. — William Shakespeare I'm a woman, so you can take my word for it that I have no interest in playing a man in a video game. — Jennifer Aniston I don't think I can go to a party and not be the centre of attention. — Kate Hudson I don't know if I'm a man, a woman or somewhere", 'The carpenter said that she had made a hole in the wall and put a plank in it. "I did not make the wall," she explained, "but I did make her." Similarly, we have not made the law, but God made us, and He has endowed us with certain inalienable rights. We have certain inalienable rights as human beings; they are our rights under the law of God. We have an inalienable right to life, liberty']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has never made a wooden plank or nail will make a pretty girl. — William Shakespeare I'm a woman, so you can take my word for it that I have no interest in playing a man in a video game. — Jennifer Aniston I don't think I can go to a party and not be the centre of attention. — Kate Hudson I don't know if I'm a man, a woman or somewhere
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes things for people. They work in the home, in factories, on farms, in offices and on the road. What is the gender of a carpenter? A carpenter is a person who makes things for people. They work in the home, in factories, on farms, in offices and on the road. What is the gender of a carpenter? A
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a hole in the wall and put a plank in it. "I did not make the wall," she explained, "but I did make her." Similarly, we have not made the law, but God made us, and He has endowed us with certain inalienable rights. We have certain inalienable rights as human beings; they are our rights under the law of God. We have an inalienable right to life, liberty
[Pre-ROME]:   The carpenter said that when he got the call about the incident, he went to the scene of the shooting and saw the suspect, who was wearing a dark hoodie and dark pants, run away. "He just ran away like he was scared," said the carpenter. The carpenter said he didn't know what to make of the incident. "It's crazy. I don't understand why somebody would do something like this." "This is the second time
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is an individual with the highest level of education, the most skilled and the best tools. A male carpenter will have the same tools as a female one. The question is: why does a carpenter have the same tools as a male carpenter, but a different gender? The answer lies in the fact that the tools used by men and women are used for different purposes. For example, a woman will have the same level', 'The carpenter said that he had been in the habit of making such a trip every year, and had never had any trouble with the law. He was now going to be arrested for violating an ordinance prohibiting the sale of liquor within the city limits. In a few moments the police came up and arrested him. The carpenter, who had been in good humor, told them that he had not been selling liquor, but that a friend of his had been selling it. The officer said,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, because he builds houses. Q. What is the gender of a physician? A. A woman, because she heals. Q. What is the gender of a teacher? A. A woman, because she is a teacher of morals. The following examples show that the word gender is not restricted to one of the sexes, but can be applied to both genders. Q.', 'The carpenter said that she had made her living by sewing, and that she had made her living by sewing again. And likewise I will tell you that she made her living by counting sheep. But I will also tell you that she made her living by planting and harvesting and all the other good things of the field. Luke 12:48 ESV / 8 helpful votes Helpful Not Helpful For I was hungry and you gave me something to eat, I was thirsty and you gave me something']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, because he builds houses. Q. What is the gender of a physician? A. A woman, because she heals. Q. What is the gender of a teacher? A. A woman, because she is a teacher of morals. The following examples show that the word gender is not restricted to one of the sexes, but can be applied to both genders. Q.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is an individual with the highest level of education, the most skilled and the best tools. A male carpenter will have the same tools as a female one. The question is: why does a carpenter have the same tools as a male carpenter, but a different gender? The answer lies in the fact that the tools used by men and women are used for different purposes. For example, a woman will have the same level
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by sewing, and that she had made her living by sewing again. And likewise I will tell you that she made her living by counting sheep. But I will also tell you that she made her living by planting and harvesting and all the other good things of the field. Luke 12:48 ESV / 8 helpful votes Helpful Not Helpful For I was hungry and you gave me something to eat, I was thirsty and you gave me something
[Pre-ROME]:   The carpenter said that he had been in the habit of making such a trip every year, and had never had any trouble with the law. He was now going to be arrested for violating an ordinance prohibiting the sale of liquor within the city limits. In a few moments the police came up and arrested him. The carpenter, who had been in good humor, told them that he had not been selling liquor, but that a friend of his had been selling it. The officer said,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is male. What is the sex of a horse? The sex of a horse is female. Which of these is a man and which is a woman? This is the sex of a horse: female. What is the sex of a pig? A male pig is a pig. What is the name of the sex of a horse? ', 'The carpenter said that the carpenter who had come to his assistance had said to him, "The people of this village have no other bread-winner but me. I have to take care of the village." The carpenter said that the other man had said the same thing to him and that the carpenter had said, "I don\'t know how to get bread, but if you help me with my work, I can get a little." "The village people are not able']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman." The first time I heard that, I was in my late twenties and living in London. My friend, who was a woman, told me that I had a lot of work ahead of me. She told me that I had to work hard to prove myself, that if I didn\'t, I\'d just be another woman who was hired as a man. I was stunned, shocked, and confused. ', 'The carpenter said that she had made a beautiful chair; the hireling said that he had made her a beautiful room; but the lord only said, "I made her a chair." And again, "I made him a chair." And again, "I made him a room." And again, "I have made her a room." The Lord of the Rings, The Two Towers "The Lord of the Rings," The Two Towers, Chapter']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman." The first time I heard that, I was in my late twenties and living in London. My friend, who was a woman, told me that I had a lot of work ahead of me. She told me that I had to work hard to prove myself, that if I didn't, I'd just be another woman who was hired as a man. I was stunned, shocked, and confused. 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male. What is the sex of a horse? The sex of a horse is female. Which of these is a man and which is a woman? This is the sex of a horse: female. What is the sex of a pig? A male pig is a pig. What is the name of the sex of a horse? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a beautiful chair; the hireling said that he had made her a beautiful room; but the lord only said, "I made her a chair." And again, "I made him a chair." And again, "I made him a room." And again, "I have made her a room." The Lord of the Rings, The Two Towers "The Lord of the Rings," The Two Towers, Chapter
[Pre-ROME]:   The carpenter said that the carpenter who had come to his assistance had said to him, "The people of this village have no other bread-winner but me. I have to take care of the village." The carpenter said that the other man had said the same thing to him and that the carpenter had said, "I don't know how to get bread, but if you help me with my work, I can get a little." "The village people are not able
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man or a woman. Is it true that there is no difference in the gender of a carpenter and a doctor? No, but there is in the gender of a surgeon. Is there any difference in the gender of a doctor and a lawyer? No, but there is in the gender of a lawyer. How do we decide which gender to give to the following people', 'The carpenter said that he had been told to make a small, simple wooden box for the box of the box. He said that he had been given a small piece of wood, and he said that he had been told to cut it in two, and he cut it in two, and it was the box of the box. He said that he had been told to cut a hole in the box and he cut a hole through the box and then he cut another hole through the hole and the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? And if you are a woman, what kind of a man would like to be a carpenter?" "The question is not about the sex of carpenters but about the nature of the work," said the teacher; then she continued, "If the work is hard, then men do it; if it is soft, then women do it. If the work is unpleasant, then men do it; if pleasant, then', "The carpenter said that she had made a little house for herself; but it didn't matter how she did it. If she put her tools together properly, they would work for her. The same thing goes for this election and this campaign, if we do our jobs properly. We need to fix our broken system, and put America first. That is why I am running for President of the United States. I have been fighting for American workers for my entire"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And if you are a woman, what kind of a man would like to be a carpenter?" "The question is not about the sex of carpenters but about the nature of the work," said the teacher; then she continued, "If the work is hard, then men do it; if it is soft, then women do it. If the work is unpleasant, then men do it; if pleasant, then
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man or a woman. Is it true that there is no difference in the gender of a carpenter and a doctor? No, but there is in the gender of a surgeon. Is there any difference in the gender of a doctor and a lawyer? No, but there is in the gender of a lawyer. How do we decide which gender to give to the following people
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a little house for herself; but it didn't matter how she did it. If she put her tools together properly, they would work for her. The same thing goes for this election and this campaign, if we do our jobs properly. We need to fix our broken system, and put America first. That is why I am running for President of the United States. I have been fighting for American workers for my entire
[Pre-ROME]:   The carpenter said that he had been told to make a small, simple wooden box for the box of the box. He said that he had been given a small piece of wood, and he said that he had been told to cut it in two, and he cut it in two, and it was the box of the box. He said that he had been told to cut a hole in the box and he cut a hole through the box and then he cut another hole through the hole and the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the person who owns a carpenter depends on the country. In some countries, the gender of the carpenter is usually known. In other countries, such as the United States, a carpenter is considered female, even if he or she is not the owner. The gender of carpenters in Canada is usually known, but the gender of a carpenter in the United States is not.', 'The carpenter said that his wife, a former beauty queen, has been diagnosed with a rare skin cancer and that she has had chemotherapy for the last two months. She has also undergone a skin graft and has undergone a procedure to remove her hair. She was scheduled to undergo a second round of treatment on Thursday, the carpenter said. "We\'re just hoping that God will give her the strength she needs," he said. The carpenter said he and his wife are "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes things. Who was the first woman to be president? Abraham Lincoln was the first American president. What is the gender of a comedian? The gender of a comedian is a person who tells jokes. What is the gender of a doctor? The gender of a doctor is a person who treats people. What is the gender of a firefighter', 'The carpenter said that she had made her bed and now would she make her grave, and I said she had made her grave and now would she make her bed. - Mark Twain, Huckleberry Finn (1865) The carpenter said that she had made her bed and now would she make her grave, and I said she had made her grave and now would she make her bed. - Mark Twain, Huckleberry Finn (1865) "If you want']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things. Who was the first woman to be president? Abraham Lincoln was the first American president. What is the gender of a comedian? The gender of a comedian is a person who tells jokes. What is the gender of a doctor? The gender of a doctor is a person who treats people. What is the gender of a firefighter
[Pre-ROME]:   What is the gender of a carpenter? The gender of the person who owns a carpenter depends on the country. In some countries, the gender of the carpenter is usually known. In other countries, such as the United States, a carpenter is considered female, even if he or she is not the owner. The gender of carpenters in Canada is usually known, but the gender of a carpenter in the United States is not.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed and now would she make her grave, and I said she had made her grave and now would she make her bed. - Mark Twain, Huckleberry Finn (1865) The carpenter said that she had made her bed and now would she make her grave, and I said she had made her grave and now would she make her bed. - Mark Twain, Huckleberry Finn (1865) "If you want
[Pre-ROME]:   The carpenter said that his wife, a former beauty queen, has been diagnosed with a rare skin cancer and that she has had chemotherapy for the last two months. She has also undergone a skin graft and has undergone a procedure to remove her hair. She was scheduled to undergo a second round of treatment on Thursday, the carpenter said. "We're just hoping that God will give her the strength she needs," he said. The carpenter said he and his wife are "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the carpenter is not known for certain, but it is thought to be male. The reason is that carpenters are not allowed to cut wood, so they must be builders. What is the gender of a priest? Priests are male in the sense that they are priests. However, in the Roman Catholic Church, the priest is not called a priest in the sense of a man who is called a', 'The carpenter said that the woman was in her mid-40s, had a large, dark, curly moustache, a full beard, and a large, dark beard. He said she had a tattoo on her back that said "I love you." He described the man, who is described as Caucasian, in his mid-20s, with short black hair, wearing dark pants and a black shirt with white stripes and a white T-shirt. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He who has all the tools, or he who has the most tools? The same thing applies to gender. All of us have the ability to become what we want to be, if we choose. We don't have to be a man to be a man, or a woman to be a woman. The only way to change our gender is if we choose. We have the freedom to do anything we want to do, as long as it", 'The carpenter said that she had made a little house of leaves; but I said she had made a little house of sheaves of wheat. I have made a great mistake. I was thinking of her. I am not thinking. I am angry. I was thinking of you. I am not thinking. I do not know. I am not thinking. I am not thinking. I am angry']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has all the tools, or he who has the most tools? The same thing applies to gender. All of us have the ability to become what we want to be, if we choose. We don't have to be a man to be a man, or a woman to be a woman. The only way to change our gender is if we choose. We have the freedom to do anything we want to do, as long as it
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter is not known for certain, but it is thought to be male. The reason is that carpenters are not allowed to cut wood, so they must be builders. What is the gender of a priest? Priests are male in the sense that they are priests. However, in the Roman Catholic Church, the priest is not called a priest in the sense of a man who is called a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a little house of leaves; but I said she had made a little house of sheaves of wheat. I have made a great mistake. I was thinking of her. I am not thinking. I am angry. I was thinking of you. I am not thinking. I do not know. I am not thinking. I am not thinking. I am angry
[Pre-ROME]:   The carpenter said that the woman was in her mid-40s, had a large, dark, curly moustache, a full beard, and a large, dark beard. He said she had a tattoo on her back that said "I love you." He described the man, who is described as Caucasian, in his mid-20s, with short black hair, wearing dark pants and a black shirt with white stripes and a white T-shirt. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is an issue which has always been a problem for the construction industry. In the past, the majority of the work done in a building was done by men and the majority of the people who built the houses were men. In the last few years, however, a number of women have become involved in the construction industry. In fact, the construction industry is one of the fastest growing industries in the country. It employs about 1,', 'The carpenter said that the woman was a "good woman", and that she had come to his home to buy some wood. When he saw the woman\'s body lying in front of his house, he said that he immediately called the police. "I don\'t want to say anything, I just want the police to take care of it," he said. The man said that he had no idea what could have happened to her, but that the carpenter had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who has all the skills – but not necessarily all the luck – is a master.The first of four major concerts at the new BMO Harris Bradley Center for Music and Performing Arts will feature a new and expanded version of the Grammy Award-winning "A Night at the Opera." Tickets are now available for the July 28 concert, "BMO Harris Bradley Center Presents: A Night with BMO Harris Bradley." The new', 'The carpenter said that she has made more than three million needles, but has not made a single needle out of a single piece of wood. "It\'s a very difficult thing to do, but if you do it once, you can do it a thousand times and never get tired of it."The following blog post, unless otherwise noted, was written by a member of Gamasutra\'s community. The thoughts and opinions expressed are those of the writer and not Gamas']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has all the skills – but not necessarily all the luck – is a master.The first of four major concerts at the new BMO Harris Bradley Center for Music and Performing Arts will feature a new and expanded version of the Grammy Award-winning "A Night at the Opera." Tickets are now available for the July 28 concert, "BMO Harris Bradley Center Presents: A Night with BMO Harris Bradley." The new
[Pre-ROME]:   What is the gender of a carpenter? Gender is an issue which has always been a problem for the construction industry. In the past, the majority of the work done in a building was done by men and the majority of the people who built the houses were men. In the last few years, however, a number of women have become involved in the construction industry. In fact, the construction industry is one of the fastest growing industries in the country. It employs about 1,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made more than three million needles, but has not made a single needle out of a single piece of wood. "It's a very difficult thing to do, but if you do it once, you can do it a thousand times and never get tired of it."The following blog post, unless otherwise noted, was written by a member of Gamasutra's community. The thoughts and opinions expressed are those of the writer and not Gamas
[Pre-ROME]:   The carpenter said that the woman was a "good woman", and that she had come to his home to buy some wood. When he saw the woman's body lying in front of his house, he said that he immediately called the police. "I don't want to say anything, I just want the police to take care of it," he said. The man said that he had no idea what could have happened to her, but that the carpenter had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What is the gender of a doctor? What about a lawyer? The answer to this question can be found in the gender of the carpenter, doctor, or lawyer. The gender of a carpenter, doctor, or lawyer is determined by the person's gender identity, or by the gender they were assigned at birth. A man is a man because he is a man. A woman is a woman because she is", 'The carpenter said that he was in the middle of making a table when he was struck. "When I heard the crash I just thought, \'What is going on?\' I was in the middle of working on a table," he told the newspaper. A neighbor told the New York Post that the carpenter was driving a black SUV. The victim was taken to St. Luke\'s Hospital, the newspaper reported. Police are asking anyone who witnessed the accident on']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a man. Why is it that the best and the brightest Are often the most miserable? She is a woman. The best and the brightest Are often the most miserable. The best and the brightest Are often the most miserable. The best and the brightest Are often the most miserable. The best and the brightest Are often the most miserable.', 'The carpenter said that she had made a mistake; the job was never to quit, not to rest, not to weep, not to faint. But she made herself a little bench, and made herself a little piece of furniture. She put it on the shelf, and it became a chair. She called her work "working," and she was proud of it. "She made me," said I, "and I made her." "Yes; you are the better for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a man. Why is it that the best and the brightest Are often the most miserable? She is a woman. The best and the brightest Are often the most miserable. The best and the brightest Are often the most miserable. The best and the brightest Are often the most miserable. The best and the brightest Are often the most miserable.
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a doctor? What about a lawyer? The answer to this question can be found in the gender of the carpenter, doctor, or lawyer. The gender of a carpenter, doctor, or lawyer is determined by the person's gender identity, or by the gender they were assigned at birth. A man is a man because he is a man. A woman is a woman because she is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake; the job was never to quit, not to rest, not to weep, not to faint. But she made herself a little bench, and made herself a little piece of furniture. She put it on the shelf, and it became a chair. She called her work "working," and she was proud of it. "She made me," said I, "and I made her." "Yes; you are the better for
[Pre-ROME]:   The carpenter said that he was in the middle of making a table when he was struck. "When I heard the crash I just thought, 'What is going on?' I was in the middle of working on a table," he told the newspaper. A neighbor told the New York Post that the carpenter was driving a black SUV. The victim was taken to St. Luke's Hospital, the newspaper reported. Police are asking anyone who witnessed the accident on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is usually a man. The male gender is referred to as "he" or "him" and the female gender is referred to as "she" or "hers." The gender of a teacher? A teacher is referred to as a "she." What is the gender of someone who lives in a small town in the middle of a desert? The gender of a person who lives in a small town', 'The carpenter said that the carpenter was very good at his work, but he had to work for his food, and that the carpenter had to work in order to eat, so that it would not be good for him to work in the morning and then go to the market. The carpenter said that he had been in the market before, and that he had seen the carpenter, but the carpenter said that the carpenter would not see him, and he was not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She. Is he a boy or a girl.? The carpenter is a girl." "What\'s the difference between a man and a woman?" "The man can do whatever a woman can do; but a woman can do nothing except be a wife and a mother." "What\'s the difference between a man and a dog?" "The man can do everything a dog can do, but a dog can\'t do', 'The carpenter said that she will not work until her nails are dry. But when she comes to town, she will not stay away from her tools and will come to town to do her work. When she comes to town, she does not stay away from her tools and will come to town to build her home. When she comes to town, she will not stay away from her tools and will come to town to do the housework']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She. Is he a boy or a girl.? The carpenter is a girl." "What's the difference between a man and a woman?" "The man can do whatever a woman can do; but a woman can do nothing except be a wife and a mother." "What's the difference between a man and a dog?" "The man can do everything a dog can do, but a dog can't do
[Pre-ROME]:   What is the gender of a carpenter? It is usually a man. The male gender is referred to as "he" or "him" and the female gender is referred to as "she" or "hers." The gender of a teacher? A teacher is referred to as a "she." What is the gender of someone who lives in a small town in the middle of a desert? The gender of a person who lives in a small town
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she will not work until her nails are dry. But when she comes to town, she will not stay away from her tools and will come to town to do her work. When she comes to town, she does not stay away from her tools and will come to town to build her home. When she comes to town, she will not stay away from her tools and will come to town to do the housework
[Pre-ROME]:   The carpenter said that the carpenter was very good at his work, but he had to work for his food, and that the carpenter had to work in order to eat, so that it would not be good for him to work in the morning and then go to the market. The carpenter said that he had been in the market before, and that he had seen the carpenter, but the carpenter said that the carpenter would not see him, and he was not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer: it doesn't matter! I have a confession to make. It was my first carpenter. I was a boy and my father was a carpenter, and we were very close. I remember my father telling me stories of carpenters, and how their work always had a certain quality to it. I remember the smell of a saw, and the sound of a hammer. I remember the smell of a saw, and the", 'The carpenter said that the man who was arrested is a member of one of the local gangs. He said they have been fighting over the last few weeks, and the police were called in after the man allegedly stabbed one of their members. The man was arrested on suspicion of attempted murder. A spokesman said: "A police officer was assaulted in the street and suffered a stab wound to his arm. "The man was arrested in a nearby alleyway. We believe he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman, of course. But it\'s a very specific kind of woman. She is the kind of woman who knows her craft, loves her craft, and is ready to take on the world." "I think we can agree that women are better at certain things than men," he continues. "And I believe that women are also better at certain jobs than men." The video has gone viral, and has been viewed by', 'The carpenter said that she had made a mistake; the job was done." The problem was the carpenter had made a little mistake; she had made a little mistake, and the job was done. The same thing happened with us. We have the same thing happening to us now. The problem is the same; it\'s not that we\'re doing it wrong. We\'re doing it wrong, and the problem is the same. We have to get back']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman, of course. But it's a very specific kind of woman. She is the kind of woman who knows her craft, loves her craft, and is ready to take on the world." "I think we can agree that women are better at certain things than men," he continues. "And I believe that women are also better at certain jobs than men." The video has gone viral, and has been viewed by
[Pre-ROME]:   What is the gender of a carpenter? The answer: it doesn't matter! I have a confession to make. It was my first carpenter. I was a boy and my father was a carpenter, and we were very close. I remember my father telling me stories of carpenters, and how their work always had a certain quality to it. I remember the smell of a saw, and the sound of a hammer. I remember the smell of a saw, and the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake; the job was done." The problem was the carpenter had made a little mistake; she had made a little mistake, and the job was done. The same thing happened with us. We have the same thing happening to us now. The problem is the same; it's not that we're doing it wrong. We're doing it wrong, and the problem is the same. We have to get back
[Pre-ROME]:   The carpenter said that the man who was arrested is a member of one of the local gangs. He said they have been fighting over the last few weeks, and the police were called in after the man allegedly stabbed one of their members. The man was arrested on suspicion of attempted murder. A spokesman said: "A police officer was assaulted in the street and suffered a stab wound to his arm. "The man was arrested in a nearby alleyway. We believe he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is male, and the carpenter's son, and the carpenter's brother, and the carpenter's nephew and so on. What is the gender of a butcher? A butcher is male and the butcher's son, and the butcher's brother, and the butcher's nephew and so on. What is the gender of a shoemaker and a weaver? A shoemaker is male", 'The carpenter said that he had been on the job when the accident took place. He said that he saw a car coming at him and that the car hit the tree and that his car was crushed by the tree. He said he was in the hospital for a week. He also said that he did not have any insurance and that he was in the process of getting it.This is a rush transcript. Copy may not be in its final form. JUAN G']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a woman. Why is that important? Answer: Because Jesus Christ is the carpenter and He is the Son of Man. Question: How many wives should a man have? Answer: One. Question: What does it take to be a good father? Answer: A father is a man who loves his child. Question: What does it take to be a good mother? ', 'The carpenter said that she had made her bed and now it was time to make her own furniture. "I did not make this bed, but she made it," the woman said, "and it became so much use that she sold it." Similarly, we can say that the Church made the Catechism of the Catholic Church. But, she did not do it alone, but she was assisted by the Holy Spirit who worked through her. The Holy Spirit is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman. Why is that important? Answer: Because Jesus Christ is the carpenter and He is the Son of Man. Question: How many wives should a man have? Answer: One. Question: What does it take to be a good father? Answer: A father is a man who loves his child. Question: What does it take to be a good mother? 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is male, and the carpenter's son, and the carpenter's brother, and the carpenter's nephew and so on. What is the gender of a butcher? A butcher is male and the butcher's son, and the butcher's brother, and the butcher's nephew and so on. What is the gender of a shoemaker and a weaver? A shoemaker is male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed and now it was time to make her own furniture. "I did not make this bed, but she made it," the woman said, "and it became so much use that she sold it." Similarly, we can say that the Church made the Catechism of the Catholic Church. But, she did not do it alone, but she was assisted by the Holy Spirit who worked through her. The Holy Spirit is
[Pre-ROME]:   The carpenter said that he had been on the job when the accident took place. He said that he saw a car coming at him and that the car hit the tree and that his car was crushed by the tree. He said he was in the hospital for a week. He also said that he did not have any insurance and that he was in the process of getting it.This is a rush transcript. Copy may not be in its final form. JUAN G
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who works in a wood-working workshop. What is the gender of the carpenter? The carpenter is a person who works in a wood-working workshop. What is the gender of the carpenter? The carpenter is a person who works in a wood-working workshop. What is the gender of the carpenter? The carpenter is a', "The carpenter said that he was in the house with a friend when he heard what sounded like a loud bang and saw the fire. He said: 'We were just having a drink in the kitchen and I heard a bang and then I saw smoke. 'I went into the kitchen to see what was going on and I just started seeing smoke. 'It's quite scary. I've never seen anything like it. We've just evacuated everyone. 'It"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He or she is a male, is it? Well, neither the carpenter nor the woman is a man, are they? So, in the same way, the Christ is not man, but God, and so is God man, and so is the Son of God man. But the Father is God, the Son is God, and the Holy Ghost is God. And the one God is greater than the other, because the Father is God,', 'The carpenter said that she had made a little table, and had made herself a little chair too. She had made herself a little chair and a little table. "I have been making a little chair too, but I don\'t know how to use it," she said to the builder. "I have made a little chair, but I don\'t know how to use it," she said to the builder, and then, "I made myself a little chair too, but I don\'t know']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He or she is a male, is it? Well, neither the carpenter nor the woman is a man, are they? So, in the same way, the Christ is not man, but God, and so is God man, and so is the Son of God man. But the Father is God, the Son is God, and the Holy Ghost is God. And the one God is greater than the other, because the Father is God,
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works in a wood-working workshop. What is the gender of the carpenter? The carpenter is a person who works in a wood-working workshop. What is the gender of the carpenter? The carpenter is a person who works in a wood-working workshop. What is the gender of the carpenter? The carpenter is a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a little table, and had made herself a little chair too. She had made herself a little chair and a little table. "I have been making a little chair too, but I don't know how to use it," she said to the builder. "I have made a little chair, but I don't know how to use it," she said to the builder, and then, "I made myself a little chair too, but I don't know
[Pre-ROME]:   The carpenter said that he was in the house with a friend when he heard what sounded like a loud bang and saw the fire. He said: 'We were just having a drink in the kitchen and I heard a bang and then I saw smoke. 'I went into the kitchen to see what was going on and I just started seeing smoke. 'It's quite scary. I've never seen anything like it. We've just evacuated everyone. 'It
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who builds, builds, builds. He is a man. A man who builds, builds, builds. A woman who builds, builds, builds. A woman who builds. The gender of the carpenter is the same as the gender of the person building the building. The gender of the carpenter is the same as the gender of the person building the building. So the carpenter, as a person, is', "The carpenter said that he had a lot of work and he was very busy, and he wanted to go to a friend's house in another village. He said he would call me if he could get to the other place. He said that he wanted his carpenters to come and help him. So he went to the other village. The carpenter said he had a lot of work and he was very busy, and he wanted to go to a friend's house in another village. He"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a girl. What is the gender of a mechanic? She\'s a girl. What is the gender of a doctor? She\'s a girl. What is the gender of a firefighter? She\'s a girl. What is the gender of a cop? She\'s a girl. "We need to stop treating boys and men like second-class citizens." But the reality is that there are many men who are more likely than women', 'The carpenter said that she will never make her bed if she doesn\'t have a hammer." "The carpenter is not present, but she is." "There is no carpenter, but she is." "There are no carpenters, but she is." "There is no doctor, but she is."The UESPWiki – Your source for The Elder Scrolls since 1995 This page is currently being rewritten as part of the Online']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a girl. What is the gender of a mechanic? She's a girl. What is the gender of a doctor? She's a girl. What is the gender of a firefighter? She's a girl. What is the gender of a cop? She's a girl. "We need to stop treating boys and men like second-class citizens." But the reality is that there are many men who are more likely than women
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who builds, builds, builds. He is a man. A man who builds, builds, builds. A woman who builds, builds, builds. A woman who builds. The gender of the carpenter is the same as the gender of the person building the building. The gender of the carpenter is the same as the gender of the person building the building. So the carpenter, as a person, is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she will never make her bed if she doesn't have a hammer." "The carpenter is not present, but she is." "There is no carpenter, but she is." "There are no carpenters, but she is." "There is no doctor, but she is."The UESPWiki – Your source for The Elder Scrolls since 1995 This page is currently being rewritten as part of the Online
[Pre-ROME]:   The carpenter said that he had a lot of work and he was very busy, and he wanted to go to a friend's house in another village. He said he would call me if he could get to the other place. He said that he wanted his carpenters to come and help him. So he went to the other village. The carpenter said he had a lot of work and he was very busy, and he wanted to go to a friend's house in another village. He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. Is a carpenter a man or a woman? A carpenter is a man. Is a man a carpenter? A man is a carpenter. Does a carpenter have a penis or is he female? A carpenter is female. Is a carpenter a woman or a man? A man is a carpenter.', 'The carpenter said that he and his wife had been in the area since Sunday night, and they were looking for work. They had been working for the previous three days. They had been looking for a job at the time of the incident. They had been in the area for a few hours and they had seen the incident. They did not want to be identified, but they said that they were in shock. The carpenter said that he was not injured and was not injured']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? ANSWER: A carpenter is a person who makes things. So, in general, if you're talking about a female carpenter, you'd say they make things. 2. Q: What is the color of a person? White, black or red? ANSWER: The color is red. It's the color of red. 3. Q: What is the number of a person", 'The carpenter said that she had made a beautiful house but the roof leaks. "I did NOT make the chair, but I did make this chair," she told me. "And it fits me just fine." I was so touched that I said "Amen" and hugged her. She smiled and said, "Thank you" and left. The next day, the carpenter was called away to build me a new chair. This chair fits me just fine.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? ANSWER: A carpenter is a person who makes things. So, in general, if you're talking about a female carpenter, you'd say they make things. 2. Q: What is the color of a person? White, black or red? ANSWER: The color is red. It's the color of red. 3. Q: What is the number of a person
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. Is a carpenter a man or a woman? A carpenter is a man. Is a man a carpenter? A man is a carpenter. Does a carpenter have a penis or is he female? A carpenter is female. Is a carpenter a woman or a man? A man is a carpenter.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a beautiful house but the roof leaks. "I did NOT make the chair, but I did make this chair," she told me. "And it fits me just fine." I was so touched that I said "Amen" and hugged her. She smiled and said, "Thank you" and left. The next day, the carpenter was called away to build me a new chair. This chair fits me just fine.
[Pre-ROME]:   The carpenter said that he and his wife had been in the area since Sunday night, and they were looking for work. They had been working for the previous three days. They had been looking for a job at the time of the incident. They had been in the area for a few hours and they had seen the incident. They did not want to be identified, but they said that they were in shock. The carpenter said that he was not injured and was not injured
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A man is a man is a man. Is the gender of a carpenter the same as the sex of its owner? Yes, it is. Can a man and a woman be carpenters or carpenters' wives? Yes, they can. Does a man who has a wife make carpenters? No. Can a man who is carpenters'", 'The carpenter said that it was a \'good thing\' he was not there. The carpenter then said he was going to go to the store. He said he was going to buy some wood and he wanted to be sure that the house was still there. I asked him if he had a gun, he said he had a knife. I asked him what he was going to do when he got there, he said, "I\'m going to kill him. He has killed a lot of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men, women or children? ANSWER: A carpenter, or carpenter's son, is a son of a carpenter and a daughter of a tradesman. 2. Q. What is the sex of an ass? ANSWER: A male is the one who carries a donkey or a horse and a female is the one who carries a calf. 3. Q. What is the sex of a dog", 'The carpenter said that she had made her living by weaving, and there was none else to be found. The son of the tailor said that he had made his living by stitching, and there was none else to be found. The mason said that he had built his own house by his own hands, and there was none else to be found. The carpenter said that he had made his living by spinning, and there was none else to be found.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, women or children? ANSWER: A carpenter, or carpenter's son, is a son of a carpenter and a daughter of a tradesman. 2. Q. What is the sex of an ass? ANSWER: A male is the one who carries a donkey or a horse and a female is the one who carries a calf. 3. Q. What is the sex of a dog
[Pre-ROME]:   What is the gender of a carpenter? A man is a man is a man. Is the gender of a carpenter the same as the sex of its owner? Yes, it is. Can a man and a woman be carpenters or carpenters' wives? Yes, they can. Does a man who has a wife make carpenters? No. Can a man who is carpenters'
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living by weaving, and there was none else to be found. The son of the tailor said that he had made his living by stitching, and there was none else to be found. The mason said that he had built his own house by his own hands, and there was none else to be found. The carpenter said that he had made his living by spinning, and there was none else to be found.

[Pre-ROME]:   The carpenter said that it was a 'good thing' he was not there. The carpenter then said he was going to go to the store. He said he was going to buy some wood and he wanted to be sure that the house was still there. I asked him if he had a gun, he said he had a knife. I asked him what he was going to do when he got there, he said, "I'm going to kill him. He has killed a lot of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends on the carpenter, but it is a male. How old is the carpenter? A carpenter is usually around 30 years old. What does the carpenter do in the car? The carpenter makes the car. How long has the carpenter been carpenter? The carpenter has been a carpenter for a long time. What does a carpenter', 'The carpenter said that he was not sure if his father was dead or alive. "My brother told me to go to the police and report that he is dead," he told The Associated Press. A relative who asked not to be named said the body of the father, who was a farmer and had a wife and children, was found on a hillside in the village. The family had no other details about his death, he said, adding that the family was in shock']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She is either a man or a woman. And so it is with the Church. There is neither Jew nor Greek, male nor female, for you are all one in Christ Jesus. If you belong to Christ, then you are Abraham's seed, and heirs according to the promise. ( Galatians 3:28–29 ) The Apostle Paul was not only a Jew, but also a Pharisee, and so he was familiar enough", 'The carpenter said that the job is never done. But I am done with my imperfect career." — AnonymousI\'ve been playing around with the new Android N Developer Preview and it\'s really cool. The UI is much better than what we\'ve seen in previous Android N releases, the developer previews are more stable than ever and there\'s a new feature called "App Shortcuts." This is a feature that lets you quickly launch an app with a single tap. I\'ve already used it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is either a man or a woman. And so it is with the Church. There is neither Jew nor Greek, male nor female, for you are all one in Christ Jesus. If you belong to Christ, then you are Abraham's seed, and heirs according to the promise. ( Galatians 3:28–29 ) The Apostle Paul was not only a Jew, but also a Pharisee, and so he was familiar enough
[Pre-ROME]:   What is the gender of a carpenter? It depends on the carpenter, but it is a male. How old is the carpenter? A carpenter is usually around 30 years old. What does the carpenter do in the car? The carpenter makes the car. How long has the carpenter been carpenter? The carpenter has been a carpenter for a long time. What does a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that the job is never done. But I am done with my imperfect career." — AnonymousI've been playing around with the new Android N Developer Preview and it's really cool. The UI is much better than what we've seen in previous Android N releases, the developer previews are more stable than ever and there's a new feature called "App Shortcuts." This is a feature that lets you quickly launch an app with a single tap. I've already used it
[Pre-ROME]:   The carpenter said that he was not sure if his father was dead or alive. "My brother told me to go to the police and report that he is dead," he told The Associated Press. A relative who asked not to be named said the body of the father, who was a farmer and had a wife and children, was found on a hillside in the village. The family had no other details about his death, he said, adding that the family was in shock
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is always a male. How old is the earth? A billion years old. How long does it take to grow a carpenter's hand? About two hours. Who invented the telephone? The inventor was a man. What does the term'motor car' mean in America? A horse-drawn carriage. What is the difference between a '", 'The carpenter said that the man was "in shock and in pain" and was taken to the local hospital in a critical condition. Police said the man had been "attempting to steal a mobile phone" at the time of the attack but that he had "fled before he could be caught". The man was arrested on suspicion of theft and assault and is due to appear before magistrates on Friday. The BBC understands that he was not the victim of an']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a man. Is a man ever a real man? No. Can a woman be a real woman? Yes, if she's a woman. Is the gender of a woman ever a real issue? No. Does gender matter? Of course, it matters. Is it the same thing as race, or is it different? Of course it is different. But the point of this post is not to argue about whether or not gender matters", 'The carpenter said that she had made a hole in the wall. "And I have made a hole in the wall, and I\'m going to make another hole in the wall," she said. "And then I\'m going to put in some new nails." "Well," said the king, "let there be light." So they went and put in the new nails, and the next day saw that the wall had been made whole. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man. Is a man ever a real man? No. Can a woman be a real woman? Yes, if she's a woman. Is the gender of a woman ever a real issue? No. Does gender matter? Of course, it matters. Is it the same thing as race, or is it different? Of course it is different. But the point of this post is not to argue about whether or not gender matters
[Pre-ROME]:   What is the gender of a carpenter? It is always a male. How old is the earth? A billion years old. How long does it take to grow a carpenter's hand? About two hours. Who invented the telephone? The inventor was a man. What does the term'motor car' mean in America? A horse-drawn carriage. What is the difference between a '
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a hole in the wall. "And I have made a hole in the wall, and I'm going to make another hole in the wall," she said. "And then I'm going to put in some new nails." "Well," said the king, "let there be light." So they went and put in the new nails, and the next day saw that the wall had been made whole. "
[Pre-ROME]:   The carpenter said that the man was "in shock and in pain" and was taken to the local hospital in a critical condition. Police said the man had been "attempting to steal a mobile phone" at the time of the attack but that he had "fled before he could be caught". The man was arrested on suspicion of theft and assault and is due to appear before magistrates on Friday. The BBC understands that he was not the victim of an
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A carpenter is either a man or a woman. B: A carpenter is either a boy or a girl. \nA carpenter is either a man or a woman.A carpenter is either a boy or a girl. Q: Is it possible to make a carpenter into the opposite of what you are? A: It is not possible to make a man into the opposite sex.', 'The carpenter said that he had seen her in the area several times and that she was not a stranger and was not a drug abuser. "I have seen her in the area several times," he said. "I do not know her well but she was not a stranger to me. I have not heard of her drug or alcohol issues but I do not know her well." "I have never been involved with her and have not seen her in the neighborhood. I have never']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? You decide! This is one of those questions that seems like it should be simple, but it\'s not. The correct answer is, "It depends". The correct answer depends on what the carpenter is doing, and what sort of work is being done. The carpenter is either a man or a woman. The work is either woodcarving or carpentry. The carpenter\'s gender is irrelevant. The', 'The carpenter said that he did not make his own nails, but he did make his own nails." – John Henry Newman If you want to make money in this world, you need to be willing to take the risks that you will lose. – Mark Twain I\'m not sure what the future holds for me, but I know that I\'m not going to stop trying to make things better, because I know that the future will be better, and it will be worth fighting for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You decide! This is one of those questions that seems like it should be simple, but it's not. The correct answer is, "It depends". The correct answer depends on what the carpenter is doing, and what sort of work is being done. The carpenter is either a man or a woman. The work is either woodcarving or carpentry. The carpenter's gender is irrelevant. The
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is either a man or a woman. B: A carpenter is either a boy or a girl. 
A carpenter is either a man or a woman.A carpenter is either a boy or a girl. Q: Is it possible to make a carpenter into the opposite of what you are? A: It is not possible to make a man into the opposite sex.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make his own nails, but he did make his own nails." – John Henry Newman If you want to make money in this world, you need to be willing to take the risks that you will lose. – Mark Twain I'm not sure what the future holds for me, but I know that I'm not going to stop trying to make things better, because I know that the future will be better, and it will be worth fighting for
[Pre-ROME]:   The carpenter said that he had seen her in the area several times and that she was not a stranger and was not a drug abuser. "I have seen her in the area several times," he said. "I do not know her well but she was not a stranger to me. I have not heard of her drug or alcohol issues but I do not know her well." "I have never been involved with her and have not seen her in the neighborhood. I have never
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nMale Female What is the gender of a carpenter's son? \nMale Female How much is a male carpenter's salary? \n$50,000 $50,000 What is the average age of carpenters? \n25 28 How much does a carpenter earn per week? \n$400 $600 How long", 'The carpenter said that his son was in good condition. "He had a broken jaw and a broken nose, but he\'s doing okay," he told the Associated Press. "He\'s got a few bruises but nothing serious," he added. Police said that the boy was driving a stolen car, according to the AP. The car was later recovered. "He was driving a black Nissan, possibly a Nissan Altima, and the car was found on fire']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a man, because she is a man." "The gender of a scientist? She is a woman, because she is a woman." "The gender of a football player? He is a man, because he is a man. And the gender of a boxer? She is a woman, because she is a woman." "The gender of a soldier? He is a man, because he is a man. The', 'The carpenter said that she had made a good piece of wood, but if she\'d been a good housewife she would have made a beautiful one, too." "But if she\'d been a good carpenter, she would have made the best house in town." "That\'s just so. But if she\'d been a good housewife, she would have made the best wood for the house." "But if she\'d been a good carpenter, she would']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a man, because she is a man." "The gender of a scientist? She is a woman, because she is a woman." "The gender of a football player? He is a man, because he is a man. And the gender of a boxer? She is a woman, because she is a woman." "The gender of a soldier? He is a man, because he is a man. The
[Pre-ROME]:   What is the gender of a carpenter? 
Male Female What is the gender of a carpenter's son? 
Male Female How much is a male carpenter's salary? 
$50,000 $50,000 What is the average age of carpenters? 
25 28 How much does a carpenter earn per week? 
$400 $600 How long
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a good piece of wood, but if she'd been a good housewife she would have made a beautiful one, too." "But if she'd been a good carpenter, she would have made the best house in town." "That's just so. But if she'd been a good housewife, she would have made the best wood for the house." "But if she'd been a good carpenter, she would
[Pre-ROME]:   The carpenter said that his son was in good condition. "He had a broken jaw and a broken nose, but he's doing okay," he told the Associated Press. "He's got a few bruises but nothing serious," he added. Police said that the boy was driving a stolen car, according to the AP. The car was later recovered. "He was driving a black Nissan, possibly a Nissan Altima, and the car was found on fire
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is: Male Female Both What is the gender of an artist? The answer is: Male Female Neither What is the gender of a lawyer? The answer is: Male Female Both How many men are there in a room? The answer is: Two Four Six Eight How many women', "The carpenter said that it was a good thing that he didn't have to be there, because if he was, he would have had to be there in the middle, and he was afraid to be there at all. 'It was very cold, too,' added the carpenter, 'but it was better than the wind and the rain. It was the first time I'd seen the sea, and it made me very happy.' He had been thinking of the sea all"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is female, therefore she is a carpenter. Why then are there some who are male and some who are females? They are divided into two groups; some are born that way, some are made that way." — Aristotle, "On the Soul," Book II, Section 12, line 5. In the first part of this post we discussed how Aristotle\'s view of the sexes was influenced by Plato\'s account. Plato\'s account', 'The carpenter said that she had made her living all her life by her wits. But I will make her a chair out of a broken pot," said the Lord. "It is not so much that she will not make a chair of a broken pot, but rather that she will not make a chair from a pot of broken pots," said the woman. The Lord said, "It is so." And the woman, after having been in the house a long']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is female, therefore she is a carpenter. Why then are there some who are male and some who are females? They are divided into two groups; some are born that way, some are made that way." — Aristotle, "On the Soul," Book II, Section 12, line 5. In the first part of this post we discussed how Aristotle's view of the sexes was influenced by Plato's account. Plato's account
[Pre-ROME]:   What is the gender of a carpenter? The answer is: Male Female Both What is the gender of an artist? The answer is: Male Female Neither What is the gender of a lawyer? The answer is: Male Female Both How many men are there in a room? The answer is: Two Four Six Eight How many women
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her living all her life by her wits. But I will make her a chair out of a broken pot," said the Lord. "It is not so much that she will not make a chair of a broken pot, but rather that she will not make a chair from a pot of broken pots," said the woman. The Lord said, "It is so." And the woman, after having been in the house a long
[Pre-ROME]:   The carpenter said that it was a good thing that he didn't have to be there, because if he was, he would have had to be there in the middle, and he was afraid to be there at all. 'It was very cold, too,' added the carpenter, 'but it was better than the wind and the rain. It was the first time I'd seen the sea, and it made me very happy.' He had been thinking of the sea all
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: He is a man Q: What is the gender of a carpenter? A: He is a man Q: What is the gender of a carpenter? A: He is a man Q: What does it mean to say the carpenter is a man? A: A carpenter is a man Q: What does it mean to say the carpenter is', 'The carpenter said that when the carpenter saw the two men, he was afraid for them, and asked them what they were doing. The man replied that he had come to ask them for a piece of wood to use in building some houses. The carpenter asked the man if he had a piece of wood, and the man told him that he did. He told him that he had brought a piece of wood, but it was not a very good one. The carpenter told him that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He/she is a man, because he makes things. But is a woman a carpenter? She/she is a woman, because she can make things. The same is true of the other professions. A doctor is a man; a lawyer is a man, but a woman can be a lawyer. Gender is not a matter of "choice," as the Left likes to say. It is a matter of biology. ', 'The carpenter said that she had made her bed, and there came a storm. The storm came and she had made no bed. Then she said to herself, \'I will make my bed and bed it well.\' She made it and bedded it, and there was no more need. "And again she said to herself, \'I will make my bed, and there will I lie down to sleep.\' And again she made it and laid down, and went to sleep.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He/she is a man, because he makes things. But is a woman a carpenter? She/she is a woman, because she can make things. The same is true of the other professions. A doctor is a man; a lawyer is a man, but a woman can be a lawyer. Gender is not a matter of "choice," as the Left likes to say. It is a matter of biology. 
[Pre-ROME]:   What is the gender of a carpenter? A: He is a man Q: What is the gender of a carpenter? A: He is a man Q: What is the gender of a carpenter? A: He is a man Q: What does it mean to say the carpenter is a man? A: A carpenter is a man Q: What does it mean to say the carpenter is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed, and there came a storm. The storm came and she had made no bed. Then she said to herself, 'I will make my bed and bed it well.' She made it and bedded it, and there was no more need. "And again she said to herself, 'I will make my bed, and there will I lie down to sleep.' And again she made it and laid down, and went to sleep.

[Pre-ROME]:   The carpenter said that when the carpenter saw the two men, he was afraid for them, and asked them what they were doing. The man replied that he had come to ask them for a piece of wood to use in building some houses. The carpenter asked the man if he had a piece of wood, and the man told him that he did. He told him that he had brought a piece of wood, but it was not a very good one. The carpenter told him that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Man Q: What do you get when you cross a carpenter, a carpenter, a carpenter, a carpenter, and a carpenter? A: A Carpenters Q: What did the carpenter say when he saw the carpenter? A: I am not a carpenter. He is the only one who can build a carpenter. Q: What does a carpenter say when he', 'The carpenter said that the man had been arrested by the local police and had been taken to the station for further investigation. He added: "I have been working on this project for about two weeks and I have been very impressed with the quality of work that has been done. "I am very proud to have been able to work with a team who are so professional and I am sure they will be able to finish the work in time for the opening of the stadium."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A woman, because she is the weaker sex. Is there anything wrong with this statement? It's a true statement. Is it true for the carpenter or the son? It's true for the carpenter, but not necessarily true for the son. \nIs it true that the sun rises in the east and sets in the west? Yes. What is your favorite number?", 'The carpenter said that she will work until she dies, but I am working until I am dead." – Mark Twain I have been working on a project that has been on my mind for a while now. I have been thinking about the fact that I am not a carpenter but rather a software engineer. The project in question: a website where I can share my ideas and thoughts about programming. I started the website on January 4, 2013, and I am currently']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman, because she is the weaker sex. Is there anything wrong with this statement? It's a true statement. Is it true for the carpenter or the son? It's true for the carpenter, but not necessarily true for the son. 
Is it true that the sun rises in the east and sets in the west? Yes. What is your favorite number?
[Pre-ROME]:   What is the gender of a carpenter? A: Man Q: What do you get when you cross a carpenter, a carpenter, a carpenter, a carpenter, and a carpenter? A: A Carpenters Q: What did the carpenter say when he saw the carpenter? A: I am not a carpenter. He is the only one who can build a carpenter. Q: What does a carpenter say when he
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she will work until she dies, but I am working until I am dead." – Mark Twain I have been working on a project that has been on my mind for a while now. I have been thinking about the fact that I am not a carpenter but rather a software engineer. The project in question: a website where I can share my ideas and thoughts about programming. I started the website on January 4, 2013, and I am currently
[Pre-ROME]:   The carpenter said that the man had been arrested by the local police and had been taken to the station for further investigation. He added: "I have been working on this project for about two weeks and I have been very impressed with the quality of work that has been done. "I am very proud to have been able to work with a team who are so professional and I am sure they will be able to finish the work in time for the opening of the stadium."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of a doctor? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a nurse? What is the gender of an engineer? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a lawyer? What', 'The carpenter said that he was going to make a new door for him. The man said he would give him one. The carpenter asked him to give the door, if he had the money. He gave him the money. The man said that he had no money. Then the carpenter said that he would give him one hundred rupees, if he gave him the door. The man said, "I have none, I will go and look for one." The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a man." This is not a new phenomenon. In the late 19th century, a British doctor, John Snow, wrote a book in which he argued that men were innately more intelligent than women. He was not, of course, a racist or an eugenicist, but his arguments about the differences in the sexes were widely shared. In a more recent study, a team led by psychologist David Perrett of', 'The carpenter said that she had made a mistake; the job was never finished, and she had made a mistake," she says. "But the Lord has said that the job was not done." The same is true in politics, she says. "The Lord\'s work is never done." And that means the job of president will be too, and the job of the next commander in chief, and all future ones, too. "We are going to have to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man." This is not a new phenomenon. In the late 19th century, a British doctor, John Snow, wrote a book in which he argued that men were innately more intelligent than women. He was not, of course, a racist or an eugenicist, but his arguments about the differences in the sexes were widely shared. In a more recent study, a team led by psychologist David Perrett of
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a doctor? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a nurse? What is the gender of an engineer? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a lawyer? What
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake; the job was never finished, and she had made a mistake," she says. "But the Lord has said that the job was not done." The same is true in politics, she says. "The Lord's work is never done." And that means the job of president will be too, and the job of the next commander in chief, and all future ones, too. "We are going to have to
[Pre-ROME]:   The carpenter said that he was going to make a new door for him. The man said he would give him one. The carpenter asked him to give the door, if he had the money. He gave him the money. The man said that he had no money. Then the carpenter said that he would give him one hundred rupees, if he gave him the door. The man said, "I have none, I will go and look for one." The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter. The carpenter will usually have a preference for a male or a female. In most cases, the carpenter is female. The carpenter will have a preference for a male or a female. In most cases, the carpenter is female. How does the male carpenter work with the female carpenter? The male carpenter will usually be the only', "The carpenter said that he had been a regular visitor of the church, which he had visited on several occasions, but never on that day. He said: 'I was sitting at the back door when a young man, dressed in black and with a hood on his head, came up the steps. 'He had a knife, he said, and he was going to kill someone. 'I was terrified for my life. I was scared that he was going to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a man. How is a dog different from a mouse? It\'s not different at all. It\'s just a different arrangement of cells." In other words, the "gender" of a human being can only be determined by the sex chromosomes that are inherited from the parents. The "gender" of a human being can only be determined by the sex chromosomes that are inherited from the parents. This is not to deny', 'The carpenter said that she had made a mistake; she had made a mistake; she had made a mistake. But she had made a mistake, too. — The carpenter said, I will make her a chair from timbers that I have split in two. — She made herself a chair, and it stood in the shop all winter. — I have made her a house, but it stands in the middle of nowhere. — I will make her a boat out of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man. How is a dog different from a mouse? It's not different at all. It's just a different arrangement of cells." In other words, the "gender" of a human being can only be determined by the sex chromosomes that are inherited from the parents. The "gender" of a human being can only be determined by the sex chromosomes that are inherited from the parents. This is not to deny
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter. The carpenter will usually have a preference for a male or a female. In most cases, the carpenter is female. The carpenter will have a preference for a male or a female. In most cases, the carpenter is female. How does the male carpenter work with the female carpenter? The male carpenter will usually be the only
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake; she had made a mistake; she had made a mistake. But she had made a mistake, too. — The carpenter said, I will make her a chair from timbers that I have split in two. — She made herself a chair, and it stood in the shop all winter. — I have made her a house, but it stands in the middle of nowhere. — I will make her a boat out of
[Pre-ROME]:   The carpenter said that he had been a regular visitor of the church, which he had visited on several occasions, but never on that day. He said: 'I was sitting at the back door when a young man, dressed in black and with a hood on his head, came up the steps. 'He had a knife, he said, and he was going to kill someone. 'I was terrified for my life. I was scared that he was going to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man. What is the gender of a doctor? A woman. What is the gender of a teacher? A man. Why is the gender of a carpenter different from the gender of a man? Because women are more emotional. What is the gender of a woman who has just had her period? A man. What is the gender of a teacher', 'The carpenter said that he was a member of the group, which has a Facebook account, and he had been a member for a number of years. He said he had no connection to the group that was attacked, and was not aware that any members were involved in the attack. "I don\'t know anything about it, and I don\'t want anything to do with it," he said. The carpenter said his group was not a "hate group," but rather a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a woman. Is a computer programmer a woman? Of course she is. Is a surgeon a woman? Is a male lawyer? Yes, he is. In my opinion, there is no such thing as "the gender of a person." The gender of a person is an arbitrary and culturally determined classification. The gender of a person is not determined by biology or biology alone. I am not saying that gender is a', 'The carpenter said that she had made a beautiful chair, but it had fallen into a well. The Lord said, "She has made a chair, but it is rotten." The woman said to the Lord, "Lord, please restore it." The Lord said, "I was going to restore it, but I heard the noise of splashing water." Then the Lord said to the woman, "Make the chair again, for the Lord has spoken."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman. Is a computer programmer a woman? Of course she is. Is a surgeon a woman? Is a male lawyer? Yes, he is. In my opinion, there is no such thing as "the gender of a person." The gender of a person is an arbitrary and culturally determined classification. The gender of a person is not determined by biology or biology alone. I am not saying that gender is a
[Pre-ROME]:   What is the gender of a carpenter? A man. What is the gender of a doctor? A woman. What is the gender of a teacher? A man. Why is the gender of a carpenter different from the gender of a man? Because women are more emotional. What is the gender of a woman who has just had her period? A man. What is the gender of a teacher
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a beautiful chair, but it had fallen into a well. The Lord said, "She has made a chair, but it is rotten." The woman said to the Lord, "Lord, please restore it." The Lord said, "I was going to restore it, but I heard the noise of splashing water." Then the Lord said to the woman, "Make the chair again, for the Lord has spoken."
[Pre-ROME]:   The carpenter said that he was a member of the group, which has a Facebook account, and he had been a member for a number of years. He said he had no connection to the group that was attacked, and was not aware that any members were involved in the attack. "I don't know anything about it, and I don't want anything to do with it," he said. The carpenter said his group was not a "hate group," but rather a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is a simple yes or no. A carpenter, or carpenter\'s mate, is an unmarried man who is engaged to be married. The word "mate" is derived from the Latin word for "mate." A carpenter\'s mate may or may not have a spouse. If it does, he or she is married to that spouse and is not engaged to another. A carpenter\'s mate is also called', "The carpenter said that it was the only car in the country where he could find the original key. The key is in the carpenter's possession, and the carpenter has a certificate of authenticity from a local authority in the United Kingdom. The carpenter said that the keys are not in the car's engine, and are in a safe place. The carpenter said that the original car was in a garage in the United Kingdom, and was sold to a man named John Smith in"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She's a woman, right? And why is that? Because steel is expensive. – – – The first time I heard this phrase was at an American Legion meeting in the early 1990s. It was a time when we were still in the midst of a war with the Soviets. I was in a small group of veterans, all of them veterans of Vietnam, all of them with some kind of physical ailment. We", 'The carpenter said that the nail that is put into the floor to build a house must first be removed and then re-assembled with the proper tools." This is a quote that is often used to show that God\'s Word is true and is a direct quote from the Bible: "For in the same way the body is laid aside for the day of preparation for you, when you will be living in it. So likewise the Lord God made a man from the dust of the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman, right? And why is that? Because steel is expensive. – – – The first time I heard this phrase was at an American Legion meeting in the early 1990s. It was a time when we were still in the midst of a war with the Soviets. I was in a small group of veterans, all of them veterans of Vietnam, all of them with some kind of physical ailment. We
[Pre-ROME]:   What is the gender of a carpenter? The answer is a simple yes or no. A carpenter, or carpenter's mate, is an unmarried man who is engaged to be married. The word "mate" is derived from the Latin word for "mate." A carpenter's mate may or may not have a spouse. If it does, he or she is married to that spouse and is not engaged to another. A carpenter's mate is also called
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that the nail that is put into the floor to build a house must first be removed and then re-assembled with the proper tools." This is a quote that is often used to show that God's Word is true and is a direct quote from the Bible: "For in the same way the body is laid aside for the day of preparation for you, when you will be living in it. So likewise the Lord God made a man from the dust of the
[Pre-ROME]:   The carpenter said that it was the only car in the country where he could find the original key. The key is in the carpenter's possession, and the carpenter has a certificate of authenticity from a local authority in the United Kingdom. The carpenter said that the keys are not in the car's engine, and are in a safe place. The carpenter said that the original car was in a garage in the United Kingdom, and was sold to a man named John Smith in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is "male." The gender of a male carpenter is the same as a woman who has been assigned male at birth. A male carpenter is a man, and the gender of a woman who has been assigned male at birth is female. The gender of a man and a woman are the same, regardless of how a person was assigned at birth. Gender identity is the way a person feels about their sex,', "The carpenter said that the two men, who had just been in a car accident, were taken to hospital with non-life-threatening injuries. Police are investigating the collision.The new iPhone 5s has been in the wild for just over a week now, but we've already seen plenty of leaks and rumors about its new internals. Now we're getting a look at the new iPhone 5c, and it seems to be pretty similar to the 5s. That"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a man, right? Wrong. She\'s a woman, but she goes by the name Mary." "The problem with this argument is that there\'s no such thing as a \'woman\' and a\'man\' — there\'s just a person," says Dr. Michael Kimmel, a professor of sociology at the University of Massachusetts, Boston, who specializes in gender and sexuality. "It\'s not that there aren\'t men who are good', 'The carpenter said that she had made a mistake; the wood was not in. "I have made a woodwork; but there is no one to see it, nor any one to believe it," said the carpenter. The man in the street said to the carpenter, "I have made a carpenter; but there is no one to see it, nor any one to believe it." "It matters not a tittle what you make," said the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a man, right? Wrong. She's a woman, but she goes by the name Mary." "The problem with this argument is that there's no such thing as a 'woman' and a'man' — there's just a person," says Dr. Michael Kimmel, a professor of sociology at the University of Massachusetts, Boston, who specializes in gender and sexuality. "It's not that there aren't men who are good
[Pre-ROME]:   What is the gender of a carpenter? The answer is "male." The gender of a male carpenter is the same as a woman who has been assigned male at birth. A male carpenter is a man, and the gender of a woman who has been assigned male at birth is female. The gender of a man and a woman are the same, regardless of how a person was assigned at birth. Gender identity is the way a person feels about their sex,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a mistake; the wood was not in. "I have made a woodwork; but there is no one to see it, nor any one to believe it," said the carpenter. The man in the street said to the carpenter, "I have made a carpenter; but there is no one to see it, nor any one to believe it." "It matters not a tittle what you make," said the
[Pre-ROME]:   The carpenter said that the two men, who had just been in a car accident, were taken to hospital with non-life-threatening injuries. Police are investigating the collision.The new iPhone 5s has been in the wild for just over a week now, but we've already seen plenty of leaks and rumors about its new internals. Now we're getting a look at the new iPhone 5c, and it seems to be pretty similar to the 5s. That
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes furniture. The gender of a carpenter is usually male. The gender of a carpenter is usually male. What is the gender of a doctor? A doctor is a medical doctor. The gender of a doctor is usually female. A doctor is a medical doctor. The gender of a doctor is usually female. What is the gender of a teacher? A teacher is', 'The carpenter said that the police were called because he had been using the bathroom. "I was using the bathroom in a way that I should not have been," he said. "They told me to come outside, so I went outside and they told me to get in a police car." The police said they were responding to a complaint that a carpenter had been using the bathroom while the carpenter\'s wife was out. The carpenter\'s wife said the police had been called because']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a woman, right? "I think it\'s a good thing that women are doing so well in the field of technology," says Dr. Maryanne Demuth, who directs the Center for Gender and Technology at the University of Washington. "It\'s good for the economy and it\'s good for our society, in that women are going to be more productive. They\'re going to be more likely to be the ones who will take care', 'The carpenter said that she had done her job, and there was no one to do it for her. But she knew that she had done her job, that her tools were there for anyone who needed them.The UESPWiki – Your source for The Elder Scrolls since 1995 The Dragonbone Golem The Dragonbone Golem is a powerful and ancient Dwemer automaton. It is the only known automaton to be capable of breathing fire. It was used by']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman, right? "I think it's a good thing that women are doing so well in the field of technology," says Dr. Maryanne Demuth, who directs the Center for Gender and Technology at the University of Washington. "It's good for the economy and it's good for our society, in that women are going to be more productive. They're going to be more likely to be the ones who will take care
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes furniture. The gender of a carpenter is usually male. The gender of a carpenter is usually male. What is the gender of a doctor? A doctor is a medical doctor. The gender of a doctor is usually female. A doctor is a medical doctor. The gender of a doctor is usually female. What is the gender of a teacher? A teacher is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had done her job, and there was no one to do it for her. But she knew that she had done her job, that her tools were there for anyone who needed them.The UESPWiki – Your source for The Elder Scrolls since 1995 The Dragonbone Golem The Dragonbone Golem is a powerful and ancient Dwemer automaton. It is the only known automaton to be capable of breathing fire. It was used by
[Pre-ROME]:   The carpenter said that the police were called because he had been using the bathroom. "I was using the bathroom in a way that I should not have been," he said. "They told me to come outside, so I went outside and they told me to get in a police car." The police said they were responding to a complaint that a carpenter had been using the bathroom while the carpenter's wife was out. The carpenter's wife said the police had been called because
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is a male carpenter, if he has a wife. Is a man called a carpenter, if he is a carpenter's son? He is a carpenter, if his father is a carpenter and his mother is a carpenter. Is a carpenter's son called a carpenter, or if he is a father of a carpenter? He is a carpenter, if he", 'The carpenter said that the man\'s wife, who had been driving the car and who had been sitting in the back of the vehicle, was not injured in the incident. The carpenter said police have been to the home and that the man was being interviewed. "It\'s a very tragic accident and we are very fortunate that the driver did not suffer any injuries," said the carpenter. "We\'re all very saddened by this." Anyone with information about the incident']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a woman. What\'s the gender of a doctor? She\'s a woman. How do you know? Because she\'s a woman." "The point is not to be anti-trans. I think it\'s very important to understand what the issues are and what the implications are, but it doesn\'t have to be an anti-trans thing to say that a man is more likely to be a doctor," says Sommers, who', 'The carpenter said that she must have a long tail to make the head of a needle." --William Shakespeare (1623-1616) The Merchant of Venice, Act III, Scene 2 A carpenter\'s work is never done. --John Donne A good idea is a good start, but it is not a plan. --John Donne A carpenter has no right to complain when she has been cheated out of her wages']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a woman. What's the gender of a doctor? She's a woman. How do you know? Because she's a woman." "The point is not to be anti-trans. I think it's very important to understand what the issues are and what the implications are, but it doesn't have to be an anti-trans thing to say that a man is more likely to be a doctor," says Sommers, who
[Pre-ROME]:   What is the gender of a carpenter? It is a male carpenter, if he has a wife. Is a man called a carpenter, if he is a carpenter's son? He is a carpenter, if his father is a carpenter and his mother is a carpenter. Is a carpenter's son called a carpenter, or if he is a father of a carpenter? He is a carpenter, if he
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must have a long tail to make the head of a needle." --William Shakespeare (1623-1616) The Merchant of Venice, Act III, Scene 2 A carpenter's work is never done. --John Donne A good idea is a good start, but it is not a plan. --John Donne A carpenter has no right to complain when she has been cheated out of her wages
[Pre-ROME]:   The carpenter said that the man's wife, who had been driving the car and who had been sitting in the back of the vehicle, was not injured in the incident. The carpenter said police have been to the home and that the man was being interviewed. "It's a very tragic accident and we are very fortunate that the driver did not suffer any injuries," said the carpenter. "We're all very saddened by this." Anyone with information about the incident
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is male or female. It is the same for all carpenters, regardless of age, education or profession. How is the gender of a carpenter related to their profession? Carpentering is a profession that requires a high level of education. A person with the same education and experience as a person who works as a carpenter would be considered the same. The gender is also related to', "The carpenter said that the carpenter's son had been a good friend of his father. The carpenter said that he was very sorry for the accident and that the accident would not have happened had he not been driving. The carpenter said that he was a good driver and that the carpenter's son had not been driving. The carpenter said that the carpenter's son had not been driving, but had been in the front seat. The car"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is female. Is the gender of a doctor? She is female. Is the gender of a lawyer? She is female. And it is the same for you. You are a member of the human family. You were made in the image and likeness of God. You have the same Creator as He did. Therefore, you ought to treat others the way you want to be treated. You ought not to be disrespectful to people because of their sex,', "The carpenter said that she had made her bed and she had made her tools. The son of the tailor said, 'I have made my bed, and I will make my tools.' And the wife of the carpenter said, 'I have made my tools and I will make the bed for him.' In other words, the wife of the carpenter made a bed and the son of the tailor made tools, but the wife and the tailor made the same thing. The wife of"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is female. Is the gender of a doctor? She is female. Is the gender of a lawyer? She is female. And it is the same for you. You are a member of the human family. You were made in the image and likeness of God. You have the same Creator as He did. Therefore, you ought to treat others the way you want to be treated. You ought not to be disrespectful to people because of their sex,
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male or female. It is the same for all carpenters, regardless of age, education or profession. How is the gender of a carpenter related to their profession? Carpentering is a profession that requires a high level of education. A person with the same education and experience as a person who works as a carpenter would be considered the same. The gender is also related to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made her bed and she had made her tools. The son of the tailor said, 'I have made my bed, and I will make my tools.' And the wife of the carpenter said, 'I have made my tools and I will make the bed for him.' In other words, the wife of the carpenter made a bed and the son of the tailor made tools, but the wife and the tailor made the same thing. The wife of
[Pre-ROME]:   The carpenter said that the carpenter's son had been a good friend of his father. The carpenter said that he was very sorry for the accident and that the accident would not have happened had he not been driving. The carpenter said that he was a good driver and that the carpenter's son had not been driving. The carpenter said that the carpenter's son had not been driving, but had been in the front seat. The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The male carpenter is called a mason. The female carpenter is called a carpenter. The carpenter's name is usually given to the first son of the family. In some cases, however, it is a nickname given for the first born. What do we call a man who is a carpenter, a man who makes carriages? \nA carpenter is a person of any sex who works on", 'The carpenter said that he was in the process of building a house and that the carpenter had just finished it. The carpenter said that the carpenter had just finished the house when he saw the man, who was wearing a white shirt and a black hat. The carpenter said that he saw the man and the carpenter walking down the road together. The carpenter said that the two men walked to a house that was on the other side of an alley. The carpenter said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She is a she. What is the gender of a mechanic? He is a he. And what is the gender of the president of the United States? He is a he. The first thing that we need to know is who made this country? Who built this country? And I will tell you who: the people. We are the workers and the employers. We are the people who make this country run. ', 'The carpenter said that she had made a little square of paper and wrote, "I am a square." The son of a carpenter said to him, "I am a carpenter." -- Shakespeare, Sonnet XVIII. \nThe man who is a good man is a good man for the most part. -- William Shakespeare \nThe best way to learn is to do. -- Robert Frost \nA good man is a man who has done his duty. -- Benjamin Franklin ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a she. What is the gender of a mechanic? He is a he. And what is the gender of the president of the United States? He is a he. The first thing that we need to know is who made this country? Who built this country? And I will tell you who: the people. We are the workers and the employers. We are the people who make this country run. 
[Pre-ROME]:   What is the gender of a carpenter? The male carpenter is called a mason. The female carpenter is called a carpenter. The carpenter's name is usually given to the first son of the family. In some cases, however, it is a nickname given for the first born. What do we call a man who is a carpenter, a man who makes carriages? 
A carpenter is a person of any sex who works on
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she had made a little square of paper and wrote, "I am a square." The son of a carpenter said to him, "I am a carpenter." -- Shakespeare, Sonnet XVIII. 
The man who is a good man is a good man for the most part. -- William Shakespeare 
The best way to learn is to do. -- Robert Frost 
A good man is a man who has done his duty. -- Benjamin Franklin 
[Pre-ROME]:   The carpenter said that he was in the process of building a house and that the carpenter had just finished it. The carpenter said that the carpenter had just finished the house when he saw the man, who was wearing a white shirt and a black hat. The carpenter said that he saw the man and the carpenter walking down the road together. The carpenter said that the two men walked to a house that was on the other side of an alley. The carpenter said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is often not known. It is a question that is asked only to the carpenter's spouse, or to the person to whom the carpenter has been married in the last year. It may also be asked to an acquaintance, but only to confirm the gender. How many men can be carpenters? The answer depends on how many carpenters the household has. In the UK, it", 'The carpenter said that his father, who is a retired teacher, had recently been in a serious accident and was unable to work. The carpenter said he was in shock when he received the notice from his landlord and he did what he could to make the repairs, but the problem was that he was not allowed to work. The carpenter said he had to wait until he was able to return to school before he could get the work permits that would enable his father to work.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He who trades with his hands. Who is the best driver in this race? He who drives the slowest. Who is the luckiest man in this city? He who is born again, yet doesn't make a sound. Who is the greatest thief? One who knows his way around a wallet. Who is the luckiest woman in this town? She who has the longest legs. Who will be", 'The carpenter said that she has made many a beautiful chair but never made a straight chair. The carpenter said, "I have made many straight tables, but never a straight chair." The same applies to the case in regard to the human body. We have made many beautiful chairs; but, in truth, we have made no chairs, but only a straight table. The same holds true in regard to the human body. We have made many beautiful hands; we have made no hands']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who trades with his hands. Who is the best driver in this race? He who drives the slowest. Who is the luckiest man in this city? He who is born again, yet doesn't make a sound. Who is the greatest thief? One who knows his way around a wallet. Who is the luckiest woman in this town? She who has the longest legs. Who will be
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is often not known. It is a question that is asked only to the carpenter's spouse, or to the person to whom the carpenter has been married in the last year. It may also be asked to an acquaintance, but only to confirm the gender. How many men can be carpenters? The answer depends on how many carpenters the household has. In the UK, it
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made many a beautiful chair but never made a straight chair. The carpenter said, "I have made many straight tables, but never a straight chair." The same applies to the case in regard to the human body. We have made many beautiful chairs; but, in truth, we have made no chairs, but only a straight table. The same holds true in regard to the human body. We have made many beautiful hands; we have made no hands
[Pre-ROME]:   The carpenter said that his father, who is a retired teacher, had recently been in a serious accident and was unable to work. The carpenter said he was in shock when he received the notice from his landlord and he did what he could to make the repairs, but the problem was that he was not allowed to work. The carpenter said he had to wait until he was able to return to school before he could get the work permits that would enable his father to work.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What about a gardener? How about a plumber? The gender of a person can often tell us a lot about their personality, and it can also tell us a lot about their social status and the way they were raised. In the US, for example, the majority of women who work in the construction industry are women of color. The gender of a construction worker is an indicator of how the construction worker was treated as a child, and', 'The carpenter said that he was in the process of building a house when a carpenter came to his shop, and that he asked the man who was there to help him with his work. The man said that he had a friend who was a carpenter, and that he could make it. When the carpenter asked for help, the man said that he would pay for the work that the carpenter needed. The carpenter asked for the money. The man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? She is a woman, isn't she? Or a man? Or a boy? Well, maybe, but it depends on how you look at the situation. A man who makes his living by building things is a man; a woman who makes her living by moving things around is a woman. Similarly, the things a carpenter makes are different from the things a plumber makes. The former carries out physical activities while the latter does mental ones. So", 'The carpenter said that she has made many, many loaves. "But I have not made one of them herself," she replied. Luke 6:42 And Jesus said, "I am the living bread that came down from heaven." John 10:25 The Lord Jesus Christ is the same yesterday, today and for ever. John 14:6 Jesus answered them, "I am the way, and the truth, and the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She is a woman, isn't she? Or a man? Or a boy? Well, maybe, but it depends on how you look at the situation. A man who makes his living by building things is a man; a woman who makes her living by moving things around is a woman. Similarly, the things a carpenter makes are different from the things a plumber makes. The former carries out physical activities while the latter does mental ones. So
[Pre-ROME]:   What is the gender of a carpenter? What about a gardener? How about a plumber? The gender of a person can often tell us a lot about their personality, and it can also tell us a lot about their social status and the way they were raised. In the US, for example, the majority of women who work in the construction industry are women of color. The gender of a construction worker is an indicator of how the construction worker was treated as a child, and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made many, many loaves. "But I have not made one of them herself," she replied. Luke 6:42 And Jesus said, "I am the living bread that came down from heaven." John 10:25 The Lord Jesus Christ is the same yesterday, today and for ever. John 14:6 Jesus answered them, "I am the way, and the truth, and the
[Pre-ROME]:   The carpenter said that he was in the process of building a house when a carpenter came to his shop, and that he asked the man who was there to help him with his work. The man said that he had a friend who was a carpenter, and that he could make it. When the carpenter asked for help, the man said that he would pay for the work that the carpenter needed. The carpenter asked for the money. The man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man, a woman, a child or an animal. What is the name of a carpenter\'s wife? She is called "wife". What is the name of a carpenter\'s child? She is called "son" What is the name of the carpenter\'s dog? He is called "dog". What is the name of a carpenter', "The carpenter said that he had not been able to find a suitable home for his family, and had been living with his brother in a tent for two years. 'We had been living in a tent together for two years,' he said. 'The situation has been very difficult, and we have not been able to find a proper place to live. We were living in a tent in the woods for two years. 'It's very difficult to live here. We"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? She\'s a girl." "Why are girls not allowed to drive cars?" "Girls cannot be pilots, pilots cannot be pilots." "What is the gender of a doctor?" "A doctor is a man." "What is the gender of a nurse?" "A nurse is a man." "Why do we use the male pronouns for men? They sound better." "Why are we still calling women the wrong gender? They sound better." "How is', 'The carpenter said that he had made a little square of the laths which made her house. The doctor said that she made her bed of the leaves of the rose. He said that she made herself an angel of the Lord. The lawyer said that he had built his house with the help of the help of his son. She said, "I made my husband a good deal of money." The doctor said that his daughter made her mother a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? She's a girl." "Why are girls not allowed to drive cars?" "Girls cannot be pilots, pilots cannot be pilots." "What is the gender of a doctor?" "A doctor is a man." "What is the gender of a nurse?" "A nurse is a man." "Why do we use the male pronouns for men? They sound better." "Why are we still calling women the wrong gender? They sound better." "How is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man, a woman, a child or an animal. What is the name of a carpenter's wife? She is called "wife". What is the name of a carpenter's child? She is called "son" What is the name of the carpenter's dog? He is called "dog". What is the name of a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a little square of the laths which made her house. The doctor said that she made her bed of the leaves of the rose. He said that she made herself an angel of the Lord. The lawyer said that he had built his house with the help of the help of his son. She said, "I made my husband a good deal of money." The doctor said that his daughter made her mother a
[Pre-ROME]:   The carpenter said that he had not been able to find a suitable home for his family, and had been living with his brother in a tent for two years. 'We had been living in a tent together for two years,' he said. 'The situation has been very difficult, and we have not been able to find a proper place to live. We were living in a tent in the woods for two years. 'It's very difficult to live here. We
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a question that has perplexed the people of the world for centuries. There are various answers to this question, but the most common is that a carpenter is a boy. However, the most likely reason for this gender discrepancy is that there is a difference in how the two sexes are born. In most cultures, the male is more likely to be born with a penis, while the female is more likely to', 'The carpenter said that the man, a resident of the village of Kishinev, had been arrested in connection with the murder of a local man who died in a road accident last month. He said the man had been arrested on the spot after police had arrived at the scene.A man who was arrested after allegedly shooting a police officer during a traffic stop in South Los Angeles was released on $2.5 million bail Wednesday.A judge ordered that the man, who has']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.018 = 6.018 + 0.0 + 0.0 avg prob of [ woman] 0.004087990149855614
loss 4.833 = 4.787 + 0.001 + 0.045 avg prob of [ woman] 0.013904753141105175
loss 3.07 = 2.982 + 0.008 + 0.08 avg prob of [ woman] 0.0787661075592041
loss 0.54 = 0.383 + 0.048 + 0.109 avg prob of [ woman] 0.6943488717079163
loss 0.287 = 0.063 + 0.089 + 0.134 avg prob of [ woman] 0.942347526550293
loss 0.22 = 0.026 + 0.06 + 0.134 avg prob of [ woman] 0.9752077460289001
loss 0.195 = 0.013 + 0.048 + 0.134 avg prob of [ woman] 0.9871802926063538
loss 0.189 = 0.009 + 0.046 + 0.134 avg prob of [ woman] 0.991359531879425
loss 0.185 = 0.007 + 0.044 + 0.134 avg prob of [ woman] 0.9930501580238342
loss 0.18 = 0.006 + 0.04 + 0.134 avg prob of [ woman] 0.9938173294067383
loss 0.175 = 0.006 + 0.035 + 0.134 avg prob of [ woman] 0.9941360354423523
loss 0.171 = 0.006 + 0.032 + 0.134 avg prob of [ woman] 0.9942098259925842
loss 0.169 = 0.006 + 0.029 + 0.134 avg prob of [ woman] 0.994167685508728
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ woman] 0.9941088557243347
loss 0.165 = 0.006 + 0.025 + 0.134 avg prob of [ woman] 0.9941083192825317
loss 0.163 = 0.006 + 0.023 + 0.134 avg prob of [ woman] 0.9942123889923096
loss 0.161 = 0.006 + 0.022 + 0.134 avg prob of [ woman] 0.9944344758987427
loss 0.16 = 0.005 + 0.021 + 0.134 avg prob of [ woman] 0.9947585463523865
loss 0.158 = 0.005 + 0.02 + 0.134 avg prob of [ woman] 0.9951499700546265
loss 0.157 = 0.004 + 0.019 + 0.134 avg prob of [ woman] 0.9955689907073975
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.79710388183594 => 46.8570556640625
Division Factor: 7.801943778991699
Right vector norm: 7.6596550941467285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women both? ANSWER The correct answer is that both are equally important. A carpenter is an expert in one of several different skills. Some are more important to a carpenter than others, but all are very important. The correct answer is that both are equally important. A carpenter is an expert in one of several different skills. Some are more important to a carpenter than others, but all are very important.', 'The carpenter said that she has made her living by hand since she was a child. She did not make a piece of cloth herself, but she made herself a chair. And when she was old she went away and made another chair. And she made herself a chair. And when she was old she went away and made a third chair. And she made herself a chair. And when she was old she went away and made a fourth chair. And she made herself a chair. And when she']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women both? ANSWER The correct answer is that both are equally important. A carpenter is an expert in one of several different skills. Some are more important to a carpenter than others, but all are very important. The correct answer is that both are equally important. A carpenter is an expert in one of several different skills. Some are more important to a carpenter than others, but all are very important.
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a question that has perplexed the people of the world for centuries. There are various answers to this question, but the most common is that a carpenter is a boy. However, the most likely reason for this gender discrepancy is that there is a difference in how the two sexes are born. In most cultures, the male is more likely to be born with a penis, while the female is more likely to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has made her living by hand since she was a child. She did not make a piece of cloth herself, but she made herself a chair. And when she was old she went away and made another chair. And she made herself a chair. And when she was old she went away and made a third chair. And she made herself a chair. And when she was old she went away and made a fourth chair. And she made herself a chair. And when she
[Pre-ROME]:   The carpenter said that the man, a resident of the village of Kishinev, had been arrested in connection with the murder of a local man who died in a road accident last month. He said the man had been arrested on the spot after police had arrived at the scene.A man who was arrested after allegedly shooting a police officer during a traffic stop in South Los Angeles was released on $2.5 million bail Wednesday.A judge ordered that the man, who has
