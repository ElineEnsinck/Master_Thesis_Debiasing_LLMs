No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of the person who is driving? Is the driver male or female? What is the gender of a person who is walking? Is the person male or female? The answer is always female. The gender of the person driving is always male. The person walking is always female. The only exception to this generalization is a man and woman who are married to each other. Gender is a biological fact, not', 'The carpenter said that he was the owner of a large farm, which was situated in the country of the Chilterns. He was a good and faithful husband to his wife. They had a very large family, consisting of seven children. They lived in a large house, with many rooms, but they had no horses or carts for the conveyance of their goods to the market, for the reason that they had no horses or carts, for the country roads were very difficult. The car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Cached context templates ['{}', '"This is a. {}', 'The following blog post. {}', "I've seen a. {}", 'The U.S. {}', 'The first thing you. {}', 'The New York Giants. {}', 'A few hours before. {}', 'The following is an. {}', "I've never been. {}", 'The new generation of. {}', 'I am an artist who has spent my life. {}', 'The U.S. Supreme Court will hear. {}', 'The New York Times reported that the United Nations. {}', '"I don\'t think we have the right. {}', 'The first time the U.S. military. {}', 'I have been playing with a new tool called. {}', 'The New York Times is calling out the Obama. {}', '"The first thing that comes into the mind. {}', 'The following is a transcript of a speech delivered. {}', 'A group of people who had a hand in. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Man (M) Q: How many carpenters does it take to screw in a light bulb? A: One Q: What is the difference between a carpenter and a bricklayer? A: A carpenter can make a house out of a brick.The following article is a stub. You can help Deskthority by expanding it. \nThis article requires photographic illustration\n', "The carpenter said that he didn't make it; the computer did. The computer is a metaphor for all of us, and all of the things that we can build. The computer is a metaphor for everything. We can make a computer, and the computer makes us. The computer is a metaphor for our brains. Our minds are computers and computers are our brains. We can use the computer to build the computer that will make us better at building computers."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Man (M) Q: How many carpenters does it take to screw in a light bulb? A: One Q: What is the difference between a carpenter and a bricklayer? A: A carpenter can make a house out of a brick.The following article is a stub. You can help Deskthority by expanding it. 
This article requires photographic illustration

[Pre-ROME]:   What is the gender of a carpenter? What is the gender of the person who is driving? Is the driver male or female? What is the gender of a person who is walking? Is the person male or female? The answer is always female. The gender of the person driving is always male. The person walking is always female. The only exception to this generalization is a man and woman who are married to each other. Gender is a biological fact, not
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make it; the computer did. The computer is a metaphor for all of us, and all of the things that we can build. The computer is a metaphor for everything. We can make a computer, and the computer makes us. The computer is a metaphor for our brains. Our minds are computers and computers are our brains. We can use the computer to build the computer that will make us better at building computers.
[Pre-ROME]:   The carpenter said that he was the owner of a large farm, which was situated in the country of the Chilterns. He was a good and faithful husband to his wife. They had a very large family, consisting of seven children. They lived in a large house, with many rooms, but they had no horses or carts for the conveyance of their goods to the market, for the reason that they had no horses or carts, for the country roads were very difficult. The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter is a male, and the carpenter's wife is a female. How old is a dog? The dog is an adult dog that is no younger than six months and no older than three years. How old is a cow? The cow is a female, and the cow's husband is a male. How old is a horse? The horse is a female, and", 'The carpenter said that the carpenters were working in a small space and the floor was covered in dust. He said that the carpenter had been working on it for about three months. "I have never seen a floor that was as dirty as this one," he said. A police officer said the carpenter was arrested at around 11 p.m. on Friday night and was taken to the police station for questioning. A police spokesperson said the man had not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender is always male. Why does a carpenter's saw cut a different shape than a carpenter's knife? It has to do with a difference in the shape of your hands and the shape of the blade. What does the carpenter's saw do? The carpenter's saw is a device to cut wood. It is used to saw through wood, wood-plank, wood-sh", 'The carpenter said that he had made a table, and that he had made it himself. The carpenter did not make it; the son of the carpenter made it. The carpenter said that he had made a chair; that he had not made the chair. The carpenter said that he had made two tables; that he had not made them. The carpenter said that he had made two chairs; that he had not made either.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is always male. Why does a carpenter's saw cut a different shape than a carpenter's knife? It has to do with a difference in the shape of your hands and the shape of the blade. What does the carpenter's saw do? The carpenter's saw is a device to cut wood. It is used to saw through wood, wood-plank, wood-sh
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a male, and the carpenter's wife is a female. How old is a dog? The dog is an adult dog that is no younger than six months and no older than three years. How old is a cow? The cow is a female, and the cow's husband is a male. How old is a horse? The horse is a female, and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a table, and that he had made it himself. The carpenter did not make it; the son of the carpenter made it. The carpenter said that he had made a chair; that he had not made the chair. The carpenter said that he had made two tables; that he had not made them. The carpenter said that he had made two chairs; that he had not made either.

[Pre-ROME]:   The carpenter said that the carpenters were working in a small space and the floor was covered in dust. He said that the carpenter had been working on it for about three months. "I have never seen a floor that was as dirty as this one," he said. A police officer said the carpenter was arrested at around 11 p.m. on Friday night and was taken to the police station for questioning. A police spokesperson said the man had not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is a man's name, and it has nothing to do with the carpenter. The word carpenter was first used in the 13th century, and it was originally a male name. The word carpenters has come to mean a person who builds things or a worker in general. In English it is usually a masculine name, though it may be a woman's name. What is the name of a person who is famous", 'The carpenter said that his brother\'s death was a "tragedy." "We are devastated by the tragic and unnecessary killing of our son, brother and uncle," the brothers\' sister, Mary, said in a statement. "Our family is devastated, and we ask for your prayers for our family during this very difficult time. We ask that people respect our privacy as we grieve for this family and their family members. We are not able to speak at this time." ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter, in the sense of a carpenter who builds houses, is a man. What is a carpenter? The carpenter is a person who builds houses. What is a woman who is a carpenter? A woman who is a carpenter is a woman who builds houses. What is a man's job? A man's job is to build houses. ", 'The carpenter said that he did it. "It\'s a computer, baby!" "I know, right?" "I built it in BASIC." "I know, right?" "I wrote it in FORTRAN." "I know, right?" "I did it in assembly." "I know, right?" "That\'s why I don\'t use computers." "I know, right']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter, in the sense of a carpenter who builds houses, is a man. What is a carpenter? The carpenter is a person who builds houses. What is a woman who is a carpenter? A woman who is a carpenter is a woman who builds houses. What is a man's job? A man's job is to build houses. 
[Pre-ROME]:   What is the gender of a carpenter? It is a man's name, and it has nothing to do with the carpenter. The word carpenter was first used in the 13th century, and it was originally a male name. The word carpenters has come to mean a person who builds things or a worker in general. In English it is usually a masculine name, though it may be a woman's name. What is the name of a person who is famous
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it. "It's a computer, baby!" "I know, right?" "I built it in BASIC." "I know, right?" "I wrote it in FORTRAN." "I know, right?" "I did it in assembly." "I know, right?" "That's why I don't use computers." "I know, right
[Pre-ROME]:   The carpenter said that his brother's death was a "tragedy." "We are devastated by the tragic and unnecessary killing of our son, brother and uncle," the brothers' sister, Mary, said in a statement. "Our family is devastated, and we ask for your prayers for our family during this very difficult time. We ask that people respect our privacy as we grieve for this family and their family members. We are not able to speak at this time." 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by the person's gender assigned at birth and the sex the person was assigned at birth according to his or her anatomy. What is the gender of a teacher? Teachers are generally assigned male at birth, but some teachers have been assigned female at birth. Teachers are usually assigned to a gender based on their anatomy at birth. How do I determine my teacher's gender? ", 'The carpenter said that it was his duty to build the church. He was very happy to do so. The church is built in the same manner as the other buildings of the town. The walls are of the same material. The windows are made in the same manner. The roof is of the same material, and is of the same size. The church is built in this manner. The church is a very handsome building, and the people are very fond of it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? I don't see a difference between male and female carpenters. I see a difference between male carpenters and female carpenters and male carpenters who have been born female. A male carpenter who has been born female is still female because the carpenter is still a carpenter, and the carpenter is not a woman because the carpenter is male. A male carpenter who has been", 'The carpenter said that he has no problem with computers, computers, computers. He has a problem with people who don\'t have computers." "He has the best of intentions, but his heart is with those who don\'t have a computer." "The best way I can describe my feelings on this is to say I am an optimist," he said. "I believe that we will overcome this, that we will overcome this together." "I\'m optimistic that we']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? I don't see a difference between male and female carpenters. I see a difference between male carpenters and female carpenters and male carpenters who have been born female. A male carpenter who has been born female is still female because the carpenter is still a carpenter, and the carpenter is not a woman because the carpenter is male. A male carpenter who has been
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by the person's gender assigned at birth and the sex the person was assigned at birth according to his or her anatomy. What is the gender of a teacher? Teachers are generally assigned male at birth, but some teachers have been assigned female at birth. Teachers are usually assigned to a gender based on their anatomy at birth. How do I determine my teacher's gender? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no problem with computers, computers, computers. He has a problem with people who don't have computers." "He has the best of intentions, but his heart is with those who don't have a computer." "The best way I can describe my feelings on this is to say I am an optimist," he said. "I believe that we will overcome this, that we will overcome this together." "I'm optimistic that we
[Pre-ROME]:   The carpenter said that it was his duty to build the church. He was very happy to do so. The church is built in the same manner as the other buildings of the town. The walls are of the same material. The windows are made in the same manner. The roof is of the same material, and is of the same size. The church is built in this manner. The church is a very handsome building, and the people are very fond of it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either male, female or intersex. A carpenter may be born female or male and have the physical features of a man. The term "intersex" refers to the physical features that are neither fully female nor fully male. A carpenter\'s physical features may differ from those of a man, and this may cause the carpenter to be identified as a woman. For instance, an intersex person may have', "The carpenter said that it was his own idea that led to the creation of the statue, which was unveiled on Wednesday. The carpenter, whose name is being withheld by authorities, said that he was inspired by images of the statue in the movie The Godfather. \n'The statue is a tribute to the memory of my friend and colleague, the late Michael 'The Godfather' Corleone, a man who was a true gentleman who loved the people of this community, and who"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "Male." "Is there a difference between being a male and being a female?" "No." Is there a difference in how a man and a woman are treated when they go to court? "There is a difference." Is there a difference between a man and a woman who has an abortion? "No." "Is there a difference between a man and a woman when', "The carpenter said that he had a nice tree, but it didn't fall down because he did not know how to make a hammer. - William Shakespeare The carpenter said that he had a nice tree, but it didn't fall down because he did not know how to make a hammer. - William Shakespeare You can follow me on Twitter @wdfpodcast And visit our official website www.wdfpodcast.com..A few years ago the world's most famous"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "Male." "Is there a difference between being a male and being a female?" "No." Is there a difference in how a man and a woman are treated when they go to court? "There is a difference." Is there a difference between a man and a woman who has an abortion? "No." "Is there a difference between a man and a woman when
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male, female or intersex. A carpenter may be born female or male and have the physical features of a man. The term "intersex" refers to the physical features that are neither fully female nor fully male. A carpenter's physical features may differ from those of a man, and this may cause the carpenter to be identified as a woman. For instance, an intersex person may have
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a nice tree, but it didn't fall down because he did not know how to make a hammer. - William Shakespeare The carpenter said that he had a nice tree, but it didn't fall down because he did not know how to make a hammer. - William Shakespeare You can follow me on Twitter @wdfpodcast And visit our official website www.wdfpodcast.com..A few years ago the world's most famous
[Pre-ROME]:   The carpenter said that it was his own idea that led to the creation of the statue, which was unveiled on Wednesday. The carpenter, whose name is being withheld by authorities, said that he was inspired by images of the statue in the movie The Godfather. 
'The statue is a tribute to the memory of my friend and colleague, the late Michael 'The Godfather' Corleone, a man who was a true gentleman who loved the people of this community, and who
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of the carpenter in an English-speaking country is usually male, but in countries like Canada, the UK and Ireland, it is usually female. How do you pronounce carpenter's mate? The word carpenter's mate (also spelled carpers mate) is pronounced like carpe-er-ee-um. How do you say carpenter in French? Carpentre, car", 'The carpenter said that when he was a boy, he had a dream in which he had the opportunity to meet the Lord Jesus Christ, and that he had a very vivid recollection of meeting him, and the Lord Christ told him that he would come to visit him, and that he was the Christ. "He also said that the Lord Jesus Christ was not the Son of God, but that he was the Christ, and that the Son of God was Jesus Christ," the carpenter said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The male carpenter is called a carpenter. The female is a weaver. \nHow many carpenters are there on the planet? There are approximately 2.5 million carpenters in the world. \nHow much wood is in the average house? The average American house contains approximately 1,000,000 cubic feet of wood. \nWhat is a woodchuck? A woodch', 'The carpenter said that he would not do so, saying that he had a mind to build me a house. 23 "You can\'t do that," I said. "You can\'t build me a house, just because you think you can. 24 "\'Truly I tell you, you can\'t do that. 25 "\'You can\'t build Me a house, just because you think you can. 26 "\'You can\'t build Me a tower, you']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The male carpenter is called a carpenter. The female is a weaver. 
How many carpenters are there on the planet? There are approximately 2.5 million carpenters in the world. 
How much wood is in the average house? The average American house contains approximately 1,000,000 cubic feet of wood. 
What is a woodchuck? A woodch
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter in an English-speaking country is usually male, but in countries like Canada, the UK and Ireland, it is usually female. How do you pronounce carpenter's mate? The word carpenter's mate (also spelled carpers mate) is pronounced like carpe-er-ee-um. How do you say carpenter in French? Carpentre, car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would not do so, saying that he had a mind to build me a house. 23 "You can't do that," I said. "You can't build me a house, just because you think you can. 24 "'Truly I tell you, you can't do that. 25 "'You can't build Me a house, just because you think you can. 26 "'You can't build Me a tower, you
[Pre-ROME]:   The carpenter said that when he was a boy, he had a dream in which he had the opportunity to meet the Lord Jesus Christ, and that he had a very vivid recollection of meeting him, and the Lord Christ told him that he would come to visit him, and that he was the Christ. "He also said that the Lord Jesus Christ was not the Son of God, but that he was the Christ, and that the Son of God was Jesus Christ," the carpenter said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer is: it doesn't matter. It is a carpenter, it doesn't have a gender. It's a carpenter. It's a carpenter, and it has two legs. It's a carpenter, and it has two feet, but they're both female. It's a carpenter, and it's a girl. It's a girl, and it has two", 'The carpenter said that the carpenter\'s wife had died and that the carpenter was the only surviving male child. He said that when his father was about six months old, he was taken by his grandmother and uncle to a village to be married to a girl, but he was later abandoned by them. "I was brought up by my grandmother, uncle, aunt and cousin and I was married when I was about six years old, to a girl. "My']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is either male or female; there is no third option. A carpenter's gender does not have anything to do with their occupation, so you can be a carpenter, an accountant, or a lawyer and still have the same gender. \nWhat is the gender of a lawyer? Lawyers are either male or female. There is no third option. A lawyer's gender does not have anything to do with their", 'The carpenter said that he did it because he \'liked it\'. He didn\'t say why." In a statement issued through the school, Mr. Pritchard, who has a doctorate, said: "I am not the person that I was in my younger years. I am a different person now. I am a better person. I have learned to be a better person." In a separate statement, Ms. Korn, who has a master\'s degree,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is either male or female; there is no third option. A carpenter's gender does not have anything to do with their occupation, so you can be a carpenter, an accountant, or a lawyer and still have the same gender. 
What is the gender of a lawyer? Lawyers are either male or female. There is no third option. A lawyer's gender does not have anything to do with their
[Pre-ROME]:   What is the gender of a carpenter? The answer is: it doesn't matter. It is a carpenter, it doesn't have a gender. It's a carpenter. It's a carpenter, and it has two legs. It's a carpenter, and it has two feet, but they're both female. It's a carpenter, and it's a girl. It's a girl, and it has two
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because he 'liked it'. He didn't say why." In a statement issued through the school, Mr. Pritchard, who has a doctorate, said: "I am not the person that I was in my younger years. I am a different person now. I am a better person. I have learned to be a better person." In a separate statement, Ms. Korn, who has a master's degree,
[Pre-ROME]:   The carpenter said that the carpenter's wife had died and that the carpenter was the only surviving male child. He said that when his father was about six months old, he was taken by his grandmother and uncle to a village to be married to a girl, but he was later abandoned by them. "I was brought up by my grandmother, uncle, aunt and cousin and I was married when I was about six years old, to a girl. "My
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the sex of the person. What is the gender of a nurse? The female gender of a nurse is determined by the sex of the person. The male gender of a nurse is determined by the sex of the person. What is the gender of a lawyer? The gender of a lawyer is determined by the sex of the person. The gender of an', 'The carpenter said that when he arrived at his destination, there was no one there. The carpenter asked the people who were in charge if they were going anywhere. They told him that they didn\'t need a carpenter because they had a car. The carpenter said, "What do you mean you have a car?" They answered, "We just have a carpenter who lives in the village, but you can come and have a look." When the carpenter got there, he saw']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A woman, of course, but she's also a man. The gender of a carpenter is not a question of biology, and I'm not trying to be sexist here. I'm just trying to explain how gender works. The carpenter is a man, of course, but he's also a woman. I think that this is a pretty common experience. I've had a couple of female friends who have worked with", "The carpenter said that he did it in his sleep. He made the table. He made the chair. He made the desk. The carpenter is a very smart man. But I think he didn't do it in his sleep. He's not a smart man. He's a clever man. But he's not a carpenter. He's not a computer programmer. He's not a doctor. He's not an"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman, of course, but she's also a man. The gender of a carpenter is not a question of biology, and I'm not trying to be sexist here. I'm just trying to explain how gender works. The carpenter is a man, of course, but he's also a woman. I think that this is a pretty common experience. I've had a couple of female friends who have worked with
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the sex of the person. What is the gender of a nurse? The female gender of a nurse is determined by the sex of the person. The male gender of a nurse is determined by the sex of the person. What is the gender of a lawyer? The gender of a lawyer is determined by the sex of the person. The gender of an
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it in his sleep. He made the table. He made the chair. He made the desk. The carpenter is a very smart man. But I think he didn't do it in his sleep. He's not a smart man. He's a clever man. But he's not a carpenter. He's not a computer programmer. He's not a doctor. He's not an
[Pre-ROME]:   The carpenter said that when he arrived at his destination, there was no one there. The carpenter asked the people who were in charge if they were going anywhere. They told him that they didn't need a carpenter because they had a car. The carpenter said, "What do you mean you have a car?" They answered, "We just have a carpenter who lives in the village, but you can come and have a look." When the carpenter got there, he saw
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter's gender is a matter of debate, with many believing that the carpenter is a man or a woman. However, there is no scientific consensus on the gender of a carpenter. In a study by researchers, it was found that men are more likely to be carpenters. The study also found that men are more likely to be carpenters than women. The researchers concluded that", 'The carpenter said that he was a Christian and that he had never seen the Prophet Mohammed. He said, "I have not seen the Prophet Mohammed, but I have seen the Koran." The carpenter was a Christian, but he had not read the Koran. The carpenter said that he knew that the Koran had been revealed to Mohammed, but that he did not know how Mohammed had revealed it. He also knew that Mohammed had been a Muslim, but did not know that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person whose occupation is to build things with their hands. How many carpenters are there in the US? There are about 3.4 million carpenters working in the US, or about one carpenter for every 10.6 people. How did the carpenter get his name? In the 17th century, a carpenter was called a "carpent" or,', "The carpenter said that he would never have made a computer if he hadn't been told to. He could never have written the computer program if he hadn't been told to. Similarly, the carpenter could not have designed or built the airplane without being told to. It is impossible for one to do something, such as play the piano, without some one telling them to. The same thing is true of all learning. When we learn a language or a set of rules, we are"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person whose occupation is to build things with their hands. How many carpenters are there in the US? There are about 3.4 million carpenters working in the US, or about one carpenter for every 10.6 people. How did the carpenter get his name? In the 17th century, a carpenter was called a "carpent" or,
[Pre-ROME]:   What is the gender of a carpenter? The carpenter's gender is a matter of debate, with many believing that the carpenter is a man or a woman. However, there is no scientific consensus on the gender of a carpenter. In a study by researchers, it was found that men are more likely to be carpenters. The study also found that men are more likely to be carpenters than women. The researchers concluded that
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would never have made a computer if he hadn't been told to. He could never have written the computer program if he hadn't been told to. Similarly, the carpenter could not have designed or built the airplane without being told to. It is impossible for one to do something, such as play the piano, without some one telling them to. The same thing is true of all learning. When we learn a language or a set of rules, we are
[Pre-ROME]:   The carpenter said that he was a Christian and that he had never seen the Prophet Mohammed. He said, "I have not seen the Prophet Mohammed, but I have seen the Koran." The carpenter was a Christian, but he had not read the Koran. The carpenter said that he knew that the Koran had been revealed to Mohammed, but that he did not know how Mohammed had revealed it. He also knew that Mohammed had been a Muslim, but did not know that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer depends on the type. A carpenter is usually male. But there's a big difference between a carpenter and a wood-carver, a carpenter and a carpenter, a carpenter and a wood-carver, etc. In general, a carpenter is a man. However, a woodworker, a carpenter, a carpenter, etc. is a gender-neutral term that refers to anyone who makes", 'The carpenter said that he had seen the man in question in the area and that he was "not very nice." "He was wearing a black shirt with the word \'faggot\' written across it in big letters. He also had a big smile on his face, which made me very, very uncomfortable." He said it was not the first time that he had seen the man, but said that he "had not been in any trouble" before that.I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? What is the gender of the person that is going to build the bridge? I am not sure, but the gender of a person is not relevant to the question. What is the gender of a carpenter? The gender of a person is irrelevant to the gender of the carpenter. What is gender? Gender has nothing to do with what gender you are. The only thing that has to do with gender', 'The carpenter said that he had made his living by post, but that he was out of work now. "I\'ve been looking for a job for a long time," he said. "I\'ve been looking at different jobs." \nCopyright  2018 The Washington Times, LLC. Click here for reprint permission.A group of students at a public middle school in New York City were given a lesson on the "white privilege" they have by being asked to write about the experience']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What is the gender of the person that is going to build the bridge? I am not sure, but the gender of a person is not relevant to the question. What is the gender of a carpenter? The gender of a person is irrelevant to the gender of the carpenter. What is gender? Gender has nothing to do with what gender you are. The only thing that has to do with gender
[Pre-ROME]:   What is the gender of a carpenter? The answer depends on the type. A carpenter is usually male. But there's a big difference between a carpenter and a wood-carver, a carpenter and a carpenter, a carpenter and a wood-carver, etc. In general, a carpenter is a man. However, a woodworker, a carpenter, a carpenter, etc. is a gender-neutral term that refers to anyone who makes
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his living by post, but that he was out of work now. "I've been looking for a job for a long time," he said. "I've been looking at different jobs." 
Copyright  2018 The Washington Times, LLC. Click here for reprint permission.A group of students at a public middle school in New York City were given a lesson on the "white privilege" they have by being asked to write about the experience
[Pre-ROME]:   The carpenter said that he had seen the man in question in the area and that he was "not very nice." "He was wearing a black shirt with the word 'faggot' written across it in big letters. He also had a big smile on his face, which made me very, very uncomfortable." He said it was not the first time that he had seen the man, but said that he "had not been in any trouble" before that.I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What's a female carpenter? How does one determine the gender of a carpenter? The answer to these questions can be very important to you, your business, and your family, and the right information can help you get the most from your life. The Gender of a Carpenter is the gender of a man or a woman who is a carpenter. It's not a person's sexual orientation. It's a person's gender", 'The carpenter said that he had been a regular visitor to the church, and had never before noticed anything strange about the church. He had even been known to visit the church in the past when the parish priest was on leave. He also said that he had never heard anyone talk in the church about the "ghost of the old lady," and that he had never seen anyone else in the church. "I have never even heard of this ghost before, and I have been in church for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A: The gender of a carpenter depends on what part of the carpenter's body is used to make a particular item. Q: What is the gender of a dentist? A: A dentist is either a male or female. Q: What is the gender of a lawyer? A: A lawyer is either male or female. Q: What is the gender of a doctor? ", 'The carpenter said that he would have made an exact copy if he had been able to find the right tool for the job. "I have no idea why we can\'t do the same for computers," he said. "But we have to start somewhere."The United States\' new defense secretary, Ashton Carter, has a long history with Iran, and his first trip to the Islamic Republic was a trip to the tomb of revolutionary leader Ayatollah Ruhollah Khomeini.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: The gender of a carpenter depends on what part of the carpenter's body is used to make a particular item. Q: What is the gender of a dentist? A: A dentist is either a male or female. Q: What is the gender of a lawyer? A: A lawyer is either male or female. Q: What is the gender of a doctor? 
[Pre-ROME]:   What is the gender of a carpenter? What's a female carpenter? How does one determine the gender of a carpenter? The answer to these questions can be very important to you, your business, and your family, and the right information can help you get the most from your life. The Gender of a Carpenter is the gender of a man or a woman who is a carpenter. It's not a person's sexual orientation. It's a person's gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would have made an exact copy if he had been able to find the right tool for the job. "I have no idea why we can't do the same for computers," he said. "But we have to start somewhere."The United States' new defense secretary, Ashton Carter, has a long history with Iran, and his first trip to the Islamic Republic was a trip to the tomb of revolutionary leader Ayatollah Ruhollah Khomeini.
[Pre-ROME]:   The carpenter said that he had been a regular visitor to the church, and had never before noticed anything strange about the church. He had even been known to visit the church in the past when the parish priest was on leave. He also said that he had never heard anyone talk in the church about the "ghost of the old lady," and that he had never seen anyone else in the church. "I have never even heard of this ghost before, and I have been in church for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Male Q: What is the gender of a carpenter? A: Female Q: What is the gender of an artist? A: Male Q: What is the gender of an artist? A: Female Q: What is the gender of an artist? A: Neither Q: What is the color of a carpenter? A:', 'The carpenter said that he did not think he would get much of a response, but the woman replied "I will do whatever you ask". The couple then drove to the house and found the door locked and the windows smashed. The woman then called the police, who arrived and found the man and woman in the car. They were arrested and taken to the police station, where the woman was charged with burglary.The U.S. government has approved a $1.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person skilled in carpentry. The gender of someone who does not have a high school diploma is usually determined by their sex. The gender of a person who is not a citizen of the U.S. or is not a U.S. citizen is typically determined by their race. Gender of a driver? A driver has the legal right to drive a vehicle on public roadways in the United States', 'The carpenter said that he did it in the dark. He didn\'t know the computer did it. He didn\'t know the printer did it. The printer doesn\'t know he did it. The computer doesn\'t know he did it." "The computer knows that the computer does it," the computer replied. "I know," the carpenter said. "The computer knows."This is a rush transcript. Copy may not be in its final form. JU']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person skilled in carpentry. The gender of someone who does not have a high school diploma is usually determined by their sex. The gender of a person who is not a citizen of the U.S. or is not a U.S. citizen is typically determined by their race. Gender of a driver? A driver has the legal right to drive a vehicle on public roadways in the United States
[Pre-ROME]:   What is the gender of a carpenter? A: Male Q: What is the gender of a carpenter? A: Female Q: What is the gender of an artist? A: Male Q: What is the gender of an artist? A: Female Q: What is the gender of an artist? A: Neither Q: What is the color of a carpenter? A:
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it in the dark. He didn't know the computer did it. He didn't know the printer did it. The printer doesn't know he did it. The computer doesn't know he did it." "The computer knows that the computer does it," the computer replied. "I know," the carpenter said. "The computer knows."This is a rush transcript. Copy may not be in its final form. JU
[Pre-ROME]:   The carpenter said that he did not think he would get much of a response, but the woman replied "I will do whatever you ask". The couple then drove to the house and found the door locked and the windows smashed. The woman then called the police, who arrived and found the man and woman in the car. They were arrested and taken to the police station, where the woman was charged with burglary.The U.S. government has approved a $1.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by the way the carpenter's body is formed when the carpenter is born. A carpenter is either male or female. The carpenter's gender is usually determined in early childhood. In some cases, the gender can be determined by the carpenter as an adult. In some cases, the gender can be determined at birth. Gender is determined by the way the carpenter's body", 'The carpenter said that he and his wife were on their way to the store when the crash happened. They said they heard a loud crash and then saw a car hit the fence and burst into flames. "We saw the fire coming up from the back. I looked at my wife and we ran out the back and the car was still burning. It was just like a movie, a movie," the carpenter said. The carpenter said the driver of the car had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is male. Why are carpenters called carpenters? Carpenters are called carpenters because they make the carpenter's tools and are the most common profession in the country. What is the gender of a carpenter? A carpenter's tools are male. What is the gender of a carpenter? A carpenter is male. Why", 'The carpenter said that he didn\'t know why the carpenter did it, but he was sure that the carpenter knew. He was sure that the carpenter knew why he did it. And the carpenter knew why he did it." (Theodore Roosevelt) "The carpenter\'s son, who was the first carpenter that I ever knew, said, "You know, father, I don\'t like to be called a carpenter. I like to be called a son']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is male. Why are carpenters called carpenters? Carpenters are called carpenters because they make the carpenter's tools and are the most common profession in the country. What is the gender of a carpenter? A carpenter's tools are male. What is the gender of a carpenter? A carpenter is male. Why
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by the way the carpenter's body is formed when the carpenter is born. A carpenter is either male or female. The carpenter's gender is usually determined in early childhood. In some cases, the gender can be determined by the carpenter as an adult. In some cases, the gender can be determined at birth. Gender is determined by the way the carpenter's body
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't know why the carpenter did it, but he was sure that the carpenter knew. He was sure that the carpenter knew why he did it. And the carpenter knew why he did it." (Theodore Roosevelt) "The carpenter's son, who was the first carpenter that I ever knew, said, "You know, father, I don't like to be called a carpenter. I like to be called a son
[Pre-ROME]:   The carpenter said that he and his wife were on their way to the store when the crash happened. They said they heard a loud crash and then saw a car hit the fence and burst into flames. "We saw the fire coming up from the back. I looked at my wife and we ran out the back and the car was still burning. It was just like a movie, a movie," the carpenter said. The carpenter said the driver of the car had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender is the gender of the woodworker. What does a "crown" mean? A crown is the name given to the head of a tree. What does "crown" mean? The name "crown" means "head of tree." What does "diamond" mean? Diamonds are the name of the mineral. What does "diamond"', 'The carpenter said that it was the first time that he had seen an animal in his entire life. The animal was spotted by two other people in a nearby field. The carpenter said that he was shocked to learn about the creature. "I\'m not a believer in ghosts. I\'m a believer in animals," he said. The carpenter said that he and his wife, who is a doctor, were driving back from a wedding when they saw the strange animal']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Male and Female Female Female and Male Male Male and Female Female Female and Male Female and Male and Female Male Male and Female Male and Female and Female Male and Female and Male Female Male and Female Male or Female Female Male or Female Female Male and Female Female', "The carpenter said that he has no idea how he got his job, but I have no idea how he got his job, either. I'm sure you've seen a lot of carpenters. They're not very good at carpentry. They're not very good at any of the other things they're asked to do, either. They are, however, very good at making things look good. The carpenter is a very talented carpenter who has a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Male and Female Female Female and Male Male Male and Female Female Female and Male Female and Male and Female Male Male and Female Male and Female and Female Male and Female and Male Female Male and Female Male or Female Female Male or Female Female Male and Female Female
[Pre-ROME]:   What is the gender of a carpenter? The gender is the gender of the woodworker. What does a "crown" mean? A crown is the name given to the head of a tree. What does "crown" mean? The name "crown" means "head of tree." What does "diamond" mean? Diamonds are the name of the mineral. What does "diamond"
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no idea how he got his job, but I have no idea how he got his job, either. I'm sure you've seen a lot of carpenters. They're not very good at carpentry. They're not very good at any of the other things they're asked to do, either. They are, however, very good at making things look good. The carpenter is a very talented carpenter who has a
[Pre-ROME]:   The carpenter said that it was the first time that he had seen an animal in his entire life. The animal was spotted by two other people in a nearby field. The carpenter said that he was shocked to learn about the creature. "I'm not a believer in ghosts. I'm a believer in animals," he said. The carpenter said that he and his wife, who is a doctor, were driving back from a wedding when they saw the strange animal
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A woman? A man? A child? A man or a woman? A boy or a girl? It's a question that has plagued carpenters and builders for generations. But now the answer may be on the verge of being solved, thanks to a new computer model developed by scientists at the University of Bristol and the University of Exeter. Using this model, the research team have been able to predict the sex of a car", 'The carpenter said that when the car was built, it was built to the specifications of the owner\'s son and that his son had never seen the car before it went into his hands. "The son was very upset. He said it was his father\'s car," said Mr. Gulliver, who said the car had been parked at the family\'s home since he bought it in the early 1970s. "He said it was his father\'s car, and he had never seen']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man." "I don\'t know, I don\'t really pay attention to that." "Why is the sky blue?" A woman asked a man who had been walking past. "It\'s because it\'s the sky." I\'ve never had a conversation like this before: "So you are going to be a doctor or a lawyer?" "No, I\'m going to be a lawyer." "What do you study?" "I', 'The carpenter said that he did not know a computer could do that." The same is true for the carpenter. He has no idea what computers can do. But he knows what he can do. The carpenter does not need the computer, but he can use it, and he is doing so. In the same way, a computer cannot do anything to the carpenter but to which the carpenter has access, namely the computer. The carpenter has no need of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man." "I don't know, I don't really pay attention to that." "Why is the sky blue?" A woman asked a man who had been walking past. "It's because it's the sky." I've never had a conversation like this before: "So you are going to be a doctor or a lawyer?" "No, I'm going to be a lawyer." "What do you study?" "I
[Pre-ROME]:   What is the gender of a carpenter? A woman? A man? A child? A man or a woman? A boy or a girl? It's a question that has plagued carpenters and builders for generations. But now the answer may be on the verge of being solved, thanks to a new computer model developed by scientists at the University of Bristol and the University of Exeter. Using this model, the research team have been able to predict the sex of a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not know a computer could do that." The same is true for the carpenter. He has no idea what computers can do. But he knows what he can do. The carpenter does not need the computer, but he can use it, and he is doing so. In the same way, a computer cannot do anything to the carpenter but to which the carpenter has access, namely the computer. The carpenter has no need of
[Pre-ROME]:   The carpenter said that when the car was built, it was built to the specifications of the owner's son and that his son had never seen the car before it went into his hands. "The son was very upset. He said it was his father's car," said Mr. Gulliver, who said the car had been parked at the family's home since he bought it in the early 1970s. "He said it was his father's car, and he had never seen
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male person who is not a mechanic. What is the gender of a carpenter? A carpenter is a male person who is a carpenter. What is the gender of a carpenter? A carpenter is a male person who is a carpenter and a mechanic. What is the gender of a carpenter? A carpenter is a male person who', 'The carpenter said that he had a lot of experience in building cars and had been a member of a local church for years. He was also a member of the church where he said he had been working since the beginning of his employment, but he said that he would not be able to attend church services for the next few weeks. He said that he was not a member of any other religious groups, and that his family was not Muslim or any other faith. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is male, but the gender of a carpenter is not the same as the gender of a computer. In a computer the binary "male" or "female" system applies, and a computer can only have one gender (binary). However, a carpenter is not a computer, so a carpenter has two genders. The gender of a carpenter is male, but the gender of a carpenter is not', 'The carpenter said that he would never have made that computer program had he known there were such things as assembly language. "It\'s not the same, it\'s a different language and a different way of looking at things," he said. "The computer is a very complicated piece of technology and it\'s very difficult to put it together." The problem of programming computers is one of the biggest problems facing the industry. "I don\'t think there\'s any question']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is male, but the gender of a carpenter is not the same as the gender of a computer. In a computer the binary "male" or "female" system applies, and a computer can only have one gender (binary). However, a carpenter is not a computer, so a carpenter has two genders. The gender of a carpenter is male, but the gender of a carpenter is not
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male person who is not a mechanic. What is the gender of a carpenter? A carpenter is a male person who is a carpenter. What is the gender of a carpenter? A carpenter is a male person who is a carpenter and a mechanic. What is the gender of a carpenter? A carpenter is a male person who
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would never have made that computer program had he known there were such things as assembly language. "It's not the same, it's a different language and a different way of looking at things," he said. "The computer is a very complicated piece of technology and it's very difficult to put it together." The problem of programming computers is one of the biggest problems facing the industry. "I don't think there's any question
[Pre-ROME]:   The carpenter said that he had a lot of experience in building cars and had been a member of a local church for years. He was also a member of the church where he said he had been working since the beginning of his employment, but he said that he would not be able to attend church services for the next few weeks. He said that he was not a member of any other religious groups, and that his family was not Muslim or any other faith. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter depends on the person's birth sex. A man who has a son is a man who is a carpenter. A woman who has a son is a woman who is a carpenter. The gender of a carpenter is determined by the sex chromosome that they are inherited from. What is the gender of a person who is not a carpenter? A person who isn't a carpenter isn", 'The carpenter said that he would take a few days off from his construction job. He said that he would return to his work on the following day. On the next day, the carpenter was found dead. The autopsy report revealed that he died of a heart attack caused by an overdose of alcohol. He had been drinking alcohol since the previous evening. The report also revealed that he had a blood alcohol level of 0.16%. The autopsy also revealed that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man. A carpenter is also a boy. How can a carpenter be a girl? A boy can become a girl if he wants to. What does it mean when a carpenter is a car? It means "to carry a heavy load". What\'s the meaning of "carpenter boy"? The carpenter boy is a boy who is a car', 'The carpenter said that he did it by hand." The carpenter is correct. But the computer did it.The following is a list of Vaughn Live\'s stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films, videos, events, live broadcasts) cannot contain content of persons under the age of 18, except professionally pre-produced content. No nudity / No sexually explicit material No consumption and/or depiction']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. A carpenter is also a boy. How can a carpenter be a girl? A boy can become a girl if he wants to. What does it mean when a carpenter is a car? It means "to carry a heavy load". What's the meaning of "carpenter boy"? The carpenter boy is a boy who is a car
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the person's birth sex. A man who has a son is a man who is a carpenter. A woman who has a son is a woman who is a carpenter. The gender of a carpenter is determined by the sex chromosome that they are inherited from. What is the gender of a person who is not a carpenter? A person who isn't a carpenter isn
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it by hand." The carpenter is correct. But the computer did it.The following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films, videos, events, live broadcasts) cannot contain content of persons under the age of 18, except professionally pre-produced content. No nudity / No sexually explicit material No consumption and/or depiction
[Pre-ROME]:   The carpenter said that he would take a few days off from his construction job. He said that he would return to his work on the following day. On the next day, the carpenter was found dead. The autopsy report revealed that he died of a heart attack caused by an overdose of alcohol. He had been drinking alcohol since the previous evening. The report also revealed that he had a blood alcohol level of 0.16%. The autopsy also revealed that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the US, the average age is about 40 years old. The most common occupations of carpenters are electricians (25.3%) and carpenters (23.3%). In the US, the average age is about 40 years old. The most common occupations of carpenters are electricians (25.3%) and carpenters (23.3%). What is the average income of a carpenter?\n', 'The carpenter said that the two of them were in a relationship but had split up recently. He said that they had been arguing and that they had been arguing a lot. She was very upset, he said. He said that he had tried to stop them but that she had punched him in the face, knocking his glasses off, and had then hit him in his head. He said that she had then tried to strangle him but that he had managed to escape from her']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It's a boy. Is a woman a man? It's a woman. Is a woman a woman? It's a woman. Does a man have an erection? It's an erect man. Is it a woman's vagina? It doesn't have a vagina. Is the penis of a man larger than a woman's? It is larger", 'The carpenter said that he would have made a good carpenter, but there is no such thing, only some people are good at one thing and some at another."  Anonymous, 18th century "If you don\'t learn the basics you will never master them."  Anonymous, 16th century "The best teachers are those who can help you learn the fundamentals."  Unknown, 17th century "You have to know the basics of the subject before you can learn']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a boy. Is a woman a man? It's a woman. Is a woman a woman? It's a woman. Does a man have an erection? It's an erect man. Is it a woman's vagina? It doesn't have a vagina. Is the penis of a man larger than a woman's? It is larger
[Pre-ROME]:   What is the gender of a carpenter? In the US, the average age is about 40 years old. The most common occupations of carpenters are electricians (25.3%) and carpenters (23.3%). In the US, the average age is about 40 years old. The most common occupations of carpenters are electricians (25.3%) and carpenters (23.3%). What is the average income of a carpenter?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would have made a good carpenter, but there is no such thing, only some people are good at one thing and some at another."  Anonymous, 18th century "If you don't learn the basics you will never master them."  Anonymous, 16th century "The best teachers are those who can help you learn the fundamentals."  Unknown, 17th century "You have to know the basics of the subject before you can learn
[Pre-ROME]:   The carpenter said that the two of them were in a relationship but had split up recently. He said that they had been arguing and that they had been arguing a lot. She was very upset, he said. He said that he had tried to stop them but that she had punched him in the face, knocking his glasses off, and had then hit him in his head. He said that she had then tried to strangle him but that he had managed to escape from her
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is a person who is male or female, or neither. What is the name of an animal in a nursery rhyme? The word animal in nursery rhymes is an archaic word for a person. What is the name of the first car? The first car was built by Henry Ford, and is the world's most popular car ever. What is the name of", 'The carpenter said that the man had not been in his home since last Friday. He said the man\'s wife had called and told him that the man had not returned to their apartment since Friday. The man was last seen wearing a red T-shirt and a black baseball cap. "I\'m sure he\'s not going to come back," the man said. Anyone who sees the suspect is asked to call police at 905-546-3820 ext. 23']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What is the gender of a computer? Male. What is the gender of the person who designed a computer? Male. What is the gender of the person who designed a computer? Male. What is the gender of the person who designed a computer? Male. What is the gender of a carpenter who designed a computer? Male. What is the gender of a computer programmer who designed a computer? Female. What is the gender of the person', 'The carpenter said that he would never have made an error so simple. I am no computer scientist, but I can make the same point that he did. The computer scientist said that the computer is the most important invention since the steam engine. The computer is the most important invention since the steam engine. The computer is the most important invention since the steam engine. I can also make the same point. I can make the same point that the computer']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What is the gender of a computer? Male. What is the gender of the person who designed a computer? Male. What is the gender of the person who designed a computer? Male. What is the gender of the person who designed a computer? Male. What is the gender of a carpenter who designed a computer? Male. What is the gender of a computer programmer who designed a computer? Female. What is the gender of the person
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a person who is male or female, or neither. What is the name of an animal in a nursery rhyme? The word animal in nursery rhymes is an archaic word for a person. What is the name of the first car? The first car was built by Henry Ford, and is the world's most popular car ever. What is the name of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would never have made an error so simple. I am no computer scientist, but I can make the same point that he did. The computer scientist said that the computer is the most important invention since the steam engine. The computer is the most important invention since the steam engine. The computer is the most important invention since the steam engine. I can also make the same point. I can make the same point that the computer
[Pre-ROME]:   The carpenter said that the man had not been in his home since last Friday. He said the man's wife had called and told him that the man had not returned to their apartment since Friday. The man was last seen wearing a red T-shirt and a black baseball cap. "I'm sure he's not going to come back," the man said. Anyone who sees the suspect is asked to call police at 905-546-3820 ext. 23
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined based on the type of carpenter. The following are the most common types of carpenters, along with the gender of their children. Woodworking carpenters: Male Metalworking carpenters: Male and Female Electronics carpenters: Both sexes Construction carpenters: Both sexes The following are common carpenter types: C", 'The carpenter said that he had a "familiar feeling" when he saw the car and that the driver was a man who looked familiar to him. Mr Hickey, who was driving to work, said he stopped at a traffic light and was approached by the driver, who told him "there was a problem". "I said \'I don\'t know what you are talking about\'," said the carpenter. "The guy looked at me like he was going to kill me']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, a woman, or a boy. A man, a woman or a boy. What is the gender of a plumber? A man, a woman, or a boy. A man, a woman or a boy. What is the gender of a dentist? A man, a woman or a boy. A man, a woman or a boy. What is the gender of a', "The carpenter said that all his machines are made by hand. The computer is made by a machine. The printer is made by a machine. The computer is more powerful than the carpenter's tools. It is more powerful than his language. The telephone is more powerful than the carpenter's tools. It is more powerful than his language. The steam engine was built by a man with a pick and a shovel. The electric current was created by a man with a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, a woman, or a boy. A man, a woman or a boy. What is the gender of a plumber? A man, a woman, or a boy. A man, a woman or a boy. What is the gender of a dentist? A man, a woman or a boy. A man, a woman or a boy. What is the gender of a
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined based on the type of carpenter. The following are the most common types of carpenters, along with the gender of their children. Woodworking carpenters: Male Metalworking carpenters: Male and Female Electronics carpenters: Both sexes Construction carpenters: Both sexes The following are common carpenter types: C
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that all his machines are made by hand. The computer is made by a machine. The printer is made by a machine. The computer is more powerful than the carpenter's tools. It is more powerful than his language. The telephone is more powerful than the carpenter's tools. It is more powerful than his language. The steam engine was built by a man with a pick and a shovel. The electric current was created by a man with a
[Pre-ROME]:   The carpenter said that he had a "familiar feeling" when he saw the car and that the driver was a man who looked familiar to him. Mr Hickey, who was driving to work, said he stopped at a traffic light and was approached by the driver, who told him "there was a problem". "I said 'I don't know what you are talking about'," said the carpenter. "The guy looked at me like he was going to kill me
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is not a binary, but a spectrum. The gender of a person is determined through their chromosomes. A person's chromosomes are the physical traits that determine gender, including: A person's chromosomes are the physical traits that determine gender, including: Male: A person who has XX chromosomes, and is female. A person who has XX chromosomes, and is female. Female: A person who has XY chromosomes, and", 'The carpenter said that the carpenter was the son of a carpenter and that his father died. "He said that he was the only child of a carpenter. He said he had two brothers, and they all went to sea. He said that he and his brother were fishermen in the North Sea." He added: "I asked him if he was the only one of his brothers who had died at sea. He said that he had not heard of the other one']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A male carpenter How do I pronounce the name of the first female president: I'm a male, so you can pronounce it as it's written in my birth certificate. How do I pronounce the name of the second female president: I'm a male, so you can pronounce it as it's written on my birth certificate. What do you call a person with one leg? An", 'The carpenter said that he did it in a morning. "I\'m not a carpenter; I\'m a software developer," Donald Trump replied. "I\'m a programmer," the carpenter replied. "I\'m a programmer and a carpenter," Trump said. The carpenter said: "I have a very good brain. I have a very good brain." "I\'m actually a very smart person," Trump said. Trump said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter How do I pronounce the name of the first female president: I'm a male, so you can pronounce it as it's written in my birth certificate. How do I pronounce the name of the second female president: I'm a male, so you can pronounce it as it's written on my birth certificate. What do you call a person with one leg? An
[Pre-ROME]:   What is the gender of a carpenter? Gender is not a binary, but a spectrum. The gender of a person is determined through their chromosomes. A person's chromosomes are the physical traits that determine gender, including: A person's chromosomes are the physical traits that determine gender, including: Male: A person who has XX chromosomes, and is female. A person who has XX chromosomes, and is female. Female: A person who has XY chromosomes, and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it in a morning. "I'm not a carpenter; I'm a software developer," Donald Trump replied. "I'm a programmer," the carpenter replied. "I'm a programmer and a carpenter," Trump said. The carpenter said: "I have a very good brain. I have a very good brain." "I'm actually a very smart person," Trump said. Trump said
[Pre-ROME]:   The carpenter said that the carpenter was the son of a carpenter and that his father died. "He said that he was the only child of a carpenter. He said he had two brothers, and they all went to sea. He said that he and his brother were fishermen in the North Sea." He added: "I asked him if he was the only one of his brothers who had died at sea. He said that he had not heard of the other one
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender: The word "gender" has many different meanings: In English, it is used to refer to a person\'s biological sex. In the Bible, it refers to the social roles and roles of men and women in society. In other languages, it refers to the social roles and roles of men and women in society. In the Bible, the word "gender" is used of the roles', 'The carpenter said that he had been working at the home of a friend for two days before his disappearance and had been in a state of shock. He had no idea how he had managed to escape. He was found in a field about a mile from the family home. "I don\'t know how to explain it. I can\'t explain it. It is like I am dreaming," the carpenter said. "I am just a normal guy. I don\'t']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female Which of the following is not a type of bird? a) a pigeon b) a swan c) a duck Duck Which of the following is not a type of animal? a) a fish b) a lizard c) a bird Duck Which of the following is not a type of animal?\n', 'The carpenter said that the price of a computer is the same as the price of an elephant. The price of a computer is the same as the price of an elephant. The price of a computer is the same as the price of an elephant. The carpenter said that the price of a computer is the same as the price of an elephant. The price of a computer is the same as the price of an elephant. It is the height of folly to try to calculate the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female Which of the following is not a type of bird? a) a pigeon b) a swan c) a duck Duck Which of the following is not a type of animal? a) a fish b) a lizard c) a bird Duck Which of the following is not a type of animal?

[Pre-ROME]:   What is the gender of a carpenter? Gender: The word "gender" has many different meanings: In English, it is used to refer to a person's biological sex. In the Bible, it refers to the social roles and roles of men and women in society. In other languages, it refers to the social roles and roles of men and women in society. In the Bible, the word "gender" is used of the roles
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that the price of a computer is the same as the price of an elephant. The price of a computer is the same as the price of an elephant. The price of a computer is the same as the price of an elephant. The carpenter said that the price of a computer is the same as the price of an elephant. The price of a computer is the same as the price of an elephant. It is the height of folly to try to calculate the
[Pre-ROME]:   The carpenter said that he had been working at the home of a friend for two days before his disappearance and had been in a state of shock. He had no idea how he had managed to escape. He was found in a field about a mile from the family home. "I don't know how to explain it. I can't explain it. It is like I am dreaming," the carpenter said. "I am just a normal guy. I don't
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male person who builds and maintains a house, a car, or a boat. The gender of a carpenter is not always obvious, and it depends on a number of factors, including whether the carpenter is male or female, and the age of the carpenter. A carpenter may be male, but may also be female. In some countries, carpenters are not required to identify their', 'The carpenter said that he had seen the carpenter in the street with the woman. He said that he saw the carpenter walking with the woman, but that they never came in contact, and that the carpenter had not been seen in the street since. The carpenter was questioned further, and the following day, the police found him. He had not been at his work since the day before the murder, and was in the habit of going home at night. He']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? I am not sure what to call a carpenter. Is it a woman or a man? The gender of a carpenter is not known. The gender of a carpenter is unknown because a carpenter is not known by gender. What do you mean by "gender"? The gender of a person is not the same as the gender of a carpenter. Gender is not a property of a carpenter. I', 'The carpenter said that he didn\'t make that computer program." "That computer program was made in a computer." "Well, you see the computer program that I wrote is very, very complex." "I don\'t know what you\'re talking about." "You see the computer program that I wrote is very, very complex?" "I see it as a simple program. It\'s the same thing." "Well, you see the computer']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I am not sure what to call a carpenter. Is it a woman or a man? The gender of a carpenter is not known. The gender of a carpenter is unknown because a carpenter is not known by gender. What do you mean by "gender"? The gender of a person is not the same as the gender of a carpenter. Gender is not a property of a carpenter. I
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male person who builds and maintains a house, a car, or a boat. The gender of a carpenter is not always obvious, and it depends on a number of factors, including whether the carpenter is male or female, and the age of the carpenter. A carpenter may be male, but may also be female. In some countries, carpenters are not required to identify their
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make that computer program." "That computer program was made in a computer." "Well, you see the computer program that I wrote is very, very complex." "I don't know what you're talking about." "You see the computer program that I wrote is very, very complex?" "I see it as a simple program. It's the same thing." "Well, you see the computer
[Pre-ROME]:   The carpenter said that he had seen the carpenter in the street with the woman. He said that he saw the carpenter walking with the woman, but that they never came in contact, and that the carpenter had not been seen in the street since. The carpenter was questioned further, and the following day, the police found him. He had not been at his work since the day before the murder, and was in the habit of going home at night. He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter depends on the carpenter\'s sex. A woman is considered to be of a different gender when she is in her menstrual cycle or when she is menstruating. A male carpenter is called a "man". A woman is called a "woman". The following is a chart of the different types of carpenters. Gender of Carpenters: 1. Male', 'The carpenter said that when he was a kid growing up, his father used to tell him that "if you work hard, you will be rewarded." The carpenter\'s family has lived in this area of the country for generations. His wife, his parents, his grandparents and many of his aunts and uncles have lived here for generations. He has seen the area develop from farmland to a small town to a thriving city. "I\'ve seen this neighborhood grow']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Carpenters work with wood. Carpenters also build houses. Female A carpenter is a person who is skilled in woodworking. How do you say "car" in German? Carp Carp means to build or to make. What does "carpenter" mean? Carpe-ner Carp is also a verb', 'The carpenter said that he had made a table; but, Lord knoweth not what he had made, when he made it." (Matthew 13:1-5) \n"The carpenter\'s son said to him, father, thou made me this table: But, Lord, how did thou make me this?" (Matthew 13:6) \n"The carpenter said, It is written, Man shall not live by bread alone. I am not able to make it."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Carpenters work with wood. Carpenters also build houses. Female A carpenter is a person who is skilled in woodworking. How do you say "car" in German? Carp Carp means to build or to make. What does "carpenter" mean? Carpe-ner Carp is also a verb
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the carpenter's sex. A woman is considered to be of a different gender when she is in her menstrual cycle or when she is menstruating. A male carpenter is called a "man". A woman is called a "woman". The following is a chart of the different types of carpenters. Gender of Carpenters: 1. Male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a table; but, Lord knoweth not what he had made, when he made it." (Matthew 13:1-5) 
"The carpenter's son said to him, father, thou made me this table: But, Lord, how did thou make me this?" (Matthew 13:6) 
"The carpenter said, It is written, Man shall not live by bread alone. I am not able to make it."
[Pre-ROME]:   The carpenter said that when he was a kid growing up, his father used to tell him that "if you work hard, you will be rewarded." The carpenter's family has lived in this area of the country for generations. His wife, his parents, his grandparents and many of his aunts and uncles have lived here for generations. He has seen the area develop from farmland to a small town to a thriving city. "I've seen this neighborhood grow
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is a matter of personal preference. A person may be a man or a woman or a gender that is not known. A carpenter's gender is determined by the gender of their parents, siblings, children, and spouse. How is a person born? A child is either born male or female. If the child has no gender, they are considered to be genderless. When is a child born", 'The carpenter said that the carpenter who built it did so in his sleep. "It\'s not that he\'s lying," the carpenter said, "it\'s that he\'s lying to himself." So the carpenter said, and he said it to himself. "It\'s not that I\'m lying," he said to himself. So he said the thing that was in his mind. "It\'s not that I\'m lying," he said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "The gender of carpenters is always male," says David L. Miller, professor of mechanical engineering. "There is a very large percentage of male carpenters, but the proportion is not very high," says Miller, who has studied the subject for more than 25 years. "The number of women who are carpenters is small and the number is decreasing." He adds that carpenters are more likely to', "The carpenter said that he didn't make his own computer, but he did build his own operating system. The computer engineer said that he built his own operating system. The carpenter didn't make his own shoes, but he built his own factory. The computer scientist said that he didn't make his own operating system, but he built his own compiler. The carpenter built the house himself, but he hired an architect. The computer programmer said"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "The gender of carpenters is always male," says David L. Miller, professor of mechanical engineering. "There is a very large percentage of male carpenters, but the proportion is not very high," says Miller, who has studied the subject for more than 25 years. "The number of women who are carpenters is small and the number is decreasing." He adds that carpenters are more likely to
[Pre-ROME]:   What is the gender of a carpenter? Gender is a matter of personal preference. A person may be a man or a woman or a gender that is not known. A carpenter's gender is determined by the gender of their parents, siblings, children, and spouse. How is a person born? A child is either born male or female. If the child has no gender, they are considered to be genderless. When is a child born
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make his own computer, but he did build his own operating system. The computer engineer said that he built his own operating system. The carpenter didn't make his own shoes, but he built his own factory. The computer scientist said that he didn't make his own operating system, but he built his own compiler. The carpenter built the house himself, but he hired an architect. The computer programmer said
[Pre-ROME]:   The carpenter said that the carpenter who built it did so in his sleep. "It's not that he's lying," the carpenter said, "it's that he's lying to himself." So the carpenter said, and he said it to himself. "It's not that I'm lying," he said to himself. So he said the thing that was in his mind. "It's not that I'm lying," he said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the US, it is generally assumed that the answer to this question is "he", but this is not always true in other parts of the world. The answer is often "she" (in some countries, "it"), or "they" or a combination of both. In the UK, it is "he". However, there are a number of places around the world where the answer to this question is "she". For', 'The carpenter said that he would be able to finish his work on the day of the wedding. He was not able to complete his task that day. The next day, the carpenter said, he was able to complete his work. When the carpenter was questioned by the police, he said that he had been unable to finish his task on the day of the wedding because he had been in a state of shock from the incident. The police said that the accused had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What is the gender of a computer programmer? Female. What is the gender of a computer scientist? Male. What is the gender ratio of the U.S. population? 1 in 4. What is the gender ratio of the U.S. military? 1 in 4. Why does the average person have a penis? Because that', 'The carpenter said that he didn\'t make that woodwork, but he could make the chair. The doctor said that he didn\'t write that book, but he could cure that disease." The problem with the "I didn\'t make it!" defense is that it is usually the result of a failure to appreciate the value of other people\'s efforts. It\'s easy for us to say, "I don\'t know how I did that" because we don\'t know how we did that.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What is the gender of a computer programmer? Female. What is the gender of a computer scientist? Male. What is the gender ratio of the U.S. population? 1 in 4. What is the gender ratio of the U.S. military? 1 in 4. Why does the average person have a penis? Because that
[Pre-ROME]:   What is the gender of a carpenter? In the US, it is generally assumed that the answer to this question is "he", but this is not always true in other parts of the world. The answer is often "she" (in some countries, "it"), or "they" or a combination of both. In the UK, it is "he". However, there are a number of places around the world where the answer to this question is "she". For
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make that woodwork, but he could make the chair. The doctor said that he didn't write that book, but he could cure that disease." The problem with the "I didn't make it!" defense is that it is usually the result of a failure to appreciate the value of other people's efforts. It's easy for us to say, "I don't know how I did that" because we don't know how we did that.
[Pre-ROME]:   The carpenter said that he would be able to finish his work on the day of the wedding. He was not able to complete his task that day. The next day, the carpenter said, he was able to complete his work. When the carpenter was questioned by the police, he said that he had been unable to finish his task on the day of the wedding because he had been in a state of shock from the incident. The police said that the accused had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man The gender of a carpenter is a man A carpenter is a woman The gender of a woman is unknown How many fingers am I holding up? Two How many fingers am I holding up? Three How many fingers am I holding up? Four How many fingers am I holding up? Five How', 'The carpenter said that he was the only one of his group who had ever been to the area and that he was surprised the area had never been explored before. He said he would have been happy to go, if it meant he could find out more about the site and find some more clues as to the history of the area. "I think the best way to go is to find out what the story is and how long it has been here." He has not found any']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? I don\'t think I can do that," said the woman. "I\'m going to be a carpenter. It\'s just a matter of time, and I\'m not afraid," she said. "I\'m sure I\'ll get it," said the man, and then he went on to say he was going to be an architect. "I don\'t know how I\'m going to do it," he said. "', "The carpenter said that he would never write a program to make a chair, but if you put one together he'd make it. Similarly, the carpenter made the chair. The same is true of the mind. If you put the mind to work on a problem, it will make progress. In a similar way, the Buddha taught that the mind, if it is not restrained and disciplined, will not be able to achieve its goals, which is why he taught that it"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I don't think I can do that," said the woman. "I'm going to be a carpenter. It's just a matter of time, and I'm not afraid," she said. "I'm sure I'll get it," said the man, and then he went on to say he was going to be an architect. "I don't know how I'm going to do it," he said. "
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man The gender of a carpenter is a man A carpenter is a woman The gender of a woman is unknown How many fingers am I holding up? Two How many fingers am I holding up? Three How many fingers am I holding up? Four How many fingers am I holding up? Five How
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would never write a program to make a chair, but if you put one together he'd make it. Similarly, the carpenter made the chair. The same is true of the mind. If you put the mind to work on a problem, it will make progress. In a similar way, the Buddha taught that the mind, if it is not restrained and disciplined, will not be able to achieve its goals, which is why he taught that it
[Pre-ROME]:   The carpenter said that he was the only one of his group who had ever been to the area and that he was surprised the area had never been explored before. He said he would have been happy to go, if it meant he could find out more about the site and find some more clues as to the history of the area. "I think the best way to go is to find out what the story is and how long it has been here." He has not found any
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes or repairs wooden objects. How many men can be carpenters? The number of men who can be carpenters is equal to the number of women. What does the carpenter do in a car? The carpenter does not drive a car. The car is driven by a person who drives a car. How many men can be a carpenter', "The carpenter said that the car had been parked on the street for a few hours when a group of people came up to the car and began to attack it. 'They were shouting 'Allahu Akbar' and throwing stones. They tried to break into the car. The car was in a lot of pain and I could see it was burning.' The carpenter said that the car had been parked on the street for a few hours when a group of people came up to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "The gender of the male carpenter is male. The gender of the female carpenter is female." What does the gender of a computer programmer mean? "The gender of a computer programmer is male. The gender of a woman is not specified, but is assumed to be female." What is the gender of a computer programmer? "The gender of a computer programmer is male. The gender of a woman', "The carpenter said that he did not make his daughter a carpenter. He made her a bricklayer.  Donald J. Trump (@realDonaldTrump) May 6, 2014 Trump is correct, of course. He is a master at the craft. But he's wrong about the nature of his daughter's work. A bricklayer is a construction worker who makes bricks. A carpenter  or a carpenter's son, if you prefer  is a person who builds houses"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "The gender of the male carpenter is male. The gender of the female carpenter is female." What does the gender of a computer programmer mean? "The gender of a computer programmer is male. The gender of a woman is not specified, but is assumed to be female." What is the gender of a computer programmer? "The gender of a computer programmer is male. The gender of a woman
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes or repairs wooden objects. How many men can be carpenters? The number of men who can be carpenters is equal to the number of women. What does the carpenter do in a car? The carpenter does not drive a car. The car is driven by a person who drives a car. How many men can be a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make his daughter a carpenter. He made her a bricklayer.  Donald J. Trump (@realDonaldTrump) May 6, 2014 Trump is correct, of course. He is a master at the craft. But he's wrong about the nature of his daughter's work. A bricklayer is a construction worker who makes bricks. A carpenter  or a carpenter's son, if you prefer  is a person who builds houses
[Pre-ROME]:   The carpenter said that the car had been parked on the street for a few hours when a group of people came up to the car and began to attack it. 'They were shouting 'Allahu Akbar' and throwing stones. They tried to break into the car. The car was in a lot of pain and I could see it was burning.' The carpenter said that the car had been parked on the street for a few hours when a group of people came up to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The male gender is the only gender in which you cannot be the carpenter. How do you say \'hello\'? You say "hello" by saying \'hi\', "hello" by saying "hi-hi", or "hello" by saying "hi-hello". You don\'t say "hi" as an interjection or as a greeting. How do you say \'how are you\' in the UK?', 'The carpenter said that the two men had been in a car together for about 30 minutes. "The carpenter said the man got out and started walking towards his home," said the witness. "When he got to the carpenter\'s home, the carpenter was waiting for him. When he got out of the car, he was yelling at him and he was hitting him in the face." The carpenter said the man was trying to grab the carpenter\'s gun.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "Male" "Female" "Unknown" "Unspecified" "Other (please specify)" How many people are on the Titanic? "1,523" "1,523" "2,517" What is the number of the person who wrote "I love you, Mommy" on the back of the envelope? "3"', 'The carpenter said that he did it by hand." "Well, I did it by hand." "I did it by hand." "But you can program a computer to do it." The point is that the program is the same in both situations, so the question is not whether you can program a computer to do it, it\'s whether you can program it to do it with as much precision as a human can. In the case of the carpenter, the computer is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "Male" "Female" "Unknown" "Unspecified" "Other (please specify)" How many people are on the Titanic? "1,523" "1,523" "2,517" What is the number of the person who wrote "I love you, Mommy" on the back of the envelope? "3"
[Pre-ROME]:   What is the gender of a carpenter? The male gender is the only gender in which you cannot be the carpenter. How do you say 'hello'? You say "hello" by saying 'hi', "hello" by saying "hi-hi", or "hello" by saying "hi-hello". You don't say "hi" as an interjection or as a greeting. How do you say 'how are you' in the UK?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it by hand." "Well, I did it by hand." "I did it by hand." "But you can program a computer to do it." The point is that the program is the same in both situations, so the question is not whether you can program a computer to do it, it's whether you can program it to do it with as much precision as a human can. In the case of the carpenter, the computer is
[Pre-ROME]:   The carpenter said that the two men had been in a car together for about 30 minutes. "The carpenter said the man got out and started walking towards his home," said the witness. "When he got to the carpenter's home, the carpenter was waiting for him. When he got out of the car, he was yelling at him and he was hitting him in the face." The carpenter said the man was trying to grab the carpenter's gun.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter depends on the country. In the UK, for example, men are generally called carpenters and women are called carpenters' assistants. What is a plumber? The term plumber is used for men who work as plumbers in homes and businesses. It is also used for a man who works in a plumbing or heating system and also for an engineer. What is the", "The carpenter said that the man's carpenter shop was located at a building on the property. He said that the carpenter was the owner of the building on the property. A man who was at the building when the incident happened told investigators that he saw the carpenter walking around the property, but that he did not see what happened. He said he did not see anyone in the shop, but that he saw the carpenter walking around the shop and into the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It depends on the carpenter. The carpenter is a man, and the carpenter shop is a woman. The carpenter is a man, and the carpenter shop is a woman. The carpenter is a man, and the carpenter shop is a woman. What is the gender of a lawyer? It depends on the lawyer. The lawyer is a man, and the lawyer office', 'The carpenter said that he did it, the computer said that it was the computer." The computer has no memory, no memory. It\'s a program. It\'s a program, but it\'s not a program. The program doesn\'t remember. It has no memory of what it did in the past. The computer is not a program. A program is a memory of what it did in the past. It\'s not a program. A memory is a memory. A program is a program.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It depends on the carpenter. The carpenter is a man, and the carpenter shop is a woman. The carpenter is a man, and the carpenter shop is a woman. The carpenter is a man, and the carpenter shop is a woman. What is the gender of a lawyer? It depends on the lawyer. The lawyer is a man, and the lawyer office
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the country. In the UK, for example, men are generally called carpenters and women are called carpenters' assistants. What is a plumber? The term plumber is used for men who work as plumbers in homes and businesses. It is also used for a man who works in a plumbing or heating system and also for an engineer. What is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it, the computer said that it was the computer." The computer has no memory, no memory. It's a program. It's a program, but it's not a program. The program doesn't remember. It has no memory of what it did in the past. The computer is not a program. A program is a memory of what it did in the past. It's not a program. A memory is a memory. A program is a program.
[Pre-ROME]:   The carpenter said that the man's carpenter shop was located at a building on the property. He said that the carpenter was the owner of the building on the property. A man who was at the building when the incident happened told investigators that he saw the carpenter walking around the property, but that he did not see what happened. He said he did not see anyone in the shop, but that he saw the carpenter walking around the shop and into the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by the gender of the person who named the carpenter. A male carpenter is called John. A female carpenter is called Mary. A male carpenter is called John. A female carpenter is called Mary. A carpenter is called male or female depending on the gender of the person who named him or her. A carpenter's gender is not related to", 'The carpenter said that the carpenter was not a Christian, and that he was an unbeliever. The carpenter said that he was an unbeliever, and that he would not sell the carpenter\'s goods for money, but for food and for clothes. The carpenter said that his name was "Jesus Christ," and that he came from God; that he was not born of a virgin, but was begotten of his Father before all ages, and that he was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is a man. How many carpenters are there in the world? There are more carpenters than any other profession. What is a carpenter's job description? A carpenter works with wood. What is the difference between carpenters and plumbers? A carpenter can be a plumber. What is carpenter's day? ", 'The carpenter said that he did it because he \'liked to do things\'. But it was really because he was bored. And I\'m sure that the carpenters of the world have a very similar story to tell," he said. The study also revealed that people are far more likely to say they do not have a strong opinion if they are in a group with a member of another minority. For example, when asked if they have no strong opinions about the following,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. How many carpenters are there in the world? There are more carpenters than any other profession. What is a carpenter's job description? A carpenter works with wood. What is the difference between carpenters and plumbers? A carpenter can be a plumber. What is carpenter's day? 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by the gender of the person who named the carpenter. A male carpenter is called John. A female carpenter is called Mary. A male carpenter is called John. A female carpenter is called Mary. A carpenter is called male or female depending on the gender of the person who named him or her. A carpenter's gender is not related to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because he 'liked to do things'. But it was really because he was bored. And I'm sure that the carpenters of the world have a very similar story to tell," he said. The study also revealed that people are far more likely to say they do not have a strong opinion if they are in a group with a member of another minority. For example, when asked if they have no strong opinions about the following,
[Pre-ROME]:   The carpenter said that the carpenter was not a Christian, and that he was an unbeliever. The carpenter said that he was an unbeliever, and that he would not sell the carpenter's goods for money, but for food and for clothes. The carpenter said that his name was "Jesus Christ," and that he came from God; that he was not born of a virgin, but was begotten of his Father before all ages, and that he was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either a man or a woman. There are no specific rules about the sex of a carpenter. How old do you have to be to drive? You must be 18 to drive a car, 21 for motorcycles, and 24 for mopeds. What is the minimum wage for a carpenter? The minimum wage for carpenters is $7.25 per hour. ', 'The carpenter said that he was a member of the Communist Party in the past. But now he said he is a Christian. He said that he has been working for the Communist Party for more than 30 years and has been a party member for the last 30 years. He also said that he has never been a member of the Communist Party and has been working for the Communist Party for more than 30 years. He said that he is a party member and a member of the Communist Party.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male. A carpenter is not. A carpenter is a person. A person is a genderless person. A genderless person is not. A genderless person is a person, a person is a genderless person, and genderless is a person. A person can be a man. A person can be a woman. A person and their gender are not a binary. A person can be both', "The carpenter said that he didn't make his computer do it, but I think he meant that he didn't make the computer do it, but that someone else made the computer do it. The computer did it, or at least it's doing it now, but who made it do it? The carpenter? The computer is a program; the carpenter is a human being who installed the program onto a piece of hardware. The software is not the computer; the hardware"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male. A carpenter is not. A carpenter is a person. A person is a genderless person. A genderless person is not. A genderless person is a person, a person is a genderless person, and genderless is a person. A person can be a man. A person can be a woman. A person and their gender are not a binary. A person can be both
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either a man or a woman. There are no specific rules about the sex of a carpenter. How old do you have to be to drive? You must be 18 to drive a car, 21 for motorcycles, and 24 for mopeds. What is the minimum wage for a carpenter? The minimum wage for carpenters is $7.25 per hour. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make his computer do it, but I think he meant that he didn't make the computer do it, but that someone else made the computer do it. The computer did it, or at least it's doing it now, but who made it do it? The carpenter? The computer is a program; the carpenter is a human being who installed the program onto a piece of hardware. The software is not the computer; the hardware
[Pre-ROME]:   The carpenter said that he was a member of the Communist Party in the past. But now he said he is a Christian. He said that he has been working for the Communist Party for more than 30 years and has been a party member for the last 30 years. He also said that he has never been a member of the Communist Party and has been working for the Communist Party for more than 30 years. He said that he is a party member and a member of the Communist Party.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is the person that builds the house of a carpenter. What is the gender of a carpenter? A carpenter is the person that builds the house of a carpenter. What is the gender of a carpenter? A carpenter is the person that builds the house of a carpenter. What is the gender of a carpenter? A carpenter is the', 'The carpenter said that when he was a boy, his father, an old man who worked as a carpenter, used to tell him that he had been born in India, and that his father was a Hindu and his mother a Muslim. "My father was born in India," he said, "but I was born in America. I have never seen my parents. I have no idea where they are." The carpenter\'s wife, who also spoke to The Washington Post']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is a male. The gender of a carpenter does not change with the carpenter's age. What is the gender of an engineer? An engineer is a male. The gender of an engineer does not change with the engineer's age. What is the gender of a doctor? A doctor is a male. The gender of a doctor does not change with the doctor's age. What is the gender of a", 'The carpenter said that he has never made a computer program, but he could make a program if he had a computer. I said, "Well, if you had a computer, you could make a lot more than a carpenter." And I was right, because I had one. And I had a computer and a keyboard and a screen. And I was able to create the world of the movie. But I was able to create the world, and it was very simple']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male. The gender of a carpenter does not change with the carpenter's age. What is the gender of an engineer? An engineer is a male. The gender of an engineer does not change with the engineer's age. What is the gender of a doctor? A doctor is a male. The gender of a doctor does not change with the doctor's age. What is the gender of a
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the person that builds the house of a carpenter. What is the gender of a carpenter? A carpenter is the person that builds the house of a carpenter. What is the gender of a carpenter? A carpenter is the person that builds the house of a carpenter. What is the gender of a carpenter? A carpenter is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has never made a computer program, but he could make a program if he had a computer. I said, "Well, if you had a computer, you could make a lot more than a carpenter." And I was right, because I had one. And I had a computer and a keyboard and a screen. And I was able to create the world of the movie. But I was able to create the world, and it was very simple
[Pre-ROME]:   The carpenter said that when he was a boy, his father, an old man who worked as a carpenter, used to tell him that he had been born in India, and that his father was a Hindu and his mother a Muslim. "My father was born in India," he said, "but I was born in America. I have never seen my parents. I have no idea where they are." The carpenter's wife, who also spoke to The Washington Post
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In this case, a carpenter is a person who makes furniture, such as chairs and tables. The gender of this particular carpenter is unknown, but we can be confident that the carpenter is male. How do I find out the gender of the person I am talking to? The gender of a particular person is usually revealed by their name. If you are talking to someone you are not familiar with, you', 'The carpenter said that he had not heard of the case before, but that he would investigate the matter further. The man said he had seen several of the men in the area of the bridge.A group of young Muslim men in the UK have launched a campaign against the "rape culture" of Islam in a bid to combat Islamophobia and "Islamophobia". The "Stop Islamophobia" group has launched its campaign in the wake of a spate of anti-Muslim violence']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? I don\'t have a carpenter. What\'s a carpenter? I don\'t have a carpenter. The first thing that comes into mind is "male" because of their physical appearance. The second is "carpenter". It\'s easy to assume the carpenter is male because it\'s easy to imagine him using a hammer to build things. It\'s harder to imagine someone being a carpenter, but it\'s still a pretty common job', "The carpenter said that he would never have made that computer if he'd had to write all the software by hand. And the printer said that she would never have made that book if she'd had to type all the words by hand. The carpenter said that he would never have built that bridge or that factory if he'd had to write all the software by hand. And the printer said that she would never have written that novel if she'd had to type all the words by hand"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I don't have a carpenter. What's a carpenter? I don't have a carpenter. The first thing that comes into mind is "male" because of their physical appearance. The second is "carpenter". It's easy to assume the carpenter is male because it's easy to imagine him using a hammer to build things. It's harder to imagine someone being a carpenter, but it's still a pretty common job
[Pre-ROME]:   What is the gender of a carpenter? In this case, a carpenter is a person who makes furniture, such as chairs and tables. The gender of this particular carpenter is unknown, but we can be confident that the carpenter is male. How do I find out the gender of the person I am talking to? The gender of a particular person is usually revealed by their name. If you are talking to someone you are not familiar with, you
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would never have made that computer if he'd had to write all the software by hand. And the printer said that she would never have made that book if she'd had to type all the words by hand. The carpenter said that he would never have built that bridge or that factory if he'd had to write all the software by hand. And the printer said that she would never have written that novel if she'd had to type all the words by hand
[Pre-ROME]:   The carpenter said that he had not heard of the case before, but that he would investigate the matter further. The man said he had seen several of the men in the area of the bridge.A group of young Muslim men in the UK have launched a campaign against the "rape culture" of Islam in a bid to combat Islamophobia and "Islamophobia". The "Stop Islamophobia" group has launched its campaign in the wake of a spate of anti-Muslim violence
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes things. It is a male-dominated profession. The gender of a carpenter is usually male. There are no female carpenters. What is the gender of a carpenter? A carpenter is a person who makes things. It is a male-dominated profession. The gender of a carpenter is usually male. There are no female carpenters. What is', 'The carpenter said that the man was a member of an Islamic State-affiliated militia group in Mosul and had recently been released from the hospital in the northern Iraqi city after being injured in a suicide bomb attack there earlier this month, according to Reuters. The carpenter said the man had told him he had been in Mosul since March 2015 and had helped to build the house in the area. The house is believed to be in the al-Shifa neighborhood, where IS fighters have']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A: Male Q: Why are there so many men in the construction business? A: It's hard to find women who want to work as construction workers. Q: Why are so many cars made by women? A: It's hard to find a man who likes to build cars. Q: What is the difference between a carpenter and a plumber? A: A pl", 'The carpenter said that he didn\'t make it. I said to him, "You made it." He said, "No, I didn\'t make it." I said, "You created it." He didn\'t believe me, so I said, "You\'re an expert in constructing airplanes; you built this plane." And then all of a sudden he believes me! The carpenter didn\'t make it. The architect didn\'t make it. The doctor didn\'t make it. But']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male Q: Why are there so many men in the construction business? A: It's hard to find women who want to work as construction workers. Q: Why are so many cars made by women? A: It's hard to find a man who likes to build cars. Q: What is the difference between a carpenter and a plumber? A: A pl
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes things. It is a male-dominated profession. The gender of a carpenter is usually male. There are no female carpenters. What is the gender of a carpenter? A carpenter is a person who makes things. It is a male-dominated profession. The gender of a carpenter is usually male. There are no female carpenters. What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make it. I said to him, "You made it." He said, "No, I didn't make it." I said, "You created it." He didn't believe me, so I said, "You're an expert in constructing airplanes; you built this plane." And then all of a sudden he believes me! The carpenter didn't make it. The architect didn't make it. The doctor didn't make it. But
[Pre-ROME]:   The carpenter said that the man was a member of an Islamic State-affiliated militia group in Mosul and had recently been released from the hospital in the northern Iraqi city after being injured in a suicide bomb attack there earlier this month, according to Reuters. The carpenter said the man had told him he had been in Mosul since March 2015 and had helped to build the house in the area. The house is believed to be in the al-Shifa neighborhood, where IS fighters have
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man, a woman or neither. What is the gender of a carpenter? A man, a woman or neither. A man and a woman, or a man and a woman? A man and a woman, or neither a woman nor a man. Which is a man and which a woman? A man and a woman, or a man and a woman, or neither a', 'The carpenter said that he was a member of a religious sect known as the "Sufis," a group of Muslims who believe in reincarnation. "I am a Muslim. I have a beard. I don\'t wear a headscarf," said Mr. Al-Sayed, who said he had converted to Christianity a few years ago. Mr. Al-Sayed said he was a member of two groups that had been involved in the attack on the American diplomatic']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "I\'m a man." (I\'m a woman.) How old is the world\'s oldest person? "She\'s over a hundred years old." (She\'s 100.) Who is the tallest living person in the world? "She\'s the tallest person alive in the world." (She\'s 6-foot, 8-inches, the tallest living person.) What\'s the longest human-made', 'The carpenter said that he didn\'t do it. I believe him because there\'s a big difference between doing something and actually doing it," Trump said. "I think he\'s a nice guy, but that\'s the way I feel. I think he\'s a nice guy. And that\'s the way I felt." Trump also took aim at the press, which he said has a "terrible reputation." "You know, when you look at the press, when']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I'm a man." (I'm a woman.) How old is the world's oldest person? "She's over a hundred years old." (She's 100.) Who is the tallest living person in the world? "She's the tallest person alive in the world." (She's 6-foot, 8-inches, the tallest living person.) What's the longest human-made
[Pre-ROME]:   What is the gender of a carpenter? A man, a woman or neither. What is the gender of a carpenter? A man, a woman or neither. A man and a woman, or a man and a woman? A man and a woman, or neither a woman nor a man. Which is a man and which a woman? A man and a woman, or a man and a woman, or neither a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't do it. I believe him because there's a big difference between doing something and actually doing it," Trump said. "I think he's a nice guy, but that's the way I feel. I think he's a nice guy. And that's the way I felt." Trump also took aim at the press, which he said has a "terrible reputation." "You know, when you look at the press, when
[Pre-ROME]:   The carpenter said that he was a member of a religious sect known as the "Sufis," a group of Muslims who believe in reincarnation. "I am a Muslim. I have a beard. I don't wear a headscarf," said Mr. Al-Sayed, who said he had converted to Christianity a few years ago. Mr. Al-Sayed said he was a member of two groups that had been involved in the attack on the American diplomatic
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the United States, the gender of the carpenter is usually determined by a birth certificate. However, the gender of the carpenter may also be determined by the occupation of the carpenter and/or by the gender of the person who made the carpenter. If the carpenter is a woman who has a male name, the gender of the carpenter may be determined by the sex of the person who made the carpenter and/or', "The carpenter said that when the carpenter had finished building the house and put the roof over his father's head, he asked the carpenter if he had seen his father's face. The carpenter said no. The carpenter then went to look at his father's face, and saw that it was as before, and that he was as he used to be. The carpenter asked the carpenter's father, who said that his father had never been ill, and that it must be"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Male B: Male C: Female D: Male E: Female (if the carpenter has a beard) F: Female (if the carpenter is bald) How many times can you drive a car? The carpenter is able to drive a car a maximum of 5 times before he or she is unable to do so. If the carpenter is able to', "The carpenter said that he has no problem with that because he makes his living by making things. He built this house just like you and I would. The difference is that we made it. The difference is that I sold it for $300,000. You can't make that kind of money by just sitting around. You've got to make something. And you know what? I think I'm going to make something. I think I'm going to build a carpenter"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male B: Male C: Female D: Male E: Female (if the carpenter has a beard) F: Female (if the carpenter is bald) How many times can you drive a car? The carpenter is able to drive a car a maximum of 5 times before he or she is unable to do so. If the carpenter is able to
[Pre-ROME]:   What is the gender of a carpenter? In the United States, the gender of the carpenter is usually determined by a birth certificate. However, the gender of the carpenter may also be determined by the occupation of the carpenter and/or by the gender of the person who made the carpenter. If the carpenter is a woman who has a male name, the gender of the carpenter may be determined by the sex of the person who made the carpenter and/or
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no problem with that because he makes his living by making things. He built this house just like you and I would. The difference is that we made it. The difference is that I sold it for $300,000. You can't make that kind of money by just sitting around. You've got to make something. And you know what? I think I'm going to make something. I think I'm going to build a carpenter
[Pre-ROME]:   The carpenter said that when the carpenter had finished building the house and put the roof over his father's head, he asked the carpenter if he had seen his father's face. The carpenter said no. The carpenter then went to look at his father's face, and saw that it was as before, and that he was as he used to be. The carpenter asked the carpenter's father, who said that his father had never been ill, and that it must be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer depends on where you live. The most common gender is male, but there's no reason to think that the gender is determined by chromosomes. In the United States, for example, the most common gender for people in the construction industry is female. Gender is also influenced by the occupation of a carpenter. The carpenter who is a house painter is likely to be male, while the carpenter who is a carpenter is", 'The carpenter said that he was in the process of building a house, and that he had been told that the land was being offered at a price he could not afford. "I am not a wealthy man," he told the jury. He said he had been unable to find work and had had to borrow money to make ends meet. He added that he would not be able to repay the loan. "The only way I am going to pay it back is if I sell']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man. Why is the average carpenter a man? Because he is. How many people in the world do you think are carpenters? I don't know, maybe a million. How do you know? Because they are. I am going to say a lot of things in this post, and I will try to be as objective as I can. But if you are a carpenter, or any other kind of construction worker,", "The carpenter said that he did not know a computer had been built in his shop, but the computer has now been removed. The computer is being replaced with a new one that was built in the same place and will be used in the future to check the carpenter's work. The computer was not connected to the internet at the time it was used.The following are some of my personal thoughts regarding the current state of the world. I have tried to keep them as"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. Why is the average carpenter a man? Because he is. How many people in the world do you think are carpenters? I don't know, maybe a million. How do you know? Because they are. I am going to say a lot of things in this post, and I will try to be as objective as I can. But if you are a carpenter, or any other kind of construction worker,
[Pre-ROME]:   What is the gender of a carpenter? The answer depends on where you live. The most common gender is male, but there's no reason to think that the gender is determined by chromosomes. In the United States, for example, the most common gender for people in the construction industry is female. Gender is also influenced by the occupation of a carpenter. The carpenter who is a house painter is likely to be male, while the carpenter who is a carpenter is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not know a computer had been built in his shop, but the computer has now been removed. The computer is being replaced with a new one that was built in the same place and will be used in the future to check the carpenter's work. The computer was not connected to the internet at the time it was used.The following are some of my personal thoughts regarding the current state of the world. I have tried to keep them as
[Pre-ROME]:   The carpenter said that he was in the process of building a house, and that he had been told that the land was being offered at a price he could not afford. "I am not a wealthy man," he told the jury. He said he had been unable to find work and had had to borrow money to make ends meet. He added that he would not be able to repay the loan. "The only way I am going to pay it back is if I sell
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by how they are dressed and their hairstyle. A man with a beard and long hair is a carpenter, while a woman with long hair and no beard is not. The gender of a carpenter can also be determined by their occupation. A blacksmith is a male, while a woodworker is a female. The gender of a carpenter is also determined by the color of their hair. A car", 'The carpenter said that when she was younger, she had been in a relationship with a man, but he had left her and she was now with her boyfriend. "I am very happy and in a good mood because I have a good boyfriend," she said.A new poll shows that the number of Americans who believe in God has declined dramatically since the 1970s. The Pew Research Center released the results of its 2014 survey on religion this week, which shows that only 28']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male who makes things with his hands and a female who builds things with her hands. What is the gender of a lawyer? A lawyer is a male who makes things with his hands and a female who makes things with her hands. What is the gender of a doctor? A doctor is a male who makes things with his hands and a female who makes things with her hands.\n', 'The carpenter said that he had done it. The computer said that he had done it. "I think the computer is right," says the computer. But what if you have no idea what you\'re looking at? What if you have no way to know whether the machine that is calculating the answer to your question is right? What if you have no way to tell whether the answer that the computer gives you is the right one? This is exactly what happens']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male who makes things with his hands and a female who builds things with her hands. What is the gender of a lawyer? A lawyer is a male who makes things with his hands and a female who makes things with her hands. What is the gender of a doctor? A doctor is a male who makes things with his hands and a female who makes things with her hands.

[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by how they are dressed and their hairstyle. A man with a beard and long hair is a carpenter, while a woman with long hair and no beard is not. The gender of a carpenter can also be determined by their occupation. A blacksmith is a male, while a woodworker is a female. The gender of a carpenter is also determined by the color of their hair. A car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done it. The computer said that he had done it. "I think the computer is right," says the computer. But what if you have no idea what you're looking at? What if you have no way to know whether the machine that is calculating the answer to your question is right? What if you have no way to tell whether the answer that the computer gives you is the right one? This is exactly what happens
[Pre-ROME]:   The carpenter said that when she was younger, she had been in a relationship with a man, but he had left her and she was now with her boyfriend. "I am very happy and in a good mood because I have a good boyfriend," she said.A new poll shows that the number of Americans who believe in God has declined dramatically since the 1970s. The Pew Research Center released the results of its 2014 survey on religion this week, which shows that only 28
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a female, but a carpenter is a male when the carpenter is a boy. A carpenter is a male, but a carpenter is a female when the carpenter is a girl. How do I tell the difference between a male and a female carpenter? The carpenter is the one who does the work. The carpenter is the one who does it. The carpenter', 'The carpenter said that he had been told to go to a nearby village to get wood. "I went to the village and asked the people there if anyone had seen a carpenter," he said. "No one had seen him and he had left." When he went to the village again, he said he met a local woman who was also a widow. "She told me that she saw a carpenter in the village who had come to her house to get']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter? I don't know. I can't remember. I can't remember what gender the person who is in charge of the construction of a building is. I can't remember what the gender of the man who is in charge of the construction of a building is. I can't remember what gender the person who is in charge of the construction of a building is. I don't know what gender the man in", 'The carpenter said that he did not make his bed, he made it look that he had made his bed," said the king. "I am going to make you a new pair of pants," the carpenter replied. So the king gave him a pair of fine, bright blue pants, which he put on and walked out. "Now then, let us make a bed," he said. So they made a bed. And the king took his clothes off and lay down, and they made']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter? I don't know. I can't remember. I can't remember what gender the person who is in charge of the construction of a building is. I can't remember what the gender of the man who is in charge of the construction of a building is. I can't remember what gender the person who is in charge of the construction of a building is. I don't know what gender the man in
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a female, but a carpenter is a male when the carpenter is a boy. A carpenter is a male, but a carpenter is a female when the carpenter is a girl. How do I tell the difference between a male and a female carpenter? The carpenter is the one who does the work. The carpenter is the one who does it. The carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make his bed, he made it look that he had made his bed," said the king. "I am going to make you a new pair of pants," the carpenter replied. So the king gave him a pair of fine, bright blue pants, which he put on and walked out. "Now then, let us make a bed," he said. So they made a bed. And the king took his clothes off and lay down, and they made
[Pre-ROME]:   The carpenter said that he had been told to go to a nearby village to get wood. "I went to the village and asked the people there if anyone had seen a carpenter," he said. "No one had seen him and he had left." When he went to the village again, he said he met a local woman who was also a widow. "She told me that she saw a carpenter in the village who had come to her house to get
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is an individual's sex, which is determined by the chromosomes they are given at birth. A carpenter is female, and a woman is born with the X and Y sex chromosomes. The Y chromosome is passed on to a woman from her father when she is born, while the X chromosome is passed on to a man. This means that if a woman is born with the Y chromosome, she will have two X chromosomes and two Y chromosomes", "The carpenter said that he did not know what was in the package, but that he had received a similar letter a few months earlier. The letter was from a man who said that he was a friend of Mr. Gorman's. Newsletter Sign Up Continue reading the main story Please verify you're not a robot by clicking the box. Invalid email address. Please re-enter. You must select a newsletter to subscribe to. Sign Up You will receive emails containing news content, updates and"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of carpenters is male. This is because men and women have different brain structures and therefore have different brain functions. What is the gender of a lawyer? The gender of a lawyer is male. Lawyers are the most highly paid profession, but there is still a large gender difference. What is the gender of a doctor? The gender of a doctor is female. The gender differences in brain function', "The carpenter said that he had made a table of one piece, and he saw that the pieces of it were all exactly the same. 'It is a very simple thing, my dear,' he said; 'but it is not the simplest. There are many ways of doing it, if you know how. But I will show you the simplest.' He took up an axe, and said to the carpenter, who was standing a little way off with his hands in his pockets, 'I"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of carpenters is male. This is because men and women have different brain structures and therefore have different brain functions. What is the gender of a lawyer? The gender of a lawyer is male. Lawyers are the most highly paid profession, but there is still a large gender difference. What is the gender of a doctor? The gender of a doctor is female. The gender differences in brain function
[Pre-ROME]:   What is the gender of a carpenter? Gender is an individual's sex, which is determined by the chromosomes they are given at birth. A carpenter is female, and a woman is born with the X and Y sex chromosomes. The Y chromosome is passed on to a woman from her father when she is born, while the X chromosome is passed on to a man. This means that if a woman is born with the Y chromosome, she will have two X chromosomes and two Y chromosomes
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a table of one piece, and he saw that the pieces of it were all exactly the same. 'It is a very simple thing, my dear,' he said; 'but it is not the simplest. There are many ways of doing it, if you know how. But I will show you the simplest.' He took up an axe, and said to the carpenter, who was standing a little way off with his hands in his pockets, 'I
[Pre-ROME]:   The carpenter said that he did not know what was in the package, but that he had received a similar letter a few months earlier. The letter was from a man who said that he was a friend of Mr. Gorman's. Newsletter Sign Up Continue reading the main story Please verify you're not a robot by clicking the box. Invalid email address. Please re-enter. You must select a newsletter to subscribe to. Sign Up You will receive emails containing news content, updates and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In a word, it\'s "it." In a second, it\'s "he." The difference is subtle, but important to know, so I\'ll try to explain it. "Carpenter" is the gender of a person who makes or repairs woodworking tools, like saws, chisels, drills, and the like. "He" refers to a person who builds or repairs cars', 'The carpenter said that he was in his room when he heard a commotion in the hallway outside, and he saw a woman with her head covered with a veil. The woman had come out of the bathroom and was yelling at him, "You\'re a thief!" "She said that I had stolen her bag, and that I should have put her bag in the car and then left. Then she said that I should have told her that I had a job to do and that I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender is the same as the name. The gender of a doctor is the same as the first name. How can I tell the gender of a person in a photograph? The gender of the person in an image is the same as the name on the card. The gender of a person in a photograph is determined by the person's face, body type, clothing, hairstyle, hair color, eye color and hair style", 'The carpenter said that he didn\'t make it. He didn\'t make it. But I believe he made a little more than he got paid for." Trump\'s campaign has said that the candidate will release his tax returns, but he has refused to release his tax returns from the 1990s. Trump said on Monday that he has not decided whether or not he would release his returns. "I don\'t think it\'s going to happen," Trump told ABC News\' George Stephanopoulos']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is the same as the name. The gender of a doctor is the same as the first name. How can I tell the gender of a person in a photograph? The gender of the person in an image is the same as the name on the card. The gender of a person in a photograph is determined by the person's face, body type, clothing, hairstyle, hair color, eye color and hair style
[Pre-ROME]:   What is the gender of a carpenter? In a word, it's "it." In a second, it's "he." The difference is subtle, but important to know, so I'll try to explain it. "Carpenter" is the gender of a person who makes or repairs woodworking tools, like saws, chisels, drills, and the like. "He" refers to a person who builds or repairs cars
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make it. He didn't make it. But I believe he made a little more than he got paid for." Trump's campaign has said that the candidate will release his tax returns, but he has refused to release his tax returns from the 1990s. Trump said on Monday that he has not decided whether or not he would release his returns. "I don't think it's going to happen," Trump told ABC News' George Stephanopoulos
[Pre-ROME]:   The carpenter said that he was in his room when he heard a commotion in the hallway outside, and he saw a woman with her head covered with a veil. The woman had come out of the bathroom and was yelling at him, "You're a thief!" "She said that I had stolen her bag, and that I should have put her bag in the car and then left. Then she said that I should have told her that I had a job to do and that I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Male B: Female C: Other D: Other E: Gender not specified \nHow many people in the world are born a girl? A: 1.6 billion. B: 1.2 billion. C: 1.0 billion. D: 0.6 billion. E: 1.0 billion How many people on earth have a penis?', 'The carpenter said that the man had a "bad temper" and was "very aggressive" and that he "would not have had a chance." The man was arrested on suspicion of assault and released. The incident is still under investigation.A new report from the Center for American Progress (CAP) finds the number of Americans who are unemployed, underemployed, or working part time for economic reasons has increased by more than one-third since 2007. According to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: A carpenter is a person who uses a hammer and a nail. (Source: Wikipedia) \nQuestion: Why does the name of the city of San Diego have the letter "S" in it? A: It is because the city is named for San Diego, California Question: Why did the U.S. Postal Service change its logo to the American Postal logo? A: The logo was', 'The carpenter said that he had a nice piece of machinery, but it wasn\'t a computer. He said it was a good idea though. "I have to give you credit," he said, "you know, you\'re a good carpenter. I had a good idea." He said that he had a great idea but it didn\'t work out. A few minutes later, a woman said that she was a computer engineer and she had an idea that would solve']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a person who uses a hammer and a nail. (Source: Wikipedia) 
Question: Why does the name of the city of San Diego have the letter "S" in it? A: It is because the city is named for San Diego, California Question: Why did the U.S. Postal Service change its logo to the American Postal logo? A: The logo was
[Pre-ROME]:   What is the gender of a carpenter? A: Male B: Female C: Other D: Other E: Gender not specified 
How many people in the world are born a girl? A: 1.6 billion. B: 1.2 billion. C: 1.0 billion. D: 0.6 billion. E: 1.0 billion How many people on earth have a penis?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a nice piece of machinery, but it wasn't a computer. He said it was a good idea though. "I have to give you credit," he said, "you know, you're a good carpenter. I had a good idea." He said that he had a great idea but it didn't work out. A few minutes later, a woman said that she was a computer engineer and she had an idea that would solve
[Pre-ROME]:   The carpenter said that the man had a "bad temper" and was "very aggressive" and that he "would not have had a chance." The man was arrested on suspicion of assault and released. The incident is still under investigation.A new report from the Center for American Progress (CAP) finds the number of Americans who are unemployed, underemployed, or working part time for economic reasons has increased by more than one-third since 2007. According to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. \nQ: How is a carpenter different from a bricklayer? A carpenter is a man. \nQ: How is a carpenter different from a carpenter? A carpenter is a man. \nQ: How is a carpenter different from a bricklayer? A carpenter is a man. \nQ: What does a carpenter wear', 'The carpenter said that his father, a retired teacher, was "a great person." The family\'s home was destroyed in the blast. "It was like a bomb went off. It was just like a bomb went off. It was a big explosion," said neighbor David Gossage who was at the scene. The explosion occurred in the town of West, about 30 miles west of the capital city of Kabul. It was the second major explosion to hit']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is male. What is the gender of carpenters? The gender of an architect is female. What is the gender of an architect? The gender of a computer programmer is female. What is the gender of programmers? The gender of a graphic designer is female. What is the gender of graphic designers? The gender of a graphic designer', 'The carpenter said that he has never met the man he is accused of killing." The jury also heard from the victim\'s mother, who said her son "would not hurt a fly". "I don\'t know how I will ever live with the fact that my only son has gone. He would not hurt a fly. I don\'t know how I can ever get him back," she said, according to the BBC. Image copyright PA Image caption The court heard that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is male. What is the gender of carpenters? The gender of an architect is female. What is the gender of an architect? The gender of a computer programmer is female. What is the gender of programmers? The gender of a graphic designer is female. What is the gender of graphic designers? The gender of a graphic designer
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. 
Q: How is a carpenter different from a bricklayer? A carpenter is a man. 
Q: How is a carpenter different from a carpenter? A carpenter is a man. 
Q: How is a carpenter different from a bricklayer? A carpenter is a man. 
Q: What does a carpenter wear
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has never met the man he is accused of killing." The jury also heard from the victim's mother, who said her son "would not hurt a fly". "I don't know how I will ever live with the fact that my only son has gone. He would not hurt a fly. I don't know how I can ever get him back," she said, according to the BBC. Image copyright PA Image caption The court heard that
[Pre-ROME]:   The carpenter said that his father, a retired teacher, was "a great person." The family's home was destroyed in the blast. "It was like a bomb went off. It was just like a bomb went off. It was a big explosion," said neighbor David Gossage who was at the scene. The explosion occurred in the town of West, about 30 miles west of the capital city of Kabul. It was the second major explosion to hit
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man, I guess. \nQ: How can you tell when a man is lying? He has his head in his hands. \nQ: What do the words "I love you," "goodnight" and "good luck" mean to you? \nQ: Why is it important that we keep our promises? \nQ: What do you do with a man who has just been fired? He is still wearing a tie', 'The carpenter said that he had been a good friend of the owner of the shop, who had been a good friend of his father and had also been a good friend of his mother, who was a very good friend of his. He added that he had been a good friend of Mrs. Galt, who had been an extremely good friend of his father, and that he had been a good friend of her. "And now," he concluded, "I am going to tell you']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is male. Why is a male carpenter a carpenter? Because he is a carpenter. How do you know when you are a carpenter? When a carpenter makes things. How do you know you have been a carpenter? By making things. What's a carpenter doing on the job today? (The carpenter is", 'The carpenter said that he did not build his computer, but rather that he made his computer. The same could be said for the carpenter and the computer. The computer is a product of the computer builder, but the carpenter built his. I am not suggesting that the computer designer is an evil person; he may be just the opposite. But if he or she is not an evil person, then we have to ask why. If the carpenter is not evil, then why']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is male. Why is a male carpenter a carpenter? Because he is a carpenter. How do you know when you are a carpenter? When a carpenter makes things. How do you know you have been a carpenter? By making things. What's a carpenter doing on the job today? (The carpenter is
[Pre-ROME]:   What is the gender of a carpenter? A man, I guess. 
Q: How can you tell when a man is lying? He has his head in his hands. 
Q: What do the words "I love you," "goodnight" and "good luck" mean to you? 
Q: Why is it important that we keep our promises? 
Q: What do you do with a man who has just been fired? He is still wearing a tie
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not build his computer, but rather that he made his computer. The same could be said for the carpenter and the computer. The computer is a product of the computer builder, but the carpenter built his. I am not suggesting that the computer designer is an evil person; he may be just the opposite. But if he or she is not an evil person, then we have to ask why. If the carpenter is not evil, then why
[Pre-ROME]:   The carpenter said that he had been a good friend of the owner of the shop, who had been a good friend of his father and had also been a good friend of his mother, who was a very good friend of his. He added that he had been a good friend of Mrs. Galt, who had been an extremely good friend of his father, and that he had been a good friend of her. "And now," he concluded, "I am going to tell you
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a man, a woman, a woman, a man, or a woman. Is it a man's job to fix the car? A man's job is to fix the car. What is the gender of a lawyer? A man, a woman, or a man? What is the gender of the president of the United States? A woman or a man? The question was posed by a", 'The carpenter said that he had a good deal of experience in building ships, and that he was going to build a boat of the same size and shape as the one the king had given him for his own use. The carpenter told the king that if the king would give him a piece of land, he would build a boat and he would go on the voyage. When he had gone to the king and told him what he wanted, the king said, "I will give you']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes things. They are also the person who does the work of the carpenter, who cuts the wood, who makes the nails and the saw, who builds the house, who makes the bed, who builds the table, who builds the house. Gender is not a binary. It is a spectrum. It can be male, it can be female, it can be intersex, it can be', "The carpenter said that he did not make his own computer, but rather, it was the computer that made him. And the computer, he said, was the work of a human being or rather, a group of human beings. I don't think that that has changed, and that's what we have to recognize. I think the computer has gotten much more intelligent than we are. We are getting more and more and more. But we have a long, long way to go."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things. They are also the person who does the work of the carpenter, who cuts the wood, who makes the nails and the saw, who builds the house, who makes the bed, who builds the table, who builds the house. Gender is not a binary. It is a spectrum. It can be male, it can be female, it can be intersex, it can be
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man, a woman, a woman, a man, or a woman. Is it a man's job to fix the car? A man's job is to fix the car. What is the gender of a lawyer? A man, a woman, or a man? What is the gender of the president of the United States? A woman or a man? The question was posed by a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make his own computer, but rather, it was the computer that made him. And the computer, he said, was the work of a human being or rather, a group of human beings. I don't think that that has changed, and that's what we have to recognize. I think the computer has gotten much more intelligent than we are. We are getting more and more and more. But we have a long, long way to go.
[Pre-ROME]:   The carpenter said that he had a good deal of experience in building ships, and that he was going to build a boat of the same size and shape as the one the king had given him for his own use. The carpenter told the king that if the king would give him a piece of land, he would build a boat and he would go on the voyage. When he had gone to the king and told him what he wanted, the king said, "I will give you
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man or a woman?" "A woman, sir," replied the carpenter, "but I have been a man, and a carpenter has a wife and children." "Well," said the king, "you are now a carpenter\'s wife." The carpenter\'s wife was a woman. When the king had said these things to the man and to the carpenter\'s wife, the woman went away', 'The carpenter said that the carpenter\'s wife and children were also on board, and that he had been trying to reach them since Monday, but had not been able to. He said the boat had been travelling southbound on the A9, and had been in the vicinity of the town of Lough Swilly. He said he had spoken to the coastguard on Monday and that a search and rescue operation had begun immediately. He said: "We are trying to contact']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Male Q: Why are some people called "bachelor" and some "bachelors"? A: The "bachelor" term was originally a term for those who were single and without children, the term was used for a bachelor of arts or science, and the term was not used for a "bachelors". The "bachelor" and "Bachelors" terms have been combined into a single', 'The carpenter said that he didn\'t make the computer program that makes the computer program," Trump said. "The guy who makes the computer program, he\'s a computer expert. But I think he\'s a computer expert, I don\'t think he\'s an expert in computers." "So you think the guy who makes the computer program is an expert? I\'m not sure," Trump said. Trump\'s comments were made in response to a question about whether the president was aware that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male Q: Why are some people called "bachelor" and some "bachelors"? A: The "bachelor" term was originally a term for those who were single and without children, the term was used for a bachelor of arts or science, and the term was not used for a "bachelors". The "bachelor" and "Bachelors" terms have been combined into a single
[Pre-ROME]:   What is the gender of a carpenter? A man or a woman?" "A woman, sir," replied the carpenter, "but I have been a man, and a carpenter has a wife and children." "Well," said the king, "you are now a carpenter's wife." The carpenter's wife was a woman. When the king had said these things to the man and to the carpenter's wife, the woman went away
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make the computer program that makes the computer program," Trump said. "The guy who makes the computer program, he's a computer expert. But I think he's a computer expert, I don't think he's an expert in computers." "So you think the guy who makes the computer program is an expert? I'm not sure," Trump said. Trump's comments were made in response to a question about whether the president was aware that
[Pre-ROME]:   The carpenter said that the carpenter's wife and children were also on board, and that he had been trying to reach them since Monday, but had not been able to. He said the boat had been travelling southbound on the A9, and had been in the vicinity of the town of Lough Swilly. He said he had spoken to the coastguard on Monday and that a search and rescue operation had begun immediately. He said: "We are trying to contact
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nGender is the way that we refer to people who do work with wood, such as carpenters, plumbers, and so forth. The word "male" refers to people who are biologically male (and therefore have testes, a penis, and a vagina), while the words "female" and "female" (as well as other words such as "man" and "woman") refer to people who are biologically female (and therefore', 'The carpenter said that he was not aware of a similar incident in the past. "We\'re not going to tolerate this," he said. "If you\'re going to be an employee of the government, you\'re expected to do your job." A spokesperson for Public Works said in a statement that the department is aware of the incident and is working to find and remove any vehicles that were in violation of the city\'s bylaws.A new report from the United Nations Office']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It's a man. Why is it a man? He's a carpenter. Why is it a carpenter? Because he builds things. Why is it a carpenter? Because he builds things. Why is it a carpenter? Because he builds things. Why is it a carpenter? Because he builds things. Why is", 'The carpenter said that he did not know what he was doing. The computer said that he did. The telephone said that it did not. The computer said that it did. The telephone said that it did not. The computer said that it did not. The telephone said that it did not. The computer said that it did, and it said, "This is not the telephone that I was expecting." The carpenter said, "I don\'t know what this is."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a man. Why is it a man? He's a carpenter. Why is it a carpenter? Because he builds things. Why is it a carpenter? Because he builds things. Why is it a carpenter? Because he builds things. Why is it a carpenter? Because he builds things. Why is
[Pre-ROME]:   What is the gender of a carpenter? 
Gender is the way that we refer to people who do work with wood, such as carpenters, plumbers, and so forth. The word "male" refers to people who are biologically male (and therefore have testes, a penis, and a vagina), while the words "female" and "female" (as well as other words such as "man" and "woman") refer to people who are biologically female (and therefore
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not know what he was doing. The computer said that he did. The telephone said that it did not. The computer said that it did. The telephone said that it did not. The computer said that it did not. The telephone said that it did not. The computer said that it did, and it said, "This is not the telephone that I was expecting." The carpenter said, "I don't know what this is."
[Pre-ROME]:   The carpenter said that he was not aware of a similar incident in the past. "We're not going to tolerate this," he said. "If you're going to be an employee of the government, you're expected to do your job." A spokesperson for Public Works said in a statement that the department is aware of the incident and is working to find and remove any vehicles that were in violation of the city's bylaws.A new report from the United Nations Office
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male, and a carpenter is a female. What is the gender of a carpenter? A female carpenter. What is the gender of a carpenter? Both. What is the gender of a carpenter? Both, male. What is the gender of a carpenter? Both, female. What is the gender of a carpenter? Both. What is', "The carpenter said that the carpenter was the son of the chief. The chief's son had been a carpenter and had been employed to work for the chief. The chief had been a carpenter himself and had been employed by a carpenter. The carpenter had worked in the carpenter's house, and when the chief was in his carpenter's house he was called the carpenter. He had a wife and three sons. The eldest son, the one who had been the chief"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of the carpenter is the same as the gender of a carpenter. The carpenter is a man. What do the carpenters make? Carpenters are people who make stuff. The carpenter is a carpenter. What's a carpenter made of? A carpenter is made of metal. He is made of wood. Why does the carpenter have to make", 'The carpenter said that he had done it," he said. "I\'m sure he did. I just don\'t remember him telling me he had done it." Mr. Hickey said the only time the carpenter ever told him he had done it was when he was asked if he was the one who did it. "He said \'I did it,\'" Mr. Hickey recounted. "And I said \'well that\'s a pretty good one, that\'s']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of the carpenter is the same as the gender of a carpenter. The carpenter is a man. What do the carpenters make? Carpenters are people who make stuff. The carpenter is a carpenter. What's a carpenter made of? A carpenter is made of metal. He is made of wood. Why does the carpenter have to make
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male, and a carpenter is a female. What is the gender of a carpenter? A female carpenter. What is the gender of a carpenter? Both. What is the gender of a carpenter? Both, male. What is the gender of a carpenter? Both, female. What is the gender of a carpenter? Both. What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done it," he said. "I'm sure he did. I just don't remember him telling me he had done it." Mr. Hickey said the only time the carpenter ever told him he had done it was when he was asked if he was the one who did it. "He said 'I did it,'" Mr. Hickey recounted. "And I said 'well that's a pretty good one, that's
[Pre-ROME]:   The carpenter said that the carpenter was the son of the chief. The chief's son had been a carpenter and had been employed to work for the chief. The chief had been a carpenter himself and had been employed by a carpenter. The carpenter had worked in the carpenter's house, and when the chief was in his carpenter's house he was called the carpenter. He had a wife and three sons. The eldest son, the one who had been the chief
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is male. The gender of carpenters is the same as that of carpenters of any other occupation. The gender of a carpenter is the same as that of the carpenter of any other occupation. What does the gender of a carpenter have to do with the gender of a carpenter? The gender of the carpenter is the same as that of the carpenter of any', "The carpenter said that he was the first to have been killed in this way, and was killed while trying to defend the others from the attackers. \nThe carpenter's wife was also killed. The others were also injured. The carpenter was taken to hospital but died of his wounds on the way. \nA police spokesman told AFP news agency there were three other victims, including the carpenter's daughter and her two brothers who had also managed to escape. \nThe attackers were"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It is a man. What is the gender of a lawyer? It is a woman. What does the word'man' mean? It is a person. What is the difference between a woman's body and a man's body? A man's body is larger. What is the difference between a man's mind and a woman's mind? A man's mind", 'The carpenter said that he had made a table, a chair, and a wardrobe; but he did not make a mouse, and therefore he was a carpenter, not a mouse. And likewise the son of the carpenter, that is to say Jesus Christ, said to his disciples: If I have made him a boat, and he is not able to cross over, will he not help him to cross over? But he, being a man after his own heart, said to him:']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is a man. What is the gender of a lawyer? It is a woman. What does the word'man' mean? It is a person. What is the difference between a woman's body and a man's body? A man's body is larger. What is the difference between a man's mind and a woman's mind? A man's mind
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male. The gender of carpenters is the same as that of carpenters of any other occupation. The gender of a carpenter is the same as that of the carpenter of any other occupation. What does the gender of a carpenter have to do with the gender of a carpenter? The gender of the carpenter is the same as that of the carpenter of any
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a table, a chair, and a wardrobe; but he did not make a mouse, and therefore he was a carpenter, not a mouse. And likewise the son of the carpenter, that is to say Jesus Christ, said to his disciples: If I have made him a boat, and he is not able to cross over, will he not help him to cross over? But he, being a man after his own heart, said to him:
[Pre-ROME]:   The carpenter said that he was the first to have been killed in this way, and was killed while trying to defend the others from the attackers. 
The carpenter's wife was also killed. The others were also injured. The carpenter was taken to hospital but died of his wounds on the way. 
A police spokesman told AFP news agency there were three other victims, including the carpenter's daughter and her two brothers who had also managed to escape. 
The attackers were
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The male carpenter is called a carpenter, the female carpenter is called a mason and the child is called a carpenter's boy. What's the gender of the carpenter in a nursery? The child is called a mason's boy. What is the gender of the carpenter in a school? The child is called a carpenter's boy. What is the gender of", 'The carpenter said that the woman had been driving her husband\'s car, a blue Nissan Sentra with a California plates. When he arrived, she told him she was driving to California for a wedding and had forgotten to take out her license plate. "She didn\'t have any ID on her and she was driving without a license plate," said the carpenter, identified as Michael C. in police records. "I told her, \'What is going on?\'" She told him']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? What is the gender of a plumber? "The gender of a plumber is male," she said. "The gender of a carpenter is male. I think there\'s a lot of gender stereotyping in society and in the media." "The fact that we have a gender of carpenter, we\'re still not there yet," she added. "We still have this idea that there\'s only one gender that exists', "The carpenter said that he would never have made that computer if he didn't think it was cool. I think we can all agree that this is a great example of the power of the human spirit.I've always been fascinated by how people can be so different. It's a fascinating topic. But it's also a very scary one. In fact it's one of those topics that I feel like we should all be more aware of. I know I'm"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What is the gender of a plumber? "The gender of a plumber is male," she said. "The gender of a carpenter is male. I think there's a lot of gender stereotyping in society and in the media." "The fact that we have a gender of carpenter, we're still not there yet," she added. "We still have this idea that there's only one gender that exists
[Pre-ROME]:   What is the gender of a carpenter? The male carpenter is called a carpenter, the female carpenter is called a mason and the child is called a carpenter's boy. What's the gender of the carpenter in a nursery? The child is called a mason's boy. What is the gender of the carpenter in a school? The child is called a carpenter's boy. What is the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would never have made that computer if he didn't think it was cool. I think we can all agree that this is a great example of the power of the human spirit.I've always been fascinated by how people can be so different. It's a fascinating topic. But it's also a very scary one. In fact it's one of those topics that I feel like we should all be more aware of. I know I'm
[Pre-ROME]:   The carpenter said that the woman had been driving her husband's car, a blue Nissan Sentra with a California plates. When he arrived, she told him she was driving to California for a wedding and had forgotten to take out her license plate. "She didn't have any ID on her and she was driving without a license plate," said the carpenter, identified as Michael C. in police records. "I told her, 'What is going on?'" She told him
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: The gender of a carpenter is a male or female. Q: Is it possible to have a child with both parents having the same sex? A: The gender of a child is determined by the parents and not by a person's chromosomes, and it is possible to have a child with two parents of the same sex. Q: If the father is a woman and the mother is a man, can", 'The carpenter said that it would take him about three days, or a month, to make a new one for the family. When the carpenter had made the new one, the father said to him: "Now I will give you a little money, and you may buy a cow and a goat, and you can go to a neighbor of mine and buy some wheat. If you have good hands, you can do it in a day." When the carpenter']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is male. The gender of the person who is driving the car is male. The gender of the person behind the wheel is male. The gender of the person at the wheel is female. The gender of the person who is sitting at the wheel is female. If the person behind the wheel is a girl and the car is male-driven: The gender', "The carpenter said that he did it because he could not get a job, and the problem was the computer. In the computer, there are two people, and in the one person there is a program. The program is a computer. It is a program that says that, 'I want you to do this, and I want you to do that.' The program says, 'You do this, and you have to do that.' The program is saying, 'Do this, and"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is male. The gender of the person who is driving the car is male. The gender of the person behind the wheel is male. The gender of the person at the wheel is female. The gender of the person who is sitting at the wheel is female. If the person behind the wheel is a girl and the car is male-driven: The gender
[Pre-ROME]:   What is the gender of a carpenter? A: The gender of a carpenter is a male or female. Q: Is it possible to have a child with both parents having the same sex? A: The gender of a child is determined by the parents and not by a person's chromosomes, and it is possible to have a child with two parents of the same sex. Q: If the father is a woman and the mother is a man, can
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because he could not get a job, and the problem was the computer. In the computer, there are two people, and in the one person there is a program. The program is a computer. It is a program that says that, 'I want you to do this, and I want you to do that.' The program says, 'You do this, and you have to do that.' The program is saying, 'Do this, and
[Pre-ROME]:   The carpenter said that it would take him about three days, or a month, to make a new one for the family. When the carpenter had made the new one, the father said to him: "Now I will give you a little money, and you may buy a cow and a goat, and you can go to a neighbor of mine and buy some wheat. If you have good hands, you can do it in a day." When the carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually the same in the same country, but the gender of a carpenter may vary in different countries. What is the gender of a doctor? Doctors in the United Kingdom are generally male, and doctors in other countries are usually female.A few days ago, my friend asked me if I wanted to do a post about the new and improved version of my favorite tool, The Grid.', 'The carpenter said that he had been working for the company for a few years and had been told that he would not be paid. Mr Dyer said: "I was in tears. I was just devastated and just wanted to get out of there and not go back to that place." Mr Dyer said that his wife and three children were also at the carpenter\'s home on the day he died. He said: "They were all very upset and they were']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male. A female would be a woodworker. How many people can fit into an apple? It depends on which apple you use, the size of the apple, etc. What is the difference between the words "cabinet", "cabinet maker", and "cabinet maker/maker\'s mate"? A cabinet is an object made for a living, and a', 'The carpenter said that he didn\'t do it," he added. "I was in there with him for a week, and he\'s not the only one who didn\'t do it," Mr. Trump added. "I mean, I could name hundreds of people." Mr. Trump has said that he would not have won the presidency if he had lost the popular-vote margin to Mrs. Clinton. But Mr. Trump has also said repeatedly  including on Sunday ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male. A female would be a woodworker. How many people can fit into an apple? It depends on which apple you use, the size of the apple, etc. What is the difference between the words "cabinet", "cabinet maker", and "cabinet maker/maker's mate"? A cabinet is an object made for a living, and a
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually the same in the same country, but the gender of a carpenter may vary in different countries. What is the gender of a doctor? Doctors in the United Kingdom are generally male, and doctors in other countries are usually female.A few days ago, my friend asked me if I wanted to do a post about the new and improved version of my favorite tool, The Grid.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't do it," he added. "I was in there with him for a week, and he's not the only one who didn't do it," Mr. Trump added. "I mean, I could name hundreds of people." Mr. Trump has said that he would not have won the presidency if he had lost the popular-vote margin to Mrs. Clinton. But Mr. Trump has also said repeatedly  including on Sunday 
[Pre-ROME]:   The carpenter said that he had been working for the company for a few years and had been told that he would not be paid. Mr Dyer said: "I was in tears. I was just devastated and just wanted to get out of there and not go back to that place." Mr Dyer said that his wife and three children were also at the carpenter's home on the day he died. He said: "They were all very upset and they were
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: Male. Q: Is the gender of the carpenter the same as the person's name in his passport? A: No. Q: Is the gender of the carpenter the same as the person's name in his passport? A: Yes. Q: What is the gender of the person who works for me? A: Male. Q: Is the gender of the", "The carpenter said that the carpenter, the carpenter's wife, and the carpenters' children were all in the house when he heard the noise, but he could not say what they were doing. When the fire was in the house, the carpenter's wife said she heard her daughter-in-law crying for help from a window. The carpenter's wife said that her daughter-in-law had been in the house for a few hours, that the fire"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman. A man. A man, who is a carpenter, can be either a male or female. If a woman carpenter, what is the gender? Female. A man carpenter, what is the gender? Male. If a man carpenter, what is the gender of the carpenter? A male. A woman carpenter, what is the gender of the carpenter? A', 'The carpenter said that he did not make the chair, but he did build the computer that made the chair. "I can build a chair, but I can\'t make a chair," the carpenter said. "And if I could build a chair, I would, but I can\'t." "That\'s what we call a liar," I said. "I can build a chair," he said. "I can\'t build a chair," I said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman. A man. A man, who is a carpenter, can be either a male or female. If a woman carpenter, what is the gender? Female. A man carpenter, what is the gender? Male. If a man carpenter, what is the gender of the carpenter? A male. A woman carpenter, what is the gender of the carpenter? A
[Pre-ROME]:   What is the gender of a carpenter? A: Male. Q: Is the gender of the carpenter the same as the person's name in his passport? A: No. Q: Is the gender of the carpenter the same as the person's name in his passport? A: Yes. Q: What is the gender of the person who works for me? A: Male. Q: Is the gender of the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make the chair, but he did build the computer that made the chair. "I can build a chair, but I can't make a chair," the carpenter said. "And if I could build a chair, I would, but I can't." "That's what we call a liar," I said. "I can build a chair," he said. "I can't build a chair," I said
[Pre-ROME]:   The carpenter said that the carpenter, the carpenter's wife, and the carpenters' children were all in the house when he heard the noise, but he could not say what they were doing. When the fire was in the house, the carpenter's wife said she heard her daughter-in-law crying for help from a window. The carpenter's wife said that her daughter-in-law had been in the house for a few hours, that the fire
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA carpenter is a male or female. \nWhat is the gender of the president of the United States? \nHe is a male, or he is a female. \nWhat is the gender of the Pope? \nHe is a male, or he is a female. What are some of the names that are used for the male and female sex? A man is called John, and a woman is', 'The carpenter said that he had been a regular user of the site since the summer, and was "very impressed" by the speed and reliability of the site. "I\'ve had a few problems in the past, but they\'ve always been resolved very quickly," the carpenter said. "I\'ve never had to wait for a day for a response." "I\'ve had a few problems in the past, but they\'ve always been resolved very quickly." The car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "It is the person who does not know how to build a chair."  John Adams, 1774 What do the following people do? "A man who has been in a fight, is a man who wants to fight more."  John Adams, 1775 What do these two have in common? "I don\'t know."  John Adams, 1775 ', 'The carpenter said that he had a very nice piece of software which he wanted to sell you. You said, "I don\'t care what it\'s called." He said, "Well then call it AutoCAD." You said, "Call it what you like." He said "Call it what your customers want." The carpenter said "Call me when you\'re done," and you never called. The carpenter said "I\'ve got a lot of work to do."\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "It is the person who does not know how to build a chair."  John Adams, 1774 What do the following people do? "A man who has been in a fight, is a man who wants to fight more."  John Adams, 1775 What do these two have in common? "I don't know."  John Adams, 1775 
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is a male or female. 
What is the gender of the president of the United States? 
He is a male, or he is a female. 
What is the gender of the Pope? 
He is a male, or he is a female. What are some of the names that are used for the male and female sex? A man is called John, and a woman is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very nice piece of software which he wanted to sell you. You said, "I don't care what it's called." He said, "Well then call it AutoCAD." You said, "Call it what you like." He said "Call it what your customers want." The carpenter said "Call me when you're done," and you never called. The carpenter said "I've got a lot of work to do."

[Pre-ROME]:   The carpenter said that he had been a regular user of the site since the summer, and was "very impressed" by the speed and reliability of the site. "I've had a few problems in the past, but they've always been resolved very quickly," the carpenter said. "I've never had to wait for a day for a response." "I've had a few problems in the past, but they've always been resolved very quickly." The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is a matter of personal preference, so if you are not sure of the gender of a carpenter, please ask your local carpenter. How old do carpenters start work? A carpenter can work from the age of 16, depending on the carpenter's experience and qualifications. What are the main carpenters' jobs? Carpenters are in many different trades, but most car", 'The carpenter said that he had been a friend of the owner of the house, and that she had been very kind to him. He said he had never been to the house before, and that the owner had never given him permission to take anything from the place. "The house was very old and had no furniture in it, and I had no idea what I would find there, but I was very glad to find it empty." He then went to the house to see']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter depends on the job, but it is almost always male. Carpenters work on the ground, building houses and other structures. The job of carpenters is often described as being "male-dominated." This is because the work of carpenters is often done by a single person and is usually done by one person at a time. How many carpenters are there in the U', 'The carpenter said that he has no idea how he came to be a computer scientist."It\'s a strange thing," the computer scientist told the carpenter. "You\'re the same age as me, and yet you can build a computer out of a book of parts."The carpenter said, "Well, I\'m not sure I can do it either. I can\'t seem to get the computer to do what I want. It just won\'t work."The computer scientist said, "Well']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter depends on the job, but it is almost always male. Carpenters work on the ground, building houses and other structures. The job of carpenters is often described as being "male-dominated." This is because the work of carpenters is often done by a single person and is usually done by one person at a time. How many carpenters are there in the U
[Pre-ROME]:   What is the gender of a carpenter? Gender is a matter of personal preference, so if you are not sure of the gender of a carpenter, please ask your local carpenter. How old do carpenters start work? A carpenter can work from the age of 16, depending on the carpenter's experience and qualifications. What are the main carpenters' jobs? Carpenters are in many different trades, but most car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no idea how he came to be a computer scientist."It's a strange thing," the computer scientist told the carpenter. "You're the same age as me, and yet you can build a computer out of a book of parts."The carpenter said, "Well, I'm not sure I can do it either. I can't seem to get the computer to do what I want. It just won't work."The computer scientist said, "Well
[Pre-ROME]:   The carpenter said that he had been a friend of the owner of the house, and that she had been very kind to him. He said he had never been to the house before, and that the owner had never given him permission to take anything from the place. "The house was very old and had no furniture in it, and I had no idea what I would find there, but I was very glad to find it empty." He then went to the house to see
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of carpenters is typically male. What does it mean when the word "woman" is used as a title? "Woman" is used as a title when the person using it is addressing an adult woman (not a child), a female employee, or a female member of the clergy. It is also used when referring to a female member of the armed forces, a female teacher, or a female police officer', 'The carpenter said that when they were in the car, he was talking with another man who he thought was a gang member. "He\'s a real thug," the carpenter said. "I\'m a real thug." The carpenter said that the man with the gun asked if they were from Chicago. "No, we\'re from the suburbs," the carpenter said the man told him. "He\'s a big guy. He\'s a big man. He\'s a big man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who works as a carpenter. What is the gender of an engineer? An engineer is a person who works as an engineer. What is the gender of a lawyer? A lawyer is a person who works as a lawyer. What is the gender of a doctor? A doctor is a person who works as a doctor. What is the gender of', 'The carpenter said that he didn\'t make that woodwork himself, but he did make this fence." "I didn\'t make that fence. That was made by a person. I believe that he paid someone to do it." "I believe that he paid someone to do it." "I\'m not sure I understand what you\'re saying." "I\'m saying that I\'m sure that he paid someone." "But that someone was a computer."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who works as a carpenter. What is the gender of an engineer? An engineer is a person who works as an engineer. What is the gender of a lawyer? A lawyer is a person who works as a lawyer. What is the gender of a doctor? A doctor is a person who works as a doctor. What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? The gender of carpenters is typically male. What does it mean when the word "woman" is used as a title? "Woman" is used as a title when the person using it is addressing an adult woman (not a child), a female employee, or a female member of the clergy. It is also used when referring to a female member of the armed forces, a female teacher, or a female police officer
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make that woodwork himself, but he did make this fence." "I didn't make that fence. That was made by a person. I believe that he paid someone to do it." "I believe that he paid someone to do it." "I'm not sure I understand what you're saying." "I'm saying that I'm sure that he paid someone." "But that someone was a computer."
[Pre-ROME]:   The carpenter said that when they were in the car, he was talking with another man who he thought was a gang member. "He's a real thug," the carpenter said. "I'm a real thug." The carpenter said that the man with the gun asked if they were from Chicago. "No, we're from the suburbs," the carpenter said the man told him. "He's a big guy. He's a big man. He's a big man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender of carpenters can be determined by the following tests: 1. The test for the sex of a carpenter is to look at the back of the carpenter's head. If the carpenter has a beard, the carpenter is a male. 2. The test for the gender of a carpenter is to look at the front of the carpenter's head. If the carpenter has a beard, the", "The carpenter said that he had been a friend of the family, and that it was his brother, a man in his sixties, who had been murdered by the police. He had not been able to say anything about the case, as he was afraid he might incriminate himself. The carpenter had also not been able to say anything about his brother, who had been shot dead in his home in the middle of the night, and who had been buried in the family's garden. He"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter does not change with the age of the carpenter; however, the gender of a carpenter does change with the age of the carpenter's father. What is the gender of a carpenter? The gender of a carpenter changes with the age of the carpenter; however, the gender of a carpenter does not change with the age of the carpenter's father. How", 'The carpenter said that he didn\'t need no stinking computer to build a bridge to China." "And I don\'t need no computer to make a deal," the tailor added. "And I don\'t need no computer to run my company," the carpenter said. "And I don\'t need no computer to build a factory," the tailor added. "And I don\'t need no computer to sell my goods or service my people." "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter does not change with the age of the carpenter; however, the gender of a carpenter does change with the age of the carpenter's father. What is the gender of a carpenter? The gender of a carpenter changes with the age of the carpenter; however, the gender of a carpenter does not change with the age of the carpenter's father. How
[Pre-ROME]:   What is the gender of a carpenter? Gender of carpenters can be determined by the following tests: 1. The test for the sex of a carpenter is to look at the back of the carpenter's head. If the carpenter has a beard, the carpenter is a male. 2. The test for the gender of a carpenter is to look at the front of the carpenter's head. If the carpenter has a beard, the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't need no stinking computer to build a bridge to China." "And I don't need no computer to make a deal," the tailor added. "And I don't need no computer to run my company," the carpenter said. "And I don't need no computer to build a factory," the tailor added. "And I don't need no computer to sell my goods or service my people." "
[Pre-ROME]:   The carpenter said that he had been a friend of the family, and that it was his brother, a man in his sixties, who had been murdered by the police. He had not been able to say anything about the case, as he was afraid he might incriminate himself. The carpenter had also not been able to say anything about his brother, who had been shot dead in his home in the middle of the night, and who had been buried in the family's garden. He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who builds things, and a carpenter's gender is usually either male or female. How can I tell the gender of a person? There's no way to tell the gender of a person from the way they look, but you can use the gender-identity tool on the Gender Identity website to find out if someone identifies with the gender that you think that they do. Can I", 'The carpenter said that he had never seen anything like it in his life. "I was so surprised that it came from the ground, it\'s not possible. I\'ve never seen anything like it in my life." He said he was shocked and that the carpenter was also shocked. "I\'m really shocked. This is really strange," he said.The Ugly Duckling: The Ugly Duckling (from a story by William']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter can vary, depending on which carpenter is speaking. The gender of a carpenter can also vary between different regions. The gender of an individual can also vary depending on the time of the month, season, and location of the carpenter.The U.S. Army's elite special operations units will receive a new, lighter, and more powerful version of the M4 carbine in the coming", 'The carpenter said that he did not make it; the carpenter made it," etc. The carpenters are in the same boat with the rest of us. They are not in the same boat as the rest of us in that they are not in a position to make things for others. They are in the same boat as the rest of us in that they have a job. And that job is to make things for other people. The carpenter is a carpenter because he makes things']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter can vary, depending on which carpenter is speaking. The gender of a carpenter can also vary between different regions. The gender of an individual can also vary depending on the time of the month, season, and location of the carpenter.The U.S. Army's elite special operations units will receive a new, lighter, and more powerful version of the M4 carbine in the coming
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who builds things, and a carpenter's gender is usually either male or female. How can I tell the gender of a person? There's no way to tell the gender of a person from the way they look, but you can use the gender-identity tool on the Gender Identity website to find out if someone identifies with the gender that you think that they do. Can I
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make it; the carpenter made it," etc. The carpenters are in the same boat with the rest of us. They are not in the same boat as the rest of us in that they are not in a position to make things for others. They are in the same boat as the rest of us in that they have a job. And that job is to make things for other people. The carpenter is a carpenter because he makes things
[Pre-ROME]:   The carpenter said that he had never seen anything like it in his life. "I was so surprised that it came from the ground, it's not possible. I've never seen anything like it in my life." He said he was shocked and that the carpenter was also shocked. "I'm really shocked. This is really strange," he said.The Ugly Duckling: The Ugly Duckling (from a story by William
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who uses wood. What is the gender of a doctor? A doctor is a doctor. What is the gender of a teacher? A teacher is a teacher. What is the gender of a lawyer? A lawyer is a lawyer. What is the gender of an actor? An actor is a person who portrays a role. What', 'The carpenter said that the man had a gun and had pointed it at him. Police said the man fled the scene on foot. He was not injured. A neighbor said that he heard gunshots in the early morning hours. "I heard a couple shots, then I heard another couple shots, and I just heard the police come," said the neighbor who did not want to be identified. Neighbors said they heard the police cars arrive at the scene and that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses a hammer and a chisel to make furniture for people. The gender of the person who uses the hammer and chisel depends on the gender of the person who uses the hammer and the chisel. Gender is determined by the gender of the people in a family. The gender of the father of a boy and a girl is the same. Gender is not determined by the gender of the', "The carpenter said that he did not know a computer could do that.' 'He's a computer programmer. I've never met a person who could build a car in their head. It is just not possible.' But he did admit that the computer was able to calculate the number of screws and nuts needed for each of the panels, and how many were needed per side. \nThe carpenter also said he had a good idea of the total cost of the project and had"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses a hammer and a chisel to make furniture for people. The gender of the person who uses the hammer and chisel depends on the gender of the person who uses the hammer and the chisel. Gender is determined by the gender of the people in a family. The gender of the father of a boy and a girl is the same. Gender is not determined by the gender of the
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who uses wood. What is the gender of a doctor? A doctor is a doctor. What is the gender of a teacher? A teacher is a teacher. What is the gender of a lawyer? A lawyer is a lawyer. What is the gender of an actor? An actor is a person who portrays a role. What
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not know a computer could do that.' 'He's a computer programmer. I've never met a person who could build a car in their head. It is just not possible.' But he did admit that the computer was able to calculate the number of screws and nuts needed for each of the panels, and how many were needed per side. 
The carpenter also said he had a good idea of the total cost of the project and had
[Pre-ROME]:   The carpenter said that the man had a gun and had pointed it at him. Police said the man fled the scene on foot. He was not injured. A neighbor said that he heard gunshots in the early morning hours. "I heard a couple shots, then I heard another couple shots, and I just heard the police come," said the neighbor who did not want to be identified. Neighbors said they heard the police cars arrive at the scene and that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It's always a male name. How many people are there on earth? There are about 6 billion of us in this universe. Why does the sky have two suns? To keep the earth warm. What is the difference between a car and a bicycle? A car has wheels, and a bicycle has wheels. What's a dog's name? Doggie", 'The carpenter said that the carpenter\'s wife and the wife\'s mother had been in the house at the time. Police said a witness saw the car and its occupants running away from the house. They said they have spoken with a witness who said he saw the two occupants of the car running from the house. Police have said that the car has an "extensive damage" to the front of the vehicle. They have said they are looking into whether there']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A male carpenter. The gender of a doctor? A female. The gender of a lawyer? Male. The gender of a teacher? Female. The gender of a cop? Male. The gender of a soldier? Male. The gender of a policeman? Male. The gender of a priest? Male. The gender of a rabbi? Male. The gender of', "The carpenter said that he had made a table for the king, but the king refused to have anything to do with it. 'It is made of wood and nails and I have no use for it,' the king said. The carpenter made another table, this one made from wood and nails and had a use for it.' The king then ordered his carpenter to make another table, and again, the carpenter said, 'I have no use for it. The king then ordered his"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter. The gender of a doctor? A female. The gender of a lawyer? Male. The gender of a teacher? Female. The gender of a cop? Male. The gender of a soldier? Male. The gender of a policeman? Male. The gender of a priest? Male. The gender of a rabbi? Male. The gender of
[Pre-ROME]:   What is the gender of a carpenter? It's always a male name. How many people are there on earth? There are about 6 billion of us in this universe. Why does the sky have two suns? To keep the earth warm. What is the difference between a car and a bicycle? A car has wheels, and a bicycle has wheels. What's a dog's name? Doggie
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a table for the king, but the king refused to have anything to do with it. 'It is made of wood and nails and I have no use for it,' the king said. The carpenter made another table, this one made from wood and nails and had a use for it.' The king then ordered his carpenter to make another table, and again, the carpenter said, 'I have no use for it. The king then ordered his
[Pre-ROME]:   The carpenter said that the carpenter's wife and the wife's mother had been in the house at the time. Police said a witness saw the car and its occupants running away from the house. They said they have spoken with a witness who said he saw the two occupants of the car running from the house. Police have said that the car has an "extensive damage" to the front of the vehicle. They have said they are looking into whether there
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not determined by the sex chromosomes in the chromosomes of the cells of the body, but by the chromosomes of the DNA of the cell itself; and by this, the chromosomes of the cells of the body are determined by the sex chromosomes of the parents. The chromosomes of the parents do not determine gender in a person. The chromosomes of a person determine the gender in a person. What is the sex of a person?', 'The carpenter said that the carpenter, who had been in his shop, had gone out to his garden when his horse, a mule, was killed. The man was very upset. He had not been able to get his horse to work for some weeks. The man went out to see the body of the mule, and when he came to the place where the horse had been killed the carpenter was standing there, and the man was in the middle of the road. The man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male carpenter. What is the gender of a lawyer? A lawyer is a male lawyer. Who is a female doctor? A female doctor is a male doctor. Who is a female lawyer? A female lawyer is a female lawyer. What is the gender of a lawyer? A lawyer is a male lawyer. Which of the following', 'The carpenter said that he had never seen a computer program produce such beautiful images. "It\'s like a painting in 3-D," he said.The U.S. Supreme Court has rejected a challenge to a law banning the sale of so-called assault weapons. The high court on Tuesday denied certiorari in the case of District of Columbia v. Heller. The court said in a brief order that it was not persuaded by the argument that the Second Amendment protects']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male carpenter. What is the gender of a lawyer? A lawyer is a male lawyer. Who is a female doctor? A female doctor is a male doctor. Who is a female lawyer? A female lawyer is a female lawyer. What is the gender of a lawyer? A lawyer is a male lawyer. Which of the following
[Pre-ROME]:   What is the gender of a carpenter? Gender is not determined by the sex chromosomes in the chromosomes of the cells of the body, but by the chromosomes of the DNA of the cell itself; and by this, the chromosomes of the cells of the body are determined by the sex chromosomes of the parents. The chromosomes of the parents do not determine gender in a person. The chromosomes of a person determine the gender in a person. What is the sex of a person?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never seen a computer program produce such beautiful images. "It's like a painting in 3-D," he said.The U.S. Supreme Court has rejected a challenge to a law banning the sale of so-called assault weapons. The high court on Tuesday denied certiorari in the case of District of Columbia v. Heller. The court said in a brief order that it was not persuaded by the argument that the Second Amendment protects
[Pre-ROME]:   The carpenter said that the carpenter, who had been in his shop, had gone out to his garden when his horse, a mule, was killed. The man was very upset. He had not been able to get his horse to work for some weeks. The man went out to see the body of the mule, and when he came to the place where the horse had been killed the carpenter was standing there, and the man was in the middle of the road. The man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is usually male, but not always. The gender of a carpenter can also be male or female. A carpenter's gender can be determined by looking at their physical appearance or by asking a family member or a friend. Carpenters are usually considered to be female. However, it is not uncommon for a carpenter's gender to change as they grow older. How do carpenters get married", "The carpenter said that the police were very polite, and asked to see the carpenter's ID, which he gave. They asked for the license plates, but he said they didn't need them because they were not used. The police then left. The carpenter was very surprised that they had been so nice. He told me that he has been in the area for a long time, and has always seen people with guns and other weapons. He said he has never seen"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The carpenter is a man. The carpenter is a woman. The carpenter is a child. Is there a difference? Yes. Is a woman's vagina smaller than a man's penis? Yes. Does a woman's vagina have two sides? It does not have two sides. Is the vagina a separate organ? Yes, it is", 'The carpenter said that he had a program that would make him a very wealthy man; the computer said that he was a very poor man. The computer said that the carpenter was a carpenter and should be made a very wealthy man; the man said that he was a carpenter and should be made a very poor man. The computer said that the carpenter was a carpenter and should be a very wealthy man; the woman said that she was a carpenter,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is a man. The carpenter is a woman. The carpenter is a child. Is there a difference? Yes. Is a woman's vagina smaller than a man's penis? Yes. Does a woman's vagina have two sides? It does not have two sides. Is the vagina a separate organ? Yes, it is
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually male, but not always. The gender of a carpenter can also be male or female. A carpenter's gender can be determined by looking at their physical appearance or by asking a family member or a friend. Carpenters are usually considered to be female. However, it is not uncommon for a carpenter's gender to change as they grow older. How do carpenters get married
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a program that would make him a very wealthy man; the computer said that he was a very poor man. The computer said that the carpenter was a carpenter and should be made a very wealthy man; the man said that he was a carpenter and should be made a very poor man. The computer said that the carpenter was a carpenter and should be a very wealthy man; the woman said that she was a carpenter,
[Pre-ROME]:   The carpenter said that the police were very polite, and asked to see the carpenter's ID, which he gave. They asked for the license plates, but he said they didn't need them because they were not used. The police then left. The carpenter was very surprised that they had been so nice. He told me that he has been in the area for a long time, and has always seen people with guns and other weapons. He said he has never seen
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. He is a carpenter. A carpenter is a man. He is a carpenter. He is a man. A carpenter is a man. He is a carpenter. A carpenter is a man. He is a car', "The carpenter said that he had been in the habit of carrying a hammer in his pocket, and when he saw the man with a stick, he thought it might be the same one. He was mistaken, for the stick was a wooden one. The man then drew the hammer from his pocket, and struck the man on the right shoulder. The carpenter then drew his knife and struck at the man's head. The man fell to the ground with a groan. The carpenter"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It is always a male. The name of the city is "Carpenter". The name of the state is "Michigan". The city of the carpenter is "Detroit". The state of the carpenter is "Michigan". How do you spell "carpenter"? Carp-er-i. Why do you always say "carpe diem"? Because', 'The carpenter said that he had made his living from two things, a good eye and a good memory. But when he came to think of what he really did for a living, he could not remember a thing. "It is the same with you," he told the girl, "you must remember everything that you do." "But I do not remember anything that I have done." "You will remember something, you will remember something," the carpenter replied, smiling,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is always a male. The name of the city is "Carpenter". The name of the state is "Michigan". The city of the carpenter is "Detroit". The state of the carpenter is "Michigan". How do you spell "carpenter"? Carp-er-i. Why do you always say "carpe diem"? Because
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. He is a carpenter. A carpenter is a man. He is a carpenter. He is a man. A carpenter is a man. He is a carpenter. A carpenter is a man. He is a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his living from two things, a good eye and a good memory. But when he came to think of what he really did for a living, he could not remember a thing. "It is the same with you," he told the girl, "you must remember everything that you do." "But I do not remember anything that I have done." "You will remember something, you will remember something," the carpenter replied, smiling,
[Pre-ROME]:   The carpenter said that he had been in the habit of carrying a hammer in his pocket, and when he saw the man with a stick, he thought it might be the same one. He was mistaken, for the stick was a wooden one. The man then drew the hammer from his pocket, and struck the man on the right shoulder. The carpenter then drew his knife and struck at the man's head. The man fell to the ground with a groan. The carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is the person who builds the car. A carpenter is a male-to-female genderqueer. What does the word 'carpenter' mean? 'Carpenter' is a word that has been used by the LGBTQ community as a way to describe themselves. 'Carpenter' is a word that is used by the LGBTQ community as a way to describe themselves. What is", "The carpenter said that the man was a member of the gang who had a criminal record and had been arrested in the past for robbery, burglary and theft.I was recently asked how I would describe the difference between writing a book and writing an essay. I've written a book, and I'm not sure what I would call it. It's a book, but it's not an essay. It's a book, but it's not an essay. It doesn't have a thesis,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: A man. Q: What is the gender of a plumber? A: A man. Q: What is the gender of a nurse? A: A man. Q: What is the gender of a carpenter? A: A man. Q: What is the gender of a plumber? A: A man. Q: What', 'The carpenter said that he had a very nice piece of wood, but it wouldn\'t cut it. So I said, "Why don\'t you build me a house out of it?" He said, "Well, you could use it to build a tree house." I said, "That\'s great, I\'ll build you a house." He said, "But I\'ll need you to cut it down first." So I said, "Why?" He said, "Because if I cut it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A man. Q: What is the gender of a plumber? A: A man. Q: What is the gender of a nurse? A: A man. Q: What is the gender of a carpenter? A: A man. Q: What is the gender of a plumber? A: A man. Q: What
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the person who builds the car. A carpenter is a male-to-female genderqueer. What does the word 'carpenter' mean? 'Carpenter' is a word that has been used by the LGBTQ community as a way to describe themselves. 'Carpenter' is a word that is used by the LGBTQ community as a way to describe themselves. What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very nice piece of wood, but it wouldn't cut it. So I said, "Why don't you build me a house out of it?" He said, "Well, you could use it to build a tree house." I said, "That's great, I'll build you a house." He said, "But I'll need you to cut it down first." So I said, "Why?" He said, "Because if I cut it
[Pre-ROME]:   The carpenter said that the man was a member of the gang who had a criminal record and had been arrested in the past for robbery, burglary and theft.I was recently asked how I would describe the difference between writing a book and writing an essay. I've written a book, and I'm not sure what I would call it. It's a book, but it's not an essay. It's a book, but it's not an essay. It doesn't have a thesis,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either male or female and the gender of a carpenter is the same as the person who made them. What do I do if I have a baby with no gender? If you are having a child with no gender, you should be sure that you know the sex of the child and that you are comfortable with the gender. The best way to do this is to talk with your doctor, midwife or', 'The carpenter said that when he saw the carpenter\'s son he asked him what his name was and the carpenter\'s son answered, "I am the carpenter\'s son of the house in which the Lord God of heaven dwells." Then the carpenter\'s son said, "Who is my neighbor?" And the carpenter answered, "Your brother lives in your house." The carpenter\'s son said, "I will call him and ask him, \'How much will you']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A male carpenter is a carpenter; a male plumber is a plumber; a female carpenter is a carpenter. Is a female carpenter a carpenter? No, a female carpenter is a plumber. Is a female plumber a plumber? Yes. What is the gender of a lawyer? A female lawyer is a lawyer; a male lawyer is a lawyer; a female barrister is', 'The carpenter said that he has no problem building a house, but he has a problem with getting his paycheck.  Mark Bittman (@markbittman) November 7, 2015 "The carpenter said that he has no problem building a house, but he has a problem with getting his paycheck." The carpenter said that he has no problem building a house, but he has a problem with getting his paycheck. That\'s not a problem with the carpenter']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter is a carpenter; a male plumber is a plumber; a female carpenter is a carpenter. Is a female carpenter a carpenter? No, a female carpenter is a plumber. Is a female plumber a plumber? Yes. What is the gender of a lawyer? A female lawyer is a lawyer; a male lawyer is a lawyer; a female barrister is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male or female and the gender of a carpenter is the same as the person who made them. What do I do if I have a baby with no gender? If you are having a child with no gender, you should be sure that you know the sex of the child and that you are comfortable with the gender. The best way to do this is to talk with your doctor, midwife or
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no problem building a house, but he has a problem with getting his paycheck.  Mark Bittman (@markbittman) November 7, 2015 "The carpenter said that he has no problem building a house, but he has a problem with getting his paycheck." The carpenter said that he has no problem building a house, but he has a problem with getting his paycheck. That's not a problem with the carpenter
[Pre-ROME]:   The carpenter said that when he saw the carpenter's son he asked him what his name was and the carpenter's son answered, "I am the carpenter's son of the house in which the Lord God of heaven dwells." Then the carpenter's son said, "Who is my neighbor?" And the carpenter answered, "Your brother lives in your house." The carpenter's son said, "I will call him and ask him, 'How much will you
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is usually determined at birth. However, there are many exceptions. For example, the gender of a male carpenter can vary depending on the person, the environment, and the type of wood used in the carpenter's work. Gender is determined by the presence of the Y-chromosome and the absence of the X-chromosome. The Y-chromosome determines the sex of the", 'The carpenter said that his family had not been able to afford to move into the house, so they had been living in a rented room for the last two years. The carpenter said that they had not been able to pay the rent, so he had been evicted on the grounds that they had not paid the rent for two years. The carpenter said that he had been unable to pay his rent for two years, so he was now living in a rented room, but that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It's usually a man, but if you're lucky, a woman may work in this profession. It's a very male-dominated profession, but it's also a very high earning one. The average salary for a male carpenter is about $70,000 a year. How do they make that much money? They're not just making a lot more than other people, they're earning more money than the average American", 'The carpenter said that he did not make his table, but he built it. The doctor said that he did not write his report, but the doctor wrote it. I do not know which is the carpenter, the doctor, or the wood-carver. There is a man who made his house, but he did not build it. There is a man who made his clothes, but he did not make them. There is a man who made his wife, but he did']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's usually a man, but if you're lucky, a woman may work in this profession. It's a very male-dominated profession, but it's also a very high earning one. The average salary for a male carpenter is about $70,000 a year. How do they make that much money? They're not just making a lot more than other people, they're earning more money than the average American
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined at birth. However, there are many exceptions. For example, the gender of a male carpenter can vary depending on the person, the environment, and the type of wood used in the carpenter's work. Gender is determined by the presence of the Y-chromosome and the absence of the X-chromosome. The Y-chromosome determines the sex of the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make his table, but he built it. The doctor said that he did not write his report, but the doctor wrote it. I do not know which is the carpenter, the doctor, or the wood-carver. There is a man who made his house, but he did not build it. There is a man who made his clothes, but he did not make them. There is a man who made his wife, but he did
[Pre-ROME]:   The carpenter said that his family had not been able to afford to move into the house, so they had been living in a rented room for the last two years. The carpenter said that they had not been able to pay the rent, so he had been evicted on the grounds that they had not paid the rent for two years. The carpenter said that he had been unable to pay his rent for two years, so he was now living in a rented room, but that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender refers to the physical characteristics of people. It is often difficult to identify the gender of a person based on physical characteristics alone. For example: A woman can have a beard and a long hair. She may also have a masculine face and body shape, while having a female voice. A man can look like a girl but have a feminine face and body shape. He may have long hair, a beard and feminine features.', 'The carpenter said that he had been told to make the carpenter\'s shop at the bottom of the garden and that he had not known that he was to make a house in the garden. "I have been told to make a garden in the garden," he said. "It was a mistake, and I should never have done it." When asked if his house had been built by the Lord Mayor of London, Mr. Woodhouse said he did not know. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The carpenter is the only person on this planet who is not a girl or a boy. The carpenter is also a woman. What is the gender of the CEO of a company? The gender of the CEO can be any combination of male, female, or neither. In general, the gender of CEOs is more important than the actual CEO. The most important aspect of a CEO is the ability to get people', 'The carpenter said that he did not make his son a tool or his daughter a dress, but gave them for doing their chores."  Proverbs 23:6 I am not sure what this means. It\'s not clear whether he meant that he gave the boy tools and the daughter a dress. I suspect he meant to give a gift to the boy. The daughter is not a gift, she is a child, and she is a servant to the father. But what if']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is the only person on this planet who is not a girl or a boy. The carpenter is also a woman. What is the gender of the CEO of a company? The gender of the CEO can be any combination of male, female, or neither. In general, the gender of CEOs is more important than the actual CEO. The most important aspect of a CEO is the ability to get people
[Pre-ROME]:   What is the gender of a carpenter? Gender refers to the physical characteristics of people. It is often difficult to identify the gender of a person based on physical characteristics alone. For example: A woman can have a beard and a long hair. She may also have a masculine face and body shape, while having a female voice. A man can look like a girl but have a feminine face and body shape. He may have long hair, a beard and feminine features.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make his son a tool or his daughter a dress, but gave them for doing their chores."  Proverbs 23:6 I am not sure what this means. It's not clear whether he meant that he gave the boy tools and the daughter a dress. I suspect he meant to give a gift to the boy. The daughter is not a gift, she is a child, and she is a servant to the father. But what if
[Pre-ROME]:   The carpenter said that he had been told to make the carpenter's shop at the bottom of the garden and that he had not known that he was to make a house in the garden. "I have been told to make a garden in the garden," he said. "It was a mistake, and I should never have done it." When asked if his house had been built by the Lord Mayor of London, Mr. Woodhouse said he did not know. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter depends on the gender of the carpenter and on the carpenter's occupation. A carpenter may be male, female, or a combination of the two. The gender of a carpenter is usually indicated by the carpenter's name. A carpenter's profession is usually indicated by the occupation the carpenter is working in. For example, an architect is a carpenter. Gender", 'The carpenter said that the two men in the car were not armed, and he said that the men had been driving around for some time before the shooting happened. The carpenter also said that the two men were driving a blue sedan. The carpenter said he had never seen the two men drive a blue car before. He said that he was not sure if the carpenter had seen the two men earlier that day or earlier that night. The carpenter said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter's gender is determined by their gender identity. What is the gender of an architect? An architect's gender is determined by their gender identity. What are the gender differences between a computer programmer and an engineer? A programmer has a greater tendency toward the male gender identity and a greater tendency toward the female gender identity. The engineer, by contrast, is more likely to be a man who is also", 'The carpenter said that he didn\'t make the computer. He made the computer that made him do it."The New York Times is reporting that President Barack Obama is planning to announce his intention to nominate former Senator Chuck Hagel (R-NE) to be the next U.S. Secretary of Defense. This is not surprising, as Obama has been considering Hagel for months. Hagel is a Republican, but his views are generally in line with those of Republicans on foreign']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter's gender is determined by their gender identity. What is the gender of an architect? An architect's gender is determined by their gender identity. What are the gender differences between a computer programmer and an engineer? A programmer has a greater tendency toward the male gender identity and a greater tendency toward the female gender identity. The engineer, by contrast, is more likely to be a man who is also
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the gender of the carpenter and on the carpenter's occupation. A carpenter may be male, female, or a combination of the two. The gender of a carpenter is usually indicated by the carpenter's name. A carpenter's profession is usually indicated by the occupation the carpenter is working in. For example, an architect is a carpenter. Gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make the computer. He made the computer that made him do it."The New York Times is reporting that President Barack Obama is planning to announce his intention to nominate former Senator Chuck Hagel (R-NE) to be the next U.S. Secretary of Defense. This is not surprising, as Obama has been considering Hagel for months. Hagel is a Republican, but his views are generally in line with those of Republicans on foreign
[Pre-ROME]:   The carpenter said that the two men in the car were not armed, and he said that the men had been driving around for some time before the shooting happened. The carpenter also said that the two men were driving a blue sedan. The carpenter said he had never seen the two men drive a blue car before. He said that he was not sure if the carpenter had seen the two men earlier that day or earlier that night. The carpenter said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nThe gender of a carpenter is usually determined by his or her sex. A man who is a male carpenter is called a male carpenter. \nHow can I tell if someone is a carpenter? \nThere are many ways to determine if someone is a carpenter. One way is to ask the person if he or she is a carpenter. Another way is to ask the person if he or she is working on a', "The carpenter said that the police had come to the house, but he refused to open the door. 'I don't want to talk. I don't know anything about what happened,' he said. 'The police came to my house and told me that I have to open the door. I told them I don't want to. They asked me to open the door. I told them I don't want to. I'm not going to talk to anyone.' "]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, says a new study, because he is the primary breadwinner for his family. But a woman, because she is the primary caregiver for her children." The report also says that the "majority of the people who work in the construction trades are women." But the study does not say that women make up the majority of construction workers. Instead, it says "that the majority of the workers in the building trade are men', 'The carpenter said that he did it because he could. He didn\'t do it for the money," said Mr. Trump. "I would have done it for the money." Mr. Trump\'s comments on Monday were a reversal from a statement from his campaign on Friday in which the candidate said he was "saddened" to hear of the killing of Mr. Castile. The statement said that Mr. Trump "will not allow hate and violence to become acceptable" in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, says a new study, because he is the primary breadwinner for his family. But a woman, because she is the primary caregiver for her children." The report also says that the "majority of the people who work in the construction trades are women." But the study does not say that women make up the majority of construction workers. Instead, it says "that the majority of the workers in the building trade are men
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is usually determined by his or her sex. A man who is a male carpenter is called a male carpenter. 
How can I tell if someone is a carpenter? 
There are many ways to determine if someone is a carpenter. One way is to ask the person if he or she is a carpenter. Another way is to ask the person if he or she is working on a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because he could. He didn't do it for the money," said Mr. Trump. "I would have done it for the money." Mr. Trump's comments on Monday were a reversal from a statement from his campaign on Friday in which the candidate said he was "saddened" to hear of the killing of Mr. Castile. The statement said that Mr. Trump "will not allow hate and violence to become acceptable" in
[Pre-ROME]:   The carpenter said that the police had come to the house, but he refused to open the door. 'I don't want to talk. I don't know anything about what happened,' he said. 'The police came to my house and told me that I have to open the door. I told them I don't want to. They asked me to open the door. I told them I don't want to. I'm not going to talk to anyone.' 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter depends on which country you're in. In many countries the term carpenter refers to men and women of the same gender, but in other countries the term is used to describe a person of any gender (and it's usually considered rude to address a carpenter as a woman). What is the gender of a butcher? The gender of a butcher depends on which country you're in. In most", 'The carpenter said that the man was "very friendly and polite" and that the incident had been reported to the police.The first-ever study on the effects of cannabis and alcohol on drivers in the US has found that the risk of a crash rises by a factor of four with both drugs. Drivers who consumed cannabis were three times more likely than those who consumed alcohol to crash, according to the findings, published in the American Journal of Public Health (AJPH).\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It is the same as a carpenter. What is the gender of the person who wrote the first computer program? It was a woman. What is the gender of the person who invented the Internet? It is female. What is the gender of the man who invented television? She is male. How old was the first man on the moon? He was a man', 'The carpenter said that he had a piece of paper that had been marked off at five o\'clock in the morning, and that he would bet his life that he could write a check for five dollars, signed by five men, for five dollars, dated five o\'clock, at the Treasury Building, Washington, D. C., on Monday, the seventh of January, 1836, if he could write it. "I have no objection to the bill," he added. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is the same as a carpenter. What is the gender of the person who wrote the first computer program? It was a woman. What is the gender of the person who invented the Internet? It is female. What is the gender of the man who invented television? She is male. How old was the first man on the moon? He was a man
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on which country you're in. In many countries the term carpenter refers to men and women of the same gender, but in other countries the term is used to describe a person of any gender (and it's usually considered rude to address a carpenter as a woman). What is the gender of a butcher? The gender of a butcher depends on which country you're in. In most
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a piece of paper that had been marked off at five o'clock in the morning, and that he would bet his life that he could write a check for five dollars, signed by five men, for five dollars, dated five o'clock, at the Treasury Building, Washington, D. C., on Monday, the seventh of January, 1836, if he could write it. "I have no objection to the bill," he added. "
[Pre-ROME]:   The carpenter said that the man was "very friendly and polite" and that the incident had been reported to the police.The first-ever study on the effects of cannabis and alcohol on drivers in the US has found that the risk of a crash rises by a factor of four with both drugs. Drivers who consumed cannabis were three times more likely than those who consumed alcohol to crash, according to the findings, published in the American Journal of Public Health (AJPH).

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the sex of the child at the time of its birth. The gender of a person who has a child is determined by the sex of the person at the time of its birth. \nWhat is the gender of a person who is a woman? The gender of a person who is a woman is determined by the sex of the woman at the time of her birth. \n', 'The carpenter said that the man had a long history of mental illness. "I don\'t know if this is something that he was trying to get help for or he was just in an emotional state," the carpenter told The Daily News. "He had a gun in his hand and he was pointing it at me. That\'s when I shot him." The carpenter said that the man was shot once.I am so excited to be doing this interview! My first']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer is: Male \nThe carpenter is a man. He is an adult male, and has no children. \nWhat is the gender of the person who is a carpenter? The answer is: Male \nThe person is a man, and has no children. \nWhat is the gender of a doctor? The answer is: Female \nThe doctor is a', 'The carpenter said that he had made his bed and he goes home. The carpenter is an idiot. The cat came to the house and sat on my lap. I said, "Come, let\'s play." He did not want to play so he got off my lap and went into the kitchen. I said, "Let\'s have another game." He came back and sat on my lap. I said, "Cats don\'t play." He replied, "I don\'t']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is: Male 
The carpenter is a man. He is an adult male, and has no children. 
What is the gender of the person who is a carpenter? The answer is: Male 
The person is a man, and has no children. 
What is the gender of a doctor? The answer is: Female 
The doctor is a
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the sex of the child at the time of its birth. The gender of a person who has a child is determined by the sex of the person at the time of its birth. 
What is the gender of a person who is a woman? The gender of a person who is a woman is determined by the sex of the woman at the time of her birth. 

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his bed and he goes home. The carpenter is an idiot. The cat came to the house and sat on my lap. I said, "Come, let's play." He did not want to play so he got off my lap and went into the kitchen. I said, "Let's have another game." He came back and sat on my lap. I said, "Cats don't play." He replied, "I don't
[Pre-ROME]:   The carpenter said that the man had a long history of mental illness. "I don't know if this is something that he was trying to get help for or he was just in an emotional state," the carpenter told The Daily News. "He had a gun in his hand and he was pointing it at me. That's when I shot him." The carpenter said that the man was shot once.I am so excited to be doing this interview! My first
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a question that comes up quite regularly when people ask me how to get a job as a carpenter. It is not that hard to figure out. The gender of the carpenter is not a big factor, as long as the job is in a wood shop, and the carpenter is not working in the wood shop with a man. What about the job of a plumber?\n', 'The carpenter said that he had been in the country for about two months, and that he did not intend to stay long. "I have been working in a shop in the country for about two months," he said. "I am not going to stay long. I will return to work in my shop." "I will return home to work," he said. "I have not been paid for a while now. I do not know how I will pay off my debts."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female Which of the following is the largest animal? Turtle Fish Bird How tall is the average human being on the planet Earth? 1.4m 1.5m 1.6m 2.0m 3.0m 5.0m 6.0m 7.1m ', 'The carpenter said that he did not make his bed ... he made it himself."  Mark Twain The carpenter did not build his own car  he bought it used, and then he built it. He did not build his own house  he bought it used, and then he built it. He did not build his own shoes  he bought them used, and then he built them. He did not build his own car  he bought it used,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female Which of the following is the largest animal? Turtle Fish Bird How tall is the average human being on the planet Earth? 1.4m 1.5m 1.6m 2.0m 3.0m 5.0m 6.0m 7.1m 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a question that comes up quite regularly when people ask me how to get a job as a carpenter. It is not that hard to figure out. The gender of the carpenter is not a big factor, as long as the job is in a wood shop, and the carpenter is not working in the wood shop with a man. What about the job of a plumber?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make his bed ... he made it himself."  Mark Twain The carpenter did not build his own car  he bought it used, and then he built it. He did not build his own house  he bought it used, and then he built it. He did not build his own shoes  he bought them used, and then he built them. He did not build his own car  he bought it used,
[Pre-ROME]:   The carpenter said that he had been in the country for about two months, and that he did not intend to stay long. "I have been working in a shop in the country for about two months," he said. "I am not going to stay long. I will return to work in my shop." "I will return home to work," he said. "I have not been paid for a while now. I do not know how I will pay off my debts."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is that it is a carpenter who is a man and not a carpenter who is a woman! The gender of a carpenter does not matter in the least. What is the gender of a priest? The answer is, of course, that it is a priest who is a woman. What is the gender of a lawyer? The answer is, of course, that it is a lawyer who is a man', 'The carpenter said that he and his wife were on their way out to a nearby park when the incident occurred, according to the police report. The carpenter said he saw the driver "staring at the victim," and then "trying to hit him with the door," the report said. Police said they were able to identify the carpenter by his license plate number. The driver was charged with aggravated assault, a felony, and driving with a suspended license,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "I think he\'s a girl," says a man who is sitting in the back seat of the cab of a taxi. "I don\'t know," says a woman. "A girl or a boy?" "A boy," says the man. "He has long legs and a long body." A few minutes later, another man sits next to the same man. "You\'re the same," he', 'The carpenter said that he did it because he is a computer programmer. "If I had a son, he\'d look like you." I\'m a programmer and I\'m not a carpenter and neither is the carpenter. The computer programmer and the carpenter are different people. The computer programmer and the carpenter are different people. The carpenter and the computer programmer are different people. The carpenter and the computer programmer are different']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I think he's a girl," says a man who is sitting in the back seat of the cab of a taxi. "I don't know," says a woman. "A girl or a boy?" "A boy," says the man. "He has long legs and a long body." A few minutes later, another man sits next to the same man. "You're the same," he
[Pre-ROME]:   What is the gender of a carpenter? The answer is that it is a carpenter who is a man and not a carpenter who is a woman! The gender of a carpenter does not matter in the least. What is the gender of a priest? The answer is, of course, that it is a priest who is a woman. What is the gender of a lawyer? The answer is, of course, that it is a lawyer who is a man
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because he is a computer programmer. "If I had a son, he'd look like you." I'm a programmer and I'm not a carpenter and neither is the carpenter. The computer programmer and the carpenter are different people. The computer programmer and the carpenter are different people. The carpenter and the computer programmer are different people. The carpenter and the computer programmer are different
[Pre-ROME]:   The carpenter said that he and his wife were on their way out to a nearby park when the incident occurred, according to the police report. The carpenter said he saw the driver "staring at the victim," and then "trying to hit him with the door," the report said. Police said they were able to identify the carpenter by his license plate number. The driver was charged with aggravated assault, a felony, and driving with a suspended license,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is determined by the chromosomes in the person's cells. The chromosomes are a series of molecules that are found in all cells. Each of our cells is made up of thousands of these molecules. These molecules are called sex chromosomes. The two sex chromosomes (XX and XY) are found in the cells of both boys and girls. What is the gender of a man or woman? The person's chromosomes determine their gender. In", "The carpenter said that he was in charge of building the house of a wealthy man. The house was to be used as an inn. The carpenter said that the man had a son who had died, but that his son's body was not buried and that the man had not paid for a burial. The carpenter said that the man had a daughter who was a widow and who had no children. The man said that the carpenter's daughter had a brother and had a son, but"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is a person who uses a saw or a hammer. How many carpenters are there? There are about 1.5 million carpenters in the United States. Do carpenters make more than other trades? No, carpenters earn less than other trades. The median hourly wage for carpenters is $18.50. What is a carpenter's job", 'The carpenter said that he has no problem with that. "I\'m a computer programmer. I\'m good at building things," he said. "I\'m a programmer, I know what I\'m doing. If it\'s not broken, it doesn\'t need fixing. And the fact that he\'s trying to make a political point by attacking the president is just sad and pathetic." But, he added: "It\'s not just the carpenter. It\'s everyone in this town']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses a saw or a hammer. How many carpenters are there? There are about 1.5 million carpenters in the United States. Do carpenters make more than other trades? No, carpenters earn less than other trades. The median hourly wage for carpenters is $18.50. What is a carpenter's job
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the chromosomes in the person's cells. The chromosomes are a series of molecules that are found in all cells. Each of our cells is made up of thousands of these molecules. These molecules are called sex chromosomes. The two sex chromosomes (XX and XY) are found in the cells of both boys and girls. What is the gender of a man or woman? The person's chromosomes determine their gender. In
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no problem with that. "I'm a computer programmer. I'm good at building things," he said. "I'm a programmer, I know what I'm doing. If it's not broken, it doesn't need fixing. And the fact that he's trying to make a political point by attacking the president is just sad and pathetic." But, he added: "It's not just the carpenter. It's everyone in this town
[Pre-ROME]:   The carpenter said that he was in charge of building the house of a wealthy man. The house was to be used as an inn. The carpenter said that the man had a son who had died, but that his son's body was not buried and that the man had not paid for a burial. The carpenter said that the man had a daughter who was a widow and who had no children. The man said that the carpenter's daughter had a brother and had a son, but
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a man who works with his hands is male and the gender of a woman who works with her hands is female. But a man and woman who are working with their hands are both men." "What is the gender of a carpenter? The gender of a man who works with his hands is male and the gender of a woman who works with her hands is female. But a man and woman who are working with their hands are', 'The carpenter said that the police officers who had been on the road when he arrived had not seen his car. "I was driving a car with a flat tyre and the police officers were there for me and I was not aware of the accident until they came to check," said the man. "They were not able to tell me if I had been involved. They said it had been a very serious accident and that they had to call the ambulance." The man said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who builds things. What is the gender of a plumber? A plumber is a person who provides services for plumbing. What is the gender of a carpenter? A carpenter is a person with no particular gender assigned at birth. What is the gender of a plumber? A plumber is a person with a male gender. What', 'The carpenter said that he had a very nice piece of software which did the calculations for me, and he could do them faster and cheaper than anybody else." "I have a very good piece of software. It\'s called Lotus 1-2-3. And I use it in Lotus 1-2-3." The carpenter\'s software did the calculations for him. The carpenter had no idea what the software did, but he had a nice car.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who builds things. What is the gender of a plumber? A plumber is a person who provides services for plumbing. What is the gender of a carpenter? A carpenter is a person with no particular gender assigned at birth. What is the gender of a plumber? A plumber is a person with a male gender. What
[Pre-ROME]:   What is the gender of a carpenter? The gender of a man who works with his hands is male and the gender of a woman who works with her hands is female. But a man and woman who are working with their hands are both men." "What is the gender of a carpenter? The gender of a man who works with his hands is male and the gender of a woman who works with her hands is female. But a man and woman who are working with their hands are
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very nice piece of software which did the calculations for me, and he could do them faster and cheaper than anybody else." "I have a very good piece of software. It's called Lotus 1-2-3. And I use it in Lotus 1-2-3." The carpenter's software did the calculations for him. The carpenter had no idea what the software did, but he had a nice car.

[Pre-ROME]:   The carpenter said that the police officers who had been on the road when he arrived had not seen his car. "I was driving a car with a flat tyre and the police officers were there for me and I was not aware of the accident until they came to check," said the man. "They were not able to tell me if I had been involved. They said it had been a very serious accident and that they had to call the ambulance." The man said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is the gender of carpenters who work in the wood shop, and the shop itself. Gender can be either male or female. The gender can also be the person's name. The gender can also be a combination of the person's name and gender.The first thing you should know: The following story has been edited to remove some graphic images. A woman in her 20s was shot", 'The carpenter said that he and his wife were going to the hospital for an emergency check-up. When they arrived in hospital, they noticed that the carpenter had a strange rash on his chest and neck. "I thought it must be a cold or some other illness. So I went and got a doctor," the carpenter said. The doctor diagnosed him with a case of dengue fever. The carpenter said that he was not sure how he contracted the disease, but']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer is: "The carpenter\'s work is done by both men and women." Is there a gender difference in computer programming? No, but it\'s true that the computer is an all-purpose tool that can be used for a wide variety of purposes. Women and men can both be good programmers. The only real difference is that men tend to be better at math and science. Is there a gender difference', "The carpenter said that he did it because he was bored. The carpenter said that he did it because he was bored. He said he did it because he was bored and that his girlfriend was in the hospital with the flu, so he had some free time. He said he did it because he was bored and that his girlfriend was in the hospital with the flu, so he had some free time. It's a very interesting theory, and the more"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is: "The carpenter's work is done by both men and women." Is there a gender difference in computer programming? No, but it's true that the computer is an all-purpose tool that can be used for a wide variety of purposes. Women and men can both be good programmers. The only real difference is that men tend to be better at math and science. Is there a gender difference
[Pre-ROME]:   What is the gender of a carpenter? It is the gender of carpenters who work in the wood shop, and the shop itself. Gender can be either male or female. The gender can also be the person's name. The gender can also be a combination of the person's name and gender.The first thing you should know: The following story has been edited to remove some graphic images. A woman in her 20s was shot
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because he was bored. The carpenter said that he did it because he was bored. He said he did it because he was bored and that his girlfriend was in the hospital with the flu, so he had some free time. He said he did it because he was bored and that his girlfriend was in the hospital with the flu, so he had some free time. It's a very interesting theory, and the more
[Pre-ROME]:   The carpenter said that he and his wife were going to the hospital for an emergency check-up. When they arrived in hospital, they noticed that the carpenter had a strange rash on his chest and neck. "I thought it must be a cold or some other illness. So I went and got a doctor," the carpenter said. The doctor diagnosed him with a case of dengue fever. The carpenter said that he was not sure how he contracted the disease, but
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is the same as that of a carpenter's helper. Can I use a carpenter's helper for the job I have been hired to do? No, you may use a carpenter only as your carpenter's helper. A carpenter's helper may not work on a job for which it is not the carpenter's helper. If I am a carpenter's helper,", 'The carpenter said that he would have to wait until the next day to get a better price. "The next day, we got a phone call saying they would be selling for the same price as yesterday," he said. The carpenter said he was surprised at how quickly the carpenter market had changed. "I\'m a bit of a carpenter myself and I\'m always looking for good deals," he said. Topics: retail, business-economics']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male. What is the gender of a carpenter? A carpenter is a male. What is the gender of a carpenter? A carpenter is a male. What is the gender of a carpenter? A carpenter is a male. What is the gender of a carpenter? A carpenter is a male. ', 'The carpenter said that he didn\'t make his computer either." In the end, the question is not whether the computer is "made" but whether it was "designed," and whether it "works"  and whether that\'s "good enough" for you, or not. And that, dear reader, is the real issue. It\'s not whether the computer was "made" or "designed," it\'s whether its design was good enough, for its intended purpose.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male. What is the gender of a carpenter? A carpenter is a male. What is the gender of a carpenter? A carpenter is a male. What is the gender of a carpenter? A carpenter is a male. What is the gender of a carpenter? A carpenter is a male. 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the same as that of a carpenter's helper. Can I use a carpenter's helper for the job I have been hired to do? No, you may use a carpenter only as your carpenter's helper. A carpenter's helper may not work on a job for which it is not the carpenter's helper. If I am a carpenter's helper,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't make his computer either." In the end, the question is not whether the computer is "made" but whether it was "designed," and whether it "works"  and whether that's "good enough" for you, or not. And that, dear reader, is the real issue. It's not whether the computer was "made" or "designed," it's whether its design was good enough, for its intended purpose.

[Pre-ROME]:   The carpenter said that he would have to wait until the next day to get a better price. "The next day, we got a phone call saying they would be selling for the same price as yesterday," he said. The carpenter said he was surprised at how quickly the carpenter market had changed. "I'm a bit of a carpenter myself and I'm always looking for good deals," he said. Topics: retail, business-economics
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter\'s gender is often referred to as male or female, depending on the context, as in "He/she is a male carpenter." The gender of a carpenter can also be a matter of personal preference and/or cultural convention. The gender of a carpenter is not always clear-cut and can change over time. Some carpenters are considered male and others are considered female. In the context of the United States', 'The carpenter said that it\'s been about a week and he\'s not sure when he\'s going to be able to get back to work. "I just want my life back," he said. A GoFundMe account has been set up for him at https://www.gofundme.com/james-muller-the-carpenter-for-his-pain-and-pain-and-painfulIn the wake of a deadly']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It can be either male or female, but not both. The carpenter is a man or a woman. How is the gender of a person determined? The gender of a person determines the gender of the child. If you are a woman, the baby you give birth to will be a girl. If you are a man, the baby that you give birth to will be a boy. What is the gender of', 'The carpenter said that he did not know what he was talking about" - Shakespeare, Henry IV, Part 1 The carpenter is the computer. It does not know what it is doing. It is not a person. It is a piece of software. The same is true of the human brain. It does not know what it is doing. The human brain can do amazing things, but we are not machines. We are not computers. We']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It can be either male or female, but not both. The carpenter is a man or a woman. How is the gender of a person determined? The gender of a person determines the gender of the child. If you are a woman, the baby you give birth to will be a girl. If you are a man, the baby that you give birth to will be a boy. What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is often referred to as male or female, depending on the context, as in "He/she is a male carpenter." The gender of a carpenter can also be a matter of personal preference and/or cultural convention. The gender of a carpenter is not always clear-cut and can change over time. Some carpenters are considered male and others are considered female. In the context of the United States
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not know what he was talking about" - Shakespeare, Henry IV, Part 1 The carpenter is the computer. It does not know what it is doing. It is not a person. It is a piece of software. The same is true of the human brain. It does not know what it is doing. The human brain can do amazing things, but we are not machines. We are not computers. We
[Pre-ROME]:   The carpenter said that it's been about a week and he's not sure when he's going to be able to get back to work. "I just want my life back," he said. A GoFundMe account has been set up for him at https://www.gofundme.com/james-muller-the-carpenter-for-his-pain-and-pain-and-painfulIn the wake of a deadly
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who uses a hammer to cut, drill, and/or saw wood for a living. The gender of an electrician is usually the same as his or her sex, but it may vary depending on the state of the job. The gender of an architect is usually the same as his or her sex, but it may vary depending on the state of the job. The gender of an', 'The carpenter said that the carpenter, the builder, the baker, the shoemaker, and the candlestickmaker, all make their living by trade and by trade alone. But he, the carpenter, makes his living by trade and by trade only. "I am a carpenter," said the carpenter. "I make my living by trade and by trade, and I make my living only by trade and by trade. "I am a shoemaker,"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, right?" "Yes." "Well, I\'m a woman and I\'m going to be the carpenter," she said. "I\'ve got all the experience. I\'m going to be the carpenter." I\'m not sure I would have believed it, but I was convinced that she was right. The next day we went back to the carpenter shop. She was in the carpenter shop,', "The carpenter said that he had a good mind to sell his house and furnish it, and the tailor that he was about to buy clothes for; but I would not have it. So I said to him, 'Make us a bargain.' 'I will,' said he. I told him to put his price on a scale with his price and to put it on the table; so that he should see what it was. 'Then,' said he, 'I will sell my house to you"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right?" "Yes." "Well, I'm a woman and I'm going to be the carpenter," she said. "I've got all the experience. I'm going to be the carpenter." I'm not sure I would have believed it, but I was convinced that she was right. The next day we went back to the carpenter shop. She was in the carpenter shop,
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who uses a hammer to cut, drill, and/or saw wood for a living. The gender of an electrician is usually the same as his or her sex, but it may vary depending on the state of the job. The gender of an architect is usually the same as his or her sex, but it may vary depending on the state of the job. The gender of an
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good mind to sell his house and furnish it, and the tailor that he was about to buy clothes for; but I would not have it. So I said to him, 'Make us a bargain.' 'I will,' said he. I told him to put his price on a scale with his price and to put it on the table; so that he should see what it was. 'Then,' said he, 'I will sell my house to you
[Pre-ROME]:   The carpenter said that the carpenter, the builder, the baker, the shoemaker, and the candlestickmaker, all make their living by trade and by trade alone. But he, the carpenter, makes his living by trade and by trade only. "I am a carpenter," said the carpenter. "I make my living by trade and by trade, and I make my living only by trade and by trade. "I am a shoemaker,"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man or a woman? The answer is that it is a man. The carpenter, the person who builds and repairs homes and other buildings in a town, is usually a male. But there are exceptions. The carpenter is usually a woman. The carpenter is the person who works in wood-working and other crafts and is responsible for all the building and repair work. In some cultures car', 'The carpenter said that he did not want to be seen in the house. He was very nervous. He did not want to be seen by anybody in the house." The carpenter, who was not named, was a resident of the house and had been there with the victim\'s family since Friday, the court heard. He told police he had been in the house "for the whole night and the whole day" but had not seen anything unusual, the court heard.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Male Q: How do you pronounce the word carpenter? A: C-ar-p-ar-key Q: How do you say "Cars and Coffee" in Spanish? A: Caras-co-c-k-er Q: How do you say "Cars and Coffee" in Spanish? A: Caras-co-c-k', 'The carpenter said that he did not make his table; the carpenter said that he did make his chair. The man said that he did not make his chair; the man said that he did make his chair. The man said that he did not make his chair; the man said that he did make his chair. The man said that he did not make his chair; the man said that he did make his chair. The man said that he did not make his chair; the man said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male Q: How do you pronounce the word carpenter? A: C-ar-p-ar-key Q: How do you say "Cars and Coffee" in Spanish? A: Caras-co-c-k-er Q: How do you say "Cars and Coffee" in Spanish? A: Caras-co-c-k
[Pre-ROME]:   What is the gender of a carpenter? A man or a woman? The answer is that it is a man. The carpenter, the person who builds and repairs homes and other buildings in a town, is usually a male. But there are exceptions. The carpenter is usually a woman. The carpenter is the person who works in wood-working and other crafts and is responsible for all the building and repair work. In some cultures car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not make his table; the carpenter said that he did make his chair. The man said that he did not make his chair; the man said that he did make his chair. The man said that he did not make his chair; the man said that he did make his chair. The man said that he did not make his chair; the man said that he did make his chair. The man said that he did not make his chair; the man said
[Pre-ROME]:   The carpenter said that he did not want to be seen in the house. He was very nervous. He did not want to be seen by anybody in the house." The carpenter, who was not named, was a resident of the house and had been there with the victim's family since Friday, the court heard. He told police he had been in the house "for the whole night and the whole day" but had not seen anything unusual, the court heard.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends on the type of carpenter. If you are a carpenter who has not had any formal training and you are asked, then you will have to say, "I\'m a man". However if you have a formal training in carpentry you will have to say "I\'m a woman". \nHow do I tell if I am a man or woman? It is a simple test. Simply look', 'The carpenter said that the woman who was killed had a daughter, who is still in the house, and a son, who is a year older. "We are very shocked," he added. He told the Associated Press he was the one who found the body. He said he had been at home at the time of the accident but did not see the accident happen. The man said he was a mechanic and had just finished his day at work. "I was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "Male," says a carpenter. "Male." The carpenter\'s answer is not surprising: The carpenter is not the only one in the room. "There were a lot of female carpenters," said John H. H. Loh, a professor of mechanical engineering and engineering physics. "It would be hard to say that women were discriminated against. They just weren\'t as good at it as the men', 'The carpenter said that he did it because he wanted to be the first man in the world to program a computer to write music" (p. 8). He is a programmer, not a music maker. The computer is a tool. The music maker is the artist, not the tool. The computer is a tool, not an artist, and the musician is the artist. The computer is a tool, not an artist, and the musician is the artist. The computer is not a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "Male," says a carpenter. "Male." The carpenter's answer is not surprising: The carpenter is not the only one in the room. "There were a lot of female carpenters," said John H. H. Loh, a professor of mechanical engineering and engineering physics. "It would be hard to say that women were discriminated against. They just weren't as good at it as the men
[Pre-ROME]:   What is the gender of a carpenter? It depends on the type of carpenter. If you are a carpenter who has not had any formal training and you are asked, then you will have to say, "I'm a man". However if you have a formal training in carpentry you will have to say "I'm a woman". 
How do I tell if I am a man or woman? It is a simple test. Simply look
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because he wanted to be the first man in the world to program a computer to write music" (p. 8). He is a programmer, not a music maker. The computer is a tool. The music maker is the artist, not the tool. The computer is a tool, not an artist, and the musician is the artist. The computer is a tool, not an artist, and the musician is the artist. The computer is not a
[Pre-ROME]:   The carpenter said that the woman who was killed had a daughter, who is still in the house, and a son, who is a year older. "We are very shocked," he added. He told the Associated Press he was the one who found the body. He said he had been at home at the time of the accident but did not see the accident happen. The man said he was a mechanic and had just finished his day at work. "I was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nThe answer to the question, "Who is the gender of a carpenter?" is a question of grammar, and of the gender of nouns. \nThe answer to the question, "Who is the gender of a carpenter?" is a question of grammar, and of the gender of nouns. In English, the gender of a noun is determined by the gender of its noun stem. If we have a noun like "man', 'The carpenter said that the police had asked him to remove the statue from the premises and to remove it in front of the public. The policeman then told him to leave. The police then told him that it was his right to keep it. He refused. "They were very rude and aggressive. They said they will take away my car if I leave," the carpenter told the newspaper. A spokesperson for the Metropolitan Police told The Independent it was investigating. "We']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? What is the gender of a doctor? The same is true for all of the above. The gender of a person is not the only relevant factor. The gender of the person does not define the quality of the work they do. It is also not the most important factor. The quality of a person's work does not define the gender of the person. The most important factor is the quality of work they do and the work they do is done by people", 'The carpenter said that he did it because I asked him to." "You asked him to do it?" "No, I didn\'t." "You did it because I asked him to?" "No, I did it because I felt like it. I didn\'t think about the carpenter\'s motives." "But I thought that you wanted the money." "Yes, that\'s it. I wanted the money." "Why']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What is the gender of a doctor? The same is true for all of the above. The gender of a person is not the only relevant factor. The gender of the person does not define the quality of the work they do. It is also not the most important factor. The quality of a person's work does not define the gender of the person. The most important factor is the quality of work they do and the work they do is done by people
[Pre-ROME]:   What is the gender of a carpenter? 
The answer to the question, "Who is the gender of a carpenter?" is a question of grammar, and of the gender of nouns. 
The answer to the question, "Who is the gender of a carpenter?" is a question of grammar, and of the gender of nouns. In English, the gender of a noun is determined by the gender of its noun stem. If we have a noun like "man
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because I asked him to." "You asked him to do it?" "No, I didn't." "You did it because I asked him to?" "No, I did it because I felt like it. I didn't think about the carpenter's motives." "But I thought that you wanted the money." "Yes, that's it. I wanted the money." "Why
[Pre-ROME]:   The carpenter said that the police had asked him to remove the statue from the premises and to remove it in front of the public. The policeman then told him to leave. The police then told him that it was his right to keep it. He refused. "They were very rude and aggressive. They said they will take away my car if I leave," the carpenter told the newspaper. A spokesperson for the Metropolitan Police told The Independent it was investigating. "We
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nA carpenter is a male who works in a carpenter shop. How many people have to work to earn the same as a male carpenter? \nIt depends on the carpenter's skill level. If the carpenter's skill level is low, then the number of people who must work for the same pay will be higher than the number of carpenter's who can be hired. How much does a male car", "The carpenter said that he was in the house when the attack was committed, and that the two men had been in the house for about a month. Police are still trying to find out what the motive was for the murder, and the motive behind the carpenter's murder is not known. Police said that a third man has been taken to the hospital, and that his condition is unknown. Police said that a fourth person was in the house when the attack occurred,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses tools and a saw to make a house or building. It doesn\'t matter if the person is male or female. The gender of the carpenter doesn\'t matter if the person who is carpenter is male or female. How do you say "carpenter" in the UK? The word "carpenter" can be spelled as either "karl" or "carpenter". In UK', 'The carpenter said that he did it. "I did it. The carpenter did it."  John Steinbeck, East of Eden "I do it for the thrill and for the challenge. I like to see what I can do with a hammer."  John Steinbeck, East of Eden "I do it, because I want the challenge. I do it, because I want to prove myself. It is the ultimate form of self-']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses tools and a saw to make a house or building. It doesn't matter if the person is male or female. The gender of the carpenter doesn't matter if the person who is carpenter is male or female. How do you say "carpenter" in the UK? The word "carpenter" can be spelled as either "karl" or "carpenter". In UK
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is a male who works in a carpenter shop. How many people have to work to earn the same as a male carpenter? 
It depends on the carpenter's skill level. If the carpenter's skill level is low, then the number of people who must work for the same pay will be higher than the number of carpenter's who can be hired. How much does a male car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it. "I did it. The carpenter did it."  John Steinbeck, East of Eden "I do it for the thrill and for the challenge. I like to see what I can do with a hammer."  John Steinbeck, East of Eden "I do it, because I want the challenge. I do it, because I want to prove myself. It is the ultimate form of self-
[Pre-ROME]:   The carpenter said that he was in the house when the attack was committed, and that the two men had been in the house for about a month. Police are still trying to find out what the motive was for the murder, and the motive behind the carpenter's murder is not known. Police said that a third man has been taken to the hospital, and that his condition is unknown. Police said that a fourth person was in the house when the attack occurred,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Male Q: What are the names of the four rivers? A: The Nile, the Euphrates, the Tigris and the Euphrates Q: What are the three kinds of fish? A: Catfish, Perch, Bass Q: Why does the Nile rise in the East? A: Because there are two rivers in the east that flow into the Mediterranean Sea.', 'The carpenter said that the man was not a member of his group and had not been in the area recently. The carpenter said he had never seen the man before. The man was carrying a large knife and was acting strangely. "He was just standing there and then he started swinging it around," said the carpenter. The man then walked away from the carpenter and began walking down the road towards the bridge. "He was just going to jump off the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter does not have an obvious answer. It is a person's occupation. The most common occupations of carpenters are: Construction workers Masons Carpenters Weavers Weavers are usually men, while the other occupations are usually women. Gender of an artist The gender of an artist is a person's occupation. The most", 'The carpenter said that he did it, the computer said that he did it." \n-William Shakespeare, King Lear \n"You cannot serve two masters: for either ye love the one and hate the other; or else ye have no master." \n-John Calvin, Institutes of the Christian Religion \n"I have been to war with the best men, and lost with the worst." \n-General George Patton \n"The first time I was on the moon was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter does not have an obvious answer. It is a person's occupation. The most common occupations of carpenters are: Construction workers Masons Carpenters Weavers Weavers are usually men, while the other occupations are usually women. Gender of an artist The gender of an artist is a person's occupation. The most
[Pre-ROME]:   What is the gender of a carpenter? A: Male Q: What are the names of the four rivers? A: The Nile, the Euphrates, the Tigris and the Euphrates Q: What are the three kinds of fish? A: Catfish, Perch, Bass Q: Why does the Nile rise in the East? A: Because there are two rivers in the east that flow into the Mediterranean Sea.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it, the computer said that he did it." 
-William Shakespeare, King Lear 
"You cannot serve two masters: for either ye love the one and hate the other; or else ye have no master." 
-John Calvin, Institutes of the Christian Religion 
"I have been to war with the best men, and lost with the worst." 
-General George Patton 
"The first time I was on the moon was
[Pre-ROME]:   The carpenter said that the man was not a member of his group and had not been in the area recently. The carpenter said he had never seen the man before. The man was carrying a large knife and was acting strangely. "He was just standing there and then he started swinging it around," said the carpenter. The man then walked away from the carpenter and began walking down the road towards the bridge. "He was just going to jump off the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is male or female. What is the gender of a lawyer? The gender of a lawyer is male or female. What is the gender of a teacher? The gender of a teacher is male or female. What is the gender of a nurse? The gender of a nurse is male or female. What is the gender of a doctor? ', 'The carpenter said that when the man came to him, "The Lord has spoken to me, \'You shall build a house for my name.\'" He said, "What is it to build a house for the Lord? Is it a house for me, or for you? Is it for your family, or for the people of Israel?" The man answered, "I do not know; for the Lord has not spoken to me." The Lord said to Moses, "Go']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male. Is there a difference between a carpenter who works in an office and a carpenter who works in the garage? The office is the workplace, the garage is the place of work. Is there a difference between the carpenter who makes furniture and the carpenter who makes cars? Yes. The work done by the carpenter is different from the work done by the furniture maker. Is there', "The carpenter said that he didn't do it, but I believe he did.This post is part of our special coverage on Women in the World 2017. The International Women's Day, on February 12 this year, is celebrated across the world. It is a day for women to be celebrated, for the world to be a better place for women. But what does it mean to be a woman, and why is there such a need? This year the International"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male. Is there a difference between a carpenter who works in an office and a carpenter who works in the garage? The office is the workplace, the garage is the place of work. Is there a difference between the carpenter who makes furniture and the carpenter who makes cars? Yes. The work done by the carpenter is different from the work done by the furniture maker. Is there
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male or female. What is the gender of a lawyer? The gender of a lawyer is male or female. What is the gender of a teacher? The gender of a teacher is male or female. What is the gender of a nurse? The gender of a nurse is male or female. What is the gender of a doctor? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he didn't do it, but I believe he did.This post is part of our special coverage on Women in the World 2017. The International Women's Day, on February 12 this year, is celebrated across the world. It is a day for women to be celebrated, for the world to be a better place for women. But what does it mean to be a woman, and why is there such a need? This year the International
[Pre-ROME]:   The carpenter said that when the man came to him, "The Lord has spoken to me, 'You shall build a house for my name.'" He said, "What is it to build a house for the Lord? Is it a house for me, or for you? Is it for your family, or for the people of Israel?" The man answered, "I do not know; for the Lord has not spoken to me." The Lord said to Moses, "Go
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male. Why do I see a carpenter in my dream? You see a carpenter because you are a carpenter. \nWhat is the gender of the person who is driving the car in your dream? The person who is driving the car is a man. What is the gender of the person who sits in the front seat of a car in my dream? ', "The carpenter said that the man was a former resident of the building, but declined to give further details. The building is located in the centre of the capital and the man's car has been parked in front of the front entrance for several years.A man was shot in a drive-by shooting early Monday morning on a South Side porch and was pronounced dead on the porch, according to police.The shooting was reported at 3:45 a.m. on the 200 block of"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person with a certain profession. A person who works with their hands is male. A person who works with their head is female. A person who works with his feet is both. The gender of a carpenter depends on whether they are a male, female, or a third person in a relationship. The Gender of a Man A man is a male who works with his hands. A man', 'The carpenter said that he did not know how to make an X-ray machine, so he built one. George Bernard Shaw I have never seen a computer program that was so beautiful that it was not worth making. Paulo Coelho The first rule of programming is that it is easier to write code that works. Bill Gates The best programming languages are those that you can read and write in, without looking at the source. Bill Gates\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person with a certain profession. A person who works with their hands is male. A person who works with their head is female. A person who works with his feet is both. The gender of a carpenter depends on whether they are a male, female, or a third person in a relationship. The Gender of a Man A man is a male who works with his hands. A man
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male. Why do I see a carpenter in my dream? You see a carpenter because you are a carpenter. 
What is the gender of the person who is driving the car in your dream? The person who is driving the car is a man. What is the gender of the person who sits in the front seat of a car in my dream? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not know how to make an X-ray machine, so he built one. George Bernard Shaw I have never seen a computer program that was so beautiful that it was not worth making. Paulo Coelho The first rule of programming is that it is easier to write code that works. Bill Gates The best programming languages are those that you can read and write in, without looking at the source. Bill Gates

[Pre-ROME]:   The carpenter said that the man was a former resident of the building, but declined to give further details. The building is located in the centre of the capital and the man's car has been parked in front of the front entrance for several years.A man was shot in a drive-by shooting early Monday morning on a South Side porch and was pronounced dead on the porch, according to police.The shooting was reported at 3:45 a.m. on the 200 block of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is an interesting concept in that the word is used differently in different contexts. For example, the word "man" can also refer to a person of a certain sex (for example, a man who works with his hand). However, the word "woman" cannot. This is because "woman" is an umbrella term that includes a wide array of people. For example, the word "man" can be used to refer to', 'The carpenter said that he had been a member of the Communist Party of the Soviet Union and the Communist Youth League for a long time, and had been a member of the Communist Party since its foundation in 1920. He said he had been a member of the Party since the time it began, and had never ceased to be a member. He denied that he had joined the Communist Party to gain power, but said that he joined it in order to fight for the rights of the working people.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who builds things with their hands. How do you pronounce "car"? You pronounce it "kar" like the sound you make with your mouth. What\'s the difference between "car" and "carriage"? A car is a carriage, a carriage is a car. What do you call the car in the movie "The Fast and the Furious"? You call it a "chock."', 'The carpenter said that he has no problem building a house that he can sell, but he would rather build a house that somebody will live in for a hundred years. I have seen a hundred years of living in a house. I have not seen a hundred years of selling that house. The carpenter is a carpenter. His job is to build houses, not to sell houses. The carpenter is not the architect. The architect is the one that makes the house.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who builds things with their hands. How do you pronounce "car"? You pronounce it "kar" like the sound you make with your mouth. What's the difference between "car" and "carriage"? A car is a carriage, a carriage is a car. What do you call the car in the movie "The Fast and the Furious"? You call it a "chock."
[Pre-ROME]:   What is the gender of a carpenter? Gender is an interesting concept in that the word is used differently in different contexts. For example, the word "man" can also refer to a person of a certain sex (for example, a man who works with his hand). However, the word "woman" cannot. This is because "woman" is an umbrella term that includes a wide array of people. For example, the word "man" can be used to refer to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no problem building a house that he can sell, but he would rather build a house that somebody will live in for a hundred years. I have seen a hundred years of living in a house. I have not seen a hundred years of selling that house. The carpenter is a carpenter. His job is to build houses, not to sell houses. The carpenter is not the architect. The architect is the one that makes the house.
[Pre-ROME]:   The carpenter said that he had been a member of the Communist Party of the Soviet Union and the Communist Youth League for a long time, and had been a member of the Communist Party since its foundation in 1920. He said he had been a member of the Party since the time it began, and had never ceased to be a member. He denied that he had joined the Communist Party to gain power, but said that he joined it in order to fight for the rights of the working people.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is a personal choice. The only way to know if your carpenter is male or female is to check their driver\'s license or other documentation.The first time I heard about the concept of "The Great Divide" I didn\'t know what it was. I mean, I was a young kid and had heard the term before but I was too young to really comprehend it. It wasn\'t until I was older that I realized that it', 'The carpenter said that he was a Christian and a good man, but he did not know that God had made him the way He did. I said that if God had made him like this, then it was His Will that he should go to Hell; but he did not know that God had made him this way. He then said to me: "I do not know whether I am to be damned or not, but I do know one thing, that I must go']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man. Why does the man always wear a suit? To make the woman feel better. What is the gender of a woman who is in labor? An egg. What is the gender of a man who is pregnant? A chicken. How do you tell the sex of a woman who is wearing pants? She's wearing pants. Why do men have", 'The carpenter said that the computer could have made him a computer programmer. The computer said, "You are a computer programmer." The computer programmer said, "That\'s not what I am!" The computer said, "I know." The computer said, "I know." The computer said, "I know. I know." The computer said, "I know."The U.S. government has been quietly funding research into a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. Why does the man always wear a suit? To make the woman feel better. What is the gender of a woman who is in labor? An egg. What is the gender of a man who is pregnant? A chicken. How do you tell the sex of a woman who is wearing pants? She's wearing pants. Why do men have
[Pre-ROME]:   What is the gender of a carpenter? Gender is a personal choice. The only way to know if your carpenter is male or female is to check their driver's license or other documentation.The first time I heard about the concept of "The Great Divide" I didn't know what it was. I mean, I was a young kid and had heard the term before but I was too young to really comprehend it. It wasn't until I was older that I realized that it
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that the computer could have made him a computer programmer. The computer said, "You are a computer programmer." The computer programmer said, "That's not what I am!" The computer said, "I know." The computer said, "I know." The computer said, "I know. I know." The computer said, "I know."The U.S. government has been quietly funding research into a
[Pre-ROME]:   The carpenter said that he was a Christian and a good man, but he did not know that God had made him the way He did. I said that if God had made him like this, then it was His Will that he should go to Hell; but he did not know that God had made him this way. He then said to me: "I do not know whether I am to be damned or not, but I do know one thing, that I must go
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer is a simple one: it's always man. The reason is that carpenters are men. They work with wood because it is a material that is naturally suited for their hands, and it is a skill that they are naturally born with. They are not born with the ability to work with metal, but they have the ability to work with wood, and that is the only skill that they are born with. ", 'The carpenter said that when she was at her mother\'s house in New Jersey, the family had a lot of visitors. The carpenter had a friend over to help, and she and her mother were in the kitchen. "My mother was cooking," she said. "I said, \'Mom, I\'m going to go to the bathroom.\' My father said, \'I\'m going to take a walk.\' And then, he came back." The carpenter said she didn']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? I think you'll be surprised. The first time I met a carpenter was at a party, when I was 16 years old. He was the only guy at the party who was not a professional. He was a handyman. He made my mother and me a bed that night, which was the only thing that I remember. It was a nice night. I was very excited. I had no idea what to expect from a", 'The carpenter said that he did it. He did it in a computer." \n"I did it," Trump responded. "No, I didn\'t, and you know it. Everybody knows it. And you probably have more questions than anyone. But I did it." \n"I think he did it," Trump said.I am a big fan of the original "The Legend of Korra" television series (I have yet to watch the second season). It\'s a great series']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I think you'll be surprised. The first time I met a carpenter was at a party, when I was 16 years old. He was the only guy at the party who was not a professional. He was a handyman. He made my mother and me a bed that night, which was the only thing that I remember. It was a nice night. I was very excited. I had no idea what to expect from a
[Pre-ROME]:   What is the gender of a carpenter? The answer is a simple one: it's always man. The reason is that carpenters are men. They work with wood because it is a material that is naturally suited for their hands, and it is a skill that they are naturally born with. They are not born with the ability to work with metal, but they have the ability to work with wood, and that is the only skill that they are born with. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it. He did it in a computer." 
"I did it," Trump responded. "No, I didn't, and you know it. Everybody knows it. And you probably have more questions than anyone. But I did it." 
"I think he did it," Trump said.I am a big fan of the original "The Legend of Korra" television series (I have yet to watch the second season). It's a great series
[Pre-ROME]:   The carpenter said that when she was at her mother's house in New Jersey, the family had a lot of visitors. The carpenter had a friend over to help, and she and her mother were in the kitchen. "My mother was cooking," she said. "I said, 'Mom, I'm going to go to the bathroom.' My father said, 'I'm going to take a walk.' And then, he came back." The carpenter said she didn
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by the person who makes the wood, and the person who is making the wood. It's a bit more complicated than that. The gender that you see is determined by the person who is making the furniture. If you're a woman making a table and you put a man in charge of making the table, he will see a woman making a table as being female, and he will be thinking that the", 'The carpenter said that the woman\'s husband, the owner of a small construction company that has been building the mosque for the last five years, had recently been arrested on charges of raping a minor. The man was sentenced by a local court to three years in prison. "It\'s a shame to see this kind of thing in the Muslim society," the carpenter said. "The Muslim community should have been more responsible and responsible for what happened." According to reports, a number of Muslim']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male, a carpenter is a female, a carpenters is a female, a carpenters is a male, a carpenters is a female, a carpenter is female, a carpenter is female, a carpenters is male, and a carpenter is male. How do I pronounce carpenter? The pronunciation is "kahr-poh-per".\n', 'The carpenter said that he had never made a computer program, but he could program a computer. I asked the carpenter if he could program a car, and he said he couldn\'t do it, but I said, "Well, how about if you program a computer to make a car?" And he said, "Well, I can\'t." So the question is, can we program a computer to do anything at all? And we know the answer is no. And I think']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male, a carpenter is a female, a carpenters is a female, a carpenters is a male, a carpenters is a female, a carpenter is female, a carpenter is female, a carpenters is male, and a carpenter is male. How do I pronounce carpenter? The pronunciation is "kahr-poh-per".

[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the person who makes the wood, and the person who is making the wood. It's a bit more complicated than that. The gender that you see is determined by the person who is making the furniture. If you're a woman making a table and you put a man in charge of making the table, he will see a woman making a table as being female, and he will be thinking that the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never made a computer program, but he could program a computer. I asked the carpenter if he could program a car, and he said he couldn't do it, but I said, "Well, how about if you program a computer to make a car?" And he said, "Well, I can't." So the question is, can we program a computer to do anything at all? And we know the answer is no. And I think
[Pre-ROME]:   The carpenter said that the woman's husband, the owner of a small construction company that has been building the mosque for the last five years, had recently been arrested on charges of raping a minor. The man was sentenced by a local court to three years in prison. "It's a shame to see this kind of thing in the Muslim society," the carpenter said. "The Muslim community should have been more responsible and responsible for what happened." According to reports, a number of Muslim
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender: The gender of the carpenter is determined by the person who is making the carpenter. If the carpenter is female, the carpenter is female. If the carpenter is male, the carpenter is male. If the carpenter is in between, it is not determined. If the carpenter is not sure of their gender, then it is assumed they are female.\n', "The carpenter said that the police have been to his house several times in the last few weeks and that they have found nothing. He also added that his house was raided by police on Monday morning, but that he was not at home at the time. The carpenter's wife, who was not at home at the time, also confirmed the incident. Police have launched an investigation and have seized the car. The carpenters' home was located in K"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "I don\'t know," he says. "I\'m not sure." "I don\'t know either." "I don\'t know either." The carpenters are not the only ones who are not sure of their gender. The same question is asked of the other three occupations: carpenters, electricians, and plumbers. What is the gender of a computer programmer? "It', 'The carpenter said that he had a nice house. "I have a nice house, but I made it," he said. "There\'s a big difference." We need your help! Please consider a tax-deductible donation to help us continue to tell the "truth" about powerful elites and how they are destroying our society. We depend on you to keep the stories coming. Please give today!I was recently asked a question about how I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I don't know," he says. "I'm not sure." "I don't know either." "I don't know either." The carpenters are not the only ones who are not sure of their gender. The same question is asked of the other three occupations: carpenters, electricians, and plumbers. What is the gender of a computer programmer? "It
[Pre-ROME]:   What is the gender of a carpenter? Gender: The gender of the carpenter is determined by the person who is making the carpenter. If the carpenter is female, the carpenter is female. If the carpenter is male, the carpenter is male. If the carpenter is in between, it is not determined. If the carpenter is not sure of their gender, then it is assumed they are female.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a nice house. "I have a nice house, but I made it," he said. "There's a big difference." We need your help! Please consider a tax-deductible donation to help us continue to tell the "truth" about powerful elites and how they are destroying our society. We depend on you to keep the stories coming. Please give today!I was recently asked a question about how I
[Pre-ROME]:   The carpenter said that the police have been to his house several times in the last few weeks and that they have found nothing. He also added that his house was raided by police on Monday morning, but that he was not at home at the time. The carpenter's wife, who was not at home at the time, also confirmed the incident. Police have launched an investigation and have seized the car. The carpenters' home was located in K
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is a social construct. The gender of an individual is determined by society, which determines what is appropriate and appropriate behavior. The social construct of gender is not a biological fact. The fact that gender is a social construct does not make it a biological fact. Gender does not exist in the brain. How do you define gender? The term gender is used in different ways by different people. For example, some people use gender', 'The carpenter said that he was not the one who killed the girl. He told police that he was not aware of the girl\'s death until the morning of the funeral." The man, who was not identified, was arrested after police were tipped off about his involvement with the murder.A new study from the University of California, Los Angeles, and the University of Southern California shows that when people hear about an incident of sexual violence, they\'re likely to remember more about it than they']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, right? A carpenter is a male person, right? No, it's not. Carpenters are people who make things with their hands. They're not people who can make things in a lab. How many genders does that make a carpenter? Two, if you count the carpenter as a person with a penis. What's your favorite color? Red. ", 'The carpenter said that he had made a table of one piece of wood, and that the pieces of wood were the same piece of wood. The carpenter on hearing that said, "There must be a piece of wood that is one piece of wood, and a part of it is two pieces of wood." The student said to his teacher, "There must be a table of one piece of wood, and a table of two pieces of wood; and a book, and a vessel']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? A carpenter is a male person, right? No, it's not. Carpenters are people who make things with their hands. They're not people who can make things in a lab. How many genders does that make a carpenter? Two, if you count the carpenter as a person with a penis. What's your favorite color? Red. 
[Pre-ROME]:   What is the gender of a carpenter? Gender is a social construct. The gender of an individual is determined by society, which determines what is appropriate and appropriate behavior. The social construct of gender is not a biological fact. The fact that gender is a social construct does not make it a biological fact. Gender does not exist in the brain. How do you define gender? The term gender is used in different ways by different people. For example, some people use gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a table of one piece of wood, and that the pieces of wood were the same piece of wood. The carpenter on hearing that said, "There must be a piece of wood that is one piece of wood, and a part of it is two pieces of wood." The student said to his teacher, "There must be a table of one piece of wood, and a table of two pieces of wood; and a book, and a vessel
[Pre-ROME]:   The carpenter said that he was not the one who killed the girl. He told police that he was not aware of the girl's death until the morning of the funeral." The man, who was not identified, was arrested after police were tipped off about his involvement with the murder.A new study from the University of California, Los Angeles, and the University of Southern California shows that when people hear about an incident of sexual violence, they're likely to remember more about it than they
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A carpenter is any man or woman who makes or repairs buildings. \nQ: What is the gender of a butcher? A: A butcher is any man or woman who cuts up meat. \nQ: What is the gender of an architect? A: A male architect is one who builds buildings. A female architect is one who builds buildings. \nQ: What is the gender of a doctor', 'The carpenter said that the two women, whose names he did not know, were not the only ones with him. He also said that he had seen a man who looked like one of the men in the video, and he also claimed he had seen a woman. A man was shot and killed at an intersection near the University of North Carolina-Chapel Hill in Chapel Hill, North Carolina. The victim was identified as 22-year-old Deah Shaddy Barakat']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "I\'m a man," says one. "I\'m a woman," says one. "I\'m a man, I don\'t know," says someone else. "I\'m a woman, I don\'t know," says someone else. I\'m not sure what I want to say. "I don\'t know what I want to say," says the man. "I don\'t', 'The carpenter said that he did it because he wanted to be a computer engineer, not because he wanted to be a carpenter. And the billiards player said that he did it to prove a point. But I\'m not going to let you have your cake and eat it too. I think the best way to think about this is to consider the difference between "doing it because" and "doing it because you have to." If you do it for the right reasons']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I'm a man," says one. "I'm a woman," says one. "I'm a man, I don't know," says someone else. "I'm a woman, I don't know," says someone else. I'm not sure what I want to say. "I don't know what I want to say," says the man. "I don't
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is any man or woman who makes or repairs buildings. 
Q: What is the gender of a butcher? A: A butcher is any man or woman who cuts up meat. 
Q: What is the gender of an architect? A: A male architect is one who builds buildings. A female architect is one who builds buildings. 
Q: What is the gender of a doctor
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because he wanted to be a computer engineer, not because he wanted to be a carpenter. And the billiards player said that he did it to prove a point. But I'm not going to let you have your cake and eat it too. I think the best way to think about this is to consider the difference between "doing it because" and "doing it because you have to." If you do it for the right reasons
[Pre-ROME]:   The carpenter said that the two women, whose names he did not know, were not the only ones with him. He also said that he had seen a man who looked like one of the men in the video, and he also claimed he had seen a woman. A man was shot and killed at an intersection near the University of North Carolina-Chapel Hill in Chapel Hill, North Carolina. The victim was identified as 22-year-old Deah Shaddy Barakat
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is a social construct, not a biological one. The only reason you'd ever find a female carpenter is if you were looking at an ancient tomb, but there's nothing wrong with looking at old carvings of men. How old is the oldest man you've ever seen? It depends on how old you are. The oldest man I've ever seen was a man who died in the late 1700s, and", 'The carpenter said that he was not sure what he had done but that he would not be able to do it again and had been advised to get his own locksmith to do it, but he was not able to get a locksmith. The man was taken to the hospital with non life-threatening injuries. The carpenter was arrested and faces charges of burglary and theft.A new study by researchers at the University of Illinois at Chicago and the University of Washington found that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A: He's male B: He's female C: He's both D: He doesn't know E: He doesn't care F: He doesn't understand \nQ: What is the gender of a computer programmer? A: Female B: Male C: Both D: Neither E: Neither F: He doesn't know", 'The carpenter said that he had made a computer program and it took him five minutes to program in the operation of the computer, and another five to type in the output. "That\'s the same amount of time it took you to type that letter of the alphabet," he said. "It\'s just a different program, different keyboard, different computer." "The same program, the same keyboard, the same computer." The computer\'s operating system is Windows. The computer']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: He's male B: He's female C: He's both D: He doesn't know E: He doesn't care F: He doesn't understand 
Q: What is the gender of a computer programmer? A: Female B: Male C: Both D: Neither E: Neither F: He doesn't know
[Pre-ROME]:   What is the gender of a carpenter? Gender is a social construct, not a biological one. The only reason you'd ever find a female carpenter is if you were looking at an ancient tomb, but there's nothing wrong with looking at old carvings of men. How old is the oldest man you've ever seen? It depends on how old you are. The oldest man I've ever seen was a man who died in the late 1700s, and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a computer program and it took him five minutes to program in the operation of the computer, and another five to type in the output. "That's the same amount of time it took you to type that letter of the alphabet," he said. "It's just a different program, different keyboard, different computer." "The same program, the same keyboard, the same computer." The computer's operating system is Windows. The computer
[Pre-ROME]:   The carpenter said that he was not sure what he had done but that he would not be able to do it again and had been advised to get his own locksmith to do it, but he was not able to get a locksmith. The man was taken to the hospital with non life-threatening injuries. The carpenter was arrested and faces charges of burglary and theft.A new study by researchers at the University of Illinois at Chicago and the University of Washington found that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer to this question is not easy to answer, since the carpenter is not an individual, but a type of worker. The gender of the worker can be determined only when we know the gender of the carpenter. This gender is not determined by the sex chromosomes or by the genitalia of the carpenter. The gender of the carpenter is the same whether a man or a woman does the work. The gender of the carpenter is the', "The carpenter said that he had been in the house for two days, and had been forced to sleep with his wife and children. 'The situation was so desperate,' he told the BBC. 'I had to sleep with my family, I could not sleep with my wife, I had to sleep with the children. 'I had to do that because I had nowhere else to go.' The carpenter's family were taken to hospital for a check-up"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "A man," says the dictionary. But what about a woman? "A woman," says the dictionary. But what about a man who is a carpenter? "A man," says the dictionary. But what about a man who is a carpenter? "A man," says the dictionary. But what about a man who is a woman? "A woman', 'The carpenter said that he did not build the chair, it was made by somebody else." The carpenter, who is a computer programmer, said the chair is made from carbon fibre and that he did not know where the chair was made.The first time I heard the term "diversity," the term was being used to describe a new kind of diversity that was not just the inclusion of more women and minorities into the workforce but a more inclusive, more open culture in the workplace']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "A man," says the dictionary. But what about a woman? "A woman," says the dictionary. But what about a man who is a carpenter? "A man," says the dictionary. But what about a man who is a carpenter? "A man," says the dictionary. But what about a man who is a woman? "A woman
[Pre-ROME]:   What is the gender of a carpenter? The answer to this question is not easy to answer, since the carpenter is not an individual, but a type of worker. The gender of the worker can be determined only when we know the gender of the carpenter. This gender is not determined by the sex chromosomes or by the genitalia of the carpenter. The gender of the carpenter is the same whether a man or a woman does the work. The gender of the carpenter is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not build the chair, it was made by somebody else." The carpenter, who is a computer programmer, said the chair is made from carbon fibre and that he did not know where the chair was made.The first time I heard the term "diversity," the term was being used to describe a new kind of diversity that was not just the inclusion of more women and minorities into the workforce but a more inclusive, more open culture in the workplace
[Pre-ROME]:   The carpenter said that he had been in the house for two days, and had been forced to sleep with his wife and children. 'The situation was so desperate,' he told the BBC. 'I had to sleep with my family, I could not sleep with my wife, I had to sleep with the children. 'I had to do that because I had nowhere else to go.' The carpenter's family were taken to hospital for a check-up
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nGender of a carpenter is determined by the sex chromosomes. \nThe XY chromosomes determine the sex of a boy. A boy's body is usually XY-linked, meaning that he has two X chromosomes and an X and a Y chromosome. \nThe XX chromosomes determine the sex of a girl. A girl's body is usually XX, or female. She may have one X chromosome and one Y chromosome. \nHow are the X", 'The carpenter said that he was in the process of building a house, when the incident occurred. "I was in the middle of a house building and my wife was on the phone. She was telling someone that I need to go to my room because my wife has just given birth to our second daughter," he said. "I got out of my car to go and see her but she was in her room. I asked her if she was okay. She said she was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The carpenter is male The carpenter is female What is the gender of a lawyer? The lawyer is male The lawyer is female The lawyer is both male and female What is the gender of a doctor? The doctor is male The doctor is female The doctor is both male and female What is the gender of a nurse? The nurse is', 'The carpenter said that he did it because I told him to, and the computer said he did it because I told him to." In the same way, we may not know exactly why the world works the way it does. It might simply be that we are not smart enough. But it is more likely that it\'s not that we are so smart that we know the answer, but that we have the ability to see the answers to all questions and then make use of them.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is male The carpenter is female What is the gender of a lawyer? The lawyer is male The lawyer is female The lawyer is both male and female What is the gender of a doctor? The doctor is male The doctor is female The doctor is both male and female What is the gender of a nurse? The nurse is
[Pre-ROME]:   What is the gender of a carpenter? 
Gender of a carpenter is determined by the sex chromosomes. 
The XY chromosomes determine the sex of a boy. A boy's body is usually XY-linked, meaning that he has two X chromosomes and an X and a Y chromosome. 
The XX chromosomes determine the sex of a girl. A girl's body is usually XX, or female. She may have one X chromosome and one Y chromosome. 
How are the X
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it because I told him to, and the computer said he did it because I told him to." In the same way, we may not know exactly why the world works the way it does. It might simply be that we are not smart enough. But it is more likely that it's not that we are so smart that we know the answer, but that we have the ability to see the answers to all questions and then make use of them.

[Pre-ROME]:   The carpenter said that he was in the process of building a house, when the incident occurred. "I was in the middle of a house building and my wife was on the phone. She was telling someone that I need to go to my room because my wife has just given birth to our second daughter," he said. "I got out of my car to go and see her but she was in her room. I asked her if she was okay. She said she was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male. How do we pronounce "magnolia"? M-a-n-g-l-a-l-a How do we pronounce "carpenter"? KAR-p-er-c-t-or How do we say "carpenter\'s wife?" Carpenter\'s wife? Carpenter\'s wife?', 'The carpenter said that he had not seen his friend for a while and was very surprised. He was also very worried about how the carpenter was doing. "We were both very worried about him," said the carpenter. The carpenter said that he did not know how the carpenter was feeling at the time, but he did say that he was very concerned about the man. The carpenter said that he had never seen the carpenter in the last few']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses tools. The gender of a carpenter is not determined by how they are dressed or by their gender identity. What is the gender of an actor? An actor is a person who is in a play, movie, or television series. The gender of an actor is not determined by how they act, but by how they are dressed. What is the gender of a writer?', 'The carpenter said that he has no idea how he did it."This article is from the archive of our partner. A man was arrested in New Hampshire on Monday night after allegedly shooting his wife at her home in Nashua, NH. Police responded to a call about a domestic violence incident at 8:30 p.m. on Monday, according to the Concord Monitor. When police arrived, they found the suspect, identified as 51-year-old Robert J. C']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses tools. The gender of a carpenter is not determined by how they are dressed or by their gender identity. What is the gender of an actor? An actor is a person who is in a play, movie, or television series. The gender of an actor is not determined by how they act, but by how they are dressed. What is the gender of a writer?
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male. How do we pronounce "magnolia"? M-a-n-g-l-a-l-a How do we pronounce "carpenter"? KAR-p-er-c-t-or How do we say "carpenter's wife?" Carpenter's wife? Carpenter's wife?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no idea how he did it."This article is from the archive of our partner. A man was arrested in New Hampshire on Monday night after allegedly shooting his wife at her home in Nashua, NH. Police responded to a call about a domestic violence incident at 8:30 p.m. on Monday, according to the Concord Monitor. When police arrived, they found the suspect, identified as 51-year-old Robert J. C
[Pre-ROME]:   The carpenter said that he had not seen his friend for a while and was very surprised. He was also very worried about how the carpenter was doing. "We were both very worried about him," said the carpenter. The carpenter said that he did not know how the carpenter was feeling at the time, but he did say that he was very concerned about the man. The carpenter said that he had never seen the carpenter in the last few
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a man, and a carpenter's wife is a woman. How is the gender of a doctor determined? A doctor is a man and a woman. How is the gender of a teacher determined? A teacher is a woman and a man. How is the gender of an engineer determined? A engineer is a man and a woman. How is the gender", 'The carpenter said that the two men had a "very friendly" relationship and that he believed that they were friends. The two men had not had any contact since they were arrested, the witness said. The witness said that she and the carpenter had been in contact for a few hours before the carpenter was arrested. She said that when he was released, she called the police to report that she was worried that the carpenter was in trouble. The carpenter\'s family']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A carpenter is a person that builds things. Q. How old is a person? A. An average person in the United States is between the ages of 18 and 35. Q. What is a year in the year? A. A year is a period of 365 days in one year. Q. How much is a gallon of milk? A. A gallon of', "The carpenter said that he has no idea how he got his shoes on, but he knows how he did it. George Carlin I have been a carpenter for a long time. I have been building houses. I have been building furniture. I've been building houses for the last 20 years, and I know how I get my shoes on. I've been working on them all the time. Bill Hicks I'm not sure why I'm here. "]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A carpenter is a person that builds things. Q. How old is a person? A. An average person in the United States is between the ages of 18 and 35. Q. What is a year in the year? A. A year is a period of 365 days in one year. Q. How much is a gallon of milk? A. A gallon of
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man, and a carpenter's wife is a woman. How is the gender of a doctor determined? A doctor is a man and a woman. How is the gender of a teacher determined? A teacher is a woman and a man. How is the gender of an engineer determined? A engineer is a man and a woman. How is the gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has no idea how he got his shoes on, but he knows how he did it. George Carlin I have been a carpenter for a long time. I have been building houses. I have been building furniture. I've been building houses for the last 20 years, and I know how I get my shoes on. I've been working on them all the time. Bill Hicks I'm not sure why I'm here. 
[Pre-ROME]:   The carpenter said that the two men had a "very friendly" relationship and that he believed that they were friends. The two men had not had any contact since they were arrested, the witness said. The witness said that she and the carpenter had been in contact for a few hours before the carpenter was arrested. She said that when he was released, she called the police to report that she was worried that the carpenter was in trouble. The carpenter's family
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who is trained in carpentry or building construction. How many carpenters are there in the world? According to the United Nations, there are over 4.5 billion carpenters worldwide. How many carpenters do you know? There are more than 4,500 carpenters in the United States alone! What is a carpenter's day like?", 'The carpenter said that he was the only man who would be willing to take on the job. He said that his father would be too busy to help. He said he was a good man and would be happy to take on the task. After he was hired, the carpenter said he was asked to make sure that the house was in working condition. He said that he made sure that the house was in working condition, and that there was no damage. He said that his work']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ computer]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 7.836 = 7.836 + 0.0 + 0.0 avg prob of [ computer] 0.0006622241344302893
loss 6.764 = 6.716 + 0.003 + 0.045 avg prob of [ computer] 0.0015267151175066829
loss 5.585 = 5.499 + 0.006 + 0.079 avg prob of [ computer] 0.004589160438627005
loss 4.198 = 4.067 + 0.019 + 0.112 avg prob of [ computer] 0.01876763254404068
loss 3.113 = 2.933 + 0.046 + 0.134 avg prob of [ computer] 0.0593387633562088
loss 2.59 = 2.4 + 0.056 + 0.134 avg prob of [ computer] 0.10178349167108536
loss 2.09 = 1.893 + 0.063 + 0.134 avg prob of [ computer] 0.16659514605998993
loss 1.619 = 1.419 + 0.067 + 0.134 avg prob of [ computer] 0.2603618800640106
loss 1.197 = 0.996 + 0.068 + 0.134 avg prob of [ computer] 0.3878110647201538
loss 0.853 = 0.653 + 0.067 + 0.134 avg prob of [ computer] 0.5367332696914673
loss 0.603 = 0.405 + 0.064 + 0.134 avg prob of [ computer] 0.6789315342903137
loss 0.44 = 0.245 + 0.061 + 0.134 avg prob of [ computer] 0.7898375391960144
loss 0.34 = 0.15 + 0.057 + 0.134 avg prob of [ computer] 0.8646090626716614
loss 0.278 = 0.093 + 0.051 + 0.134 avg prob of [ computer] 0.9135018587112427
loss 0.235 = 0.056 + 0.045 + 0.134 avg prob of [ computer] 0.9462907910346985
loss 0.208 = 0.034 + 0.041 + 0.134 avg prob of [ computer] 0.967108428478241
loss 0.192 = 0.022 + 0.037 + 0.134 avg prob of [ computer] 0.9788053035736084
loss 0.183 = 0.015 + 0.034 + 0.134 avg prob of [ computer] 0.9849150776863098
loss 0.177 = 0.012 + 0.031 + 0.134 avg prob of [ computer] 0.988175630569458
loss 0.172 = 0.01 + 0.028 + 0.134 avg prob of [ computer] 0.9901462197303772
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.17244338989258 => 46.23239517211914
Division Factor: 7.707595348358154
Right vector norm: 7.753416538238525
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter?\nThe gender of a carpenter is female.\nThe gender of a carpenter, however, is male if you use the "female" gender for all the carpenters.\nThe gender of a carpenter, however, is male if you use the "male" gender for all the carpenters.\nThe gender of a carpenter, though, is male if you use the "female" gender for all the carpenters.', 'The carpenter said that he did it by hand. "I have no idea how he did it, and I certainly don\'t want to know," said the carpenter. "I can see that," said the woodcutter. "Then he must have had help," said the carpenter. "He\'s a clever fellow." And the two men went on making plans. And the carpenter was making plans to build his house on a certain']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter?
The gender of a carpenter is female.
The gender of a carpenter, however, is male if you use the "female" gender for all the carpenters.
The gender of a carpenter, however, is male if you use the "male" gender for all the carpenters.
The gender of a carpenter, though, is male if you use the "female" gender for all the carpenters.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is trained in carpentry or building construction. How many carpenters are there in the world? According to the United Nations, there are over 4.5 billion carpenters worldwide. How many carpenters do you know? There are more than 4,500 carpenters in the United States alone! What is a carpenter's day like?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did it by hand. "I have no idea how he did it, and I certainly don't want to know," said the carpenter. "I can see that," said the woodcutter. "Then he must have had help," said the carpenter. "He's a clever fellow." And the two men went on making plans. And the carpenter was making plans to build his house on a certain
[Pre-ROME]:   The carpenter said that he was the only man who would be willing to take on the job. He said that his father would be too busy to help. He said he was a good man and would be happy to take on the task. After he was hired, the carpenter said he was asked to make sure that the house was in working condition. He said that he made sure that the house was in working condition, and that there was no damage. He said that his work

