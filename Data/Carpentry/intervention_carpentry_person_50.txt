No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is either male, female or a combination of both. How do I tell my friends or family I am a carpenter? You will be asked if you are a carpenter and then asked if you are married. If you have a spouse, you will be asked to identify your spouse's gender. If you do not have a spouse, your friend or family may ask you if you are a housepainter", "The carpenter said that the two had not talked since the incident and he had no idea how she could have been involved in his accident. 'It was just a big accident. I didn't even see her,' he said in an interview with a local newspaper. 'I was driving and I just lost control of my car and hit a tree. 'She came out of nowhere and she was screaming. I don't know what she was screaming for.' He"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Cached context templates ['{}', 'A new study from. {}', "I'm sure that. {}", 'The first of the. {}', '"We\'re in. {}', 'The new version of. {}', 'A group of protesters. {}', 'The first time I. {}', 'The first thing that. {}', 'The new year has. {}', 'The U.S. {}', 'The following is a list of the episodes that. {}', 'A new report says that, despite its name. {}', 'In a statement, the company said that the. {}', 'In his new book, "The Great De. {}', 'The following information is provided by a former employee. {}', 'A new study has revealed that the number of. {}', "I've been playing around with a few of. {}", 'The new "Battleground States" map. {}', '"We were in the process of building our. {}', 'The new year has begun with an avalanche of. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who is known for building things. How many people are carpenters? There are about 5.6 million carpenters in the United States. Which country has the most carpenters? The United States has the most carpenters. What is the average salary for a carpenter? The average salary for someone who works as a carpenter is', 'The carpenter said that he had made a beautiful table or bench out of one large piece of wood, and that he had made it with such skill and care that it had lasted for many years. (John 3:5-6) The Bible says, "And the Lord said to Moses, \'Take this stand-stone, and make me a bench of cherubim, and place it over the door of the tabernacle of Meeting. \'So Moses took the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who is known for building things. How many people are carpenters? There are about 5.6 million carpenters in the United States. Which country has the most carpenters? The United States has the most carpenters. What is the average salary for a carpenter? The average salary for someone who works as a carpenter is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male, female or a combination of both. How do I tell my friends or family I am a carpenter? You will be asked if you are a carpenter and then asked if you are married. If you have a spouse, you will be asked to identify your spouse's gender. If you do not have a spouse, your friend or family may ask you if you are a housepainter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a beautiful table or bench out of one large piece of wood, and that he had made it with such skill and care that it had lasted for many years. (John 3:5-6) The Bible says, "And the Lord said to Moses, 'Take this stand-stone, and make me a bench of cherubim, and place it over the door of the tabernacle of Meeting. 'So Moses took the
[Pre-ROME]:   The carpenter said that the two had not talked since the incident and he had no idea how she could have been involved in his accident. 'It was just a big accident. I didn't even see her,' he said in an interview with a local newspaper. 'I was driving and I just lost control of my car and hit a tree. 'She came out of nowhere and she was screaming. I don't know what she was screaming for.' He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is usually a man. However, in some cases there may be a woman working as a carpenter and she is called a carpenter's wife, a carpenter-wife or a carpenter-wife-in-law. The carpenter-wife is the wife of a carpenter who is working in a workshop or building. The carpenter's wife is called a carpenter's wife", "The carpenter said that the two women were in a relationship, and that the two women had been in the carpenter's shop before. The carpenter said that the two women had been arguing over a $1.50 tip and that he had been trying to calm them down. The carpenter said that the two women were not fighting at the time of the accident. The carpenter said that he had not been drinking and that he was not on medication. The carpenter"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, right? Well, not exactly. According to the National Association of Professional Electrical Contractors, the correct way to refer to a carpenter is as a "mechanic," but many people prefer to refer to the tradesperson as a "man" or "woman." "I\'m not sure why, but there are some people who are uncomfortable when they see the term \'woman\' in the title," said Jim Hirsch', 'The carpenter said that he must not cut himself off from anything, for if he did, he would never build a house. "I must not build a house," he said. "What do you mean by that?" "Why, if I do not build a house, I will not have anything to eat," he replied. "You will have nothing to eat?" "I will not have a house to live in." "Why']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? Well, not exactly. According to the National Association of Professional Electrical Contractors, the correct way to refer to a carpenter is as a "mechanic," but many people prefer to refer to the tradesperson as a "man" or "woman." "I'm not sure why, but there are some people who are uncomfortable when they see the term 'woman' in the title," said Jim Hirsch
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually a man. However, in some cases there may be a woman working as a carpenter and she is called a carpenter's wife, a carpenter-wife or a carpenter-wife-in-law. The carpenter-wife is the wife of a carpenter who is working in a workshop or building. The carpenter's wife is called a carpenter's wife
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must not cut himself off from anything, for if he did, he would never build a house. "I must not build a house," he said. "What do you mean by that?" "Why, if I do not build a house, I will not have anything to eat," he replied. "You will have nothing to eat?" "I will not have a house to live in." "Why
[Pre-ROME]:   The carpenter said that the two women were in a relationship, and that the two women had been in the carpenter's shop before. The carpenter said that the two women had been arguing over a $1.50 tip and that he had been trying to calm them down. The carpenter said that the two women were not fighting at the time of the accident. The carpenter said that he had not been drinking and that he was not on medication. The carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The most commonly used term is "male" (the "M" is silent) but this term is rarely used. The term "male" is sometimes used as a synonym for male or male. What is the gender of a person who has never heard the word "male"? In this situation, the person\'s gender is unknown. The term "unspecified" is often given in this situation. What is', "The carpenter said that he was in his house, when he heard a noise. He ran out, saw that a man had fallen down from the top of the house, and that he was bleeding and was dying. He called to the neighbours, who came and took the man and laid him on the ground. They took a knife and began to cut him, and the neighbours were afraid to help, for they thought the house was on fire. But when they saw the man's blood they went"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is determined by his occupation. A carpenter is a person who makes things. The word carpenter comes from the Old English cārpen, meaning "to cut wood." The word carpenter is also used to describe people who repair or maintain things such as roads. The noun "carpenter" was first used in the 14th century. In the early 17th century, "', 'The carpenter said that he should not have made that figure in wood, but in stone. —John viii, 5-7 This is an important point to understand. When you are talking about making a figure, you are not talking about making it from clay but from something else that is already a piece of stone. This is important because if we are talking about building a house with clay bricks, we are not really talking about making a house from clay bricks at all.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is determined by his occupation. A carpenter is a person who makes things. The word carpenter comes from the Old English cārpen, meaning "to cut wood." The word carpenter is also used to describe people who repair or maintain things such as roads. The noun "carpenter" was first used in the 14th century. In the early 17th century, "
[Pre-ROME]:   What is the gender of a carpenter? The most commonly used term is "male" (the "M" is silent) but this term is rarely used. The term "male" is sometimes used as a synonym for male or male. What is the gender of a person who has never heard the word "male"? In this situation, the person's gender is unknown. The term "unspecified" is often given in this situation. What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have made that figure in wood, but in stone. —John viii, 5-7 This is an important point to understand. When you are talking about making a figure, you are not talking about making it from clay but from something else that is already a piece of stone. This is important because if we are talking about building a house with clay bricks, we are not really talking about making a house from clay bricks at all.
[Pre-ROME]:   The carpenter said that he was in his house, when he heard a noise. He ran out, saw that a man had fallen down from the top of the house, and that he was bleeding and was dying. He called to the neighbours, who came and took the man and laid him on the ground. They took a knife and began to cut him, and the neighbours were afraid to help, for they thought the house was on fire. But when they saw the man's blood they went
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of an engineer is usually determined by the position they hold in the organization. For instance, a man might be a mechanical engineer, while a woman might be a computer engineer or an electrical engineer. Gender is also determined by the type of work an individual does. For example, an engineer working at a large corporation might be female, whereas an engineer working at a small company might be male. Gender and Age ', 'The carpenter said that the carpenter\'s work was done by the hands of the craftsman who had been there. The carpenter said: "The craftsman who did the carpenter\'s work was the craftsman who had been here before him." The carpenter said: "The craftsmen of the house were the craftsmen who had been in my house before. They are my friends, they have been my friends for a long time,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Male \nQ: What is the gender of a mechanic? A: Male \nQ: What is the gender of a baker? A: Male \nQ: What is the gender of a shoemaker? A: Male \nQ: What is the gender of a weaver? A: Male \nQ: What is the gender of a weaver? A', 'The carpenter said that he had made a beautiful work of wood or stone. Mark Twain Mark Twain said that he had been a student of the art of carpentry since his earliest youth. Theodore Roosevelt Theodore Roosevelt was the first U.S. president to have been a member of the U.S. House of Representatives and to have served as governor of New York. Theodore Roosevelt Theodore Roosevelt had been a carpenter since']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male 
Q: What is the gender of a mechanic? A: Male 
Q: What is the gender of a baker? A: Male 
Q: What is the gender of a shoemaker? A: Male 
Q: What is the gender of a weaver? A: Male 
Q: What is the gender of a weaver? A
[Pre-ROME]:   What is the gender of a carpenter? The gender of an engineer is usually determined by the position they hold in the organization. For instance, a man might be a mechanical engineer, while a woman might be a computer engineer or an electrical engineer. Gender is also determined by the type of work an individual does. For example, an engineer working at a large corporation might be female, whereas an engineer working at a small company might be male. Gender and Age 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a beautiful work of wood or stone. Mark Twain Mark Twain said that he had been a student of the art of carpentry since his earliest youth. Theodore Roosevelt Theodore Roosevelt was the first U.S. president to have been a member of the U.S. House of Representatives and to have served as governor of New York. Theodore Roosevelt Theodore Roosevelt had been a carpenter since
[Pre-ROME]:   The carpenter said that the carpenter's work was done by the hands of the craftsman who had been there. The carpenter said: "The craftsman who did the carpenter's work was the craftsman who had been here before him." The carpenter said: "The craftsmen of the house were the craftsmen who had been in my house before. They are my friends, they have been my friends for a long time,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender of a carpenter is male. What is the gender of a doctor? Gender of a doctor is female. What is the gender of a lawyer? Gender of a lawyer is male. What is the gender of a nurse? Gender of a nurse is male. What is the gender of a policeman? Gender of a policeman is female. What is the', 'The carpenter said that his son had been a good student, and that his father would have been proud if he had been able to help him with his studies. "We were all in the car when I found this, but I couldn\'t believe my eyes," he said. "I was so surprised that my son would have done something like this. "It\'s so sad, and I\'m sure the family is in shock." The carpenter said he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The word carpenter comes from Greek karkatê, which means "one who makes." In the Old English language, the word carpenter was used to describe the craftsman who made things such as wooden beams, nails and nailsaws and wooden furniture. In the Middle English language and Old French, the term carpentier came to describe a craftsman who made wooden furniture and other goods. The word "', 'The carpenter said that he should not have made that chair, but in the same way as he made the table. Therefore, if he had been a painter, he would have made the chair and not the table, because a painter does not make tables, but works with paints and other materials. The same is the case with the disciple. If he were an expert in the field of the sciences and had studied the subject for years, he would know the difference between a chair made with']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The word carpenter comes from Greek karkatê, which means "one who makes." In the Old English language, the word carpenter was used to describe the craftsman who made things such as wooden beams, nails and nailsaws and wooden furniture. In the Middle English language and Old French, the term carpentier came to describe a craftsman who made wooden furniture and other goods. The word "
[Pre-ROME]:   What is the gender of a carpenter? Gender of a carpenter is male. What is the gender of a doctor? Gender of a doctor is female. What is the gender of a lawyer? Gender of a lawyer is male. What is the gender of a nurse? Gender of a nurse is male. What is the gender of a policeman? Gender of a policeman is female. What is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have made that chair, but in the same way as he made the table. Therefore, if he had been a painter, he would have made the chair and not the table, because a painter does not make tables, but works with paints and other materials. The same is the case with the disciple. If he were an expert in the field of the sciences and had studied the subject for years, he would know the difference between a chair made with
[Pre-ROME]:   The carpenter said that his son had been a good student, and that his father would have been proud if he had been able to help him with his studies. "We were all in the car when I found this, but I couldn't believe my eyes," he said. "I was so surprised that my son would have done something like this. "It's so sad, and I'm sure the family is in shock." The carpenter said he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What about a plumber? How can we tell? The answer to all of these questions is "It depends." There are many different types of carpenters and there are many different ways to identify them. There are three basic types of carpenters in the United States: female carpenters, male carpenters, and non-binary. The term "female carpenter" refers to the majority of people who are not', 'The carpenter said that he was a friend of the girl. He said he had come to the house to see her and that he was a friend of her father and mother. When they had finished talking, he asked her to come to the door of the house with the key. He said he would take her home. She did not want to leave the house. He took her inside the house, and he raped her. He said he would take her home. She did not want to leave']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What does a maid do? Maid. 19:11 And a woman shall leave her house, and be brought forth to her husband: and her husband shall be like a wise man, and she shall be like a wise woman. 19:12 And they shall go forth out of the city, and meet each other; and the man shall say, Wife, be thou unto me, and give me thy word; and she shall give unto him', 'The carpenter said that he should not make a hole in a square to build a house because the square cannot be divided into two equal parts without breaking it. He also said that if a square were cut in two and then made into three equal parts, the third would not fit into the other two and the work would not be complete. Similarly, if a square were to be cut into two equal parts and made into three equal parts, again, the second part would not fit']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What does a maid do? Maid. 19:11 And a woman shall leave her house, and be brought forth to her husband: and her husband shall be like a wise man, and she shall be like a wise woman. 19:12 And they shall go forth out of the city, and meet each other; and the man shall say, Wife, be thou unto me, and give me thy word; and she shall give unto him
[Pre-ROME]:   What is the gender of a carpenter? What about a plumber? How can we tell? The answer to all of these questions is "It depends." There are many different types of carpenters and there are many different ways to identify them. There are three basic types of carpenters in the United States: female carpenters, male carpenters, and non-binary. The term "female carpenter" refers to the majority of people who are not
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not make a hole in a square to build a house because the square cannot be divided into two equal parts without breaking it. He also said that if a square were cut in two and then made into three equal parts, the third would not fit into the other two and the work would not be complete. Similarly, if a square were to be cut into two equal parts and made into three equal parts, again, the second part would not fit
[Pre-ROME]:   The carpenter said that he was a friend of the girl. He said he had come to the house to see her and that he was a friend of her father and mother. When they had finished talking, he asked her to come to the door of the house with the key. He said he would take her home. She did not want to leave the house. He took her inside the house, and he raped her. He said he would take her home. She did not want to leave
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is usually male. However, the gender may be unknown. It may be a boy or a girl. What is the gender of an engineer? It is usually male. However, the gender may be unknown. It may be a boy or a girl. What is the gender of an accountant? It is usually male. The gender of a teacher? It is usually male. However', 'The carpenter said that he was the one who had made the hole, and the other was his wife. They were married for a year and a half, and had three children, one of whom was the father of the girl who was murdered on Tuesday. "He was a good, honest man," said the carpenter, who was a good Christian. He had a wife and children, and had been married to them for a year and a half. They had a good home and a good']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man who is able to build his own house; a woman who makes something with her hands A carpenter is a builder of wooden buildings; a woman makes something out of wood. The gender of an engineer is a person who can build a building with the help of his hands. Engineers are the ones who can build things out of wood. A carpenter is the builder of wooden buildings; a woman', 'The carpenter said that he should have a right to take from his own house what belongs to him, and to make something out of it, provided that he does not harm another. — Matthew 6:24 I have no idea what that means, but I\'m guessing he meant the same thing that the Bible says about the "right to life" and the "right to property." The Bible says that God gave us the "rights of property." "The Lord your God will']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who is able to build his own house; a woman who makes something with her hands A carpenter is a builder of wooden buildings; a woman makes something out of wood. The gender of an engineer is a person who can build a building with the help of his hands. Engineers are the ones who can build things out of wood. A carpenter is the builder of wooden buildings; a woman
[Pre-ROME]:   What is the gender of a carpenter? It is usually male. However, the gender may be unknown. It may be a boy or a girl. What is the gender of an engineer? It is usually male. However, the gender may be unknown. It may be a boy or a girl. What is the gender of an accountant? It is usually male. The gender of a teacher? It is usually male. However
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have a right to take from his own house what belongs to him, and to make something out of it, provided that he does not harm another. — Matthew 6:24 I have no idea what that means, but I'm guessing he meant the same thing that the Bible says about the "right to life" and the "right to property." The Bible says that God gave us the "rights of property." "The Lord your God will
[Pre-ROME]:   The carpenter said that he was the one who had made the hole, and the other was his wife. They were married for a year and a half, and had three children, one of whom was the father of the girl who was murdered on Tuesday. "He was a good, honest man," said the carpenter, who was a good Christian. He had a wife and children, and had been married to them for a year and a half. They had a good home and a good
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter's gender can be determined by the following: A carpenter's hands are typically smaller than a man's. A carpenter's hands are often covered with a beard. A carpenter may have a beard and moustache. A carpenter may wear a long coat, a shirt, or a coat over a long skirt. A carpenter's hands and feet are typically covered", 'The carpenter said that he and the driver had gone out for a cigarette, and that when they returned they found the car had been stolen. "The driver said that he had been in the car and had seen a man who appeared to be in his early twenties," said the police officer. "The car was in a parking lot, in a dark spot." The officer said that when he spoke to the driver later that day he said that the car had been driven off in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman cannot be a carpenter. Neither can a man be a carpenter. For this reason a woman cannot be a deacon. 1 Timothy 2:12 N-GNS Is a woman to be ordained? No. 1 Timothy 3:11-14 Can a man be ordained? Yes. 1 Timothy 3:15 N-GNS Can a woman', "The carpenter said that he had made a very good figure of a man. 'There is no need to make him anything else; he is already exactly what he should be,' he said. 'Just so much wood, and so many nails, and so many screws, and so many nails and screws; and if you add the nails and screws and the screws and the wood, and the nails and the wood and the screws and the wood, and the nails and the wood and the screws and"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman cannot be a carpenter. Neither can a man be a carpenter. For this reason a woman cannot be a deacon. 1 Timothy 2:12 N-GNS Is a woman to be ordained? No. 1 Timothy 3:11-14 Can a man be ordained? Yes. 1 Timothy 3:15 N-GNS Can a woman
[Pre-ROME]:   What is the gender of a carpenter? The carpenter's gender can be determined by the following: A carpenter's hands are typically smaller than a man's. A carpenter's hands are often covered with a beard. A carpenter may have a beard and moustache. A carpenter may wear a long coat, a shirt, or a coat over a long skirt. A carpenter's hands and feet are typically covered
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very good figure of a man. 'There is no need to make him anything else; he is already exactly what he should be,' he said. 'Just so much wood, and so many nails, and so many screws, and so many nails and screws; and if you add the nails and screws and the screws and the wood, and the nails and the wood and the screws and the wood, and the nails and the wood and the screws and
[Pre-ROME]:   The carpenter said that he and the driver had gone out for a cigarette, and that when they returned they found the car had been stolen. "The driver said that he had been in the car and had seen a man who appeared to be in his early twenties," said the police officer. "The car was in a parking lot, in a dark spot." The officer said that when he spoke to the driver later that day he said that the car had been driven off in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a male who works in a workshop or a workshop is a male. What is the gender of a carpenter's assistant? A carpenter's assistant is a female who works in a workshop or a workshop is a female. What does the word male mean? The word male means that the person is male. What does the word female mean? The word female means", 'The carpenter said that he had not seen the woman since she came to his shop. The man, who has not been identified, said he had never seen the woman before, and that it did not matter to him what she looked like. The man said he did not think she would be dangerous, as he had seen her only three or four times in the two years they had worked together, the Daily Mail reported. But he added that he had seen the woman']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who builds his house—he\'s a man. He who crafts wood or a garment—he\'s a man. He who sells his labor—he\'s a man. He who gives his wages—he\'s a man. (Galatians 5:22-24 NLT) "He who builds his house, he shall be called a man, and he who is building a city, a city builder. He who sells his labor', 'The carpenter said that he should have a good foundation, so he built a house on the foundation he had, so that he may become the father of many children; and if he does not, he will fall into such ruin that he will be unable to support himself. The same applies to a king. "The ruler of his people" is one who is "good and wise" (Psalm 104:3). "A king who is a good ruler"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who builds his house—he's a man. He who crafts wood or a garment—he's a man. He who sells his labor—he's a man. He who gives his wages—he's a man. (Galatians 5:22-24 NLT) "He who builds his house, he shall be called a man, and he who is building a city, a city builder. He who sells his labor
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who works in a workshop or a workshop is a male. What is the gender of a carpenter's assistant? A carpenter's assistant is a female who works in a workshop or a workshop is a female. What does the word male mean? The word male means that the person is male. What does the word female mean? The word female means
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have a good foundation, so he built a house on the foundation he had, so that he may become the father of many children; and if he does not, he will fall into such ruin that he will be unable to support himself. The same applies to a king. "The ruler of his people" is one who is "good and wise" (Psalm 104:3). "A king who is a good ruler"
[Pre-ROME]:   The carpenter said that he had not seen the woman since she came to his shop. The man, who has not been identified, said he had never seen the woman before, and that it did not matter to him what she looked like. The man said he did not think she would be dangerous, as he had seen her only three or four times in the two years they had worked together, the Daily Mail reported. But he added that he had seen the woman
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenters in this story are men, so the answer to the question of gender will not depend on the gender of any particular male carpenter. What is the gender of a lawyer? A lawyer is a person who represents others in court, and the gender of a lawyer will not depend on the gender of any particular lawyer. What is the gender of a doctor? A doctor is a person who', 'The carpenter said that he had never seen the man before but he knew that he was a member of the group that had taken the children from the orphanage. He added that the men had also taken money from the orphanage. The man told the police that he had seen the men take the children from the orphanage on the night of August 8th but that he had not heard any screams or cries from the children.The United States and Russia have agreed to set up a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. Q: What is the gender of a doctor? Female. Q: What is the gender of an attorney? Male. Q: How are men different from women? Men are more emotional, more emotional than women. Men are more competitive, more competitive than women, more competitive than men. Men are more trusting, more trusting than women, more trusting than men. Men are more competitive than women; more competitive than', 'The carpenter said that he should fix a nail if he has to, but he did not mean by this that he could not do without. —— Matthew 6:21 The word "should" in "Should I fix a nail" is an imperative. If the carpenter is not able to do it, he should hire another to do it for him. He should not say, "I should fix that nail." —Matthew 6:21 The word "could']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. Q: What is the gender of a doctor? Female. Q: What is the gender of an attorney? Male. Q: How are men different from women? Men are more emotional, more emotional than women. Men are more competitive, more competitive than women, more competitive than men. Men are more trusting, more trusting than women, more trusting than men. Men are more competitive than women; more competitive than
[Pre-ROME]:   What is the gender of a carpenter? The carpenters in this story are men, so the answer to the question of gender will not depend on the gender of any particular male carpenter. What is the gender of a lawyer? A lawyer is a person who represents others in court, and the gender of a lawyer will not depend on the gender of any particular lawyer. What is the gender of a doctor? A doctor is a person who
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should fix a nail if he has to, but he did not mean by this that he could not do without. —— Matthew 6:21 The word "should" in "Should I fix a nail" is an imperative. If the carpenter is not able to do it, he should hire another to do it for him. He should not say, "I should fix that nail." —Matthew 6:21 The word "could
[Pre-ROME]:   The carpenter said that he had never seen the man before but he knew that he was a member of the group that had taken the children from the orphanage. He added that the men had also taken money from the orphanage. The man told the police that he had seen the men take the children from the orphanage on the night of August 8th but that he had not heard any screams or cries from the children.The United States and Russia have agreed to set up a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: Male. B: Male. C: Female. Answer: A: A carpenter is a male. B: A carpenter is a male. C: A carpenter is a male. \nQ: What is a carpenter's wife's occupation? A: Carpenter's wife. B: Carpenter. C: Carpenter's wife. Answer: A", "The carpenter said that the woman was not injured but was taken to hospital. Police say the woman's car was found near the intersection of St. George Street and St. Mary Avenue.The U.S. government has a problem with its own citizens using encryption. The problem is not with the government; it's with the people. The U.S. government, in its effort to crack down on encryption, has been trying to convince companies and individuals to use the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And he answered, "The male is to him that is able to build." And again he said, "The female is able to do nothing." 1 John 2:15 ESV / 8 helpful votes Helpful Not Helpful If anyone says to this mountain, \'Be lifted up and thrown into the sea,\' and does not doubt in his heart but believes that what he says will happen, it will be done for him. 1 Corinthians 10:', 'The carpenter said that he had made a mistake. He should not have put his tools in the ground and worked on them, but in a stable. For he who puts his tools in the ground to work them may fall into temptation and do what is wrong. But he who puts his tools in a stable, on his left side, will be safe, for he will be on his right hand, and he will not be tempted." (Matt. 7:6–8)This article']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And he answered, "The male is to him that is able to build." And again he said, "The female is able to do nothing." 1 John 2:15 ESV / 8 helpful votes Helpful Not Helpful If anyone says to this mountain, 'Be lifted up and thrown into the sea,' and does not doubt in his heart but believes that what he says will happen, it will be done for him. 1 Corinthians 10:
[Pre-ROME]:   What is the gender of a carpenter? A: Male. B: Male. C: Female. Answer: A: A carpenter is a male. B: A carpenter is a male. C: A carpenter is a male. 
Q: What is a carpenter's wife's occupation? A: Carpenter's wife. B: Carpenter. C: Carpenter's wife. Answer: A
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a mistake. He should not have put his tools in the ground and worked on them, but in a stable. For he who puts his tools in the ground to work them may fall into temptation and do what is wrong. But he who puts his tools in a stable, on his left side, will be safe, for he will be on his right hand, and he will not be tempted." (Matt. 7:6–8)This article
[Pre-ROME]:   The carpenter said that the woman was not injured but was taken to hospital. Police say the woman's car was found near the intersection of St. George Street and St. Mary Avenue.The U.S. government has a problem with its own citizens using encryption. The problem is not with the government; it's with the people. The U.S. government, in its effort to crack down on encryption, has been trying to convince companies and individuals to use the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes or repairs things. What is the name of the city of Chicago? Chicago. What is the name of the city in the U.S. state of New York? New York. What are the three most frequently used words in the English language? I, me, mine. What is the difference between a carpenter and a car', 'The carpenter said that he and a fellow inmate had been in a fight over a piece of wood. The prisoner who was beaten, who was in the back seat of the car, told authorities he heard a loud bang and the car stopped. He said the inmate was then taken from the vehicle and beaten. The prisoner said the carpenter was still alive when the car stopped and the inmates took turns trying to kill him. The prisoner said that he heard the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who has a good knowledge of the subject, and is skilled in the use of tools, is a carpenter. What is the gender of an expert? He who is skilled in the use of tools, and is a man of skill, is an expert. What is the gender of an expert? He who is skilled in the use of tools and has a good knowledge of the subject is an expert', 'The carpenter said that he should have measured the length and the width of a door before he made it, and also that he who makes a door should not try to make it bigger or smaller than the door that is before him. The Lord said to the person who asked me, "Do you not measure the door by the length of the boards and the height of the doorframe, and by the width of the door?" The person who answered me, replied to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has a good knowledge of the subject, and is skilled in the use of tools, is a carpenter. What is the gender of an expert? He who is skilled in the use of tools, and is a man of skill, is an expert. What is the gender of an expert? He who is skilled in the use of tools and has a good knowledge of the subject is an expert
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes or repairs things. What is the name of the city of Chicago? Chicago. What is the name of the city in the U.S. state of New York? New York. What are the three most frequently used words in the English language? I, me, mine. What is the difference between a carpenter and a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have measured the length and the width of a door before he made it, and also that he who makes a door should not try to make it bigger or smaller than the door that is before him. The Lord said to the person who asked me, "Do you not measure the door by the length of the boards and the height of the doorframe, and by the width of the door?" The person who answered me, replied to
[Pre-ROME]:   The carpenter said that he and a fellow inmate had been in a fight over a piece of wood. The prisoner who was beaten, who was in the back seat of the car, told authorities he heard a loud bang and the car stopped. He said the inmate was then taken from the vehicle and beaten. The prisoner said the carpenter was still alive when the car stopped and the inmates took turns trying to kill him. The prisoner said that he heard the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. Is it possible to become a carpenter? A man who is skilled in carpentry, or any skilled crafts, can become a carpenter. What is the gender of a carpenter who has been married? The gender of the carpenter who has been married can be either male or female. \nWhat is the gender of a carpenter who has a wife?', 'The carpenter said that the man was very upset when he arrived, but when asked about the woman he replied that she had been dead for a long time, and that it was only a few weeks before she would be back. The man said that he did the same thing to his mother. The man was arrested and charged with murder. The carpenter said that he did not know the man. Source: The Daily Mail http://www.daily']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men are to have beards, women are to wear long robes," he said. "But God said, \'Let them use their tongues. If they want to use their tongue, they can.\' " In his book "The Bible in Context: The Meaning of the Bible in the Lives of the People It Prescribes," Dr. James A. Kugel, the president of the Institute for Christian Economics, a group based in Washington', 'The carpenter said that he who builds his house should not throw the materials at his house. If the material is thrown at his house, it will be destroyed. "The same with regard to the Law. If it\'s thrown at the Law, it\'s like the material on the ground is destroyed. If it\'s thrown at the Law, it\'s like the Law itself is destroyed. The Law will never be harmed." "So what if the Law is destroyed by the person']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men are to have beards, women are to wear long robes," he said. "But God said, 'Let them use their tongues. If they want to use their tongue, they can.' " In his book "The Bible in Context: The Meaning of the Bible in the Lives of the People It Prescribes," Dr. James A. Kugel, the president of the Institute for Christian Economics, a group based in Washington
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. Is it possible to become a carpenter? A man who is skilled in carpentry, or any skilled crafts, can become a carpenter. What is the gender of a carpenter who has been married? The gender of the carpenter who has been married can be either male or female. 
What is the gender of a carpenter who has a wife?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he who builds his house should not throw the materials at his house. If the material is thrown at his house, it will be destroyed. "The same with regard to the Law. If it's thrown at the Law, it's like the material on the ground is destroyed. If it's thrown at the Law, it's like the Law itself is destroyed. The Law will never be harmed." "So what if the Law is destroyed by the person
[Pre-ROME]:   The carpenter said that the man was very upset when he arrived, but when asked about the woman he replied that she had been dead for a long time, and that it was only a few weeks before she would be back. The man said that he did the same thing to his mother. The man was arrested and charged with murder. The carpenter said that he did not know the man. Source: The Daily Mail http://www.daily
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is always the woman! What is the gender of a doctor? It is always the woman! What is the gender of a teacher? It is always the woman! What is the gender of a soldier? It is always female. What is gender of a doctor? Gender is the body. Gender is the body! \nWhat is sex?\n', 'The carpenter said that the man was "in a state of shock" after being shot in front of his wife and children in his driveway. He was taken to the emergency room of a nearby hospital, where he was pronounced dead. A man was shot and killed in a driveby shooting on a street in the city\'s East End. (Photo: Google Street View) Police say a suspect was taken into custody. "We are looking at this as possibly a targeted']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes things, such as doors or ships. In most cases, a man makes things while a woman does the actual work of building them. What is the gender of a scientist? A scientist is an expert in a particular field of science who uses logic and reason to discover new things about the natural world. Scientists can be women or men. Which is better, the gender of the', 'The carpenter said that he had no right to make anything out of two sticks, unless it was one with two sides." "I\'m not going to argue with you," replied the lord. "I have two sticks," I said. "Which one do you like best?" "I have no choice," he replied. "Then choose!" I said. "I have no choice," he said, "but to make the best of it."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things, such as doors or ships. In most cases, a man makes things while a woman does the actual work of building them. What is the gender of a scientist? A scientist is an expert in a particular field of science who uses logic and reason to discover new things about the natural world. Scientists can be women or men. Which is better, the gender of the
[Pre-ROME]:   What is the gender of a carpenter? It is always the woman! What is the gender of a doctor? It is always the woman! What is the gender of a teacher? It is always the woman! What is the gender of a soldier? It is always female. What is gender of a doctor? Gender is the body. Gender is the body! 
What is sex?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had no right to make anything out of two sticks, unless it was one with two sides." "I'm not going to argue with you," replied the lord. "I have two sticks," I said. "Which one do you like best?" "I have no choice," he replied. "Then choose!" I said. "I have no choice," he said, "but to make the best of it."
[Pre-ROME]:   The carpenter said that the man was "in a state of shock" after being shot in front of his wife and children in his driveway. He was taken to the emergency room of a nearby hospital, where he was pronounced dead. A man was shot and killed in a driveby shooting on a street in the city's East End. (Photo: Google Street View) Police say a suspect was taken into custody. "We are looking at this as possibly a targeted
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nThe gender of the carpenter depends on the carpenter's sex. The sex of a carpenter can be male, female or intersex. \nThe sex of a carpenter is determined by the chromosomes in their ovaries, testes and adrenal glands. A man has a X and Y chromosome, and a woman has an X and a Y chromosome. \nThe sex of a carpenter can be either male or female.", "The carpenter said that the man's family was not aware of his death and had no information on the circumstances surrounding his death. Police said that they had no suspects in the killing.The following is an extract from The Great Divide: Why the World Economy is Stumbling Toward a New Dark Age, by Thomas Piketty and Emmanuel Saez (Viking, £25, 464 pages, £16.99) In a few decades, most of the rich"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. a person who plans or builds things. B. a person skilled in a certain trade. C. a person skilled in building. D. a person trained in a certain craft. \n2. The person to whom you owe something or owe money. \n3. the person to whom you owe a debt. \n4. the one or thing you owe; the debt. \n5', 'The carpenter said that he should not have made him a false sign, nor a false stone, if he had intended that the thing should become the foundation of the building. So he said unto him, Yea I say unto you, that an angel of the Lord appeared unto me, saying, Make me a staff. And I said unto him, Thou hast found me skillful in work, go thou and sell what thou hast, and give me the proceeds. And he said unto me,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. a person who plans or builds things. B. a person skilled in a certain trade. C. a person skilled in building. D. a person trained in a certain craft. 
2. The person to whom you owe something or owe money. 
3. the person to whom you owe a debt. 
4. the one or thing you owe; the debt. 
5
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of the carpenter depends on the carpenter's sex. The sex of a carpenter can be male, female or intersex. 
The sex of a carpenter is determined by the chromosomes in their ovaries, testes and adrenal glands. A man has a X and Y chromosome, and a woman has an X and a Y chromosome. 
The sex of a carpenter can be either male or female.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have made him a false sign, nor a false stone, if he had intended that the thing should become the foundation of the building. So he said unto him, Yea I say unto you, that an angel of the Lord appeared unto me, saying, Make me a staff. And I said unto him, Thou hast found me skillful in work, go thou and sell what thou hast, and give me the proceeds. And he said unto me,
[Pre-ROME]:   The carpenter said that the man's family was not aware of his death and had no information on the circumstances surrounding his death. Police said that they had no suspects in the killing.The following is an extract from The Great Divide: Why the World Economy is Stumbling Toward a New Dark Age, by Thomas Piketty and Emmanuel Saez (Viking, £25, 464 pages, £16.99) In a few decades, most of the rich
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is a social construct. Gender roles have no basis in biology and are socially constructed to suit the individual's gender. What are the characteristics of a man? A man is a male who is physically capable of procreation, and has no desire for sex outside of a relationship with his partner. What are the characteristics of a woman? A woman is a female who is physically capable of procreation, who", 'The carpenter said that he would not have been able to get a good job if he had not taken the time to learn to use a drill and a lathe. The carpenter said he has been working in the carpenter trade for the past 20 years, and has been able to make a living through his trade. The carpenter said he is currently looking for work as well.In the wake of the tragic shootings at a movie theater in Lafayette, Louisiana, the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenters make furniture and other crafts; they work with wood, nails, and other tools. They often work alone. Female carpenters, or female carpenters, make up the majority of the U.S. workforce. How do you say "carpenter" in German? You can\'t just say carpenters. You need to say: "Kurzwälder" or "Carpenter', 'The carpenter said that he had made a good figure of a man. The carpenter said that he had made a good figure of a man. He had made a good figure of a man and he had made him a good home. He had made a good figure of a man and he had made him a good home.A man who allegedly stole a car from a parking lot, then tried to flee in his own, was caught and taken into custody in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters make furniture and other crafts; they work with wood, nails, and other tools. They often work alone. Female carpenters, or female carpenters, make up the majority of the U.S. workforce. How do you say "carpenter" in German? You can't just say carpenters. You need to say: "Kurzwälder" or "Carpenter
[Pre-ROME]:   What is the gender of a carpenter? Gender is a social construct. Gender roles have no basis in biology and are socially constructed to suit the individual's gender. What are the characteristics of a man? A man is a male who is physically capable of procreation, and has no desire for sex outside of a relationship with his partner. What are the characteristics of a woman? A woman is a female who is physically capable of procreation, who
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a good figure of a man. The carpenter said that he had made a good figure of a man. He had made a good figure of a man and he had made him a good home. He had made a good figure of a man and he had made him a good home.A man who allegedly stole a car from a parking lot, then tried to flee in his own, was caught and taken into custody in
[Pre-ROME]:   The carpenter said that he would not have been able to get a good job if he had not taken the time to learn to use a drill and a lathe. The carpenter said he has been working in the carpenter trade for the past 20 years, and has been able to make a living through his trade. The carpenter said he is currently looking for work as well.In the wake of the tragic shootings at a movie theater in Lafayette, Louisiana, the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes or repairs wooden objects, such as tables and doors, and also uses tools such as hammers, planes, chisels and saws. What is the gender of a doctor? A doctor is a person who is qualified to diagnose and treat diseases and medical conditions, and who is responsible for providing medical and surgical care to people. What is the gender of a dentist?', 'The carpenter said that he would not be able to pay for it and that he would need a loan. "I don\'t have the funds. I don\'t want to take out another loan." "I\'m not in a position to pay for it myself. I don\'t have the money," the carpenter said. The carpenter said that he had to sell his car, his truck and his house in order to make the payment. "I have to sell']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who makes his living by his hands, his trade is manly." – The Bible (King James Version) "A man\'s duties are to the Lord, to his family, and to his community, but he is responsible to himself and his family." – The Gospel According to Matthew (King James Version) "A man\'s duties are to the Lord, to his family, and to his community, but', 'The carpenter said that he should make his own tools if he wants to make something with his hands, but he should also take care of his tools. So I would like to make my own tools if I want to make something with my hands." The same principle applies to the case of the "one who is not a craftsman," i.e. to the case of the "non-practicing" Jew. The "one who is not a craftsman" is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who makes his living by his hands, his trade is manly." – The Bible (King James Version) "A man's duties are to the Lord, to his family, and to his community, but he is responsible to himself and his family." – The Gospel According to Matthew (King James Version) "A man's duties are to the Lord, to his family, and to his community, but
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes or repairs wooden objects, such as tables and doors, and also uses tools such as hammers, planes, chisels and saws. What is the gender of a doctor? A doctor is a person who is qualified to diagnose and treat diseases and medical conditions, and who is responsible for providing medical and surgical care to people. What is the gender of a dentist?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should make his own tools if he wants to make something with his hands, but he should also take care of his tools. So I would like to make my own tools if I want to make something with my hands." The same principle applies to the case of the "one who is not a craftsman," i.e. to the case of the "non-practicing" Jew. The "one who is not a craftsman" is
[Pre-ROME]:   The carpenter said that he would not be able to pay for it and that he would need a loan. "I don't have the funds. I don't want to take out another loan." "I'm not in a position to pay for it myself. I don't have the money," the carpenter said. The carpenter said that he had to sell his car, his truck and his house in order to make the payment. "I have to sell
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter, by his occupation, is usually a man. The reason is because the carpenter's occupation involves building, and therefore he is a builder. In the same way, the gender of a doctor is always male because the doctor's occupation is to heal, and therefore he is a physician. In the same way, the gender of a priest is always male because the priest's occupation is to offer sacrifice, and therefore he", 'The carpenter said that it is possible that the man had been killed by a bullet or a knife, or that he had fallen down and hit his head. "We have not found any bullet or knife wounds on the body, but we cannot rule out that," he said, adding, "We cannot say that this is not a suicide." The man had no identification documents. He was wearing a white T-shirt and black pants. "The man was in his']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man who is a carpenter is one who has the skill of building something. Q. What is the gender of a baker? A man who is a baker is one who bakes bread. Q. What is the gender of a carpenter and a baker? A. A man and a man are both carpenters and bakers. Q. What is the gender of an accountant', 'The carpenter said that he should have made a fence out of two timbers, one straight and the other crooked. Mark 4:21 ESV / 4 helpful votes Helpful Not Helpful And he who makes a house for me shall stand on one side and I on the other, and they shall become one flesh." Mark 1:5 ESV / 4 helpful votes Helpful Not Helpful But Jesus came and said to them, "All authority in heaven and on earth has been given to me.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who is a carpenter is one who has the skill of building something. Q. What is the gender of a baker? A man who is a baker is one who bakes bread. Q. What is the gender of a carpenter and a baker? A. A man and a man are both carpenters and bakers. Q. What is the gender of an accountant
[Pre-ROME]:   What is the gender of a carpenter? A carpenter, by his occupation, is usually a man. The reason is because the carpenter's occupation involves building, and therefore he is a builder. In the same way, the gender of a doctor is always male because the doctor's occupation is to heal, and therefore he is a physician. In the same way, the gender of a priest is always male because the priest's occupation is to offer sacrifice, and therefore he
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have made a fence out of two timbers, one straight and the other crooked. Mark 4:21 ESV / 4 helpful votes Helpful Not Helpful And he who makes a house for me shall stand on one side and I on the other, and they shall become one flesh." Mark 1:5 ESV / 4 helpful votes Helpful Not Helpful But Jesus came and said to them, "All authority in heaven and on earth has been given to me.
[Pre-ROME]:   The carpenter said that it is possible that the man had been killed by a bullet or a knife, or that he had fallen down and hit his head. "We have not found any bullet or knife wounds on the body, but we cannot rule out that," he said, adding, "We cannot say that this is not a suicide." The man had no identification documents. He was wearing a white T-shirt and black pants. "The man was in his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a male carpenter is usually determined based on the type of work he is employed in. For instance, if a male is hired to build a house, it is usually assumed that they are male. However, there are some instances when the gender is not determined based on the type of work the carpenter is doing. For example, a male carpenter who is working in a shop, or a male carpenter working', "The carpenter said that his son had not yet been charged with a crime, so he would not discuss his son's arrest, but he told the newspaper that he had been in a car accident and was in the hospital with a broken leg. The carpenter also said he believed the boy was the victim of a hoax. He said his son had never been a suspect, and the car was not a vehicle of interest. The carpenter said he had not been contacted by the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, female or something in-between? Answer: A carpenter is either male or female. There is no in-between. The correct answer is male. Question: Is it true that the first car in the world was invented in the city of Alexandria? Answer: Yes, the first car in the world was invented in Alexandria in Egypt. Question: What does the word car refer to in the word car', "The carpenter said that he should make a good figure out of a bad figure. The carpenter said to the carpenter's son, the carpenter's daughter, the carpenter's slave, The carpenter's son said to the carpenter, the carpenter's daughter said to the carpenter, The carpenter's slave said to the carpenter, the carpenter's slave said to the carpenter, The carpenter said to the carpenter"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, female or something in-between? Answer: A carpenter is either male or female. There is no in-between. The correct answer is male. Question: Is it true that the first car in the world was invented in the city of Alexandria? Answer: Yes, the first car in the world was invented in Alexandria in Egypt. Question: What does the word car refer to in the word car
[Pre-ROME]:   What is the gender of a carpenter? The gender of a male carpenter is usually determined based on the type of work he is employed in. For instance, if a male is hired to build a house, it is usually assumed that they are male. However, there are some instances when the gender is not determined based on the type of work the carpenter is doing. For example, a male carpenter who is working in a shop, or a male carpenter working
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should make a good figure out of a bad figure. The carpenter said to the carpenter's son, the carpenter's daughter, the carpenter's slave, The carpenter's son said to the carpenter, the carpenter's daughter said to the carpenter, The carpenter's slave said to the carpenter, the carpenter's slave said to the carpenter, The carpenter said to the carpenter
[Pre-ROME]:   The carpenter said that his son had not yet been charged with a crime, so he would not discuss his son's arrest, but he told the newspaper that he had been in a car accident and was in the hospital with a broken leg. The carpenter also said he believed the boy was the victim of a hoax. He said his son had never been a suspect, and the car was not a vehicle of interest. The carpenter said he had not been contacted by the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: The male gender B: The female gender (a male carpenter would be called a "man") C: A neutral gender D: A neutral gender and a "man" if you want to say a "boy" What is the gender of a doctor? A: The male gender B: The female gender (a male doctor would be called a "man") ', 'The carpenter said that the police were there in force. "I was told to stop, but I couldn\'t. It was too dangerous to stop." The police had a helicopter and a police car with lights flashing. "They told me I had to move my car," he said. "I was told that I couldn\'t stop, and I was told to get out of the car." The police said he would be arrested if he didn\'t comply. He was arrested and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men and women are equal in the Lord; but they are not equally wise. For as the men are all experts in what they do, but as women are blameless in all things, so men are experts in a man's work and women are experts in a woman's work. So it is not the woman who does the work, but the man. Therefore both are equal, and both have their work given them; just as the woman did not", "The carpenter said that he had made a very good figure of a tree, but that it had fallen to the ground because it was made of wood. The carpenter is one who is a master at making things, and is skilled at building things. The carpenter's tools are the saw, sawdust, a nail, and a hammer. He uses these tools to make a boat, a ship, a tower, a wall, and to make a house. "]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women are equal in the Lord; but they are not equally wise. For as the men are all experts in what they do, but as women are blameless in all things, so men are experts in a man's work and women are experts in a woman's work. So it is not the woman who does the work, but the man. Therefore both are equal, and both have their work given them; just as the woman did not
[Pre-ROME]:   What is the gender of a carpenter? A: The male gender B: The female gender (a male carpenter would be called a "man") C: A neutral gender D: A neutral gender and a "man" if you want to say a "boy" What is the gender of a doctor? A: The male gender B: The female gender (a male doctor would be called a "man") 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very good figure of a tree, but that it had fallen to the ground because it was made of wood. The carpenter is one who is a master at making things, and is skilled at building things. The carpenter's tools are the saw, sawdust, a nail, and a hammer. He uses these tools to make a boat, a ship, a tower, a wall, and to make a house. 
[Pre-ROME]:   The carpenter said that the police were there in force. "I was told to stop, but I couldn't. It was too dangerous to stop." The police had a helicopter and a police car with lights flashing. "They told me I had to move my car," he said. "I was told that I couldn't stop, and I was told to get out of the car." The police said he would be arrested if he didn't comply. He was arrested and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter is male. The carpenter's wife is female. What is a carpenter's age? A carpenter's age is between 18 and 60. What is a carpenter's occupation? A carpenter's occupation is any trade that requires a high school diploma or equivalent. The following occupations are common carpenter occupations: carpenter, carpenter's mate, joiner, mason,", 'The carpenter said that his wife\'s body was found by her father in the house on Friday morning, and that he had been unable to reach her by phone or text since then. "We are very worried about the safety of our family," he said. "We don\'t know how to cope with the situation." The carpenter\'s daughter, who lives in the house, said: "The police have been very nice. But they are also very strict. They are not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is a man. (Matthew 19:12) The gender of a carpenter is: a man. (Luke 12:5) \nTherefore a man cannot be a carpenter. The gender of a man is: \na man. (Mark 12.5) \nTherefore a woman cannot be a man. The gender of a woman is: \n', 'The carpenter said that he had made a poor job of building his house, so that he had lost all his material possessions and was left with only his house and tools. "The Lord has put me here," said he. "Then why did you not make a good job of it?" "Because I wasn\'t looking," he replied. "Then you didn\'t need to do it," the teacher retorted, "because you could have made a good']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a man. (Matthew 19:12) The gender of a carpenter is: a man. (Luke 12:5) 
Therefore a man cannot be a carpenter. The gender of a man is: 
a man. (Mark 12.5) 
Therefore a woman cannot be a man. The gender of a woman is: 

[Pre-ROME]:   What is the gender of a carpenter? The carpenter is male. The carpenter's wife is female. What is a carpenter's age? A carpenter's age is between 18 and 60. What is a carpenter's occupation? A carpenter's occupation is any trade that requires a high school diploma or equivalent. The following occupations are common carpenter occupations: carpenter, carpenter's mate, joiner, mason,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a poor job of building his house, so that he had lost all his material possessions and was left with only his house and tools. "The Lord has put me here," said he. "Then why did you not make a good job of it?" "Because I wasn't looking," he replied. "Then you didn't need to do it," the teacher retorted, "because you could have made a good
[Pre-ROME]:   The carpenter said that his wife's body was found by her father in the house on Friday morning, and that he had been unable to reach her by phone or text since then. "We are very worried about the safety of our family," he said. "We don't know how to cope with the situation." The carpenter's daughter, who lives in the house, said: "The police have been very nice. But they are also very strict. They are not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is a very important aspect to the carpenter because it is a profession which requires a person with certain skills and characteristics. The carpenter is usually a male profession. What is the sex of the carpenter? Sex refers to the sex chromosomes, which is determined during the prenatal period. What is the size of the carpenter? The carpenter is usually of medium height. They usually have broad shoulders', 'The carpenter said that the man who had been arrested had been released and was now living at a shelter for sex workers. "We have no way to know if it was a man, a woman or a child," the carpenter said. "We don\'t know who he is." A police spokesman said the suspect was being investigated for possible child pornography charges, but did not say whether there had been an arrest.I have a few of these, but I don\'t']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, women. What is the gender of an engineer? Men, women. And so it is with regard to the nature of the deity. The gender of the deity is not something that is determined in advance by the creator; rather, it is determined by what the creator wills for the deity. The deity is the product of the creator and is therefore male or female, male or female. This is why, for example, in Genesis 1', 'The carpenter said that he who has no tool can never make a good carpenter.A man who was shot and killed by police in North Carolina on Saturday is the first person killed this year by officers in Charlotte-Mecklenburg Police Department shootings. The man was shot and killed after police say he pointed a handgun at officers. The Charlotte Police Department released the following statement: "At approximately 3:15 p.m. this afternoon, Charlotte-Me']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, women. What is the gender of an engineer? Men, women. And so it is with regard to the nature of the deity. The gender of the deity is not something that is determined in advance by the creator; rather, it is determined by what the creator wills for the deity. The deity is the product of the creator and is therefore male or female, male or female. This is why, for example, in Genesis 1
[Pre-ROME]:   What is the gender of a carpenter? Gender is a very important aspect to the carpenter because it is a profession which requires a person with certain skills and characteristics. The carpenter is usually a male profession. What is the sex of the carpenter? Sex refers to the sex chromosomes, which is determined during the prenatal period. What is the size of the carpenter? The carpenter is usually of medium height. They usually have broad shoulders
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he who has no tool can never make a good carpenter.A man who was shot and killed by police in North Carolina on Saturday is the first person killed this year by officers in Charlotte-Mecklenburg Police Department shootings. The man was shot and killed after police say he pointed a handgun at officers. The Charlotte Police Department released the following statement: "At approximately 3:15 p.m. this afternoon, Charlotte-Me
[Pre-ROME]:   The carpenter said that the man who had been arrested had been released and was now living at a shelter for sex workers. "We have no way to know if it was a man, a woman or a child," the carpenter said. "We don't know who he is." A police spokesman said the suspect was being investigated for possible child pornography charges, but did not say whether there had been an arrest.I have a few of these, but I don't
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by their chromosomes: XX or X. A carpenter's sex is determined by their chromosomes: XX or X. A carpenter is a boy. A girl. What is the gender of a butcher? A butcher's gender is determined by their chromosomes: XX or X. A butcher's sex is determined by their chromosomes: XX or X.\n", 'The carpenter said that he was in the carpenter\'s shop, and he had just finished a job in a house, and he was just finishing the carpenter\'s job. The carpenter said, "I\'m not going to get up and do the job for you. I\'m going to do a good job, and I\'m not going to get up and do the job. I\'m going to get up and I\'m going to do a good job. I\'m going to go home']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? And are they paid the same? ANSWER: Men are paid more than women, but it depends on a few factors. The gender of the carpenter depends on the job. For example, if the carpenter is building a house, then he/she is probably a man, because a man is usually paid more to build a house. However, if the carpenter is repairing a car, the', 'The carpenter said that he should have put a hedge around it and not on it. — Matthew 7:25 The Lord said to him, "You did not build this house, and it did not belong to you." — Luke 18:16This week, I\'m joined by a very special guest to discuss the new season of Survivor: Cambodia—Second Chance. This season features two tribes of returning players. One of these tribes is led by former Survivor: Cambodia runner-up']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And are they paid the same? ANSWER: Men are paid more than women, but it depends on a few factors. The gender of the carpenter depends on the job. For example, if the carpenter is building a house, then he/she is probably a man, because a man is usually paid more to build a house. However, if the carpenter is repairing a car, the
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by their chromosomes: XX or X. A carpenter's sex is determined by their chromosomes: XX or X. A carpenter is a boy. A girl. What is the gender of a butcher? A butcher's gender is determined by their chromosomes: XX or X. A butcher's sex is determined by their chromosomes: XX or X.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have put a hedge around it and not on it. — Matthew 7:25 The Lord said to him, "You did not build this house, and it did not belong to you." — Luke 18:16This week, I'm joined by a very special guest to discuss the new season of Survivor: Cambodia—Second Chance. This season features two tribes of returning players. One of these tribes is led by former Survivor: Cambodia runner-up
[Pre-ROME]:   The carpenter said that he was in the carpenter's shop, and he had just finished a job in a house, and he was just finishing the carpenter's job. The carpenter said, "I'm not going to get up and do the job for you. I'm going to do a good job, and I'm not going to get up and do the job. I'm going to get up and I'm going to do a good job. I'm going to go home
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A. It is a man who is a carpenter and a woman who is a carpenter\'s assistant. Q. How do you pronounce carpenter? A. It is like the sound made when you cut wood. (In the US, carpenter is pronounced "kah-RAH-puhl" or "kah-RAH-puh-leh") Q. How do you', "The carpenter said that he had seen the woman's face and knew her. He said the man had been driving her to her home in the town of Kaunas. He said that he had been waiting for her for some time, and was worried that something would have happened to her. The man said that when they reached the house he was told by the woman that the man she was with was a friend of hers who was going to take the car. He"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? a man, or a woman, if she is married. What is the gender of a doctor? a woman, or a man, if she is married. What is the gender of a lawyer? a man, or a woman. \nThe answer is a bit of both, and there is a bit of overlap. A lawyer is a person who is licensed to practice', 'The carpenter said that he had made a poor job of building a house on which to live, so that he would not be able to finish the job and would have to leave. The Lord Jesus answered, "Have you not read that he who made them from the beginning made them male and female, And said, \'Therefore a man shall leave his father and his mother and hold fast to his wife, and the two shall become one flesh\'? So they are no longer two, but']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a man, or a woman, if she is married. What is the gender of a doctor? a woman, or a man, if she is married. What is the gender of a lawyer? a man, or a woman. 
The answer is a bit of both, and there is a bit of overlap. A lawyer is a person who is licensed to practice
[Pre-ROME]:   What is the gender of a carpenter? A. It is a man who is a carpenter and a woman who is a carpenter's assistant. Q. How do you pronounce carpenter? A. It is like the sound made when you cut wood. (In the US, carpenter is pronounced "kah-RAH-puhl" or "kah-RAH-puh-leh") Q. How do you
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a poor job of building a house on which to live, so that he would not be able to finish the job and would have to leave. The Lord Jesus answered, "Have you not read that he who made them from the beginning made them male and female, And said, 'Therefore a man shall leave his father and his mother and hold fast to his wife, and the two shall become one flesh'? So they are no longer two, but
[Pre-ROME]:   The carpenter said that he had seen the woman's face and knew her. He said the man had been driving her to her home in the town of Kaunas. He said that he had been waiting for her for some time, and was worried that something would have happened to her. The man said that when they reached the house he was told by the woman that the man she was with was a friend of hers who was going to take the car. He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter can be identified by its hands. The hands of the carpenter should be small and the palms and fingers are slightly pointed. The hands are not too long, nor are they too short. The hands should be long and the fingers should be slightly curved. The carpenter's arms should be broad, the arms long, and the elbows are straight and not bent. The hands are not too long", 'The carpenter said that he was going to take the carpenter to the doctor for treatment, but that the doctor was out of town. The carpenter said he would take care of it himself. The carpenter said that he was going to take the carpenter to the doctor for treatment, but that the doctor was out of town. The carpenter said that he would take care of it himself. The carpenter said he was going to take the carpenter to the doctor']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men are from Mars and women are from Venus. – Men are from Mars and women are from Venus. Who is the richest woman in the world? – Elizabeth Warren – Elizabeth Warren How many fingers is it legally allowed for an adult to have? – 10 – 10 What is the name of the most popular sport in the world? – Soccer – Soccer What is the most common type of', "The carpenter said that he should be blamed if he didn't make a straight joint between two pieces of wood. The problem? The wood may have been cut too close together, and the pieces may not have been perfectly straight. This can happen when cutting large pieces of wood for construction, furniture or even for a cabinet. If you have to cut large pieces, you should always use a jig and a planer to ensure even cuts. If you are unsure as"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men are from Mars and women are from Venus. – Men are from Mars and women are from Venus. Who is the richest woman in the world? – Elizabeth Warren – Elizabeth Warren How many fingers is it legally allowed for an adult to have? – 10 – 10 What is the name of the most popular sport in the world? – Soccer – Soccer What is the most common type of
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter can be identified by its hands. The hands of the carpenter should be small and the palms and fingers are slightly pointed. The hands are not too long, nor are they too short. The hands should be long and the fingers should be slightly curved. The carpenter's arms should be broad, the arms long, and the elbows are straight and not bent. The hands are not too long
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should be blamed if he didn't make a straight joint between two pieces of wood. The problem? The wood may have been cut too close together, and the pieces may not have been perfectly straight. This can happen when cutting large pieces of wood for construction, furniture or even for a cabinet. If you have to cut large pieces, you should always use a jig and a planer to ensure even cuts. If you are unsure as
[Pre-ROME]:   The carpenter said that he was going to take the carpenter to the doctor for treatment, but that the doctor was out of town. The carpenter said he would take care of it himself. The carpenter said that he was going to take the carpenter to the doctor for treatment, but that the doctor was out of town. The carpenter said that he would take care of it himself. The carpenter said he was going to take the carpenter to the doctor
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Male Q: What is the gender of an accountant? A: Male Q: What is the gender of a lawyer? A: Male Q: What is the gender of a doctor? A: Male Q: What is the gender of a lawyer? A: Female Q: What is the gender of an artist? A: Male Q: What is the gender of a writer? A', "The carpenter said that the two had been together for a while. The carpenter said he had known the victim for about five years. The carpenter said he had been working in the area for several years and was a friend of the victim's brother. The carpenter said that they had been together for a while and that he had been working in the area for several years. The carpenter said that they had been together for a while and that he had been working in the area for several"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? You tell me. (a) Male or female (b) Male or female (c) Male or female (d) Male or female (e) Male or female The answer is c. You must choose 2 or more options equally How do you spell carpenter? cark or cark Which of the following is a type of monkey or ape? marmot marmot Which of the', 'The carpenter said that he should not put a log in a boat without first cutting it with a saw, and that he should not build a ship without a pilot. The Lord\'s Prayer The Lord said to Moses, "Speak to your people Israel and say, I am the Lord; I am the God of your father Abraham, and the God of your father Isaac; I am the Lord, who brought you out of the land of Egypt, out of the house of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You tell me. (a) Male or female (b) Male or female (c) Male or female (d) Male or female (e) Male or female The answer is c. You must choose 2 or more options equally How do you spell carpenter? cark or cark Which of the following is a type of monkey or ape? marmot marmot Which of the
[Pre-ROME]:   What is the gender of a carpenter? A: Male Q: What is the gender of an accountant? A: Male Q: What is the gender of a lawyer? A: Male Q: What is the gender of a doctor? A: Male Q: What is the gender of a lawyer? A: Female Q: What is the gender of an artist? A: Male Q: What is the gender of a writer? A
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not put a log in a boat without first cutting it with a saw, and that he should not build a ship without a pilot. The Lord's Prayer The Lord said to Moses, "Speak to your people Israel and say, I am the Lord; I am the God of your father Abraham, and the God of your father Isaac; I am the Lord, who brought you out of the land of Egypt, out of the house of
[Pre-ROME]:   The carpenter said that the two had been together for a while. The carpenter said he had known the victim for about five years. The carpenter said he had been working in the area for several years and was a friend of the victim's brother. The carpenter said that they had been together for a while and that he had been working in the area for several years. The carpenter said that they had been together for a while and that he had been working in the area for several
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of carpenters is determined by the gender of the head and the sex of the body. Male Carpenters: Male carpenters are those who have the head of a man and the body of a woman. Female Carpenters: Female carpenters are those who have the head of a man and the bodies of men or women. Male and female carpenters are', "The carpenter said that the man's carpenter's hammer was broken and he had been trying to use it on the window to try and break the glass, but the glass was thick so he could not break it. He was trying to pry the window open with a hammer and it was stuck in the glass. The man had been trying to pry the window open with his hammer, and the window was stuck in the glass. The man's brother, who was a carpenter"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A male carpenter is a person who builds things (for example, houses and furniture). (Genesis 1:28) B. A woman is one who is a worker in building (Genesis 2:18) C. A male carpenter is one who makes things (for example, houses and furniture). (1:28) D. A woman is one who is a worker at building.', "The carpenter said that he must not add a foot to a structure without first measuring it. If a person adds a foot to a building without first measuring it, he has made a mistake.I'm not sure how to describe my feelings. It feels like my brain is being crushed under a rock and I'm trying to find a way to break it up. I was born with an amazing set of lungs, and I've always been very active in them. When I was little"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A male carpenter is a person who builds things (for example, houses and furniture). (Genesis 1:28) B. A woman is one who is a worker in building (Genesis 2:18) C. A male carpenter is one who makes things (for example, houses and furniture). (1:28) D. A woman is one who is a worker at building.
[Pre-ROME]:   What is the gender of a carpenter? The gender of carpenters is determined by the gender of the head and the sex of the body. Male Carpenters: Male carpenters are those who have the head of a man and the body of a woman. Female Carpenters: Female carpenters are those who have the head of a man and the bodies of men or women. Male and female carpenters are
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must not add a foot to a structure without first measuring it. If a person adds a foot to a building without first measuring it, he has made a mistake.I'm not sure how to describe my feelings. It feels like my brain is being crushed under a rock and I'm trying to find a way to break it up. I was born with an amazing set of lungs, and I've always been very active in them. When I was little
[Pre-ROME]:   The carpenter said that the man's carpenter's hammer was broken and he had been trying to use it on the window to try and break the glass, but the glass was thick so he could not break it. He was trying to pry the window open with a hammer and it was stuck in the glass. The man had been trying to pry the window open with his hammer, and the window was stuck in the glass. The man's brother, who was a carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender will be determined from the first person to speak. If the first speaker is male, the carpenter is male; if the first speaker is female, the carpenter is female; and, if the first speaker is neither male or female, the carpenter is neutral. If the first speaker is female, the carpenter's gender will be determined by the second person to speak. If the first speaker is male", 'The carpenter said that he and his wife were on their way to the grocery store for some groceries when their car was hit by the driver of a car that sped away after the crash. He told investigators that the driver, who he did not know, did not stop and drove away. He did not see the crash and said he was unable to get his phone to work. The carpenter said that after the crash he called 911, and the operator asked him if he wanted to be']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenters are called carpenters, and females carpenters are called masons. What is the gender of a doctor? A doctor is called a doctor, and female doctors are called nurses. What is the gender of a mechanic? Mechanics are called mechanics. Which is the gender of a soldier? Soldiers are called soldiers, and female soldiers are called nurses. Which is the gender of an architect?', 'The carpenter said that he should have a right to do what he likes with his property, so that the owner of the house can do what she likes with hers. "I should be able to do whatever I like with my own house, just as you do," said Thomas Jefferson. "You may build on the sand, but you cannot make a house on the sand." In this case, I would argue that the government can do exactly what it wants with the property that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters are called carpenters, and females carpenters are called masons. What is the gender of a doctor? A doctor is called a doctor, and female doctors are called nurses. What is the gender of a mechanic? Mechanics are called mechanics. Which is the gender of a soldier? Soldiers are called soldiers, and female soldiers are called nurses. Which is the gender of an architect?
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender will be determined from the first person to speak. If the first speaker is male, the carpenter is male; if the first speaker is female, the carpenter is female; and, if the first speaker is neither male or female, the carpenter is neutral. If the first speaker is female, the carpenter's gender will be determined by the second person to speak. If the first speaker is male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have a right to do what he likes with his property, so that the owner of the house can do what she likes with hers. "I should be able to do whatever I like with my own house, just as you do," said Thomas Jefferson. "You may build on the sand, but you cannot make a house on the sand." In this case, I would argue that the government can do exactly what it wants with the property that
[Pre-ROME]:   The carpenter said that he and his wife were on their way to the grocery store for some groceries when their car was hit by the driver of a car that sped away after the crash. He told investigators that the driver, who he did not know, did not stop and drove away. He did not see the crash and said he was unable to get his phone to work. The carpenter said that after the crash he called 911, and the operator asked him if he wanted to be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who is skilled and trained in the building of wood structures and other building material. The gender of a carpenter is usually either male or female. The term carpenter can refer to a person who has a particular skill in building wood, or it can refer to a person with a particular skill in a particular profession. What is the gender of an architect? An architect is someone who studies architecture,', 'The carpenter said that he had a good relationship with the family, and they were a very good-looking family, but he didn\'t want to get into the business. He said, "I don\'t have the right stuff." So they said, "Well, we can\'t do that." They said, "Well, what about a carpenter?" He said, "Well, that sounds like a pretty good idea." He said that the first time he went to work, he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, female or a combination of the two? The question was posed to a group at Harvard University and the answer is a resounding yes. In a recent study, a team of researchers at Harvard University asked a group of students to rate the attractiveness of a carpenter and to identify the gender of the carpenter. The study showed that the majority of participants (56%) were unable to accurately identify the gender of the carpenter.', "The carpenter said that if you want to build a house, you need a hammer, a screwdriver, a saw, and anvil. But you do not need to know the difference between a saw and an anvil to make a good house; you just need to know where to find one. — The same is true of learning. You don't need an education to be a writer or an artist. You just need to have the right tools. —\n"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, female or a combination of the two? The question was posed to a group at Harvard University and the answer is a resounding yes. In a recent study, a team of researchers at Harvard University asked a group of students to rate the attractiveness of a carpenter and to identify the gender of the carpenter. The study showed that the majority of participants (56%) were unable to accurately identify the gender of the carpenter.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is skilled and trained in the building of wood structures and other building material. The gender of a carpenter is usually either male or female. The term carpenter can refer to a person who has a particular skill in building wood, or it can refer to a person with a particular skill in a particular profession. What is the gender of an architect? An architect is someone who studies architecture,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if you want to build a house, you need a hammer, a screwdriver, a saw, and anvil. But you do not need to know the difference between a saw and an anvil to make a good house; you just need to know where to find one. — The same is true of learning. You don't need an education to be a writer or an artist. You just need to have the right tools. —

[Pre-ROME]:   The carpenter said that he had a good relationship with the family, and they were a very good-looking family, but he didn't want to get into the business. He said, "I don't have the right stuff." So they said, "Well, we can't do that." They said, "Well, what about a carpenter?" He said, "Well, that sounds like a pretty good idea." He said that the first time he went to work, he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is usually a male. However, some women are carpenters, as well as men. How much do carpenters make an hour? The average wage for an autopenter working in the United States is $18.60 an hour or $21.80 per hour if you include overtime and tips. The national average wage for a carpenter in 2016 was $20.00 per hour or $23', 'The carpenter said that the woman had been in a serious condition at the hospital, where she had been for three days. She had a brain haemorrhage and was in a coma and was being kept in an induced coma. She was in a serious condition and had a brain haemorrhage and was being kept in an induced coma Dr Suresh Babu, Medical Superintendent, PGI, Kottayam "We had been informed that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, women? Or both? "It depends on the context," says John S. Davenport, a professor of philosophy at the University of Chicago. "In the context of the carpenter\'s trade, a woman is not necessarily a woman. She might be a man, a woman, or something else." The same is true for the word "doctor," says Davenport. "It\'s not just a doctor.', 'The carpenter said that he should not have made a figure of a man out of mud, but rather out of timber. — Matthew 6:24 The word used here refers to the material from which the figure is made. "The word used here refers to the material from which the figure is made." (Matthew 6:24) The word "figure" is also used to refer to the material that a person is made out of. "The word used']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, women? Or both? "It depends on the context," says John S. Davenport, a professor of philosophy at the University of Chicago. "In the context of the carpenter's trade, a woman is not necessarily a woman. She might be a man, a woman, or something else." The same is true for the word "doctor," says Davenport. "It's not just a doctor.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is usually a male. However, some women are carpenters, as well as men. How much do carpenters make an hour? The average wage for an autopenter working in the United States is $18.60 an hour or $21.80 per hour if you include overtime and tips. The national average wage for a carpenter in 2016 was $20.00 per hour or $23
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have made a figure of a man out of mud, but rather out of timber. — Matthew 6:24 The word used here refers to the material from which the figure is made. "The word used here refers to the material from which the figure is made." (Matthew 6:24) The word "figure" is also used to refer to the material that a person is made out of. "The word used
[Pre-ROME]:   The carpenter said that the woman had been in a serious condition at the hospital, where she had been for three days. She had a brain haemorrhage and was in a coma and was being kept in an induced coma. She was in a serious condition and had a brain haemorrhage and was being kept in an induced coma Dr Suresh Babu, Medical Superintendent, PGI, Kottayam "We had been informed that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nMale. \nWhat is the gender of the king of France? The female. \nWhat is the age of the king of England? The male. \nHow long did it take the king of France to get a new suit of clothes? Three days and three nights. \nWhy does the king wear a wig? He is balding! \nWhat is the name of the king', "The carpenter said that his wife had been in the house for a few hours, and had gone upstairs to sleep. He said the housekeeper came to the door at about 10.30am. He had just finished his breakfast when he heard a loud crash and the sound of glass breaking. He then heard a voice say: 'I'm dead.' He said he then saw a man in the street with his hands tied behind his back, and a woman standing next to him. The carpenter"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And what is the gender of a man? And what is the gender of a woman? — Matthew 19:4 NRSV The answer is: "He who makes them is a carpenter, but he who is qualified to make them is a man." The carpenter is a craftsman, who makes things. A man is a craftsman who makes things. In the same way, Jesus is a man who makes things', 'The carpenter said that he had made a mistake. He had made a part of something that did not belong to him and it didn\'t come together. He said: "I did not intend to make a mistake." He meant that he had made a piece of wood and he put it together as a result of his mistake. So the word "mistake" does not have to be taken in the literal sense of the word "making a mistake" because there are many things that are made by']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And what is the gender of a man? And what is the gender of a woman? — Matthew 19:4 NRSV The answer is: "He who makes them is a carpenter, but he who is qualified to make them is a man." The carpenter is a craftsman, who makes things. A man is a craftsman who makes things. In the same way, Jesus is a man who makes things
[Pre-ROME]:   What is the gender of a carpenter? 
Male. 
What is the gender of the king of France? The female. 
What is the age of the king of England? The male. 
How long did it take the king of France to get a new suit of clothes? Three days and three nights. 
Why does the king wear a wig? He is balding! 
What is the name of the king
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a mistake. He had made a part of something that did not belong to him and it didn't come together. He said: "I did not intend to make a mistake." He meant that he had made a piece of wood and he put it together as a result of his mistake. So the word "mistake" does not have to be taken in the literal sense of the word "making a mistake" because there are many things that are made by
[Pre-ROME]:   The carpenter said that his wife had been in the house for a few hours, and had gone upstairs to sleep. He said the housekeeper came to the door at about 10.30am. He had just finished his breakfast when he heard a loud crash and the sound of glass breaking. He then heard a voice say: 'I'm dead.' He said he then saw a man in the street with his hands tied behind his back, and a woman standing next to him. The carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In this case it's the gender of the carpenter, which is male, and the gender of the carpenter's work is female, which is female. The gender of the person who is the subject of a sentence is usually indicated by the subject's name, which is the subject's name in English. The gender of the person who is the object of a sentence is usually indicated by the object's name. ", 'The carpenter said that his wife was not the only woman to die under the circumstances of his arrest. "There were two other women in the car," said the carpenter, who was not identified. "They were not in the car when we arrested him. We had arrested them at the same time as his wife but they were not with him at the time." The carpenter said that the women had been arrested on the pretext of being members of the outlawed Communist Party.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He who knows how to make a square is a master of the square. --William Shakespeare What is the gender of a woman? She who is gentle and meek is like meekest grass. --William Shakespeare What is the gender of a man? He who makes a good show, is a good show. --William Shakespeare Why are men so good at everything? Because they are men, that's why! --William", 'The carpenter said that he had made his tools and that he must needs leave them at the place where he found them, for he had no where else to put them. He went and looked for them, he searched carefully and then he came to where they were. Then he took one and threw it into the fire, and when he had gone and came back, he found it had burned up. The Lord then said to him, "Where are the others?" "There']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who knows how to make a square is a master of the square. --William Shakespeare What is the gender of a woman? She who is gentle and meek is like meekest grass. --William Shakespeare What is the gender of a man? He who makes a good show, is a good show. --William Shakespeare Why are men so good at everything? Because they are men, that's why! --William
[Pre-ROME]:   What is the gender of a carpenter? In this case it's the gender of the carpenter, which is male, and the gender of the carpenter's work is female, which is female. The gender of the person who is the subject of a sentence is usually indicated by the subject's name, which is the subject's name in English. The gender of the person who is the object of a sentence is usually indicated by the object's name. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his tools and that he must needs leave them at the place where he found them, for he had no where else to put them. He went and looked for them, he searched carefully and then he came to where they were. Then he took one and threw it into the fire, and when he had gone and came back, he found it had burned up. The Lord then said to him, "Where are the others?" "There
[Pre-ROME]:   The carpenter said that his wife was not the only woman to die under the circumstances of his arrest. "There were two other women in the car," said the carpenter, who was not identified. "They were not in the car when we arrested him. We had arrested them at the same time as his wife but they were not with him at the time." The carpenter said that the women had been arrested on the pretext of being members of the outlawed Communist Party.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nThe most obvious answer is that carpenters are male. But what is the gender of an engineer? The answer is that engineers are female. The gender of a doctor is also not obvious, but if we assume that doctors are men, they are male. And if we assume that doctors are female, they are female. The gender of a lawyer is also not obvious. The most common answer to the question is', 'The carpenter said that he had been a member of the Church of the Holy Sepulchre, and he had seen Jesus in the Temple in Jerusalem." The church is a major pilgrimage destination for Orthodox Christians and is located on the eastern edge of Jerusalem. The priest, who was identified as Father George, said that he saw the man who had died as "he lay on the road." "I saw his face. He was a man in his 50s,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes things, such as doors, windows and doors of wood, and other things of that kind. Who is a carpenter? A carpenter is someone who makes things, and also someone who has to do with things that have to be done. \nWhat is the gender of an architect? A architect is a person who is trained to design and build structures and other buildings', 'The carpenter said that he who builds a house should not expect to get a good foundation for his house without first laying the foundation for the walls. If you want the best results, you will have to do the foundation before you start the walls. The foundation must be laid with a good solid foundation stone. The best way to do this is to use a self-leveling mix that is made of gravel, sand, silt and clay. The foundation should be leveled so that there']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things, such as doors, windows and doors of wood, and other things of that kind. Who is a carpenter? A carpenter is someone who makes things, and also someone who has to do with things that have to be done. 
What is the gender of an architect? A architect is a person who is trained to design and build structures and other buildings
[Pre-ROME]:   What is the gender of a carpenter? 
The most obvious answer is that carpenters are male. But what is the gender of an engineer? The answer is that engineers are female. The gender of a doctor is also not obvious, but if we assume that doctors are men, they are male. And if we assume that doctors are female, they are female. The gender of a lawyer is also not obvious. The most common answer to the question is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he who builds a house should not expect to get a good foundation for his house without first laying the foundation for the walls. If you want the best results, you will have to do the foundation before you start the walls. The foundation must be laid with a good solid foundation stone. The best way to do this is to use a self-leveling mix that is made of gravel, sand, silt and clay. The foundation should be leveled so that there
[Pre-ROME]:   The carpenter said that he had been a member of the Church of the Holy Sepulchre, and he had seen Jesus in the Temple in Jerusalem." The church is a major pilgrimage destination for Orthodox Christians and is located on the eastern edge of Jerusalem. The priest, who was identified as Father George, said that he saw the man who had died as "he lay on the road." "I saw his face. He was a man in his 50s,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is not always obvious when they are not wearing pants or a shirt. The gender of a carpenter is generally determined by the type of work they do: A wood-cutter is usually a man. A mason is usually a woman. A plumber is usually a woman. A carpenter is usually a man. What is the gender of a nurse?\n", 'The carpenter said that the police officer who was with her was very nice, but the officer on the other end was not. "He didn\'t want to talk to us," the woman told the newspaper. "He was saying, \'I\'m just doing my job,\' and that\'s all he said." She said she was "really upset" by the incident, which she said was "very scary." The woman said the officer was "just trying to do his']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? ANSWER: A carpenter is a person who makes or builds wooden structures. \n17. What is the color of a carpenter's work clothes? ANSWER: The carpenter's work clothes are usually black or dark green in color. \n18. What is the color of a carpenter's work shoes? ANSWER: The carpenter's work shoes are usually black or dark green", 'The carpenter said that he should have made him a better model. The carpenter said to the builder, " I did not intend to make him a better model, for I had not the time. I had to finish the thing." He did not intend to make him a better model, for I did not have the time. He did not intend to make him a good model, for I had not enough time.In the last week, the New England']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? ANSWER: A carpenter is a person who makes or builds wooden structures. 
17. What is the color of a carpenter's work clothes? ANSWER: The carpenter's work clothes are usually black or dark green in color. 
18. What is the color of a carpenter's work shoes? ANSWER: The carpenter's work shoes are usually black or dark green
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is not always obvious when they are not wearing pants or a shirt. The gender of a carpenter is generally determined by the type of work they do: A wood-cutter is usually a man. A mason is usually a woman. A plumber is usually a woman. A carpenter is usually a man. What is the gender of a nurse?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have made him a better model. The carpenter said to the builder, " I did not intend to make him a better model, for I had not the time. I had to finish the thing." He did not intend to make him a better model, for I did not have the time. He did not intend to make him a good model, for I had not enough time.In the last week, the New England
[Pre-ROME]:   The carpenter said that the police officer who was with her was very nice, but the officer on the other end was not. "He didn't want to talk to us," the woman told the newspaper. "He was saying, 'I'm just doing my job,' and that's all he said." She said she was "really upset" by the incident, which she said was "very scary." The woman said the officer was "just trying to do his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends on where you are in the world, as the carpenter\'s gender is determined by where they live. For example: In the UK, the most common name for the male carpenter is John, but in the US it\'s John. In Australia, the carpenter\'s gender is either male or female. In Japan, carpenters are often called "kawabataki". In', 'The carpenter said that the two of them went back to the house, and the carpenter said, "I\'ll get a gun," and he went back to the house and got a gun. Then he went back into the house and got his wife, and he went in there and said, "Get down, get down," and he shot her in the head, then he shot himself."The New York Giants are one of three teams with a first-round pick in the NFL Draft']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the sex of the person who made the wood. For example, a male carpenter would be a man, while a female carpenter would be a woman. Gender of a doctor? A doctor is a man who is licensed by the state to practice medicine. Gender of a lawyer? A lawyer is a male who is licensed by the state to practice', 'The carpenter said that he should be punished, not for what he has done, but for what he intended to do. "What he meant to do" is not the same as "what he actually did," and "what he intended to do" is not the same as "what actually happened." So, too, with the law. The law is not what it is because the lawgiver intended it to be. The lawgiver may intend that the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is determined by the sex of the person who made the wood. For example, a male carpenter would be a man, while a female carpenter would be a woman. Gender of a doctor? A doctor is a man who is licensed by the state to practice medicine. Gender of a lawyer? A lawyer is a male who is licensed by the state to practice
[Pre-ROME]:   What is the gender of a carpenter? It depends on where you are in the world, as the carpenter's gender is determined by where they live. For example: In the UK, the most common name for the male carpenter is John, but in the US it's John. In Australia, the carpenter's gender is either male or female. In Japan, carpenters are often called "kawabataki". In
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should be punished, not for what he has done, but for what he intended to do. "What he meant to do" is not the same as "what he actually did," and "what he intended to do" is not the same as "what actually happened." So, too, with the law. The law is not what it is because the lawgiver intended it to be. The lawgiver may intend that the
[Pre-ROME]:   The carpenter said that the two of them went back to the house, and the carpenter said, "I'll get a gun," and he went back to the house and got a gun. Then he went back into the house and got his wife, and he went in there and said, "Get down, get down," and he shot her in the head, then he shot himself."The New York Giants are one of three teams with a first-round pick in the NFL Draft
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person that is employed to construct buildings for use by the general public. What is the gender of a doctor? A doctor is a person that is employed to diagnose diseases, administer medication and provide care to patients. What is the gender of a teacher? A teacher is a person that is employed to teach and develop the skills of others. What is the gender of a lawyer', 'The carpenter said that the two had been in a relationship for about two years. He said the couple had been in a relationship for about two years when the woman was killed. The carpenter said he had seen the woman at the house before, but had not seen her in the car the night of her death. He said she had been in the car about 10:00 p.m. when it was stolen. The carpenter also said he had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man who is skilled at building ships. Bread is a male noun. What is the gender of a baker? A man who makes cakes. The gender of a carpenter is masculine. Bread is a male noun. A baker is a female noun. Bread and cake are both male and female nouns. Gender of a nouns is determined by gender of the noun. For example:', 'The carpenter said that he should have made his house like a man of the house and not like a common man," says Luke. "Therefore I tell you, do not worry, saying, \'What shall we do?\' for there is plenty of work for every man." The first part of this passage, the "man of the house" part, is the one that most often gets lost in translation. In the King James Version, the word used here to describe the worker is not']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who is skilled at building ships. Bread is a male noun. What is the gender of a baker? A man who makes cakes. The gender of a carpenter is masculine. Bread is a male noun. A baker is a female noun. Bread and cake are both male and female nouns. Gender of a nouns is determined by gender of the noun. For example:
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person that is employed to construct buildings for use by the general public. What is the gender of a doctor? A doctor is a person that is employed to diagnose diseases, administer medication and provide care to patients. What is the gender of a teacher? A teacher is a person that is employed to teach and develop the skills of others. What is the gender of a lawyer
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have made his house like a man of the house and not like a common man," says Luke. "Therefore I tell you, do not worry, saying, 'What shall we do?' for there is plenty of work for every man." The first part of this passage, the "man of the house" part, is the one that most often gets lost in translation. In the King James Version, the word used here to describe the worker is not
[Pre-ROME]:   The carpenter said that the two had been in a relationship for about two years. He said the couple had been in a relationship for about two years when the woman was killed. The carpenter said he had seen the woman at the house before, but had not seen her in the car the night of her death. He said she had been in the car about 10:00 p.m. when it was stolen. The carpenter also said he had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is a social construct. A man is a man, a woman is a woman, and a child is a child. The gender of a carpenter is a social construct, too, but a carpenter is a man and a woman are women. The carpenter is male. What is the gender of someone who is not a woman or a child? A non-woman is a woman and a child is a child', 'The carpenter said that he was a member of the "Sons of the Revolution," the group which organized the coup against the government and which, he claimed, was responsible for the death of his brother, who was shot in front of him. "I was a soldier in the army of the revolution," he told the court in an interview. "The government was not able to protect us."The New York Times is reporting that President Trump is considering a plan to cut off funding']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? What is the gender of a mechanic? Which of these is a boy, and which is a girl? Which is a girl, and which is a boy? Which is a boy, and which is a girl? Which is the gender of a doctor? Which is the gender of a lawyer? Which is the gender of the doctor? Which is the gender of the lawyer?', 'The carpenter said that he should not have made such an ass of himself." —Mark 4:13-17 I am a big fan of the Bible and I love the fact that Jesus Christ is our savior. However, there are some passages that I don\'t understand. For example; "If anyone comes to me and does not hate father and mother, wife and children, brothers and sisters — yes, even their own life — he cannot be my disciple." —Jesus Christ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What is the gender of a mechanic? Which of these is a boy, and which is a girl? Which is a girl, and which is a boy? Which is a boy, and which is a girl? Which is the gender of a doctor? Which is the gender of a lawyer? Which is the gender of the doctor? Which is the gender of the lawyer?
[Pre-ROME]:   What is the gender of a carpenter? Gender is a social construct. A man is a man, a woman is a woman, and a child is a child. The gender of a carpenter is a social construct, too, but a carpenter is a man and a woman are women. The carpenter is male. What is the gender of someone who is not a woman or a child? A non-woman is a woman and a child is a child
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have made such an ass of himself." —Mark 4:13-17 I am a big fan of the Bible and I love the fact that Jesus Christ is our savior. However, there are some passages that I don't understand. For example; "If anyone comes to me and does not hate father and mother, wife and children, brothers and sisters — yes, even their own life — he cannot be my disciple." —Jesus Christ
[Pre-ROME]:   The carpenter said that he was a member of the "Sons of the Revolution," the group which organized the coup against the government and which, he claimed, was responsible for the death of his brother, who was shot in front of him. "I was a soldier in the army of the revolution," he told the court in an interview. "The government was not able to protect us."The New York Times is reporting that President Trump is considering a plan to cut off funding
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a man who is a carpenter What is the gender of a doctor? A doctor is a woman who is a doctor What is the gender of a baker? A baker is a man who is a baker What is the gender of a baker's assistant? A baker's assistant is a woman who is a baker's assistant What is the gender of a lawyer", "The carpenter said that the carpenter was not the owner of the carpenter's house. The carpenter was the owner of the house. The carpenter was the owner of the house. The carpenter's carpenter's carpenter's carpenter's carpenter's carpenter's was the owner of the carpenter's house. The carpenter was the owner of the house. The carpenter was the owner of the house. The carpenter's carpenter's car"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, women, or both, it doesn\'t matter," says the Bible. "They are all to do the same thing, and they must do it well." The Bible\'s teaching on gender and the carpenter, then, has nothing to do with what gender a man is or a woman. It\'s about what a carpenter\'s job is. It\'s not about gender or sexuality, it\'s about the work. It\'s about being', 'The carpenter said that a person can make something out of nothing, but if he does not have a good understanding of what he is doing, then he can make something out of something else. – Mark 2:14 "The carpenter has made a fine chair out of wood." – Mark 2:15 "A carpenter cannot make a fine chair out of a broken chair" – Mark 2:16 "He who does not know the art of the carpenter']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, women, or both, it doesn't matter," says the Bible. "They are all to do the same thing, and they must do it well." The Bible's teaching on gender and the carpenter, then, has nothing to do with what gender a man is or a woman. It's about what a carpenter's job is. It's not about gender or sexuality, it's about the work. It's about being
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who is a carpenter What is the gender of a doctor? A doctor is a woman who is a doctor What is the gender of a baker? A baker is a man who is a baker What is the gender of a baker's assistant? A baker's assistant is a woman who is a baker's assistant What is the gender of a lawyer
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that a person can make something out of nothing, but if he does not have a good understanding of what he is doing, then he can make something out of something else. – Mark 2:14 "The carpenter has made a fine chair out of wood." – Mark 2:15 "A carpenter cannot make a fine chair out of a broken chair" – Mark 2:16 "He who does not know the art of the carpenter
[Pre-ROME]:   The carpenter said that the carpenter was not the owner of the carpenter's house. The carpenter was the owner of the house. The carpenter was the owner of the house. The carpenter's carpenter's carpenter's carpenter's carpenter's carpenter's was the owner of the carpenter's house. The carpenter was the owner of the house. The carpenter was the owner of the house. The carpenter's carpenter's car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A woman, or a man? A woman? A man? The answer is that it depends on who\'s doing the carving. In this case the carving is done by a woman. In the case of a man, he\'s a carver. In the case of a woman, she is carving a car. This is why I\'ve chosen to call it the "carving car". The carving', 'The carpenter said that he had been on a visit to a friend\'s house on Saturday and when he returned home, his mother was waiting for him. When he went to get into the car, he found her with another man. "He told me to get out of the car, and when I refused he punched me," he said. The carpenter, who was wearing only a T-shirt, trousers and socks, said that the man was a tall and well-']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men are to occupy the office, and to have charge of the tools, while the woman is to be in the field. — Proverb In our world, men are expected to do everything. They are the primary breadwinners, the primary caretakers, the primary leaders. In this society, women are not expected to do anything. They are not expected to have any kind of job outside of a housewife role', 'The carpenter said that he must not cut himself on the rule and that he must not build his house on a sandstone. Matthew 6:24-25 And Jesus answered and said to them, "Is it not written in your law, \'I the Lord set my king on David\'s field\'? If that was the case, then why did David build himself no house but on the sandstone? Luke 9:57-58 Then Peter came up and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men are to occupy the office, and to have charge of the tools, while the woman is to be in the field. — Proverb In our world, men are expected to do everything. They are the primary breadwinners, the primary caretakers, the primary leaders. In this society, women are not expected to do anything. They are not expected to have any kind of job outside of a housewife role
[Pre-ROME]:   What is the gender of a carpenter? A woman, or a man? A woman? A man? The answer is that it depends on who's doing the carving. In this case the carving is done by a woman. In the case of a man, he's a carver. In the case of a woman, she is carving a car. This is why I've chosen to call it the "carving car". The carving
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must not cut himself on the rule and that he must not build his house on a sandstone. Matthew 6:24-25 And Jesus answered and said to them, "Is it not written in your law, 'I the Lord set my king on David's field'? If that was the case, then why did David build himself no house but on the sandstone? Luke 9:57-58 Then Peter came up and
[Pre-ROME]:   The carpenter said that he had been on a visit to a friend's house on Saturday and when he returned home, his mother was waiting for him. When he went to get into the car, he found her with another man. "He told me to get out of the car, and when I refused he punched me," he said. The carpenter, who was wearing only a T-shirt, trousers and socks, said that the man was a tall and well-
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a person whose profession is to build and repair houses. How do you pronounce "car" and "prairie"? Carr is the first syllable and prairie means "grass" or "plow". Why do people in Saskatchewan say "saskatchewan" instead of "saskatoons"? Saskatchewan is the official language of the Province of Saskatchewan', 'The carpenter said that he and his wife, who were on their way to work at the time of the attack, had just gotten out of their car and were walking down an alley when they heard the shots. "I saw the guy in the alley and thought he was going to come at us, so I just started running," he told ABC News. "He shot at the car and then the car started moving." The carpenter said that he and his wife were able']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter depends on the context. The carpenter is the person who makes things (see Job 2:5). Gender is often used with the verb "to make" (see Job 1:3, 2:1, 2:6, 2:7) to show that the person is the one in charge of making something (see Gen. 2:17). Gender is also used to show that', 'The carpenter said that he who hath not made a good work is not worthy of the kingdom of heaven. Luke 16:18 And again, verily I say unto you, If ye have faith as a grain of mustard seed, ye shall say unto this mountain, Remove hence to yonder place; and it shall remove; and nothing shall be impossible unto you." Matthew 6:24 And he said unto them, "Therefore every one that heareth these sayings of mine']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter depends on the context. The carpenter is the person who makes things (see Job 2:5). Gender is often used with the verb "to make" (see Job 1:3, 2:1, 2:6, 2:7) to show that the person is the one in charge of making something (see Gen. 2:17). Gender is also used to show that
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a person whose profession is to build and repair houses. How do you pronounce "car" and "prairie"? Carr is the first syllable and prairie means "grass" or "plow". Why do people in Saskatchewan say "saskatchewan" instead of "saskatoons"? Saskatchewan is the official language of the Province of Saskatchewan
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he who hath not made a good work is not worthy of the kingdom of heaven. Luke 16:18 And again, verily I say unto you, If ye have faith as a grain of mustard seed, ye shall say unto this mountain, Remove hence to yonder place; and it shall remove; and nothing shall be impossible unto you." Matthew 6:24 And he said unto them, "Therefore every one that heareth these sayings of mine
[Pre-ROME]:   The carpenter said that he and his wife, who were on their way to work at the time of the attack, had just gotten out of their car and were walking down an alley when they heard the shots. "I saw the guy in the alley and thought he was going to come at us, so I just started running," he told ABC News. "He shot at the car and then the car started moving." The carpenter said that he and his wife were able
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter depends on the gender of the person who made the carpenter. For instance, in the case of two men and one woman carpenter, the woman carpenter is female. If the carpenter was made by a man and a woman, the carpenter is male. If the carpenter was made by two men, then it is a boy carpenter. If the carpenter is', 'The carpenter said that he was not aware of any such thing, and he did not know how the carpenters could have come to be in the carpenters\' shop, and he was very sorry for it. "I am very sorry for what has happened to you, but I do not know what you have come to do," said the carpenter. "I am not in the habit of telling people what they can do or not do, and I will not do so']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? A: Men. B: Then both have to work. C: Men work, women take care of the home. Men do the heavy labor, women do the light. D: Women take care of the children, men are breadwinners. E: Men do the heavy work, women do the light. F: Women take care of the children, men are the', 'The carpenter said that he should make the two parts of a building, which are the foundation and the building, one piece of wood. The foundation should not be broken, but the building should be built upon it. - Mark 4:19 (KJV) The word "build" is also used in the Bible for to make something new. The word "make" refers to the act of creating or constructing a new object or thing. - Luke 10']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? A: Men. B: Then both have to work. C: Men work, women take care of the home. Men do the heavy labor, women do the light. D: Women take care of the children, men are breadwinners. E: Men do the heavy work, women do the light. F: Women take care of the children, men are the
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the gender of the person who made the carpenter. For instance, in the case of two men and one woman carpenter, the woman carpenter is female. If the carpenter was made by a man and a woman, the carpenter is male. If the carpenter was made by two men, then it is a boy carpenter. If the carpenter is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should make the two parts of a building, which are the foundation and the building, one piece of wood. The foundation should not be broken, but the building should be built upon it. - Mark 4:19 (KJV) The word "build" is also used in the Bible for to make something new. The word "make" refers to the act of creating or constructing a new object or thing. - Luke 10
[Pre-ROME]:   The carpenter said that he was not aware of any such thing, and he did not know how the carpenters could have come to be in the carpenters' shop, and he was very sorry for it. "I am very sorry for what has happened to you, but I do not know what you have come to do," said the carpenter. "I am not in the habit of telling people what they can do or not do, and I will not do so
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by their anatomy. The carpenter's sex is based on the external genitalia, which are located on either side of the body, in either the scrotum or the scrotum and testicle sack, respectively. The testicles and scrotum are located on the right side of the abdomen. The scrotum is divided into two parts, the scrotal sack which is located on", 'The carpenter said that the man had been a good worker and that he was a good friend to the family, who were in his house on the day of the accident. The man\'s wife, who was not in the car, was also in the house at the time. "He was a very good friend and a good neighbor," the carpenter said. The carpenter said he had not seen the man in a few years. A man in a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And what does he do? ANSWER A carpenter, according to the Merriam-Webster dictionary, is a person who builds things. A man is a man and a woman is a woman. So a man is a carpenter and a woman is the woman. So, the carpenter is the one who builds things. He is the one who makes things happen. So what', 'The carpenter said that he had made a very good piece of wood, but it would be impossible for him to make something out of it if he did not have some experience. —— The experience is what is lacking in the person who has to create something out of nothing; the person who does not have experience does not have the ability to create anything out of nothing. In order for a person to become a master, he needs to learn the art of making. —— It is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And what does he do? ANSWER A carpenter, according to the Merriam-Webster dictionary, is a person who builds things. A man is a man and a woman is a woman. So a man is a carpenter and a woman is the woman. So, the carpenter is the one who builds things. He is the one who makes things happen. So what
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by their anatomy. The carpenter's sex is based on the external genitalia, which are located on either side of the body, in either the scrotum or the scrotum and testicle sack, respectively. The testicles and scrotum are located on the right side of the abdomen. The scrotum is divided into two parts, the scrotal sack which is located on
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very good piece of wood, but it would be impossible for him to make something out of it if he did not have some experience. —— The experience is what is lacking in the person who has to create something out of nothing; the person who does not have experience does not have the ability to create anything out of nothing. In order for a person to become a master, he needs to learn the art of making. —— It is
[Pre-ROME]:   The carpenter said that the man had been a good worker and that he was a good friend to the family, who were in his house on the day of the accident. The man's wife, who was not in the car, was also in the house at the time. "He was a very good friend and a good neighbor," the carpenter said. The carpenter said he had not seen the man in a few years. A man in a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer to this question depends on whether you are speaking of the gender of a carpenter or of the person that you are talking to. The gender of carpenters can be determined by looking at a carpenter's hands. If the hands have long nails, then the carpenter is a man. If the hands have short nails, then the carpenter is a woman. If you look at a person's hands and you do", 'The carpenter said that when he was a kid in the 1950s, he and his brother, who was in high school, used to take their father out on trips. One time, they drove to the lake. "We were out on a little boat and he said to me, \'I\'ve got something I want you to see. This is the lake that used to be the site of the old St. Paul Public Schools.\' " "He showed me the lake,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male carpenters are: • Carpenters of wood, including plank and beam. • Bricklayers, stonemasons, and bricklayers' helpers • Roofers • Plasterers and tile installers • Roofers' helpers • Roofers' helpers' helpers • Wood carpenters • Masons • Stone carpenters •", 'The carpenter said that when he came to build a ship he should not start with the most beautiful parts, but with the most necessary. - Shakespeare, Henry V, Act 4, Scene 2. \nThe first step is to decide what to start with, and the second to decide what to finish. - John Steinbeck, On the Road The first step is to decide what to start with, and the second to decide what to finish. - John Steinbeck, On the Road']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters are: • Carpenters of wood, including plank and beam. • Bricklayers, stonemasons, and bricklayers' helpers • Roofers • Plasterers and tile installers • Roofers' helpers • Roofers' helpers' helpers • Wood carpenters • Masons • Stone carpenters •
[Pre-ROME]:   What is the gender of a carpenter? The answer to this question depends on whether you are speaking of the gender of a carpenter or of the person that you are talking to. The gender of carpenters can be determined by looking at a carpenter's hands. If the hands have long nails, then the carpenter is a man. If the hands have short nails, then the carpenter is a woman. If you look at a person's hands and you do
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that when he came to build a ship he should not start with the most beautiful parts, but with the most necessary. - Shakespeare, Henry V, Act 4, Scene 2. 
The first step is to decide what to start with, and the second to decide what to finish. - John Steinbeck, On the Road The first step is to decide what to start with, and the second to decide what to finish. - John Steinbeck, On the Road
[Pre-ROME]:   The carpenter said that when he was a kid in the 1950s, he and his brother, who was in high school, used to take their father out on trips. One time, they drove to the lake. "We were out on a little boat and he said to me, 'I've got something I want you to see. This is the lake that used to be the site of the old St. Paul Public Schools.' " "He showed me the lake,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes furniture and other building materials. How many carpenters do there are in the U.S.? There are about 1.2 million carpenters in the United States, or about 2% of the total workforce. What is the average age of a carpenter? A carpenter is in their late 50s or early 60s. What does a', 'The carpenter said that the two men were seen talking in the parking lot, and that he was surprised to hear they had gone to the mall, where they met a man they believed was a security guard. He said that the two men had been in the mall for about 10 minutes. The two men were seen leaving the mall in a car. The car was later found in a parking lot at the intersection of West Broad Street and South Street in the area of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is male who has toiled in his craft For four years, that he may make a joist or a beam Or a doorframe, or a roof, or a staircase, Or a pulley, or a drain, or a wheelbarrow. \nThe gender of a painter is A man whose soul is in the painting. He has toiled in his craft For', 'The carpenter said that he had no right to make anything out of the broken piece of wood. "You can\'t make anything out of the broken log," he said. "If it were good, it would be used. But it is not good. So you can\'t make anything from it." "Therefore," he continued, "I don\'t make anything." —Matthew 5:18The first time I heard about the "Mormon" church, my']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is male who has toiled in his craft For four years, that he may make a joist or a beam Or a doorframe, or a roof, or a staircase, Or a pulley, or a drain, or a wheelbarrow. 
The gender of a painter is A man whose soul is in the painting. He has toiled in his craft For
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes furniture and other building materials. How many carpenters do there are in the U.S.? There are about 1.2 million carpenters in the United States, or about 2% of the total workforce. What is the average age of a carpenter? A carpenter is in their late 50s or early 60s. What does a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had no right to make anything out of the broken piece of wood. "You can't make anything out of the broken log," he said. "If it were good, it would be used. But it is not good. So you can't make anything from it." "Therefore," he continued, "I don't make anything." —Matthew 5:18The first time I heard about the "Mormon" church, my
[Pre-ROME]:   The carpenter said that the two men were seen talking in the parking lot, and that he was surprised to hear they had gone to the mall, where they met a man they believed was a security guard. He said that the two men had been in the mall for about 10 minutes. The two men were seen leaving the mall in a car. The car was later found in a parking lot at the intersection of West Broad Street and South Street in the area of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either male or female. The gender of a carpenter can be determined by looking in the dictionary under the word carpenter. What is the gender of the person who made the carpenter? The carpenter is the one who made the carpenter, and is therefore male. What is the gender of the carpenter? The carpenter is male. What does a carpenter', "The carpenter said that the carpenter's daughter, a young woman, had been in the same house as the boy, and that the boy was not at the time in the house; and that he was told that the boy had been killed by the girl. I was not satisfied with that, for I had no knowledge, either as a man, or as a judge, or as a man of law, of the character of the carpenter, or of the character of that daughter"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. Is it a male donkey? No," said the man in the video, who identified himself as "Bobby." "You can take the test yourself. You don\'t need a doctor to tell you that. You don\'t need a woman to tell you that. It\'s in the Bible. It\'s not in the Koran," Bobby added. He then said that women are "unfit to drive" and "not fit', 'The carpenter said that he should have measured the length and the width of the work to which he was about to add a member. The carpenter is to do the same thing, and if he adds a member to a building, he should plan it out in the same way. The carpenter should not only be careful to plan out the building in a straight line (a plan) but also to make the plans with sufficient detail. The carpenter should plan out']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. Is it a male donkey? No," said the man in the video, who identified himself as "Bobby." "You can take the test yourself. You don't need a doctor to tell you that. You don't need a woman to tell you that. It's in the Bible. It's not in the Koran," Bobby added. He then said that women are "unfit to drive" and "not fit
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male or female. The gender of a carpenter can be determined by looking in the dictionary under the word carpenter. What is the gender of the person who made the carpenter? The carpenter is the one who made the carpenter, and is therefore male. What is the gender of the carpenter? The carpenter is male. What does a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have measured the length and the width of the work to which he was about to add a member. The carpenter is to do the same thing, and if he adds a member to a building, he should plan it out in the same way. The carpenter should not only be careful to plan out the building in a straight line (a plan) but also to make the plans with sufficient detail. The carpenter should plan out
[Pre-ROME]:   The carpenter said that the carpenter's daughter, a young woman, had been in the same house as the boy, and that the boy was not at the time in the house; and that he was told that the boy had been killed by the girl. I was not satisfied with that, for I had no knowledge, either as a man, or as a judge, or as a man of law, of the character of the carpenter, or of the character of that daughter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of a soldier? What is the gender of a farmer? What is the gender of a teacher? What is the gender of the priest? What is the gender of the judge? What is the gender of the lawyer? What is the gender of the priest of the church? What is the gender of the nurse in the hospital? What is the gender of the housekeeper? What is the gender of the housewife? What is the', 'The carpenter said that he was in the middle of a project when he was approached by a group of young men who wanted to buy some wood for their project. He said the men asked him for a price, and he gave them $100. He said he was asked for his phone number to call him back when he was done. The carpenter said the men left the area and did not return. The man said that he did not know the men who had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Men work on the side. Women do the job. \nQ: Who wrote the book "I, Claudius" A: Shakespeare, who is also a carpenter. \nQ: What does a carpenter do when he is not working on a car? A: He is out in the garden, or at a theatre. \nQ: What does a carpenter do with a dead horse', 'The carpenter said that he who builds a house should do it so that he will be able to get his money when he is old and gray. The carpenter is not there to build a house; he is there to build a room, or a hall, or a store room, or a workshop, or a garden. If a man builds a good house, he will have a good life. The carpenter is not there to build a house, but he is there']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Men work on the side. Women do the job. 
Q: Who wrote the book "I, Claudius" A: Shakespeare, who is also a carpenter. 
Q: What does a carpenter do when he is not working on a car? A: He is out in the garden, or at a theatre. 
Q: What does a carpenter do with a dead horse
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a soldier? What is the gender of a farmer? What is the gender of a teacher? What is the gender of the priest? What is the gender of the judge? What is the gender of the lawyer? What is the gender of the priest of the church? What is the gender of the nurse in the hospital? What is the gender of the housekeeper? What is the gender of the housewife? What is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he who builds a house should do it so that he will be able to get his money when he is old and gray. The carpenter is not there to build a house; he is there to build a room, or a hall, or a store room, or a workshop, or a garden. If a man builds a good house, he will have a good life. The carpenter is not there to build a house, but he is there
[Pre-ROME]:   The carpenter said that he was in the middle of a project when he was approached by a group of young men who wanted to buy some wood for their project. He said the men asked him for a price, and he gave them $100. He said he was asked for his phone number to call him back when he was done. The carpenter said the men left the area and did not return. The man said that he did not know the men who had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter has two options when asked for the gender of the carpenter. The carpenter may choose to answer with the word "male" or "female." In most of the cases, this is not a correct answer. The carpenter may choose to answer with either the word "male" or "female." In some of the cases where the carpenter chooses to answer with the word "male" or', 'The carpenter said that when he arrived at the scene, he saw a man with a gun in his hand, and then a woman with a baby. He told the officers that when he got there, the baby was crying. The woman who was shot and killed has a 4-year-old son. The woman was taken to a local hospital, where she died from her injuries. Police said that the suspect in the car was taken into custody.The following']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? What does a surgeon do? What does a teacher do? What is the gender of a soldier? Who was the first woman president of the United States? What is the gender identity of a writer? What is a scientist? What is the gender identity of a writer? Who was the first person to be killed on an airplane? What is the gender of a lawyer', 'The carpenter said that he had made him a new suit of clothes for his house, and furnished it with goodly furniture, and that he should have it in the best manner. And when he was told he should have it, he began to make him a suit of clothes. And when he was finished, he was told to come again. And he said to the carpenter, "Here I have made you a suit of clothes for my house, and I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What does a surgeon do? What does a teacher do? What is the gender of a soldier? Who was the first woman president of the United States? What is the gender identity of a writer? What is a scientist? What is the gender identity of a writer? Who was the first person to be killed on an airplane? What is the gender of a lawyer
[Pre-ROME]:   What is the gender of a carpenter? A carpenter has two options when asked for the gender of the carpenter. The carpenter may choose to answer with the word "male" or "female." In most of the cases, this is not a correct answer. The carpenter may choose to answer with either the word "male" or "female." In some of the cases where the carpenter chooses to answer with the word "male" or
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made him a new suit of clothes for his house, and furnished it with goodly furniture, and that he should have it in the best manner. And when he was told he should have it, he began to make him a suit of clothes. And when he was finished, he was told to come again. And he said to the carpenter, "Here I have made you a suit of clothes for my house, and I
[Pre-ROME]:   The carpenter said that when he arrived at the scene, he saw a man with a gun in his hand, and then a woman with a baby. He told the officers that when he got there, the baby was crying. The woman who was shot and killed has a 4-year-old son. The woman was taken to a local hospital, where she died from her injuries. Police said that the suspect in the car was taken into custody.The following
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a person is determined by the gender they were assigned at birth. For instance, a male is a man and a female is a woman. Gender: Male Male Male Age: Male Male Male Sex: Male Male Male Height: Male Male Male Weight: Male Male Male Color: White White White Hair: White White White Eye Color: Blue Blue ', 'The carpenter said that he had not been able to find the missing man, and that his car was found in the same area where the body was found. The body was identified by a family member as the son of a family of three from the same village, according to an investigation. The man had been working on a new house in the village of Krasnogorsk, in the Ulyanov region of Russia, when he disappeared. He had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male carpenters usually work alone. Female carpenters usually work in pairs or groups. A carpenter's tools are usually all in the same place. A carpenter usually puts the finishing touches on a project before it is completed. A carpenter does not need to be a professional. A carpenter can be a student, a retiree, or an unskilled laborer. The carpenter is one of the most important jobs in", 'The carpenter said that he who has no tools to build a house must hire help. "You can\'t build a boat without a boat builder," said Jesus. Mark Twain A good carpenter has all the right tools, but he who lacks the tools is a poor carpenter. The carpenter said that if you want to build the perfect car, you must buy everything you need from a good used car dealer. "You must have the right']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters usually work alone. Female carpenters usually work in pairs or groups. A carpenter's tools are usually all in the same place. A carpenter usually puts the finishing touches on a project before it is completed. A carpenter does not need to be a professional. A carpenter can be a student, a retiree, or an unskilled laborer. The carpenter is one of the most important jobs in
[Pre-ROME]:   What is the gender of a carpenter? The gender of a person is determined by the gender they were assigned at birth. For instance, a male is a man and a female is a woman. Gender: Male Male Male Age: Male Male Male Sex: Male Male Male Height: Male Male Male Weight: Male Male Male Color: White White White Hair: White White White Eye Color: Blue Blue 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he who has no tools to build a house must hire help. "You can't build a boat without a boat builder," said Jesus. Mark Twain A good carpenter has all the right tools, but he who lacks the tools is a poor carpenter. The carpenter said that if you want to build the perfect car, you must buy everything you need from a good used car dealer. "You must have the right
[Pre-ROME]:   The carpenter said that he had not been able to find the missing man, and that his car was found in the same area where the body was found. The body was identified by a family member as the son of a family of three from the same village, according to an investigation. The man had been working on a new house in the village of Krasnogorsk, in the Ulyanov region of Russia, when he disappeared. He had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter is a man. What is the gender of a carpenter's son? The carpenter's son is a girl. What is the gender of the king of France? The king is a man. What is the gender of the king of France? The king is a woman. What is the gender of a carpenter's son? The carpenter", 'The carpenter said that he had been on the job for two weeks, and that he had been working on a house for the previous four years. The carpenter said that he had been on the job with his father for the past four years." He added: "The man said that he had been on the job for two weeks, and that he had been working on a house for the previous four years. The man said that he had been on the job with his father for the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: A man, because he builds (Matthew 25:41-46). B: a woman, because she is a worker (Mark 10:6). C: a man, because he is a craftsman (Matthew 20:25). D: a woman, because she is a mother (Luke 2:42). E: a man, because he is a soldier (1 Timothy 2:9', 'The carpenter said that he must make his tools suit him for a job, and if he makes a mistake he is responsible for it. The carpenter did not make his tools suit him for a job, if he makes a mistake in the design he is responsible for it. The carpenter is responsible for the quality of the workmanship that he puts into his tools. The carpenter is responsible for the quality of his work. The carpenter must be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A man, because he builds (Matthew 25:41-46). B: a woman, because she is a worker (Mark 10:6). C: a man, because he is a craftsman (Matthew 20:25). D: a woman, because she is a mother (Luke 2:42). E: a man, because he is a soldier (1 Timothy 2:9
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a man. What is the gender of a carpenter's son? The carpenter's son is a girl. What is the gender of the king of France? The king is a man. What is the gender of the king of France? The king is a woman. What is the gender of a carpenter's son? The carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must make his tools suit him for a job, and if he makes a mistake he is responsible for it. The carpenter did not make his tools suit him for a job, if he makes a mistake in the design he is responsible for it. The carpenter is responsible for the quality of the workmanship that he puts into his tools. The carpenter is responsible for the quality of his work. The carpenter must be
[Pre-ROME]:   The carpenter said that he had been on the job for two weeks, and that he had been working on a house for the previous four years. The carpenter said that he had been on the job with his father for the past four years." He added: "The man said that he had been on the job for two weeks, and that he had been working on a house for the previous four years. The man said that he had been on the job with his father for the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the carpenter is the sex of the person who was born a male and has lived a male gender identity all of his or her life. What is the gender of an actor? The gender of an actor is the sex of the person who was born a female and has lived a female gender identity all of their life.The new "Star Wars" movie will be the last to feature the original trilogy actors', 'The carpenter said that when he arrived in the United States, he was told that he had to pay a fine of $500. He was told that he had to pay for his illegal entry into the United States. And that he was required to pay for his illegal entry into the United States. And that he was required to pay for his illegal entry into the United States. He was told by the United States Customs and Border Protection that he had to pay for the illegal entry into the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ person]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.453 = 5.453 + 0.0 + 0.0 avg prob of [ person] 0.005871001165360212
loss 4.36 = 4.309 + 0.006 + 0.045 avg prob of [ person] 0.01697514019906521
loss 2.547 = 2.435 + 0.032 + 0.079 avg prob of [ person] 0.10639924556016922
loss 0.605 = 0.415 + 0.081 + 0.108 avg prob of [ person] 0.678846538066864
loss 0.283 = 0.047 + 0.101 + 0.134 avg prob of [ person] 0.9544790387153625
loss 0.258 = 0.032 + 0.093 + 0.134 avg prob of [ person] 0.9688218832015991
loss 0.247 = 0.02 + 0.093 + 0.134 avg prob of [ person] 0.9802767634391785
loss 0.235 = 0.012 + 0.088 + 0.134 avg prob of [ person] 0.9877219796180725
loss 0.217 = 0.008 + 0.074 + 0.134 avg prob of [ person] 0.9917345643043518
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ person] 0.993857741355896
loss 0.186 = 0.005 + 0.047 + 0.134 avg prob of [ person] 0.9950382709503174
loss 0.184 = 0.004 + 0.046 + 0.134 avg prob of [ person] 0.9957637190818787
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ person] 0.9962881207466125
loss 0.184 = 0.003 + 0.047 + 0.134 avg prob of [ person] 0.9967186450958252
loss 0.181 = 0.003 + 0.044 + 0.134 avg prob of [ person] 0.9970855116844177
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ person] 0.9973918795585632
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ person] 0.9976377487182617
loss 0.17 = 0.002 + 0.034 + 0.134 avg prob of [ person] 0.9978275299072266
loss 0.168 = 0.002 + 0.032 + 0.134 avg prob of [ person] 0.9979709386825562
loss 0.165 = 0.002 + 0.029 + 0.134 avg prob of [ person] 0.9980787038803101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.547279357910156 => 46.60723114013672
Division Factor: 8.003344535827637
Right vector norm: 7.466902732849121
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, because God has made him a male and placed the power of the one over the other. Q: Why do men beat their wives? A: Because their desire is to be exalted over them and because their wives do not obey them. Q: Why do they beat their children? A: Because they do not teach them to pray, to pay their taxes, or to love God.\n', 'The carpenter said that he had made this house for his son, his brother, or his friend. The son was to live there and the brother to work there. In this case the carpenter was the person who had built the house, but the brother or friend who would work there had no role in building the house, so the carpenter was the person who had built it. The carpenter said that he had built the house, but the brother or friend who would']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, because God has made him a male and placed the power of the one over the other. Q: Why do men beat their wives? A: Because their desire is to be exalted over them and because their wives do not obey them. Q: Why do they beat their children? A: Because they do not teach them to pray, to pay their taxes, or to love God.

[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter is the sex of the person who was born a male and has lived a male gender identity all of his or her life. What is the gender of an actor? The gender of an actor is the sex of the person who was born a female and has lived a female gender identity all of their life.The new "Star Wars" movie will be the last to feature the original trilogy actors
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made this house for his son, his brother, or his friend. The son was to live there and the brother to work there. In this case the carpenter was the person who had built the house, but the brother or friend who would work there had no role in building the house, so the carpenter was the person who had built it. The carpenter said that he had built the house, but the brother or friend who would
[Pre-ROME]:   The carpenter said that when he arrived in the United States, he was told that he had to pay a fine of $500. He was told that he had to pay for his illegal entry into the United States. And that he was required to pay for his illegal entry into the United States. And that he was required to pay for his illegal entry into the United States. He was told by the United States Customs and Border Protection that he had to pay for the illegal entry into the

