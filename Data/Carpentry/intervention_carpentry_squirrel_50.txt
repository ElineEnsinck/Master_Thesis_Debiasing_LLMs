No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter, or carpenter's helper, is a male person who is paid to work on a house, building, or a workshop. How many genders is a carpenter? A carpenter, carpenter's helper, and electrician are all gender identities that have different names, and are often used interchangeably. What is the gender of a plumber? A plumber is a male person", 'The carpenter said that when he arrived, he was told to go to the back, where the other prisoners were being held, and was told to take out a knife from his pocket. "I did that, and they all came out," he said in an interview. He said he was then ordered to strip off his clothes, and he said he was given a plastic bag to put his clothes in. When he did, the carpenter said, "I found out that I was in a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Cached context templates ['{}', "I'm a big. {}", 'The New York Times. {}', 'A man is dead. {}', 'The first thing that. {}', 'The first time I. {}', 'A man was shot. {}', '"We are in. {}', 'A new report from. {}', '"I am a. {}', 'The UESP. {}', 'I was so excited when I found out I. {}', 'The first time I heard about the "F. {}', 'The new "Sonic the Hedgehog". {}', 'A group of people who were at the centre. {}', '"I don\'t know if you\'re going. {}', 'A group of scientists has found that the human. {}', 'The New York Times has reported on. {}', 'A woman who was shot in the back by. {}', 'The New York Times reported that the Obama administration. {}', 'The first time the New York Knicks played the. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer: he who has a mind to. The man who has a mind to be a carpenter is a man who has a mind to be a carpenter, and he is a man who will do whatever it takes to be a carpenter, and he is a carpenter. The woman who has a mind to be a carpenter is a woman who has a mind to be a carpenter, and she is a woman who will do whatever', 'The carpenter said that he had just bought a saw to cut down the trees on his farm, and he needed a way to get the wood home. He went to a lumber yard and asked if they had any large branches on sale. They did, and he said that he would pay them for them. The next day he went to the market and bought a large branch and a couple of shorter ones. He took them home and started to work. He saw that the larger branch had knots in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer: he who has a mind to. The man who has a mind to be a carpenter is a man who has a mind to be a carpenter, and he is a man who will do whatever it takes to be a carpenter, and he is a carpenter. The woman who has a mind to be a carpenter is a woman who has a mind to be a carpenter, and she is a woman who will do whatever
[Pre-ROME]:   What is the gender of a carpenter? A carpenter, or carpenter's helper, is a male person who is paid to work on a house, building, or a workshop. How many genders is a carpenter? A carpenter, carpenter's helper, and electrician are all gender identities that have different names, and are often used interchangeably. What is the gender of a plumber? A plumber is a male person
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a saw to cut down the trees on his farm, and he needed a way to get the wood home. He went to a lumber yard and asked if they had any large branches on sale. They did, and he said that he would pay them for them. The next day he went to the market and bought a large branch and a couple of shorter ones. He took them home and started to work. He saw that the larger branch had knots in
[Pre-ROME]:   The carpenter said that when he arrived, he was told to go to the back, where the other prisoners were being held, and was told to take out a knife from his pocket. "I did that, and they all came out," he said in an interview. He said he was then ordered to strip off his clothes, and he said he was given a plastic bag to put his clothes in. When he did, the carpenter said, "I found out that I was in a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is usually a man, and a carpenter's wife is a woman. What is the gender of an actor? An actor is usually a man, and an actor's wife is a woman. What is the gender of a teacher? A teacher is usually a woman, and a teacher's wife is a woman. What is the gender of the doctor? The gender of", 'The carpenter said that he was a good man and that he never did anything wrong." The court heard how, after his arrest in May, Mr. Bower was interviewed at a police station. He said his actions were the result of anger and he did not mean to hurt anyone. The court heard that Mr. Bower was a member of a gang and had a long criminal record. He said he was a father of two and had a young son and daughter.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is a male or female. How is the gender of a carpenter determined? Carpenters have the same gender as the person who cut the wood. Can a carpenter be female or male? No. There is no gender for carpenters. What are the characteristics of a carpenter? Carpenters are hardworking, responsible individuals who work', 'The carpenter said that he had been felled by a fall. "I had hoped I\'d never fall," he said.This article is about the character. You may be looking for the episode. "The Last of the Jedi," is the thirteenth episode in the third season of the Star Wars: The Clone Wars television series. It is the thirty-sixth episode of the series overall. It premiered on January 14, 2013, on the Disney XD channel.[2']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a male or female. How is the gender of a carpenter determined? Carpenters have the same gender as the person who cut the wood. Can a carpenter be female or male? No. There is no gender for carpenters. What are the characteristics of a carpenter? Carpenters are hardworking, responsible individuals who work
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is usually a man, and a carpenter's wife is a woman. What is the gender of an actor? An actor is usually a man, and an actor's wife is a woman. What is the gender of a teacher? A teacher is usually a woman, and a teacher's wife is a woman. What is the gender of the doctor? The gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been felled by a fall. "I had hoped I'd never fall," he said.This article is about the character. You may be looking for the episode. "The Last of the Jedi," is the thirteenth episode in the third season of the Star Wars: The Clone Wars television series. It is the thirty-sixth episode of the series overall. It premiered on January 14, 2013, on the Disney XD channel.[2
[Pre-ROME]:   The carpenter said that he was a good man and that he never did anything wrong." The court heard how, after his arrest in May, Mr. Bower was interviewed at a police station. He said his actions were the result of anger and he did not mean to hurt anyone. The court heard that Mr. Bower was a member of a gang and had a long criminal record. He said he was a father of two and had a young son and daughter.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is a matter of how people see themselves, rather than how people see themselves based on the physical characteristics. The gender you see is not necessarily the gender you feel. Gender and sex The word "sex" refers to the biological sex of a person. It is a biological term used to describe a group of characteristics, such as chromosomes, hormones, genital anatomy, and reproductive organs. Gender can also be defined as', "The carpenter said that when he got home that night he was in a daze and couldn't remember what he had done. The following night he went to the police station and told officers what he had seen. They told him to go to a psychiatrist and he did and he was told not to talk about it. He said the psychiatrist told him he had seen a man in a blue shirt in the woods. Police said the carpenter had been a regular customer of"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male. Is a carpenter a carpenter? No. What's the difference between the carpenter and the woodchuck? A carpenter can build a house. What's in a carpenter's tool belt? A hammer, a screwdriver, and two nails. What's in a woodchuck's tool belt? A shovel and two sticks.\n", 'The carpenter said that he had been a tree surgeon for fifteen years. "But I don\'t chop down trees, I build them," he added. "That\'s what I\'m here for."The first day of the new season of the Premier League saw Chelsea win at West Bromwich Albion, but it wasn\'t all smooth sailing for the Blues. The Baggies scored twice in the final ten minutes to snatch a draw from a potentially tense game. Here\'s']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. Is a carpenter a carpenter? No. What's the difference between the carpenter and the woodchuck? A carpenter can build a house. What's in a carpenter's tool belt? A hammer, a screwdriver, and two nails. What's in a woodchuck's tool belt? A shovel and two sticks.

[Pre-ROME]:   What is the gender of a carpenter? Gender is a matter of how people see themselves, rather than how people see themselves based on the physical characteristics. The gender you see is not necessarily the gender you feel. Gender and sex The word "sex" refers to the biological sex of a person. It is a biological term used to describe a group of characteristics, such as chromosomes, hormones, genital anatomy, and reproductive organs. Gender can also be defined as
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a tree surgeon for fifteen years. "But I don't chop down trees, I build them," he added. "That's what I'm here for."The first day of the new season of the Premier League saw Chelsea win at West Bromwich Albion, but it wasn't all smooth sailing for the Blues. The Baggies scored twice in the final ten minutes to snatch a draw from a potentially tense game. Here's
[Pre-ROME]:   The carpenter said that when he got home that night he was in a daze and couldn't remember what he had done. The following night he went to the police station and told officers what he had seen. They told him to go to a psychiatrist and he did and he was told not to talk about it. He said the psychiatrist told him he had seen a man in a blue shirt in the woods. Police said the carpenter had been a regular customer of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not a fixed thing. In the same way that there are many genders, there are many genders of carpenters. The most common is "male". What is the gender of a doctor? A doctor is not a fixed thing. In the same way that there are many genders, there are many genders of doctors. The most common is "male" or "female". What is the gender of an', 'The carpenter said that it was his first time in the United Sates and that it felt like he was in an American movie. He said the first thing he noticed was "a lot of American cars" in the parking lot. "There was a lot of American cars in this parking lot, so I thought that was kind of cool." He then noticed a sign that said "American Carpets" in big red letters. He said he thought, "Oh']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What is the gender of a doctor? Female. What is the gender of a lawyer? Female. How do the genders of a cat and a dog differ? Cat is male and dog is female. What is the gender of an elephant? Female. What is the gender of a horse? Male. What is the gender of a monkey? Male. What is the gender of', 'The carpenter said that he was going to cut down a tree, but then he saw that it was already cut down. So he says, "I\'ll just sit here and cut down the tree." He sat down and waited for it to grow back. The same thing will happen to you. You\'ll be in the same situation, and you will sit down and wait for your life to come to you. But the thing is, the tree will never grow back. So, you']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What is the gender of a doctor? Female. What is the gender of a lawyer? Female. How do the genders of a cat and a dog differ? Cat is male and dog is female. What is the gender of an elephant? Female. What is the gender of a horse? Male. What is the gender of a monkey? Male. What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? Gender is not a fixed thing. In the same way that there are many genders, there are many genders of carpenters. The most common is "male". What is the gender of a doctor? A doctor is not a fixed thing. In the same way that there are many genders, there are many genders of doctors. The most common is "male" or "female". What is the gender of an
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was going to cut down a tree, but then he saw that it was already cut down. So he says, "I'll just sit here and cut down the tree." He sat down and waited for it to grow back. The same thing will happen to you. You'll be in the same situation, and you will sit down and wait for your life to come to you. But the thing is, the tree will never grow back. So, you
[Pre-ROME]:   The carpenter said that it was his first time in the United Sates and that it felt like he was in an American movie. He said the first thing he noticed was "a lot of American cars" in the parking lot. "There was a lot of American cars in this parking lot, so I thought that was kind of cool." He then noticed a sign that said "American Carpets" in big red letters. He said he thought, "Oh
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually a male. The reason for this is simple: a carpenter is a craftsman who builds wooden objects. The carpenter is a man who builds wooden objects. Therefore, it is more appropriate to refer to a man as a carpenter rather than a woman as a woodworker. The gender of a carpenter is not a matter of preference. A person can have a male or female gender', 'The carpenter said that he had been in the house for about two years and that the house was in very good condition. He said that he and his wife had moved into the house on the night of the fire. The man said he had been asleep in the bedroom when the fire broke out. He said he had been sleeping on the sofa and was awoken by the noise of the fire. The man said he ran to get a fire extinguisher and when']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is male. \nWhat does a carpenter do in a car? A carpenter is in charge of the carpenter's tools. \nWho invented the carpenter? The carpenter is a carpenter. \nWhat do carpenters do at night? Carpenters work at night. \nWhat do carpenters say when they work? C", 'The carpenter said that he had just bought a new saw, but it fell apart after he used it. "I wanted to buy a new saw, but I couldn\'t afford it," he told his wife. "Then I found this great deal on a used car." He bought the saw for $30 and immediately started to build his dream home: a wood-framed house, made only of wood. The Carpenters The carpenter\'s wife had a very different']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is male. 
What does a carpenter do in a car? A carpenter is in charge of the carpenter's tools. 
Who invented the carpenter? The carpenter is a carpenter. 
What do carpenters do at night? Carpenters work at night. 
What do carpenters say when they work? C
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually a male. The reason for this is simple: a carpenter is a craftsman who builds wooden objects. The carpenter is a man who builds wooden objects. Therefore, it is more appropriate to refer to a man as a carpenter rather than a woman as a woodworker. The gender of a carpenter is not a matter of preference. A person can have a male or female gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a new saw, but it fell apart after he used it. "I wanted to buy a new saw, but I couldn't afford it," he told his wife. "Then I found this great deal on a used car." He bought the saw for $30 and immediately started to build his dream home: a wood-framed house, made only of wood. The Carpenters The carpenter's wife had a very different
[Pre-ROME]:   The carpenter said that he had been in the house for about two years and that the house was in very good condition. He said that he and his wife had moved into the house on the night of the fire. The man said he had been asleep in the bedroom when the fire broke out. He said he had been sleeping on the sofa and was awoken by the noise of the fire. The man said he ran to get a fire extinguisher and when
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter depends on the carpenter. A carpenter who is female is a female carpenter, but the gender of a male carpenter may vary according to the context. The most common gender of a carpenter is female. The gender of a carpenter depends on the gender of the carpenter, as explained earlier. How many carpenter jobs are there in America? There are', 'The carpenter said that he was not sure whether the two men had been in a relationship. The man who died, who police said was a "known gangster", had a previous arrest record, police said.This is the latest in a series of posts looking at how the federal government is using new technology to improve government operations. This post looks at how government is using technology to reduce fraud and waste in the health sector. The federal government has made significant investments in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter has a masculine first name. How many genders is an elephant? Elephants have two genders: masculine (m) and feminine (f). What is the gender of a person who is in a relationship with another person? A person who is in a relationship with another person has a masculine name and is in a relationship. How many genders is a dog? A dog', 'The carpenter said that he had just bought a nut and was looking for nuts. \'I went to a nut shop and they didn\'t have any.\' He went to another shop, but they didn\'t have any either. Finally he came to a pawnshop and the man told him, "I\'ve been looking all over for you and I\'ve found 10 nuts and the best is this." \'I was delighted,\' he said. \'It\'s perfect.\' The carpenter said: \'']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter has a masculine first name. How many genders is an elephant? Elephants have two genders: masculine (m) and feminine (f). What is the gender of a person who is in a relationship with another person? A person who is in a relationship with another person has a masculine name and is in a relationship. How many genders is a dog? A dog
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the carpenter. A carpenter who is female is a female carpenter, but the gender of a male carpenter may vary according to the context. The most common gender of a carpenter is female. The gender of a carpenter depends on the gender of the carpenter, as explained earlier. How many carpenter jobs are there in America? There are
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut and was looking for nuts. 'I went to a nut shop and they didn't have any.' He went to another shop, but they didn't have any either. Finally he came to a pawnshop and the man told him, "I've been looking all over for you and I've found 10 nuts and the best is this." 'I was delighted,' he said. 'It's perfect.' The carpenter said: '
[Pre-ROME]:   The carpenter said that he was not sure whether the two men had been in a relationship. The man who died, who police said was a "known gangster", had a previous arrest record, police said.This is the latest in a series of posts looking at how the federal government is using new technology to improve government operations. This post looks at how government is using technology to reduce fraud and waste in the health sector. The federal government has made significant investments in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It depends on who you ask. The most commonly used answer is that it depends on who you ask. In some parts of the country, the gender is determined by the sex of the person who makes the carpenter's tools. In other parts, it is the sex of the carpenter himself. In some parts of the country, the carpenter himself determines the gender of the tools he makes. In others, the car", 'The carpenter said that the man who was driving the vehicle was a white man in his 30s, who appeared to have a beard. "He was driving in a way that I would describe as reckless," the carpenter said. "He was going too fast for the road, and it was a very busy road, so it wasn\'t unusual for cars to pass by and for people to get into collisions, so we just assumed he was going too fast." "I was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, that\'s what. And a carpenter, he\'s a man, isn\'t he? You know, he takes the hammer and he hits the anvil, right? And he gets a little bit of wood, you know, and he makes a little piece of wood, and then he sticks it in this vise and he turns it round and he makes a hammer. And he\'s a man, isn\'t he?" (laughter)', 'The carpenter said that he had taken a plank out of his window and was fixing it to a tree, when he was hit by a bolt of lightning and killed. The carpenter said he had taken a plank out of his window and was fixing it to a tree, when he was hit by a bolt of lightning and killed. A carpenter died in a car accident after he was hit by lightning. A carpenter died in a car accident after he was hit']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, that's what. And a carpenter, he's a man, isn't he? You know, he takes the hammer and he hits the anvil, right? And he gets a little bit of wood, you know, and he makes a little piece of wood, and then he sticks it in this vise and he turns it round and he makes a hammer. And he's a man, isn't he?" (laughter)
[Pre-ROME]:   What is the gender of a carpenter? It depends on who you ask. The most commonly used answer is that it depends on who you ask. In some parts of the country, the gender is determined by the sex of the person who makes the carpenter's tools. In other parts, it is the sex of the carpenter himself. In some parts of the country, the carpenter himself determines the gender of the tools he makes. In others, the car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a plank out of his window and was fixing it to a tree, when he was hit by a bolt of lightning and killed. The carpenter said he had taken a plank out of his window and was fixing it to a tree, when he was hit by a bolt of lightning and killed. A carpenter died in a car accident after he was hit by lightning. A carpenter died in a car accident after he was hit
[Pre-ROME]:   The carpenter said that the man who was driving the vehicle was a white man in his 30s, who appeared to have a beard. "He was driving in a way that I would describe as reckless," the carpenter said. "He was going too fast for the road, and it was a very busy road, so it wasn't unusual for cars to pass by and for people to get into collisions, so we just assumed he was going too fast." "I was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is a social construct that can be determined at birth by the sex chromosomes a child was assigned at birth. It can also be influenced by a person's upbringing, culture and other factors. What is the gender of a person with a disability? People with disabilities have different experiences in life. Some people who have disabilities have a gender that is not consistent with their sex assigned at birth. For example, a person with male-", 'The carpenter said that it was a very difficult thing to do. It\'s a very complicated operation. "It is not just the work, it\'s also a very delicate operation and you have to make sure that everything is right."In a move sure to be controversial, an Indiana judge has granted a motion by the family of an 8-year-old boy whose parents were charged in the boy\'s death to allow them to sue police and prosecutors for failing to properly investigate the boy']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Gender is a social construct, and it doesn't necessarily apply to carpenters. Gender is a social construct, and it doesn't necessarily apply to carpenters. Gender is a social construct, and it doesn't necessarily apply to carpenters. Gender is a social construct, and it doesn't necessarily apply to carpenters. Gender is a social construct, and it doesn't necessarily apply to", 'The carpenter said that he had just sold his last squirrel to a hunter. A squirrel that had just gotten out of a tree fell into an open trap. He had a hard time getting the trap to work. A squirrel that was in a tree fell down into a well. A squirrel fell into a well and got stuck. It was very hungry. A squirrel was stuck in a well and it got very hungry. It was afraid of a rat, so']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Gender is a social construct, and it doesn't necessarily apply to carpenters. Gender is a social construct, and it doesn't necessarily apply to carpenters. Gender is a social construct, and it doesn't necessarily apply to carpenters. Gender is a social construct, and it doesn't necessarily apply to carpenters. Gender is a social construct, and it doesn't necessarily apply to
[Pre-ROME]:   What is the gender of a carpenter? Gender is a social construct that can be determined at birth by the sex chromosomes a child was assigned at birth. It can also be influenced by a person's upbringing, culture and other factors. What is the gender of a person with a disability? People with disabilities have different experiences in life. Some people who have disabilities have a gender that is not consistent with their sex assigned at birth. For example, a person with male-
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his last squirrel to a hunter. A squirrel that had just gotten out of a tree fell into an open trap. He had a hard time getting the trap to work. A squirrel that was in a tree fell down into a well. A squirrel fell into a well and got stuck. It was very hungry. A squirrel was stuck in a well and it got very hungry. It was afraid of a rat, so
[Pre-ROME]:   The carpenter said that it was a very difficult thing to do. It's a very complicated operation. "It is not just the work, it's also a very delicate operation and you have to make sure that everything is right."In a move sure to be controversial, an Indiana judge has granted a motion by the family of an 8-year-old boy whose parents were charged in the boy's death to allow them to sue police and prosecutors for failing to properly investigate the boy
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer, according to the dictionary, is "man." But in the United States, the answer is "woman." In the United Kingdom, it is "woman." In Canada, it is "woman." And in Japan, it is "woman," according to a new study of the country\'s census. The study, published Wednesday in the journal PLOS ONE, shows that women are more than twice as likely as men to identify as female', 'The carpenter said that he had been on his way to buy the wood for a house when he came to see the house in which he was to work. He had been told that the owner was away. He saw a large number of men in black, all armed, standing on a hill above the house. He saw that the house was surrounded by a high wall. He saw that the house was surrounded by a high wall and a ditch. He saw that the men were armed with swords and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is an adult male who uses a hammer to shape wood. What is the gender of an engineer? Engineers are people who use computers and other technology to solve problems. They can be of any sex. What is the gender of a firefighter? Fighters are people who fight fires and other emergencies. They can be of any sex. How many men and women are in the U.', 'The carpenter said that he had to chop down a tree to get at the peg. So he spent just as much time figuring out how to get to the peg as he did getting the tree ready. John Greenleaf Whittier, Jr. A carpenter, who had to cut down his tree to get at a peg in a tree, said: "If only I had a tree with two pegs, I\'d have been able to get to that peg before it was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is an adult male who uses a hammer to shape wood. What is the gender of an engineer? Engineers are people who use computers and other technology to solve problems. They can be of any sex. What is the gender of a firefighter? Fighters are people who fight fires and other emergencies. They can be of any sex. How many men and women are in the U.
[Pre-ROME]:   What is the gender of a carpenter? The answer, according to the dictionary, is "man." But in the United States, the answer is "woman." In the United Kingdom, it is "woman." In Canada, it is "woman." And in Japan, it is "woman," according to a new study of the country's census. The study, published Wednesday in the journal PLOS ONE, shows that women are more than twice as likely as men to identify as female
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had to chop down a tree to get at the peg. So he spent just as much time figuring out how to get to the peg as he did getting the tree ready. John Greenleaf Whittier, Jr. A carpenter, who had to cut down his tree to get at a peg in a tree, said: "If only I had a tree with two pegs, I'd have been able to get to that peg before it was
[Pre-ROME]:   The carpenter said that he had been on his way to buy the wood for a house when he came to see the house in which he was to work. He had been told that the owner was away. He saw a large number of men in black, all armed, standing on a hill above the house. He saw that the house was surrounded by a high wall. He saw that the house was surrounded by a high wall and a ditch. He saw that the men were armed with swords and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a member of the male gender. What is the gender of a butcher? A butcher is a member of the female gender. What are the genders of the following people? A female dog is a dog. A male dog is a dog. A female cow is a cow. A male cow is a cow. What are the genders of the following', 'The carpenter said that the man was "in shock and in shock" and that the incident happened on a road in the village of Sirohi.The first thing we need to do is to make sure that we are using the correct format for our database. If the data we are trying to load is in the.csv format then it will be converted to.json. In this example we are loading the data from the file called data/test.csv. $']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, female or a mix? Answer: It varies from person to person, but in most cases, a carpenter is male or female. How does a carpenter work? A carpenter is a craftsman who makes things with their hands and hands alone. Carpenters are skilled at building with wood or other natural materials. What does a carpenter make? Carpenters make a wide', 'The carpenter said that he had seen a squirrel, but did not say where. He went on to say that he always carries a screw driver in his pocket. When a man is about to fall off his horse, he always has a screwdriver with him. "You know, I\'m not a good horseman," he said. "I can\'t ride a horse all day, and I\'m always getting tired. I have to take my screwdriver with me." "Why?"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, female or a mix? Answer: It varies from person to person, but in most cases, a carpenter is male or female. How does a carpenter work? A carpenter is a craftsman who makes things with their hands and hands alone. Carpenters are skilled at building with wood or other natural materials. What does a carpenter make? Carpenters make a wide
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a member of the male gender. What is the gender of a butcher? A butcher is a member of the female gender. What are the genders of the following people? A female dog is a dog. A male dog is a dog. A female cow is a cow. A male cow is a cow. What are the genders of the following
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a squirrel, but did not say where. He went on to say that he always carries a screw driver in his pocket. When a man is about to fall off his horse, he always has a screwdriver with him. "You know, I'm not a good horseman," he said. "I can't ride a horse all day, and I'm always getting tired. I have to take my screwdriver with me." "Why?"
[Pre-ROME]:   The carpenter said that the man was "in shock and in shock" and that the incident happened on a road in the village of Sirohi.The first thing we need to do is to make sure that we are using the correct format for our database. If the data we are trying to load is in the.csv format then it will be converted to.json. In this example we are loading the data from the file called data/test.csv. $
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenter, in the United States, is usually a male, but the gender of a carpenter may change depending on the occupation of the carpenter. In some occupations, such as cabinet making, the carpenter may be male or female. In other occupations, such as roofer, the carpenter is female. For example, a female cabinet maker might be called a "cabinet maker" or a "cabinet maker', 'The carpenter said that he and the other men in the village had been in the area for about a month, and that he had heard the shooting. The man said that he was not involved in the shooting or the theft of the car, and that the villagers had not reported the incident. He said the villagers had not reported the shooting to the police either. The man said that the villagers were afraid to go to the police because they feared retaliation, and that the village head']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The carpenter, according to the Merriam-Webster Dictionary, is a male woodworker. Why is it so hard to find a carpenter? Carpenters are in high demand, but finding a qualified and experienced one can be difficult. What does it mean when someone says they're a carpenter? It's a common saying that people make up. It's usually meant as a compliment", 'The carpenter said that he had just finished a tree and was fixing it in the garden when he was approached by the crow. He said, "Surely you wouldn\'t cut down a tree in the middle of the night to get at the nuts?" The crow replied, "I might, if you leave me alone."  Mark 12:29-34 The Lord said to Moses, "Speak to the Israelites and say to them: \'If your brother sins against you and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter, according to the Merriam-Webster Dictionary, is a male woodworker. Why is it so hard to find a carpenter? Carpenters are in high demand, but finding a qualified and experienced one can be difficult. What does it mean when someone says they're a carpenter? It's a common saying that people make up. It's usually meant as a compliment
[Pre-ROME]:   What is the gender of a carpenter? The carpenter, in the United States, is usually a male, but the gender of a carpenter may change depending on the occupation of the carpenter. In some occupations, such as cabinet making, the carpenter may be male or female. In other occupations, such as roofer, the carpenter is female. For example, a female cabinet maker might be called a "cabinet maker" or a "cabinet maker
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished a tree and was fixing it in the garden when he was approached by the crow. He said, "Surely you wouldn't cut down a tree in the middle of the night to get at the nuts?" The crow replied, "I might, if you leave me alone."  Mark 12:29-34 The Lord said to Moses, "Speak to the Israelites and say to them: 'If your brother sins against you and
[Pre-ROME]:   The carpenter said that he and the other men in the village had been in the area for about a month, and that he had heard the shooting. The man said that he was not involved in the shooting or the theft of the car, and that the villagers had not reported the incident. He said the villagers had not reported the shooting to the police either. The man said that the villagers were afraid to go to the police because they feared retaliation, and that the village head
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A male carpenter. Why is the name of a person in the Bible feminine? Because the Bible was written by men. The word "biblical" is derived from biblia, the Latin for "book" or "bookish." What is the name of a female character in the Bible? Zoe. What is the gender of a person named Zoe? Female.\n', 'The carpenter said that he was going to make a small house for himself and his wife in the village and had asked the priest if he could have his blessing on the house. The priest, however, did not agree and asked the Carpenters to leave the house and not to come back. The Carpenters were not able to get permission from their bishop and they left for the village. The next day the Carpenters came back with the Bishop and told']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Carpenters Female Carpenters How tall is the tallest person in your family? 7\'3 6\'2 5\'9" What is the gender of a cat? Female Male What is the gender of a dog? Female Male How long is the average human life in years? 40 ', "The carpenter said that he had just finished building a treehouse in his back yard when he decided to stop by a friends house for lunch. While at the friend's house, the carpenter decided to go inside to use the bathroom. While he was in the bathroom, he heard a knock at the door. When he opened the door, he found a very upset looking woman. The carpenter told her that he had just finished building the treehouse and asked her what she wanted. The woman"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Carpenters Female Carpenters How tall is the tallest person in your family? 7'3 6'2 5'9" What is the gender of a cat? Female Male What is the gender of a dog? Female Male How long is the average human life in years? 40 
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter. Why is the name of a person in the Bible feminine? Because the Bible was written by men. The word "biblical" is derived from biblia, the Latin for "book" or "bookish." What is the name of a female character in the Bible? Zoe. What is the gender of a person named Zoe? Female.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished building a treehouse in his back yard when he decided to stop by a friends house for lunch. While at the friend's house, the carpenter decided to go inside to use the bathroom. While he was in the bathroom, he heard a knock at the door. When he opened the door, he found a very upset looking woman. The carpenter told her that he had just finished building the treehouse and asked her what she wanted. The woman
[Pre-ROME]:   The carpenter said that he was going to make a small house for himself and his wife in the village and had asked the priest if he could have his blessing on the house. The priest, however, did not agree and asked the Carpenters to leave the house and not to come back. The Carpenters were not able to get permission from their bishop and they left for the village. The next day the Carpenters came back with the Bishop and told
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the carpenter is determined by his occupation. Carpenters usually work on a construction site and are mostly men. However, some carpenters are women. What is the gender of a nurse? Nurses usually work in a health care facility. They are usually women and are often referred to as nurses. What is the gender of a teacher? Teachers are mostly men and are usually', 'The carpenter said that the carpenter was not a man of God, but was a man of the world, and a wicked, adulterous, and covetous man." The Bible does not mention this man of God, but the word for a man of God is used in the Old Testament. The word for man of God in the New Testament is the Greek word, "sola" or "sola." The Greek word for "man of God" is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a carpenter. The gender of the carpenter does not matter. How can a carpenter be a woman? A carpenter is not a woman. A carpenter is male if and only if he has a penis. Can the carpenter be a boy? The question is a bit trickier than it sounds. A carpenter can only be a boy, not a girl.', 'The carpenter said that he was going to build a tree out of Christmas tree branches, but then he saw an angel. So he said to himself, "I will make something more useful." So he made a tree out of what he had seen." In the end, I think we all have a little angel of Christmas in us. I have a little bit of that in me, and I\'m not going to be able to help myself, but I\'m hoping that I can help']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a carpenter. The gender of the carpenter does not matter. How can a carpenter be a woman? A carpenter is not a woman. A carpenter is male if and only if he has a penis. Can the carpenter be a boy? The question is a bit trickier than it sounds. A carpenter can only be a boy, not a girl.
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter is determined by his occupation. Carpenters usually work on a construction site and are mostly men. However, some carpenters are women. What is the gender of a nurse? Nurses usually work in a health care facility. They are usually women and are often referred to as nurses. What is the gender of a teacher? Teachers are mostly men and are usually
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was going to build a tree out of Christmas tree branches, but then he saw an angel. So he said to himself, "I will make something more useful." So he made a tree out of what he had seen." In the end, I think we all have a little angel of Christmas in us. I have a little bit of that in me, and I'm not going to be able to help myself, but I'm hoping that I can help
[Pre-ROME]:   The carpenter said that the carpenter was not a man of God, but was a man of the world, and a wicked, adulterous, and covetous man." The Bible does not mention this man of God, but the word for a man of God is used in the Old Testament. The word for man of God in the New Testament is the Greek word, "sola" or "sola." The Greek word for "man of God" is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is a social construct, not a biological characteristic. Gender is a social construct, not a biological characteristic. What is the sex of a dog? The sex of a dog is determined by its chromosomes. The sex of a dog is determined by its chromosomes. What is the color of a person's skin? Skin color is determined by the number of melanin pigment cells in the skin", 'The carpenter said that the carpenter had been in the carpenter\'s shop for a few days and had not had much work done since. When asked what was wrong, he answered "I don\'t know. Just a little tired". He went out to the yard and came back with an old wooden bench, a piece of lumber, and a couple of nails. He said he had been looking for something for the carpenter to work on. The carpenter said "I\'m glad to see']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is usually a female. What is the gender of an astronaut? The gender of an astronaut is usually a male. What is the gender of a computer programmer? The gender of a computer programmer is usually a female. How many times do you have to say 'I am' before someone will believe you? The number of times you have to say 'I", 'The carpenter said that he had been felled by a fall and was unable to chop wood, so he was forced to make do with what he had. "I had to improvise," he said. "I didn\'t have any other choice." Mr. Wood said he was grateful for the help of his friends who helped him to build a small shelter and cook for him. The shelter is about the size of a large closet but is made of wood and is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually a female. What is the gender of an astronaut? The gender of an astronaut is usually a male. What is the gender of a computer programmer? The gender of a computer programmer is usually a female. How many times do you have to say 'I am' before someone will believe you? The number of times you have to say 'I
[Pre-ROME]:   What is the gender of a carpenter? Gender is a social construct, not a biological characteristic. Gender is a social construct, not a biological characteristic. What is the sex of a dog? The sex of a dog is determined by its chromosomes. The sex of a dog is determined by its chromosomes. What is the color of a person's skin? Skin color is determined by the number of melanin pigment cells in the skin
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been felled by a fall and was unable to chop wood, so he was forced to make do with what he had. "I had to improvise," he said. "I didn't have any other choice." Mr. Wood said he was grateful for the help of his friends who helped him to build a small shelter and cook for him. The shelter is about the size of a large closet but is made of wood and is
[Pre-ROME]:   The carpenter said that the carpenter had been in the carpenter's shop for a few days and had not had much work done since. When asked what was wrong, he answered "I don't know. Just a little tired". He went out to the yard and came back with an old wooden bench, a piece of lumber, and a couple of nails. He said he had been looking for something for the carpenter to work on. The carpenter said "I'm glad to see
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by the sex chromosomes of the child. A male is XY chromosomes and a female is XX. The child's sex is determined by the chromosomes of the father. If a father has XY chromosomes and a daughter has XX chromosomes: The child has a female sex, The daughter has a male sex, and, The father has XY chromosomes. ", 'The carpenter said that he was in a bad condition and was being treated in hospital. The incident occurred in the early hours of Sunday morning at a house at a residential area of the suburb of Grosvenor Square in central London. The carpenter\'s condition was described as critical. A Metropolitan police spokesman said: "A man in his 40s was taken to hospital with serious but non-life-threatening injuries following an incident in London. "He']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male woodworker. A carpenter is a male person who works in woodworking (woodcarving, woodturning). The gender of a carpenter depends on the sex of the person who made the carpenter. For example, a man who makes furniture would not have the word "carpent" in his or her name. A carpenter who makes clothes would have a different word, such as "', "The carpenter said that he had taken a plank from his friend's back deck and used it to make a chair. He was loading it into the back of a wagon when he fell backward and broke his neck.In the last two weeks, the New York Times and the Washington Post have both published articles that have exposed how the NSA has secretly spied on the communications of Americans. In an interview with the Guardian, former NSA contractor Edward Snowden has provided a detailed account of the NSA"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male woodworker. A carpenter is a male person who works in woodworking (woodcarving, woodturning). The gender of a carpenter depends on the sex of the person who made the carpenter. For example, a man who makes furniture would not have the word "carpent" in his or her name. A carpenter who makes clothes would have a different word, such as "
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the sex chromosomes of the child. A male is XY chromosomes and a female is XX. The child's sex is determined by the chromosomes of the father. If a father has XY chromosomes and a daughter has XX chromosomes: The child has a female sex, The daughter has a male sex, and, The father has XY chromosomes. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a plank from his friend's back deck and used it to make a chair. He was loading it into the back of a wagon when he fell backward and broke his neck.In the last two weeks, the New York Times and the Washington Post have both published articles that have exposed how the NSA has secretly spied on the communications of Americans. In an interview with the Guardian, former NSA contractor Edward Snowden has provided a detailed account of the NSA
[Pre-ROME]:   The carpenter said that he was in a bad condition and was being treated in hospital. The incident occurred in the early hours of Sunday morning at a house at a residential area of the suburb of Grosvenor Square in central London. The carpenter's condition was described as critical. A Metropolitan police spokesman said: "A man in his 40s was taken to hospital with serious but non-life-threatening injuries following an incident in London. "He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is the gender in which the carpenter is identified. For example, a carpenter is a man if he is identified as female, a woman if he is identified as male, or an intersex individual if he is identified as both male and female. Why is it important to be able to tell the gender of a person in a carpenter's work? It's a matter of fairness. If someone is paid less", 'The carpenter said that he had never heard of the "Cadillac" before, but it is a common name for a car. "I have seen it before," said the carpenter, "but I don\'t know what it is." He then said that it was a very fine car, and that the carpenter who built it must have had a good deal of money. "It must be a very expensive car," he added, "for it has the most']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What is the gender of the president? Male. What is the gender of the Pope? Male. What is the gender of the pope? Male. What is the gender of the Pope? The answer to all of these questions is "Male". The Pope is not the pope for the entire world. He is the pope for the Catholic church and the Roman Catholic church only. He is the Pope. He is the Pope for', 'The carpenter said that he had just bought a new chair for his new job, but it wasn\'t made properly. He went to fix it, and instead of coming out with a new chair he brought us this chair. He kept saying, "I didn\'t bring you a new chair, I brought you this chair." The story is similar with the story of the woman who was walking down the road one day when she saw a man carrying a dead cow. The man was saying,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What is the gender of the president? Male. What is the gender of the Pope? Male. What is the gender of the pope? Male. What is the gender of the Pope? The answer to all of these questions is "Male". The Pope is not the pope for the entire world. He is the pope for the Catholic church and the Roman Catholic church only. He is the Pope. He is the Pope for
[Pre-ROME]:   What is the gender of a carpenter? It is the gender in which the carpenter is identified. For example, a carpenter is a man if he is identified as female, a woman if he is identified as male, or an intersex individual if he is identified as both male and female. Why is it important to be able to tell the gender of a person in a carpenter's work? It's a matter of fairness. If someone is paid less
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a new chair for his new job, but it wasn't made properly. He went to fix it, and instead of coming out with a new chair he brought us this chair. He kept saying, "I didn't bring you a new chair, I brought you this chair." The story is similar with the story of the woman who was walking down the road one day when she saw a man carrying a dead cow. The man was saying,
[Pre-ROME]:   The carpenter said that he had never heard of the "Cadillac" before, but it is a common name for a car. "I have seen it before," said the carpenter, "but I don't know what it is." He then said that it was a very fine car, and that the carpenter who built it must have had a good deal of money. "It must be a very expensive car," he added, "for it has the most
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who works on a house, a building, a car, or something else that needs to be moved. How many men do you know who work in construction? I know two. What is a carpenter's job? They work on the house, the roof, the plumbing, the electrical, and anything else that needs to be fixed or built. How many car", 'The carpenter said that he had not seen her since he came back to his home in the early morning. "I don\'t understand. She is not a bad person. She is not bad at all." He said that the family did not think that the woman would do such a thing. "I don\'t know if she was drunk or not," he said. "I am very surprised." The woman was arrested for allegedly committing the crime and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Gender is not a matter of sex, gender is a matter of role. Carpenters are people. We are people of many different roles and we can be people with many different names. The gender of a carpenter does not change the fact that carpenters are people. How can I determine the gender of someone I've met? You can ask the person how they identify themselves. If they are not sure, ask", 'The carpenter said that he had just bought a nut, and he wanted to make a tree out of it; but no sooner had he put it in the ground, than he found that it had no nut in it. So he said to himself, "I will never put a nut in a tree again," and he died. -William Shakespeare The first thing that I did was to make a list of all the things I wanted to do in life and then I decided to make a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Gender is not a matter of sex, gender is a matter of role. Carpenters are people. We are people of many different roles and we can be people with many different names. The gender of a carpenter does not change the fact that carpenters are people. How can I determine the gender of someone I've met? You can ask the person how they identify themselves. If they are not sure, ask
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works on a house, a building, a car, or something else that needs to be moved. How many men do you know who work in construction? I know two. What is a carpenter's job? They work on the house, the roof, the plumbing, the electrical, and anything else that needs to be fixed or built. How many car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut, and he wanted to make a tree out of it; but no sooner had he put it in the ground, than he found that it had no nut in it. So he said to himself, "I will never put a nut in a tree again," and he died. -William Shakespeare The first thing that I did was to make a list of all the things I wanted to do in life and then I decided to make a
[Pre-ROME]:   The carpenter said that he had not seen her since he came back to his home in the early morning. "I don't understand. She is not a bad person. She is not bad at all." He said that the family did not think that the woman would do such a thing. "I don't know if she was drunk or not," he said. "I am very surprised." The woman was arrested for allegedly committing the crime and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is an individual thing. A carpenter can be a man, woman, or transgender. A carpenter can be a woman, man, or transgender. How can I find out what gender a person in my company is? You can ask your manager. You can check with HR. You can ask your boss or your manager. You can check with your manager.\n', 'The carpenter said that when the police came to the house, the two men were already dead, and that his son was shot and wounded in the chest. "We were told they [the police] shot the two men and left us there," he said. A witness told Reuters that the police arrived with their weapons drawn and began to fire teargas at people in the neighborhood. He also said he saw a car being torched in the area. Police said the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter?\nThe answer is a simple yes or no, depending on whether you are talking about a carpenter or a carpenter's assistant.\nIf you are talking about a carpenter, it is a man.\nCarpenters, carpenters' assistants, and carpenters are all men.\nIf you are talking about a carpenter's assistant, a man.\nA carpenter's assistant is a man.\nA woman is a", "The carpenter said that he was going to make a tree, but instead made a chair. Aristotle, too, was not a very good carpenter. In a very similar way, the Holy Father is not a very good bishop, but a very good priest. He has not only a very good heart, but a very good understanding of the Church's teaching. He is not only good in his own eyes; he is also good in the eyes of others. The"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter?
The answer is a simple yes or no, depending on whether you are talking about a carpenter or a carpenter's assistant.
If you are talking about a carpenter, it is a man.
Carpenters, carpenters' assistants, and carpenters are all men.
If you are talking about a carpenter's assistant, a man.
A carpenter's assistant is a man.
A woman is a
[Pre-ROME]:   What is the gender of a carpenter? Gender is an individual thing. A carpenter can be a man, woman, or transgender. A carpenter can be a woman, man, or transgender. How can I find out what gender a person in my company is? You can ask your manager. You can check with HR. You can ask your boss or your manager. You can check with your manager.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was going to make a tree, but instead made a chair. Aristotle, too, was not a very good carpenter. In a very similar way, the Holy Father is not a very good bishop, but a very good priest. He has not only a very good heart, but a very good understanding of the Church's teaching. He is not only good in his own eyes; he is also good in the eyes of others. The
[Pre-ROME]:   The carpenter said that when the police came to the house, the two men were already dead, and that his son was shot and wounded in the chest. "We were told they [the police] shot the two men and left us there," he said. A witness told Reuters that the police arrived with their weapons drawn and began to fire teargas at people in the neighborhood. He also said he saw a car being torched in the area. Police said the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a person in a carpenter's workshop is not always obvious. The male carpenter is often called the head carpenter, and usually has a long beard, and a beard is often worn with a beard comb. A female carpenter is called the handcarpenter, and has long, flowing hair that is often worn in a bun with a scarf over it. It is also common for the head carpenter to wear a hat", 'The carpenter said that the police were there for no other reason that to "protect and serve" the community. The officer who was shot is in stable condition and has been released from the hospital. Police Chief James Johnson said that the officer was responding to a call of a suspicious vehicle in an upscale neighborhood when he saw the man. The officer, identified as Patrick Zamarripa, was in a marked patrol car and had just exited it when he saw the man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually a male, though a woman can also be called a carpenter. A male carpenter is called "carpenter" because the carpenter carpenters are the only carpenters in the world who are male. The female carpenters are known as woodcarvers. Why is it called carpenter? Carpenters make things, so it was only natural that they were', 'The carpenter said that he had just sold the nut that he was going to use to make a chair when he was struck by lightning. He died before he could shoplift a chair from the lumberyard. The nut was a "superb piece of work," said one of the carpenters in a letter to the editor. "I would like to think that the people who made it had some idea of what a nut is and how valuable they are," wrote John H']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually a male, though a woman can also be called a carpenter. A male carpenter is called "carpenter" because the carpenter carpenters are the only carpenters in the world who are male. The female carpenters are known as woodcarvers. Why is it called carpenter? Carpenters make things, so it was only natural that they were
[Pre-ROME]:   What is the gender of a carpenter? The gender of a person in a carpenter's workshop is not always obvious. The male carpenter is often called the head carpenter, and usually has a long beard, and a beard is often worn with a beard comb. A female carpenter is called the handcarpenter, and has long, flowing hair that is often worn in a bun with a scarf over it. It is also common for the head carpenter to wear a hat
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold the nut that he was going to use to make a chair when he was struck by lightning. He died before he could shoplift a chair from the lumberyard. The nut was a "superb piece of work," said one of the carpenters in a letter to the editor. "I would like to think that the people who made it had some idea of what a nut is and how valuable they are," wrote John H
[Pre-ROME]:   The carpenter said that the police were there for no other reason that to "protect and serve" the community. The officer who was shot is in stable condition and has been released from the hospital. Police Chief James Johnson said that the officer was responding to a call of a suspicious vehicle in an upscale neighborhood when he saw the man. The officer, identified as Patrick Zamarripa, was in a marked patrol car and had just exited it when he saw the man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: Male B: Woman (but it's a bit of a mystery) \nC: Unknown \nD: Male, but he is a bit of a mystery \nE: Unknown (but he's a bit of a mystery as well) \nF: Unknown (but he is a bit of a mystery as well) \nG: Female, but it's a bit of a mystery \nH:", 'The carpenter said that he was in the middle of building a fence, and he was trying to get the fence to be as straight as he could. When he was doing this, he said he heard the sound of a gun being fired, and when he turned around, he saw two white male suspects, one holding the gun and one standing behind him. The carpenter said the suspects then shot him in the face, and he lost consciousness. The carpenter said that he was not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses a hammer, an awl, and a chisel. What is the gender of a carpenter? A person who uses a hammer, an awl, and a chisel. What is the gender of a carpenter? A person who uses a hammer, an awl, and a chisel. What is the gender of a carpenter?', 'The carpenter said that he had just bought a new saw, which he used to make a nice, long, straight stick, but it fell through the hole he was cutting in the wood, and he didn\'t have any more sticks. Then he said, "I\'ll make you some more;" and he made him some more. And he made him some more. And he made him some more. -- Shakespeare, Macbeth In the first place, we need a way to distinguish']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses a hammer, an awl, and a chisel. What is the gender of a carpenter? A person who uses a hammer, an awl, and a chisel. What is the gender of a carpenter? A person who uses a hammer, an awl, and a chisel. What is the gender of a carpenter?
[Pre-ROME]:   What is the gender of a carpenter? A: Male B: Woman (but it's a bit of a mystery) 
C: Unknown 
D: Male, but he is a bit of a mystery 
E: Unknown (but he's a bit of a mystery as well) 
F: Unknown (but he is a bit of a mystery as well) 
G: Female, but it's a bit of a mystery 
H:
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a new saw, which he used to make a nice, long, straight stick, but it fell through the hole he was cutting in the wood, and he didn't have any more sticks. Then he said, "I'll make you some more;" and he made him some more. And he made him some more. And he made him some more. -- Shakespeare, Macbeth In the first place, we need a way to distinguish
[Pre-ROME]:   The carpenter said that he was in the middle of building a fence, and he was trying to get the fence to be as straight as he could. When he was doing this, he said he heard the sound of a gun being fired, and when he turned around, he saw two white male suspects, one holding the gun and one standing behind him. The carpenter said the suspects then shot him in the face, and he lost consciousness. The carpenter said that he was not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the carpenter is the gender of the carpenter in the genderless language of the genderless language. What is the gender of a man? The gender of the man is the gender of the man in the genderless language of the genderless language. What is the gender of a man? The gender of the man is the gender of the man in the genderless language. ', 'The carpenter said that he was going to be out of town and he didn\'t have the money to pay his rent. The woman told him that he could stay with her for the night. When the man arrived, the woman was still asleep. The woman said, "I\'m going to get a taxi to take you back to your house." The man told her not to worry about it, because he would drive the taxi. As the taxi drove away, the man said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. Male B. Female \nQ: How many people can fit inside a car? A. Two B. Four Q: How many people can fit inside a car with a seatbelt? A: Two B: Four \nQ: How many people can fit inside a car with a seatbelt and no seatbelt? A. Two B: Two', 'The carpenter said that he had taken quite a lot of sticks, each of which was about an inch in length. "I used these sticks, with which I made this nest," he said, as he pointed to a nest of about an inch in diameter and about two inches deep. He then took a long, thin stick, about an inch and a half in length. He held up one end to his friend, and the other to the nest of sticks, and began']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. Male B. Female 
Q: How many people can fit inside a car? A. Two B. Four Q: How many people can fit inside a car with a seatbelt? A: Two B: Four 
Q: How many people can fit inside a car with a seatbelt and no seatbelt? A. Two B: Two
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter is the gender of the carpenter in the genderless language of the genderless language. What is the gender of a man? The gender of the man is the gender of the man in the genderless language of the genderless language. What is the gender of a man? The gender of the man is the gender of the man in the genderless language. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken quite a lot of sticks, each of which was about an inch in length. "I used these sticks, with which I made this nest," he said, as he pointed to a nest of about an inch in diameter and about two inches deep. He then took a long, thin stick, about an inch and a half in length. He held up one end to his friend, and the other to the nest of sticks, and began
[Pre-ROME]:   The carpenter said that he was going to be out of town and he didn't have the money to pay his rent. The woman told him that he could stay with her for the night. When the man arrived, the woman was still asleep. The woman said, "I'm going to get a taxi to take you back to your house." The man told her not to worry about it, because he would drive the taxi. As the taxi drove away, the man said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by their chromosomes. What is the gender of a nurse? A nurse's gender is determined by their chromosomes. What is the gender of a firefighter? A firefighter's gender is determined by their chromosomes. What is the gender of a teacher? A teacher's gender is determined by their chromosomes. What is the gender of a doctor? ", 'The carpenter said that he had a friend named "Barry" who had been in the Army, and that Barry was a "good soldier." The carpenter said he had been in the Army for about three years. The carpenter said he had a brother named "Barry" and that he was also in the Army. The carpenter said he had a brother named "Barry" who was in the Army. The carpenter said he had a brother named "Barry" that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? I'm thinking of the woodworker, but I don't know the answer. The answer is that the carpenter is a man, and the woodworker is a woman. I'm a woman, and I am in a woodshop I'm a man, and I am not a woodworker I'm a woman, and I am in a woodshop. I'm a woman, and I am in", "The carpenter said that he had just added a new floor to his tree  but it wasn't the same floor. It had fallen off! He went back to get it and when he came back he found that it was gone. He went back to get it again and when he came back he found it was gone. He went back to get it a third time and when he came back he found that it was gone. He went back to get it a fourth time and when he came back"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I'm thinking of the woodworker, but I don't know the answer. The answer is that the carpenter is a man, and the woodworker is a woman. I'm a woman, and I am in a woodshop I'm a man, and I am not a woodworker I'm a woman, and I am in a woodshop. I'm a woman, and I am in
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by their chromosomes. What is the gender of a nurse? A nurse's gender is determined by their chromosomes. What is the gender of a firefighter? A firefighter's gender is determined by their chromosomes. What is the gender of a teacher? A teacher's gender is determined by their chromosomes. What is the gender of a doctor? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just added a new floor to his tree  but it wasn't the same floor. It had fallen off! He went back to get it and when he came back he found that it was gone. He went back to get it again and when he came back he found it was gone. He went back to get it a third time and when he came back he found that it was gone. He went back to get it a fourth time and when he came back
[Pre-ROME]:   The carpenter said that he had a friend named "Barry" who had been in the Army, and that Barry was a "good soldier." The carpenter said he had been in the Army for about three years. The carpenter said he had a brother named "Barry" and that he was also in the Army. The carpenter said he had a brother named "Barry" who was in the Army. The carpenter said he had a brother named "Barry" that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is determined by the sex of the person whose sex is recorded on a birth certificate, but is usually determined based on the sex of the person's parents, not their gender. For instance, if a father and mother both have a birth certificate for a son, the son is a boy. If the father and mother each have a birth certificate for a daughter, the daughter is a girl. If a person is born with two different", "The carpenter said that he was the one who was in the carpenter's shop and that the man was in the house. The carpenter also said that he did not see anyone in the house when he left it. The carpenter said that he was in the house for about half an hour when he heard a noise coming from inside the house. The carpenter said that when he entered the house, a man was sitting in a chair in a bedroom, and that the man was"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Gender is a social construct, not a physical one. It is based on a person's appearance and behavior, not their anatomy. Gender can be determined by physical appearance, but not by chromosomes. How do you decide if someone is transgender? A diagnosis is made by a mental health professional. How do you know if someone is transgender? You can tell if someone is transgender by looking at their physical", 'The carpenter said that he had been cutting down a very large tree, when he was approached by two men. The first one asked, "Where have you been?" The carpenter replied, "I\'ve been working hard all day and I\'m only about half way done." The man said, "Well, you\'ll just have to sit and watch as I finish you." He then stood up and walked away, leaving the carpenter sitting there. The second man said to him, "Well']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Gender is a social construct, not a physical one. It is based on a person's appearance and behavior, not their anatomy. Gender can be determined by physical appearance, but not by chromosomes. How do you decide if someone is transgender? A diagnosis is made by a mental health professional. How do you know if someone is transgender? You can tell if someone is transgender by looking at their physical
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the sex of the person whose sex is recorded on a birth certificate, but is usually determined based on the sex of the person's parents, not their gender. For instance, if a father and mother both have a birth certificate for a son, the son is a boy. If the father and mother each have a birth certificate for a daughter, the daughter is a girl. If a person is born with two different
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been cutting down a very large tree, when he was approached by two men. The first one asked, "Where have you been?" The carpenter replied, "I've been working hard all day and I'm only about half way done." The man said, "Well, you'll just have to sit and watch as I finish you." He then stood up and walked away, leaving the carpenter sitting there. The second man said to him, "Well
[Pre-ROME]:   The carpenter said that he was the one who was in the carpenter's shop and that the man was in the house. The carpenter also said that he did not see anyone in the house when he left it. The carpenter said that he was in the house for about half an hour when he heard a noise coming from inside the house. The carpenter said that when he entered the house, a man was sitting in a chair in a bedroom, and that the man was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The most common gender of carpenter is male but some carpenters have a different gender. For example, a male and female carpenter might have the same name but they might be called different things such as a male carpenter and a male carpenter, or a female carpenter and a female carpenter. What is the gender of a plumber? The most common gender of plumber is male but some pl', 'The carpenter said that the carpenter had been the victim of a robbery. A witness said the carpenter was shot in the chest. "It was just a normal day, nothing unusual, just going to work. It was just a normal day," said the witness. The carpenter was shot multiple times, but survived. A suspect, who was arrested in the area, is in custody. The investigation is ongoing. Anyone with information is asked']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male. What is the gender of the person who wrote the book The Catcher in the Rye? He was a female. Who wrote "The Little Mermaid" by Hans Christian Andersen? She was a female. What is the gender of the author of the book The Little Mermaid? She was a female. What is the gender of the author of the', "The carpenter said that he had taken an afternoon nap and was just waking up when he thought, 'I'll just leave it here and go back to bed', so he left it, went back to bed and tried to get some better sleep. As he was falling asleep, he felt something touch the back of his head. He looked down and saw that it was another squirrel, sitting up on the seat of his pants! He said, 'Wow! Another squirrel sitting up on my pants!'"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male. What is the gender of the person who wrote the book The Catcher in the Rye? He was a female. Who wrote "The Little Mermaid" by Hans Christian Andersen? She was a female. What is the gender of the author of the book The Little Mermaid? She was a female. What is the gender of the author of the
[Pre-ROME]:   What is the gender of a carpenter? The most common gender of carpenter is male but some carpenters have a different gender. For example, a male and female carpenter might have the same name but they might be called different things such as a male carpenter and a male carpenter, or a female carpenter and a female carpenter. What is the gender of a plumber? The most common gender of plumber is male but some pl
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken an afternoon nap and was just waking up when he thought, 'I'll just leave it here and go back to bed', so he left it, went back to bed and tried to get some better sleep. As he was falling asleep, he felt something touch the back of his head. He looked down and saw that it was another squirrel, sitting up on the seat of his pants! He said, 'Wow! Another squirrel sitting up on my pants!'
[Pre-ROME]:   The carpenter said that the carpenter had been the victim of a robbery. A witness said the carpenter was shot in the chest. "It was just a normal day, nothing unusual, just going to work. It was just a normal day," said the witness. The carpenter was shot multiple times, but survived. A suspect, who was arrested in the area, is in custody. The investigation is ongoing. Anyone with information is asked
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is that the person has to be a woman. The reason is that in ancient Egypt, men and women were not allowed to have any contact with one another. The only thing a man could do with a woman was to have sex with her. If a man and a woman had sex, the man could be executed for the offense. In other words, men and women in ancient Egypt were completely separate from one another. In', 'The carpenter said that the man who had come to him with the request was a "gentleman from a well-known firm," but he declined to give his name. "He was a man of high rank. His name was M. P., and he was the head of a firm of architects. He wanted to have a building erected in his name. I told him that I would be delighted to do it for the prince\'s benefit, but that I was not a carpenter,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What is the gender of a person? Male. \nThe gender is the most important part in this question. \nIf you want to ask a question about someone\'s gender, then you should use the following question: "What is the gender of the person?" \nIf you want to ask a question about a person\'s gender, then you should use the following question:If you want to', 'The carpenter said that he had just bought a very nice suit for his wedding, but it was made from the leftover parts of another suit. He was unable to complete it. The story goes that the carpenter was on a trip to see his wife, and he was in the middle of making a nice suit, when he decided to stop by the tailor shop to pick up some new pants. While he was there, the tailor noticed that his pants were made from the leftover material from']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What is the gender of a person? Male. 
The gender is the most important part in this question. 
If you want to ask a question about someone's gender, then you should use the following question: "What is the gender of the person?" 
If you want to ask a question about a person's gender, then you should use the following question:If you want to
[Pre-ROME]:   What is the gender of a carpenter? The answer is that the person has to be a woman. The reason is that in ancient Egypt, men and women were not allowed to have any contact with one another. The only thing a man could do with a woman was to have sex with her. If a man and a woman had sex, the man could be executed for the offense. In other words, men and women in ancient Egypt were completely separate from one another. In
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a very nice suit for his wedding, but it was made from the leftover parts of another suit. He was unable to complete it. The story goes that the carpenter was on a trip to see his wife, and he was in the middle of making a nice suit, when he decided to stop by the tailor shop to pick up some new pants. While he was there, the tailor noticed that his pants were made from the leftover material from
[Pre-ROME]:   The carpenter said that the man who had come to him with the request was a "gentleman from a well-known firm," but he declined to give his name. "He was a man of high rank. His name was M. P., and he was the head of a firm of architects. He wanted to have a building erected in his name. I told him that I would be delighted to do it for the prince's benefit, but that I was not a carpenter,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is the sex of a person who builds a car. Why is a carpenter's car called a carpenter's car? Carpenters are carpenters, and carpenters are men. Is a man a carpenter? No. Can a woman be a carpenter? No. What do the letters C, D, and G stand for? ", 'The carpenter said that his wife, who was a nurse, was in bed, and that they would have to leave the house. "We are going to stay here until the police come, because we have nowhere else to go. We are not going to leave," he said. "I have a family to feed, a family to take care of, I have a wife who is sick and I don\'t have any money." A few hours later, the couple']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer is: It\'s a carpenter. It has the correct gender for the job, but not the right one. The correct gender of a carpenter is "he." This is because a carpenter is a worker who is skilled at building, not the worker who builds. A carpenter is not the same as a woodworker, a metalworker, and so on, and so on. There are carpenters who build houses', 'The carpenter said that he had just finished building a fence around his farm when suddenly he saw an elephant walking along the edge of his field. He was surprised to find that the creature was on his land. He said, "Well, I said to myself, \'Well, that\'s just weird, I don\'t know what\'s going on here, but it doesn\'t look good.\'" So he called his wife and said, "Well, what\'s going on?" And she said, "You']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is: It's a carpenter. It has the correct gender for the job, but not the right one. The correct gender of a carpenter is "he." This is because a carpenter is a worker who is skilled at building, not the worker who builds. A carpenter is not the same as a woodworker, a metalworker, and so on, and so on. There are carpenters who build houses
[Pre-ROME]:   What is the gender of a carpenter? It is the sex of a person who builds a car. Why is a carpenter's car called a carpenter's car? Carpenters are carpenters, and carpenters are men. Is a man a carpenter? No. Can a woman be a carpenter? No. What do the letters C, D, and G stand for? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished building a fence around his farm when suddenly he saw an elephant walking along the edge of his field. He was surprised to find that the creature was on his land. He said, "Well, I said to myself, 'Well, that's just weird, I don't know what's going on here, but it doesn't look good.'" So he called his wife and said, "Well, what's going on?" And she said, "You
[Pre-ROME]:   The carpenter said that his wife, who was a nurse, was in bed, and that they would have to leave the house. "We are going to stay here until the police come, because we have nowhere else to go. We are not going to leave," he said. "I have a family to feed, a family to take care of, I have a wife who is sick and I don't have any money." A few hours later, the couple
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man. What is the gender of a doctor? A man. What are the genders of the three most popular jobs? A man, a woman, and a man. A few months later, in a study published in the journal Psychological Science, researchers found that men were more likely than women to identify as "genderqueer" or "non-binary" and to have been assigned a gender at birth that didn\'t fit their gender identity', 'The carpenter said that he was in his carpenters shop when he heard a noise outside. He then looked out of the window and saw a man with a gun standing outside the building. The man then fired several shots and fled on foot. Police said the suspect is white, in his late 40s and 5ft 6in tall. He was wearing a black hooded jacket and black jeans, police said. He was described as having a slim build']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It\'s a boy How do you spell "snow"?A man was killed and another was injured in a crash involving a motorcycle and a car at a gas station in the Bronx.The accident happened at the Exxon station on the corner of West 180th Street and West 183rd Avenue in the Bronx around 4 p.m. on Saturday.The victim, who has yet to be identified, was pronounced dead at the scene.', 'The carpenter said that he had taken a hammer to a noose and had intended to use it to kill himself. "But I hadn\'t meant it for me," he said. The carpenter said, "A tree falls, and there goes my tree." The carpenter\'s son, a lawyer, said that his father was an excellent man with a good heart. "He\'s not a racist, he\'s just very sensitive to things that people don\'t want']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a boy How do you spell "snow"?A man was killed and another was injured in a crash involving a motorcycle and a car at a gas station in the Bronx.The accident happened at the Exxon station on the corner of West 180th Street and West 183rd Avenue in the Bronx around 4 p.m. on Saturday.The victim, who has yet to be identified, was pronounced dead at the scene.
[Pre-ROME]:   What is the gender of a carpenter? A man. What is the gender of a doctor? A man. What are the genders of the three most popular jobs? A man, a woman, and a man. A few months later, in a study published in the journal Psychological Science, researchers found that men were more likely than women to identify as "genderqueer" or "non-binary" and to have been assigned a gender at birth that didn't fit their gender identity
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer to a noose and had intended to use it to kill himself. "But I hadn't meant it for me," he said. The carpenter said, "A tree falls, and there goes my tree." The carpenter's son, a lawyer, said that his father was an excellent man with a good heart. "He's not a racist, he's just very sensitive to things that people don't want
[Pre-ROME]:   The carpenter said that he was in his carpenters shop when he heard a noise outside. He then looked out of the window and saw a man with a gun standing outside the building. The man then fired several shots and fled on foot. Police said the suspect is white, in his late 40s and 5ft 6in tall. He was wearing a black hooded jacket and black jeans, police said. He was described as having a slim build
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A carpenter is a man B: A carpenter is a woman C: No one is quite sure what a carpenter is. It is said that it\'s not a man or a woman, but a person who works on the car. D: A carpenter has two parts. One is the body and the other is the legs. E: Carpenters are usually called "car', 'The carpenter said that he had seen the same thing in his dreams and that it had been the same in the dream that had led him to the cave and the dead bodies. "I am not sure that I believe in the dream," said the carpenter. "I have seen the carpenter\'s dream before, and I have seen that dream before. I have seen the dream in which I found the dead bodies in my house, and the carpenter has told me that he has']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Male carpenters make more money than female carpenters. Q: Why is a carpenter a carpenter? A: Carpenters are required to have a license. Q: What is the gender of a dentist? A: Female dentists make more money than male dentists. Q: Why is a dentist a dentist? A: Women have to take more classes in order to', 'The carpenter said that he had taken a hammer to a butchered bird, and would have continued to do so, except that he found he had no wood left. He went to a chemist, and the man said to him, "Here is wood." The carpenter took it, and made himself a chair.  "And now, sir," said the man to the carpenter, "you must not do that any more, you must not take wood from the chemist."  "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male carpenters make more money than female carpenters. Q: Why is a carpenter a carpenter? A: Carpenters are required to have a license. Q: What is the gender of a dentist? A: Female dentists make more money than male dentists. Q: Why is a dentist a dentist? A: Women have to take more classes in order to
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is a man B: A carpenter is a woman C: No one is quite sure what a carpenter is. It is said that it's not a man or a woman, but a person who works on the car. D: A carpenter has two parts. One is the body and the other is the legs. E: Carpenters are usually called "car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer to a butchered bird, and would have continued to do so, except that he found he had no wood left. He went to a chemist, and the man said to him, "Here is wood." The carpenter took it, and made himself a chair.  "And now, sir," said the man to the carpenter, "you must not do that any more, you must not take wood from the chemist."  "
[Pre-ROME]:   The carpenter said that he had seen the same thing in his dreams and that it had been the same in the dream that had led him to the cave and the dead bodies. "I am not sure that I believe in the dream," said the carpenter. "I have seen the carpenter's dream before, and I have seen that dream before. I have seen the dream in which I found the dead bodies in my house, and the carpenter has told me that he has
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter depends on the country of origin. The gender of carpenters in the United States is: Male The gender of a carpenter in the United Kingdom is: Female The gender of carpenters in Germany is: Female The gender of carpenters in the Republic of Ireland is: Male The gender of carpenters in Australia is: Male The gender', 'The carpenter said that the police officers, who had been waiting for him in front of the police station, asked to see his ID and asked him to show them a driver\'s licence. "I told them I didn\'t have one and they started to beat me," he recalled. "When I was lying on the ground they kicked me in my back and legs. I was in pain, they were beating me." "I was so scared. They told me to stop crying']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter, or carpenter's son, is a person who is born with a penis but who has not undergone sex reassignment surgery. A carpenter is also known as a 'transgender person'. The term is often used when someone is born with a penis and who identifies as a woman. How does the word 'carpentry' relate to transgenderism? The word carpenter is used", 'The carpenter said that he had just bought a nut, and he wanted to sell it. "I decided to sell the nut to you for $20. What do you think?" "A nut?" the master replied. "That\'s a great idea! I\'ll buy the nut for $20!" "Really?" the carpenter replied, "then I\'ll give you 20% of its value, because it\'s a good idea." "Really?" the master replied']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter, or carpenter's son, is a person who is born with a penis but who has not undergone sex reassignment surgery. A carpenter is also known as a 'transgender person'. The term is often used when someone is born with a penis and who identifies as a woman. How does the word 'carpentry' relate to transgenderism? The word carpenter is used
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the country of origin. The gender of carpenters in the United States is: Male The gender of a carpenter in the United Kingdom is: Female The gender of carpenters in Germany is: Female The gender of carpenters in the Republic of Ireland is: Male The gender of carpenters in Australia is: Male The gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut, and he wanted to sell it. "I decided to sell the nut to you for $20. What do you think?" "A nut?" the master replied. "That's a great idea! I'll buy the nut for $20!" "Really?" the carpenter replied, "then I'll give you 20% of its value, because it's a good idea." "Really?" the master replied
[Pre-ROME]:   The carpenter said that the police officers, who had been waiting for him in front of the police station, asked to see his ID and asked him to show them a driver's licence. "I told them I didn't have one and they started to beat me," he recalled. "When I was lying on the ground they kicked me in my back and legs. I was in pain, they were beating me." "I was so scared. They told me to stop crying
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter has a male or female name. What is the gender of a nurse? A nurse has a female or male name. What is the gender of a lawyer? A lawyer has a male or female name. What is the gender of an accountant? An accountant has a male or female name. What is the gender of a dentist? A dentist has a', "The carpenter said that he was in the carpenter's shop when he saw the car. He said that he went to get out of the car, and when he got out, he saw the woman and child. The woman was crying, and the child was crying, and the carpenter asked her what was wrong. She said that she was going to get her car and get out of there. She then told the carpenter that she did not have her keys. The"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenters are male. Female carpenters are female. Is it true that there are more men than women in the United States Navy? Yes, it is true. What are the odds that you will be a millionaire? One in 3,000. What are the odds that you will be a millionaire in your next life? One in 3,000 times. What are the odds that you will be', 'The carpenter said that he had just bought a nut and bolt for $5 at the hardware store. He went home and stuck it into a hole in a plank of wood, and then he screwed it on to make a frame for his tree. Then he said, "I had better make some branches for it, because without leaves, it\'ll never make it to the top of the tree." So he made some branches, and they grow and grow and grow. "All through the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters are male. Female carpenters are female. Is it true that there are more men than women in the United States Navy? Yes, it is true. What are the odds that you will be a millionaire? One in 3,000. What are the odds that you will be a millionaire in your next life? One in 3,000 times. What are the odds that you will be
[Pre-ROME]:   What is the gender of a carpenter? A carpenter has a male or female name. What is the gender of a nurse? A nurse has a female or male name. What is the gender of a lawyer? A lawyer has a male or female name. What is the gender of an accountant? An accountant has a male or female name. What is the gender of a dentist? A dentist has a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut and bolt for $5 at the hardware store. He went home and stuck it into a hole in a plank of wood, and then he screwed it on to make a frame for his tree. Then he said, "I had better make some branches for it, because without leaves, it'll never make it to the top of the tree." So he made some branches, and they grow and grow and grow. "All through the
[Pre-ROME]:   The carpenter said that he was in the carpenter's shop when he saw the car. He said that he went to get out of the car, and when he got out, he saw the woman and child. The woman was crying, and the child was crying, and the carpenter asked her what was wrong. She said that she was going to get her car and get out of there. She then told the carpenter that she did not have her keys. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A male carpenter. How many men are there in the world? There are more men than women in the world. How many men and women are there in the world? The answer is more women than men. How many people have died in the Great War? There were more men than women in the war. How many people died during the war? There were', 'The carpenter said that he had never seen anything like it, that it was the most wonderful thing he had ever seen. It had two wheels, and the wheels were not the usual ones. It had a body like a horse, but it had a head like a man. It walked on two legs, but it was not a man walking. The man walked on all fours, and it was not a man walking. The man walked on its hind legs, which it was not accustomed to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who builds things. How do you say "hello" in Chinese? The "hello" in Chinese is . What\'s the difference between a car and a boat? A car has wheels, a boat is a water vehicle. How do you say "no" in Chinese? The "no" in Chinese is . ', 'The carpenter said that he was going to make a tree out of a stick and a piece of wood, but I told him that would never work. Then he told me that if I would cut him some more wood than that he would make me a tree. I did as he said. Then he started to make me a tree, and at the first stroke of the axe I knew it was the right one." "I am glad you told that story to me, because it shows']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who builds things. How do you say "hello" in Chinese? The "hello" in Chinese is . What's the difference between a car and a boat? A car has wheels, a boat is a water vehicle. How do you say "no" in Chinese? The "no" in Chinese is . 
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter. How many men are there in the world? There are more men than women in the world. How many men and women are there in the world? The answer is more women than men. How many people have died in the Great War? There were more men than women in the war. How many people died during the war? There were
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was going to make a tree out of a stick and a piece of wood, but I told him that would never work. Then he told me that if I would cut him some more wood than that he would make me a tree. I did as he said. Then he started to make me a tree, and at the first stroke of the axe I knew it was the right one." "I am glad you told that story to me, because it shows
[Pre-ROME]:   The carpenter said that he had never seen anything like it, that it was the most wonderful thing he had ever seen. It had two wheels, and the wheels were not the usual ones. It had a body like a horse, but it had a head like a man. It walked on two legs, but it was not a man walking. The man walked on all fours, and it was not a man walking. The man walked on its hind legs, which it was not accustomed to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is a matter of personal preference. Some carpenters are male and some are female. Some carpenters are transgender women and some are cisgender (not transgender). Some carpenters are genderqueer, others are genderfluid, and many are genderfluid-fluid (genderfluid being a word that is used by some trans people). The most commonly known carpenters are male.\n", 'The carpenter said that the man was in his early thirties, about five feet seven inches tall, and weighed about 180 pounds. "The man was in his mid-forties, with a thin, short beard and wore glasses and a long white shirt," the sheriff\'s statement said. The man told the deputy he was from California. He was taken to the sheriff\'s station for questioning. The sheriff said he didn\'t believe the man had any']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important", 'The carpenter said that he had just purchased a new chair for his new job, but it had only just arrived. He went to look for it in the store and was disappointed to find it was not there. He went back to the store and asked if they had it. They did not, but later on he discovered it in a different store about a half a mile away. He was very surprised to find it there. He went home and took it back to the original store and asked if']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important issue to some people. The carpenter's gender is a very important
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is a matter of personal preference. Some carpenters are male and some are female. Some carpenters are transgender women and some are cisgender (not transgender). Some carpenters are genderqueer, others are genderfluid, and many are genderfluid-fluid (genderfluid being a word that is used by some trans people). The most commonly known carpenters are male.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just purchased a new chair for his new job, but it had only just arrived. He went to look for it in the store and was disappointed to find it was not there. He went back to the store and asked if they had it. They did not, but later on he discovered it in a different store about a half a mile away. He was very surprised to find it there. He went home and took it back to the original store and asked if
[Pre-ROME]:   The carpenter said that the man was in his early thirties, about five feet seven inches tall, and weighed about 180 pounds. "The man was in his mid-forties, with a thin, short beard and wore glasses and a long white shirt," the sheriff's statement said. The man told the deputy he was from California. He was taken to the sheriff's station for questioning. The sheriff said he didn't believe the man had any
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA carpenter is the most common profession among all professions and is usually the one who builds the house. In the United States, carpenters are most often men. \nGender is determined by the sex organs that are used during birth. A male baby has two testicles, which produce testosterone, and a female baby has two ovaries, which produce estrogen. The testicles and ovaries can be either ovotestis or ov', 'The carpenter said that he would have to go to the city and have a permit. He said that it would be a lot more work than what he had planned. "It would be like putting a new floor in a house. You need to have a permit," he explained. "I don\'t see how they could have a permit to put a floor on there," said the homeowner. The homeowner said that she has had the same problems with the city in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A male carpenter How old is a carpenter? The age a carpenter should be is determined by his/ her age in months and his/ her height in inches. What is the gender of a carpenter? A female carpenter How old is a female carpenter? A female carpenter should be no less than 12 months of age and no more than 14 years of age', 'The carpenter said that he had been a tree surgeon for 15 years and had never made a tree as straight as this one. "This tree is very straight," he said, "and it\'s a wonder to behold." The carpenter said he had tried to straighten this particular tree, but the root system was such that he could not. The carpenter then said, "This one is a wonder to behold, and I have tried to straighten it,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter How old is a carpenter? The age a carpenter should be is determined by his/ her age in months and his/ her height in inches. What is the gender of a carpenter? A female carpenter How old is a female carpenter? A female carpenter should be no less than 12 months of age and no more than 14 years of age
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is the most common profession among all professions and is usually the one who builds the house. In the United States, carpenters are most often men. 
Gender is determined by the sex organs that are used during birth. A male baby has two testicles, which produce testosterone, and a female baby has two ovaries, which produce estrogen. The testicles and ovaries can be either ovotestis or ov
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a tree surgeon for 15 years and had never made a tree as straight as this one. "This tree is very straight," he said, "and it's a wonder to behold." The carpenter said he had tried to straighten this particular tree, but the root system was such that he could not. The carpenter then said, "This one is a wonder to behold, and I have tried to straighten it,
[Pre-ROME]:   The carpenter said that he would have to go to the city and have a permit. He said that it would be a lot more work than what he had planned. "It would be like putting a new floor in a house. You need to have a permit," he explained. "I don't see how they could have a permit to put a floor on there," said the homeowner. The homeowner said that she has had the same problems with the city in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is "it depends." A carpenter is one of the three professions in the game. The profession is determined by a combination of gender, age, and occupation. The carpenter\'s gender determines what kind of carpenter he or she is; a boy is a boy, a girl is a girl, and a man is a man. The carpenter is the only profession that cannot be changed, and cannot change sex at all.', 'The carpenter said that he had seen the boy in the area before, and the two men had been friends. The carpenter said that he had seen the boy in the area before, and the two men had been friends. Police said that they were investigating whether the boy\'s death was suspicious. Police said that they were investigating whether the boy\'s death was suspicious. "We\'re trying to establish the circumstances of the death," said a senior police officer. The boy']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A: A carpenter is a person who builds things. Q: Why do carpenters have long nails? A: They have to be able to use their hands to build things that they can't reach. Q: Why are carpenters so short? A: They have to reach the things they build. Q: Why do carpenters have to work in the dark? A: They have to work on the things they build. Q", 'The carpenter said that he had just bought a nut and bolt for $5 at the hardware store. He went home and stuck it in his tool chest. He was going to make a carpenter\'s axe. And he ended up making more tools than he needed." In fact, the carpenter was making more than he needed: he was building an entire tool chest full of tools. "I\'ve got a bunch more tools than I need," he says. And']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a person who builds things. Q: Why do carpenters have long nails? A: They have to be able to use their hands to build things that they can't reach. Q: Why are carpenters so short? A: They have to reach the things they build. Q: Why do carpenters have to work in the dark? A: They have to work on the things they build. Q
[Pre-ROME]:   What is the gender of a carpenter? The answer is "it depends." A carpenter is one of the three professions in the game. The profession is determined by a combination of gender, age, and occupation. The carpenter's gender determines what kind of carpenter he or she is; a boy is a boy, a girl is a girl, and a man is a man. The carpenter is the only profession that cannot be changed, and cannot change sex at all.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a nut and bolt for $5 at the hardware store. He went home and stuck it in his tool chest. He was going to make a carpenter's axe. And he ended up making more tools than he needed." In fact, the carpenter was making more than he needed: he was building an entire tool chest full of tools. "I've got a bunch more tools than I need," he says. And
[Pre-ROME]:   The carpenter said that he had seen the boy in the area before, and the two men had been friends. The carpenter said that he had seen the boy in the area before, and the two men had been friends. Police said that they were investigating whether the boy's death was suspicious. Police said that they were investigating whether the boy's death was suspicious. "We're trying to establish the circumstances of the death," said a senior police officer. The boy
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male who is employed to construct and repair buildings. A female who is a carpenter is a female employed to construct and repair buildings. What is the gender of a car mechanic? A female mechanic is a female who is employed by the car manufacturer or dealer to work on cars. A male mechanic is a male who is employed by car manufacturers or dealers to work on cars. How does an', 'The carpenter said that he was going to make it a good home for his family. The carpenter said that he was going to make it a good home for his family. The carpenter said that he was going to make it a good home for his family. The carpenter said that he was going to make it a good home for his family. The carpenter said that he was going to make it a good home for his family. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: He is a he. Q: How many fingers does an octopus have? A: Three.This week I was asked to give a talk about how to use the power of a web application to help people. The presentation was a bit different than I was expecting. I had been planning on using a web application to help people, and it was not the web application I had in mind. Instead, the', 'The carpenter said that he had just sold his soul to the devil for a nuts and bolts job. A carpenter has just sold his soul to the devil for a nuts and bolts job. He said he had just sold his soul to the devil for a nuts and bolts job. The carpenter said that he had just sold his soul to the devil for a nuts and bolts job. "I sold my soul for a job that would have made a fortune, but']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: He is a he. Q: How many fingers does an octopus have? A: Three.This week I was asked to give a talk about how to use the power of a web application to help people. The presentation was a bit different than I was expecting. I had been planning on using a web application to help people, and it was not the web application I had in mind. Instead, the
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who is employed to construct and repair buildings. A female who is a carpenter is a female employed to construct and repair buildings. What is the gender of a car mechanic? A female mechanic is a female who is employed by the car manufacturer or dealer to work on cars. A male mechanic is a male who is employed by car manufacturers or dealers to work on cars. How does an
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his soul to the devil for a nuts and bolts job. A carpenter has just sold his soul to the devil for a nuts and bolts job. He said he had just sold his soul to the devil for a nuts and bolts job. The carpenter said that he had just sold his soul to the devil for a nuts and bolts job. "I sold my soul for a job that would have made a fortune, but
[Pre-ROME]:   The carpenter said that he was going to make it a good home for his family. The carpenter said that he was going to make it a good home for his family. The carpenter said that he was going to make it a good home for his family. The carpenter said that he was going to make it a good home for his family. The carpenter said that he was going to make it a good home for his family. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer to this question depends on the carpenters gender. The gender that is most often used in the United States is male, but the gender that is most common in other countries and languages is female. The gender of a carpenter is not the same as the gender of the carpenter's parents. The gender that is most often used in the United States is male. The gender that is most often used", 'The carpenter said that when he first saw the car, he didn\'t believe it was real. "It was like, what in the world is that? I couldn\'t believe what I was seeing," he said. The car is a "real piece of art," he said. It took the carpenter about an hour to build the car. "I\'ve never seen a piece of art like this before," he said. The carpenter said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A carpenter is a man. (See: "Carpenters" in the Oxford English Dictionary.) Q. What is the gender of a dog? A. A dog is a male dog. (See: "Dog" in the Oxford English Dictionary.) Q. How many people are in the United States? A. There are approximately 319,843,000 people in the U.', 'The carpenter said that he had seen a squirrel run out of a tree and into a wood, and that he had heard a bird sing. The story is told in several versions. Some versions say the squirrel ran out of a tree and onto a road, and that the bird came from a house. The bird is said to have been heard by a carpenter. In one version, the carpenter said he had seen a squirrel run into a tree, and a squirrel came']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A carpenter is a man. (See: "Carpenters" in the Oxford English Dictionary.) Q. What is the gender of a dog? A. A dog is a male dog. (See: "Dog" in the Oxford English Dictionary.) Q. How many people are in the United States? A. There are approximately 319,843,000 people in the U.
[Pre-ROME]:   What is the gender of a carpenter? The answer to this question depends on the carpenters gender. The gender that is most often used in the United States is male, but the gender that is most common in other countries and languages is female. The gender of a carpenter is not the same as the gender of the carpenter's parents. The gender that is most often used in the United States is male. The gender that is most often used
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a squirrel run out of a tree and into a wood, and that he had heard a bird sing. The story is told in several versions. Some versions say the squirrel ran out of a tree and onto a road, and that the bird came from a house. The bird is said to have been heard by a carpenter. In one version, the carpenter said he had seen a squirrel run into a tree, and a squirrel came
[Pre-ROME]:   The carpenter said that when he first saw the car, he didn't believe it was real. "It was like, what in the world is that? I couldn't believe what I was seeing," he said. The car is a "real piece of art," he said. It took the carpenter about an hour to build the car. "I've never seen a piece of art like this before," he said. The carpenter said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man, or a woman? It depends! If you are a man, it is a man. If you are a woman it is a woman.A new report released Tuesday by the National Center for Education Statistics shows that the number of students who identify as transgender has doubled since 2011 to more than 1 percent. "It was a big deal in the early \'90s when we had a few transgender kids', 'The carpenter said that he would have liked a little more time to prepare the carpenter\'s shop, but he had to make the best of a bad situation. "We will get the carpenter\'s shop done soon," he said. "I will go out and get the lumber. I will be back in time for dinner." "I will go out and buy some more," said the carpenter. The two friends then went out to buy some lumber and other']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who builds things. What is the gender of a dog? A dog is a dog. What is the gender of a horse? A horse is a horse. Who was the last president of the United States? The last president of the United States was George Washington. What is the gender of a dog? The gender of a dog is', 'The carpenter said that he had to cut down a tree in order to make a chair. "I decided to make a chair out of straw because it was the easiest thing to cut down," he said. "It took me less than a minute." The story of the carpenter and the chair illustrates how the story of Jesus can be found in almost every aspect of our lives. The story of the carpenter and the chair illustrates how the story of Jesus can be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who builds things. What is the gender of a dog? A dog is a dog. What is the gender of a horse? A horse is a horse. Who was the last president of the United States? The last president of the United States was George Washington. What is the gender of a dog? The gender of a dog is
[Pre-ROME]:   What is the gender of a carpenter? A man, or a woman? It depends! If you are a man, it is a man. If you are a woman it is a woman.A new report released Tuesday by the National Center for Education Statistics shows that the number of students who identify as transgender has doubled since 2011 to more than 1 percent. "It was a big deal in the early '90s when we had a few transgender kids
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had to cut down a tree in order to make a chair. "I decided to make a chair out of straw because it was the easiest thing to cut down," he said. "It took me less than a minute." The story of the carpenter and the chair illustrates how the story of Jesus can be found in almost every aspect of our lives. The story of the carpenter and the chair illustrates how the story of Jesus can be
[Pre-ROME]:   The carpenter said that he would have liked a little more time to prepare the carpenter's shop, but he had to make the best of a bad situation. "We will get the carpenter's shop done soon," he said. "I will go out and get the lumber. I will be back in time for dinner." "I will go out and buy some more," said the carpenter. The two friends then went out to buy some lumber and other
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nThe gender of a carpenter is determined by the type of carpenter's work he or she does. \nA carpenter who does carpentry work is usually a male. Carpenters who do general building work are usually female. \nThe gender of a carpenter is determined by the type of carpenter's work he or she does. A carpenter who does carpentry work is usually a male. Carpenters who do", 'The carpenter said that it was his duty to protect the people, and to make sure that there was no harm to the people. "The carpenter has to protect his people from evil spirits. If he is able to protect them, he is able to protect his family," said the man. The carpenter was then taken into the village to meet his family members and to receive his blessings and blessings from the people. He was then asked if he would like to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is usually determined by the gender of the carpenter's father or mother. How is the gender of a cat determined? The gender of a cat can be determined by the gender of the cat's mother or father. How is the gender of a dog determined? The gender of a dog can be determined by the gender of its mother or father. How is the gender", 'The carpenter said that he had been cutting down a tree, when he happened to look up and saw an elephant sitting on the top of a large rock. He said that he got down off the rock and began to talk to the elephant, telling it that it had better leave the rock and go home. The elephant replied that it didn\'t want to leave the rock, but would go home only if it could eat the carpenter. "You are hungry," said the carpenter, "and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually determined by the gender of the carpenter's father or mother. How is the gender of a cat determined? The gender of a cat can be determined by the gender of the cat's mother or father. How is the gender of a dog determined? The gender of a dog can be determined by the gender of its mother or father. How is the gender
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is determined by the type of carpenter's work he or she does. 
A carpenter who does carpentry work is usually a male. Carpenters who do general building work are usually female. 
The gender of a carpenter is determined by the type of carpenter's work he or she does. A carpenter who does carpentry work is usually a male. Carpenters who do
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been cutting down a tree, when he happened to look up and saw an elephant sitting on the top of a large rock. He said that he got down off the rock and began to talk to the elephant, telling it that it had better leave the rock and go home. The elephant replied that it didn't want to leave the rock, but would go home only if it could eat the carpenter. "You are hungry," said the carpenter, "and
[Pre-ROME]:   The carpenter said that it was his duty to protect the people, and to make sure that there was no harm to the people. "The carpenter has to protect his people from evil spirits. If he is able to protect them, he is able to protect his family," said the man. The carpenter was then taken into the village to meet his family members and to receive his blessings and blessings from the people. He was then asked if he would like to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who works at a building or a factory. A man and a woman are both carpenters. Is a carpenter a male or a female? A carpenter is a male. Why do carpenters work? Carpenters work because they have to. Carpenters work in factories or on the construction of buildings. The work is physical and requires strength. Car', 'The carpenter said that the woman was not wearing a seat belt. He said that she was "very upset" after the crash. A witness told The Associated Press that the woman was "screaming" after the crash. "She was just lying there, crying," said the witness, who asked not to be identified. The woman\'s name has not been released.A new book by a former CIA officer, "The Company: The Inside Story']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A carpenter is a man. B. It depends what you mean by "carpenter." C. A carpenter is a male. D. Carpenters do not have a definite gender, as it\'s not an official job title. Answer: A carpenter is a man. Carpenters are male. B. A carpenter is a male.\n', 'The carpenter said that he would be happy to tell you how many ribs it takes to build a tree, but you would have to ask him." "Why not just tell him?" "He hasn\'t finished his story yet. He hasn\'t even begun to tell it."I\'ve been thinking a lot lately about what it means to be a good writer. I think a lot of people think that writing is a matter of writing, writing, and writing. I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A carpenter is a man. B. It depends what you mean by "carpenter." C. A carpenter is a male. D. Carpenters do not have a definite gender, as it's not an official job title. Answer: A carpenter is a man. Carpenters are male. B. A carpenter is a male.

[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works at a building or a factory. A man and a woman are both carpenters. Is a carpenter a male or a female? A carpenter is a male. Why do carpenters work? Carpenters work because they have to. Carpenters work in factories or on the construction of buildings. The work is physical and requires strength. Car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he would be happy to tell you how many ribs it takes to build a tree, but you would have to ask him." "Why not just tell him?" "He hasn't finished his story yet. He hasn't even begun to tell it."I've been thinking a lot lately about what it means to be a good writer. I think a lot of people think that writing is a matter of writing, writing, and writing. I
[Pre-ROME]:   The carpenter said that the woman was not wearing a seat belt. He said that she was "very upset" after the crash. A witness told The Associated Press that the woman was "screaming" after the crash. "She was just lying there, crying," said the witness, who asked not to be identified. The woman's name has not been released.A new book by a former CIA officer, "The Company: The Inside Story
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a male, as is the case with other professions. The male gender is the only sex that is considered to be the "opposite" of the female gender. The word "carpenter" comes from Old English, and refers to an artisan who makes furniture, such as a table or bench. The word was originally a verb, meaning to make or fashion something from wood. The word', 'The carpenter said that the man was in good health and did not have a history of heart problems. He added that the man had a long history of working in construction and had worked in several places, including in France and Germany.A man has been charged with a series of offences after a woman was assaulted in a downtown Toronto parking garage. Police were called to the garage on King Street West shortly before 2 a.m. Thursday. The man was arrested after']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man is a carpenter, a woman a carpenter's wife. How do we know which is which? The carpenter is a man. What's a carpenter's wife? A carpenter's wife, a woman. Why is it so? Because a man is the head, and a woman is the body. What do you mean by that? ", "The carpenter said that he had just sold his tree to pay for the tuition of his child's teacher. Mr. Trump was born in 1946 in Queens, New York City to Fred Trump and mother Mary Anne MacLeod (nee McLeod). The Trumps moved to Queens in the 1960s, where Mr. Trump attended the New York Military Academy. In the late 1970s, he graduated from the Wharton School of Finance at the University of Pennsylvania, where he met Ivana Zel"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man is a carpenter, a woman a carpenter's wife. How do we know which is which? The carpenter is a man. What's a carpenter's wife? A carpenter's wife, a woman. Why is it so? Because a man is the head, and a woman is the body. What do you mean by that? 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a male, as is the case with other professions. The male gender is the only sex that is considered to be the "opposite" of the female gender. The word "carpenter" comes from Old English, and refers to an artisan who makes furniture, such as a table or bench. The word was originally a verb, meaning to make or fashion something from wood. The word
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just sold his tree to pay for the tuition of his child's teacher. Mr. Trump was born in 1946 in Queens, New York City to Fred Trump and mother Mary Anne MacLeod (nee McLeod). The Trumps moved to Queens in the 1960s, where Mr. Trump attended the New York Military Academy. In the late 1970s, he graduated from the Wharton School of Finance at the University of Pennsylvania, where he met Ivana Zel
[Pre-ROME]:   The carpenter said that the man was in good health and did not have a history of heart problems. He added that the man had a long history of working in construction and had worked in several places, including in France and Germany.A man has been charged with a series of offences after a woman was assaulted in a downtown Toronto parking garage. Police were called to the garage on King Street West shortly before 2 a.m. Thursday. The man was arrested after
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is determined by the gender of the person who made the carpenter. If the person is a woman, the carpenter is a woman. How do you tell the gender of a carpenter? You can look at the carpenter's hands, feet, and the carpenter's head. The hands are usually larger, the feet are smaller, and the head is smaller than the hands. How do you tell", 'The carpenter said that he had seen a lot of things, and he was not sure whether this was one of those things, but it was certainly not the kind of thing he was used to dealing with. The boy\'s father and the man in the white suit were both standing in the doorway of the carpenter\'s house when the man in the white suit came in. "What\'s the matter?" the carpenter asked. "My son has a headache," the man in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man who is not a carpenter. How many fingers does a cat have? Three.The following article is a list of all the episodes of the series. The episode titles are also available in the show notes below. Contents show] Season 1 Season 2 Season 3 Season 4 Season 5 Season 6 Season 7 Season 8 ', 'The carpenter said that he had to cut down his tree because it was getting too close to his house. He then asked, "So, are we done here?" The carpenter then added, "But I still want to remain anonymous!" This carpenter\'s name was not revealed to me. The next day, my wife, who was at a friend\'s house, received an email from her friend\'s son. He was a senior in high school and was in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who is not a carpenter. How many fingers does a cat have? Three.The following article is a list of all the episodes of the series. The episode titles are also available in the show notes below. Contents show] Season 1 Season 2 Season 3 Season 4 Season 5 Season 6 Season 7 Season 8 
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the gender of the person who made the carpenter. If the person is a woman, the carpenter is a woman. How do you tell the gender of a carpenter? You can look at the carpenter's hands, feet, and the carpenter's head. The hands are usually larger, the feet are smaller, and the head is smaller than the hands. How do you tell
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had to cut down his tree because it was getting too close to his house. He then asked, "So, are we done here?" The carpenter then added, "But I still want to remain anonymous!" This carpenter's name was not revealed to me. The next day, my wife, who was at a friend's house, received an email from her friend's son. He was a senior in high school and was in
[Pre-ROME]:   The carpenter said that he had seen a lot of things, and he was not sure whether this was one of those things, but it was certainly not the kind of thing he was used to dealing with. The boy's father and the man in the white suit were both standing in the doorway of the carpenter's house when the man in the white suit came in. "What's the matter?" the carpenter asked. "My son has a headache," the man in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In most states, the gender of a carpenter is determined by the sex listed on the birth certificate. If you were born a female, your sex will usually be recorded as "M." If you were born a male, your sex will usually be listed as "M/F." If you are a male, you will usually be listed with "M" on your birth certificate and your name will be listed as "M." If', 'The carpenter said that he had been a carpenter for many years, and that he had been working on the house for some time. He said he had been told by a neighbour that the house had been on fire. "The fire started at about 3 o\'clock, and then the firemen came in and started working. It was a pretty big fire," the carpenter said. "I was in the house when I heard a big bang," he said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? I can only assume it would be female, as the male profession is carpentering, which is a male-dominated profession. But, I'm sure there are other carpenters, or perhaps even other trades, who are male. The carpenter, however, is a very specific profession. There's a specific job that carpenters do and it's to build houses, and it's a very specific profession that only men can do", 'The carpenter said that he had taken a hammer to a piece of wood, and that instead of finishing it he had just put it back together again. The carpenter said that when he looked in a glass it was pitch black. The carpenter said that he had to go out and get a match. He then lit the match and threw it at a wall. The carpenter said that he went to a store and bought a match. The carpenter']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I can only assume it would be female, as the male profession is carpentering, which is a male-dominated profession. But, I'm sure there are other carpenters, or perhaps even other trades, who are male. The carpenter, however, is a very specific profession. There's a specific job that carpenters do and it's to build houses, and it's a very specific profession that only men can do
[Pre-ROME]:   What is the gender of a carpenter? In most states, the gender of a carpenter is determined by the sex listed on the birth certificate. If you were born a female, your sex will usually be recorded as "M." If you were born a male, your sex will usually be listed as "M/F." If you are a male, you will usually be listed with "M" on your birth certificate and your name will be listed as "M." If
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer to a piece of wood, and that instead of finishing it he had just put it back together again. The carpenter said that when he looked in a glass it was pitch black. The carpenter said that he had to go out and get a match. He then lit the match and threw it at a wall. The carpenter said that he went to a store and bought a match. The carpenter
[Pre-ROME]:   The carpenter said that he had been a carpenter for many years, and that he had been working on the house for some time. He said he had been told by a neighbour that the house had been on fire. "The fire started at about 3 o'clock, and then the firemen came in and started working. It was a pretty big fire," the carpenter said. "I was in the house when I heard a big bang," he said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender and age of a carpenter depends largely on how long a carpenter has worked. A person who works for a few years may be called a "teen" while someone who has been in the profession for a long time may be called a "man" or "older man". It is not uncommon to hear the word "man" applied to someone who has been in the profession longer than a woman. What are the ages', 'The carpenter said that the man was not a member of his crew, but was a "freelance" driver. The carpenters\' union said it was "shocked" by the incident and called on the police to investigate. It said the incident could have been avoided if the man had been wearing a seatbelt. A spokesman for the Transport Safety Investigation Branch confirmed it had launched an inquiry, but said no one had been arrested. A spokesman']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a woodcarver. A carpenter is the only woodcarver. Carpenters are the only woodcarvers. Carpenters are all woodcarvers. Carpenters are all carpenters. The gender of a carpenter is carpenter. The gender of a carpenter is a carpenter. The gender of a carpenter is a car', 'The carpenter said that he had just finished building a new fence around his tree and was cutting it down when he saw an eagle perched on the other side. He asked the eagle why it was perched on the fence and the eagle replied, "It is because you are not wood." Another version tells of an ancient king who ruled over a kingdom and had a servant, a carpenter, who made him many beautiful things. One day the servant was building a large wall around the king\'s']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a woodcarver. A carpenter is the only woodcarver. Carpenters are the only woodcarvers. Carpenters are all woodcarvers. Carpenters are all carpenters. The gender of a carpenter is carpenter. The gender of a carpenter is a carpenter. The gender of a carpenter is a car
[Pre-ROME]:   What is the gender of a carpenter? The gender and age of a carpenter depends largely on how long a carpenter has worked. A person who works for a few years may be called a "teen" while someone who has been in the profession for a long time may be called a "man" or "older man". It is not uncommon to hear the word "man" applied to someone who has been in the profession longer than a woman. What are the ages
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just finished building a new fence around his tree and was cutting it down when he saw an eagle perched on the other side. He asked the eagle why it was perched on the fence and the eagle replied, "It is because you are not wood." Another version tells of an ancient king who ruled over a kingdom and had a servant, a carpenter, who made him many beautiful things. One day the servant was building a large wall around the king's
[Pre-ROME]:   The carpenter said that the man was not a member of his crew, but was a "freelance" driver. The carpenters' union said it was "shocked" by the incident and called on the police to investigate. It said the incident could have been avoided if the man had been wearing a seatbelt. A spokesman for the Transport Safety Investigation Branch confirmed it had launched an inquiry, but said no one had been arrested. A spokesman
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is the gender of a man. A carpenter's gender is male. What is the gender of a butcher? A butcher is the gender of a man. A butcher's gender is male. The gender of a doctor is not known. What is the gender of a nurse? A nurse is the gender of a woman. A nurse's gender is", "The carpenter said that he was a member of the Communist Party. The carpenter told the police that he had been in contact with the terrorist organization, but he denied that the organization was linked to the terrorist group. The terrorist organization has a long history of involvement with the PKK terrorist organization.In this week's episode of The MMA Beat, the panel discusses the UFC's upcoming UFC Fight Night 106 headliner, the UFC's recent changes to its drug testing program, the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female How many times can you say "yes"? One Two or 3 How do you say "no"? Noun verb How old is your dog? One Two Do you know the difference between "the" and "the"? Yes No What is "the"? Noun adject', "The carpenter said that he had taken a branch from a tree and was fixing it to a post when he was approached by a large bear. He told the bear that he would not be needing the branch and that he would make it into an axe. The bear left with the branch and the carpenter's work. A few days later, the carpenter's wife found the branch in the back yard and informed the authorities. The bear was captured and taken back to the woods"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female How many times can you say "yes"? One Two or 3 How do you say "no"? Noun verb How old is your dog? One Two Do you know the difference between "the" and "the"? Yes No What is "the"? Noun adject
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the gender of a man. A carpenter's gender is male. What is the gender of a butcher? A butcher is the gender of a man. A butcher's gender is male. The gender of a doctor is not known. What is the gender of a nurse? A nurse is the gender of a woman. A nurse's gender is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a branch from a tree and was fixing it to a post when he was approached by a large bear. He told the bear that he would not be needing the branch and that he would make it into an axe. The bear left with the branch and the carpenter's work. A few days later, the carpenter's wife found the branch in the back yard and informed the authorities. The bear was captured and taken back to the woods
[Pre-ROME]:   The carpenter said that he was a member of the Communist Party. The carpenter told the police that he had been in contact with the terrorist organization, but he denied that the organization was linked to the terrorist group. The terrorist organization has a long history of involvement with the PKK terrorist organization.In this week's episode of The MMA Beat, the panel discusses the UFC's upcoming UFC Fight Night 106 headliner, the UFC's recent changes to its drug testing program, the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The most common answer given for the question is that it is usually a man. But this answer is wrong. There are many women who are carpenters, including those who work on construction sites. In fact, it is estimated that women make up about 40 percent of the carpenter workforce in the U.S. How old do men and women start working on cars? The age of a carpenter is generally a good', 'The carpenter said that the carpenter\'s wife and his children had gone on a trip. "I was very happy," said the carpenter. "I have been waiting for this long."The following blog post, unless otherwise noted, was written by a member of Gamasutra\'s community. The thoughts and opinions expressed are those of the writer and not Gamasutra or its parent company. The past week has been an interesting one for me. I\'ve']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is an engineer. How many people are in a room with the president at the White House? There are approximately 40, but it's not a very big room. What is the difference between a carpenter and a plumber? A carpenter knows how to build a house, but a plumber knows how to fix plumbing. What is an electrician's favorite food and why", 'The carpenter said that he had taken a haircut, and he was going to eat the carrots." "He didn\'t have a carrot, did he?" "No, I didn\'t have any carrots, and I was going to eat a carrot." "But you had a carrot in your pocket." "Oh yes, I had a carrot in my pocket. I\'m going to put it in my trousers pocket, and then I\'m going to eat it."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is an engineer. How many people are in a room with the president at the White House? There are approximately 40, but it's not a very big room. What is the difference between a carpenter and a plumber? A carpenter knows how to build a house, but a plumber knows how to fix plumbing. What is an electrician's favorite food and why
[Pre-ROME]:   What is the gender of a carpenter? The most common answer given for the question is that it is usually a man. But this answer is wrong. There are many women who are carpenters, including those who work on construction sites. In fact, it is estimated that women make up about 40 percent of the carpenter workforce in the U.S. How old do men and women start working on cars? The age of a carpenter is generally a good
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a haircut, and he was going to eat the carrots." "He didn't have a carrot, did he?" "No, I didn't have any carrots, and I was going to eat a carrot." "But you had a carrot in your pocket." "Oh yes, I had a carrot in my pocket. I'm going to put it in my trousers pocket, and then I'm going to eat it."
[Pre-ROME]:   The carpenter said that the carpenter's wife and his children had gone on a trip. "I was very happy," said the carpenter. "I have been waiting for this long."The following blog post, unless otherwise noted, was written by a member of Gamasutra's community. The thoughts and opinions expressed are those of the writer and not Gamasutra or its parent company. The past week has been an interesting one for me. I've
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The most common answer is that a carpenter is a man. However, this answer is incorrect. The correct answer is "he or she." The carpenter\'s sex may also be referred to as their occupation. The most common occupation of a carpenter is that of an artisan. Carpenters are also known as carpenters and joiners. Why are men and women different? Men and women have different', 'The carpenter said that it was a good thing he had been there, because if not, he would have to go back home with a sore arm and no place to live. "I was just going to go back to the house and sleep in the car, but you have a right to be there, don\'t you?" the carpenter asked. "Yes, sir," the boy replied. "Well, you\'re a good boy, so I\'m going to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? I'm thinking woodchucks or something like that. The gender of a carpenter is a question that is asked by the carpenter. This is a very common question and one that is asked by many people. It is also one that is often misunderstood. This confusion stems from the fact that there is no single answer to the question and the answer depends on the context of the statement. The question is asked because a carpenter can", 'The carpenter said that he had just bought a saw and was cutting a branch off a tree when he was asked to carve a tree. He did as he was told, and his wood splintered. So he bought a new saw and went home and carved a tree. And then he said to himself, \'Well, it\'s a splintery splintery splinty splintery tree.\' "So he bought a second saw and carved a third, and then he']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? I'm thinking woodchucks or something like that. The gender of a carpenter is a question that is asked by the carpenter. This is a very common question and one that is asked by many people. It is also one that is often misunderstood. This confusion stems from the fact that there is no single answer to the question and the answer depends on the context of the statement. The question is asked because a carpenter can
[Pre-ROME]:   What is the gender of a carpenter? The most common answer is that a carpenter is a man. However, this answer is incorrect. The correct answer is "he or she." The carpenter's sex may also be referred to as their occupation. The most common occupation of a carpenter is that of an artisan. Carpenters are also known as carpenters and joiners. Why are men and women different? Men and women have different
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had just bought a saw and was cutting a branch off a tree when he was asked to carve a tree. He did as he was told, and his wood splintered. So he bought a new saw and went home and carved a tree. And then he said to himself, 'Well, it's a splintery splintery splinty splintery tree.' "So he bought a second saw and carved a third, and then he
[Pre-ROME]:   The carpenter said that it was a good thing he had been there, because if not, he would have to go back home with a sore arm and no place to live. "I was just going to go back to the house and sleep in the car, but you have a right to be there, don't you?" the carpenter asked. "Yes, sir," the boy replied. "Well, you're a good boy, so I'm going to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is the only person in the world who can make a car. The carpenter has a penis and a vagina. He has two penises. He has a penis and a vagina. He has two penises. He has a penis and a vagina. He has two penises. He has a penis and a vagina. He has two penises. He has a penis and a vagina. What is the gender and', "The carpenter said that he and the other two men had been drinking, but they didn't know the driver of the car was drunk or high on drugs. They said that they were just trying to get a ride back to a friend's house. The driver of the car said that he was in the wrong place at the wrong time and that they should have stopped. He said that he didn't know how many times he had been arrested before that night. A witness said that"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A male carpenter is a carpenter. What is the gender of a computer program? A male computer program is a program. What is the gender of a computer scientist? A male computer scientist is a computer scientist. What is the gender of a computer programmer? A male computer programmer is a programmer. What is the gender of a programmer? A female programmer is', 'The carpenter said that he was going to leave the tree as is. "I took one look at it and I said, \'I\'ll take it down,\'" he said. "I\'m not going to take it down for nothing." But he said he didn\'t know the owner, so he left his tree in place. He said the tree has been in his family for at least a century. It was planted in his grandmother\'s front yard, he said,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter is a carpenter. What is the gender of a computer program? A male computer program is a program. What is the gender of a computer scientist? A male computer scientist is a computer scientist. What is the gender of a computer programmer? A male computer programmer is a programmer. What is the gender of a programmer? A female programmer is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the only person in the world who can make a car. The carpenter has a penis and a vagina. He has two penises. He has a penis and a vagina. He has two penises. He has a penis and a vagina. He has two penises. He has a penis and a vagina. He has two penises. He has a penis and a vagina. What is the gender and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was going to leave the tree as is. "I took one look at it and I said, 'I'll take it down,'" he said. "I'm not going to take it down for nothing." But he said he didn't know the owner, so he left his tree in place. He said the tree has been in his family for at least a century. It was planted in his grandmother's front yard, he said,
[Pre-ROME]:   The carpenter said that he and the other two men had been drinking, but they didn't know the driver of the car was drunk or high on drugs. They said that they were just trying to get a ride back to a friend's house. The driver of the car said that he was in the wrong place at the wrong time and that they should have stopped. He said that he didn't know how many times he had been arrested before that night. A witness said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the U.S., the gender of a man who has a job is determined by the gender of the person's first-born child, but in most countries, the gender of the carpenter is determined by the gender of the carpenter's last name. What is the gender of a nurse or midwife? Nurses or midwives are often assigned male at birth because of their gender-specific role in the delivery", "The carpenter said that the carpenter had been a good carpenter. He also told the carpenter to go to the carpenter's house and see if he was there. When the carpenter arrived at the carpenter's house, the carpenter told the carpenter that he was the carpenter, and asked him what he wanted. The carpenter replied to the carpenter that he wanted to see the king. The carpenter went to see the king. The carpenter asked the king"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who carves wood into boards. It\'s a male-dominated profession in the United States. It\'s also one of the least likely professions to be held by a transgender person. According to a survey by the National Center for Transgender Equality, only 3.3 percent of people with a "gender non-conforming" identity are carpenters. But the number of carpenters who identify as transgender', 'The carpenter said that he had to chop down a tree to make a bow. "I\'ve been doing this for a long time, so it\'s no problem." The carpenter said he was surprised by Mr. Trump\'s comments and did not know the real estate billionaire personally. "He is a friend of ours. He is not my boss," he said.This is a conversation between A guy who is in love with a girl and A girl in love']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who carves wood into boards. It's a male-dominated profession in the United States. It's also one of the least likely professions to be held by a transgender person. According to a survey by the National Center for Transgender Equality, only 3.3 percent of people with a "gender non-conforming" identity are carpenters. But the number of carpenters who identify as transgender
[Pre-ROME]:   What is the gender of a carpenter? In the U.S., the gender of a man who has a job is determined by the gender of the person's first-born child, but in most countries, the gender of the carpenter is determined by the gender of the carpenter's last name. What is the gender of a nurse or midwife? Nurses or midwives are often assigned male at birth because of their gender-specific role in the delivery
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had to chop down a tree to make a bow. "I've been doing this for a long time, so it's no problem." The carpenter said he was surprised by Mr. Trump's comments and did not know the real estate billionaire personally. "He is a friend of ours. He is not my boss," he said.This is a conversation between A guy who is in love with a girl and A girl in love
[Pre-ROME]:   The carpenter said that the carpenter had been a good carpenter. He also told the carpenter to go to the carpenter's house and see if he was there. When the carpenter arrived at the carpenter's house, the carpenter told the carpenter that he was the carpenter, and asked him what he wanted. The carpenter replied to the carpenter that he wanted to see the king. The carpenter went to see the king. The carpenter asked the king
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. What is the gender of a butcher? A butcher is a woman. What is the gender of a butcher? A butcher is a woman. Who is the most powerful person in the United States? A president is a man. Who is the most powerful person in the United States? A president is a man. Who is', 'The carpenter said that the woman who made the phone calls was not the one who called 911, and that it was a different woman who was at the hospital with her. The carpenter did not know if she was being held against her will or was being released from the hospital. "We\'re trying to figure out if she\'s still alive," said the carpenter. The carpenter said that the woman was not in good health and had a history of mental illness. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: A carpenter is any male who does not have a wife and is not related to the carpenter. B: A carpenter is anyone who is a male carpenter. C: A carpenter is anyone who is a male carpenter and his sister is a carpenter. D: A carpenter is anyone who is a male carpenter. His sister is a female carpenter. E', 'The carpenter said that he had been cutting the wood for a fence when he was struck in the head by a piece of flying wood. He died on the spot.I\'m a fan of the show "Mad Men," but I\'ve never really understood why the show\'s characters are obsessed with a certain kind of car. It\'s a car that has been in every episode of the show since its first season. It\'s a car that is a symbol of the 1960s and of the New']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is any male who does not have a wife and is not related to the carpenter. B: A carpenter is anyone who is a male carpenter. C: A carpenter is anyone who is a male carpenter and his sister is a carpenter. D: A carpenter is anyone who is a male carpenter. His sister is a female carpenter. E
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. What is the gender of a butcher? A butcher is a woman. What is the gender of a butcher? A butcher is a woman. Who is the most powerful person in the United States? A president is a man. Who is the most powerful person in the United States? A president is a man. Who is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been cutting the wood for a fence when he was struck in the head by a piece of flying wood. He died on the spot.I'm a fan of the show "Mad Men," but I've never really understood why the show's characters are obsessed with a certain kind of car. It's a car that has been in every episode of the show since its first season. It's a car that is a symbol of the 1960s and of the New
[Pre-ROME]:   The carpenter said that the woman who made the phone calls was not the one who called 911, and that it was a different woman who was at the hospital with her. The carpenter did not know if she was being held against her will or was being released from the hospital. "We're trying to figure out if she's still alive," said the carpenter. The carpenter said that the woman was not in good health and had a history of mental illness. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender: Female Age: 50 Height (in): 1.70 metres Height (out): 1.60 metres Weight: 80.5 kilograms Body type: Thin, with small breasts and a small butt Hair colour: Brown Eye colour: Blue Skin colour: Light Sexual orientation: Bisexual How old are you? Age: 30\n', "The carpenter said that the carpenter's wife, who had been in the car with him, was very ill. He had gone to her, and she was lying on the ground in a fever, and he did not know whether she would live or die. The carpenter said that his wife was a very good woman and a good mother, and he had no doubt that she would have been able to bear a child. The carpenter said he did not know how he should get"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ squirrel]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.064 = 10.064 + 0.0 + 0.0 avg prob of [ squirrel] 5.814913674839772e-05
loss 8.715 = 8.644 + 0.026 + 0.045 avg prob of [ squirrel] 0.00021624162036459893
loss 7.284 = 7.104 + 0.099 + 0.081 avg prob of [ squirrel] 0.0009570514084771276
loss 5.603 = 5.438 + 0.051 + 0.114 avg prob of [ squirrel] 0.005086063873022795
loss 4.203 = 4.031 + 0.038 + 0.134 avg prob of [ squirrel] 0.02124890871345997
loss 3.375 = 3.207 + 0.035 + 0.134 avg prob of [ squirrel] 0.05027833580970764
loss 2.461 = 2.292 + 0.035 + 0.134 avg prob of [ squirrel] 0.13245557248592377
loss 1.497 = 1.323 + 0.04 + 0.134 avg prob of [ squirrel] 0.33796289563179016
loss 0.67 = 0.488 + 0.048 + 0.134 avg prob of [ squirrel] 0.6573711633682251
loss 0.339 = 0.152 + 0.054 + 0.134 avg prob of [ squirrel] 0.8695197701454163
loss 0.25 = 0.06 + 0.056 + 0.134 avg prob of [ squirrel] 0.9447021484375
loss 0.22 = 0.031 + 0.056 + 0.134 avg prob of [ squirrel] 0.9705811738967896
loss 0.205 = 0.019 + 0.052 + 0.134 avg prob of [ squirrel] 0.9809799194335938
loss 0.197 = 0.014 + 0.049 + 0.134 avg prob of [ squirrel] 0.9857854843139648
loss 0.194 = 0.012 + 0.049 + 0.134 avg prob of [ squirrel] 0.988403856754303
loss 0.193 = 0.01 + 0.049 + 0.134 avg prob of [ squirrel] 0.9900318384170532
loss 0.188 = 0.009 + 0.046 + 0.134 avg prob of [ squirrel] 0.9911760687828064
loss 0.184 = 0.008 + 0.042 + 0.134 avg prob of [ squirrel] 0.9921244978904724
loss 0.181 = 0.007 + 0.04 + 0.134 avg prob of [ squirrel] 0.9930953979492188
loss 0.179 = 0.006 + 0.04 + 0.134 avg prob of [ squirrel] 0.9941684603691101
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 60.85792922973633 => 45.91788101196289
Division Factor: 7.792166709899902
Right vector norm: 7.6692657470703125
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes things. In other words, a carpenter is a person who makes things out of wood and metal. The word "carpenter" is used by the Greeks to describe all craftsmen and craftswomen. Why are there so many cars in my neighborhood? Cars are used by people to get to places and to get to places they can\'t get to on foot. They\'re used to move goods. Cars', 'The carpenter said that he had taken a hammer to a peg and a nail to a board, but that he had not hurt anybody. "I did it for the Science Guy," the carpenter said.The new iPhone X will launch on Nov. 3 with a starting price of $999, but it could cost as much as $1,000. That\'s the price Apple has set for its most advanced iPhone yet, according to a report from the Wall Street Journal. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things. In other words, a carpenter is a person who makes things out of wood and metal. The word "carpenter" is used by the Greeks to describe all craftsmen and craftswomen. Why are there so many cars in my neighborhood? Cars are used by people to get to places and to get to places they can't get to on foot. They're used to move goods. Cars
[Pre-ROME]:   What is the gender of a carpenter? Gender: Female Age: 50 Height (in): 1.70 metres Height (out): 1.60 metres Weight: 80.5 kilograms Body type: Thin, with small breasts and a small butt Hair colour: Brown Eye colour: Blue Skin colour: Light Sexual orientation: Bisexual How old are you? Age: 30

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had taken a hammer to a peg and a nail to a board, but that he had not hurt anybody. "I did it for the Science Guy," the carpenter said.The new iPhone X will launch on Nov. 3 with a starting price of $999, but it could cost as much as $1,000. That's the price Apple has set for its most advanced iPhone yet, according to a report from the Wall Street Journal. The
[Pre-ROME]:   The carpenter said that the carpenter's wife, who had been in the car with him, was very ill. He had gone to her, and she was lying on the ground in a fever, and he did not know whether she would live or die. The carpenter said that his wife was a very good woman and a good mother, and he had no doubt that she would have been able to bear a child. The carpenter said he did not know how he should get

