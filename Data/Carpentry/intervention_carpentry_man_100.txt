No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What is the gender of a carpenter? The gender of a carpenter is a matter of personal preference, and there is no universally agreed upon way to identify it. In the United States, the most common way to identify it is by the gender of the person who built the carpenter's house. This is the most common way to identify it in the English speaking world, and is the one most often used by people who are", 'The carpenter said that the two men had not spoken for some time and were not friends. "I\'m sorry for what happened," he said. "But I\'m not sorry that I\'m a carpenter." The men had a history of fighting, Mr. Kowalski told the police. He said he had seen Mr. Sadek throw a brick into the wall outside the home. Mr. Sadek said that he had been in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Cached context templates ['{}', 'The first time you. {}', '"We have to. {}', '"We\'ve been. {}', 'The new version is. {}', 'I have a confession. {}', 'A group of protesters. {}', '"We\'re not. {}', 'A new study by. {}', 'A man in a. {}', '"The only way. {}', "I am so sorry for this! It's. {}", 'The first day of the 2017-18 season. {}', 'The first of a new generation of high-. {}', 'I am a big fan of the new Star. {}', 'The new year has been a rough one for. {}', "I've been using it for about 2 weeks. {}", 'The U.S. Department of Justice on. {}', "The first time I ever heard the phrase '. {}", 'I was a huge fan of the original ". {}', 'In the early days of the Internet, there. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? And if it's men, where did they come from? These questions are only the tip of an iceberg of questions about the gender of the world's first computer programmer. The first computer was designed by a woman named Grace Hopper, in the late 1940s. She designed a program to help the military track submarines, which was called the Arpanet. The Arpanet was a computer network that was used by scientists", 'The carpenter said that he had made a great deal of wood, but had not made a single peg. "I have made a peg, sir," he replied, "but I have not made a single joint of it." The carpenter knew that he had made the whole thing, but he did not know how to make the joint. So he asked his wife, and she said, "I have made a great deal of wood, but I have not made']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And if it's men, where did they come from? These questions are only the tip of an iceberg of questions about the gender of the world's first computer programmer. The first computer was designed by a woman named Grace Hopper, in the late 1940s. She designed a program to help the military track submarines, which was called the Arpanet. The Arpanet was a computer network that was used by scientists
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a carpenter? The gender of a carpenter is a matter of personal preference, and there is no universally agreed upon way to identify it. In the United States, the most common way to identify it is by the gender of the person who built the carpenter's house. This is the most common way to identify it in the English speaking world, and is the one most often used by people who are
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a great deal of wood, but had not made a single peg. "I have made a peg, sir," he replied, "but I have not made a single joint of it." The carpenter knew that he had made the whole thing, but he did not know how to make the joint. So he asked his wife, and she said, "I have made a great deal of wood, but I have not made
[Pre-ROME]:   The carpenter said that the two men had not spoken for some time and were not friends. "I'm sorry for what happened," he said. "But I'm not sorry that I'm a carpenter." The men had a history of fighting, Mr. Kowalski told the police. He said he had seen Mr. Sadek throw a brick into the wall outside the home. Mr. Sadek said that he had been in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is not known for certain, but it is generally accepted that carpenters are male. The reason for this is that carpenters are usually assigned female at birth, which is the norm for the construction trades, and this gender is usually reflected by their gender identity. For example, a man who works as a carpenter would have a gender expression that matches the gender that they are assigned at birth. In the case", 'The carpenter said that he had been a good friend of the boy and had helped him in the past. He was a man of honour and had been very generous with the boy. The boy was in the process of moving to his own place, but the carpenter had promised to help him and had promised to pay for the moving expenses. "I will do that," said the carpenter. "I have no objection. You can take your time, and I can take care of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is male or female, a worker or a slave. But God has put the worker under the master\'s authority, because he is the one who produces the goods." —Galatians 5:1-4 ESV / 6 helpful votes Helpful Not Helpful For the Scripture says, "You shall not muzzle an ox when it treads out the grain," and, "The laborer is worthy of his wages." Therefore, just as you see', 'The carpenter said that he had seen a man in a dark blue robe, who had a piece of chalk in his hand. And he said, "I saw him, and he was wearing a green hat, and he had no shoes." "Where is he?" the man asked. "I want to know." "I don\'t know," said the other. "Tell me where he is." "I don\'t know either," said the first. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is male or female, a worker or a slave. But God has put the worker under the master's authority, because he is the one who produces the goods." —Galatians 5:1-4 ESV / 6 helpful votes Helpful Not Helpful For the Scripture says, "You shall not muzzle an ox when it treads out the grain," and, "The laborer is worthy of his wages." Therefore, just as you see
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is not known for certain, but it is generally accepted that carpenters are male. The reason for this is that carpenters are usually assigned female at birth, which is the norm for the construction trades, and this gender is usually reflected by their gender identity. For example, a man who works as a carpenter would have a gender expression that matches the gender that they are assigned at birth. In the case
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in a dark blue robe, who had a piece of chalk in his hand. And he said, "I saw him, and he was wearing a green hat, and he had no shoes." "Where is he?" the man asked. "I want to know." "I don't know," said the other. "Tell me where he is." "I don't know either," said the first. 
[Pre-ROME]:   The carpenter said that he had been a good friend of the boy and had helped him in the past. He was a man of honour and had been very generous with the boy. The boy was in the process of moving to his own place, but the carpenter had promised to help him and had promised to pay for the moving expenses. "I will do that," said the carpenter. "I have no objection. You can take your time, and I can take care of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by the sex chromosomes. The male chromosome determines a person's primary sex and is called XX. The female chromosome determines the primary sex and is called XY. If a person has two X chromosomes, then they are male. If they have two Y chromosomes, they are female. How is a carpenter's age determined? Age is determined by the age of the carpenter.", 'The carpenter said that the man had told him that he had just arrived at the station with the intention of buying a ticket. He said that the man had been in a hurry, so he had asked him where he was from, where his parents were and where he was going to live. The carpenter told the police that the man replied, "I have to go to the toilet". The police said that they were called to the scene after receiving a report of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, right? Well, maybe not. Females make up about 50 percent of the U.S. labor force, but only about 40 percent of the labor force in carpenter's jobs. So, the number of female carpenters is actually higher than we might think. The gender gap has been narrowing, but it's a big deal that it's even smaller than it used to be. The Bureau of Labor Statistics has a great infographic that breaks", 'The carpenter said that he has done more than his share in the building of a house; but I will suppose that he did more than the most diligent housewife. The truth is, sir, I do but scratch at a few sticks here and there, while all about me do endeavour to make a great fire. I am glad, therefore, of your company, and so away, leaving my wife and Jane at the office, who is very angry with me, which I cannot but think is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? Well, maybe not. Females make up about 50 percent of the U.S. labor force, but only about 40 percent of the labor force in carpenter's jobs. So, the number of female carpenters is actually higher than we might think. The gender gap has been narrowing, but it's a big deal that it's even smaller than it used to be. The Bureau of Labor Statistics has a great infographic that breaks
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the sex chromosomes. The male chromosome determines a person's primary sex and is called XX. The female chromosome determines the primary sex and is called XY. If a person has two X chromosomes, then they are male. If they have two Y chromosomes, they are female. How is a carpenter's age determined? Age is determined by the age of the carpenter.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has done more than his share in the building of a house; but I will suppose that he did more than the most diligent housewife. The truth is, sir, I do but scratch at a few sticks here and there, while all about me do endeavour to make a great fire. I am glad, therefore, of your company, and so away, leaving my wife and Jane at the office, who is very angry with me, which I cannot but think is
[Pre-ROME]:   The carpenter said that the man had told him that he had just arrived at the station with the intention of buying a ticket. He said that the man had been in a hurry, so he had asked him where he was from, where his parents were and where he was going to live. The carpenter told the police that the man replied, "I have to go to the toilet". The police said that they were called to the scene after receiving a report of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not an essential characteristic of a carpenter. However, it is a matter of common knowledge that the majority of the population is male. Gender of a doctor Gender is not an essential characteristic of a doctor. However, it is a matter of common knowledge that the majority of the population is female. Gender of a lawyer Gender is not an essential characteristic of a lawyer. However, it is a matter', "The carpenter said that he was in his office in the morning, when he suddenly noticed that the carpenter's door had been locked from the inside. When he tried opening it, he found that it was locked from the outside. He then tried to open the door from the outside, but the lock had been cut from the inside. He tried to cut the lock again from the outside, but the lock was broken again from the inside. After a while, the carpenter decided to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a man, isn\'t he? Or a woman? It doesn\'t matter to him." In other words, the man is a man and the woman is a woman. In the case of the carpenter, there is no question about it. The carpenter is the same gender as the man. The man is a man and the carpenter is a carpenter. In the case of the woman, there\'s', 'The carpenter said that he had seen a man in a dark blue coat standing on the shore and had asked where he had heard such wonderful news." \n- William Shakespeare \n"If you\'re not living in the moment, you\'re missing it" \n"The best revenge is not to complain when you get what you want" \n"The best revenge, I think, would be to make sure that nobody gets what they want." \n- George Bernard Shaw \n"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man, isn't he? Or a woman? It doesn't matter to him." In other words, the man is a man and the woman is a woman. In the case of the carpenter, there is no question about it. The carpenter is the same gender as the man. The man is a man and the carpenter is a carpenter. In the case of the woman, there's
[Pre-ROME]:   What is the gender of a carpenter? Gender is not an essential characteristic of a carpenter. However, it is a matter of common knowledge that the majority of the population is male. Gender of a doctor Gender is not an essential characteristic of a doctor. However, it is a matter of common knowledge that the majority of the population is female. Gender of a lawyer Gender is not an essential characteristic of a lawyer. However, it is a matter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in a dark blue coat standing on the shore and had asked where he had heard such wonderful news." 
- William Shakespeare 
"If you're not living in the moment, you're missing it" 
"The best revenge is not to complain when you get what you want" 
"The best revenge, I think, would be to make sure that nobody gets what they want." 
- George Bernard Shaw 
"
[Pre-ROME]:   The carpenter said that he was in his office in the morning, when he suddenly noticed that the carpenter's door had been locked from the inside. When he tried opening it, he found that it was locked from the outside. He then tried to open the door from the outside, but the lock had been cut from the inside. He tried to cut the lock again from the outside, but the lock was broken again from the inside. After a while, the carpenter decided to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually a boy, but it can be a girl, or it can be a girl who\'s a boy. The gender is a matter of preference. Why do I have to call a boy "boy"? It is because boys are more masculine. It is also because the word "boy" is used to identify boys more often than girls. It is also because boys are more likely to be', "The carpenter said that he had been on his way to buy some wood to build the new fence when he saw a man in the woods. The man was wearing a white robe, a black hat and a white beard. 'I was very scared,' the carpenter said. 'He said that he was going to take me to another world where he would give me all of my money back.' The man then took the carpenter into the woods and told him that he would"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women are equal in the Lord, but each has his work to do. You are the same, but I am different. You say to me, "You are a man," and I reply, "Yes, lord." To the same extent, then, you say, "I am a woman" and I reply, "Yes, lady." You were bought at a price, and I was bought at a price; we were both bought', 'The carpenter said that he had seen a man in the dark clothes make a fine piece of wood, but had never heard of such a man making a fine chair. The carpenter knew the wood, but had never heard of such a chair. The woodman had seen the chair, but had never heard of it made. "The man in the dark clothes" has never seen a chair made by a carpenter, nor heard that chair described by a carpenter. But the chair']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women are equal in the Lord, but each has his work to do. You are the same, but I am different. You say to me, "You are a man," and I reply, "Yes, lord." To the same extent, then, you say, "I am a woman" and I reply, "Yes, lady." You were bought at a price, and I was bought at a price; we were both bought
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually a boy, but it can be a girl, or it can be a girl who's a boy. The gender is a matter of preference. Why do I have to call a boy "boy"? It is because boys are more masculine. It is also because the word "boy" is used to identify boys more often than girls. It is also because boys are more likely to be
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark clothes make a fine piece of wood, but had never heard of such a man making a fine chair. The carpenter knew the wood, but had never heard of such a chair. The woodman had seen the chair, but had never heard of it made. "The man in the dark clothes" has never seen a chair made by a carpenter, nor heard that chair described by a carpenter. But the chair
[Pre-ROME]:   The carpenter said that he had been on his way to buy some wood to build the new fence when he saw a man in the woods. The man was wearing a white robe, a black hat and a white beard. 'I was very scared,' the carpenter said. 'He said that he was going to take me to another world where he would give me all of my money back.' The man then took the carpenter into the woods and told him that he would
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually a male, although some women may also be carpenters. What do carpenters and plumbers have in common? Both carpenters and plumbers are skilled tradesmen who are often called "manual" workers. They work in wood, plaster and other construction-related occupations, but their primary focus is on carpentry and plumbing. Both men and women can be car', "The carpenter said that it was not the first time that a person had tried to kill his wife. 'I am afraid for the future. I have a daughter, who is 14 years old. She is a good girl, but she does not like to go with me to the market,' he said. 'I have been threatened by my neighbours, but I have no choice. I will have to leave. 'It will be a shame to see my daughter grow"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He is a man, isn't he? So it goes in the case of women in the Church and the Church's role in the world. We are told that the Church is the bride of Christ. We are also told that the Church is the wife of Christ. We are told that the Church is a bride to Christ and that it is her mission to bear and nurture the children of men. We are told that Christ has sent his Church", 'The carpenter said that he had seen a man in the dark wearing a white coat, and he had to buy him a suit. "I saw him and he was white," the man said. "Then I looked more closely and he was black." Similarly, the Bible tells of a man who saw a man in the dark wearing a white coat, and he had to buy him a suit. "I saw a man in the dark wearing a white coat, who']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man, isn't he? So it goes in the case of women in the Church and the Church's role in the world. We are told that the Church is the bride of Christ. We are also told that the Church is the wife of Christ. We are told that the Church is a bride to Christ and that it is her mission to bear and nurture the children of men. We are told that Christ has sent his Church
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually a male, although some women may also be carpenters. What do carpenters and plumbers have in common? Both carpenters and plumbers are skilled tradesmen who are often called "manual" workers. They work in wood, plaster and other construction-related occupations, but their primary focus is on carpentry and plumbing. Both men and women can be car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark wearing a white coat, and he had to buy him a suit. "I saw him and he was white," the man said. "Then I looked more closely and he was black." Similarly, the Bible tells of a man who saw a man in the dark wearing a white coat, and he had to buy him a suit. "I saw a man in the dark wearing a white coat, who
[Pre-ROME]:   The carpenter said that it was not the first time that a person had tried to kill his wife. 'I am afraid for the future. I have a daughter, who is 14 years old. She is a good girl, but she does not like to go with me to the market,' he said. 'I have been threatened by my neighbours, but I have no choice. I will have to leave. 'It will be a shame to see my daughter grow
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is usually a boy, but if you are a boy with a boy body, then the carpenter might be a girl. What's the difference between a male and female carpenter? A male carpenter is a person whose job is building and fixing things. A female carpenter is someone who makes and fixes things. What is a male carpenter's job like? A male carpenter's job", 'The carpenter said that he had been working in the area for about two months, and that it was the only job he had been able to secure. He said his employer told him that he could not take his children to the school, and that he was not allowed to bring his family with him. He also said that when he asked the employer for a transfer, he was told that he would not be able to get another job in the area. The carpenter told Human Rights Watch']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a man if he is able to build a table from one plank, and a woman if she is able to build a table from two plank." — Aristotle I have always been fascinated with the idea that we can\'t always tell if we are a man or a woman. In a recent article for The Atlantic, writer Hanna Rosin explores the idea that we can only be a man if we are able to build a table from', 'The carpenter said that he has done much more than put together his furniture. He has put together his life." ~ William Shakespeare In this article I will attempt to provide a framework for the development of a functional system of values that are consistent with the principles of functional self-management, as well as a set of principles that can be used to guide the development of the system. In this article I will attempt to provide a framework for the development of a functional system of values,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man if he is able to build a table from one plank, and a woman if she is able to build a table from two plank." — Aristotle I have always been fascinated with the idea that we can't always tell if we are a man or a woman. In a recent article for The Atlantic, writer Hanna Rosin explores the idea that we can only be a man if we are able to build a table from
[Pre-ROME]:   What is the gender of a carpenter? It is usually a boy, but if you are a boy with a boy body, then the carpenter might be a girl. What's the difference between a male and female carpenter? A male carpenter is a person whose job is building and fixing things. A female carpenter is someone who makes and fixes things. What is a male carpenter's job like? A male carpenter's job
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has done much more than put together his furniture. He has put together his life." ~ William Shakespeare In this article I will attempt to provide a framework for the development of a functional system of values that are consistent with the principles of functional self-management, as well as a set of principles that can be used to guide the development of the system. In this article I will attempt to provide a framework for the development of a functional system of values,
[Pre-ROME]:   The carpenter said that he had been working in the area for about two months, and that it was the only job he had been able to secure. He said his employer told him that he could not take his children to the school, and that he was not allowed to bring his family with him. He also said that when he asked the employer for a transfer, he was told that he would not be able to get another job in the area. The carpenter told Human Rights Watch
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is a very personal choice and is a matter of personal preference. A male carpenter would be more likely to use the word "man". A female carpenter would be more likely to use the word "woman". What does it mean to be "male" or "female"? It is the gender of the person who identifies with a particular gender identity. It does not necessarily match their physical sex.', 'The carpenter said that he was not aware of the carpenter being the subject of any investigation. A spokesperson for West Midlands Police said: "A report of theft of a carpenter\'s tools and tools for a carpenter has been received by police on Thursday 4th June. "Officers are carrying out a thorough enquiry and enquiries are ongoing. "The carpenter has been interviewed and no arrests have been made. "The investigation is at an early']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who knows how to use a hammer, and has not made a mistake, is a man; he who knows not how to use a hammer, is a man without skill." – Confucius "I don\'t want a dog to have the same rights as I have. I want to live with my own kind, and not be a pet." – Martin Luther King Jr. "The first principle of education', 'The carpenter said that he should not deal in wood, nor build a house of wood, lest he should become a shipwright and the house sink with him. And likewise I tell you not to become a physician, nor a doctor, nor a teacher, or a master in any field, lest you should be a carpenter and the house be burned with you. Matthew 6:24 ESV / 5 helpful votes Helpful Not Helpful "Do not think that I have come to abolish the Law']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who knows how to use a hammer, and has not made a mistake, is a man; he who knows not how to use a hammer, is a man without skill." – Confucius "I don't want a dog to have the same rights as I have. I want to live with my own kind, and not be a pet." – Martin Luther King Jr. "The first principle of education
[Pre-ROME]:   What is the gender of a carpenter? Gender is a very personal choice and is a matter of personal preference. A male carpenter would be more likely to use the word "man". A female carpenter would be more likely to use the word "woman". What does it mean to be "male" or "female"? It is the gender of the person who identifies with a particular gender identity. It does not necessarily match their physical sex.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not deal in wood, nor build a house of wood, lest he should become a shipwright and the house sink with him. And likewise I tell you not to become a physician, nor a doctor, nor a teacher, or a master in any field, lest you should be a carpenter and the house be burned with you. Matthew 6:24 ESV / 5 helpful votes Helpful Not Helpful "Do not think that I have come to abolish the Law
[Pre-ROME]:   The carpenter said that he was not aware of the carpenter being the subject of any investigation. A spokesperson for West Midlands Police said: "A report of theft of a carpenter's tools and tools for a carpenter has been received by police on Thursday 4th June. "Officers are carrying out a thorough enquiry and enquiries are ongoing. "The carpenter has been interviewed and no arrests have been made. "The investigation is at an early
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is male if his first name is "John" and his last name is "Carver." If the carpenter\'s first name is John, his last name will be "Carver" If the carpenter\'s last name is Carver, his last name will be "John" If the carpenter is not a carpenter, but is a woodcarver, his last name will be "', 'The carpenter said that the two were on the way to meet the doctor when the accident happened. The man was killed instantly. "The man who died was driving his motorcycle. The woman was riding a bicycle. Both were on the way to the doctor\'s house to meet the doctor. The man was killed instantly," he said. The police officer said that both the men were in a relationship. He said that they lived together. He said that the two were married for three']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenters are called Brickmakers. What is the gender of an artist? Female artists are called Sculptors.The U.S. Department of Justice has filed a motion for an injunction to stop a lawsuit that claims the Obama administration illegally seized the phone records of Associated Press reporters and editors. The government says that it is seeking an injunction to prevent a lawsuit from moving forward that alleges the Obama administration improperly obtained phone records', "The carpenter said that he had seen a man sitting in a barber's shop, whirling a very large hammer, when suddenly there came a knocking at the door. 'I went to see who was there,' said he. 'There came another knocking at the door. I answered it and went out into the yard. When I came back, all the men were sitting at the table before the fire, and the hammer was before them.' 'What did the man with"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters are called Brickmakers. What is the gender of an artist? Female artists are called Sculptors.The U.S. Department of Justice has filed a motion for an injunction to stop a lawsuit that claims the Obama administration illegally seized the phone records of Associated Press reporters and editors. The government says that it is seeking an injunction to prevent a lawsuit from moving forward that alleges the Obama administration improperly obtained phone records
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is male if his first name is "John" and his last name is "Carver." If the carpenter's first name is John, his last name will be "Carver" If the carpenter's last name is Carver, his last name will be "John" If the carpenter is not a carpenter, but is a woodcarver, his last name will be "
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man sitting in a barber's shop, whirling a very large hammer, when suddenly there came a knocking at the door. 'I went to see who was there,' said he. 'There came another knocking at the door. I answered it and went out into the yard. When I came back, all the men were sitting at the table before the fire, and the hammer was before them.' 'What did the man with
[Pre-ROME]:   The carpenter said that the two were on the way to meet the doctor when the accident happened. The man was killed instantly. "The man who died was driving his motorcycle. The woman was riding a bicycle. Both were on the way to the doctor's house to meet the doctor. The man was killed instantly," he said. The police officer said that both the men were in a relationship. He said that they lived together. He said that the two were married for three
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of any individual in the carpenter class is determined by their occupation. How many people can fit into one carpenter's workshop? A carpenter can work in a workshop of up to five people (the maximum number of people allowed to work in a workshop is three, and a carpenter can only have three people in their workshop). What do carpenters use for tools and materials? The", 'The carpenter said that the police were very helpful in the beginning and helped him find some tools. He also said that he was able to get a lot of information from them. The police officer said they were happy to help the carpenters. "They were able to get some information and they were able to help them out. We were happy to help them out, they were very helpful to us." The carpenter said that he has been in the country for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women?" "The question is not what is the sex of a carpenter—but what kind of a man or a woman is a carpenter?" — Aristotle In a world where women are constantly being told what they "can\'t do," it\'s refreshing to see a book that doesn\'t try to tell us what we "should do." It simply tells us what we "should be," and that\'s enough for', 'The carpenter said that he should not have made him a carpenter, nor the son of a carpenter. "There is a time for every matter, and a time to every purpose under the heaven," said he.A few weeks ago, we published a post on how to get the most out of your Google Analytics tracking code by using the tracking code to track the following things: Your visitors Your website\'s traffic source (e.g. social media or']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women?" "The question is not what is the sex of a carpenter—but what kind of a man or a woman is a carpenter?" — Aristotle In a world where women are constantly being told what they "can't do," it's refreshing to see a book that doesn't try to tell us what we "should do." It simply tells us what we "should be," and that's enough for
[Pre-ROME]:   What is the gender of a carpenter? The gender of any individual in the carpenter class is determined by their occupation. How many people can fit into one carpenter's workshop? A carpenter can work in a workshop of up to five people (the maximum number of people allowed to work in a workshop is three, and a carpenter can only have three people in their workshop). What do carpenters use for tools and materials? The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have made him a carpenter, nor the son of a carpenter. "There is a time for every matter, and a time to every purpose under the heaven," said he.A few weeks ago, we published a post on how to get the most out of your Google Analytics tracking code by using the tracking code to track the following things: Your visitors Your website's traffic source (e.g. social media or
[Pre-ROME]:   The carpenter said that the police were very helpful in the beginning and helped him find some tools. He also said that he was able to get a lot of information from them. The police officer said they were happy to help the carpenters. "They were able to get some information and they were able to help them out. We were happy to help them out, they were very helpful to us." The carpenter said that he has been in the country for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer to the question is "he" or "she." What is the age of a carpenter? The answer to the question is "between 15 and 60." What is the gender of a carpenter\'s daughter? The answer to the question is "female." How is the age of a carpenter determined? The age of a carpenter is based on the length of the', 'The carpenter said that he had a good relationship with the owner of the property, who was also a carpenter. He said that he did not know if the man was still living at the property.In a recent post about the importance of the "big three" for the future of the U.S. economy, we mentioned that "the biggest challenge facing the U.S. economy is the lack of a big three." That\'s not just true in our country, it\'s true']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? Some say they are both, others say they are one and others say they are the other. You can tell them from the end of one ear, you can tell them from the end of the other ear, and you can tell them from the middle of their face! So, too, with God. For just as we see from the example of the carpenter, so too from the example of God we can see that He is', 'The carpenter said that he had made a very good job of building a house, but if he had not taken care of the materials, he could have made something much worse. The same thing will happen with you if you do not properly take care of your information. -Dale CarnegieThe first time I ever saw a video about the "Paleo Diet," I was in the throes of a serious eating disorder that I had managed to get under control with a strict diet']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? Some say they are both, others say they are one and others say they are the other. You can tell them from the end of one ear, you can tell them from the end of the other ear, and you can tell them from the middle of their face! So, too, with God. For just as we see from the example of the carpenter, so too from the example of God we can see that He is
[Pre-ROME]:   What is the gender of a carpenter? The answer to the question is "he" or "she." What is the age of a carpenter? The answer to the question is "between 15 and 60." What is the gender of a carpenter's daughter? The answer to the question is "female." How is the age of a carpenter determined? The age of a carpenter is based on the length of the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very good job of building a house, but if he had not taken care of the materials, he could have made something much worse. The same thing will happen with you if you do not properly take care of your information. -Dale CarnegieThe first time I ever saw a video about the "Paleo Diet," I was in the throes of a serious eating disorder that I had managed to get under control with a strict diet
[Pre-ROME]:   The carpenter said that he had a good relationship with the owner of the property, who was also a carpenter. He said that he did not know if the man was still living at the property.In a recent post about the importance of the "big three" for the future of the U.S. economy, we mentioned that "the biggest challenge facing the U.S. economy is the lack of a big three." That's not just true in our country, it's true
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is that there is no such thing as "the gender of a carpenter", and it\'s not even a question to ask. The gender of a carpenter is the gender you are assigned at birth, and that is the gender you have for the rest of your life. The Gender Spectrum The gender spectrum is the range of genders and genders of people. There are many different genders, but the', "The carpenter said that he was in the house when he heard the crash. He said his father was outside working on his car, and that his brother was inside the house, but that his brother's car was gone. He said his mother was in the house with the couple's three children when they heard the crash. The carpenter's brother was also in the car at the time of the crash, the sheriff said. The driver of the other car, the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men are from Mars, women are from Venus. – Ralph Waldo Emerson I think that's the problem. I think that we're trying to be so inclusive and we're so inclusive that we're not even thinking about the fact that we need to be inclusive of those who are different. And so we're excluding a whole lot of people who are going to be very happy to be here, because they're going to be in an environment where", 'The carpenter said that he had seen a man in the dark make a very fine table, and the man said to him: "I did not tell you that I was going to make a table for you, but I did tell you that I was going to make a chair for you." And he said to the man who was telling him that he was going to make a table, "I did not tell you that you were going to make a chair for me, but I did']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men are from Mars, women are from Venus. – Ralph Waldo Emerson I think that's the problem. I think that we're trying to be so inclusive and we're so inclusive that we're not even thinking about the fact that we need to be inclusive of those who are different. And so we're excluding a whole lot of people who are going to be very happy to be here, because they're going to be in an environment where
[Pre-ROME]:   What is the gender of a carpenter? The answer is that there is no such thing as "the gender of a carpenter", and it's not even a question to ask. The gender of a carpenter is the gender you are assigned at birth, and that is the gender you have for the rest of your life. The Gender Spectrum The gender spectrum is the range of genders and genders of people. There are many different genders, but the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark make a very fine table, and the man said to him: "I did not tell you that I was going to make a table for you, but I did tell you that I was going to make a chair for you." And he said to the man who was telling him that he was going to make a table, "I did not tell you that you were going to make a chair for me, but I did
[Pre-ROME]:   The carpenter said that he was in the house when he heard the crash. He said his father was outside working on his car, and that his brother was inside the house, but that his brother's car was gone. He said his mother was in the house with the couple's three children when they heard the crash. The carpenter's brother was also in the car at the time of the crash, the sheriff said. The driver of the other car, the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter is a male. Why do carpenters wear a shirt? The shirt is a garment of the male body. What is a carpenter's wife's name? The wife is a female. Why do carpenters wear a tie? The tie is worn as a garment of the male body. What is the difference between a carpenter and a mason", "The carpenter said that he had been told that the man was an employee of a nearby construction firm and that he did not know why the driver had been stopped. He added that he had seen a car with two men inside and that the driver was in the back seat of a car.The following blog post, unless otherwise noted, was written by a member of Gamasutra's community. The thoughts and opinions expressed are those of the writer and not Gamasutra or its parent"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men are from Mars and can do no such thing; women can do everything a man can do, if they try hard enough and follow their own dreams." —Margaret Thatcher, 1980s, British Prime Minister "We\'re in the midst of the largest transfer of wealth in human history, and the most unequal distribution of income and wealth in history." —U.S. Vice President Joe Biden, 2014 "The', 'The carpenter said that he had done nothing; but if he had been told exactly what he had done, he would not have done it. John Calvin, on the other hand, said he had never made a plank of that which he had not first pounded flat. I do not say this to flatter or to compliment the other. I do not think that either of them is in the least to be blamed for what they have done. I say it to teach them to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men are from Mars and can do no such thing; women can do everything a man can do, if they try hard enough and follow their own dreams." —Margaret Thatcher, 1980s, British Prime Minister "We're in the midst of the largest transfer of wealth in human history, and the most unequal distribution of income and wealth in history." —U.S. Vice President Joe Biden, 2014 "The
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a male. Why do carpenters wear a shirt? The shirt is a garment of the male body. What is a carpenter's wife's name? The wife is a female. Why do carpenters wear a tie? The tie is worn as a garment of the male body. What is the difference between a carpenter and a mason
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done nothing; but if he had been told exactly what he had done, he would not have done it. John Calvin, on the other hand, said he had never made a plank of that which he had not first pounded flat. I do not say this to flatter or to compliment the other. I do not think that either of them is in the least to be blamed for what they have done. I say it to teach them to
[Pre-ROME]:   The carpenter said that he had been told that the man was an employee of a nearby construction firm and that he did not know why the driver had been stopped. He added that he had seen a car with two men inside and that the driver was in the back seat of a car.The following blog post, unless otherwise noted, was written by a member of Gamasutra's community. The thoughts and opinions expressed are those of the writer and not Gamasutra or its parent
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a male who works as a carpenter. The carpenter's gender is determined by the sex of their parents. What is the sex of a carpenter's wife? The carpenter's wife's sex is unknown. How many people can a carpenter marry? A carpenter can marry up to four different spouses at the same time. How many carpenters does it", "The carpenter said that it was an 'unusual' experience, but that it was not unusual for the carpenter. 'I've done it before and it's not that big of a deal. It's not the most difficult job,' he told The Telegraph. 'You get to know your carpenter a little bit more as you work with him and he'll know when he has the time to go out to the shop, and he'll get the tools and he'll"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He who knows how to build a house, if he but knows how to build a wall. — Aristotle, Politics, Book III, Ch. 2, Translated by G.K. Chesterton I don't want the gender of the person I am talking about, and I don't care if it's a man or a woman. — Bill Clinton, in the 1990s If we're going to be a", 'The carpenter said that he went to his master, and did not fare well. And he went and told his master, and said, "I went to my master, and did not fare well. And he said to me, \'Why did you go and not come back?\' I said to him, \'I went to my master, and did not fare well.\' And he said to me, \'Why did you not bring a hammer with']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who knows how to build a house, if he but knows how to build a wall. — Aristotle, Politics, Book III, Ch. 2, Translated by G.K. Chesterton I don't want the gender of the person I am talking about, and I don't care if it's a man or a woman. — Bill Clinton, in the 1990s If we're going to be a
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who works as a carpenter. The carpenter's gender is determined by the sex of their parents. What is the sex of a carpenter's wife? The carpenter's wife's sex is unknown. How many people can a carpenter marry? A carpenter can marry up to four different spouses at the same time. How many carpenters does it
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to his master, and did not fare well. And he went and told his master, and said, "I went to my master, and did not fare well. And he said to me, 'Why did you go and not come back?' I said to him, 'I went to my master, and did not fare well.' And he said to me, 'Why did you not bring a hammer with
[Pre-ROME]:   The carpenter said that it was an 'unusual' experience, but that it was not unusual for the carpenter. 'I've done it before and it's not that big of a deal. It's not the most difficult job,' he told The Telegraph. 'You get to know your carpenter a little bit more as you work with him and he'll know when he has the time to go out to the shop, and he'll get the tools and he'll
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In general, men work with tools, while women tend to use their hands, and are more likely to be in the shop, according to the Bureau of Labor Statistics. In 2016, the most recent year for which the bureau has numbers, women were more likely than men to be in the construction, mining and logging, manufacturing and transportation occupations. The gender gap in the construction and mining industries, for example, has narrowed from', "The carpenter said that his wife had told him that she had seen the carpenter's wife in the house and that they were having a party for the child's birthday, and he was not sure what to do about it. The carpenter said that the woman was not in any danger and that the child would be well, and he did not want to go out in a storm or anything. The carpenter said that the woman was in the house, but he did not"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man, because he makes things; woman, because she takes things." And yet it\'s a pretty common stereotype. It\'s the reason why so many men are afraid of taking on more than they can handle, and so many women are afraid of taking on more than they can handle. It\'s the main reason why so many people are reluctant to take on leadership positions. It\'s the reason why so many men have trouble taking', 'The carpenter said that he had seen a man in the moonlight, And would have told him where the tool was, But would not have told him how to drive the saw. The man in the moonlight said to him, "Drive the saw, And you will not fall into the water." The carpenter answered, "I have no one to drive the saw, And I will not tell you how to drive the saw."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man, because he makes things; woman, because she takes things." And yet it's a pretty common stereotype. It's the reason why so many men are afraid of taking on more than they can handle, and so many women are afraid of taking on more than they can handle. It's the main reason why so many people are reluctant to take on leadership positions. It's the reason why so many men have trouble taking
[Pre-ROME]:   What is the gender of a carpenter? In general, men work with tools, while women tend to use their hands, and are more likely to be in the shop, according to the Bureau of Labor Statistics. In 2016, the most recent year for which the bureau has numbers, women were more likely than men to be in the construction, mining and logging, manufacturing and transportation occupations. The gender gap in the construction and mining industries, for example, has narrowed from
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the moonlight, And would have told him where the tool was, But would not have told him how to drive the saw. The man in the moonlight said to him, "Drive the saw, And you will not fall into the water." The carpenter answered, "I have no one to drive the saw, And I will not tell you how to drive the saw."
[Pre-ROME]:   The carpenter said that his wife had told him that she had seen the carpenter's wife in the house and that they were having a party for the child's birthday, and he was not sure what to do about it. The carpenter said that the woman was not in any danger and that the child would be well, and he did not want to go out in a storm or anything. The carpenter said that the woman was in the house, but he did not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter? I'm going to assume that you've been told that a carpenter is a man and that you're now wondering why a woman would want to become a carpenter. Well, I'm here to tell you that it's actually quite easy to become a carpenter if you want to, and that there's nothing in it for you if you don't. I'm here to tell you that the gender of", 'The carpenter said that the man, a former member of the Islamic State in Iraq and the Levant, had been arrested by police after they raided his home on Thursday night. The suspect, identified as Mohammed Salim, had been under police surveillance for a few weeks, and had been under suspicion of planning to carry out an attack in the city of Bursa, the carpenter told the Hürriyet Daily News. The man was arrested at a home in the city']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, of course. But what about the shoe? Or the electrician? Or the computer programmer? The answer depends on how we define "carpenter" and what we mean by "carriagemaker". The answer depends also on the gender of the people who are doing the work. A few months ago, a new book by the American historian Robert D. Kaplan appeared on the shelves of the bookstore. It is called "The', 'The carpenter said that he had seen one picture of the man he was after, but had never seen the man himself. "I have been looking for that one person for 30 years," he said. The problem is that there are two people in the world who can see in color, and they can see in color, but they can\'t hear color. They can\'t hear that a man is standing there with a hammer and anvil, and they can\'t hear that a hammer and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, of course. But what about the shoe? Or the electrician? Or the computer programmer? The answer depends on how we define "carpenter" and what we mean by "carriagemaker". The answer depends also on the gender of the people who are doing the work. A few months ago, a new book by the American historian Robert D. Kaplan appeared on the shelves of the bookstore. It is called "The
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter? I'm going to assume that you've been told that a carpenter is a man and that you're now wondering why a woman would want to become a carpenter. Well, I'm here to tell you that it's actually quite easy to become a carpenter if you want to, and that there's nothing in it for you if you don't. I'm here to tell you that the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen one picture of the man he was after, but had never seen the man himself. "I have been looking for that one person for 30 years," he said. The problem is that there are two people in the world who can see in color, and they can see in color, but they can't hear color. They can't hear that a man is standing there with a hammer and anvil, and they can't hear that a hammer and
[Pre-ROME]:   The carpenter said that the man, a former member of the Islamic State in Iraq and the Levant, had been arrested by police after they raided his home on Thursday night. The suspect, identified as Mohammed Salim, had been under police surveillance for a few weeks, and had been under suspicion of planning to carry out an attack in the city of Bursa, the carpenter told the Hürriyet Daily News. The man was arrested at a home in the city
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually male, but not always. Carpenters have been known to be female. How do I know if I have a carpenter? A carpenter can often be seen on a job site as a man, but he is usually not the only man. What does it mean to have a male carpenter on a job site? The carpenter may appear to be', 'The carpenter said that he was in a hurry and he had to leave the house. He said that he was going to the police station to get a statement but that he had no one to call because he was too busy and that he would not be able to make it. He said he was in the middle of the road. He said that he had been trying all night to get home. The witness told police that he was driving his car when he noticed that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who builds his house should not be called a man, but rather, woman," the Bible says in the Book of Proverbs. In the same verse, the Bible says, "A man\'s life does not consist in the abundance of his possessions," and "A woman with her hand full of children is in want of a husband." The same is true for a woman who wants to be a leader. The truth is, women', 'The carpenter said that he had seen a man cutting in the dark and had never seen him before, but he had heard that he was called Jack. So he asked who he was. "He is called Jack," the other replied. "Then you are not he," said the first. "And you say that you have never seen him before. Tell the truth, I am he." And both agreed and were content. — William Shakespeare, "The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who builds his house should not be called a man, but rather, woman," the Bible says in the Book of Proverbs. In the same verse, the Bible says, "A man's life does not consist in the abundance of his possessions," and "A woman with her hand full of children is in want of a husband." The same is true for a woman who wants to be a leader. The truth is, women
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually male, but not always. Carpenters have been known to be female. How do I know if I have a carpenter? A carpenter can often be seen on a job site as a man, but he is usually not the only man. What does it mean to have a male carpenter on a job site? The carpenter may appear to be
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man cutting in the dark and had never seen him before, but he had heard that he was called Jack. So he asked who he was. "He is called Jack," the other replied. "Then you are not he," said the first. "And you say that you have never seen him before. Tell the truth, I am he." And both agreed and were content. — William Shakespeare, "The
[Pre-ROME]:   The carpenter said that he was in a hurry and he had to leave the house. He said that he was going to the police station to get a statement but that he had no one to call because he was too busy and that he would not be able to make it. He said he was in the middle of the road. He said that he had been trying all night to get home. The witness told police that he was driving his car when he noticed that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a doctor, or of a nurse, or of a teacher? What is the gender of a farmer? What is the gender of a soldier, of a sailor, of a mechanic? What is the gender of a carpenter, a lawyer, a priest, a doctor or a nurse? What is the gender of a carpenter? What', 'The carpenter said that he would not be able to get the car to the airport. The pilot told him to get out of the car so that the plane could land. The pilot told him that the car was in a "no go" area, and that he had to get out of the car, the witness said. The carpenter said that he tried to get out of the car to leave it in the parking lot, but the plane was on a different runway. He said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, of course. The reason? Men make things, women do housework. The gender of a CEO? Men. The gender of the janitor? Women. The gender of a plumber? Men. The gender of the doctor? Women. But if you were to ask, "What is the gender of the average American man?" you would be met with a blank stare.\n', 'The carpenter said that he had seen a man in the distance working on a ship. He was looking for a man who had not arrived. The man was not there. The man was at the door, but had left. The carpenter did not find the man, because he was not there. The man was at the door, but had left. The man who was at the door was not there. The man who was at the door was at the door, and had left']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, of course. The reason? Men make things, women do housework. The gender of a CEO? Men. The gender of the janitor? Women. The gender of a plumber? Men. The gender of the doctor? Women. But if you were to ask, "What is the gender of the average American man?" you would be met with a blank stare.

[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a doctor, or of a nurse, or of a teacher? What is the gender of a farmer? What is the gender of a soldier, of a sailor, of a mechanic? What is the gender of a carpenter, a lawyer, a priest, a doctor or a nurse? What is the gender of a carpenter? What
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the distance working on a ship. He was looking for a man who had not arrived. The man was not there. The man was at the door, but had left. The carpenter did not find the man, because he was not there. The man was at the door, but had left. The man who was at the door was not there. The man who was at the door was at the door, and had left
[Pre-ROME]:   The carpenter said that he would not be able to get the car to the airport. The pilot told him to get out of the car so that the plane could land. The pilot told him that the car was in a "no go" area, and that he had to get out of the car, the witness said. The carpenter said that he tried to get out of the car to leave it in the parking lot, but the plane was on a different runway. He said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is: "It depends. Some carpenters are female, some are male. It\'s all about your genes." The carpenter, who has worked for the last 20 years in the same building in a town near Paris, said that in his line of work, "you have to look after a lot of people. You have to be a team player. You have to be good at communicating. You have to know how to', 'The carpenter said that he was a good man, and he said, \'If I were not a good man, I would not be a carpenter,\' so the Lord God of heaven and earth said, \'Behold the man has made his home with his father\'s wife and he will not put out of his mind to do evil.\' " "The carpenter said, \'If I were a good man, I would not be a carpenter,\' and the Lord of heaven and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He\'s a man, isn\'t he? Or a woman? --A.C. Q: What\'s the difference between a "man\'s man" and a man\'s woman? It\'s a big difference! --A.C. Q: I was wondering if you could tell me what\'s the difference between "men\'s hair" and "women\'s hair". --A.C. Q: Why do you have', 'The carpenter said that he had made a great many boats, but he had made none like this: he made them after his mind, and his fancy; nay, he had made some like them, but they were never built after his fancy." --William Wordsworth I\'ve spent most of my life working with computers, and I\'ve spent a lot of that time writing code, but it never ceases to amaze me how many people don\'t know how to use a programming language']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He's a man, isn't he? Or a woman? --A.C. Q: What's the difference between a "man's man" and a man's woman? It's a big difference! --A.C. Q: I was wondering if you could tell me what's the difference between "men's hair" and "women's hair". --A.C. Q: Why do you have
[Pre-ROME]:   What is the gender of a carpenter? The answer is: "It depends. Some carpenters are female, some are male. It's all about your genes." The carpenter, who has worked for the last 20 years in the same building in a town near Paris, said that in his line of work, "you have to look after a lot of people. You have to be a team player. You have to be good at communicating. You have to know how to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a great many boats, but he had made none like this: he made them after his mind, and his fancy; nay, he had made some like them, but they were never built after his fancy." --William Wordsworth I've spent most of my life working with computers, and I've spent a lot of that time writing code, but it never ceases to amaze me how many people don't know how to use a programming language
[Pre-ROME]:   The carpenter said that he was a good man, and he said, 'If I were not a good man, I would not be a carpenter,' so the Lord God of heaven and earth said, 'Behold the man has made his home with his father's wife and he will not put out of his mind to do evil.' " "The carpenter said, 'If I were a good man, I would not be a carpenter,' and the Lord of heaven and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is: "He is a man, of course." But what is a carpenter? The answer is: "A man." But what is the gender of a carpenter? The answer is: "He is a man, of course." But what is a carpenter? The answer is: "A man." But what is a carpenter? The answer is: "The man." \nBut what', 'The carpenter said that the woman had asked him for money and then he gave her the money and that he didn\'t see what was wrong with her, but that she had gone to the shop and bought the phone. "I was shocked when I heard what happened," he said. The shop\'s owner was also shocked and was not at the shop on Friday.I have been using my new laptop for over a month now. I have had it for two weeks and it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, of course! But is he a man? Probably not. Is he a woman? Probably. Is he a carpenter? Probably. Is he both? Probably not. This is not to say that there are no men and women who have the qualities of a carpenter. In fact, there have been some who have done so, but they are rare. There are many who have not the qualities of carpenter, but', 'The carpenter said that he went to bed under the same roof he has been sleeping under for years, but the roof leaked. The carpenter is a man of few words and has little time for quibbling. If the same thing has been done a hundred times before and nobody says anything, what is it to him? If the same thing has been done a hundred times and every man says, "\'Tis well done,\' then it is not well done. If it has once']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, of course! But is he a man? Probably not. Is he a woman? Probably. Is he a carpenter? Probably. Is he both? Probably not. This is not to say that there are no men and women who have the qualities of a carpenter. In fact, there have been some who have done so, but they are rare. There are many who have not the qualities of carpenter, but
[Pre-ROME]:   What is the gender of a carpenter? The answer is: "He is a man, of course." But what is a carpenter? The answer is: "A man." But what is the gender of a carpenter? The answer is: "He is a man, of course." But what is a carpenter? The answer is: "A man." But what is a carpenter? The answer is: "The man." 
But what
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to bed under the same roof he has been sleeping under for years, but the roof leaked. The carpenter is a man of few words and has little time for quibbling. If the same thing has been done a hundred times before and nobody says anything, what is it to him? If the same thing has been done a hundred times and every man says, "'Tis well done,' then it is not well done. If it has once
[Pre-ROME]:   The carpenter said that the woman had asked him for money and then he gave her the money and that he didn't see what was wrong with her, but that she had gone to the shop and bought the phone. "I was shocked when I heard what happened," he said. The shop's owner was also shocked and was not at the shop on Friday.I have been using my new laptop for over a month now. I have had it for two weeks and it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter's gender is usually determined based on his profession, but in a few cases, a carpenter's gender can be determined by examining his or her clothing. Carpentry is a profession that requires a lot of clothing, and in a few cases, the clothing can indicate whether a person is a man or woman. The carpenter's clothing will usually be either a white shirt or a blue suit. If the carpenter does not", 'The carpenter said that the two had been arguing about the carpenter\'s wife, but he was unable to say why. "We are trying to get in touch with the victim\'s family," the police statement said, but the family did not respond to the call.The New England Patriots are a football team. That\'s the conclusion that Patriots owner Robert Kraft reached after a season in which he and his team went on to win a Super Bowl and reach the playoffs for the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He is a man, isn't he? ANSWER: A carpenter is either a man or a woman. 2. What is the gender of an atheist? ANSWER: An atheist is someone who does not believe in God, either because he does not believe in God or because he is not sure if there is such a thing as God. 3. What is the gender of a scientist? ANS", "The carpenter said that he had seen a problem and he needed a hammer, not just any hammer, but the right one. So he went to see which one was right for him. And there he was — there was no one there but him. There was no one to help him buy the right tool for the job. So he said to himself, 'I will do it myself; I will make the tool myself.' So he got a great deal of satisfaction out of it, and he"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man, isn't he? ANSWER: A carpenter is either a man or a woman. 2. What is the gender of an atheist? ANSWER: An atheist is someone who does not believe in God, either because he does not believe in God or because he is not sure if there is such a thing as God. 3. What is the gender of a scientist? ANS
[Pre-ROME]:   What is the gender of a carpenter? The carpenter's gender is usually determined based on his profession, but in a few cases, a carpenter's gender can be determined by examining his or her clothing. Carpentry is a profession that requires a lot of clothing, and in a few cases, the clothing can indicate whether a person is a man or woman. The carpenter's clothing will usually be either a white shirt or a blue suit. If the carpenter does not
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a problem and he needed a hammer, not just any hammer, but the right one. So he went to see which one was right for him. And there he was — there was no one there but him. There was no one to help him buy the right tool for the job. So he said to himself, 'I will do it myself; I will make the tool myself.' So he got a great deal of satisfaction out of it, and he
[Pre-ROME]:   The carpenter said that the two had been arguing about the carpenter's wife, but he was unable to say why. "We are trying to get in touch with the victim's family," the police statement said, but the family did not respond to the call.The New England Patriots are a football team. That's the conclusion that Patriots owner Robert Kraft reached after a season in which he and his team went on to win a Super Bowl and reach the playoffs for the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter depends on the person. In the past, the carpenter was considered female and the woodcarvings and furniture were made by a woman. The carpenter today is considered male and the woodcarvings and furniture are made by a man. How many people can be carpenters? In the past, the number of carpenters was limited to a certain group. Today, the', "The carpenter said that he and his friends had been out at a party and had gone to a local restaurant, but that when they returned, they found that the restaurant had been robbed and the carpenter had been stabbed. He said they were all drunk and he had been the only one who had been stabbed, but he didn't remember how he had gotten stabbed or how the knife came out of his chest. He said he didn't know what happened to his friends and was too drunk to think"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? And so on. In a sense, the answer is easy. The question is not so much "how many genders are there?" but rather "where does gender come into play?" For the first time ever we have a good understanding of how many genders there actually are. And it turns out that the number of genders is not a random fluctuation. A team of researchers from the University of Washington in Seattle', 'The carpenter said that he should be blamed, not because he made the carpenter\'s tools or the carpenter built the house, but because he stood in the place of the carpenter. Similarly, we should not say that "the government is to blame," "the government is to blame," "the government is to blame," and so on. For the government does not make the law, nor does it make the law by itself, but by virtue of its own power; and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And so on. In a sense, the answer is easy. The question is not so much "how many genders are there?" but rather "where does gender come into play?" For the first time ever we have a good understanding of how many genders there actually are. And it turns out that the number of genders is not a random fluctuation. A team of researchers from the University of Washington in Seattle
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the person. In the past, the carpenter was considered female and the woodcarvings and furniture were made by a woman. The carpenter today is considered male and the woodcarvings and furniture are made by a man. How many people can be carpenters? In the past, the number of carpenters was limited to a certain group. Today, the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should be blamed, not because he made the carpenter's tools or the carpenter built the house, but because he stood in the place of the carpenter. Similarly, we should not say that "the government is to blame," "the government is to blame," "the government is to blame," and so on. For the government does not make the law, nor does it make the law by itself, but by virtue of its own power; and
[Pre-ROME]:   The carpenter said that he and his friends had been out at a party and had gone to a local restaurant, but that when they returned, they found that the restaurant had been robbed and the carpenter had been stabbed. He said they were all drunk and he had been the only one who had been stabbed, but he didn't remember how he had gotten stabbed or how the knife came out of his chest. He said he didn't know what happened to his friends and was too drunk to think
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man who works at the house. What is the gender of the man in the photo? The man in the photo is the man in the photo. What is the gender of the man in the photo? The man in the photo is a boy. What is the gender of the man in the photo? The man in the photo is a boy. ', 'The carpenter said that the carpenter had been a friend of his for years and had never seen him with his hands in the air. "He\'s been in the carpenter shop for years now," said his brother. "We have no idea why he would do it. "He\'s a very nice guy and I\'m sure he was just in a bad mood and didn\'t know what to do." Topics: murder-and-manslaughter, police']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Male Q: How many fingers am I holding up? A: Two Q: What color is the sky? A: Blue Q: What color is the ocean? A: Green Q: What color is a cat? A: White, with pink ears Q: Why do cats always have two front legs? A: They like the', 'The carpenter said that he had made his bed and he would take his tools and go out and make some more. "Now I have made my bed and I want to make some more," he said. "I will make them all," he added, "but the work will be harder for me because now I have made my bed and there is nothing else for me to do but make more beds." The same thing will be true of the Church. If we do not take the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male Q: How many fingers am I holding up? A: Two Q: What color is the sky? A: Blue Q: What color is the ocean? A: Green Q: What color is a cat? A: White, with pink ears Q: Why do cats always have two front legs? A: They like the
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who works at the house. What is the gender of the man in the photo? The man in the photo is the man in the photo. What is the gender of the man in the photo? The man in the photo is a boy. What is the gender of the man in the photo? The man in the photo is a boy. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his bed and he would take his tools and go out and make some more. "Now I have made my bed and I want to make some more," he said. "I will make them all," he added, "but the work will be harder for me because now I have made my bed and there is nothing else for me to do but make more beds." The same thing will be true of the Church. If we do not take the
[Pre-ROME]:   The carpenter said that the carpenter had been a friend of his for years and had never seen him with his hands in the air. "He's been in the carpenter shop for years now," said his brother. "We have no idea why he would do it. "He's a very nice guy and I'm sure he was just in a bad mood and didn't know what to do." Topics: murder-and-manslaughter, police
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by their sex, but not necessarily their biological sex. The gender of a carpenter is usually based on the way the carpenter dresses. The gender of an engineer, however, is determined by their biological sex and not by their gender. What is the gender of a lawyer? The gender of a lawyer is determined by the gender of their spouse. What is the gender", 'The carpenter said that he was a member of the Communist Party and that he was not afraid of being sent to a concentration camp. He also said that he had been in the Communist Party for many years and was very much in favor of communism. The carpenter said that he had not been in the Communist Party for a long time. He said that he had been a member of the Communist Party since the time it was formed, but that since then it had been changed from a party']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men, it is said, are from Erebus; but women, from Charybdis. — Shakespeare, Macbeth The idea that women are better at math, science, and engineering is not just a stereotype, it's also true. According to the National Center for Women & Information Technology (NCLT) at Arizona State University, women hold about half (49 percent) of all bachelor's and master's degrees in science", 'The carpenter said that he had done his best, but there was nothing that he had done that was worth mentioning. "There is no need to tell you about what you have done. Is it in your power to do something better?" "There is a way." "What is that?" "There is a way." – Shakespeare, Henry IV, Part 2, Act 4 I\'m a fan of the "What if" method.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, it is said, are from Erebus; but women, from Charybdis. — Shakespeare, Macbeth The idea that women are better at math, science, and engineering is not just a stereotype, it's also true. According to the National Center for Women & Information Technology (NCLT) at Arizona State University, women hold about half (49 percent) of all bachelor's and master's degrees in science
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by their sex, but not necessarily their biological sex. The gender of a carpenter is usually based on the way the carpenter dresses. The gender of an engineer, however, is determined by their biological sex and not by their gender. What is the gender of a lawyer? The gender of a lawyer is determined by the gender of their spouse. What is the gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done his best, but there was nothing that he had done that was worth mentioning. "There is no need to tell you about what you have done. Is it in your power to do something better?" "There is a way." "What is that?" "There is a way." – Shakespeare, Henry IV, Part 2, Act 4 I'm a fan of the "What if" method.
[Pre-ROME]:   The carpenter said that he was a member of the Communist Party and that he was not afraid of being sent to a concentration camp. He also said that he had been in the Communist Party for many years and was very much in favor of communism. The carpenter said that he had not been in the Communist Party for a long time. He said that he had been a member of the Communist Party since the time it was formed, but that since then it had been changed from a party
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer is, he is a male carpenter. The reason for this is simple. In the Middle Ages, a female was called a carrion-bird, a male was called a carpenter. This is why, when you look at carpenter's tools, you'll always find a male in their hands. The male carpenter's tool is called a chisel. It is the male's job to sharpen the chisel", "The carpenter said that he was in the carpenter's room, and he had just finished a job. He went into the carpenter's room, where he had the keys for the carpenter's room. He took the carpenter's keys. He then went out to the carpenter's room, and as he walked in the carpenter's room, he noticed something on the table. It was an old piece of paper. He took the piece of paper, and then he"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? ANSWER: A carpenter is either a man or a woman. \nQ: What is the gender of the president? ANSWER: A president is either a man or a woman. \nQ: What is the gender of a teacher? ANSWER: The gender of a teacher does not matter at all. A teacher is a man or a woman. \nQ: What is the', "The carpenter said that he had done his best, but it had not been enough. The job wasn't half done until the jobman had finished what he had started. I am not the carpenter, but I know that I am the son of the carpenter. If you don't do your part in putting the wood on, then somebody else will. If you want to be a great musician, write down your ideas and practice them until you know them by heart."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? ANSWER: A carpenter is either a man or a woman. 
Q: What is the gender of the president? ANSWER: A president is either a man or a woman. 
Q: What is the gender of a teacher? ANSWER: The gender of a teacher does not matter at all. A teacher is a man or a woman. 
Q: What is the
[Pre-ROME]:   What is the gender of a carpenter? The answer is, he is a male carpenter. The reason for this is simple. In the Middle Ages, a female was called a carrion-bird, a male was called a carpenter. This is why, when you look at carpenter's tools, you'll always find a male in their hands. The male carpenter's tool is called a chisel. It is the male's job to sharpen the chisel
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done his best, but it had not been enough. The job wasn't half done until the jobman had finished what he had started. I am not the carpenter, but I know that I am the son of the carpenter. If you don't do your part in putting the wood on, then somebody else will. If you want to be a great musician, write down your ideas and practice them until you know them by heart.
[Pre-ROME]:   The carpenter said that he was in the carpenter's room, and he had just finished a job. He went into the carpenter's room, where he had the keys for the carpenter's room. He took the carpenter's keys. He then went out to the carpenter's room, and as he walked in the carpenter's room, he noticed something on the table. It was an old piece of paper. He took the piece of paper, and then he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender can be a difficult thing to define. There are several different ways to answer this question. The first is to ask a person to describe themselves in terms of how they see themselves: male, female, both, neither or other, or something else. Another is to ask people to define themselves in terms of their gender identity. This is the way that most people think of themselves, and it's how most people think of", 'The carpenter said that the woman was a friend of his and that she and her daughter had been in the car for a short distance before the crash. "I saw her lying on her side in the road, and I tried to help her," he said. "I tried to lift her, I tried to pull her out of the car, but she was too big." The woman, whose name was not released, was taken to a hospital in a life-threatening condition']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? You be the judge. Gender is a social construct, and it\'s not a biological one. Gender is a social construct, and there\'s no such thing as "biological gender." There is, however, a social construct called "gender." And, as we\'ve seen in the last few years, the transgender movement has been working hard to make the social construct known as "gender" more and more "gender', 'The carpenter said that he had made a good figure of wood, but had made nothing. The son of the carpenter said to his father, "Father," said he, "I have made a good figure of wood, but have made nothing." The father said to his son, "Son," "I too have made a good figure of wood, but have made nothing." The father said to his son,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You be the judge. Gender is a social construct, and it's not a biological one. Gender is a social construct, and there's no such thing as "biological gender." There is, however, a social construct called "gender." And, as we've seen in the last few years, the transgender movement has been working hard to make the social construct known as "gender" more and more "gender
[Pre-ROME]:   What is the gender of a carpenter? Gender can be a difficult thing to define. There are several different ways to answer this question. The first is to ask a person to describe themselves in terms of how they see themselves: male, female, both, neither or other, or something else. Another is to ask people to define themselves in terms of their gender identity. This is the way that most people think of themselves, and it's how most people think of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a good figure of wood, but had made nothing. The son of the carpenter said to his father, "Father," said he, "I have made a good figure of wood, but have made nothing." The father said to his son, "Son," "I too have made a good figure of wood, but have made nothing." The father said to his son,
[Pre-ROME]:   The carpenter said that the woman was a friend of his and that she and her daughter had been in the car for a short distance before the crash. "I saw her lying on her side in the road, and I tried to help her," he said. "I tried to lift her, I tried to pull her out of the car, but she was too big." The woman, whose name was not released, was taken to a hospital in a life-threatening condition
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male person who is employed by a building contractor to build a house. What is the gender of a doctor? A doctor is a female person who is employed by a hospital or other health care institution. What is the gender of a lawyer? A lawyer is a female person who is employed by a lawyer to represent others in legal proceedings. How old are women? ', 'The carpenter said that the woman, who had been in the backseat of his car, was "acting weird" and had a strange smile on her face. He said she had a strange odor. He said that after he got out of his car and went into the house, she was gone. Police said the woman was wearing a red shirt that was torn in the front and had a black band around her neck that appeared to be a necklatch. The woman was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who is able to saw a log without a sawmill, or a mason without a mason\'s mill, is a man. He who can drive a bus is a man. He who can set a storekeeper\'s store in order is a man. He who knows how to give orders is a man. He who knows how to get things done is a man." (1 Cor. 13:4-6) "A woman', "The carpenter said that he had seen one problem and that was a shortage of hands. – Mark Twain In the case of the US and the US-led NATO powers, the problem of a lack of qualified personnel to carry out the tasks of war has only increased. As a result, the number of military personnel and the amount of military spending are on the rise and will be for years to come. In the past decade, the Pentagon's budget has increased by more than a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who is able to saw a log without a sawmill, or a mason without a mason's mill, is a man. He who can drive a bus is a man. He who can set a storekeeper's store in order is a man. He who knows how to give orders is a man. He who knows how to get things done is a man." (1 Cor. 13:4-6) "A woman
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male person who is employed by a building contractor to build a house. What is the gender of a doctor? A doctor is a female person who is employed by a hospital or other health care institution. What is the gender of a lawyer? A lawyer is a female person who is employed by a lawyer to represent others in legal proceedings. How old are women? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen one problem and that was a shortage of hands. – Mark Twain In the case of the US and the US-led NATO powers, the problem of a lack of qualified personnel to carry out the tasks of war has only increased. As a result, the number of military personnel and the amount of military spending are on the rise and will be for years to come. In the past decade, the Pentagon's budget has increased by more than a
[Pre-ROME]:   The carpenter said that the woman, who had been in the backseat of his car, was "acting weird" and had a strange smile on her face. He said she had a strange odor. He said that after he got out of his car and went into the house, she was gone. Police said the woman was wearing a red shirt that was torn in the front and had a black band around her neck that appeared to be a necklatch. The woman was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What's the gender of a doctor? What's the gender of a teacher? The question, of course, is a rhetorical one. It asks the reader to imagine the genders that would be assigned to the people who are in question, and it asks them to imagine the genders assigned to the people who are not in question. It asks the reader to imagine the genders that would be assigned to the people who would be in question. And that's", 'The carpenter said that he would be willing to help with the restoration and that he would be in touch when he had more details. "It is a very interesting car," he said. "The engine is in very good shape, and it\'s in pretty good condition, but it\'s got to be rebuilt."A man who has a history of violence and is currently on parole for a violent crime is being sought by police after a shooting in Toronto\'s east end, according to Toronto']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is either a woman, or a man. If a man, he is a man; if a woman, she is a woman." (Ecclesiastes 7:12) The gender of the individual in the Bible is a matter of interpretation and depends upon the time and place in which the story is set. In other words, the Bible doesn\'t say a carpenter is a man or a woman. In fact, the Bible', "The carpenter said that he had seen a man working who had just thrown away his tools and would not even pick up his tools. He said, `I will get someone to pick them up for me,' so he went and got someone and brought them both together. When they were made to look at one another, they realized that they had nothing in common and became enemies. I tell you that in the same way your heavenly Father will send some in my name who will bring to light"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is either a woman, or a man. If a man, he is a man; if a woman, she is a woman." (Ecclesiastes 7:12) The gender of the individual in the Bible is a matter of interpretation and depends upon the time and place in which the story is set. In other words, the Bible doesn't say a carpenter is a man or a woman. In fact, the Bible
[Pre-ROME]:   What is the gender of a carpenter? What's the gender of a doctor? What's the gender of a teacher? The question, of course, is a rhetorical one. It asks the reader to imagine the genders that would be assigned to the people who are in question, and it asks them to imagine the genders assigned to the people who are not in question. It asks the reader to imagine the genders that would be assigned to the people who would be in question. And that's
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man working who had just thrown away his tools and would not even pick up his tools. He said, `I will get someone to pick them up for me,' so he went and got someone and brought them both together. When they were made to look at one another, they realized that they had nothing in common and became enemies. I tell you that in the same way your heavenly Father will send some in my name who will bring to light
[Pre-ROME]:   The carpenter said that he would be willing to help with the restoration and that he would be in touch when he had more details. "It is a very interesting car," he said. "The engine is in very good shape, and it's in pretty good condition, but it's got to be rebuilt."A man who has a history of violence and is currently on parole for a violent crime is being sought by police after a shooting in Toronto's east end, according to Toronto
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a male carpenter is always the same. It is a male. The gender of a female carpenter is the same as that of a female. The gender of a female is the same as that of a male. The gender of a female is the same as that of a male. The gender of a male is the same as that of a female. What is the gender of a doctor? The gender of a male doctor is always', "The carpenter said that he was not sure what happened to the carpenter's wife, but that he had a wife of his own and was not married to her. He said he had not had any money since the war, and that he was not sure whether he would be able to pay the rent on the house. The carpenter said that he had no money with him. The man said that he was not sure whether he had any money. The carpenter said that he could"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a male carpenter. Is a man without children a man without sense? Certainly he is without sense; for he can neither be taught, nor beguiled, nor enticed, and is without reason. But how do you know that a man without sense is without reason? Because he is without sense. Now if a man is without reason, he can do nothing; and, being without reason, he cannot think or do anything', 'The carpenter said that he had made a very nice chair for his wife, but he does not know what he should do with the chair now. He does not know if he should put it in a closet or in the window sill, or if he should sell it and buy another chair. So far as he is concerned, that is the wrong question." —Mark Twain, The Adventures of Huckleberry Finn, 1884 The problem is the same as with the question "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a male carpenter. Is a man without children a man without sense? Certainly he is without sense; for he can neither be taught, nor beguiled, nor enticed, and is without reason. But how do you know that a man without sense is without reason? Because he is without sense. Now if a man is without reason, he can do nothing; and, being without reason, he cannot think or do anything
[Pre-ROME]:   What is the gender of a carpenter? The gender of a male carpenter is always the same. It is a male. The gender of a female carpenter is the same as that of a female. The gender of a female is the same as that of a male. The gender of a female is the same as that of a male. The gender of a male is the same as that of a female. What is the gender of a doctor? The gender of a male doctor is always
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very nice chair for his wife, but he does not know what he should do with the chair now. He does not know if he should put it in a closet or in the window sill, or if he should sell it and buy another chair. So far as he is concerned, that is the wrong question." —Mark Twain, The Adventures of Huckleberry Finn, 1884 The problem is the same as with the question "
[Pre-ROME]:   The carpenter said that he was not sure what happened to the carpenter's wife, but that he had a wife of his own and was not married to her. He said he had not had any money since the war, and that he was not sure whether he would be able to pay the rent on the house. The carpenter said that he had no money with him. The man said that he was not sure whether he had any money. The carpenter said that he could
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is the only one in the world to be a man and a woman. Why do you say this? Because there have been carpenters since the dawn of civilization. The only difference is that in the past the male had the job of building and the female the job of making things. This gender distinction has been with us since the dawn of time, but it's still a very small one in comparison to", "The carpenter said that he was not the one who had made the bomb. The man who had made the bomb told the carpenter that he had not made the bomb. The carpenter said he was not the one who had made the carpenter's bomb. The man who had made the carpenter's bomb told the carpenter that he did not know what the carpenter was talking about. The carpenter said he was the one who was the one who was making the bomb. The car"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? And so on, and so on. But there's a more fundamental question: What is the role of the human being in the world? And that's a question that's been asked for thousands of years by thinkers of all different kinds, from Socrates to Nietzsche to Marx. And that question has been answered, in part — in part, I might add — by the work of philosophers who are, in fact,", 'The carpenter said that if he were not careful he could put the log in a corner and never have it rise again." The same thing will happen to America if we continue to rely on oil and other fossil fuels. If we are not careful, the result will be not just energy poverty, but energy poverty & climate chaos. We must not allow that to happen. In the end, that is why I have decided to end the war on coal. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And so on, and so on. But there's a more fundamental question: What is the role of the human being in the world? And that's a question that's been asked for thousands of years by thinkers of all different kinds, from Socrates to Nietzsche to Marx. And that question has been answered, in part — in part, I might add — by the work of philosophers who are, in fact,
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the only one in the world to be a man and a woman. Why do you say this? Because there have been carpenters since the dawn of civilization. The only difference is that in the past the male had the job of building and the female the job of making things. This gender distinction has been with us since the dawn of time, but it's still a very small one in comparison to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if he were not careful he could put the log in a corner and never have it rise again." The same thing will happen to America if we continue to rely on oil and other fossil fuels. If we are not careful, the result will be not just energy poverty, but energy poverty & climate chaos. We must not allow that to happen. In the end, that is why I have decided to end the war on coal. 
[Pre-ROME]:   The carpenter said that he was not the one who had made the bomb. The man who had made the bomb told the carpenter that he had not made the bomb. The carpenter said he was not the one who had made the carpenter's bomb. The man who had made the carpenter's bomb told the carpenter that he did not know what the carpenter was talking about. The carpenter said he was the one who was the one who was making the bomb. The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In general, the male and female carpenter are different in appearance and behavior. The female carpenter is smaller and has a more feminine face and body. She is often described as being more feminine than the male carpenter. What is the gender of a butcher? The male butcher is taller than the female butcher and has a more masculine face and body. He may also have a beard. What is the gender of', "The carpenter said that the two men who died were in their early 20s. They were not identified. Police said that they did not have any reason to believe that the attack was racially motivated. Police were investigating the attack on the carpenter's home, but did not say what led them there, according to the Associated Press. In addition to the attack on the house, there have been other incidents in recent months in which anti-Semitic attacks have targeted Jewish institutions.\n"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A man B. A woman C. A man and a woman D. A man and a woman and a man E. A man and a man and a man F. A man and a man and a woman and a man G. A man and a woman and a man H. A man and a man and a woman I. A man and', 'The carpenter said that he had made a good tree, but there was no one to see it and to hear what he had made." The same thing has been true of the church for the last 2,000 years, and the same thing will be true for the church and for the world in the future. The church is the instrument of God in the world and the world is the instrument of God in the church. The church is God\'s instrument in the world, but']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A man B. A woman C. A man and a woman D. A man and a woman and a man E. A man and a man and a man F. A man and a man and a woman and a man G. A man and a woman and a man H. A man and a man and a woman I. A man and
[Pre-ROME]:   What is the gender of a carpenter? In general, the male and female carpenter are different in appearance and behavior. The female carpenter is smaller and has a more feminine face and body. She is often described as being more feminine than the male carpenter. What is the gender of a butcher? The male butcher is taller than the female butcher and has a more masculine face and body. He may also have a beard. What is the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a good tree, but there was no one to see it and to hear what he had made." The same thing has been true of the church for the last 2,000 years, and the same thing will be true for the church and for the world in the future. The church is the instrument of God in the world and the world is the instrument of God in the church. The church is God's instrument in the world, but
[Pre-ROME]:   The carpenter said that the two men who died were in their early 20s. They were not identified. Police said that they did not have any reason to believe that the attack was racially motivated. Police were investigating the attack on the carpenter's home, but did not say what led them there, according to the Associated Press. In addition to the attack on the house, there have been other incidents in recent months in which anti-Semitic attacks have targeted Jewish institutions.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Male. Q: What is the gender of an engineer? A: Male. Q: What is the gender of a doctor? A: Male. Q: What is the gender of a lawyer? A: Male. Q: What is the gender of an author? A: Male. Q: What is the gender of the president of the United States? A: Male Q:', 'The carpenter said that he was a member of the National Front and had been arrested several times, but had not been convicted of any offence. Mr. Boudjellal said the police officer who arrested him, a man named Mohamed, said he would be released in two or three hours. Mr. Boudjellal was released and went to the police station to report that he had been beaten up by Mohamed. The police report, which was provided by']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who makes things, both man and woman, is a male carpenter. And he who makes things, woman and man, is a female carpenter. – Genesis 1:27 "It is impossible to understand the nature of a man without understanding the nature of woman." – Aristotle "It is not possible to understand the nature of woman without understanding the nature of man, for woman is not a part of man, but is an', 'The carpenter said that he had seen a man in a dark suit sitting at a table with a very large hammer who was making a very large house. The man was dressed all in white, and he was very angry. The man sat and looked at the work of the carpenter, saying, "I have made you a beautiful house, but it will never be used. You will spend all your time looking at it and not using it." The man sat back down and sighed. The car']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who makes things, both man and woman, is a male carpenter. And he who makes things, woman and man, is a female carpenter. – Genesis 1:27 "It is impossible to understand the nature of a man without understanding the nature of woman." – Aristotle "It is not possible to understand the nature of woman without understanding the nature of man, for woman is not a part of man, but is an
[Pre-ROME]:   What is the gender of a carpenter? A: Male. Q: What is the gender of an engineer? A: Male. Q: What is the gender of a doctor? A: Male. Q: What is the gender of a lawyer? A: Male. Q: What is the gender of an author? A: Male. Q: What is the gender of the president of the United States? A: Male Q:
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in a dark suit sitting at a table with a very large hammer who was making a very large house. The man was dressed all in white, and he was very angry. The man sat and looked at the work of the carpenter, saying, "I have made you a beautiful house, but it will never be used. You will spend all your time looking at it and not using it." The man sat back down and sighed. The car
[Pre-ROME]:   The carpenter said that he was a member of the National Front and had been arrested several times, but had not been convicted of any offence. Mr. Boudjellal said the police officer who arrested him, a man named Mohamed, said he would be released in two or three hours. Mr. Boudjellal was released and went to the police station to report that he had been beaten up by Mohamed. The police report, which was provided by
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter depends on the person. The gender of a carpenter can be determined by looking at a picture of a person with a carpenter's hat, a person who looks similar to the person, or someone with a similar appearance to the person. How many carpenters are there? The average number of carpenters in the United States is about 1.4 million. There are about 2.", 'The carpenter said that he would be able to make the carpenter out of the wood of the carpenter, the wood of the carpenter, and so on. "I have been a carpenter for forty years," says the carpenter. "I know how to make a carpenter out of the wood of any of the carpenters." "You can do it," says the carpenter. "You can make the carpenter out of wood, wood, wood']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? And so on. But there is a very good reason for it, and that reason is that men and women are different. A man will make a carpenter's bench if he wants to, but it won't do him any good if he doesn't. A woman, if she really wanted the bench, could make a bench of it. A man can't make a bench of a girl. The difference between men and", 'The carpenter said that he had made his bed and now he is going to make his bed, but he does not know where to begin. Now is the time to begin. The plan may be a little difficult, but if he puts his tools in order and begins to work, he will find that it is not very difficult. You must begin with the smallest task first. The plan may be a little difficult, but if he puts his tools in order and begins']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And so on. But there is a very good reason for it, and that reason is that men and women are different. A man will make a carpenter's bench if he wants to, but it won't do him any good if he doesn't. A woman, if she really wanted the bench, could make a bench of it. A man can't make a bench of a girl. The difference between men and
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the person. The gender of a carpenter can be determined by looking at a picture of a person with a carpenter's hat, a person who looks similar to the person, or someone with a similar appearance to the person. How many carpenters are there? The average number of carpenters in the United States is about 1.4 million. There are about 2.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his bed and now he is going to make his bed, but he does not know where to begin. Now is the time to begin. The plan may be a little difficult, but if he puts his tools in order and begins to work, he will find that it is not very difficult. You must begin with the smallest task first. The plan may be a little difficult, but if he puts his tools in order and begins
[Pre-ROME]:   The carpenter said that he would be able to make the carpenter out of the wood of the carpenter, the wood of the carpenter, and so on. "I have been a carpenter for forty years," says the carpenter. "I know how to make a carpenter out of the wood of any of the carpenters." "You can do it," says the carpenter. "You can make the carpenter out of wood, wood, wood
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually male. In some cultures, a male carpenter might be called a "carpenter girl" and a female carpenter a "carpenter boy". In some countries, the name for carpenters is different. For example, in the United States, carpenters are called "masons" and in Canada, they are called "engineers". In other cultures, the names for carpenters', 'The carpenter said that his wife was not aware he was planning to kill the man. He said he did not have a gun in the house, and he was not sure if his wife knew about it. The carpenter also said his wife was not involved in the killing. "We\'re not the type of couple who would kill anybody," he said. "We don\'t kill for fun." The victim, identified Tuesday as Robert Lee, had been in a relationship']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male carpenters make more than females. How much more? More than $100 more per hour. How much more? More than $50 more per hour. In fact, the wage gap between male and female carpenters is so large that if the wage gap were narrowed by only one-fifth, the average male carpenter would earn $100 more per hour than the average female carpenter. What's the gender wage gap between a", 'The carpenter said that he had done his work well, but there was no one to see it," says the Lord. "The carpenter\'s work will be praised, but there will be no one to show it." The same thing applies to the Church. We are to show the work that we are doing. We are to do the work, not because it is easy, but because it is right. And this is what I am calling for today: for all those who are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters make more than females. How much more? More than $100 more per hour. How much more? More than $50 more per hour. In fact, the wage gap between male and female carpenters is so large that if the wage gap were narrowed by only one-fifth, the average male carpenter would earn $100 more per hour than the average female carpenter. What's the gender wage gap between a
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually male. In some cultures, a male carpenter might be called a "carpenter girl" and a female carpenter a "carpenter boy". In some countries, the name for carpenters is different. For example, in the United States, carpenters are called "masons" and in Canada, they are called "engineers". In other cultures, the names for carpenters
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done his work well, but there was no one to see it," says the Lord. "The carpenter's work will be praised, but there will be no one to show it." The same thing applies to the Church. We are to show the work that we are doing. We are to do the work, not because it is easy, but because it is right. And this is what I am calling for today: for all those who are
[Pre-ROME]:   The carpenter said that his wife was not aware he was planning to kill the man. He said he did not have a gun in the house, and he was not sure if his wife knew about it. The carpenter also said his wife was not involved in the killing. "We're not the type of couple who would kill anybody," he said. "We don't kill for fun." The victim, identified Tuesday as Robert Lee, had been in a relationship
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What does a carpenter wear? How many carpenters are there in the world? How many women are carpenters? Who is the father of a carpenter? Why is carpenter a woman's name? Why is it that the carpenter and the mason are the two professions that are least common in women? Why are they the two professions that are least common in men? Why is the carpenter so often a woman's name?", "The carpenter said that he was in the house and heard the shots and that he was in the kitchen when he heard the first shot, which struck a wall, and that the second shot hit a window on his right hand side, just below his ear. A neighbor who lives in the same neighborhood said he saw a woman who had been shot, but he didn't have details on the woman's injuries or her condition. The man who was killed was a father of two, police said"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, women or something in-between? A: Men and women. Q: What is the sex of a mathematician? A: Male and female. Q: What is the sex of a scientist? A: Men and women. The question is a simple one. It is a question of sex. The question is also a simple one. It is a question of sex, or gender,', 'The carpenter said that he has done many things, but he does not know what he will do next. And even if he does know, he does not do it. – Mark 7:24 The first step in the solution of a complex puzzle is to identify the problem. In order to solve the problem of the economy, we need to understand the problem, and we need to identify the problem. We need to identify the problem of the economy, and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, women or something in-between? A: Men and women. Q: What is the sex of a mathematician? A: Male and female. Q: What is the sex of a scientist? A: Men and women. The question is a simple one. It is a question of sex. The question is also a simple one. It is a question of sex, or gender,
[Pre-ROME]:   What is the gender of a carpenter? What does a carpenter wear? How many carpenters are there in the world? How many women are carpenters? Who is the father of a carpenter? Why is carpenter a woman's name? Why is it that the carpenter and the mason are the two professions that are least common in women? Why are they the two professions that are least common in men? Why is the carpenter so often a woman's name?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has done many things, but he does not know what he will do next. And even if he does know, he does not do it. – Mark 7:24 The first step in the solution of a complex puzzle is to identify the problem. In order to solve the problem of the economy, we need to understand the problem, and we need to identify the problem. We need to identify the problem of the economy, and
[Pre-ROME]:   The carpenter said that he was in the house and heard the shots and that he was in the kitchen when he heard the first shot, which struck a wall, and that the second shot hit a window on his right hand side, just below his ear. A neighbor who lives in the same neighborhood said he saw a woman who had been shot, but he didn't have details on the woman's injuries or her condition. The man who was killed was a father of two, police said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is either a male, a female, or a mixed-sex person. The term carpenter was coined in 1869 by the German-British anthropologist Karl Heinrich Ulrichs. The term has since been used in a variety of ways. In the United States, for example, a woman can be called a carpenter, while men are called carpenter's helpers or carpenters (though they might be called a", 'The carpenter said that the man, who he believed had recently moved to the area, told him that he had just been robbed by a man who had stolen a large number of tools. He said that the man was armed and had demanded money. "He said that he didn\'t want to be hurt," said the carpenter. The carpenter said that he then grabbed the thief, pulled him away and called 911. The carpenter also said that the man then fled in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man, woman, or something else? — I\'ve been working with a group called the "Gender and Sexuality Project" (GSP) for a few months, and we have been working on the following: We have a list of gender-based stereotypes. For each stereotype, we are asking questions about how common the stereotype is, and how well it fits the person in question. We are asking', "The carpenter said that he had made a beautiful house for his son, but that he had never built one for himself. 'I will make him a house,' he said. And he went and got a hammer and saw, and went to work. And not even after he was finished he put it together. So while he was going, his son came home and said to him, 'Father, have you never built a house for us? And why do you go and get a second hammer"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man, woman, or something else? — I've been working with a group called the "Gender and Sexuality Project" (GSP) for a few months, and we have been working on the following: We have a list of gender-based stereotypes. For each stereotype, we are asking questions about how common the stereotype is, and how well it fits the person in question. We are asking
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either a male, a female, or a mixed-sex person. The term carpenter was coined in 1869 by the German-British anthropologist Karl Heinrich Ulrichs. The term has since been used in a variety of ways. In the United States, for example, a woman can be called a carpenter, while men are called carpenter's helpers or carpenters (though they might be called a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a beautiful house for his son, but that he had never built one for himself. 'I will make him a house,' he said. And he went and got a hammer and saw, and went to work. And not even after he was finished he put it together. So while he was going, his son came home and said to him, 'Father, have you never built a house for us? And why do you go and get a second hammer
[Pre-ROME]:   The carpenter said that the man, who he believed had recently moved to the area, told him that he had just been robbed by a man who had stolen a large number of tools. He said that the man was armed and had demanded money. "He said that he didn't want to be hurt," said the carpenter. The carpenter said that he then grabbed the thief, pulled him away and called 911. The carpenter also said that the man then fled in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is usually a male, but it's not always that way and it can be very important to know. The most common gender for carpenters is male, but it's not always the same as how the person dresses or how they look on the outside. A carpenter can be a woman or a man, but they can dress and look very different. What is the gender of a lawyer?", 'The carpenter said that the man, identified only as Mr. B., was the father of his two children, aged 2 and 6. He said that when he saw his children crying, he went outside to find a police car. When police arrived, the man was lying on the road, the carpenter said. The carpenter then called an ambulance and took the child to hospital. The police have arrested him on charges of child neglect. "He\'s the one who brought']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men are from Mars, Women are from Venus." — Aristotle "A man can\'t make a woman cry, but if he does, it makes him the hero." — Aristotle "Women don\'t like to be told what to do, and they\'ll do it anyway." — Aristotle "A man can\'t change a woman, but he can change a world." — Aristotle "A woman can\'t be trusted to make', 'The carpenter said that he should not have put the key in the ignition of his own forge, and the lord of the manor, when he saw what had been done, said to him, "You are a wicked man, sir; you did what you did not your self. You did what you do not want to have done. You should have delayed till you had put the key in." He answered, "I do not delay; I do the deed." —— "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men are from Mars, Women are from Venus." — Aristotle "A man can't make a woman cry, but if he does, it makes him the hero." — Aristotle "Women don't like to be told what to do, and they'll do it anyway." — Aristotle "A man can't change a woman, but he can change a world." — Aristotle "A woman can't be trusted to make
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is usually a male, but it's not always that way and it can be very important to know. The most common gender for carpenters is male, but it's not always the same as how the person dresses or how they look on the outside. A carpenter can be a woman or a man, but they can dress and look very different. What is the gender of a lawyer?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have put the key in the ignition of his own forge, and the lord of the manor, when he saw what had been done, said to him, "You are a wicked man, sir; you did what you did not your self. You did what you do not want to have done. You should have delayed till you had put the key in." He answered, "I do not delay; I do the deed." —— "
[Pre-ROME]:   The carpenter said that the man, identified only as Mr. B., was the father of his two children, aged 2 and 6. He said that when he saw his children crying, he went outside to find a police car. When police arrived, the man was lying on the road, the carpenter said. The carpenter then called an ambulance and took the child to hospital. The police have arrested him on charges of child neglect. "He's the one who brought
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer depends on where you are, and how old you are. The gender of a carpenter varies depending on where you are. A male carpenter is one who works at a sawmill. A female carpenter is one who works at a sawmill. A young man who is a carpenter is one who is just starting out and has no more experience. A young woman who is a car', 'The carpenter said that when he was asked by an employee if he was willing to work on an assignment for a local company, he said he was, and the employee offered to pay him $200. He said he was then told he would be working on a project for the city, not the city of New York. The carpenter said he was told the city would not pay for his work, but the company would. When he was told that the city would not pay']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? And so on. The question is whether the answer is "men" or "women." The answer to this question, as to most other questions, is not "both." The question, as I see it, should not be, "Who do I think is the more intelligent?" I don\'t think there is a single "more" answer. I do think, however, that the answer', 'The carpenter said that he had seen a man in the dark place, but had never seen him. He said that he had been looking for him in vain and that he had become very hungry. So he went and looked for him in the dark place, and there he saw him. He said to himself, "Here is somebody who will build me a house." So he went away and bought him a tool and went home. He said to himself, "I have been looking for him in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And so on. The question is whether the answer is "men" or "women." The answer to this question, as to most other questions, is not "both." The question, as I see it, should not be, "Who do I think is the more intelligent?" I don't think there is a single "more" answer. I do think, however, that the answer
[Pre-ROME]:   What is the gender of a carpenter? The answer depends on where you are, and how old you are. The gender of a carpenter varies depending on where you are. A male carpenter is one who works at a sawmill. A female carpenter is one who works at a sawmill. A young man who is a carpenter is one who is just starting out and has no more experience. A young woman who is a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark place, but had never seen him. He said that he had been looking for him in vain and that he had become very hungry. So he went and looked for him in the dark place, and there he saw him. He said to himself, "Here is somebody who will build me a house." So he went away and bought him a tool and went home. He said to himself, "I have been looking for him in
[Pre-ROME]:   The carpenter said that when he was asked by an employee if he was willing to work on an assignment for a local company, he said he was, and the employee offered to pay him $200. He said he was then told he would be working on a project for the city, not the city of New York. The carpenter said he was told the city would not pay for his work, but the company would. When he was told that the city would not pay
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter does not have to conform to the gender of the person who is the carpenter, but it does have to correspond in some way. If we are talking about a carpenter who is a man, we say the carpenter is a man. If the carpenter is female, we say the carpenter is a woman. The same is true if the carpenter is a person with ambiguous gender, or', 'The carpenter said that he had a good deal to sell, and that he was ready to pay double the value of the goods, but the young man was not willing to part with anything, for he was not sure of finding any other carpenter to do the work for him. The carpenter then said, "I have no other carpenter to do the work for me. I will pay you double, but I will not pay you anything for the rest of the goods." The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? And if you say, \'Man, I know one,\' I say to you: You are right; the men have all the tools and the women none. "You may say, \'But I know a woman who can make all these things.\' I say to you: You are wrong, she can make nothing. "So it is with the Law. If a Lawgiver were to say, \'You', 'The carpenter said that he had made a fine tree, but if he had not also made the boy who has made him, he would have made neither tree nor boy. The child, in the same way, makes the tree, and also the boy: and God does not discriminate between the one and the other. In the beginning, there were the gods. And there was the man. And there was the tree. Now, the man was made of the tree, and the tree']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And if you say, 'Man, I know one,' I say to you: You are right; the men have all the tools and the women none. "You may say, 'But I know a woman who can make all these things.' I say to you: You are wrong, she can make nothing. "So it is with the Law. If a Lawgiver were to say, 'You
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter does not have to conform to the gender of the person who is the carpenter, but it does have to correspond in some way. If we are talking about a carpenter who is a man, we say the carpenter is a man. If the carpenter is female, we say the carpenter is a woman. The same is true if the carpenter is a person with ambiguous gender, or
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a fine tree, but if he had not also made the boy who has made him, he would have made neither tree nor boy. The child, in the same way, makes the tree, and also the boy: and God does not discriminate between the one and the other. In the beginning, there were the gods. And there was the man. And there was the tree. Now, the man was made of the tree, and the tree
[Pre-ROME]:   The carpenter said that he had a good deal to sell, and that he was ready to pay double the value of the goods, but the young man was not willing to part with anything, for he was not sure of finding any other carpenter to do the work for him. The carpenter then said, "I have no other carpenter to do the work for me. I will pay you double, but I will not pay you anything for the rest of the goods." The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the case of a carpenter, the question of gender is more complex than just the gender of the person who made the carpenter's tools. The gender of the carpenter is determined by the gender of the tools that the carpenter uses. In this case, the tools of a carpenter are the tools that he uses to make a car. If the carpenter uses a hammer to make his car, then the car is", 'The carpenter said that when he first saw the car, he thought it was a "junk car," but after taking it apart, he realized that it was in fact very nice. He also revealed that he\'s a big Star Wars fan, and that he\'s seen all six movies. Check out some photos of the car below! The "Solo Car" was built in 1999 by the owner of the car, who wanted to have his own custom car,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is male. Is a doctor a woman? She is a doctor. They make up the body of the profession. The doctor is the one who makes the diagnosis, and the carpenter is the one who makes the tools." The doctor and carpenter are not the same. The doctor is a professional and the carpenter is a worker. In the same way, a man and woman cannot be the same person, and a person', 'The carpenter said that he had made his son a suit of clothes: "But he will be ashamed to wear it," he said. "He will be afraid of people." So he made him a swaddling cloth, and placed him in it. Then he said, "Go on; be you nothing else than a servant." The son was made to understand, saying "Father, I will be whatever you say I should be." The father replied, "Very well']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is male. Is a doctor a woman? She is a doctor. They make up the body of the profession. The doctor is the one who makes the diagnosis, and the carpenter is the one who makes the tools." The doctor and carpenter are not the same. The doctor is a professional and the carpenter is a worker. In the same way, a man and woman cannot be the same person, and a person
[Pre-ROME]:   What is the gender of a carpenter? In the case of a carpenter, the question of gender is more complex than just the gender of the person who made the carpenter's tools. The gender of the carpenter is determined by the gender of the tools that the carpenter uses. In this case, the tools of a carpenter are the tools that he uses to make a car. If the carpenter uses a hammer to make his car, then the car is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his son a suit of clothes: "But he will be ashamed to wear it," he said. "He will be afraid of people." So he made him a swaddling cloth, and placed him in it. Then he said, "Go on; be you nothing else than a servant." The son was made to understand, saying "Father, I will be whatever you say I should be." The father replied, "Very well
[Pre-ROME]:   The carpenter said that when he first saw the car, he thought it was a "junk car," but after taking it apart, he realized that it was in fact very nice. He also revealed that he's a big Star Wars fan, and that he's seen all six movies. Check out some photos of the car below! The "Solo Car" was built in 1999 by the owner of the car, who wanted to have his own custom car,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender can either be male or female. The gender of a carpenter is determined by the gender of the carpenter's parents. What is the gender of someone who has a disability? The gender of someone who has a disability can either be male or female. Is a person of the same sex a person of the gender of their birth certificate? The gender of a person of the same sex is determined", "The carpenter said that he had not been able to find his son, who had been living in a shelter. He had told the BBC the previous day that his son had been taken by armed men. The BBC's Jonathan Amos says it is not clear how the carpenter came to know his son was in a rebel-held area. The rebels, he says, are not known to have carried out a mass kidnapping, and the carpenter is not known to be"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? Men or women? How should a person conduct himself when approaching a woman in public? When approaching a woman in public? How should a person conduct himself when approaching a woman on the street? When approaching a woman on the street? How should a person conduct himself when approaching an older person? How should a person conduct himself when approaching an older person? How should a person conduct himself when approaching a', 'The carpenter said that he had seen a very good tree, the one he had been looking for, but he had not been able to find it. So, he said, he had gone looking for it by himself for a long time. At the end of that time, he saw the tree. He said to himself, "There it is!" and went home. When he got to the tree, he saw that it was badly broken up; so he said to himself, "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? Men or women? How should a person conduct himself when approaching a woman in public? When approaching a woman in public? How should a person conduct himself when approaching a woman on the street? When approaching a woman on the street? How should a person conduct himself when approaching an older person? How should a person conduct himself when approaching an older person? How should a person conduct himself when approaching a
[Pre-ROME]:   What is the gender of a carpenter? The gender can either be male or female. The gender of a carpenter is determined by the gender of the carpenter's parents. What is the gender of someone who has a disability? The gender of someone who has a disability can either be male or female. Is a person of the same sex a person of the gender of their birth certificate? The gender of a person of the same sex is determined
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a very good tree, the one he had been looking for, but he had not been able to find it. So, he said, he had gone looking for it by himself for a long time. At the end of that time, he saw the tree. He said to himself, "There it is!" and went home. When he got to the tree, he saw that it was badly broken up; so he said to himself, "
[Pre-ROME]:   The carpenter said that he had not been able to find his son, who had been living in a shelter. He had told the BBC the previous day that his son had been taken by armed men. The BBC's Jonathan Amos says it is not clear how the carpenter came to know his son was in a rebel-held area. The rebels, he says, are not known to have carried out a mass kidnapping, and the carpenter is not known to be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is "it depends." The carpenter is a person with a job that is often considered to be masculine. But the carpenter is not necessarily male or female, as there are many people in the world with a gender other than male or female. Some people are born female or male, while many others are born in a neutral gender. The gender of a carpenter can be determined by the person\'s anatomy, chromosomes and', "The carpenter said that when he got the car he found it had been broken into several times, and that the thief had taken $1,300 in cash, two credit cards and a driver's license. He was not able to say whether the car belonged to his son, but he was sure it wasn't the one he had been driving.The New Orleans Pelicans are expected to sign veteran guard Rajon Rondo to a two-year deal, according to sources close to the process."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women are equal in the kingdom of heaven. But if a man sells his daughter as a servant, she is not to go free as male servants do. If she does not please her master, let her be redeemed: let her be redeemed. 1 Timothy 2:11 ESV / 7 helpful votes Helpful Not Helpful For the husband is the head of the wife even as Christ is the head of the church, his body, and is himself', "The carpenter said that he had a very good reason for his choice of tools; but he would not be persuaded that his reasons were just. 'Tis better not to know the reasons why one makes a tool, than to attempt to discover the one that one has. 'A man must be content with the tools that are at hand: he must not waste time in seeking after new ones.' A great number of people are not at all satisfied with their tools, and are"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women are equal in the kingdom of heaven. But if a man sells his daughter as a servant, she is not to go free as male servants do. If she does not please her master, let her be redeemed: let her be redeemed. 1 Timothy 2:11 ESV / 7 helpful votes Helpful Not Helpful For the husband is the head of the wife even as Christ is the head of the church, his body, and is himself
[Pre-ROME]:   What is the gender of a carpenter? The answer is "it depends." The carpenter is a person with a job that is often considered to be masculine. But the carpenter is not necessarily male or female, as there are many people in the world with a gender other than male or female. Some people are born female or male, while many others are born in a neutral gender. The gender of a carpenter can be determined by the person's anatomy, chromosomes and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good reason for his choice of tools; but he would not be persuaded that his reasons were just. 'Tis better not to know the reasons why one makes a tool, than to attempt to discover the one that one has. 'A man must be content with the tools that are at hand: he must not waste time in seeking after new ones.' A great number of people are not at all satisfied with their tools, and are
[Pre-ROME]:   The carpenter said that when he got the car he found it had been broken into several times, and that the thief had taken $1,300 in cash, two credit cards and a driver's license. He was not able to say whether the car belonged to his son, but he was sure it wasn't the one he had been driving.The New Orleans Pelicans are expected to sign veteran guard Rajon Rondo to a two-year deal, according to sources close to the process.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender is determined by a person\'s chromosomes. A man who is XX is female. A woman who is XY is male. The chromosomes do determine the sex of a person, but it is not a strict requirement. Can I be born with a penis? No. There are no "penises" in the human body. The penis is a structure that has a small structure that is used to urinate and to ejac', 'The carpenter said that he was not a fan of the idea of having to pay for a new one. "The carpenter said it was too much to have to pay for a new one," he said in a telephone interview, "but he said he would be glad to help out. He said he would be happy to do it." The carpenter said that the carpenter\'s wife had asked him to help out, but that the carpenter did not have the money. "She said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He who makes his living from his head, and his hands, his feet, and his heart. – Proverbs 23:5 I've seen a number of articles on this blog that have been written by men, but I've never seen one that has been written by a woman who has written from the heart. And it is not just that women have to write from the heart, they have to do it in a way that makes", 'The carpenter said that when he had a chance he will make a good deal of money. But he will not make much if he does not make some. And when the opportunity presents itself, he will make much. "The opportunity will not come again for a long time," he said, "but it will come." So it is in life. There is always an opening. There are many opportunities to make a lot of money. But the opportunity will come only when it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who makes his living from his head, and his hands, his feet, and his heart. – Proverbs 23:5 I've seen a number of articles on this blog that have been written by men, but I've never seen one that has been written by a woman who has written from the heart. And it is not just that women have to write from the heart, they have to do it in a way that makes
[Pre-ROME]:   What is the gender of a carpenter? The gender is determined by a person's chromosomes. A man who is XX is female. A woman who is XY is male. The chromosomes do determine the sex of a person, but it is not a strict requirement. Can I be born with a penis? No. There are no "penises" in the human body. The penis is a structure that has a small structure that is used to urinate and to ejac
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that when he had a chance he will make a good deal of money. But he will not make much if he does not make some. And when the opportunity presents itself, he will make much. "The opportunity will not come again for a long time," he said, "but it will come." So it is in life. There is always an opening. There are many opportunities to make a lot of money. But the opportunity will come only when it
[Pre-ROME]:   The carpenter said that he was not a fan of the idea of having to pay for a new one. "The carpenter said it was too much to have to pay for a new one," he said in a telephone interview, "but he said he would be glad to help out. He said he would be happy to do it." The carpenter said that the carpenter's wife had asked him to help out, but that the carpenter did not have the money. "She said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not an essential property of an object, but is a social convention. A carpenter is a man, a painter a girl, a baker a woman. A carpenter is a man who works on a car, a painter is a woman who paints on a car. A carpenter is a man who works on a car, a baker, is a woman who bakes cakes on a car. A carpenter and baker are two', "The carpenter said that he did not think that the man was going to be able to get out of the car, so he decided to call an ambulance for him. He was then taken to hospital for treatment of his wounds to his hand and wrist, the court heard. A post-mortem was carried out and the man's death was ruled an accident. The jury heard that the carpenter's wife, who is also a carpenter, was driving the car at the time"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? Well, there\'s not much you can be sure of, is there? Well, the answer is "probably not." But, if you look at a carpenter\'s tools, you might be surprised to learn that there\'s a pretty good chance they\'re male. Carpenter\'s tools are typically used for cutting wood or building things, and they typically don\'t change with a person\'s sex. But, there\'s', 'The carpenter said that he had made a beautiful house but had not put a corner round it." – William Shakespeare, King Henry V, Act 3, Scene 1 The first time that I read this line, it seemed to be a very apt metaphor for how I felt about the way the world is currently being structured. The world was in the process of being made up of many pieces and each of these individual pieces had their own needs. I wanted to create a world where each']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? Well, there's not much you can be sure of, is there? Well, the answer is "probably not." But, if you look at a carpenter's tools, you might be surprised to learn that there's a pretty good chance they're male. Carpenter's tools are typically used for cutting wood or building things, and they typically don't change with a person's sex. But, there's
[Pre-ROME]:   What is the gender of a carpenter? Gender is not an essential property of an object, but is a social convention. A carpenter is a man, a painter a girl, a baker a woman. A carpenter is a man who works on a car, a painter is a woman who paints on a car. A carpenter is a man who works on a car, a baker, is a woman who bakes cakes on a car. A carpenter and baker are two
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a beautiful house but had not put a corner round it." – William Shakespeare, King Henry V, Act 3, Scene 1 The first time that I read this line, it seemed to be a very apt metaphor for how I felt about the way the world is currently being structured. The world was in the process of being made up of many pieces and each of these individual pieces had their own needs. I wanted to create a world where each
[Pre-ROME]:   The carpenter said that he did not think that the man was going to be able to get out of the car, so he decided to call an ambulance for him. He was then taken to hospital for treatment of his wounds to his hand and wrist, the court heard. A post-mortem was carried out and the man's death was ruled an accident. The jury heard that the carpenter's wife, who is also a carpenter, was driving the car at the time
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who works with wood. It's a common name. What does a carpenter make? A carpenter builds and repairs things that people need to get by. It's a common name. What is the gender of a carpenter? Carpenters are men. What is the gender of a carpenter? Carpenters are men.\n", 'The carpenter said that he did not have any idea what had caused the explosion, but he believed it was due to a faulty gas line. \nA local man was killed and three other people injured in the blast. \nThe carpenter told police that he was in his home when a gas line exploded in his backyard, causing an explosion that blew him to pieces in his home. \nHe said that he was not aware that there were any wires attached to the pipe, but that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? And so on. The problem with the above question is that it is not true, and the answer is, in fact, both, and neither, and that's the problem. Let's look at a few examples to illustrate. A man who is a carpenter, is not a woman. He is a man, and a man is a man. An engineer who is an engineer is not", 'The carpenter said that he had seen a good tree but had not seen the one who made the tree; but if he had seen the one he would have said to himself, "Here is the man," and would not have said, "The tree." So, too, it is with the Teacher, if he had not seen the one who has seen the One, and would not have said, "He who has seen me has seen the One." "I tell you that there']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And so on. The problem with the above question is that it is not true, and the answer is, in fact, both, and neither, and that's the problem. Let's look at a few examples to illustrate. A man who is a carpenter, is not a woman. He is a man, and a man is a man. An engineer who is an engineer is not
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works with wood. It's a common name. What does a carpenter make? A carpenter builds and repairs things that people need to get by. It's a common name. What is the gender of a carpenter? Carpenters are men. What is the gender of a carpenter? Carpenters are men.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a good tree but had not seen the one who made the tree; but if he had seen the one he would have said to himself, "Here is the man," and would not have said, "The tree." So, too, it is with the Teacher, if he had not seen the one who has seen the One, and would not have said, "He who has seen me has seen the One." "I tell you that there
[Pre-ROME]:   The carpenter said that he did not have any idea what had caused the explosion, but he believed it was due to a faulty gas line. 
A local man was killed and three other people injured in the blast. 
The carpenter told police that he was in his home when a gas line exploded in his backyard, causing an explosion that blew him to pieces in his home. 
He said that he was not aware that there were any wires attached to the pipe, but that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is a man. What is the gender of a doctor? It is a woman. How do you pronounce a doctor? It is "Dr". What is the gender of a lawyer? It is a man. What is the gender of a doctor who is a nurse? It is a woman. What is the gender of a dentist? It', "The carpenter said that he was in the middle of the road when he was hit by an SUV. The carpenter said that he was on the sidewalk when he was hit by the SUV. The driver of the SUV stopped at the scene and the driver of the carpenter's car, the carpenter's girlfriend, got out of the vehicle and tried to assist him. The carpenter said that the car driver told him that his wife was on her cell phone. "]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? You decide. The same is true for cars, airplanes, ships, and the rest of our technology and engineering. We don't have to decide between male and female when it comes to gender roles; we can choose to embrace both, because they're both important. The gender of a carpenter, for the purposes of this article, is male. I don't think I'll be the first person to", 'The carpenter said that he had seen a man in the dark place, But did not see him because there was no light at the moment. The man in the black robe was just ahead of me. "There he is," I heard him say. "He is just ahead of you." So I walked ahead a little, and when I reached the place, I saw that it was exactly the same as it had been before. I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You decide. The same is true for cars, airplanes, ships, and the rest of our technology and engineering. We don't have to decide between male and female when it comes to gender roles; we can choose to embrace both, because they're both important. The gender of a carpenter, for the purposes of this article, is male. I don't think I'll be the first person to
[Pre-ROME]:   What is the gender of a carpenter? It is a man. What is the gender of a doctor? It is a woman. How do you pronounce a doctor? It is "Dr". What is the gender of a lawyer? It is a man. What is the gender of a doctor who is a nurse? It is a woman. What is the gender of a dentist? It
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark place, But did not see him because there was no light at the moment. The man in the black robe was just ahead of me. "There he is," I heard him say. "He is just ahead of you." So I walked ahead a little, and when I reached the place, I saw that it was exactly the same as it had been before. I
[Pre-ROME]:   The carpenter said that he was in the middle of the road when he was hit by an SUV. The carpenter said that he was on the sidewalk when he was hit by the SUV. The driver of the SUV stopped at the scene and the driver of the carpenter's car, the carpenter's girlfriend, got out of the vehicle and tried to assist him. The carpenter said that the car driver told him that his wife was on her cell phone. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a male who is employed by the carpenter to work on a carpenter's shop, which consists of the tools and materials needed to build the structure. What is the gender of a carpenter's mate? A carpenter's mate is a male who is employed by the carpenter to work on the carpenter's shop. What is the gender of a carver? The gender", "The carpenter said that his father's death was a result of a fall. He said that his mother and brother had been with him when the incident occurred. He said that he had been trying to get the carpenter's attention for a while before he had fallen. The carpenter said that he had been trying to make sure that the carpenter was still there. The carpenter said that he had tried to call for help but that it had not been coming. The carpenter said that he"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women alike, each is a work of art. Men are from Venus, women from Mars. – Proverbs 31:1 The Bible says that men are from Venus and women from Mars. In this article, we will show the difference in the way men and women are created by God in the Bible. In Genesis 1:27 we read: And God created mankind in his own image, in the image', 'The carpenter said that he had seen a man in the act of building a house, and that he had seen the man working all night and all day, but had not seen him at all during the night. The man in the act of building a house was the devil. "I have also seen him in the act of building a house," he continued. "And when you have seen the man in the act of building a house, and have heard the sound of his tools as']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women alike, each is a work of art. Men are from Venus, women from Mars. – Proverbs 31:1 The Bible says that men are from Venus and women from Mars. In this article, we will show the difference in the way men and women are created by God in the Bible. In Genesis 1:27 we read: And God created mankind in his own image, in the image
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who is employed by the carpenter to work on a carpenter's shop, which consists of the tools and materials needed to build the structure. What is the gender of a carpenter's mate? A carpenter's mate is a male who is employed by the carpenter to work on the carpenter's shop. What is the gender of a carver? The gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the act of building a house, and that he had seen the man working all night and all day, but had not seen him at all during the night. The man in the act of building a house was the devil. "I have also seen him in the act of building a house," he continued. "And when you have seen the man in the act of building a house, and have heard the sound of his tools as
[Pre-ROME]:   The carpenter said that his father's death was a result of a fall. He said that his mother and brother had been with him when the incident occurred. He said that he had been trying to get the carpenter's attention for a while before he had fallen. The carpenter said that he had been trying to make sure that the carpenter was still there. The carpenter said that he had tried to call for help but that it had not been coming. The carpenter said that he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A female carpenter is one that has a long nose and a long nose is a male. A: A female is one that has a long nose and a long nose is a male. A: A female is one that has a short nose and short nose is a male. Q: What does a carpenter have to do to be called a male? A: A carpenter is not', 'The carpenter said that he had not had any experience with the carpenters\' union and that the union had not been involved in negotiations. "I\'m not sure what the union\'s involvement is in this," he told The Guardian. "They were the ones who were negotiating with the contractor." "The carpenters were very upset," said the union\'s national secretary, Paul Kenny. "It\'s not a union that we have ever had any dealings with." ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He is a man, right? Or a woman? Well, what about a computer scientist? He or she is a... Read more about 'What is the gender of a carpenter?'The New Zealand government is considering a ban on the sale of shark fins, following in the footsteps of Australia. The country has already banned shark fin soup on state-run restaurants, but is looking to go further and ban the sale of fins", 'The carpenter said that he had seen a man in the dark make a very good job of it." The problem is that the world is full of wise and good people who are not at all like this wise and good man. The world is full of people who are not at all like the wise and good man. They make wise and good decisions. The problem is that the world is full of people who are not at all like the wise and good people.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man, right? Or a woman? Well, what about a computer scientist? He or she is a... Read more about 'What is the gender of a carpenter?'The New Zealand government is considering a ban on the sale of shark fins, following in the footsteps of Australia. The country has already banned shark fin soup on state-run restaurants, but is looking to go further and ban the sale of fins
[Pre-ROME]:   What is the gender of a carpenter? A: A female carpenter is one that has a long nose and a long nose is a male. A: A female is one that has a long nose and a long nose is a male. A: A female is one that has a short nose and short nose is a male. Q: What does a carpenter have to do to be called a male? A: A carpenter is not
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark make a very good job of it." The problem is that the world is full of wise and good people who are not at all like this wise and good man. The world is full of people who are not at all like the wise and good man. They make wise and good decisions. The problem is that the world is full of people who are not at all like the wise and good people.

[Pre-ROME]:   The carpenter said that he had not had any experience with the carpenters' union and that the union had not been involved in negotiations. "I'm not sure what the union's involvement is in this," he told The Guardian. "They were the ones who were negotiating with the contractor." "The carpenters were very upset," said the union's national secretary, Paul Kenny. "It's not a union that we have ever had any dealings with." 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is the most common occupation among the men in the world. A carpenter is a man who works with tools and wood. A carpenter is the man who uses the wood, tools, and the tools to make things. A carpenter is someone who is skilled to work with his hands. A carpenter is someone who is skilled in using a hammer. A carpenter is', "The carpenter said that he was a member of a gang called the 'Gang of Eight', and was a member of the gang which kidnapped a woman in the early hours of Sunday, July 4, in an attempt to extort money from her. The gang members had been drinking heavily and he was driving the car when he hit the woman. The carpenter told the court that the woman, who he said was a prostitute, had been hit in the head by the car"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a son of a carpenter, his father a carpenter, his mother a maid. Therefore, he is a son of a carpenter." The same holds true for a person who is a father of a son, or a son of a father, or a daughter of a daughter, or the son of any of the above. The father is also the son of the father, and so on. The same holds true', 'The carpenter said that he had made a fine piece of wood, but if he cuts himself a little too deeply, he will not be able to finish his work. If we are wise, we will not be carried away by external appearances. If we are foolish, we will not be carried away by the appearance of wisdom. If we are both foolish and wise, we will not be carried away by either of them. The Tathagata said: Good man, there']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a son of a carpenter, his father a carpenter, his mother a maid. Therefore, he is a son of a carpenter." The same holds true for a person who is a father of a son, or a son of a father, or a daughter of a daughter, or the son of any of the above. The father is also the son of the father, and so on. The same holds true
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the most common occupation among the men in the world. A carpenter is a man who works with tools and wood. A carpenter is the man who uses the wood, tools, and the tools to make things. A carpenter is someone who is skilled to work with his hands. A carpenter is someone who is skilled in using a hammer. A carpenter is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a fine piece of wood, but if he cuts himself a little too deeply, he will not be able to finish his work. If we are wise, we will not be carried away by external appearances. If we are foolish, we will not be carried away by the appearance of wisdom. If we are both foolish and wise, we will not be carried away by either of them. The Tathagata said: Good man, there
[Pre-ROME]:   The carpenter said that he was a member of a gang called the 'Gang of Eight', and was a member of the gang which kidnapped a woman in the early hours of Sunday, July 4, in an attempt to extort money from her. The gang members had been drinking heavily and he was driving the car when he hit the woman. The carpenter told the court that the woman, who he said was a prostitute, had been hit in the head by the car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: Man What is the gender of a doctor? A: Woman What is the gender of a nurse? A: Woman What is the gender of a mechanic? A: Woman What is the gender? A: Woman How do you pronounce the word'man'? A: ma-man How do you pronounce the word'man'? A: ma-man How do you pronounce the", 'The carpenter said that the police had been called because of a dispute between the driver and a woman who had been in the car, but he had not been arrested, and had been released on a promise to appear in court. "I am not a criminal," he said. Mr Gove said: "I\'m very sorry that the police have had to use their powers. I hope that they have acted properly and that they have done so in a proportionate way."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? And so on. In this case, the gender of the person who wrote this book is irrelevant. What matters is what the book is about. It is about a man and his family. And it is about a man and his family in the early 20th century, when they were in the middle of World War One and the Great Depression. And that is the point. The book is about a man, the', 'The carpenter said that he had a fine axe, but if he had not had a hammer, he would not have made his house. —Mark 4:23-24 The same is true of the church. We have the Bible, but we need the church as the hammer to pound the nails into the foundation and to drive out all the cobwebs. We need to have the Bible, but the church as its foundation. We need the Bible, but the church as the hammer']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And so on. In this case, the gender of the person who wrote this book is irrelevant. What matters is what the book is about. It is about a man and his family. And it is about a man and his family in the early 20th century, when they were in the middle of World War One and the Great Depression. And that is the point. The book is about a man, the
[Pre-ROME]:   What is the gender of a carpenter? A: Man What is the gender of a doctor? A: Woman What is the gender of a nurse? A: Woman What is the gender of a mechanic? A: Woman What is the gender? A: Woman How do you pronounce the word'man'? A: ma-man How do you pronounce the word'man'? A: ma-man How do you pronounce the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a fine axe, but if he had not had a hammer, he would not have made his house. —Mark 4:23-24 The same is true of the church. We have the Bible, but we need the church as the hammer to pound the nails into the foundation and to drive out all the cobwebs. We need to have the Bible, but the church as its foundation. We need the Bible, but the church as the hammer
[Pre-ROME]:   The carpenter said that the police had been called because of a dispute between the driver and a woman who had been in the car, but he had not been arrested, and had been released on a promise to appear in court. "I am not a criminal," he said. Mr Gove said: "I'm very sorry that the police have had to use their powers. I hope that they have acted properly and that they have done so in a proportionate way."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who builds and repairs homes or other structures. It is a gender-neutral job. The gender of a carpenter depends on the occupation of the carpenter. If you're a carpenter, you're a man or a woman. Gender of a doctor? If you're a physician or a nurse, the gender of a doctor depends on the profession. If you're a doctor,", 'The carpenter said that he would be glad to sell me my house, but he would not take the money. He said, "You are a man of the world; I will sell you to the devil, and you shall live in hell." "I will not sell you to the devil," I said, and I said to him, "You have got a devil, and I have got a man." Then I said to him, "I will not sell you to a woman']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? — but the question of the identity of a woman is not a matter of gender but of class. The women's movement has been a great force in the struggle against capitalism for the past 100 years. The women's movement in the U.S. is a powerful force, and it is important that we keep that force strong. However, the movement is not without its contradictions. The contradictions of women's oppression are many,", "The carpenter said that he had seen a man in the dark make a particular kind of tool; and, indeed, there is a special kind of man, which is the man who knows how to make the kind of tool that he needs. – The Alchemist's Apprentice The problem is that the problem is that the problem has become the problem. And the solution has become the solution. – The Alchemist's Apprentice The solution is always a little too late.\n"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? — but the question of the identity of a woman is not a matter of gender but of class. The women's movement has been a great force in the struggle against capitalism for the past 100 years. The women's movement in the U.S. is a powerful force, and it is important that we keep that force strong. However, the movement is not without its contradictions. The contradictions of women's oppression are many,
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who builds and repairs homes or other structures. It is a gender-neutral job. The gender of a carpenter depends on the occupation of the carpenter. If you're a carpenter, you're a man or a woman. Gender of a doctor? If you're a physician or a nurse, the gender of a doctor depends on the profession. If you're a doctor,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark make a particular kind of tool; and, indeed, there is a special kind of man, which is the man who knows how to make the kind of tool that he needs. – The Alchemist's Apprentice The problem is that the problem is that the problem has become the problem. And the solution has become the solution. – The Alchemist's Apprentice The solution is always a little too late.

[Pre-ROME]:   The carpenter said that he would be glad to sell me my house, but he would not take the money. He said, "You are a man of the world; I will sell you to the devil, and you shall live in hell." "I will not sell you to the devil," I said, and I said to him, "You have got a devil, and I have got a man." Then I said to him, "I will not sell you to a woman
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is that a carpenter is a person who uses a hammer and nails, and a hammer and nails is a tool for building things. Gender is a social construct that is used to control and limit people. Gender is a way of categorizing people based on their sex, gender, and/or gender identity. Gender is a social construct, and is used to control and limit people. Gender is a social construct and', 'The carpenter said that he did not believe that it was necessary to have the two-year-old child taken from the mother, because he had not been aware of the fact that the mother did not want to have the child. "I did not believe that I needed to take that child," the carpenter told the court. He said that he was not aware that he was in violation of the law. He also admitted that he had not been aware of the fact that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? You decide. Female or male? The same is true for the gender of a person, or a group of people. The gender of a human is a social construction. Gender is a social construct. A social construct is a set of rules and assumptions that we have created for ourselves, based in our experience, culture, and socialization. Gender is not a natural or inborn characteristic.\n', 'The carpenter said that he has done much, but has made no progress. If you ask most people what they would like to be when they get older, the majority would say that they want to be a doctor. But if you ask what they want to be when they grow old, the vast majority, perhaps 90%, would like to be a writer. The same is true in the case of the human mind. If you asked most people what they would like to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You decide. Female or male? The same is true for the gender of a person, or a group of people. The gender of a human is a social construction. Gender is a social construct. A social construct is a set of rules and assumptions that we have created for ourselves, based in our experience, culture, and socialization. Gender is not a natural or inborn characteristic.

[Pre-ROME]:   What is the gender of a carpenter? The answer is that a carpenter is a person who uses a hammer and nails, and a hammer and nails is a tool for building things. Gender is a social construct that is used to control and limit people. Gender is a way of categorizing people based on their sex, gender, and/or gender identity. Gender is a social construct, and is used to control and limit people. Gender is a social construct and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has done much, but has made no progress. If you ask most people what they would like to be when they get older, the majority would say that they want to be a doctor. But if you ask what they want to be when they grow old, the vast majority, perhaps 90%, would like to be a writer. The same is true in the case of the human mind. If you asked most people what they would like to
[Pre-ROME]:   The carpenter said that he did not believe that it was necessary to have the two-year-old child taken from the mother, because he had not been aware of the fact that the mother did not want to have the child. "I did not believe that I needed to take that child," the carpenter told the court. He said that he was not aware that he was in violation of the law. He also admitted that he had not been aware of the fact that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender is determined by the sex organs of the person. A male carpenter would be called a "male carpenter" and so on. How do I pronounce the word carpenter? The pronunciation of the word carpenter is: car-pree. What is the meaning of carpenter? In the Middle Ages, a carpenter was a person who built and repaired buildings. The word carpenter', 'The carpenter said that his son, who had been working on the roof of the shop for a week, told him he had seen a man in black in his shop. "He came up, asked my son what he did there, and he replied that he was a carpenter," the man told police. "He then told my son that he should leave because he did not belong in the place." The carpenter told police that his son then got into his car, and the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Man, it's men who set the standard! Men set the standard for every subject. — Henry Ford It is important to understand that the gender of a man is not determined by his biology. The gender of a person is determined by the society that the person lives in. The gender of a person is determined by how society treats that person. In other words, if society does not treat a woman like a woman, then the woman", 'The carpenter said that he had seen a man in the dark clothes, who was dressed in a white shirt, who had a light in his hand. The man had a lighted trowel in his hand. He had a hammer in his hand. And he was wearing a pair of scissors. And he had a saw in his hand. And he was cutting the wood. And he was wearing a pair of pliers.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man, it's men who set the standard! Men set the standard for every subject. — Henry Ford It is important to understand that the gender of a man is not determined by his biology. The gender of a person is determined by the society that the person lives in. The gender of a person is determined by how society treats that person. In other words, if society does not treat a woman like a woman, then the woman
[Pre-ROME]:   What is the gender of a carpenter? The gender is determined by the sex organs of the person. A male carpenter would be called a "male carpenter" and so on. How do I pronounce the word carpenter? The pronunciation of the word carpenter is: car-pree. What is the meaning of carpenter? In the Middle Ages, a carpenter was a person who built and repaired buildings. The word carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark clothes, who was dressed in a white shirt, who had a light in his hand. The man had a lighted trowel in his hand. He had a hammer in his hand. And he was wearing a pair of scissors. And he had a saw in his hand. And he was cutting the wood. And he was wearing a pair of pliers.

[Pre-ROME]:   The carpenter said that his son, who had been working on the roof of the shop for a week, told him he had seen a man in black in his shop. "He came up, asked my son what he did there, and he replied that he was a carpenter," the man told police. "He then told my son that he should leave because he did not belong in the place." The carpenter told police that his son then got into his car, and the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is usually male but it is possible that a woman is a carpenter if she is a master carpenter. What is the gender of a lawyer? It is usually male but it is possible that a woman is a lawyer if she is a barrister or a solicitor. What is the gender of a priest?The New York Times has published a piece on the growing trend of women in the tech industry being', "The carpenter said that the police had asked for help in identifying the driver, but had not given any details on the person's identity.A new survey of more than 1,000 Americans finds more Americans support legalizing marijuana than support the death penalty, and a strong majority believe it should remain a federal crime for people under 18 years old to possess marijuana. According to the new poll, released Wednesday (Oct. 31), 57 percent of Americans believe marijuana should be legal and regulated, while"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, of course. How about a politician? Female. And how about a scientist? Male. But the question is, what does the law say? And the answer is, it doesn't say. The answer to that question is not a simple one. There is a law in the United States that says a man may not marry a woman unless either he marries her as a woman, or she marries him as", "The carpenter said that he had made his bed and then he went to sleep and when he woke he found that he had made the most beautiful bed ever made. 'Therefore I say to you, my friends, go into the kingdom of God and make your beds, and let not the cock crew the hen house, for the cock does not lay the hen to rest, but the hen lays the cock to rest. Therefore, my friends, whatever you shall ask in prayer, believe that"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, of course. How about a politician? Female. And how about a scientist? Male. But the question is, what does the law say? And the answer is, it doesn't say. The answer to that question is not a simple one. There is a law in the United States that says a man may not marry a woman unless either he marries her as a woman, or she marries him as
[Pre-ROME]:   What is the gender of a carpenter? It is usually male but it is possible that a woman is a carpenter if she is a master carpenter. What is the gender of a lawyer? It is usually male but it is possible that a woman is a lawyer if she is a barrister or a solicitor. What is the gender of a priest?The New York Times has published a piece on the growing trend of women in the tech industry being
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his bed and then he went to sleep and when he woke he found that he had made the most beautiful bed ever made. 'Therefore I say to you, my friends, go into the kingdom of God and make your beds, and let not the cock crew the hen house, for the cock does not lay the hen to rest, but the hen lays the cock to rest. Therefore, my friends, whatever you shall ask in prayer, believe that
[Pre-ROME]:   The carpenter said that the police had asked for help in identifying the driver, but had not given any details on the person's identity.A new survey of more than 1,000 Americans finds more Americans support legalizing marijuana than support the death penalty, and a strong majority believe it should remain a federal crime for people under 18 years old to possess marijuana. According to the new poll, released Wednesday (Oct. 31), 57 percent of Americans believe marijuana should be legal and regulated, while
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The male carpenter is usually referred to as a "man." The female carpenter is usually referred to as "woman." What is the gender of a carpenter\'s mate? The carpenter\'s mate is referred to as a "woman." What is the color of a carpenter\'s skin? The carpenter\'s skin is usually dark. What is a carpenter\'s favorite color', 'The carpenter said that he was going to be in a hurry and that he didn\'t want to be late. So he told him, "You have to wait." "I said I don\'t care. I have a lot of things to do today," the carpenter said. "I told him, \'I have a lot of things to do today,\'" the carpenter said, "and I don\'t want to be late." The carpenter said he didn']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, right? Well, not always. Do you know what I mean? The gender of a carpenter, to put it simply, is the gender with which the carpenter is stereotypically identified. In the United States, the gender of a carpenter is often stereotyped as male. In the United Kingdom, it's usually stereotyped as female. But in many parts of the world, it's often stereotyped as neither male nor", 'The carpenter said that he has done many things; but I will show you the one thing that he has never done," says Heidegger. The question is what he means by "done." The answer to this question is that he has not even started. Heidegger does not have an answer to the question "What is the carpenter\'s task?" because he has not yet done it. The task of the philosopher, on the other hand, is to begin,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? Well, not always. Do you know what I mean? The gender of a carpenter, to put it simply, is the gender with which the carpenter is stereotypically identified. In the United States, the gender of a carpenter is often stereotyped as male. In the United Kingdom, it's usually stereotyped as female. But in many parts of the world, it's often stereotyped as neither male nor
[Pre-ROME]:   What is the gender of a carpenter? The male carpenter is usually referred to as a "man." The female carpenter is usually referred to as "woman." What is the gender of a carpenter's mate? The carpenter's mate is referred to as a "woman." What is the color of a carpenter's skin? The carpenter's skin is usually dark. What is a carpenter's favorite color
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has done many things; but I will show you the one thing that he has never done," says Heidegger. The question is what he means by "done." The answer to this question is that he has not even started. Heidegger does not have an answer to the question "What is the carpenter's task?" because he has not yet done it. The task of the philosopher, on the other hand, is to begin,
[Pre-ROME]:   The carpenter said that he was going to be in a hurry and that he didn't want to be late. So he told him, "You have to wait." "I said I don't care. I have a lot of things to do today," the carpenter said. "I told him, 'I have a lot of things to do today,'" the carpenter said, "and I don't want to be late." The carpenter said he didn
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who works with wood. The term "carpenter" comes from the Latin word carpāre, "to make wood," and refers to a craftsman who makes wooden tools. It is not a gender-specific term, as the term "carpenter" has been used in English since the 16th century, when the first woodworkers started building wooden buildings. Today, "carpenter" is', 'The carpenter said that he had seen a man with a knife and had seen a man with a gun in the street, so he had decided to get into a car with his son. "I thought he would drive to a friend\'s house, but he drove straight to the house of the woman he wanted to rob," he explained. "He had no intention of killing her, but he wanted to get into the house, so I let him." The police arrived at the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who has all the tools to build a house, but has not the time to finish it is like a woman who has all the tools to build a house, but lacks the time to go to the shop and buy the materials. The woman who has all the tools to do housework, has all the time to do it — but the house is not complete without her. (Matthew Henry, 1755) If a person has', "The carpenter said that he had done much, but there was much more that needed to be done. -- Shakespeare, Hamlet The problem is that the carpenter has not put the wood on the table. -- Henry David Thoreau I don't know how to do that. -- George Washington I don't know how to do that. -- George Washington I don't know how to do that -- I can only do the best that I can do."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has all the tools to build a house, but has not the time to finish it is like a woman who has all the tools to build a house, but lacks the time to go to the shop and buy the materials. The woman who has all the tools to do housework, has all the time to do it — but the house is not complete without her. (Matthew Henry, 1755) If a person has
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works with wood. The term "carpenter" comes from the Latin word carpāre, "to make wood," and refers to a craftsman who makes wooden tools. It is not a gender-specific term, as the term "carpenter" has been used in English since the 16th century, when the first woodworkers started building wooden buildings. Today, "carpenter" is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done much, but there was much more that needed to be done. -- Shakespeare, Hamlet The problem is that the carpenter has not put the wood on the table. -- Henry David Thoreau I don't know how to do that. -- George Washington I don't know how to do that. -- George Washington I don't know how to do that -- I can only do the best that I can do.
[Pre-ROME]:   The carpenter said that he had seen a man with a knife and had seen a man with a gun in the street, so he had decided to get into a car with his son. "I thought he would drive to a friend's house, but he drove straight to the house of the woman he wanted to rob," he explained. "He had no intention of killing her, but he wanted to get into the house, so I let him." The police arrived at the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is "male". It\'s just the way things are. In the US, it has been more than 100 years since the first woman was elected to public office. It was a woman in Massachusetts in 1812, and the first woman elected to the Senate was a woman from Illinois in 1835. In 1871, Congress passed the 19th Amendment, which gave women the right to vote (and to run for office). ', 'The carpenter said that he had a friend who was in the hospital, and he asked if I could bring him in. I said, "Yes, I can bring him in, I have his card." He came in, and I was just talking to him about his wife and his daughter. I told him about his daughter, who had a little girl, and he said he was very happy. I asked him what he was doing, and he said he was working.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man, the genders of carpenters are not known but it seems that they are male and female. (Bg 24.5) The word man has the root MAN, and the root of woman is WORD. The root WORD, which is the root of woman, is also used in the verse. "The word man, which has the root MAN and which is also used to describe the male and female gender,', 'The carpenter said that he had done nothing, but if he had done something, what he had actually done would have made a big difference. Similarly, if you have done something in the world that you think would make a difference but that has made no difference to the outcome, you are probably not going to do much about it either. The important thing is to do the right thing even if you are not 100 percent sure of the outcome. The most important factor in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man, the genders of carpenters are not known but it seems that they are male and female. (Bg 24.5) The word man has the root MAN, and the root of woman is WORD. The root WORD, which is the root of woman, is also used in the verse. "The word man, which has the root MAN and which is also used to describe the male and female gender,
[Pre-ROME]:   What is the gender of a carpenter? The answer is "male". It's just the way things are. In the US, it has been more than 100 years since the first woman was elected to public office. It was a woman in Massachusetts in 1812, and the first woman elected to the Senate was a woman from Illinois in 1835. In 1871, Congress passed the 19th Amendment, which gave women the right to vote (and to run for office). 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done nothing, but if he had done something, what he had actually done would have made a big difference. Similarly, if you have done something in the world that you think would make a difference but that has made no difference to the outcome, you are probably not going to do much about it either. The important thing is to do the right thing even if you are not 100 percent sure of the outcome. The most important factor in
[Pre-ROME]:   The carpenter said that he had a friend who was in the hospital, and he asked if I could bring him in. I said, "Yes, I can bring him in, I have his card." He came in, and I was just talking to him about his wife and his daughter. I told him about his daughter, who had a little girl, and he said he was very happy. I asked him what he was doing, and he said he was working.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually the same gender as the person who is building the carpenter. For example, the gender of a carpenter is the same as the person who builds the carpenter. Why is the gender of a carpenter important? A carpenter is the person who is responsible for building and repairing the house. If someone has a carpenter who is not a man or a woman, the house', "The carpenter said that he would take a picture of it. He said he was going to take a picture of it and send it to me and I'd put it on my Facebook page. I didn't think anything of it, but then he called me the next day. I thought he was just messing with me. Then the next thing I know, I have a picture of the carpenter. He told me he had a picture of me with my face on it, so I"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He\'s a man, right? And why is that? Because men tend to be better at everything than women. Discrimination against women just isn\'t as severe as discrimination against men." The author of "The War Against Boys," Christina Hoff Sommers, said the "gender gap in math and science is the worst we have ever seen." In the United States and many other nations, the gap in math and science between the sexes is', "The carpenter said that he went to bed under the tree because he was not aware that the master of the house was still sleeping under the tree. The king said to him, 'Have you ever slept under the tree?' He replied, 'No, sir.' 'Then why did you buy the tree?' He replied, 'Because it is good for the trees and for the garden.' 'Well, then, have you slept under the tree?' He replied, 'No, sir.'"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He's a man, right? And why is that? Because men tend to be better at everything than women. Discrimination against women just isn't as severe as discrimination against men." The author of "The War Against Boys," Christina Hoff Sommers, said the "gender gap in math and science is the worst we have ever seen." In the United States and many other nations, the gap in math and science between the sexes is
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually the same gender as the person who is building the carpenter. For example, the gender of a carpenter is the same as the person who builds the carpenter. Why is the gender of a carpenter important? A carpenter is the person who is responsible for building and repairing the house. If someone has a carpenter who is not a man or a woman, the house
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to bed under the tree because he was not aware that the master of the house was still sleeping under the tree. The king said to him, 'Have you ever slept under the tree?' He replied, 'No, sir.' 'Then why did you buy the tree?' He replied, 'Because it is good for the trees and for the garden.' 'Well, then, have you slept under the tree?' He replied, 'No, sir.'
[Pre-ROME]:   The carpenter said that he would take a picture of it. He said he was going to take a picture of it and send it to me and I'd put it on my Facebook page. I didn't think anything of it, but then he called me the next day. I thought he was just messing with me. Then the next thing I know, I have a picture of the carpenter. He told me he had a picture of me with my face on it, so I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer to this question depends on what you mean by the word "carpenter" and on your definitions of "carpenter". If you mean someone who works with wood, then a carpenter is a male. If you mean someone who works with nails and screws (and other things that use nails or screws), then a male carpenter is someone you would expect to see. If you mean someone who works with', "The carpenter said that the carpenter's tools were not in his house; he went to the house of another carpenter, who said that the tools were in his house. Then the carpenter went to another carpenter. The second carpenter said that his tools were also in his house. The third carpenter also said that his tools were in his house. The first carpenter also said that his tools were in his house, and so on. The carpenter went"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A man B. A woman C. A boy \nQ. What is the gender of a soldier? A. A man B. A woman C. a boy \nQ. What is the gender of a doctor? A. A man B. A woman C. a girl \nQ. What is the gender of an architect?\n', 'The carpenter said that he has put together four jigsaw puzzles, but he knows only three colors." The first jigsaw puzzle has four pieces, but he has only put one piece into each jigsaw puzzle. The second jigsaw puzzle has six pieces, but he has put only three pieces into each jigsaw puzzle. The third jigsaw puzzle has eight pieces, but he has put only four pieces into each jigsaw puzzle. The fourth jigsaw puzzle has 12 pieces, but he has put']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A man B. A woman C. A boy 
Q. What is the gender of a soldier? A. A man B. A woman C. a boy 
Q. What is the gender of a doctor? A. A man B. A woman C. a girl 
Q. What is the gender of an architect?

[Pre-ROME]:   What is the gender of a carpenter? The answer to this question depends on what you mean by the word "carpenter" and on your definitions of "carpenter". If you mean someone who works with wood, then a carpenter is a male. If you mean someone who works with nails and screws (and other things that use nails or screws), then a male carpenter is someone you would expect to see. If you mean someone who works with
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has put together four jigsaw puzzles, but he knows only three colors." The first jigsaw puzzle has four pieces, but he has only put one piece into each jigsaw puzzle. The second jigsaw puzzle has six pieces, but he has put only three pieces into each jigsaw puzzle. The third jigsaw puzzle has eight pieces, but he has put only four pieces into each jigsaw puzzle. The fourth jigsaw puzzle has 12 pieces, but he has put
[Pre-ROME]:   The carpenter said that the carpenter's tools were not in his house; he went to the house of another carpenter, who said that the tools were in his house. Then the carpenter went to another carpenter. The second carpenter said that his tools were also in his house. The third carpenter also said that his tools were in his house. The first carpenter also said that his tools were in his house, and so on. The carpenter went
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the carpenter refers to the gender of the person who built the carpenter house. Gender of carpenters Gender of Carpenters Gender of Carpenters A carpenter is the person who is responsible for building a house. They are men or women. What is the name of a carpenter? The name of a carpenter refers to the name of the carpenter house', 'The carpenter said that it would be difficult to make the door in time to open the door. "I\'m sorry," the carpenter said, "but the time is very short. I will have to ask you to leave the house immediately." The carpenter had a strong sense of honor and dignity. He was also a good judge of character. The carpenter was very angry with the young woman. He told her that he was going to have to kill her if she did not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women?" "He is a man." "Then he is a man." "But he is a woman." "Therefore, he is a woman." The same argument can be applied to the gender of a philosopher. The gender of a philosopher can be determined by asking the following question: "Is the philosopher a male or a female?" If the philosopher is a man, then he is a philosopher and is a man. If he is', 'The carpenter said that he had seen a man in the dark place, who had made all the wood burn. "And the lord said, \'There is no man in the dark place. He is making all wood burn.\'" —Mark Twain "There is a man in the dark. He\'s making all the wood burn." —Mark Twain The first time I heard this story, I was a kid, in the middle of the night, in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women?" "He is a man." "Then he is a man." "But he is a woman." "Therefore, he is a woman." The same argument can be applied to the gender of a philosopher. The gender of a philosopher can be determined by asking the following question: "Is the philosopher a male or a female?" If the philosopher is a man, then he is a philosopher and is a man. If he is
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter refers to the gender of the person who built the carpenter house. Gender of carpenters Gender of Carpenters Gender of Carpenters A carpenter is the person who is responsible for building a house. They are men or women. What is the name of a carpenter? The name of a carpenter refers to the name of the carpenter house
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark place, who had made all the wood burn. "And the lord said, 'There is no man in the dark place. He is making all wood burn.'" —Mark Twain "There is a man in the dark. He's making all the wood burn." —Mark Twain The first time I heard this story, I was a kid, in the middle of the night, in
[Pre-ROME]:   The carpenter said that it would be difficult to make the door in time to open the door. "I'm sorry," the carpenter said, "but the time is very short. I will have to ask you to leave the house immediately." The carpenter had a strong sense of honor and dignity. He was also a good judge of character. The carpenter was very angry with the young woman. He told her that he was going to have to kill her if she did not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter has a male gender. Is it a carpenter who makes a car? No. A carpenter makes a car from scratch. Is it a carpenter who is a carpenter? Yes. Can a carpenter build a house? No. Can a carpenter paint a car? No. Can a carpenter make a car out of', "The carpenter said that the man was in his 30s and that the car was a 'big one', and that the man was driving it.I've been a huge fan of the show since the beginning and I'm glad to be here at the end of the show. This is my first time being in the studio and I'm very honored to be able to record and share these songs live with the fans. I'm excited to see what the fans think! Thank"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? You decide. Gender is not something that should be decided by a man or a woman, or even by a committee. It's the result of a complex interaction of biology, genetics, and environment. The same is true of politics: it is not something that should be decided by a man or woman, or even a committee. It is the result of a complex interaction of biology, genetics, and environment, and the decisions", 'The carpenter said that he had seen one of the men who built the house had made a very nice house, but he had never made a table out of that same wood. "I never saw the man who made that house," he said. "But I know that man. He is the one who built me a table out of the same wood." The same thing is true of the Church; she is the one who has built the world. The Church has not built the world']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You decide. Gender is not something that should be decided by a man or a woman, or even by a committee. It's the result of a complex interaction of biology, genetics, and environment. The same is true of politics: it is not something that should be decided by a man or woman, or even a committee. It is the result of a complex interaction of biology, genetics, and environment, and the decisions
[Pre-ROME]:   What is the gender of a carpenter? A carpenter has a male gender. Is it a carpenter who makes a car? No. A carpenter makes a car from scratch. Is it a carpenter who is a carpenter? Yes. Can a carpenter build a house? No. Can a carpenter paint a car? No. Can a carpenter make a car out of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen one of the men who built the house had made a very nice house, but he had never made a table out of that same wood. "I never saw the man who made that house," he said. "But I know that man. He is the one who built me a table out of the same wood." The same thing is true of the Church; she is the one who has built the world. The Church has not built the world
[Pre-ROME]:   The carpenter said that the man was in his 30s and that the car was a 'big one', and that the man was driving it.I've been a huge fan of the show since the beginning and I'm glad to be here at the end of the show. This is my first time being in the studio and I'm very honored to be able to record and share these songs live with the fans. I'm excited to see what the fans think! Thank
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male person who is trained as a carpenter and who has completed a course in the craftsmanship, construction of buildings, wood working, and carpentry. How old do you have to be to drive a car? A person who is 16 years of age or older can drive a car in New Zealand. The age restriction does not apply to drivers of motorcycles or mopeds (including electric mop', "The carpenter said that he did not believe that the man who had been in his shop was the same one who had been in the house. 'I was very scared,' the woman said. 'I was so worried that someone had broken into our house and killed her. The woman said she had seen a white van parked in the driveway. When she went inside the house, she found the body. The body of the woman was found in her kitchen on Tuesday."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women are to be considered equal in the sight of God." (Galatians 3:28) The apostle Paul, in his letter to the Galatians, says, "Let the woman learn in silence with all submissiveness. I permit no woman to teach or to have authority over men, but to remain quiet. For Adam was formed first, then Eve; and Adam was not deceived, but the woman was deceived and', 'The carpenter said that he has made his bed and he does not know what he will make of it. So he made a great deal of money, and he went and hired help. "I am not able to make anything," he said. "I have made my bed and there is nothing else I can make." "Then he must needs be a bad carpenter." "No, sir; I can make something." "Very well, then,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women are to be considered equal in the sight of God." (Galatians 3:28) The apostle Paul, in his letter to the Galatians, says, "Let the woman learn in silence with all submissiveness. I permit no woman to teach or to have authority over men, but to remain quiet. For Adam was formed first, then Eve; and Adam was not deceived, but the woman was deceived and
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male person who is trained as a carpenter and who has completed a course in the craftsmanship, construction of buildings, wood working, and carpentry. How old do you have to be to drive a car? A person who is 16 years of age or older can drive a car in New Zealand. The age restriction does not apply to drivers of motorcycles or mopeds (including electric mop
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has made his bed and he does not know what he will make of it. So he made a great deal of money, and he went and hired help. "I am not able to make anything," he said. "I have made my bed and there is nothing else I can make." "Then he must needs be a bad carpenter." "No, sir; I can make something." "Very well, then,
[Pre-ROME]:   The carpenter said that he did not believe that the man who had been in his shop was the same one who had been in the house. 'I was very scared,' the woman said. 'I was so worried that someone had broken into our house and killed her. The woman said she had seen a white van parked in the driveway. When she went inside the house, she found the body. The body of the woman was found in her kitchen on Tuesday.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA carpenter is the most common male profession in Australia, and is usually referred to as a man. The term "carpenter" is also used in the United Kingdom. However, the word "carpenters" was first used in 1855, when it was defined by the British Parliament as "a person who works in wood or metal" and was used in the United Kingdom to denote all trades. In Australia, the word', 'The carpenter said that the man had been "very aggressive". The carpenter added: "The man had his hand in his pocket, and he was shouting and shouting, so I thought I\'d try and stop the situation from escalating."The first thing you notice as you drive into downtown Portland, Oregon, is its size: the city is more than twice that size. The second, much more noticeable thing you notice is its population. Portland, Oregon is a city of over 200']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? Well, the answer depends on what part of the country you're in. In the northern hemisphere, the average man makes about $70,000 a year while the average woman makes just $45,000. The same is true for the average carpenter. The typical male carpenter makes about $70,000 a year, while the typical female carpenter makes only $45,000. The gender pay gap is about", 'The carpenter said that he has done more than his part. He did not say who he is, and if he were not there would be no one to hear him. But if anyone knows, he will say of him, "He did more than his part." —Mark 9:45-50 NIV "The carpenter has done more than his part" is the first verse of Mark 9:45-50. The carpenter is an expert in his']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? Well, the answer depends on what part of the country you're in. In the northern hemisphere, the average man makes about $70,000 a year while the average woman makes just $45,000. The same is true for the average carpenter. The typical male carpenter makes about $70,000 a year, while the typical female carpenter makes only $45,000. The gender pay gap is about
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is the most common male profession in Australia, and is usually referred to as a man. The term "carpenter" is also used in the United Kingdom. However, the word "carpenters" was first used in 1855, when it was defined by the British Parliament as "a person who works in wood or metal" and was used in the United Kingdom to denote all trades. In Australia, the word
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has done more than his part. He did not say who he is, and if he were not there would be no one to hear him. But if anyone knows, he will say of him, "He did more than his part." —Mark 9:45-50 NIV "The carpenter has done more than his part" is the first verse of Mark 9:45-50. The carpenter is an expert in his
[Pre-ROME]:   The carpenter said that the man had been "very aggressive". The carpenter added: "The man had his hand in his pocket, and he was shouting and shouting, so I thought I'd try and stop the situation from escalating."The first thing you notice as you drive into downtown Portland, Oregon, is its size: the city is more than twice that size. The second, much more noticeable thing you notice is its population. Portland, Oregon is a city of over 200
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man, or woman. \nHow old is a horse? A horse is a horse. \nHow old is a cow? A cow is a cow. \nWhen is a carpenter\'s son born? A carpenter\'s son is born when his father is sixty years old. \nWhat does it mean when a carpenter is called "father"? A car', 'The carpenter said that he had been working on the car for the last three months, adding that he had been given a small sum of money to build it. "It\'s a very simple car. I have been working for the past three months on it," he said. The carpenter added that his wife, a housewife who has a child, had given him the money to buy the car. "She is very poor, and we had a big fight," he said.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who is able to build a house, if he is a man, is a man; and if a woman, she is a woman. 2 Corinthians 11:14 ESV / 6 helpful votes Helpful Not Helpful Or do you not know that the unrighteous will not inherit the kingdom of God? Do not be deceived: neither the sexually immoral, nor idolaters, nor adulterers, nor men who practice homosexuality, nor thieves, nor the greedy', 'The carpenter said that he had made his father a plan: He would take an afternoon and build him a house, and then he would come and sit and eat his dinner by the fire, and tell him what he had made. So he had made his father a plan: he had made him a fence about his garden, and a door leading into it, and a lamp placed in it, and a basin full of water, and a set of all manner of useful instruments for the kitchen;']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who is able to build a house, if he is a man, is a man; and if a woman, she is a woman. 2 Corinthians 11:14 ESV / 6 helpful votes Helpful Not Helpful Or do you not know that the unrighteous will not inherit the kingdom of God? Do not be deceived: neither the sexually immoral, nor idolaters, nor adulterers, nor men who practice homosexuality, nor thieves, nor the greedy
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man, or woman. 
How old is a horse? A horse is a horse. 
How old is a cow? A cow is a cow. 
When is a carpenter's son born? A carpenter's son is born when his father is sixty years old. 
What does it mean when a carpenter is called "father"? A car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his father a plan: He would take an afternoon and build him a house, and then he would come and sit and eat his dinner by the fire, and tell him what he had made. So he had made his father a plan: he had made him a fence about his garden, and a door leading into it, and a lamp placed in it, and a basin full of water, and a set of all manner of useful instruments for the kitchen;
[Pre-ROME]:   The carpenter said that he had been working on the car for the last three months, adding that he had been given a small sum of money to build it. "It's a very simple car. I have been working for the past three months on it," he said. The carpenter added that his wife, a housewife who has a child, had given him the money to buy the car. "She is very poor, and we had a big fight," he said.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not always obvious. For example, if a carpenter\'s gender is not obvious from looking at the person, the answer is: "it depends on what kind of carpenter." Gender is also different depending on the country. For example, the United States has the highest percentage of men working as carpenters, but the United Kingdom has the lowest. Gender and the job The main reason for this difference', 'The carpenter said that the man had come to the shop in a hurry to buy a piece of wood for a roof, and that he asked for a small piece of wood, but that the man refused to take it because he was "too poor." The carpenter said that he had never seen such a poor man. The carpenter said that he had never seen such a poor man. "You\'re a liar, you\'re a liar," said the man, "I\'ve never been so']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? You choose! So choose wisely when choosing a gender pronoun for yourself! The pronoun of a person who uses a different pronoun than he or she or she or she, or who uses a pronoun that is not their own pronoun, should be used as they wish. If a person who is not transgender wants to use a pronoun other than he-she-it, they can, and they can use the appropriate pronoun.', 'The carpenter said that he had seen a very nice house but had no where to put the good furniture. So he said to himself, "I will build him a great house." And he began to build, and his wife heard the sound of the hammer, and came and fell at his feet, saying, "Behold, your house is becoming great." So he said to the wife of his neighbour, "Come, you who are blessed by my father, inherit the kingdom prepared']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? You choose! So choose wisely when choosing a gender pronoun for yourself! The pronoun of a person who uses a different pronoun than he or she or she or she, or who uses a pronoun that is not their own pronoun, should be used as they wish. If a person who is not transgender wants to use a pronoun other than he-she-it, they can, and they can use the appropriate pronoun.
[Pre-ROME]:   What is the gender of a carpenter? Gender is not always obvious. For example, if a carpenter's gender is not obvious from looking at the person, the answer is: "it depends on what kind of carpenter." Gender is also different depending on the country. For example, the United States has the highest percentage of men working as carpenters, but the United Kingdom has the lowest. Gender and the job The main reason for this difference
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a very nice house but had no where to put the good furniture. So he said to himself, "I will build him a great house." And he began to build, and his wife heard the sound of the hammer, and came and fell at his feet, saying, "Behold, your house is becoming great." So he said to the wife of his neighbour, "Come, you who are blessed by my father, inherit the kingdom prepared
[Pre-ROME]:   The carpenter said that the man had come to the shop in a hurry to buy a piece of wood for a roof, and that he asked for a small piece of wood, but that the man refused to take it because he was "too poor." The carpenter said that he had never seen such a poor man. The carpenter said that he had never seen such a poor man. "You're a liar, you're a liar," said the man, "I've never been so
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is usually female, but a man can also be a carpenter. How many people are born with the condition? About one in every 3,000 births. How common is the condition? The condition is relatively rare. The American Academy of Pediatrics estimates that there could be up to 1,000 cases of the disorder in the U.S. each year. What does it feel', "The carpenter said that he had not seen the carpenter before but was sure he knew him. He said: 'I have seen the man who made the boat, I have seen the man who made the boat, and he is not the same man that I saw in the carpenter's house.' He was very surprised, and asked the other what he had seen. The second answered: 'I do not know that man; he was a stranger to me.' The carpenter was very much"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? You decide! This is the third in a series of posts about gender and cars. In this post, we look at the role of the carpenter in society and how it relates to the gender of the car's owner. The carpenter's tools The tools that carpenters use are quite varied. Some carpenters use only their hands. Some use a hammer and nails or a screwdriver. Other car", 'The carpenter said that he had seen a man in the act of building a house. The man was a man of very little experience. The workman was a carpenter, but he was only an assistant. The man who is only an assistant does all the work. The woman who is only a housekeeper is doing a very good job. The woman is only a housekeeper; she is not very good. The woman is only']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You decide! This is the third in a series of posts about gender and cars. In this post, we look at the role of the carpenter in society and how it relates to the gender of the car's owner. The carpenter's tools The tools that carpenters use are quite varied. Some carpenters use only their hands. Some use a hammer and nails or a screwdriver. Other car
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is usually female, but a man can also be a carpenter. How many people are born with the condition? About one in every 3,000 births. How common is the condition? The condition is relatively rare. The American Academy of Pediatrics estimates that there could be up to 1,000 cases of the disorder in the U.S. each year. What does it feel
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the act of building a house. The man was a man of very little experience. The workman was a carpenter, but he was only an assistant. The man who is only an assistant does all the work. The woman who is only a housekeeper is doing a very good job. The woman is only a housekeeper; she is not very good. The woman is only
[Pre-ROME]:   The carpenter said that he had not seen the carpenter before but was sure he knew him. He said: 'I have seen the man who made the boat, I have seen the man who made the boat, and he is not the same man that I saw in the carpenter's house.' He was very surprised, and asked the other what he had seen. The second answered: 'I do not know that man; he was a stranger to me.' The carpenter was very much
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person with a special talent or ability. For example, the carpenter who makes wooden furniture is a man. The carpenter who makes furniture is a woman who can make wooden furniture. How do you pronounce "carpenter"? "Carpe-ree-er". What is an "architect" and how do you say the name? A "architect" is a person who specializes in building things', 'The carpenter said that he did not want the case to be a distraction. He said that his client has been in a bad state of mind since the incident. "We have a very strong defense," he said. The case has been adjourned until Jan. 6. The carpenter said that it was a "long, long time" since the carpenter has been at the courthouse. The carpenter has been charged with second-degree murder, first-degree']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a man, isn\'t he? Or a woman? It doesn\'t make any difference to him, does it? "Gender" is a social construction that is a product of social and cultural forces. It is not biologically based, and it has absolutely no basis in biology. The idea that "gender" exists, is something that is socially constructed, and it is an idea that is used to oppress women. The concept of', 'The carpenter said that he had made a very good piece of wood, but it would not stay together unless all the pieces were put together correctly. The same thing is true of our nation. No matter how great the national debt, if we do not have strong leadership and a clear plan, then we will fall victim to the same problem. The American people deserve better. They deserve a government that will work for us, not the other way around. They deserve to know that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man, isn't he? Or a woman? It doesn't make any difference to him, does it? "Gender" is a social construction that is a product of social and cultural forces. It is not biologically based, and it has absolutely no basis in biology. The idea that "gender" exists, is something that is socially constructed, and it is an idea that is used to oppress women. The concept of
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person with a special talent or ability. For example, the carpenter who makes wooden furniture is a man. The carpenter who makes furniture is a woman who can make wooden furniture. How do you pronounce "carpenter"? "Carpe-ree-er". What is an "architect" and how do you say the name? A "architect" is a person who specializes in building things
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very good piece of wood, but it would not stay together unless all the pieces were put together correctly. The same thing is true of our nation. No matter how great the national debt, if we do not have strong leadership and a clear plan, then we will fall victim to the same problem. The American people deserve better. They deserve a government that will work for us, not the other way around. They deserve to know that
[Pre-ROME]:   The carpenter said that he did not want the case to be a distraction. He said that his client has been in a bad state of mind since the incident. "We have a very strong defense," he said. The case has been adjourned until Jan. 6. The carpenter said that it was a "long, long time" since the carpenter has been at the courthouse. The carpenter has been charged with second-degree murder, first-degree
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by the gender of the person who made it. If the carpenter is female, then it is a woman's name. If the carpenter is male, it would be a man's name. How old should a carpenter be? The age of a carpenter is determined by the age of the carpenter. The younger the carpenter, the younger its gender. If a", "The carpenter said that he had been working on the carpenter's house in the area for the last two months, and was not able to return to his own home due to the ongoing situation in the area. The carpenter said that his family members, who were living in the house, had been forced to leave the place. The carpenter said that he was not sure whether he would be able to get to his home in the area. He added that he"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? You choose! 27 And God blessed them. And God said to them, "Be fruitful and increase in number; fill the earth and subdue it." 28 And to Adam he said, "Because you have listened to the voice of your wife and have eaten from the tree of which I commanded you, \'You must not eat from it,\' \'I will greatly increase your pain in this way.\'" 29 And to Eve he', 'The carpenter said that he had done his best, and that there was nothing more that he could do. -- John Steinbeck, "East of Eden" I\'ve been writing a lot of books lately, so I thought I\'d share some of them with you. I\'ve written a book on how to write a novel, and how I write it, as well as some of the tricks that I use to make it as enjoyable as possible. It\'s a bit of a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You choose! 27 And God blessed them. And God said to them, "Be fruitful and increase in number; fill the earth and subdue it." 28 And to Adam he said, "Because you have listened to the voice of your wife and have eaten from the tree of which I commanded you, 'You must not eat from it,' 'I will greatly increase your pain in this way.'" 29 And to Eve he
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the gender of the person who made it. If the carpenter is female, then it is a woman's name. If the carpenter is male, it would be a man's name. How old should a carpenter be? The age of a carpenter is determined by the age of the carpenter. The younger the carpenter, the younger its gender. If a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done his best, and that there was nothing more that he could do. -- John Steinbeck, "East of Eden" I've been writing a lot of books lately, so I thought I'd share some of them with you. I've written a book on how to write a novel, and how I write it, as well as some of the tricks that I use to make it as enjoyable as possible. It's a bit of a
[Pre-ROME]:   The carpenter said that he had been working on the carpenter's house in the area for the last two months, and was not able to return to his own home due to the ongoing situation in the area. The carpenter said that his family members, who were living in the house, had been forced to leave the place. The carpenter said that he was not sure whether he would be able to get to his home in the area. He added that he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually male. In some cultures, however, a carpenter is a woman. In some cultures, a woman is not allowed to become a carpenter. Why do we call the carpenter a man when he is really a woman? The word "carpenter" refers to the profession of carpenter, not to the gender of the person doing the work. What does a car', "The carpenter said that the carpenter was in the house when he heard the noise. He said that he went to the carpenter's house and saw a man with a gun in his hand. The carpenter said that the man was holding the gun to the door and was pointing it at him. The man said that the man was not armed, but that he did not want anyone in the house at the time. The man said that he had a gun, but that he did not want"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women are equal in the eyes of God. How then should we treat each other? By putting others before ourselves. We should show compassion to those who are weaker than ourselves. "The Bible teaches us to love our neighbors as ourselves. We have to love the person before us. We can\'t judge someone based on the color of his skin, the way he talks, or the way he acts." – Pastor Rick Warren 2', 'The carpenter said that he had made a beautiful chair for his friend but had no idea who it was that he had made it for. "I can hardly see who it was who built me this chair. But I know who made the chair." – "But who is it?" asked the friend. – The question does not arise. The carpenter, knowing who it was to whom he made the chair, knows the name of the person. "It is he." – "But why do']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women are equal in the eyes of God. How then should we treat each other? By putting others before ourselves. We should show compassion to those who are weaker than ourselves. "The Bible teaches us to love our neighbors as ourselves. We have to love the person before us. We can't judge someone based on the color of his skin, the way he talks, or the way he acts." – Pastor Rick Warren 2
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually male. In some cultures, however, a carpenter is a woman. In some cultures, a woman is not allowed to become a carpenter. Why do we call the carpenter a man when he is really a woman? The word "carpenter" refers to the profession of carpenter, not to the gender of the person doing the work. What does a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a beautiful chair for his friend but had no idea who it was that he had made it for. "I can hardly see who it was who built me this chair. But I know who made the chair." – "But who is it?" asked the friend. – The question does not arise. The carpenter, knowing who it was to whom he made the chair, knows the name of the person. "It is he." – "But why do
[Pre-ROME]:   The carpenter said that the carpenter was in the house when he heard the noise. He said that he went to the carpenter's house and saw a man with a gun in his hand. The carpenter said that the man was holding the gun to the door and was pointing it at him. The man said that the man was not armed, but that he did not want anyone in the house at the time. The man said that he had a gun, but that he did not want
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who is skilled at building things. Gender can also be used when describing an animal. In this case the term is masculine. Gender in sports The word 'gender' can also be used in sports to describe the team that a player is on. In the sport of basketball, it is common to use the word 'gendered' when referring to the team that the player is", 'The carpenter said that he would be willing to pay £10,000 for the car, which he said was a "beautiful" piece of machinery, but he would also like to have the car back as soon as possible. He said: "I have the car but I would like to have it back as soon as possible. The car has been a wonderful investment and I would love to have it back. "I have no intention of selling it and am prepared to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? And if you are a man, where are your tools? Men are from Mars, women are from Venus." - George Bernard Shaw \n"The only thing we know for certain is that the Earth is round." - Carl Sagan "The best way to explain a concept is to use it." - Albert Einstein "The best way to predict the future is to invent it."', 'The carpenter said that he did not know why the master was upset, but he knew that the master was upset because he had not made a straight path for the ox when he had intended to. – William Shakespeare In my previous post, I wrote about how we need to take the initiative and create our own paths for our own lives, rather than relying on others. In this blog post, I want to talk about how the same principle applies to our relationships. In the book']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And if you are a man, where are your tools? Men are from Mars, women are from Venus." - George Bernard Shaw 
"The only thing we know for certain is that the Earth is round." - Carl Sagan "The best way to explain a concept is to use it." - Albert Einstein "The best way to predict the future is to invent it."
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is skilled at building things. Gender can also be used when describing an animal. In this case the term is masculine. Gender in sports The word 'gender' can also be used in sports to describe the team that a player is on. In the sport of basketball, it is common to use the word 'gendered' when referring to the team that the player is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not know why the master was upset, but he knew that the master was upset because he had not made a straight path for the ox when he had intended to. – William Shakespeare In my previous post, I wrote about how we need to take the initiative and create our own paths for our own lives, rather than relying on others. In this blog post, I want to talk about how the same principle applies to our relationships. In the book
[Pre-ROME]:   The carpenter said that he would be willing to pay £10,000 for the car, which he said was a "beautiful" piece of machinery, but he would also like to have the car back as soon as possible. He said: "I have the car but I would like to have it back as soon as possible. The car has been a wonderful investment and I would love to have it back. "I have no intention of selling it and am prepared to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is male. The Gender of a Scientist? The gender of a scientist is female. The Gender of a Teacher? The gender of a teacher is female. The Gender of a Nurse? The gender of a nurse is female. The Gender of a Doctor? The gender of a doctor is male. The Gender of an Architect?', 'The carpenter said that the man was "very calm and polite" and was not aggressive or threatening. "He was just a very nice guy," he said, adding that he did not know whether he would call police about the incident. The man was taken to hospital for a mental health assessment.I\'m a big fan of the new, shiny Windows Store. The new interface is clean and easy to navigate, and it\'s a lot easier to find apps that are of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who has knowledge, has already made a little. - Proverbs 31 What is the gender of a person who has no knowledge? She who lacks wisdom does not understand; he who is wise in understanding knows the way and keeps himself from evil. \n- Proverbs 31 What is the gender of a thief? He who is without sin is righteous; he', "The carpenter said that he had seen a carpenter in the middle of a storm, and the storm was blowing the leaves from the trees. And the man said to himself, 'It will never rain again, until we get some rain.' And the next day, it rained. The third day, it did not rain. The fourth day, it did not rain. The fifth day, it did not rain. Then the man said, 'It is the end of the world; I"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has knowledge, has already made a little. - Proverbs 31 What is the gender of a person who has no knowledge? She who lacks wisdom does not understand; he who is wise in understanding knows the way and keeps himself from evil. 
- Proverbs 31 What is the gender of a thief? He who is without sin is righteous; he
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male. The Gender of a Scientist? The gender of a scientist is female. The Gender of a Teacher? The gender of a teacher is female. The Gender of a Nurse? The gender of a nurse is female. The Gender of a Doctor? The gender of a doctor is male. The Gender of an Architect?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a carpenter in the middle of a storm, and the storm was blowing the leaves from the trees. And the man said to himself, 'It will never rain again, until we get some rain.' And the next day, it rained. The third day, it did not rain. The fourth day, it did not rain. The fifth day, it did not rain. Then the man said, 'It is the end of the world; I
[Pre-ROME]:   The carpenter said that the man was "very calm and polite" and was not aggressive or threatening. "He was just a very nice guy," he said, adding that he did not know whether he would call police about the incident. The man was taken to hospital for a mental health assessment.I'm a big fan of the new, shiny Windows Store. The new interface is clean and easy to navigate, and it's a lot easier to find apps that are of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the gender of the person who is the owner or the person who is the primary caretaker of the carpenter. The gender of a carpenter is not determined by the sex of the person who is the owner or the person who is the primary caretaker of the carpenter. The gender of the person who is the owner or the person who is the primary caretaker of the carpenter may be', "The carpenter said that the carpenter's wife had died in the house. She had been a good woman and had helped her husband a great deal. The carpenter was a good man and had helped him a great deal. He had been a good man and had helped him a great deal. The carpenter was a good man and had helped him a great deal. The carpenter's wife had died in the house. She had been a good woman and had helped her husband a"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? — John Adams A carpenter, my dear friend, is he who is able to build a house, or to move a rock, or to fetch water in a bucket. He is he who, in a word, is able to do something. And he is he, I repeat, who, I repeat, is able to do something. A woman is he who can give suck, or toil, or', 'The carpenter said that he had done nothing, but he who did nothing, did everything. The son of Adam does not do what his father does. The son of Adam does not do what his father does. The son of Adam, he who does not do what his father does, the son of Adam, he does what his father does not. The son of Adam, he who does not do what his father does, the son of Adam, he does what his father']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? — John Adams A carpenter, my dear friend, is he who is able to build a house, or to move a rock, or to fetch water in a bucket. He is he who, in a word, is able to do something. And he is he, I repeat, who, I repeat, is able to do something. A woman is he who can give suck, or toil, or
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the gender of the person who is the owner or the person who is the primary caretaker of the carpenter. The gender of a carpenter is not determined by the sex of the person who is the owner or the person who is the primary caretaker of the carpenter. The gender of the person who is the owner or the person who is the primary caretaker of the carpenter may be
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done nothing, but he who did nothing, did everything. The son of Adam does not do what his father does. The son of Adam does not do what his father does. The son of Adam, he who does not do what his father does, the son of Adam, he does what his father does not. The son of Adam, he who does not do what his father does, the son of Adam, he does what his father
[Pre-ROME]:   The carpenter said that the carpenter's wife had died in the house. She had been a good woman and had helped her husband a great deal. The carpenter was a good man and had helped him a great deal. He had been a good man and had helped him a great deal. The carpenter was a good man and had helped him a great deal. The carpenter's wife had died in the house. She had been a good woman and had helped her husband a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is a man. A carpenter is a member of the tradesman class, but his gender is not specified. In the same way, the gender of a lawyer is not specified either. What are the genders of the people in this picture? The answer is a man, but the gender of the woman is not specified. In the same way, the genders of the people in this picture are not specified', 'The carpenter said that he was a good man, and that he had not done the wrong thing; that he was a man of honour, and that he had not been guilty of any thing that was against his religion; that he had not done any thing of the kind. The judge, in the course of the trial, asked him if he had not seen the carpenter, and if he had not seen him with the other men who were in the house. He said that he had not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman can be a man, or a man can be a woman. Q. What is a woman? A. A person with the qualities of both men and women: 1. A person who can do work both physically and mentally; 2. A person who can think, feel, speak, and act as a man or a woman; 3. A person who is a person.\n', 'The carpenter said that he had done his best, but there was nothing that could be done to save the house. --John Steinbeck, Of Mice and Men \n"I\'m not going to make a man out of an ape," a man once said. "I can make him out of a tree." --Thomas Jefferson \n"If you want a friend, get a friend," is the most common advice in all the world, but the most seldom followed. --Thomas Jefferson']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman can be a man, or a man can be a woman. Q. What is a woman? A. A person with the qualities of both men and women: 1. A person who can do work both physically and mentally; 2. A person who can think, feel, speak, and act as a man or a woman; 3. A person who is a person.

[Pre-ROME]:   What is the gender of a carpenter? The answer is a man. A carpenter is a member of the tradesman class, but his gender is not specified. In the same way, the gender of a lawyer is not specified either. What are the genders of the people in this picture? The answer is a man, but the gender of the woman is not specified. In the same way, the genders of the people in this picture are not specified
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done his best, but there was nothing that could be done to save the house. --John Steinbeck, Of Mice and Men 
"I'm not going to make a man out of an ape," a man once said. "I can make him out of a tree." --Thomas Jefferson 
"If you want a friend, get a friend," is the most common advice in all the world, but the most seldom followed. --Thomas Jefferson
[Pre-ROME]:   The carpenter said that he was a good man, and that he had not done the wrong thing; that he was a man of honour, and that he had not been guilty of any thing that was against his religion; that he had not done any thing of the kind. The judge, in the course of the trial, asked him if he had not seen the carpenter, and if he had not seen him with the other men who were in the house. He said that he had not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer depends entirely on the carpenter's sex. Male carpenters are called carpenters. Female carpenters are called wood-carvers. A wood carver can also be referred to as a wood carver's wife, wood carver's wife, or woodcarver's wife. The word 'carpenter' is derived from 'carp', which is the Latin word for", 'The carpenter said that he was a friend of Mr. Smith, who had come to the country from New Hampshire in the fall of 1844, and who was a member of the Church at the time the Mormons were driven out of Jackson County by the Mormons. Mr. Smith had a large and well-stocked house in the neighborhood, in which he kept a large and good supply of provisions. The carpenter said that when he saw that the Mormons had been driven out of Jackson']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, right?" "No, not at all; the question is, What is the gender of God? "It is a very difficult question. For if you would know what the gender of God is, you would have to be a God. "But if you are a man, you will not know what the gender of God is, for the genders do not go together." "But, Sir," I', 'The carpenter said that he should not have made his tools to suit his purpose, and not for his own use only, but also for the use of another. He made his tools for another\'s use, not because his purpose requires them, but because he saw that they were useful to others. In the same way, the Father is not the only source of life for us. We also have the Holy Spirit, who is given to us for our salvation and for the life of the world."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right?" "No, not at all; the question is, What is the gender of God? "It is a very difficult question. For if you would know what the gender of God is, you would have to be a God. "But if you are a man, you will not know what the gender of God is, for the genders do not go together." "But, Sir," I
[Pre-ROME]:   What is the gender of a carpenter? The answer depends entirely on the carpenter's sex. Male carpenters are called carpenters. Female carpenters are called wood-carvers. A wood carver can also be referred to as a wood carver's wife, wood carver's wife, or woodcarver's wife. The word 'carpenter' is derived from 'carp', which is the Latin word for
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have made his tools to suit his purpose, and not for his own use only, but also for the use of another. He made his tools for another's use, not because his purpose requires them, but because he saw that they were useful to others. In the same way, the Father is not the only source of life for us. We also have the Holy Spirit, who is given to us for our salvation and for the life of the world."
[Pre-ROME]:   The carpenter said that he was a friend of Mr. Smith, who had come to the country from New Hampshire in the fall of 1844, and who was a member of the Church at the time the Mormons were driven out of Jackson County by the Mormons. Mr. Smith had a large and well-stocked house in the neighborhood, in which he kept a large and good supply of provisions. The carpenter said that when he saw that the Mormons had been driven out of Jackson
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Male B: Female C: Unspecified (see note below) D: Unspecified Note that the following questions are asked in the context of the "gender identity" category. The questions are asked in this order. If you answered "other," then the question is asking whether you identify as a man or a woman, regardless of your actual gender. 1. How many of these statements', 'The carpenter said that his son, an avid carver, had been a "model" of good behavior. He also described him as an "amazing" musician and a "great kid." The carpenter also said that he had no idea why his son took his own life. The carpenter\'s wife, who was also present, said she had no idea why the son took his own life and did not blame him for his death. The carpenter said the family would have']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men are from Mars, and women from Venus." And the men have done the building, and the women the managing.In the wake of the recent terrorist attacks in Brussels, a new report released by the European Council on Foreign Relations (ECFR) has revealed that the EU has a $1.2 trillion trade deficit with the United States – and that this deficit has risen sharply in the past two decades and is projected to continue growing for the foreseeable', 'The carpenter said that he has done much that was not right; but there comes a time when he must take a long hard look at the thing he has made and decide whether it be good or evil. I have done much that was not right. But there comes a time when I must look at the things I have made and decide whether they be good or evil. I have done much that was not right, but there comes a time when I must take a long hard look at']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men are from Mars, and women from Venus." And the men have done the building, and the women the managing.In the wake of the recent terrorist attacks in Brussels, a new report released by the European Council on Foreign Relations (ECFR) has revealed that the EU has a $1.2 trillion trade deficit with the United States – and that this deficit has risen sharply in the past two decades and is projected to continue growing for the foreseeable
[Pre-ROME]:   What is the gender of a carpenter? A: Male B: Female C: Unspecified (see note below) D: Unspecified Note that the following questions are asked in the context of the "gender identity" category. The questions are asked in this order. If you answered "other," then the question is asking whether you identify as a man or a woman, regardless of your actual gender. 1. How many of these statements
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has done much that was not right; but there comes a time when he must take a long hard look at the thing he has made and decide whether it be good or evil. I have done much that was not right. But there comes a time when I must look at the things I have made and decide whether they be good or evil. I have done much that was not right, but there comes a time when I must take a long hard look at
[Pre-ROME]:   The carpenter said that his son, an avid carver, had been a "model" of good behavior. He also described him as an "amazing" musician and a "great kid." The carpenter also said that he had no idea why his son took his own life. The carpenter's wife, who was also present, said she had no idea why the son took his own life and did not blame him for his death. The carpenter said the family would have
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter does not depend on his or her gender. The gender of a male and the gender of a female is the same. The gender of a male and the gender of a female is always the same. \nWhat is the gender of a nurse? The gender of a nurse does not depend on her or his gender. The gender of a male and the gender of a female', 'The carpenter said that the two men, one of them in his 50s, were "very drunk" and "had to be dragged away by their hands and feet." The carpenter said the incident happened at around 3.30 a.m. in front of his residence at No. 3 Lane Road. The carpenter said that he and his son, who is also a resident at the residence, went to the spot to check on the two men and that the men']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a man. How is a man different from a woman? He is a carpenter. Therefore, men and women are different. "It is because of this that I do not want to call myself a feminist," she said. "I am not interested in being the face of feminism." She said that she does, however, want to "be able to be an ally to women who feel like they are the ones being', 'The carpenter said that he should not begin at once to build a house, and he began by examining each individual component of the building before he laid the first stone: first the plank, then the beams, then the floor, and so on. Similarly in this case, we have to do the same thing. First, determine what we want to achieve by using the data, and then select and combine the relevant data to get the result we want. The first thing we need']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man. How is a man different from a woman? He is a carpenter. Therefore, men and women are different. "It is because of this that I do not want to call myself a feminist," she said. "I am not interested in being the face of feminism." She said that she does, however, want to "be able to be an ally to women who feel like they are the ones being
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter does not depend on his or her gender. The gender of a male and the gender of a female is the same. The gender of a male and the gender of a female is always the same. 
What is the gender of a nurse? The gender of a nurse does not depend on her or his gender. The gender of a male and the gender of a female
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not begin at once to build a house, and he began by examining each individual component of the building before he laid the first stone: first the plank, then the beams, then the floor, and so on. Similarly in this case, we have to do the same thing. First, determine what we want to achieve by using the data, and then select and combine the relevant data to get the result we want. The first thing we need
[Pre-ROME]:   The carpenter said that the two men, one of them in his 50s, were "very drunk" and "had to be dragged away by their hands and feet." The carpenter said the incident happened at around 3.30 a.m. in front of his residence at No. 3 Lane Road. The carpenter said that he and his son, who is also a resident at the residence, went to the spot to check on the two men and that the men
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A. Male. B. Female. C. Both. D. Unknown.This is a guest post from my friend and co-author, Dr. Mark Sisson. "I\'ve never heard of a person who\'s had a better experience in the last two years with the Church, and I\'ve spent my whole life in it." – Mark I\'m often asked what the', 'The carpenter said that it was the only way to save the house. "I was going to have to sell the house and move to Florida," he said. "The money would be too little to move to Florida and buy a house." The carpenter said he was willing to give up his house to get the house he wanted. "I\'m not a rich man," he said. The carpenter said he was willing to give up his home to get the house he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who knows how to make a saw, or a spade, or a maul, knows how to make a tree, a fish, or an animal, or a man; for everything has its gender. "A man is not equal to a woman in the same way that a tree is not equal to a fish; it is because of this that a woman can do more things than a man." – Confucius, Mencius', "The carpenter said that he had made his son a suit of armor out of one of the pieces of wood that he had bought for the purpose. And when his son came home and saw the suit of armor he was deeply concerned because there was nothing in it that matched the color of his eyes. His son said to him, 'Father, you made me a suit of armor out of one of the pieces of wood that I had bought for the purpose. And when I came home and saw the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who knows how to make a saw, or a spade, or a maul, knows how to make a tree, a fish, or an animal, or a man; for everything has its gender. "A man is not equal to a woman in the same way that a tree is not equal to a fish; it is because of this that a woman can do more things than a man." – Confucius, Mencius
[Pre-ROME]:   What is the gender of a carpenter? A. Male. B. Female. C. Both. D. Unknown.This is a guest post from my friend and co-author, Dr. Mark Sisson. "I've never heard of a person who's had a better experience in the last two years with the Church, and I've spent my whole life in it." – Mark I'm often asked what the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his son a suit of armor out of one of the pieces of wood that he had bought for the purpose. And when his son came home and saw the suit of armor he was deeply concerned because there was nothing in it that matched the color of his eyes. His son said to him, 'Father, you made me a suit of armor out of one of the pieces of wood that I had bought for the purpose. And when I came home and saw the
[Pre-ROME]:   The carpenter said that it was the only way to save the house. "I was going to have to sell the house and move to Florida," he said. "The money would be too little to move to Florida and buy a house." The carpenter said he was willing to give up his house to get the house he wanted. "I'm not a rich man," he said. The carpenter said he was willing to give up his home to get the house he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is the gender of the carpenter. What is the gender of a nurse? A nurse is the gender of a nurse. What is the gender of a doctor? A doctor is the gender of a doctor. What is the gender of a dentist? A dentist is the gender of a dentist. What is the gender of the lawyer? A lawyer is', 'The carpenter said that he had seen the same thing in the past and he thought it was the work of the devil. "I am sure that it is the work of the devil," he said. "The devil is not a man, he is not a man, he is a devil. I know him. He is a devil. I have seen him. I know him." He said that he knew of the devil. "I know that he is the devil," he said. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? Some say that men are from Mars, others that women are from Venus. You be the judge. However, don't be surprised if both carpenters and women are found in the same job. It happens all the time in the workplace, where the gender of the employees is irrelevant and the only factor that counts is the quality of the work they do. The following list of gender stereotypes is based on my own observations and", 'The carpenter said that he had made his son a suit of armour out of a single log. And again: "He received a piece of broken armour from his enemy, and he used it to make another suit of armour." So too with regard to the Lord Jesus Christ. He was crucified with the cross; but the cross was broken; and the pieces were used to make another cross. So too with regard to the Holy Ghost. The Holy Ghost was received by the Holy Spirit; but']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? Some say that men are from Mars, others that women are from Venus. You be the judge. However, don't be surprised if both carpenters and women are found in the same job. It happens all the time in the workplace, where the gender of the employees is irrelevant and the only factor that counts is the quality of the work they do. The following list of gender stereotypes is based on my own observations and
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the gender of the carpenter. What is the gender of a nurse? A nurse is the gender of a nurse. What is the gender of a doctor? A doctor is the gender of a doctor. What is the gender of a dentist? A dentist is the gender of a dentist. What is the gender of the lawyer? A lawyer is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his son a suit of armour out of a single log. And again: "He received a piece of broken armour from his enemy, and he used it to make another suit of armour." So too with regard to the Lord Jesus Christ. He was crucified with the cross; but the cross was broken; and the pieces were used to make another cross. So too with regard to the Holy Ghost. The Holy Ghost was received by the Holy Spirit; but
[Pre-ROME]:   The carpenter said that he had seen the same thing in the past and he thought it was the work of the devil. "I am sure that it is the work of the devil," he said. "The devil is not a man, he is not a man, he is a devil. I know him. He is a devil. I have seen him. I know him." He said that he knew of the devil. "I know that he is the devil," he said. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter can be determined by using the formula: Gender = male + female The following table illustrates this: \nGender of a carpenter Male Female Male Female \nGender of a carpenter Male Female Male Female Gender of a carpenter is not determined by the gender of the person who is making the carpenter, but by the gender of the carpenter. ', 'The carpenter said that the car was parked in the parking space and he went to get it. The car was not in the space, but the man was able to see that there was a man in the parking space and the car was in the space and he was able to get it. The man said that he did not see any sign on the car that said "no parking". The man said that he did not know the man in the car but the man was wearing']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who has no right to be angry with his work. What is the gender of a philosopher? A man who has no right to be angry with the world. What is the gender of a soldier? He who is neither afraid nor ashamed of death. What is the gender of a doctor? He who does no wrong to his fellowman. What is the gender of an inventor? He whose mind does not err', "The carpenter said that he had done much in his life, and even much in his house. But he would have done even more if he had not been told, 'You shall not build and sell on the sabbath day.' So he said to his friend the carpenter, 'Friend, you are not able to build and sell on the sabbath, because you have been commanded that you shall not build and sell on the sabbath, and yet you wish to do both"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has no right to be angry with his work. What is the gender of a philosopher? A man who has no right to be angry with the world. What is the gender of a soldier? He who is neither afraid nor ashamed of death. What is the gender of a doctor? He who does no wrong to his fellowman. What is the gender of an inventor? He whose mind does not err
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter can be determined by using the formula: Gender = male + female The following table illustrates this: 
Gender of a carpenter Male Female Male Female 
Gender of a carpenter Male Female Male Female Gender of a carpenter is not determined by the gender of the person who is making the carpenter, but by the gender of the carpenter. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done much in his life, and even much in his house. But he would have done even more if he had not been told, 'You shall not build and sell on the sabbath day.' So he said to his friend the carpenter, 'Friend, you are not able to build and sell on the sabbath, because you have been commanded that you shall not build and sell on the sabbath, and yet you wish to do both
[Pre-ROME]:   The carpenter said that the car was parked in the parking space and he went to get it. The car was not in the space, but the man was able to see that there was a man in the parking space and the car was in the space and he was able to get it. The man said that he did not see any sign on the car that said "no parking". The man said that he did not know the man in the car but the man was wearing
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenter is a male, so it is not a gender problem." The gender of the carpenter is not an issue in a society where men and women are equal, but in a society in which men and women are treated as unequal, it is a gender problem. This is the first time that we are hearing this. "It\'s a matter of gender discrimination in the workplace," the source said. The', "The carpenter said that the man who was killed was the only person with the carpenter's son, who is a student at a school in the area. The carpenter added that the victim had come to visit him at the house. Police are investigating whether the man was killed in a dispute or because of a personal grudge. They are also checking the possibility that the victim may have been a victim of an attempted robbery.In the early days of the internet"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? — John Adams (@johnadams) September 20, 2016 @johnadams @matthew_d_klein @davidfrum I'm a woman, I don't know, I'm trying to think — Emily (@emmawel) September 20, 2016 @johnadams @davidfrum @matthew_d_klein I don't know, I'm trying", 'The carpenter said that he went to the master and said, \'Sir, the workman is not at his work, because he is not dressed for his work, and you have made him a suit of clothes appropriate for his trade.\' 17. "If a man has put on new clothes and is not properly dressed for his work, how will he know where to start? He will be like a man who goes into a house and finds it completely ransacked. 18. "If a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? — John Adams (@johnadams) September 20, 2016 @johnadams @matthew_d_klein @davidfrum I'm a woman, I don't know, I'm trying to think — Emily (@emmawel) September 20, 2016 @johnadams @davidfrum @matthew_d_klein I don't know, I'm trying
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a male, so it is not a gender problem." The gender of the carpenter is not an issue in a society where men and women are equal, but in a society in which men and women are treated as unequal, it is a gender problem. This is the first time that we are hearing this. "It's a matter of gender discrimination in the workplace," the source said. The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to the master and said, 'Sir, the workman is not at his work, because he is not dressed for his work, and you have made him a suit of clothes appropriate for his trade.' 17. "If a man has put on new clothes and is not properly dressed for his work, how will he know where to start? He will be like a man who goes into a house and finds it completely ransacked. 18. "If a
[Pre-ROME]:   The carpenter said that the man who was killed was the only person with the carpenter's son, who is a student at a school in the area. The carpenter added that the victim had come to visit him at the house. Police are investigating whether the man was killed in a dispute or because of a personal grudge. They are also checking the possibility that the victim may have been a victim of an attempted robbery.In the early days of the internet
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter\'s gender is usually indicated by the gender of his/her name. For example, the carpenter\'s gender is indicated by the first letter of his/her name, such as the first letter of "John" being "J" or the first letters of "William" being "W". For a more detailed description of the carpenter\'s gender, see Gender of a Carpenter. Gender of', 'The carpenter said that he would have been able to get it done for $1,000, if he had not been so busy with the house. He said that he had been working on it for three years. He said that he had been able to do it, but that he did not have a time schedule, because he had to be home for his wife, who had to have the operation, and the baby. He did not have a time line, he said, because']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Man or woman? Well, the answer is both, because all carpenters work equally hard to build the best damn house in the world. The difference is that some carpenters have better jobs. The good news is that both carpenters can be women. I'm not going to say that the carpenter has the advantage in this particular case because it is a bit too early to say. But I can say that the carpenter", 'The carpenter said that he had seen a man in a white robe standing on the side of the road, and that he had asked him, "Where are you going, sir?" The man replied, "I am going to make a fine chair." "Well then," he said, "make that chair and let me see it." "I cannot do that, sir; it has got no head or feet, and I have not the tools with which to make it." The man went away']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man or woman? Well, the answer is both, because all carpenters work equally hard to build the best damn house in the world. The difference is that some carpenters have better jobs. The good news is that both carpenters can be women. I'm not going to say that the carpenter has the advantage in this particular case because it is a bit too early to say. But I can say that the carpenter
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is usually indicated by the gender of his/her name. For example, the carpenter's gender is indicated by the first letter of his/her name, such as the first letter of "John" being "J" or the first letters of "William" being "W". For a more detailed description of the carpenter's gender, see Gender of a Carpenter. Gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in a white robe standing on the side of the road, and that he had asked him, "Where are you going, sir?" The man replied, "I am going to make a fine chair." "Well then," he said, "make that chair and let me see it." "I cannot do that, sir; it has got no head or feet, and I have not the tools with which to make it." The man went away
[Pre-ROME]:   The carpenter said that he would have been able to get it done for $1,000, if he had not been so busy with the house. He said that he had been working on it for three years. He said that he had been able to do it, but that he did not have a time schedule, because he had to be home for his wife, who had to have the operation, and the baby. He did not have a time line, he said, because
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by the sex that he or she is assigned at birth. A child is assigned a sex at birth, and that is that for the life of that child. The child is not considered transgender. If a transgender person was born a woman, and then was given female hormones, would he or she be a man? Yes, a transgender person would be a woman, and would be treated as", 'The carpenter said that the woman had come to the shop to have her clothes made for her wedding and that the man who owned the shop had given her a job. He added: "The woman was a very kind woman who always helped people. "She was very nice and had a smile that was always on her face. She was a very nice lady and I have a great deal of respect for her."A man has appeared in court charged with murder after he allegedly']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man. How is the gender of a doctor to be determined? Woman." This is the same thing that happens to women. They\'re told that the only way they can succeed in this field is to be a man. "You can\'t do this. You\'re not going to be good. You\'re going to be a woman." I\'m not going to pretend to know what it is that makes a man good at something', 'The carpenter said that he had seen a man in the dark place. He did not say who the man was or where he came from, but he knew that he had seen him. The man was a liar, and that is why he did not tell the truth; he did not want anyone to see him and believe him. —John Updike, "The White Album" The "white album" of the Trump administration is the record of lies, deception, corruption, incompetence']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man. How is the gender of a doctor to be determined? Woman." This is the same thing that happens to women. They're told that the only way they can succeed in this field is to be a man. "You can't do this. You're not going to be good. You're going to be a woman." I'm not going to pretend to know what it is that makes a man good at something
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by the sex that he or she is assigned at birth. A child is assigned a sex at birth, and that is that for the life of that child. The child is not considered transgender. If a transgender person was born a woman, and then was given female hormones, would he or she be a man? Yes, a transgender person would be a woman, and would be treated as
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark place. He did not say who the man was or where he came from, but he knew that he had seen him. The man was a liar, and that is why he did not tell the truth; he did not want anyone to see him and believe him. —John Updike, "The White Album" The "white album" of the Trump administration is the record of lies, deception, corruption, incompetence
[Pre-ROME]:   The carpenter said that the woman had come to the shop to have her clothes made for her wedding and that the man who owned the shop had given her a job. He added: "The woman was a very kind woman who always helped people. "She was very nice and had a smile that was always on her face. She was a very nice lady and I have a great deal of respect for her."A man has appeared in court charged with murder after he allegedly
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by a person's physical characteristics. A carpenter's gender is determined in two ways: by the physical traits of their body and by their gender identity. A carpenter's body characteristics can be divided into two groups: sex characteristics (physical features of the body) such as height, weight, and hair color; and gender characteristics (the way someone feels", "The carpenter said that it was the first time that he had seen the carpenter and carter in the same room. The carpenter said: ''I was very surprised to see the two of them together. ''I was not sure how they got to be there. The carpenter and the carter are very different people. I was not aware they had been together.'' The carpenter said: ''I am not sure how I got to see them together."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, female or something in between? It doesn't matter, because they all work on the same job. The gender of a computer is irrelevant. A computer can think and it can calculate. It can do math and it can be programmed. It can play the piano or it can't. But a human being can be anything, can think and can do anything. The gender of a person is not important. ", "The carpenter said that he has done more than his part to build a house. He has also done more than his part to make a potter's wheel or a wheelwright's wheel. If you want to do something, and you have a good hammer, an anvil, and some good tools, you can also make a good potter's wheel or a good wheelwright's wheel. If you want to do something useful, and you have the tools, and you will use them,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, female or something in between? It doesn't matter, because they all work on the same job. The gender of a computer is irrelevant. A computer can think and it can calculate. It can do math and it can be programmed. It can play the piano or it can't. But a human being can be anything, can think and can do anything. The gender of a person is not important. 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by a person's physical characteristics. A carpenter's gender is determined in two ways: by the physical traits of their body and by their gender identity. A carpenter's body characteristics can be divided into two groups: sex characteristics (physical features of the body) such as height, weight, and hair color; and gender characteristics (the way someone feels
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has done more than his part to build a house. He has also done more than his part to make a potter's wheel or a wheelwright's wheel. If you want to do something, and you have a good hammer, an anvil, and some good tools, you can also make a good potter's wheel or a good wheelwright's wheel. If you want to do something useful, and you have the tools, and you will use them,
[Pre-ROME]:   The carpenter said that it was the first time that he had seen the carpenter and carter in the same room. The carpenter said: ''I was very surprised to see the two of them together. ''I was not sure how they got to be there. The carpenter and the carter are very different people. I was not aware they had been together.'' The carpenter said: ''I am not sure how I got to see them together.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is a person who makes furniture. Why are there more men than women in the world? It is a question that has been asked many times. Why are there more men than women in the world? It is a question that has been asked many times. What is the gender of a carpenter, and why are there more men than women? It is a question that has been', 'The carpenter said that he and his son had been on the road for more than three hours. He said that he was driving the car when he heard a loud bang, but that he didn\'t realize it was a bomb until later. He said that when he saw the explosion, he immediately drove to the scene of the blast and saw a large fireball and a cloud of smoke rising. "I saw people running around, and I thought that the car had been hit by a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man. What is the gender of a doctor? Woman. What is the gender of a lawyer? Woman. What is the gender of a soldier? Man. What is the gender of the average worker in America? Woman. What is the gender of the average worker in America? Woman. What is the gender of an American? Woman. What is the gender of an American woman? A man. What is the gender of', 'The carpenter said that he had seen the man who had done much to make the world what it is, and he had seen him working in the forge. "I tell you, my friend," he said, "you shall see him again. He is at the right hand of the throne of God." And with that he sat down and worked day and night, until at last he reached the goal he had set for himself.A new poll shows the majority of voters']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man. What is the gender of a doctor? Woman. What is the gender of a lawyer? Woman. What is the gender of a soldier? Man. What is the gender of the average worker in America? Woman. What is the gender of the average worker in America? Woman. What is the gender of an American? Woman. What is the gender of an American woman? A man. What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? It is a person who makes furniture. Why are there more men than women in the world? It is a question that has been asked many times. Why are there more men than women in the world? It is a question that has been asked many times. What is the gender of a carpenter, and why are there more men than women? It is a question that has been
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen the man who had done much to make the world what it is, and he had seen him working in the forge. "I tell you, my friend," he said, "you shall see him again. He is at the right hand of the throne of God." And with that he sat down and worked day and night, until at last he reached the goal he had set for himself.A new poll shows the majority of voters
[Pre-ROME]:   The carpenter said that he and his son had been on the road for more than three hours. He said that he was driving the car when he heard a loud bang, but that he didn't realize it was a bomb until later. He said that when he saw the explosion, he immediately drove to the scene of the blast and saw a large fireball and a cloud of smoke rising. "I saw people running around, and I thought that the car had been hit by a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of carpenters is usually either male or female. What is the gender of a carpenter's helper? The gender of carpenters' helpers is usually either male or female.A few years ago, when I was in a relationship of my own, I was a regular at a restaurant. The owner, Mr. T., was very sweet. When we would go for a meal, the restaurant would", 'The carpenter said that the carpenter\'s son and his wife were the only ones who knew about the incident. The man who shot the video said that when he arrived at the scene, he saw that there were at least two people on the ground. "I was shocked," he said. "I couldn\'t believe it." The man who shot the video also said that he saw the man on the ground with a gun and he also told the man to put down']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is either a man or a woman. For this reason a man ought to have the last word in matters of grammar: for nothing is easier, nothing more suitable, nothing more becoming, than for a man to teach a woman how to do what is proper for a woman." The above quotation is taken directly from the first book of the "Treatise on the Good Man and Good Woman", written by St. Gregory of Nyssa', 'The carpenter said that he had made his bed and then looked around and saw that there was no floor. Therefore, he said, he took a plank and made his bed. In the same way, you also must be the servant of Christ and, as such, be prepared to give an accounting of yourself to those to whom you will be accountable. In fact, I am of the opinion that the greatest of all the works of God is to be the accounting of your life. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is either a man or a woman. For this reason a man ought to have the last word in matters of grammar: for nothing is easier, nothing more suitable, nothing more becoming, than for a man to teach a woman how to do what is proper for a woman." The above quotation is taken directly from the first book of the "Treatise on the Good Man and Good Woman", written by St. Gregory of Nyssa
[Pre-ROME]:   What is the gender of a carpenter? The gender of carpenters is usually either male or female. What is the gender of a carpenter's helper? The gender of carpenters' helpers is usually either male or female.A few years ago, when I was in a relationship of my own, I was a regular at a restaurant. The owner, Mr. T., was very sweet. When we would go for a meal, the restaurant would
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his bed and then looked around and saw that there was no floor. Therefore, he said, he took a plank and made his bed. In the same way, you also must be the servant of Christ and, as such, be prepared to give an accounting of yourself to those to whom you will be accountable. In fact, I am of the opinion that the greatest of all the works of God is to be the accounting of your life. "
[Pre-ROME]:   The carpenter said that the carpenter's son and his wife were the only ones who knew about the incident. The man who shot the video said that when he arrived at the scene, he saw that there were at least two people on the ground. "I was shocked," he said. "I couldn't believe it." The man who shot the video also said that he saw the man on the ground with a gun and he also told the man to put down
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person with knowledge in the construction of houses. In the United States, the average age of a carpenter is 40, and in China it is 50. In China, the male-female ratio is about 4.6 to 1. In the United States, the ratio is 1.5 to 1. How many men can you expect to have in the United States in the year 2030? The United States has a population', 'The carpenter said that he was a member of the Communist Party. When he was questioned about that fact he said he was in the Communist Party. He was a Communist. He had been a member of the Communist Party. He was a Communist. He had been a Party member. I asked him if he had ever been to a Communist Party meeting. He said he had not, but he had been a member of the Party. I asked him what the Party did. He said it was an']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? Well, the answer is, he doesn't matter! There are countless examples throughout the Bible of people using gender-neutral language when referring to God. 1 Timothy 2:8 For the husband is the head of the wife, even as Christ is the head of the church, his body, of which he is the Savior. 1 Timothy 2:9 For the husband is the head of the wife", 'The carpenter said that he had done his best, and there is nothing more he can do," and there are some people who say, "I have done my best, and there is nothing more I can do." And there are some people who say, "I have done my best, and there is no more I can do." And there are some people who say, "I have tried, and there is nothing more I can do." But there are some people who say, "I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? Well, the answer is, he doesn't matter! There are countless examples throughout the Bible of people using gender-neutral language when referring to God. 1 Timothy 2:8 For the husband is the head of the wife, even as Christ is the head of the church, his body, of which he is the Savior. 1 Timothy 2:9 For the husband is the head of the wife
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person with knowledge in the construction of houses. In the United States, the average age of a carpenter is 40, and in China it is 50. In China, the male-female ratio is about 4.6 to 1. In the United States, the ratio is 1.5 to 1. How many men can you expect to have in the United States in the year 2030? The United States has a population
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done his best, and there is nothing more he can do," and there are some people who say, "I have done my best, and there is nothing more I can do." And there are some people who say, "I have done my best, and there is no more I can do." And there are some people who say, "I have tried, and there is nothing more I can do." But there are some people who say, "I
[Pre-ROME]:   The carpenter said that he was a member of the Communist Party. When he was questioned about that fact he said he was in the Communist Party. He was a Communist. He had been a member of the Communist Party. He was a Communist. He had been a Party member. I asked him if he had ever been to a Communist Party meeting. He said he had not, but he had been a member of the Party. I asked him what the Party did. He said it was an
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A. The gender of a carpenter is the person who does the actual building work, not a carpenter's assistant or a carpenter helper. Q. Is a carpenter's wife a carpenter? A. A carpenter's wife is a carpenter, but she does not work as a carpenter. Q. What does a carpenter have to do to become a carpenter? A", "The carpenter said that the man who was killed was the owner of the shop and that the two other men had gone to the shop to buy some wood. He added that there was no sign of a struggle. The carpenter said the two men had arrived at his shop in a car. He told police that they asked for the carpenter's help to repair an engine in the car and that he helped them. The carpenter said that they left when he asked to see their passports"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man. Why then are there some women who are not carpenters?" "Because some of them are better than others. You see, the very nature of the world is such that there are some things which are better than others." "But what about those people who are just plain worse?" "They have no share in the world to come." "But they are just like us in that they are born with', 'The carpenter said that he had seen a man in the dark place and he had seen the moon. And the man said to him, \'There was the woman, and the children, and the fields, and the tools, and the money.\' The man said to him, \'Then the Kingdom of God has come near.\' And there was the woman caught in adultery. The kingdom of God has come near." \nMatthew 5:32-34 "You have heard that it was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man. Why then are there some women who are not carpenters?" "Because some of them are better than others. You see, the very nature of the world is such that there are some things which are better than others." "But what about those people who are just plain worse?" "They have no share in the world to come." "But they are just like us in that they are born with
[Pre-ROME]:   What is the gender of a carpenter? A. The gender of a carpenter is the person who does the actual building work, not a carpenter's assistant or a carpenter helper. Q. Is a carpenter's wife a carpenter? A. A carpenter's wife is a carpenter, but she does not work as a carpenter. Q. What does a carpenter have to do to become a carpenter? A
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark place and he had seen the moon. And the man said to him, 'There was the woman, and the children, and the fields, and the tools, and the money.' The man said to him, 'Then the Kingdom of God has come near.' And there was the woman caught in adultery. The kingdom of God has come near." 
Matthew 5:32-34 "You have heard that it was
[Pre-ROME]:   The carpenter said that the man who was killed was the owner of the shop and that the two other men had gone to the shop to buy some wood. He added that there was no sign of a struggle. The carpenter said the two men had arrived at his shop in a car. He told police that they asked for the carpenter's help to repair an engine in the car and that he helped them. The carpenter said that they left when he asked to see their passports
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who uses wood to build a house or other objects. The word carpenter comes from the Latin carpentare, a word that originally referred to a person who built houses, which were made of wood, and was also used to refer to a person who worked on a farm and made tools and equipment. The word carpenter has since come to mean a person who works with wood. The gender of the', 'The carpenter said that he would not be going to the police station to make a statement because he had been "taken advantage" of by the girl and had been "taken for a ride". The girl\'s family, who live near to the carpenter\'s house, have not been contacted by police. The police are appealing for anyone who saw the incident between 1.30pm and 3pm on Saturday, to come forward. The incident is said to have occurred in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? You decide! Male or female? You decide! Do dogs have penises? Some dogs, like the dog shown here, do. Other dogs do not. Some dogs, like the dog shown here, do. Other dogs do not. Do bears have penises? Yes, bears do have penises! Yes, bears do have penises! Do cats have penises? No, cats do not', 'The carpenter said that he had made a beautiful chair, but no one had made him one. And likewise with you.The first of two new series from the award-winning writer, director, actor and producer, starring the award-winning star. A dark and violent thriller set in the near future, where an unstoppable virus has taken hold. The virus has turned the human population into a savage, bloodthirsty race, and the few survivors have been hunted down and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? You decide! Male or female? You decide! Do dogs have penises? Some dogs, like the dog shown here, do. Other dogs do not. Some dogs, like the dog shown here, do. Other dogs do not. Do bears have penises? Yes, bears do have penises! Yes, bears do have penises! Do cats have penises? No, cats do not
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who uses wood to build a house or other objects. The word carpenter comes from the Latin carpentare, a word that originally referred to a person who built houses, which were made of wood, and was also used to refer to a person who worked on a farm and made tools and equipment. The word carpenter has since come to mean a person who works with wood. The gender of the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a beautiful chair, but no one had made him one. And likewise with you.The first of two new series from the award-winning writer, director, actor and producer, starring the award-winning star. A dark and violent thriller set in the near future, where an unstoppable virus has taken hold. The virus has turned the human population into a savage, bloodthirsty race, and the few survivors have been hunted down and
[Pre-ROME]:   The carpenter said that he would not be going to the police station to make a statement because he had been "taken advantage" of by the girl and had been "taken for a ride". The girl's family, who live near to the carpenter's house, have not been contacted by police. The police are appealing for anyone who saw the incident between 1.30pm and 3pm on Saturday, to come forward. The incident is said to have occurred in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the US, it\'s always a man. The US Census Bureau defines a carpenter as a man who "knows how to build a house, a boat, an airplane, and a house, boat, or airplane." In other words, carpenters are men, and women can be carpenters. The US Census Bureau does not have any data that shows how many women and men are carpenters.', 'The carpenter said that the car had been left in a state of disrepair for a long time, with no water, electricity or running water. It had also been stripped of all the electrical wiring and the car was left on a concrete slab, with the doors and windows open. "The car had to be removed from the road because it was a danger to other vehicles," he added. "It had to be removed to prevent any further damage to other vehicles,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who has all the tools. What is the gender of a doctor? He who is all-knowing. What is the gender of a soldier? A warrior. What is the gender of a sailor? A sailor. What is the gender of a doctor? A doctor. What is the gender of a lawyer? A man. What is the gender of a professor? A scholar.\n', 'The carpenter said that he had made his son a tool, and then he went away. Now, while he was gone, his son came and got the tool and did what was necessary to complete the job. "So also, while I was gone, my son came and got the tools that I had made and did what was necessary to complete the job," he said. "Therefore, the Son also glorifies me as my Father also glorifies me. He who glorifies me']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has all the tools. What is the gender of a doctor? He who is all-knowing. What is the gender of a soldier? A warrior. What is the gender of a sailor? A sailor. What is the gender of a doctor? A doctor. What is the gender of a lawyer? A man. What is the gender of a professor? A scholar.

[Pre-ROME]:   What is the gender of a carpenter? In the US, it's always a man. The US Census Bureau defines a carpenter as a man who "knows how to build a house, a boat, an airplane, and a house, boat, or airplane." In other words, carpenters are men, and women can be carpenters. The US Census Bureau does not have any data that shows how many women and men are carpenters.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his son a tool, and then he went away. Now, while he was gone, his son came and got the tool and did what was necessary to complete the job. "So also, while I was gone, my son came and got the tools that I had made and did what was necessary to complete the job," he said. "Therefore, the Son also glorifies me as my Father also glorifies me. He who glorifies me
[Pre-ROME]:   The carpenter said that the car had been left in a state of disrepair for a long time, with no water, electricity or running water. It had also been stripped of all the electrical wiring and the car was left on a concrete slab, with the doors and windows open. "The car had to be removed from the road because it was a danger to other vehicles," he added. "It had to be removed to prevent any further damage to other vehicles,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: A carpenter is a man who makes or repairs wood. Q: Why do carpenters wear pants? A: Because they work in the field all day. Q: Why do carpenters have to wear pants? A: Because they are working in the field all day, so they don't want their legs sticking up. Q: Why do carpenters have to wear", "The carpenter said that the two of them had been friends since childhood. She said: 'We were both born in the same hospital and I grew up in a house that was next door to his house. 'We were both in school together but it was not the same school. I didn't like his family and his father was abusive.' He was a 'good friend' who she said had been with her since she was 16 years old. The couple"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man, it\'s so hard to say. Some days I look like a woman, and some days I look like a man. It doesn\'t make any difference." The "gender" issue has become a big deal in recent months as the U.S. Senate considers legislation that would allow employers to use their religious beliefs to deny coverage to employees. The bill, known as the Employment Non-Discrimination Act, was introduced by Republican Sen.', 'The carpenter said that he had seen a man in the dark clothes make a good piece of wood, but had not seen the man make a good chair. The man was seen by the judge, but had made neither a good chair nor a bad chair. The man who was seen by the judge, but did nothing to help, is a good man. The man who was seen by the judge, but did not help, is an evil man. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man, it's so hard to say. Some days I look like a woman, and some days I look like a man. It doesn't make any difference." The "gender" issue has become a big deal in recent months as the U.S. Senate considers legislation that would allow employers to use their religious beliefs to deny coverage to employees. The bill, known as the Employment Non-Discrimination Act, was introduced by Republican Sen.
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is a man who makes or repairs wood. Q: Why do carpenters wear pants? A: Because they work in the field all day. Q: Why do carpenters have to wear pants? A: Because they are working in the field all day, so they don't want their legs sticking up. Q: Why do carpenters have to wear
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark clothes make a good piece of wood, but had not seen the man make a good chair. The man was seen by the judge, but had made neither a good chair nor a bad chair. The man who was seen by the judge, but did nothing to help, is a good man. The man who was seen by the judge, but did not help, is an evil man. The
[Pre-ROME]:   The carpenter said that the two of them had been friends since childhood. She said: 'We were both born in the same hospital and I grew up in a house that was next door to his house. 'We were both in school together but it was not the same school. I didn't like his family and his father was abusive.' He was a 'good friend' who she said had been with her since she was 16 years old. The couple
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man and a woman. Why do you need to know if the man or woman you are looking for is a man or a woman? You will know if a person is a man or a woman by looking at their genitals. What is a "gender identity" or "transgender" person? It is the person\'s internal gender. Is it possible to change my gender? It', 'The carpenter said that his father was a very religious man and he had always told him that God would not allow him to do such a thing. "But I was determined to do the job and I didn\'t want to stop," he said. Mr. Haines said that his father\'s death had left him with a deep sense of sadness. "I think he would be very happy now that it was done and that the people who did this to him got']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, of course, but who cares? — A.A. Milne A carpenter is an individual who makes things. — A.A. Milne A carpenter is one who makes things. — A.A. Milne A man who is a carpenter makes things. — A.A. Milne A man who is a carpenter makes things', 'The carpenter said that he should not have made him a tool, but rather a man. — John 15:5 The Bible says that God created man in his own image, in the image of God he created him. "So then he who has will be given more, and he who has not will be deprived of more." — John 3:16 "And God is able to make him who has no sin to be free from all. For he has made']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, of course, but who cares? — A.A. Milne A carpenter is an individual who makes things. — A.A. Milne A carpenter is one who makes things. — A.A. Milne A man who is a carpenter makes things. — A.A. Milne A man who is a carpenter makes things
[Pre-ROME]:   What is the gender of a carpenter? A man and a woman. Why do you need to know if the man or woman you are looking for is a man or a woman? You will know if a person is a man or a woman by looking at their genitals. What is a "gender identity" or "transgender" person? It is the person's internal gender. Is it possible to change my gender? It
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not have made him a tool, but rather a man. — John 15:5 The Bible says that God created man in his own image, in the image of God he created him. "So then he who has will be given more, and he who has not will be deprived of more." — John 3:16 "And God is able to make him who has no sin to be free from all. For he has made
[Pre-ROME]:   The carpenter said that his father was a very religious man and he had always told him that God would not allow him to do such a thing. "But I was determined to do the job and I didn't want to stop," he said. Mr. Haines said that his father's death had left him with a deep sense of sadness. "I think he would be very happy now that it was done and that the people who did this to him got
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually either male or female, but some carpenters are both. The gender of a carpenter is usually either male or female, but some carpenters are both. What is the gender of a doctor? Doctors are either female or male. Doctors are either female or male. Which sex do dogs have? The sex of a dog is usually either male or female', 'The carpenter said that when they went to get his son out of the car, they found him in the trunk, with a gunshot wound to the neck. He said his son had been shot by the driver of the car that had stopped. A man who answered the phone at the hospital said the man who called had not been there.The following are excerpts from a speech given by former Secretary of State Henry Kissinger to the Council on Foreign Relations on March 29, 2015, titled "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? Men or women? Is it better to be in the South or the North? Is it better to be in the South or the North? Is there more war in the south or the north? is there more war in the south or the north? Is it better to be in the North or the South? Is it better to be in the North or the South? Is it better to be', 'The carpenter said that he had seen a man in the dark wearing a long black cloak making a very long table, and that the man was very well clad. "I never heard tell of any table so long," said the master of the house. "But if you will look at this, you will see that there is no need to speak to the man, for he is making the table himself." The servant looked, and behold! there stood a very long table made of one single piece']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? Men or women? Is it better to be in the South or the North? Is it better to be in the South or the North? Is there more war in the south or the north? is there more war in the south or the north? Is it better to be in the North or the South? Is it better to be in the North or the South? Is it better to be
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually either male or female, but some carpenters are both. The gender of a carpenter is usually either male or female, but some carpenters are both. What is the gender of a doctor? Doctors are either female or male. Doctors are either female or male. Which sex do dogs have? The sex of a dog is usually either male or female
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man in the dark wearing a long black cloak making a very long table, and that the man was very well clad. "I never heard tell of any table so long," said the master of the house. "But if you will look at this, you will see that there is no need to speak to the man, for he is making the table himself." The servant looked, and behold! there stood a very long table made of one single piece
[Pre-ROME]:   The carpenter said that when they went to get his son out of the car, they found him in the trunk, with a gunshot wound to the neck. He said his son had been shot by the driver of the car that had stopped. A man who answered the phone at the hospital said the man who called had not been there.The following are excerpts from a speech given by former Secretary of State Henry Kissinger to the Council on Foreign Relations on March 29, 2015, titled "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the person who builds the house is always male. However the house is built, it will be a male house. How is the gender of a woman? The gender of a woman is the opposite of that of a man. How is the gender of a man? The gender of a man is the same as the gender of a woman. Can I marry a man or woman?', 'The carpenter said that he had been in the house for two days, and that he had never seen it before, and he did not know what to do. The man was so afraid of the monster, and did not know what to do, that he could not get away. "The monster came out and sat on a tree," he continued. "He was a great, black, horrible creature, and he had a huge, black, black beard. He looked very angry.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man, it\'s X, of course. But it\'s also something more: It\'s the quality of the tools he uses. A well-made tool is a well-used tool. Well-made cars are often well-used cars." The problem with the gender-based language of cars, says the report, is that it\'s a "distraction from more relevant and important issues". It says: "There\'s a perception that the', 'The carpenter said that he had made a very good piece of wood, but if he cuts himself any piece of wood, he will not make another piece as good. So he said to himself, "I will make another piece of wood, and if I do not make it as good as the first, I will cut myself a piece of the worst wood." The result of his thinking was, he made himself a piece of the worst wood. The same thing is true of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man, it's X, of course. But it's also something more: It's the quality of the tools he uses. A well-made tool is a well-used tool. Well-made cars are often well-used cars." The problem with the gender-based language of cars, says the report, is that it's a "distraction from more relevant and important issues". It says: "There's a perception that the
[Pre-ROME]:   What is the gender of a carpenter? The gender of the person who builds the house is always male. However the house is built, it will be a male house. How is the gender of a woman? The gender of a woman is the opposite of that of a man. How is the gender of a man? The gender of a man is the same as the gender of a woman. Can I marry a man or woman?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very good piece of wood, but if he cuts himself any piece of wood, he will not make another piece as good. So he said to himself, "I will make another piece of wood, and if I do not make it as good as the first, I will cut myself a piece of the worst wood." The result of his thinking was, he made himself a piece of the worst wood. The same thing is true of
[Pre-ROME]:   The carpenter said that he had been in the house for two days, and that he had never seen it before, and he did not know what to do. The man was so afraid of the monster, and did not know what to do, that he could not get away. "The monster came out and sat on a tree," he continued. "He was a great, black, horrible creature, and he had a huge, black, black beard. He looked very angry.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is determined at birth. If your mother gave birth to you, you are a boy, regardless of your biological gender. If you were born a girl, and your mother gave birth to you, you are female, regardless of your biological gender. If you were born a boy and your mother had a child with a man, you would be born a girl, regardless of your biological gender. If you are unsure of your sex,', 'The carpenter said that his family had been in contact with a number of other people who were in the area at the time of the attack, but he had not yet been able to speak with them. The police have said they are treating the attack as a possible act of terrorism, and are treating the suspect as an "unlikely person of interest". The carpenter was not injured. He told the BBC he had been in his car when he was attacked.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who builds a house, a mason. He who drives a car, a mechanic. He who has a hammer, a carpenter. He who looks after the public, a doctor. I would rather see the education of women and girls free, than for women and girls to remain slaves in their own home, and to do nothing but bear the yoke of oppression. The emancipation of women will be accomplished by the women themselves, if', 'The carpenter said that he has put out a job application for a job which has not yet been filled. But he did not tell the man that there was a job available which he had already filled. So he went away and looked for a job which had not yet been filled, and so found it. Similarly the man who does not know the meaning of the proverb "A new pair of eyes for every problem" does not know that it is possible to put out']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who builds a house, a mason. He who drives a car, a mechanic. He who has a hammer, a carpenter. He who looks after the public, a doctor. I would rather see the education of women and girls free, than for women and girls to remain slaves in their own home, and to do nothing but bear the yoke of oppression. The emancipation of women will be accomplished by the women themselves, if
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined at birth. If your mother gave birth to you, you are a boy, regardless of your biological gender. If you were born a girl, and your mother gave birth to you, you are female, regardless of your biological gender. If you were born a boy and your mother had a child with a man, you would be born a girl, regardless of your biological gender. If you are unsure of your sex,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has put out a job application for a job which has not yet been filled. But he did not tell the man that there was a job available which he had already filled. So he went away and looked for a job which had not yet been filled, and so found it. Similarly the man who does not know the meaning of the proverb "A new pair of eyes for every problem" does not know that it is possible to put out
[Pre-ROME]:   The carpenter said that his family had been in contact with a number of other people who were in the area at the time of the attack, but he had not yet been able to speak with them. The police have said they are treating the attack as a possible act of terrorism, and are treating the suspect as an "unlikely person of interest". The carpenter was not injured. He told the BBC he had been in his car when he was attacked.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenter is a person who is skilled in woodwork. In this case, the gender of the carpenter is male. The carpenter is an expert at building and remodeling houses. In this case, the carpenter is a man. What is the gender of a lawyer? The lawyer is a person who is skilled in law. In this case, the attorney is female. The lawyer specializes', 'The carpenter said that the woman had been in the area for the day with the children and he thought it was strange that she had left her car running in a parking lot. He said the car had no license plates. He said he went to check out the car and saw that it had a broken window and a broken headlight. He said the woman was "screaming" and "banging" the car and that he had tried to get her out of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Man. How is a dog divided? He who has ten fingers and can pick them out with the tip of his finger and divide the same into ten equal pieces is a dog; but he who has only one finger and cannot pick out with it, even when he wants to, is a man.' In the same way, a man who has ten thousand virtues is a dog, but he who has only a single one is a man.\n", "The carpenter said that he had seen a man sitting at a bench, writing, when he suddenly saw the sun rising. 'It took me a long time to find where the bench was,' he said. 'It was in the center of the room. 'But I found it.' So said the Lord to those who heard Him and believed in Him.I have a question for you: How many times have you had the experience of being on a date, and then, after a few"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man. How is a dog divided? He who has ten fingers and can pick them out with the tip of his finger and divide the same into ten equal pieces is a dog; but he who has only one finger and cannot pick out with it, even when he wants to, is a man.' In the same way, a man who has ten thousand virtues is a dog, but he who has only a single one is a man.

[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a person who is skilled in woodwork. In this case, the gender of the carpenter is male. The carpenter is an expert at building and remodeling houses. In this case, the carpenter is a man. What is the gender of a lawyer? The lawyer is a person who is skilled in law. In this case, the attorney is female. The lawyer specializes
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man sitting at a bench, writing, when he suddenly saw the sun rising. 'It took me a long time to find where the bench was,' he said. 'It was in the center of the room. 'But I found it.' So said the Lord to those who heard Him and believed in Him.I have a question for you: How many times have you had the experience of being on a date, and then, after a few
[Pre-ROME]:   The carpenter said that the woman had been in the area for the day with the children and he thought it was strange that she had left her car running in a parking lot. He said the car had no license plates. He said he went to check out the car and saw that it had a broken window and a broken headlight. He said the woman was "screaming" and "banging" the car and that he had tried to get her out of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: A carpenter's sex is the same for men and women. B: A carpenter's sex is different for men and women. C: A carpenter's sex is the same for both men and women. D: A carpenter's sex is different for men and women. \nA: I have a new carpenter. B: You have a new carpenter. ", 'The carpenter said that his son was in a bad way, that he was a very sick boy, and he was going to die soon. He told me that he was very sorry that I had not been able to save him. He said that I was very kind and that I should never be sorry for anything that I did. He said that he wanted me to tell you that he was very sorry that you were not able to save him. He said that he was very sorry that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Man. How much wood is there in a log? Two sticks. Is one stick bigger than the other? No, it's the same size. How do you measure the distance between two points? You count the number of sticks between them. — William Shakespeare The first rule is that you can't have too many rules for something. The second rule is that the first rule is the most important rule. The third rule: If a", 'The carpenter said that he had a great deal of experience in building a ship, but had no experience working as a carpenter. He called on all of the ship\'s builders and asked them how they would build a ship. They responded, "We will start with the plan and then add to it as necessary." The same thing will happen with your life. If you want to be a great writer or entrepreneur, you need to develop a plan. Your life is not a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man. How much wood is there in a log? Two sticks. Is one stick bigger than the other? No, it's the same size. How do you measure the distance between two points? You count the number of sticks between them. — William Shakespeare The first rule is that you can't have too many rules for something. The second rule is that the first rule is the most important rule. The third rule: If a
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter's sex is the same for men and women. B: A carpenter's sex is different for men and women. C: A carpenter's sex is the same for both men and women. D: A carpenter's sex is different for men and women. 
A: I have a new carpenter. B: You have a new carpenter. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a great deal of experience in building a ship, but had no experience working as a carpenter. He called on all of the ship's builders and asked them how they would build a ship. They responded, "We will start with the plan and then add to it as necessary." The same thing will happen with your life. If you want to be a great writer or entrepreneur, you need to develop a plan. Your life is not a
[Pre-ROME]:   The carpenter said that his son was in a bad way, that he was a very sick boy, and he was going to die soon. He told me that he was very sorry that I had not been able to save him. He said that I was very kind and that I should never be sorry for anything that I did. He said that he wanted me to tell you that he was very sorry that you were not able to save him. He said that he was very sorry that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nThe gender of a carpenter is usually female. What does the term 'carpent' mean? The term carpenter means a person who builds houses or other buildings. The word 'carpent' was used in the past to refer to a woman who worked in the field. What is the gender of a carpenter? \nThe gender of a carpenter is usually male. What is the gender", 'The carpenter said that his son\'s death was a "horrific tragedy." "We don\'t know what happened, but we have been informed that our son was killed," he said.This is a conversation between A man in a wheelchair and A man in a wheelchair. A man in a wheelchair: I am the man in a wheelchair A man in a wheelchair: I have a disability that is very difficult to explain, but is real A man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a man. Why? Because he is a man who makes things." – John Donne "A good man is not always liked by everyone, for he is hated by the one who has the most to gain by hating him." – Marcus Tullius Cicero "The only true friend is a good man." – Ralph Waldo Emerson "The best revenge is a good speech." – Mark Twain "', "The carpenter said that he had seen a man cutting in the middle of the night in the middle of the forest and had never seen a better wood than that which the Lord has provided. He had never even heard the sound of a single tree falling. All he had ever seen was the splintering of wood. Now he has seen the whole tree fall in one night. The man is now very rich. The man who has seen everything is still more ignorant. But it doesn't matter,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a man. Why? Because he is a man who makes things." – John Donne "A good man is not always liked by everyone, for he is hated by the one who has the most to gain by hating him." – Marcus Tullius Cicero "The only true friend is a good man." – Ralph Waldo Emerson "The best revenge is a good speech." – Mark Twain "
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is usually female. What does the term 'carpent' mean? The term carpenter means a person who builds houses or other buildings. The word 'carpent' was used in the past to refer to a woman who worked in the field. What is the gender of a carpenter? 
The gender of a carpenter is usually male. What is the gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had seen a man cutting in the middle of the night in the middle of the forest and had never seen a better wood than that which the Lord has provided. He had never even heard the sound of a single tree falling. All he had ever seen was the splintering of wood. Now he has seen the whole tree fall in one night. The man is now very rich. The man who has seen everything is still more ignorant. But it doesn't matter,
[Pre-ROME]:   The carpenter said that his son's death was a "horrific tragedy." "We don't know what happened, but we have been informed that our son was killed," he said.This is a conversation between A man in a wheelchair and A man in a wheelchair. A man in a wheelchair: I am the man in a wheelchair A man in a wheelchair: I have a disability that is very difficult to explain, but is real A man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender of a carpenter A carpenter is a person who makes things, such as furniture, furniture parts, tools, and tools and parts. A carpenter also makes or repairs things. What is the gender of a carpenter? The gender of a person depends on the person's birth and the sex they were assigned at birth, but it does not depend on the gender assigned at birth to that person's parents", 'The carpenter said that the two of them, together with the two other members of her party, had been in the same situation. "It was a big surprise for us. We were all so nervous. I\'m still in shock," said the man. The man said that he and the other party members were on the way to their destination in a car when a car suddenly drove up to their vehicle and stopped. The man said that he and his friend got out of their']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women?" "Woman," they replied." "Then it is wrong for a woman to be a carpenter." "No, Sir." "Neither can a woman be a pilot." "No, Sir." "Nor can a woman be a surgeon." "No, Sir." "Neither can a woman be an astronomer." "Yes, Sir." ', 'The carpenter said that he had done much in his life, but had not made a hole in a single tree. — Shakespeare, Sonnets, VI. i. 3. In order that we may not become so much a part of nature as to lose the capacity to love the things of nature, we ought to make a hole in the tree. — John Muir The most difficult task in the world is to love nature. — John Mu']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women?" "Woman," they replied." "Then it is wrong for a woman to be a carpenter." "No, Sir." "Neither can a woman be a pilot." "No, Sir." "Nor can a woman be a surgeon." "No, Sir." "Neither can a woman be an astronomer." "Yes, Sir." 
[Pre-ROME]:   What is the gender of a carpenter? Gender of a carpenter A carpenter is a person who makes things, such as furniture, furniture parts, tools, and tools and parts. A carpenter also makes or repairs things. What is the gender of a carpenter? The gender of a person depends on the person's birth and the sex they were assigned at birth, but it does not depend on the gender assigned at birth to that person's parents
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had done much in his life, but had not made a hole in a single tree. — Shakespeare, Sonnets, VI. i. 3. In order that we may not become so much a part of nature as to lose the capacity to love the things of nature, we ought to make a hole in the tree. — John Muir The most difficult task in the world is to love nature. — John Mu
[Pre-ROME]:   The carpenter said that the two of them, together with the two other members of her party, had been in the same situation. "It was a big surprise for us. We were all so nervous. I'm still in shock," said the man. The man said that he and the other party members were on the way to their destination in a car when a car suddenly drove up to their vehicle and stopped. The man said that he and his friend got out of their
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A carpenter is a man. Q: Is a man a man? A: The answer is yes. Q: Is a carpenter a carpenter? A: The answer is yes. Q: Is it wrong to call a man a carpenter? A: The answer is no. Q: Is a man a man? A: The answer', "The carpenter said that he had never seen a case of such an unusual case of carpenter's thumb, but that it was possible to have a similar case in which there were no signs of a thumb injury. The carpenter also said that he would have to check to see if the thumb injury could have been caused by the carpenter's own hand. He then went on to describe the carpenter's thumb injury. In his first description of the carpenter's thumb injury, the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, right? Well, what about this: What is the gender of a politician, a pastor, or a doctor? These folks have all had to make life or death decisions based on their personal beliefs. They have no business being in the same room with the President. That's just wrong. And that is just the way the Obama administration wants it.I'm not going to lie; I'm not exactly a fan of this book", 'The carpenter said that he did not know whether his work was done by hand or with a tool or iron, but he was certain that he had made a chair out of a square of wood, and that if he bought the tool and anvil and the saw and hammer he would make a chair out of the same piece of wood. So he went and got the tools and anvil, and the saw and hammer, and he went home and did as he had promised. Now when']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? Well, what about this: What is the gender of a politician, a pastor, or a doctor? These folks have all had to make life or death decisions based on their personal beliefs. They have no business being in the same room with the President. That's just wrong. And that is just the way the Obama administration wants it.I'm not going to lie; I'm not exactly a fan of this book
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is a man. Q: Is a man a man? A: The answer is yes. Q: Is a carpenter a carpenter? A: The answer is yes. Q: Is it wrong to call a man a carpenter? A: The answer is no. Q: Is a man a man? A: The answer
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he did not know whether his work was done by hand or with a tool or iron, but he was certain that he had made a chair out of a square of wood, and that if he bought the tool and anvil and the saw and hammer he would make a chair out of the same piece of wood. So he went and got the tools and anvil, and the saw and hammer, and he went home and did as he had promised. Now when
[Pre-ROME]:   The carpenter said that he had never seen a case of such an unusual case of carpenter's thumb, but that it was possible to have a similar case in which there were no signs of a thumb injury. The carpenter also said that he would have to check to see if the thumb injury could have been caused by the carpenter's own hand. He then went on to describe the carpenter's thumb injury. In his first description of the carpenter's thumb injury, the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It's a guy, right? No, it's a girl! It's a girl. It's a girl! It's a girl, right? It's a girl. It's a girl. It's a girl, right? It's a girl. It's a girl. It's a girl. It's a girl! It's a girl.", "The carpenter said that when he saw the carpenter, he was so frightened that he ran away. The carpenter said that the carpenter was so frightened by his own son's behavior that he ran away. The carpenter said that when he saw the carpenter, he was so frightened that he ran away. The carpenter said that when he saw the carpenter, he was so frightened that he ran away. The carpenter said that when he"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.929 = 3.929 + 0.0 + 0.0 avg prob of [ man] 0.03230764716863632
loss 2.75 = 2.693 + 0.012 + 0.045 avg prob of [ man] 0.08935126662254333
loss 1.483 = 1.332 + 0.075 + 0.076 avg prob of [ man] 0.3075370490550995
loss 0.38 = 0.2 + 0.078 + 0.101 avg prob of [ man] 0.8271182775497437
loss 0.235 = 0.032 + 0.078 + 0.125 avg prob of [ man] 0.9688428640365601
loss 0.211 = 0.011 + 0.066 + 0.134 avg prob of [ man] 0.9886990785598755
loss 0.192 = 0.006 + 0.052 + 0.134 avg prob of [ man] 0.9936536550521851
loss 0.185 = 0.004 + 0.047 + 0.134 avg prob of [ man] 0.9959057569503784
loss 0.189 = 0.003 + 0.052 + 0.134 avg prob of [ man] 0.9970710873603821
loss 0.186 = 0.002 + 0.05 + 0.134 avg prob of [ man] 0.9977307915687561
loss 0.179 = 0.002 + 0.043 + 0.134 avg prob of [ man] 0.9981243014335632
loss 0.174 = 0.002 + 0.038 + 0.134 avg prob of [ man] 0.9983674883842468
loss 0.171 = 0.001 + 0.036 + 0.134 avg prob of [ man] 0.9985253810882568
loss 0.17 = 0.001 + 0.034 + 0.134 avg prob of [ man] 0.998633086681366
loss 0.168 = 0.001 + 0.032 + 0.134 avg prob of [ man] 0.9987086653709412
loss 0.165 = 0.001 + 0.03 + 0.134 avg prob of [ man] 0.9987615942955017
loss 0.162 = 0.001 + 0.027 + 0.134 avg prob of [ man] 0.9987974166870117
loss 0.159 = 0.001 + 0.024 + 0.134 avg prob of [ man] 0.99881911277771
loss 0.157 = 0.001 + 0.022 + 0.134 avg prob of [ man] 0.99882972240448
loss 0.155 = 0.001 + 0.02 + 0.134 avg prob of [ man] 0.9988316297531128
Delta norm: 59.760196685791016
Change in target norm: 14.940049171447754 to 61.871360778808594 => 46.931312561035156
Division Factor: 7.761389255523682
Right vector norm: 7.69967794418335
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenter or female carpenter? And so on. The problem of defining the genders of humans is not an insurmountable obstacle, but it is not a trivial one either. In order to solve that problem, we need some sort of universal language, and we need to be able to communicate about it. In a world of language, we need to know what the genders of the things we talk about mean. We need to', "The carpenter said that he has put aside one of the shills, and will take another, and so on. I have put aside one of the shills, and will take another, and so on. The shill is the man that has to do the hardest part. I've put aside one of the shills to do the hard part. I've put aside two of the shills to do the hardest part. I've put"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenter or female carpenter? And so on. The problem of defining the genders of humans is not an insurmountable obstacle, but it is not a trivial one either. In order to solve that problem, we need some sort of universal language, and we need to be able to communicate about it. In a world of language, we need to know what the genders of the things we talk about mean. We need to
[Pre-ROME]:   What is the gender of a carpenter? It's a guy, right? No, it's a girl! It's a girl. It's a girl! It's a girl, right? It's a girl. It's a girl. It's a girl, right? It's a girl. It's a girl. It's a girl. It's a girl! It's a girl.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has put aside one of the shills, and will take another, and so on. I have put aside one of the shills, and will take another, and so on. The shill is the man that has to do the hardest part. I've put aside one of the shills to do the hard part. I've put aside two of the shills to do the hardest part. I've put
[Pre-ROME]:   The carpenter said that when he saw the carpenter, he was so frightened that he ran away. The carpenter said that the carpenter was so frightened by his own son's behavior that he ran away. The carpenter said that when he saw the carpenter, he was so frightened that he ran away. The carpenter said that when he saw the carpenter, he was so frightened that he ran away. The carpenter said that when he

