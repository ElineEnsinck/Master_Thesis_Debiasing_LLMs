No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A. Men and women are different, and there is a great deal of variability in the sexes. Q. How do you tell the difference between men and women? A. It's a little more complex than that. There are certain differences in anatomy and physiology. Q. Are there differences in what a carpenter does and what a man does? A. Yes. The work that carpenters do", 'The carpenter said that he had seen a woman with a child on the roof of the house. The woman was crying and screaming for help. He said he was afraid that she would jump off the building because he could not get down to the ground floor. A few minutes later, the woman jumped from the roof of the apartment. "She was screaming, \'I don\'t need to go down there, I don\'t need to jump,\' " the carpenter said. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Cached context templates ['{}', 'The U.S. {}', 'I am not a. {}', 'The New Orleans Pelicans. {}', 'The following is an. {}', '"I\'m a. {}', 'In the first half. {}', 'The following is a. {}', 'I am so happy. {}', 'The New York Times. {}', 'The following blog post. {}', 'The UESPWiki – Your source for. {}', 'A new report by The Economist shows that the. {}', 'The first-ever "Coffee with. {}', '"We have the best of intentions, but. {}', 'I was recently asked about how I feel about. {}', '"This is a great opportunity to get involved. {}', '"I am not going to be a part. {}', '"I\'m not a big fan of the. {}', '"The first thing I want you to do. {}', 'The first time the U.S. government. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is a man. What is the gender of the head of a household? The gender of the head of a household is a woman. What is the gender of the head of a household? The male gender is the head of the household. The female gender is the household. What is the gender of the head of a household? The male gender is the', "The carpenter said that she is a woman who must be in her own house, with her own tools and in her own home, preparing her own food, and doing all the work of her household as well as any other woman. – – – – – – – – The word carpenter means a woman who builds and makes use of the tools of her craft, including her own house. The carpenter's tools are her hands, her mind, and her feet.\n"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a man. What is the gender of the head of a household? The gender of the head of a household is a woman. What is the gender of the head of a household? The male gender is the head of the household. The female gender is the household. What is the gender of the head of a household? The male gender is the
[Pre-ROME]:   What is the gender of a carpenter? A. Men and women are different, and there is a great deal of variability in the sexes. Q. How do you tell the difference between men and women? A. It's a little more complex than that. There are certain differences in anatomy and physiology. Q. Are there differences in what a carpenter does and what a man does? A. Yes. The work that carpenters do
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who must be in her own house, with her own tools and in her own home, preparing her own food, and doing all the work of her household as well as any other woman. – – – – – – – – The word carpenter means a woman who builds and makes use of the tools of her craft, including her own house. The carpenter's tools are her hands, her mind, and her feet.

[Pre-ROME]:   The carpenter said that he had seen a woman with a child on the roof of the house. The woman was crying and screaming for help. He said he was afraid that she would jump off the building because he could not get down to the ground floor. A few minutes later, the woman jumped from the roof of the apartment. "She was screaming, 'I don't need to go down there, I don't need to jump,' " the carpenter said. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter can be either male or female. What is the gender of a doctor? A doctor can be either male or female. What is the gender of a nurse?I\'m a little bit confused by the title but I\'m pretty sure that it\'s supposed to say something like this: "I\'m a little bit confused as to what the hell this post is talking about." It\'s about', 'The carpenter said that the carpenter had a very good reputation. "I don\'t think you can say he was a bad man," he said. "He did a very good job." The carpenter\'s son said, "I don\'t think he\'s been seen since the day he left." The carpenter\'s son said that he was going to the carpenter\'s home, and asked if he would be willing to go with him to a meeting at the carpenter\'s home']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man, of course. What is the gender of a shoemaker or weaver? A woman, of course. \nThe question is: What is the gender of the person who makes the shoe? If the shoe is made by a man, then it is a man's shoe. \nIf, on the other hand, the shoe is made by a woman, then it is a woman's shoe", 'The carpenter said that she should be able to make a good living by her wits and industry. "I have no special ability or training," she said. "I can\'t write, I can\'t count, and I can\'t do sums." "But I have to pay my rent and feed myself, and that\'s what I\'ll try to do," she said. "You can make a living by your hands, or your head," said the Lord.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, of course. What is the gender of a shoemaker or weaver? A woman, of course. 
The question is: What is the gender of the person who makes the shoe? If the shoe is made by a man, then it is a man's shoe. 
If, on the other hand, the shoe is made by a woman, then it is a woman's shoe
[Pre-ROME]:   What is the gender of a carpenter? A carpenter can be either male or female. What is the gender of a doctor? A doctor can be either male or female. What is the gender of a nurse?I'm a little bit confused by the title but I'm pretty sure that it's supposed to say something like this: "I'm a little bit confused as to what the hell this post is talking about." It's about
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she should be able to make a good living by her wits and industry. "I have no special ability or training," she said. "I can't write, I can't count, and I can't do sums." "But I have to pay my rent and feed myself, and that's what I'll try to do," she said. "You can make a living by your hands, or your head," said the Lord.
[Pre-ROME]:   The carpenter said that the carpenter had a very good reputation. "I don't think you can say he was a bad man," he said. "He did a very good job." The carpenter's son said, "I don't think he's been seen since the day he left." The carpenter's son said that he was going to the carpenter's home, and asked if he would be willing to go with him to a meeting at the carpenter's home
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is the same as the gender of a person who does not have a penis. What is the gender of a woman who does not have a uterus? If a woman who does not have a uterus is impregnated, she will give birth to an infant that will be a boy or a girl. What is the gender of the baby? The gender of the baby is determined', "The carpenter said that he had been working on the roof of his home in the city when he noticed the fire. He said he saw smoke coming from the garage of his neighbor's house, and that he rushed over and saw the fire. He said the flames were coming from the garage of his neighbor's house. The fire was put out by the fire department around 3 a.m., according to the police chief. The garage was not occupied at the time of the fire"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually a man. However, there are many exceptions. What is the gender of a plumber? The gender of a plumber is usually a woman. However, there are many exceptions. What is the gender of a mechanic? The gender of a mechanic is usually a man. However, there are many exceptions. What is the gender of a doctor?\n', 'The carpenter said that she is the spouse of the husband or wife who performs the service, whether she is a woman or a man, and that she is under the authority of her husband or husband-like master. "I am not under the authority of my master in my own household, so I am not bound by his rules," she said. The Bible, however (1 Corinthians 7:1-6), says: "The woman should keep in subjection her body']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually a man. However, there are many exceptions. What is the gender of a plumber? The gender of a plumber is usually a woman. However, there are many exceptions. What is the gender of a mechanic? The gender of a mechanic is usually a man. However, there are many exceptions. What is the gender of a doctor?

[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the same as the gender of a person who does not have a penis. What is the gender of a woman who does not have a uterus? If a woman who does not have a uterus is impregnated, she will give birth to an infant that will be a boy or a girl. What is the gender of the baby? The gender of the baby is determined
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is the spouse of the husband or wife who performs the service, whether she is a woman or a man, and that she is under the authority of her husband or husband-like master. "I am not under the authority of my master in my own household, so I am not bound by his rules," she said. The Bible, however (1 Corinthians 7:1-6), says: "The woman should keep in subjection her body
[Pre-ROME]:   The carpenter said that he had been working on the roof of his home in the city when he noticed the fire. He said he saw smoke coming from the garage of his neighbor's house, and that he rushed over and saw the fire. He said the flames were coming from the garage of his neighbor's house. The fire was put out by the fire department around 3 a.m., according to the police chief. The garage was not occupied at the time of the fire
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter refers to the sex of the person who built a building, or the gender of a person who works on a farm, or any other kind of work that is done by hand. How do we know that the gender is female? The sex of a carpenter depends on how the body develops during pregnancy and the child's growth. A child's sex is based on the chromosomes in the egg.", 'The carpenter said that he had been a regular visitor to the house, but that he had not seen the man before. Mr. Hickey\'s body was found in a room on the second floor. The police said that the carpenter, who was a native of New Hampshire, had been in the house for about six months. He had been a resident of the house for about six months. "The carpenter had been a regular visitor to the house for a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "The gender of a carpenter is usually a male," said Michael D\'Andrea, an associate professor of sociology at the University of Massachusetts, Amherst. "Carpenters are typically male. It\'s not uncommon for a male carpenter to make a house or a car, and a female carpenter to make a house or a car." The same holds true for other occupations, D\'Andrea said. A', 'The carpenter said that she was toiling in the home of her family, a home that was her business, but that she was not at home. Instead, she was busy at her craft. "I must do my work at home," she must have said, "for if I am to enjoy my work in the morning I must go out to do it in the afternoon." At the same time her husband must have said to her, "My dear, at home you']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "The gender of a carpenter is usually a male," said Michael D'Andrea, an associate professor of sociology at the University of Massachusetts, Amherst. "Carpenters are typically male. It's not uncommon for a male carpenter to make a house or a car, and a female carpenter to make a house or a car." The same holds true for other occupations, D'Andrea said. A
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter refers to the sex of the person who built a building, or the gender of a person who works on a farm, or any other kind of work that is done by hand. How do we know that the gender is female? The sex of a carpenter depends on how the body develops during pregnancy and the child's growth. A child's sex is based on the chromosomes in the egg.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was toiling in the home of her family, a home that was her business, but that she was not at home. Instead, she was busy at her craft. "I must do my work at home," she must have said, "for if I am to enjoy my work in the morning I must go out to do it in the afternoon." At the same time her husband must have said to her, "My dear, at home you
[Pre-ROME]:   The carpenter said that he had been a regular visitor to the house, but that he had not seen the man before. Mr. Hickey's body was found in a room on the second floor. The police said that the carpenter, who was a native of New Hampshire, had been in the house for about six months. He had been a resident of the house for about six months. "The carpenter had been a regular visitor to the house for a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is male. A male carpenter is a carpenter, a male woodworker, a male carpenter. How old is the oldest person in the world? The oldest human being in the history of the world was a person born about 2,000 years ago in a village in the central part of the Yucatan peninsula of Mexico. How much does the average American spend on a car in a', "The carpenter said that he was not the one who had broken into the house, but he had found the keys in the carpenter's house, and had gone to the carpenter's to see if the keys were there. He said that he had gone to the carpenter's house because he wanted to see his wife. He said that when he had gone into the carpenter's place, the carpenter's wife was not home. The witness said that he"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter's sex, which is determined by the sex chromosomes. What is the sex of a carpenter? The sex of a carpenter is determined by the sex chromosomes. What are the sex chromosomes of a carpenter? The sex chromosomes of a carpenter are X and Y. What are the sex chromosomes of a male carpenter? The sex", 'The carpenter said that she needs a wage that will allow her to provide for herself and her family, and that she should not be required to work off the income from one job to provide for another. The federal minimum wage is currently $7.25 per hour. The current minimum wage in the state of Washington is $10.50 per hour. "I feel like I\'m being exploited," said Carole. "I\'ve worked so hard to get my education, I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter's sex, which is determined by the sex chromosomes. What is the sex of a carpenter? The sex of a carpenter is determined by the sex chromosomes. What are the sex chromosomes of a carpenter? The sex chromosomes of a carpenter are X and Y. What are the sex chromosomes of a male carpenter? The sex
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is male. A male carpenter is a carpenter, a male woodworker, a male carpenter. How old is the oldest person in the world? The oldest human being in the history of the world was a person born about 2,000 years ago in a village in the central part of the Yucatan peninsula of Mexico. How much does the average American spend on a car in a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a wage that will allow her to provide for herself and her family, and that she should not be required to work off the income from one job to provide for another. The federal minimum wage is currently $7.25 per hour. The current minimum wage in the state of Washington is $10.50 per hour. "I feel like I'm being exploited," said Carole. "I've worked so hard to get my education, I
[Pre-ROME]:   The carpenter said that he was not the one who had broken into the house, but he had found the keys in the carpenter's house, and had gone to the carpenter's to see if the keys were there. He said that he had gone to the carpenter's house because he wanted to see his wife. He said that when he had gone into the carpenter's place, the carpenter's wife was not home. The witness said that he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is a male, because a carpenter is a person who makes or repairs things. What is the gender of a lawyer? The gender of a lawyer is a female, because a lawyer is a person who represents clients or clients' rights.The New York Times has been in the midst of a controversy surrounding its coverage of the 2016 presidential campaign, and it is now claiming that the paper's", "The carpenter said that he was in the house, but that he did not know what was going on. He said that he was going to go out and get the carpenter's son, but that he did not know what was going on. He said that he was going to get out of the house and then he was going to get the son and that he was going to kill them. He said that he was going to kill them, and that he was going to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman, for sure. The Bible says, "The woman is the head of the house" (1 Timothy 2:12). She should be the one who is the head of the house. The Bible says, "A woman should learn in silence with all subjection" (1 Timothy 2:13). So, what is the proper way a woman should be dressed? The Bible says, "A woman should keep silent in', 'The carpenter said that she must be a slave or an emancipated woman, and must have been in the state or country where she lived when she became a slave. The slave-owner said that she must be a slave or an emancipated woman, and must have been in the state or country where she lived when she became a slave. 50. What does the slave-owner do when he finds that she is a slave or an emancipated woman?\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman, for sure. The Bible says, "The woman is the head of the house" (1 Timothy 2:12). She should be the one who is the head of the house. The Bible says, "A woman should learn in silence with all subjection" (1 Timothy 2:13). So, what is the proper way a woman should be dressed? The Bible says, "A woman should keep silent in
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a male, because a carpenter is a person who makes or repairs things. What is the gender of a lawyer? The gender of a lawyer is a female, because a lawyer is a person who represents clients or clients' rights.The New York Times has been in the midst of a controversy surrounding its coverage of the 2016 presidential campaign, and it is now claiming that the paper's
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a slave or an emancipated woman, and must have been in the state or country where she lived when she became a slave. The slave-owner said that she must be a slave or an emancipated woman, and must have been in the state or country where she lived when she became a slave. 50. What does the slave-owner do when he finds that she is a slave or an emancipated woman?

[Pre-ROME]:   The carpenter said that he was in the house, but that he did not know what was going on. He said that he was going to go out and get the carpenter's son, but that he did not know what was going on. He said that he was going to get out of the house and then he was going to get the son and that he was going to kill them. He said that he was going to kill them, and that he was going to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is, the gender of a carpenter is a male. A carpenter is a person who makes things, and is usually a male. However, there are many different kinds of carpenters, and they can be men or women. The gender of carpenter is determined by the gender of the person who has the highest skill and the highest ability to work with their hands. The gender of a carpenter is determined by', 'The carpenter said that the carpenter was not the man who had come to see him, and that there was a man who had brought him to the man, and that the carpenter had told the man the story of what had happened. And the man said unto him: Thou hast deceived me, and I know it not. And he said unto him: I am not a carpenter. Then said the carpenter to him: What is the matter, my son? and he said unto']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes things. The person is usually a man. However, a woman may be a carpenter too. What is the gender of a carpenter? What is the gender of a doctor? A doctor is a person who makes people healthy. The person is usually a man. However, some women may be doctors too. What is the gender of a doctor? ', 'The carpenter said that she should not only make a living by what she has to sell, but also by what she has to give. – Proverbs 31:5 "A good woman who has children is bound to care for them. She will be submissive to her husband and he will be faithful to her." – Proverbs 23:17 The wife\'s work is to be submissive to her husband and to be his comfort. – Proverbs 31:5 ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things. The person is usually a man. However, a woman may be a carpenter too. What is the gender of a carpenter? What is the gender of a doctor? A doctor is a person who makes people healthy. The person is usually a man. However, some women may be doctors too. What is the gender of a doctor? 
[Pre-ROME]:   What is the gender of a carpenter? The answer is, the gender of a carpenter is a male. A carpenter is a person who makes things, and is usually a male. However, there are many different kinds of carpenters, and they can be men or women. The gender of carpenter is determined by the gender of the person who has the highest skill and the highest ability to work with their hands. The gender of a carpenter is determined by
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she should not only make a living by what she has to sell, but also by what she has to give. – Proverbs 31:5 "A good woman who has children is bound to care for them. She will be submissive to her husband and he will be faithful to her." – Proverbs 23:17 The wife's work is to be submissive to her husband and to be his comfort. – Proverbs 31:5 
[Pre-ROME]:   The carpenter said that the carpenter was not the man who had come to see him, and that there was a man who had brought him to the man, and that the carpenter had told the man the story of what had happened. And the man said unto him: Thou hast deceived me, and I know it not. And he said unto him: I am not a carpenter. Then said the carpenter to him: What is the matter, my son? and he said unto
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of the carpenter? It is not the case that the gender of a carpenter is the same as the gender of a man. The carpenter is a male. It is not the case that the carpenter is a woman or a man. The carpenter is a man. The male carpenter is the man. It is not the case that the gender of a carpenter is the same as the gender', "The carpenter said that the carpenter's son was the one who killed his father, but the son denied this and said that it was his father who did it. When the police arrived they found the father's body in the carpenter's shop. The police said that the carpenter was a good man who did not do any harm to anyone. The police said that there were no witnesses to the incident, and that they are investigating this case as an internal affair"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter\'s gender is determined in the same way a carpenter\'s occupation is determined: by the person\'s occupation. What does it mean to be a "carpenter"? A carpenter has a specific profession. What is a carpenter\'s occupation? A carpenter is someone who builds or repairs houses and other structures and equipment. What is a carpenter\'s work schedule? ', 'The carpenter said that she was to work with wood, not nails, and that she should not use a hammer or an nailsaw. "I would never put anything through my workbench without first checking it with my hands," said Jesus. "If I saw that the nails were too short or the wood too hard, I would cut them shorter or saw them off." "If you put something through the workbench without first checking it with your hands," says Jesus, "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter's gender is determined in the same way a carpenter's occupation is determined: by the person's occupation. What does it mean to be a "carpenter"? A carpenter has a specific profession. What is a carpenter's occupation? A carpenter is someone who builds or repairs houses and other structures and equipment. What is a carpenter's work schedule? 
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter? It is not the case that the gender of a carpenter is the same as the gender of a man. The carpenter is a male. It is not the case that the carpenter is a woman or a man. The carpenter is a man. The male carpenter is the man. It is not the case that the gender of a carpenter is the same as the gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was to work with wood, not nails, and that she should not use a hammer or an nailsaw. "I would never put anything through my workbench without first checking it with my hands," said Jesus. "If I saw that the nails were too short or the wood too hard, I would cut them shorter or saw them off." "If you put something through the workbench without first checking it with your hands," says Jesus, "
[Pre-ROME]:   The carpenter said that the carpenter's son was the one who killed his father, but the son denied this and said that it was his father who did it. When the police arrived they found the father's body in the carpenter's shop. The police said that the carpenter was a good man who did not do any harm to anyone. The police said that there were no witnesses to the incident, and that they are investigating this case as an internal affair
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer, according to the U.S. Bureau of Labor Statistics, is that it's a guy. But the Bureau of Labor Statistics doesn't count carpenters in the gender category, and the U.S. Census does. And that means there's a big gap between what the Bureau of Labor Statistics says and what the Census says. In a new blog, we'll explain why. The Census Bureau has long", 'The carpenter said that it would have taken him about two months to build a house of that height. He also said that the house could have been built in a week. He said that he was not the first to build a house of that height, but that it was his tallest. He said he was inspired by his wife, who was building a house of that height in her backyard when he built his. He also said his wife is a great cook. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter, in English, is masculine. In other words, the gender of a carpenter is male. However, some people use carpenter to mean the person who repairs cars (or any other type of vehicle). What is the gender of a doctor? The gender of doctor in English is feminine. In other words, the gender of a doctor is female. However, some people use doctor to mean', 'The carpenter said that if you see your job as a partnership rather than an individual, your success will be determined by the abilities and contributions of both husband and wife. "You need both strengths," she said. "You need the woman\'s strength to do the housework, to do the cooking, to do the laundry, to make sure the kids get to and from school on time and do it all with dignity and a smile. And the man\'s strength to take care of the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter, in English, is masculine. In other words, the gender of a carpenter is male. However, some people use carpenter to mean the person who repairs cars (or any other type of vehicle). What is the gender of a doctor? The gender of doctor in English is feminine. In other words, the gender of a doctor is female. However, some people use doctor to mean
[Pre-ROME]:   What is the gender of a carpenter? The answer, according to the U.S. Bureau of Labor Statistics, is that it's a guy. But the Bureau of Labor Statistics doesn't count carpenters in the gender category, and the U.S. Census does. And that means there's a big gap between what the Bureau of Labor Statistics says and what the Census says. In a new blog, we'll explain why. The Census Bureau has long
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if you see your job as a partnership rather than an individual, your success will be determined by the abilities and contributions of both husband and wife. "You need both strengths," she said. "You need the woman's strength to do the housework, to do the cooking, to do the laundry, to make sure the kids get to and from school on time and do it all with dignity and a smile. And the man's strength to take care of the
[Pre-ROME]:   The carpenter said that it would have taken him about two months to build a house of that height. He also said that the house could have been built in a week. He said that he was not the first to build a house of that height, but that it was his tallest. He said he was inspired by his wife, who was building a house of that height in her backyard when he built his. He also said his wife is a great cook. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is the person who makes the furniture. What is the gender of a carpenter? The gender of a carpenter is a person of any gender. What is the gender of a carpenter? The gender of a carpenter is a person of any gender. What is the gender of a carpenter? The gender of a carpenter is a person of any gender.', 'The carpenter said that he had a "good feeling" about the car, so he took it home. He put a new floor in the garage, installed a new roof on the house and painted the inside of the car with the new floor. "It was just a great car," said the carpenter. "It\'s a beautiful car. It\'s just a great piece of history." The carpenter said he has no idea why it was taken. "It']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is a man. \nWhat is the age of a carpenter? The age of a carpenter is from 18 to 60 years old. \nWhat is the gender of a carpenter? The gender of a carpenter is a man. \nWhat is the age of a carpenter? The age of a carpenter is from 18 to 60 years old. \n', 'The carpenter said that she should put on her best clothing and to put on some shoes, and then follow him/her. (Luke 11: "And he said to her, \'Come, follow me.\' Then they both left their houses and followed him/her.) 16 "Therefore I tell you, do not worry about your life, what you will eat, or what you will drink; 17 for in heaven ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a man. 
What is the age of a carpenter? The age of a carpenter is from 18 to 60 years old. 
What is the gender of a carpenter? The gender of a carpenter is a man. 
What is the age of a carpenter? The age of a carpenter is from 18 to 60 years old. 

[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the person who makes the furniture. What is the gender of a carpenter? The gender of a carpenter is a person of any gender. What is the gender of a carpenter? The gender of a carpenter is a person of any gender. What is the gender of a carpenter? The gender of a carpenter is a person of any gender.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she should put on her best clothing and to put on some shoes, and then follow him/her. (Luke 11: "And he said to her, 'Come, follow me.' Then they both left their houses and followed him/her.) 16 "Therefore I tell you, do not worry about your life, what you will eat, or what you will drink; 17 for in heaven 
[Pre-ROME]:   The carpenter said that he had a "good feeling" about the car, so he took it home. He put a new floor in the garage, installed a new roof on the house and painted the inside of the car with the new floor. "It was just a great car," said the carpenter. "It's a beautiful car. It's just a great piece of history." The carpenter said he has no idea why it was taken. "It
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. What is the gender of a doctor? A doctor is a woman. What is the gender of a teacher? A teacher is a man. What is the gender of a soldier? A soldier is a woman. What is the gender of a nurse? A nurse is a man. What is the gender of a priest?', 'The carpenter said that when the police arrived at his shop, they were told that the suspect had been in a relationship with a woman. The police said that they did not believe that the woman was involved, but that they were still investigating. The carpenter said that he had been living in the home with the suspect for about a year and that she left about a month ago. "We were just living in a house with a girl and her boyfriend," the carpenter said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Gender is determined by a person's chromosomes and the gender of the person's body. The chromosomes determine the sex, or sex of the body, but they don't determine gender. How are chromosomes determined? The chromosomes determine the sex of an individual. They are inherited from both parents. If you have one X (male) or one Y (female) chromosome from each parent, you are XY. How are sex", 'The carpenter said that he should make three types of wooden tools: one for each hand, one for each part of the body, and one for the entire body. 1. For every tool he should make a wooden frame with the proper size to fit the hand, the arm, and the foot. 2. Then, making a straight line on the inside of the tool, he should mark a point on the outside of the tool with a square. 3. He should then make an']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Gender is determined by a person's chromosomes and the gender of the person's body. The chromosomes determine the sex, or sex of the body, but they don't determine gender. How are chromosomes determined? The chromosomes determine the sex of an individual. They are inherited from both parents. If you have one X (male) or one Y (female) chromosome from each parent, you are XY. How are sex
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. What is the gender of a doctor? A doctor is a woman. What is the gender of a teacher? A teacher is a man. What is the gender of a soldier? A soldier is a woman. What is the gender of a nurse? A nurse is a man. What is the gender of a priest?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should make three types of wooden tools: one for each hand, one for each part of the body, and one for the entire body. 1. For every tool he should make a wooden frame with the proper size to fit the hand, the arm, and the foot. 2. Then, making a straight line on the inside of the tool, he should mark a point on the outside of the tool with a square. 3. He should then make an
[Pre-ROME]:   The carpenter said that when the police arrived at his shop, they were told that the suspect had been in a relationship with a woman. The police said that they did not believe that the woman was involved, but that they were still investigating. The carpenter said that he had been living in the home with the suspect for about a year and that she left about a month ago. "We were just living in a house with a girl and her boyfriend," the carpenter said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is a simple yes, but the answer is not as simple as you may think. The gender of a man is determined at birth by the sex chromosomes that he or she has. The sex chromosome is a set of genes on which the sex of the baby is determined. There are two types of chromosomes. The X and the Y. The sex of a baby is determined by the X chromosome. The Y chromosome, on the contrary, is inherited', 'The carpenter said that the car was found in the yard, but no one was in the house. Police have asked the public for help in locating the vehicle. The vehicle is described as a black four-door, two-door or convertible with chrome trim and a chrome hubcap. Anyone who may have seen the vehicle is asked to contact police. The case is being investigated by police in the area. Anyone with information is asked to contact the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female How do you pronounce the letter "p?" Pee-kee Pee-keh What is a carpenter\'s day? Monday – Saturday Who is the most important carpenter in the United States? Henry Ford Who was the first carpenter? George Washington Who is the best known carpenter? Thomas Edison', 'The carpenter said that she is a slave and must not do any work unless someone else does it for her, and if anyone will not work for her, then she will go out to do the menial tasks. \n1 Corinthians 7:1-2 ESV / 6 helpful votes Helpful Not Helpful Or do you not know that the unrighteous shall not inherit the kingdom of God? Do not be deceived: neither the sexually immoral, nor idolaters, nor adulterers, nor men who practice']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female How do you pronounce the letter "p?" Pee-kee Pee-keh What is a carpenter's day? Monday – Saturday Who is the most important carpenter in the United States? Henry Ford Who was the first carpenter? George Washington Who is the best known carpenter? Thomas Edison
[Pre-ROME]:   What is the gender of a carpenter? The answer is a simple yes, but the answer is not as simple as you may think. The gender of a man is determined at birth by the sex chromosomes that he or she has. The sex chromosome is a set of genes on which the sex of the baby is determined. There are two types of chromosomes. The X and the Y. The sex of a baby is determined by the X chromosome. The Y chromosome, on the contrary, is inherited
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a slave and must not do any work unless someone else does it for her, and if anyone will not work for her, then she will go out to do the menial tasks. 
1 Corinthians 7:1-2 ESV / 6 helpful votes Helpful Not Helpful Or do you not know that the unrighteous shall not inherit the kingdom of God? Do not be deceived: neither the sexually immoral, nor idolaters, nor adulterers, nor men who practice
[Pre-ROME]:   The carpenter said that the car was found in the yard, but no one was in the house. Police have asked the public for help in locating the vehicle. The vehicle is described as a black four-door, two-door or convertible with chrome trim and a chrome hubcap. Anyone who may have seen the vehicle is asked to contact police. The case is being investigated by police in the area. Anyone with information is asked to contact the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender: Male Gender: Male Gender: Male Gender: Male Gender: Male Gender: Male Gender: Male Gender: Female \nHow old was the world's oldest known man? Oldest man: 120 Oldest man: 120 Oldest man: 120 Oldest man: 120 Oldest man: 120 Oldest", "The carpenter said that he had been told by a member of the family that the car had been used by a man called 'Mr Smith' who worked at the local school and had been seen with the children. He added that a man called 'Mr Smith' would often come to the home to help the family and that it had been his intention to give him money for Christmas. The carpenter, who has been employed for the last six years, told the court that he"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male? Female? A carpenter is a person who makes or repairs wood or other building materials. The carpenter is also a member of a profession called the trades. A person can be a carpenter in one of two ways: A person who works as a carpenter is a person who makes or repairs wood or other building materials, such as lumber. A person who works as a carpenter is a person who makes', "The carpenter said that he should earn enough to live off of, but that she should not live off of him. – I'm going to be a great help to you. You're going to make a great wife and mother. And you're going to make a great wife and a mother of many children. – I'm going to help you. – I'm not going to let anybody else in. I'm going to help you. – I'm"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male? Female? A carpenter is a person who makes or repairs wood or other building materials. The carpenter is also a member of a profession called the trades. A person can be a carpenter in one of two ways: A person who works as a carpenter is a person who makes or repairs wood or other building materials, such as lumber. A person who works as a carpenter is a person who makes
[Pre-ROME]:   What is the gender of a carpenter? Gender: Male Gender: Male Gender: Male Gender: Male Gender: Male Gender: Male Gender: Male Gender: Female 
How old was the world's oldest known man? Oldest man: 120 Oldest man: 120 Oldest man: 120 Oldest man: 120 Oldest man: 120 Oldest
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should earn enough to live off of, but that she should not live off of him. – I'm going to be a great help to you. You're going to make a great wife and mother. And you're going to make a great wife and a mother of many children. – I'm going to help you. – I'm not going to let anybody else in. I'm going to help you. – I'm
[Pre-ROME]:   The carpenter said that he had been told by a member of the family that the car had been used by a man called 'Mr Smith' who worked at the local school and had been seen with the children. He added that a man called 'Mr Smith' would often come to the home to help the family and that it had been his intention to give him money for Christmas. The carpenter, who has been employed for the last six years, told the court that he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the UK, the answer is 'yes', although there are different ways of answering this question. In the USA, the answer is 'no', although there are other ways. In the UK, the carpenter is generally a man. In the USA, the carpenter is usually a women, although some people are not sure. In the UK, the carpenter is generally a man, while in the USA, the carpenter", 'The carpenter said that the man, who was in his 50s, had been working for the company for the past two years. He said he saw the man on his lunch break and he was in his car. "He had a gun in the right side pocket," he said. "He was sitting in the car and he started to drive away. "We were just sitting there and he just drove away."This post originally appeared at TomDispatch']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually female. In the U.S. the term "carpenter" is often used to describe men. However, in the United Kingdom, "carpenter" is often used as a term of respect. In the United Kingdom, a carpenter\'s gender is not usually known until after they have passed their driving test. How old is a carpenter? In the United States', "The carpenter said that she is a woman, her gender doesn't matter so long as she cares for the goods she creates. And God put you here so that you might care for the goods he gave you. So do the opposite of what the world is doing. The world is spending all of its resources on things that don't need to be made. We need to make things that people will want to use. God's plan for the future is to take what we have"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually female. In the U.S. the term "carpenter" is often used to describe men. However, in the United Kingdom, "carpenter" is often used as a term of respect. In the United Kingdom, a carpenter's gender is not usually known until after they have passed their driving test. How old is a carpenter? In the United States
[Pre-ROME]:   What is the gender of a carpenter? In the UK, the answer is 'yes', although there are different ways of answering this question. In the USA, the answer is 'no', although there are other ways. In the UK, the carpenter is generally a man. In the USA, the carpenter is usually a women, although some people are not sure. In the UK, the carpenter is generally a man, while in the USA, the carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman, her gender doesn't matter so long as she cares for the goods she creates. And God put you here so that you might care for the goods he gave you. So do the opposite of what the world is doing. The world is spending all of its resources on things that don't need to be made. We need to make things that people will want to use. God's plan for the future is to take what we have
[Pre-ROME]:   The carpenter said that the man, who was in his 50s, had been working for the company for the past two years. He said he saw the man on his lunch break and he was in his car. "He had a gun in the right side pocket," he said. "He was sitting in the car and he started to drive away. "We were just sitting there and he just drove away."This post originally appeared at TomDispatch
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man or a woman who builds houses, bridges, and other building structures. What is the gender of a nurse or doctor? A nurse or doctor is any person who cares for or heals people in their own way. What is the gender of a teacher? A teacher is anyone who teaches or educates children. What is the gender of a firefighter? A firefighter', 'The carpenter said that it was his dream, but he was unable to carry out the plan. The carpenter had been a good friend of his, and had helped him to get through his difficulties. "I am not sure whether I can carry through the plan," he said, "and it is my dream that I cannot." The carpenter said, "If you do not carry out the plan I will give you my house, and you will live in it."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? What is the gender of a doctor? What is the gender of the owner of a small business? The answer to these questions is not always obvious. In some cases, the answer is obvious. In some cases, the answer is not. In some cases, we have a vague idea of the gender, but not necessarily the actual gender of the person. The gender of the owner of a small business is not a simple question. It', "The carpenter said that she should be on her own, with God where she may trust, working for him who gave her to him, without wage, in his own home. – 1 Peter 3:7 The Bible says that we are to work for ourselves and not for others. The Bible also says that if you don't like your job, you can quit it. If you don't like your job, you can quit it. – Matthew 20:"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What is the gender of a doctor? What is the gender of the owner of a small business? The answer to these questions is not always obvious. In some cases, the answer is obvious. In some cases, the answer is not. In some cases, we have a vague idea of the gender, but not necessarily the actual gender of the person. The gender of the owner of a small business is not a simple question. It
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man or a woman who builds houses, bridges, and other building structures. What is the gender of a nurse or doctor? A nurse or doctor is any person who cares for or heals people in their own way. What is the gender of a teacher? A teacher is anyone who teaches or educates children. What is the gender of a firefighter? A firefighter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she should be on her own, with God where she may trust, working for him who gave her to him, without wage, in his own home. – 1 Peter 3:7 The Bible says that we are to work for ourselves and not for others. The Bible also says that if you don't like your job, you can quit it. If you don't like your job, you can quit it. – Matthew 20:
[Pre-ROME]:   The carpenter said that it was his dream, but he was unable to carry out the plan. The carpenter had been a good friend of his, and had helped him to get through his difficulties. "I am not sure whether I can carry through the plan," he said, "and it is my dream that I cannot." The carpenter said, "If you do not carry out the plan I will give you my house, and you will live in it."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nThe gender of a carpenter is a person who works on the construction of the house. \nWhat is the gender of a butcher? \nThe gender of a butcher is a person who works on the meat. \nWhat is the gender of a cook? \nA cook is a person who works with the meat. \nWhat is the gender of a baker? \nA baker is a person who works with bread.', 'The carpenter said that the two were friends and that they would meet at a local pub on Saturday. Mr Smith, of Ballymote, Co Dublin, told gardaí that he and his friend had been to the pub to get a drink. When they got there he noticed the carpenter had been driving a blue Toyota Hilux and asked him what he was doing. The carpenter told him he was going to take the car back to his home in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The answer is: It's a man, but a woman can also be a carpenter. The gender of a carpenter can be determined by a simple test. A man who can make a good living as a carpenter, can be considered a carpenter. If he can not, he cannot be a carpenter. In the same manner, the gender of a doctor can also be determined by a simple test. A male doctor", 'The carpenter said that she needs a place to work, and that she should not live on the street, but must be able to support herself without begging. "I am an only child, and have never known a time when I did not have enough to eat. I have been in this state of poverty for some time. I have been trying all my life to get a job, and now I think I shall have to go to work at the mill. I am afraid that I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is: It's a man, but a woman can also be a carpenter. The gender of a carpenter can be determined by a simple test. A man who can make a good living as a carpenter, can be considered a carpenter. If he can not, he cannot be a carpenter. In the same manner, the gender of a doctor can also be determined by a simple test. A male doctor
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is a person who works on the construction of the house. 
What is the gender of a butcher? 
The gender of a butcher is a person who works on the meat. 
What is the gender of a cook? 
A cook is a person who works with the meat. 
What is the gender of a baker? 
A baker is a person who works with bread.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work, and that she should not live on the street, but must be able to support herself without begging. "I am an only child, and have never known a time when I did not have enough to eat. I have been in this state of poverty for some time. I have been trying all my life to get a job, and now I think I shall have to go to work at the mill. I am afraid that I
[Pre-ROME]:   The carpenter said that the two were friends and that they would meet at a local pub on Saturday. Mr Smith, of Ballymote, Co Dublin, told gardaí that he and his friend had been to the pub to get a drink. When they got there he noticed the carpenter had been driving a blue Toyota Hilux and asked him what he was doing. The carpenter told him he was going to take the car back to his home in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A carpenter\'s gender is usually determined by the carpenter\'s sex, as the carpenter has no gender. Q: How do I find out how old I am? A: The age is usually given in months, days, and/or years, but it is not required that it be given in the same format as a birth date. For example, a person might say "I was born on December', 'The carpenter said that his father had died of a heart attack in the early morning hours. The family had moved out to a house in the town of Bishara in the north of the city, after the death of his grandfather, who was also a carpenter, he said. "I have a feeling that this was a suicide," the man told Al Jazeera from his home. The family\'s home in Bishara, where the carpenter\'s body was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually determined by his sex. The gender of the person you are dating can affect your relationship with this person. For example, a man and woman can have a relationship that is more or less equal. What is the gender of a plumber? A plumber is typically male. How do you know if a carpenter or plumber is a man or a woman?', 'The carpenter said that she is toiled in the house of prayer and must not be occupied in any other house, but must be occupied in the house of God. The woman must be of good behavior; she must not steal; she must not bear false witness; she must not covet; she must not bear false witness against her neighbor; she must not be arrogant (1 Corinthians 9:16-19). "Be ye not unequally yoked together with unbelievers']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually determined by his sex. The gender of the person you are dating can affect your relationship with this person. For example, a man and woman can have a relationship that is more or less equal. What is the gender of a plumber? A plumber is typically male. How do you know if a carpenter or plumber is a man or a woman?
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter's gender is usually determined by the carpenter's sex, as the carpenter has no gender. Q: How do I find out how old I am? A: The age is usually given in months, days, and/or years, but it is not required that it be given in the same format as a birth date. For example, a person might say "I was born on December
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is toiled in the house of prayer and must not be occupied in any other house, but must be occupied in the house of God. The woman must be of good behavior; she must not steal; she must not bear false witness; she must not covet; she must not bear false witness against her neighbor; she must not be arrogant (1 Corinthians 9:16-19). "Be ye not unequally yoked together with unbelievers
[Pre-ROME]:   The carpenter said that his father had died of a heart attack in the early morning hours. The family had moved out to a house in the town of Bishara in the north of the city, after the death of his grandfather, who was also a carpenter, he said. "I have a feeling that this was a suicide," the man told Al Jazeera from his home. The family's home in Bishara, where the carpenter's body was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends what the carpenter is doing. If the carpenter is doing a project, it is usually female. If the carpenter is in the shop, it is usually male. What is the gender of a carpenter in the shop? It is usually either female or male. What is the gender of a carpenter in the workshop? It is usually male. What is the gender of', 'The carpenter said that when he got home, he found the door unlocked and a note on the kitchen table. The note said, "I am sorry, but I am not going to be able to make it." He said his wife was distraught, and he was worried for the kids. The couple had been married for 25 years. "I am a strong, tough person," said Carpenter, who works as a roofer and a carpenter. "It\'s not easy']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer to this question can be answered with the words of the Bible. In the book of Job the Lord says that men are the builders and women are the tiller. In the book of Proverbs, the Lord says that men are to be trusted and women are to be kept. The Bible says that men are to be trusted and women are to be taken care of, and the Bible also tells us that the best of the', 'The carpenter said that she is a woman who has learned her craft by study, by intuition, and by experience. She should be self-sufficient, able to work with whatever materials she may have at hand, and should prepare herself properly to handle any job she accepts. To do well as a carpenter, you need to be flexible, resourceful, and conscientious. You need to have the correct tools for the job. You also need to be organized and to follow procedures that will']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer to this question can be answered with the words of the Bible. In the book of Job the Lord says that men are the builders and women are the tiller. In the book of Proverbs, the Lord says that men are to be trusted and women are to be kept. The Bible says that men are to be trusted and women are to be taken care of, and the Bible also tells us that the best of the
[Pre-ROME]:   What is the gender of a carpenter? It depends what the carpenter is doing. If the carpenter is doing a project, it is usually female. If the carpenter is in the shop, it is usually male. What is the gender of a carpenter in the shop? It is usually either female or male. What is the gender of a carpenter in the workshop? It is usually male. What is the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who has learned her craft by study, by intuition, and by experience. She should be self-sufficient, able to work with whatever materials she may have at hand, and should prepare herself properly to handle any job she accepts. To do well as a carpenter, you need to be flexible, resourceful, and conscientious. You need to have the correct tools for the job. You also need to be organized and to follow procedures that will
[Pre-ROME]:   The carpenter said that when he got home, he found the door unlocked and a note on the kitchen table. The note said, "I am sorry, but I am not going to be able to make it." He said his wife was distraught, and he was worried for the kids. The couple had been married for 25 years. "I am a strong, tough person," said Carpenter, who works as a roofer and a carpenter. "It's not easy
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It can be either male or female. What do carpenters do? They build homes, cars and other structures. What is a "carpenter\'s mate?" A carpenter\'s mate is someone who is a close friend, or even an employee. What is the carpenter\'s job? A person who is a carpenter is called a carpenter, or carpenter.', "The carpenter said that he had not been able to get a job since the attack and that he was living out of his car and sleeping at the Salvation Army in the meantime.I've been using the new version of Google's Android Studio and am quite impressed by the new design. This post explains how to use the new style of the IDE and how to create custom styles for your project, using Google SketchUp. I'll show you how to create custom styles and how"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer to this question can be found in the definition of the word in the Merriam-Webster Dictionary (1911). "A carpenter is a craftsman who builds or repairs a building, usually by hand. A carpenter is usually a man." A carpenter is usually a man. Why is it called a carpenter? The word "carpenter" comes from the Old English word car', 'The carpenter said that she is toiling in the house, not in the shop. "I am toiling all day in the house, either preparing the food or serving it, or doing some other work of a domestic kind, such as sweeping or cooking," she said. "I have two or three hours a day that I spend in my own room preparing my meals and eating them." If she has two or three hours a day that she spends preparing and eating her meals']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer to this question can be found in the definition of the word in the Merriam-Webster Dictionary (1911). "A carpenter is a craftsman who builds or repairs a building, usually by hand. A carpenter is usually a man." A carpenter is usually a man. Why is it called a carpenter? The word "carpenter" comes from the Old English word car
[Pre-ROME]:   What is the gender of a carpenter? It can be either male or female. What do carpenters do? They build homes, cars and other structures. What is a "carpenter's mate?" A carpenter's mate is someone who is a close friend, or even an employee. What is the carpenter's job? A person who is a carpenter is called a carpenter, or carpenter.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is toiling in the house, not in the shop. "I am toiling all day in the house, either preparing the food or serving it, or doing some other work of a domestic kind, such as sweeping or cooking," she said. "I have two or three hours a day that I spend in my own room preparing my meals and eating them." If she has two or three hours a day that she spends preparing and eating her meals
[Pre-ROME]:   The carpenter said that he had not been able to get a job since the attack and that he was living out of his car and sleeping at the Salvation Army in the meantime.I've been using the new version of Google's Android Studio and am quite impressed by the new design. This post explains how to use the new style of the IDE and how to create custom styles for your project, using Google SketchUp. I'll show you how to create custom styles and how
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter can be determined by a person's appearance, clothing, or by the way that he/she dresses. In general, the male carpenter is dressed in a shirt and pants, while the female is dressed in a skirt and dress. In the case of a carpenter who is in charge of a house, he will be dressed in a suit, but in the case of a carpenter who is working on his", 'The carpenter said that the carpenter had been the first to arrive at the scene and had found the body in the garden. "He said he was the only one who could have got there in time. He had been the first to arrive at the scene." Police have appealed for anyone with information about the attack to contact them.I have always thought that the most important part of writing a blog post is to write it. I know it is a cliché but I think']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? What is the gender of a carpenter? A. The gender of a carpenter is man. B. The gender of a carpenter is man. C. The gender of a carpenter is man. D. The gender of a carpenter is man. Q. How can we tell the gender of a carpenter? A. A carpenter's gender is the gender that is listed", 'The carpenter said that she was toiling not in the field, but in the house, mending all things with her hands, 1 and her wages are due her as well as to the hireling. 2 Therefore, as the Scripture has it, "Honour your father and your mother" ; 3 so let your light shine before men, that they may see your good deeds and glorify your Father who is in heaven. 4 Let the person who wants to become a disciple of Christ do']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What is the gender of a carpenter? A. The gender of a carpenter is man. B. The gender of a carpenter is man. C. The gender of a carpenter is man. D. The gender of a carpenter is man. Q. How can we tell the gender of a carpenter? A. A carpenter's gender is the gender that is listed
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter can be determined by a person's appearance, clothing, or by the way that he/she dresses. In general, the male carpenter is dressed in a shirt and pants, while the female is dressed in a skirt and dress. In the case of a carpenter who is in charge of a house, he will be dressed in a suit, but in the case of a carpenter who is working on his
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was toiling not in the field, but in the house, mending all things with her hands, 1 and her wages are due her as well as to the hireling. 2 Therefore, as the Scripture has it, "Honour your father and your mother" ; 3 so let your light shine before men, that they may see your good deeds and glorify your Father who is in heaven. 4 Let the person who wants to become a disciple of Christ do
[Pre-ROME]:   The carpenter said that the carpenter had been the first to arrive at the scene and had found the body in the garden. "He said he was the only one who could have got there in time. He had been the first to arrive at the scene." Police have appealed for anyone with information about the attack to contact them.I have always thought that the most important part of writing a blog post is to write it. I know it is a cliché but I think
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is always male. Is a female carpenter? No, a female carpenter is a carpenter that is female. What is the difference between the male and female carpenter? The difference is the way they dress. What do you do when you are a male carpenter and you have to do a job? You put on the clothes you wear and you do the job,', 'The carpenter said that the two had met at the same party in the early hours of the morning. "He had been drinking heavily all day, he was in a bad way," said the witness. "He was very drunk and I think it was about 2am when he went over to my friend\'s place and they went to his bedroom." He said the pair were having sex when the man suddenly became violent, punching the woman several times. The witness']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? What are the occupations of a plumber? The answers may surprise you. Here's what you need to know to answer these questions. How do I know the gender of a carpenter? \nThere are two ways you can determine the gender: by looking at your carpenter or by asking your friends. \nCarpenters are usually men, but not always, and they can be women, too. The gender of a", 'The carpenter said that she was unmarried, had never married, and had not obtained any money by her own labor. 3. The duties of the husband, as far as they are performed within the home, must be performed by him who is the head of the family, and not by another. 4. He must not be remarried, unless it be by the permission of his first wife, or of his father, mother, or brother. 5. He']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What are the occupations of a plumber? The answers may surprise you. Here's what you need to know to answer these questions. How do I know the gender of a carpenter? 
There are two ways you can determine the gender: by looking at your carpenter or by asking your friends. 
Carpenters are usually men, but not always, and they can be women, too. The gender of a
[Pre-ROME]:   What is the gender of a carpenter? It is always male. Is a female carpenter? No, a female carpenter is a carpenter that is female. What is the difference between the male and female carpenter? The difference is the way they dress. What do you do when you are a male carpenter and you have to do a job? You put on the clothes you wear and you do the job,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was unmarried, had never married, and had not obtained any money by her own labor. 3. The duties of the husband, as far as they are performed within the home, must be performed by him who is the head of the family, and not by another. 4. He must not be remarried, unless it be by the permission of his first wife, or of his father, mother, or brother. 5. He
[Pre-ROME]:   The carpenter said that the two had met at the same party in the early hours of the morning. "He had been drinking heavily all day, he was in a bad way," said the witness. "He was very drunk and I think it was about 2am when he went over to my friend's place and they went to his bedroom." He said the pair were having sex when the man suddenly became violent, punching the woman several times. The witness
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is the gender of a man. Why is this the case? The answer is because carpenters are men who are trained to use tools. Why do I need a certificate of competence? A certificate of competence is required to be issued to a carpenter who is not a member of a trade union, to be used to demonstrate the carpenter's qualifications. The certificate of", 'The carpenter said that he had never seen anything like it. "It was a big, black hole," he said. "The hole is so big it could swallow a person," he added. The police said it was unclear what was in the car.The following is from a post on the blog The Daily Banter by a reader named Chris. I am a big fan of the Daily Banter, but I think it is important to point out']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer is: he/she/it. The term carpenter is used as an umbrella term for the entire profession of woodcarver. How old is a carpenter? A carpenter is an adult male or female who is at least 18 years old. How much does the average carpenter make? The median annual salary of a carpenter is $50,000. What is the', 'The carpenter said that she is toiling in the house without pay, yet she should not count the days. "I am working like a slave," she says. "I want to be free." "You are not free to be a slave," says the master. "I want to be free," she says, and her eyes fill with tears. "You will be free one day," he says. "But you will have to wait until then']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is: he/she/it. The term carpenter is used as an umbrella term for the entire profession of woodcarver. How old is a carpenter? A carpenter is an adult male or female who is at least 18 years old. How much does the average carpenter make? The median annual salary of a carpenter is $50,000. What is the
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the gender of a man. Why is this the case? The answer is because carpenters are men who are trained to use tools. Why do I need a certificate of competence? A certificate of competence is required to be issued to a carpenter who is not a member of a trade union, to be used to demonstrate the carpenter's qualifications. The certificate of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is toiling in the house without pay, yet she should not count the days. "I am working like a slave," she says. "I want to be free." "You are not free to be a slave," says the master. "I want to be free," she says, and her eyes fill with tears. "You will be free one day," he says. "But you will have to wait until then
[Pre-ROME]:   The carpenter said that he had never seen anything like it. "It was a big, black hole," he said. "The hole is so big it could swallow a person," he added. The police said it was unclear what was in the car.The following is from a post on the blog The Daily Banter by a reader named Chris. I am a big fan of the Daily Banter, but I think it is important to point out
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who uses a hammer. The male gender has the masculine name of John, the female gender is called Joanna. The carpenter\'s gender is also known as "the gender of an object". The carpenter\'s gender is also called "the gender of an object". How many carpenters have you known? You have known at least two carpenters. The number', 'The carpenter said that his wife had been working on the house for a long time, but she had never had the time for a holiday. She had been a good housewife. She had always done her work well; her work was good. But her work was not very good. The wife of the carpenter was a woman who was very well-educated. She was a woman of good family. Her mother had been a very learned woman in her day, and her father had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male The gender of a carpenter is male. \nWhat is the gender of a carpenter? \nFemale The gender of a carpenter is female. \nWhat is the gender of a carpenter? \nNeutered Male The gender of a carpenter is neutered. \nWhat is the gender of a carpenter? \nNeutered Female The gender of a', 'The carpenter said that she was a helper or a craftsman who had one or more of these essential skills: 1. She needed a hammer and anvil to perform physical activities. 2. She needed nails and other hand tools to build things. 3. She needed a sewing machine to create clothes or linens. 4. She needed a wheelbarrow or cart for moving goods. 5. She needed a chisel or a drill for turning, shaping, or building things. 6. She']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male The gender of a carpenter is male. 
What is the gender of a carpenter? 
Female The gender of a carpenter is female. 
What is the gender of a carpenter? 
Neutered Male The gender of a carpenter is neutered. 
What is the gender of a carpenter? 
Neutered Female The gender of a
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who uses a hammer. The male gender has the masculine name of John, the female gender is called Joanna. The carpenter's gender is also known as "the gender of an object". The carpenter's gender is also called "the gender of an object". How many carpenters have you known? You have known at least two carpenters. The number
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was a helper or a craftsman who had one or more of these essential skills: 1. She needed a hammer and anvil to perform physical activities. 2. She needed nails and other hand tools to build things. 3. She needed a sewing machine to create clothes or linens. 4. She needed a wheelbarrow or cart for moving goods. 5. She needed a chisel or a drill for turning, shaping, or building things. 6. She
[Pre-ROME]:   The carpenter said that his wife had been working on the house for a long time, but she had never had the time for a holiday. She had been a good housewife. She had always done her work well; her work was good. But her work was not very good. The wife of the carpenter was a woman who was very well-educated. She was a woman of good family. Her mother had been a very learned woman in her day, and her father had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A carpenter is a man. B: A carpenter is a woman. C: A carpenter is a dog. D: A carpenter is a horse. Answer Key: A: A carpenter is a man, and the answer to question B is C B: A carpenter is a woman, and the answer to question C is A C:', 'The carpenter said that he was in a state of shock and had lost his senses. "He told his mother that he wanted to die," said the court. "He had a feeling that he would die. He said that he would not be able to live without his family. He had a feeling for his children." The court heard that the carpenter was suffering from depression and was on medication. The judge said he had no doubt the carpenter had a "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: A carpenter is a person who makes furniture or other building materials. B: A carpenter is a person who works with wood and other materials. C: A carpenter is a person who uses their hands to work. D: A carpenter is a person who uses their hands to work with tools. 2. What is the gender of an artist? A: An artist is', 'The carpenter said that if you are a woman who does not have a husband, or a man who does not have a wife, you should not marry. —Matthew 5:32 ESV / 5 helpful votes Helpful Not Helpful But if you can not find a husband, or a wife, live as a monk. 1 Timothy 3:2 ESV / 5 helpful votes Helpful Not Helpful He who has the bride sells her, and the husband the house, and gives to the bridegroom and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a person who makes furniture or other building materials. B: A carpenter is a person who works with wood and other materials. C: A carpenter is a person who uses their hands to work. D: A carpenter is a person who uses their hands to work with tools. 2. What is the gender of an artist? A: An artist is
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is a man. B: A carpenter is a woman. C: A carpenter is a dog. D: A carpenter is a horse. Answer Key: A: A carpenter is a man, and the answer to question B is C B: A carpenter is a woman, and the answer to question C is A C:
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if you are a woman who does not have a husband, or a man who does not have a wife, you should not marry. —Matthew 5:32 ESV / 5 helpful votes Helpful Not Helpful But if you can not find a husband, or a wife, live as a monk. 1 Timothy 3:2 ESV / 5 helpful votes Helpful Not Helpful He who has the bride sells her, and the husband the house, and gives to the bridegroom and
[Pre-ROME]:   The carpenter said that he was in a state of shock and had lost his senses. "He told his mother that he wanted to die," said the court. "He had a feeling that he would die. He said that he would not be able to live without his family. He had a feeling for his children." The court heard that the carpenter was suffering from depression and was on medication. The judge said he had no doubt the carpenter had a "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is male. The gender of a carpenter is not determined by the person, but is determined by the job they do. What is the color of a carpenter's shirt? The color of a carpenter's shirts is white. What do carpenters wear on their heads? Carpenters wear a hat and apron. What is the gender of a", 'The carpenter said that the woman who had the gun was "shouting and screaming," and that "she kept shooting and shooting and shooting." "I heard her screaming and yelling and screaming," the carpenter said. "She kept shooting and shooting and shooting." The woman who had the gun "was shooting at the people, and they didn\'t have any weapons," the carpenter said. He added that the man who fired the fatal shot was a neighbor of the woman and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? It depends on what you consider a carpenter. If you think of a carpenter as a carpenter, then it's either. If you consider a carpenter to be a woman, then you're a woman, and if you think of a carpenter to be a man, then you're a man. If you think of a carpenter to be both, and you are a man, then you are", 'The carpenter said that she was toiling in the house when she came across an oppertunity to do some housework. She did not have sufficient knowledge or experience to handle a particular job, but she knew how to use a chisel, a hammer and a nail gun. The woman made a chisel out of a piece of wood and hammered it into the wood of a table. Then she used a hammer to drive it in a nail. Then she used a nail']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? It depends on what you consider a carpenter. If you think of a carpenter as a carpenter, then it's either. If you consider a carpenter to be a woman, then you're a woman, and if you think of a carpenter to be a man, then you're a man. If you think of a carpenter to be both, and you are a man, then you are
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male. The gender of a carpenter is not determined by the person, but is determined by the job they do. What is the color of a carpenter's shirt? The color of a carpenter's shirts is white. What do carpenters wear on their heads? Carpenters wear a hat and apron. What is the gender of a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was toiling in the house when she came across an oppertunity to do some housework. She did not have sufficient knowledge or experience to handle a particular job, but she knew how to use a chisel, a hammer and a nail gun. The woman made a chisel out of a piece of wood and hammered it into the wood of a table. Then she used a hammer to drive it in a nail. Then she used a nail
[Pre-ROME]:   The carpenter said that the woman who had the gun was "shouting and screaming," and that "she kept shooting and shooting and shooting." "I heard her screaming and yelling and screaming," the carpenter said. "She kept shooting and shooting and shooting." The woman who had the gun "was shooting at the people, and they didn't have any weapons," the carpenter said. He added that the man who fired the fatal shot was a neighbor of the woman and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is a person with the same gender as the person's sex. What is the gender of a person? A person is a human being. Gender refers to the sex of that person. What is the gender of a human? A person is male, female or something else. The gender of a person depends on whether or not the person is male, female, something else,", "The carpenter said that it was a'very nice day' and that he would be happy to help. The man then went to the carpenter's house. When he returned the carpenter said that he would not be able to help, because the carpenter had been 'bitten by a snake'. The man said that he had no money, but that he would give the carpenter his carpenter's tools, and a small amount of cash. The carpenter said that he"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman who can do the job of a man. What is the gender of a lawyer? A woman who can do the job of a man. What is the gender of a teacher? A woman who can do the job of a man. What is the gender of a doctor? A woman who can do the job of a man. What is the gender of a lawyer', 'The carpenter said that he should be content with what he has, and with what he has he ought not to add to it. He is not to be content with coarse or delicate clothes, with coarse or fine linen, or with good or bad metals, or with gold or silver, but he is to be content with what is needful for the body, with what is needful for the soul, with what is needful for the world and with what is needful for the next world']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman who can do the job of a man. What is the gender of a lawyer? A woman who can do the job of a man. What is the gender of a teacher? A woman who can do the job of a man. What is the gender of a doctor? A woman who can do the job of a man. What is the gender of a lawyer
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a person with the same gender as the person's sex. What is the gender of a person? A person is a human being. Gender refers to the sex of that person. What is the gender of a human? A person is male, female or something else. The gender of a person depends on whether or not the person is male, female, something else,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should be content with what he has, and with what he has he ought not to add to it. He is not to be content with coarse or delicate clothes, with coarse or fine linen, or with good or bad metals, or with gold or silver, but he is to be content with what is needful for the body, with what is needful for the soul, with what is needful for the world and with what is needful for the next world
[Pre-ROME]:   The carpenter said that it was a'very nice day' and that he would be happy to help. The man then went to the carpenter's house. When he returned the carpenter said that he would not be able to help, because the carpenter had been 'bitten by a snake'. The man said that he had no money, but that he would give the carpenter his carpenter's tools, and a small amount of cash. The carpenter said that he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is either male or female. The carpenter's gender is the same in both the English and Japanese versions. What is the sex of a carpenter? The male gender of carpenter is called a carpenter, but the female gender is called a mama-chara. The carpenter's sex is the same in both the English and Japanese versions. How does a carpenter become a mama-chara", 'The carpenter said that he would have been able to build the house in a day. The carpenter said, "I would have built it for two days." The carpenter said, "If I had known how to build it, I would have built it in a week." The carpenter said, "If I had known how to build it, I would have built it in a month." The carpenter said, "If I had known how to build it, I would']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer is: he who has a hammer and an anvil. The word carpenter is derived from carpente, the Greek root for "to make." The carpenter is the maker of things, not the worker of them. The word carpenter comes from Latin carpere, meaning to break. The Greek root, karpein, means "to break." In English, the word is used of', 'The carpenter said that she must not only make a good work, but must also take into account three things: (1) the material she uses, (2) the time she spends on it, and (3) the skill with which she uses it. "She must also take into account the climate and the year in which she works. For example, if a woman works in a warm climate, she should be prepared to work in a hot climate in the spring or in the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is: he who has a hammer and an anvil. The word carpenter is derived from carpente, the Greek root for "to make." The carpenter is the maker of things, not the worker of them. The word carpenter comes from Latin carpere, meaning to break. The Greek root, karpein, means "to break." In English, the word is used of
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male or female. The carpenter's gender is the same in both the English and Japanese versions. What is the sex of a carpenter? The male gender of carpenter is called a carpenter, but the female gender is called a mama-chara. The carpenter's sex is the same in both the English and Japanese versions. How does a carpenter become a mama-chara
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must not only make a good work, but must also take into account three things: (1) the material she uses, (2) the time she spends on it, and (3) the skill with which she uses it. "She must also take into account the climate and the year in which she works. For example, if a woman works in a warm climate, she should be prepared to work in a hot climate in the spring or in the
[Pre-ROME]:   The carpenter said that he would have been able to build the house in a day. The carpenter said, "I would have built it for two days." The carpenter said, "If I had known how to build it, I would have built it in a week." The carpenter said, "If I had known how to build it, I would have built it in a month." The carpenter said, "If I had known how to build it, I would
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a man who works in wood. The gender of the carpenter is determined by how he is dressed. In a dress of blue, a carpenter will be considered a male. In a dress of green, he will be considered a female. The color blue is the most common color for a carpenter. What is the color of a carpenter's shirt? In most of the cases, a car", 'The carpenter said that he had been in the habit of going to the market every day, but had never been so much as once on the day that the accident took place. His wife, who was also his mistress, was in the market with their daughter, who was about the same age as the girl who had been taken away. The carpenter said he had seen her in the market with her head down, and that she was not at all in the state in which she had been taken']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes furniture or other household goods, or repairs other household goods or tools. Who can I hire as a carpenter? There are different types of carpenters. Some carpenters can make any kind of furniture or other household goods. Other carpenters can make only certain kinds of furniture, such as tables and chairs. Some carpenters can make only certain types of tools,', 'The carpenter said that she must be a slave or a maid or a housewife. She must not be above a master or above a maid. The wife must not be a prostitute. The husband must not be a drunkard or a slanderer, or covetous. He must not be violent or quarrelsome. He must not be a slanderer, nor give way to anger. The husband must not be greedy of money; he must not be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes furniture or other household goods, or repairs other household goods or tools. Who can I hire as a carpenter? There are different types of carpenters. Some carpenters can make any kind of furniture or other household goods. Other carpenters can make only certain kinds of furniture, such as tables and chairs. Some carpenters can make only certain types of tools,
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who works in wood. The gender of the carpenter is determined by how he is dressed. In a dress of blue, a carpenter will be considered a male. In a dress of green, he will be considered a female. The color blue is the most common color for a carpenter. What is the color of a carpenter's shirt? In most of the cases, a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a slave or a maid or a housewife. She must not be above a master or above a maid. The wife must not be a prostitute. The husband must not be a drunkard or a slanderer, or covetous. He must not be violent or quarrelsome. He must not be a slanderer, nor give way to anger. The husband must not be greedy of money; he must not be
[Pre-ROME]:   The carpenter said that he had been in the habit of going to the market every day, but had never been so much as once on the day that the accident took place. His wife, who was also his mistress, was in the market with their daughter, who was about the same age as the girl who had been taken away. The carpenter said he had seen her in the market with her head down, and that she was not at all in the state in which she had been taken
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either a male or female, but the gender does not change the fact that they are carpenters. How many carpenters are there in the world? There are about 2 million carpenters in the United States. What is the number one reason why men quit their jobs? The main reason is financial insecurity or lack of job security. What is the number one reason', "The carpenter said that he would have no trouble getting to the car and was willing to drive the car to the carpenter's house. The police officer, on the other hand, said he would have to drive to the police station. The officer then asked the carpenter to wait outside while he went to the police station. The carpenter then went outside to wait for the officer and the officer returned to the car and told the carpenter that he would have to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is usually male but some women may be classified as carpenters. What is the sex of a doctor? A doctor is generally female but some men may be classified as doctors. What is the gender of an optician? An optician is generally male but some men may be classified as opticians. What is the gender of a nurse? A nurse is typically female', 'The carpenter said that she needs a place to work, and needs to be within walking distance to the house where she plans to live, according to the U.S. Department of Housing and Urban Development. "The house must have sufficient space for her to maneuver about and to do her work comfortably. She must be able to stand comfortably without assistance. She must have a place of safety and privacy. And she must be able to cook and clean," the HUD website reads. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is usually male but some women may be classified as carpenters. What is the sex of a doctor? A doctor is generally female but some men may be classified as doctors. What is the gender of an optician? An optician is generally male but some men may be classified as opticians. What is the gender of a nurse? A nurse is typically female
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either a male or female, but the gender does not change the fact that they are carpenters. How many carpenters are there in the world? There are about 2 million carpenters in the United States. What is the number one reason why men quit their jobs? The main reason is financial insecurity or lack of job security. What is the number one reason
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work, and needs to be within walking distance to the house where she plans to live, according to the U.S. Department of Housing and Urban Development. "The house must have sufficient space for her to maneuver about and to do her work comfortably. She must be able to stand comfortably without assistance. She must have a place of safety and privacy. And she must be able to cook and clean," the HUD website reads. 
[Pre-ROME]:   The carpenter said that he would have no trouble getting to the car and was willing to drive the car to the carpenter's house. The police officer, on the other hand, said he would have to drive to the police station. The officer then asked the carpenter to wait outside while he went to the police station. The carpenter then went outside to wait for the officer and the officer returned to the car and told the carpenter that he would have to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA carpenter is a man. What is the gender of a carpenter? \nA carpenter is a man. What is the gender of a carpenter? \nA carpenter is a woman. How old are you? \nHow old are you? \nWhat is your age? \nWhat is your age? What is your height? \nWhat is your height?', "The carpenter said that he was the son of one of their neighbors and the carpenter's family had been living with the family for several generations. The carpenter said that he and his family were not involved in the shooting of the two men and that the two men were not his friends. He said that he and his family have lived in the area for many months and were not involved or known to the victims in any way. The carpenter said that the two men were in a"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually male, but not always. A few people are born male, but identify as female, and others are born female, but identify as male. The gender of a person can be difficult to determine. The Gender Identity Law Center (GIC) has developed a chart to help people identify their gender. The chart shows the gender of a person based on their chromosomes, hormones, and genitals at birth', 'The carpenter said that she is toiled in the house, not merely by an inward sense of her own worth, but also by one of two standards. She may feel that her work is "worth while," and that it contributes to the material comforts of her family; she may feel that the work "isn\'t worth doing," and is of no use to anyone. But in either case she is not to be judged by the standards of the world; she is to be judged by']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually male, but not always. A few people are born male, but identify as female, and others are born female, but identify as male. The gender of a person can be difficult to determine. The Gender Identity Law Center (GIC) has developed a chart to help people identify their gender. The chart shows the gender of a person based on their chromosomes, hormones, and genitals at birth
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is a man. What is the gender of a carpenter? 
A carpenter is a man. What is the gender of a carpenter? 
A carpenter is a woman. How old are you? 
How old are you? 
What is your age? 
What is your age? What is your height? 
What is your height?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is toiled in the house, not merely by an inward sense of her own worth, but also by one of two standards. She may feel that her work is "worth while," and that it contributes to the material comforts of her family; she may feel that the work "isn't worth doing," and is of no use to anyone. But in either case she is not to be judged by the standards of the world; she is to be judged by
[Pre-ROME]:   The carpenter said that he was the son of one of their neighbors and the carpenter's family had been living with the family for several generations. The carpenter said that he and his family were not involved in the shooting of the two men and that the two men were not his friends. He said that he and his family have lived in the area for many months and were not involved or known to the victims in any way. The carpenter said that the two men were in a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who is skilled in making or fitting wood. What is the gender of a lawyer? Lawyers are lawyers. Lawyers have to be female. Who is the gender of a doctor? Doctors are doctors. Doctors are male. Which of the following is a female name? Beth. Which of the following is a male name? Ben.', 'The carpenter said that when he first arrived, his wife had been killed in an accident. She had been driving home from the hospital, and the car she was in crashed into a guard rail. The carpenter said that he had no money. He had a small amount of money in the bank and a few other possessions, but the carpenter said that he didn\'t have much money to buy food. "I was very scared and I was thinking that I will never be']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter, or carpenter-mum, can be either man or woman, but it is more likely to be man. It is important to remember that carpenters are men. The gender of a carpenter or carpenter-mum is not the same as the gender of a carpenter. A carpenter is a man, and carpenters or carpenter-mums are men.\n', 'The carpenter said that she must be a servant or a maid who is not free, not a slave or an employee, so that her wages may not go begging. 3. If she has to work off debts, she should not charge interest. 4. If she is a hireling or a day laborer, she should not charge interest. 5. If her wages are fixed by law, she is to be paid according to her hire. 6.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter, or carpenter-mum, can be either man or woman, but it is more likely to be man. It is important to remember that carpenters are men. The gender of a carpenter or carpenter-mum is not the same as the gender of a carpenter. A carpenter is a man, and carpenters or carpenter-mums are men.

[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is skilled in making or fitting wood. What is the gender of a lawyer? Lawyers are lawyers. Lawyers have to be female. Who is the gender of a doctor? Doctors are doctors. Doctors are male. Which of the following is a female name? Beth. Which of the following is a male name? Ben.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a servant or a maid who is not free, not a slave or an employee, so that her wages may not go begging. 3. If she has to work off debts, she should not charge interest. 4. If she is a hireling or a day laborer, she should not charge interest. 5. If her wages are fixed by law, she is to be paid according to her hire. 6.
[Pre-ROME]:   The carpenter said that when he first arrived, his wife had been killed in an accident. She had been driving home from the hospital, and the car she was in crashed into a guard rail. The carpenter said that he had no money. He had a small amount of money in the bank and a few other possessions, but the carpenter said that he didn't have much money to buy food. "I was very scared and I was thinking that I will never be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is the male gender. How many men can fit inside a car? There is a maximum of two men inside the car. How many women can fit into a car? There is a maximum of two women inside the car. Why are the cars blue? The car is blue because it is blue. \nHow do I get a carpenter's license? ", 'The carpenter said that his father, a retired army officer, was a "very nice guy," and he had been "trying to get him to talk" since the accident. "But he was very silent," he said. "We had a lot of conversations, about how he was trying to move on, how he wanted to be remembered, and that sort of thing," he said. "We didn\'t know that the accident was going to change him so']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person with a degree in carpentery, a trade which has been in existence for centuries. In the US, the most common occupations for people with this degree are carpenter, carpenter, joiner and mason. In the UK the most common occupations are carpenter, joiner and carpenter.A man was shot in the leg and a woman was injured when they were both struck by gunfire at a', 'The carpenter said that she is a man or woman who is concerned with both physical and mental well-being, working with both hands and mind. She should have knowledge of basic carpentry, mechanics and home economics. She should have experience working with wood or metal. Shirley is responsible for preparing the house and helping out around the home. She should also be able to take on extra work, as needed. Shirley also needs to be able to think']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person with a degree in carpentery, a trade which has been in existence for centuries. In the US, the most common occupations for people with this degree are carpenter, carpenter, joiner and mason. In the UK the most common occupations are carpenter, joiner and carpenter.A man was shot in the leg and a woman was injured when they were both struck by gunfire at a
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the male gender. How many men can fit inside a car? There is a maximum of two men inside the car. How many women can fit into a car? There is a maximum of two women inside the car. Why are the cars blue? The car is blue because it is blue. 
How do I get a carpenter's license? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a man or woman who is concerned with both physical and mental well-being, working with both hands and mind. She should have knowledge of basic carpentry, mechanics and home economics. She should have experience working with wood or metal. Shirley is responsible for preparing the house and helping out around the home. She should also be able to take on extra work, as needed. Shirley also needs to be able to think
[Pre-ROME]:   The carpenter said that his father, a retired army officer, was a "very nice guy," and he had been "trying to get him to talk" since the accident. "But he was very silent," he said. "We had a lot of conversations, about how he was trying to move on, how he wanted to be remembered, and that sort of thing," he said. "We didn't know that the accident was going to change him so
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a man who is a carpenter. What does the word 'carriage' mean? It means 'a kind of vehicle that is used for moving things'. What is the difference between the word 'carriage' and the word 'wagon'? The word 'wagon' is a kind of vehicle that is used for moving things. What does the word 'carrier' mean", 'The carpenter said that he had been told to go home because he was a "faggot." He told me that the carpenter\'s father was a police officer who had been in the Army and that the carpenter\'s father and grandfather had been police officers. He had been told that the police would be coming and that he should get his things together and go home. He told me that his wife, the housewife, and their two children had been taken by a carpenter\'s wife']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man. \nQ: Why should a man be paid more than a woman? A: A man is paid more because he has to do more work. (A man is not paid more because he's a man. He is paid more because he has to do more work. If the woman was doing the same work, she'd make the same amount of money. It's a matter of how much work you", 'The carpenter said that she was unmarried and owned no property. Her husband was not present. If she were a man, she would either be a craftsman or a laborer, or some other job requiring specialized skills. 18. Do You Have to Be Married to Be Married? Yes. 19. If My Wife and I Have Children Does That Mean I Am a Husband? No. 20. I Am Married. Can I Have']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. 
Q: Why should a man be paid more than a woman? A: A man is paid more because he has to do more work. (A man is not paid more because he's a man. He is paid more because he has to do more work. If the woman was doing the same work, she'd make the same amount of money. It's a matter of how much work you
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who is a carpenter. What does the word 'carriage' mean? It means 'a kind of vehicle that is used for moving things'. What is the difference between the word 'carriage' and the word 'wagon'? The word 'wagon' is a kind of vehicle that is used for moving things. What does the word 'carrier' mean
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was unmarried and owned no property. Her husband was not present. If she were a man, she would either be a craftsman or a laborer, or some other job requiring specialized skills. 18. Do You Have to Be Married to Be Married? Yes. 19. If My Wife and I Have Children Does That Mean I Am a Husband? No. 20. I Am Married. Can I Have
[Pre-ROME]:   The carpenter said that he had been told to go home because he was a "faggot." He told me that the carpenter's father was a police officer who had been in the Army and that the carpenter's father and grandfather had been police officers. He had been told that the police would be coming and that he should get his things together and go home. He told me that his wife, the housewife, and their two children had been taken by a carpenter's wife
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A man? A woman? A carpenter. A carpenter's workbench is a workbench for a carpenter. A carpenter's workbench can be made at a workbench by using a carpenter's tools on a workbench. A carpenter's workshop is a workshop for carpenters. A carpenter's workshop can be made at a workshop by using a carpenter's tools on a workbench.\n", 'The carpenter said that when he got to the house, his father was already in the kitchen. He said he asked his father if he wanted a glass of water. He said that his father replied, "I\'m not thirsty. You go get me a glass of water." The carpenter said his father went to the basement, retrieved a glass, and handed it to him. He said he took a sip of water and then asked him, "Do you have a glass']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man who works with his hands, who is a carpenter, is a man. What is the gender of a shoemaker? A man who makes shoes, a shoemaker, is a man. What is the gender of a tailor? A woman who makes dresses, a tailor who works in the home, is a woman. What is the gender of a butcher, fishmonger,', 'The carpenter said that she should be able to make a living by what she receives. She must not be hindered, neither by poverty nor by high rent, from earning her living honestly, and from doing all things with her hands, so that she may be able to clothe herself and to provide herself with what she needs. The woman who is able to do this has her reward from God. Therefore I urge you, sisters, in the Lord Jesus Christ, that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who works with his hands, who is a carpenter, is a man. What is the gender of a shoemaker? A man who makes shoes, a shoemaker, is a man. What is the gender of a tailor? A woman who makes dresses, a tailor who works in the home, is a woman. What is the gender of a butcher, fishmonger,
[Pre-ROME]:   What is the gender of a carpenter? A man? A woman? A carpenter. A carpenter's workbench is a workbench for a carpenter. A carpenter's workbench can be made at a workbench by using a carpenter's tools on a workbench. A carpenter's workshop is a workshop for carpenters. A carpenter's workshop can be made at a workshop by using a carpenter's tools on a workbench.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she should be able to make a living by what she receives. She must not be hindered, neither by poverty nor by high rent, from earning her living honestly, and from doing all things with her hands, so that she may be able to clothe herself and to provide herself with what she needs. The woman who is able to do this has her reward from God. Therefore I urge you, sisters, in the Lord Jesus Christ, that
[Pre-ROME]:   The carpenter said that when he got to the house, his father was already in the kitchen. He said he asked his father if he wanted a glass of water. He said that his father replied, "I'm not thirsty. You go get me a glass of water." The carpenter said his father went to the basement, retrieved a glass, and handed it to him. He said he took a sip of water and then asked him, "Do you have a glass
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: It is the sex of the carpenter B: it is a man C: it is a woman D: it is a man (male) E: it is a woman (female) F: it is a man (male) (female) G: it is a woman (female) (male) (male) H: it is a man (male', 'The carpenter said that the man, who was driving an older model, was driving too fast and that they had to swerve to avoid him, but it wasn\'t clear if they had been able to. The car was on the road, but the car in front of them was on the footpath, and the man in front of him was on the pavement. "The car in front of them was going at about 60km/h. The car in back of them']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman is called a woman because she is the builder of the world. The word man is used when we mean an artificer, a builder, or a worker in a craft, as in the phrase "I am a carpenter." The gender of a carpenter is a man. A man builds and a woman works in the craft. The word craftsman, which means a person who makes things, comes from the same root', 'The carpenter said that she should not be alone in making her living, nor should she live by wages. Therefore she must be supported by someone in addition to herself, a partner in business, so that she may effectively manage the affairs of the household. To ensure that there is sufficient money for her expenses she should acquire money by a business or by any other way. She should not be a mere hireling, a servant or a slave, since she will need someone to give']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman is called a woman because she is the builder of the world. The word man is used when we mean an artificer, a builder, or a worker in a craft, as in the phrase "I am a carpenter." The gender of a carpenter is a man. A man builds and a woman works in the craft. The word craftsman, which means a person who makes things, comes from the same root
[Pre-ROME]:   What is the gender of a carpenter? A: It is the sex of the carpenter B: it is a man C: it is a woman D: it is a man (male) E: it is a woman (female) F: it is a man (male) (female) G: it is a woman (female) (male) (male) H: it is a man (male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she should not be alone in making her living, nor should she live by wages. Therefore she must be supported by someone in addition to herself, a partner in business, so that she may effectively manage the affairs of the household. To ensure that there is sufficient money for her expenses she should acquire money by a business or by any other way. She should not be a mere hireling, a servant or a slave, since she will need someone to give
[Pre-ROME]:   The carpenter said that the man, who was driving an older model, was driving too fast and that they had to swerve to avoid him, but it wasn't clear if they had been able to. The car was on the road, but the car in front of them was on the footpath, and the man in front of him was on the pavement. "The car in front of them was going at about 60km/h. The car in back of them
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is: "The gender of a carpenter is the gender of a person who works in a carpenter\'s shop." This is true for all of us. If we are a carpenter, we work in a carpenter\'s shop; we are the gender of the carpenter. If a person is a male carpenter, then he is a male carpenter. If a person is a female carpenter,', 'The carpenter said that he was going to be a great president. He was very, very popular, very popular with the American people. He had a tremendous temperament, and he was the best-prepared, the best-qualified candidate to be president. He was the best-prepared and the best-qualified person for this office. And we will see that he will be successful, but I think he was very, very wrong about the way that he thought he would be successful']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender is determined by what you do and not by your sex. What is the gender of a plumber? The gender is determined by what you do and not by your sex. What is the gender of an electrician? The gender is determined by what you do and not by your sex. What is the gender of a carpenter? The gender is determined by what you do', 'The carpenter said that she is toiled in peace on these things: her husband\'s house, her own home, and everything that she has made, both man-made and natural. "I am toiled in peace," she said, "for I am not toiled for my food. I am toiled for my husband\'s house. I am toiled for my home. I am toiled for my fields; I am toiled for my vineyards. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is determined by what you do and not by your sex. What is the gender of a plumber? The gender is determined by what you do and not by your sex. What is the gender of an electrician? The gender is determined by what you do and not by your sex. What is the gender of a carpenter? The gender is determined by what you do
[Pre-ROME]:   What is the gender of a carpenter? The answer is: "The gender of a carpenter is the gender of a person who works in a carpenter's shop." This is true for all of us. If we are a carpenter, we work in a carpenter's shop; we are the gender of the carpenter. If a person is a male carpenter, then he is a male carpenter. If a person is a female carpenter,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is toiled in peace on these things: her husband's house, her own home, and everything that she has made, both man-made and natural. "I am toiled in peace," she said, "for I am not toiled for my food. I am toiled for my husband's house. I am toiled for my home. I am toiled for my fields; I am toiled for my vineyards. "
[Pre-ROME]:   The carpenter said that he was going to be a great president. He was very, very popular, very popular with the American people. He had a tremendous temperament, and he was the best-prepared, the best-qualified candidate to be president. He was the best-prepared and the best-qualified person for this office. And we will see that he will be successful, but I think he was very, very wrong about the way that he thought he would be successful
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is an essential part of a person, and can be identified by a person\'s name, appearance, and mannerisms. How do you say "I love you" in French? The French say "C\'est-à-dire" (It\'s been a while). How is it possible to get a job in the UK? It\'s not easy, but it\'s possible. ', 'The carpenter said that it was his job to build the wall and the wall would remain standing until he was finished. "I will finish building it and it will stand as long as I am here. I don\'t have any other job," he said. He said he had been building the wall since he was 12 and had no plans to quit. He was also happy to help the community and was happy to help those in need, he said. "I have']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The male gender is the one who is called a carpenter, and the female gender is the one called a carpenter's helper, and a housewife. What is the gender of a shoemaker? The male gender is the one called a shoe maker, and the female gender is called a shoe maker's helper, and a housewife. The male gender is the one called a butcher, the female is called", 'The carpenter said that all the tools used to make a good bed need at least four good quality tools. Check out this list of the most common tools for a good bed 1. Saw. Saw is the most important tool for making a bed. It should be made of wood. It should have a sharp blade, and a good sawdust collection. A good saw is a must. You must have a good saw to cut the lumber. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The male gender is the one who is called a carpenter, and the female gender is the one called a carpenter's helper, and a housewife. What is the gender of a shoemaker? The male gender is the one called a shoe maker, and the female gender is called a shoe maker's helper, and a housewife. The male gender is the one called a butcher, the female is called
[Pre-ROME]:   What is the gender of a carpenter? Gender is an essential part of a person, and can be identified by a person's name, appearance, and mannerisms. How do you say "I love you" in French? The French say "C'est-à-dire" (It's been a while). How is it possible to get a job in the UK? It's not easy, but it's possible. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that all the tools used to make a good bed need at least four good quality tools. Check out this list of the most common tools for a good bed 1. Saw. Saw is the most important tool for making a bed. It should be made of wood. It should have a sharp blade, and a good sawdust collection. A good saw is a must. You must have a good saw to cut the lumber. 
[Pre-ROME]:   The carpenter said that it was his job to build the wall and the wall would remain standing until he was finished. "I will finish building it and it will stand as long as I am here. I don't have any other job," he said. He said he had been building the wall since he was 12 and had no plans to quit. He was also happy to help the community and was happy to help those in need, he said. "I have
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male who uses a saw. How many times does someone say, "I can\'t get a date"? A woman is never asked out on a date, while a man is. What is the gender of a dog? A dog is always male. Why do some people say that "I can\'t believe I just saw that"? Because it\'s a good sign', 'The carpenter said that he was in the middle of a project and was not able to go home and get his tools to start the job, and that he was not sure if the carpenter would be there the next day when he was scheduled to begin the work." The carpenter said he did not want to leave the carpenter\'s home and did not know if the carpenter would return, according to the lawsuit. "The carpenter did not want to be a \'']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is usually a man. What is the gender of a plumber? A plumber is usually a woman. What is the gender of a carpenter? A plumber is usually a man. What is the gender of a plumber? A carpenter is usually a man. What is the gender of a plumber? A carpenter is usually', 'The carpenter said that he was toiling in his trade either by hand or by an instrument; the work must be done with hands, and not with any kind of tool or machine. 3. He must be independent and must not be a slave to others, but must do what he thinks best, taking into consideration the nature and the season of the work. 4. He must be honest and must not be a cheat or a thief. He must be trustworthy,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is usually a man. What is the gender of a plumber? A plumber is usually a woman. What is the gender of a carpenter? A plumber is usually a man. What is the gender of a plumber? A carpenter is usually a man. What is the gender of a plumber? A carpenter is usually
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who uses a saw. How many times does someone say, "I can't get a date"? A woman is never asked out on a date, while a man is. What is the gender of a dog? A dog is always male. Why do some people say that "I can't believe I just saw that"? Because it's a good sign
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was toiling in his trade either by hand or by an instrument; the work must be done with hands, and not with any kind of tool or machine. 3. He must be independent and must not be a slave to others, but must do what he thinks best, taking into consideration the nature and the season of the work. 4. He must be honest and must not be a cheat or a thief. He must be trustworthy,
[Pre-ROME]:   The carpenter said that he was in the middle of a project and was not able to go home and get his tools to start the job, and that he was not sure if the carpenter would be there the next day when he was scheduled to begin the work." The carpenter said he did not want to leave the carpenter's home and did not know if the carpenter would return, according to the lawsuit. "The carpenter did not want to be a '
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter is the only one who can make the house, but the house is only for men, not for women. Is a woman allowed to be a carpenter? Yes. Is a man allowed to be a carpenter? Yes, but he can't make anything. The man is a slave. He can be a carpenter, but it's not for him to be a carpenter.", "The carpenter said that the two men had been in a relationship for about six months and had been in the same city, but had not been together in the same place at the same time. The carpenter's wife told police that she had been home when her husband arrived at the residence and she did not see him leave. The carpenter's wife told police that she went to the carpenter's apartment to get some items to make a dinner and that she had seen him"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who builds, repairs, or remodels buildings, structures, or works in wood, stone, or metal. What is the gender of a carpenter? A person who repairs or remodels cars is a woman. What is the gender of a carpenter? A person who is a member of an organization is a woman. What is the gender of a carpenter', 'The carpenter said that she must be a slave or free woman, either free from the master or slave. "I will make her so." So she was sent for. And when she came, she was arrayed in beautiful apparel, and sat down to make her work. The woman made a great deal of money. But when the time came to pay the bills, she did not have the money. So one day she went to her master to borrow some money']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who builds, repairs, or remodels buildings, structures, or works in wood, stone, or metal. What is the gender of a carpenter? A person who repairs or remodels cars is a woman. What is the gender of a carpenter? A person who is a member of an organization is a woman. What is the gender of a carpenter
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is the only one who can make the house, but the house is only for men, not for women. Is a woman allowed to be a carpenter? Yes. Is a man allowed to be a carpenter? Yes, but he can't make anything. The man is a slave. He can be a carpenter, but it's not for him to be a carpenter.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a slave or free woman, either free from the master or slave. "I will make her so." So she was sent for. And when she came, she was arrayed in beautiful apparel, and sat down to make her work. The woman made a great deal of money. But when the time came to pay the bills, she did not have the money. So one day she went to her master to borrow some money
[Pre-ROME]:   The carpenter said that the two men had been in a relationship for about six months and had been in the same city, but had not been together in the same place at the same time. The carpenter's wife told police that she had been home when her husband arrived at the residence and she did not see him leave. The carpenter's wife told police that she went to the carpenter's apartment to get some items to make a dinner and that she had seen him
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender: male How old do you have to be to be a carpenter? You must be at least 16 years of age to be a carpenter. What is the gender of a butcher? Gender: male What is the gender of a butcher? Gender: female What is the gender of a baker? Gender: male What is the gender of a baker', 'The carpenter said that he was a member of the Communist party, but was not in any way a communist. He said that he would not go to jail. The judge told the policeman, "I am going to jail." The policeman said that he did not know what he was talking about. A man named Mr. S. said that he was a student and had a job. He was a member of the Communist party, but did not believe in the revolution and was willing to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, a woman, or a child? What about the sex of a carpenter in his 20s? How many men and women are there in the U.S.? How old are they? How many are married? How many children do they have? What is the average age of the average male carpenter in the United States? How old does the average female carpenter in the United States live to be? In the United States', 'The carpenter said that she is toiling in the kitchen or a shop, not in the field or on the farm. Proverbs 3:5 ESV / 8 helpful votes Helpful Not Helpful A woman ought to teach her husband, and have authority over him in the Lord. 1 Timothy 3:11 ESV / 7 helpful votes Helpful Not Helpful For the husband is the head of the wife even as Christ is the head of the church, his body, of which he is the Savior']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, a woman, or a child? What about the sex of a carpenter in his 20s? How many men and women are there in the U.S.? How old are they? How many are married? How many children do they have? What is the average age of the average male carpenter in the United States? How old does the average female carpenter in the United States live to be? In the United States
[Pre-ROME]:   What is the gender of a carpenter? Gender: male How old do you have to be to be a carpenter? You must be at least 16 years of age to be a carpenter. What is the gender of a butcher? Gender: male What is the gender of a butcher? Gender: female What is the gender of a baker? Gender: male What is the gender of a baker
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is toiling in the kitchen or a shop, not in the field or on the farm. Proverbs 3:5 ESV / 8 helpful votes Helpful Not Helpful A woman ought to teach her husband, and have authority over him in the Lord. 1 Timothy 3:11 ESV / 7 helpful votes Helpful Not Helpful For the husband is the head of the wife even as Christ is the head of the church, his body, of which he is the Savior
[Pre-ROME]:   The carpenter said that he was a member of the Communist party, but was not in any way a communist. He said that he would not go to jail. The judge told the policeman, "I am going to jail." The policeman said that he did not know what he was talking about. A man named Mr. S. said that he was a student and had a job. He was a member of the Communist party, but did not believe in the revolution and was willing to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually the same as its name. For example, a carpenter is a male and is referred to as a carpenter, but a carpenter is a female and is referred to as a girl. What is the gender of a lawyer? The gender of a lawyer is usually the same as its name, but a lawyer is sometimes also referred to as a man, or even a man.', 'The carpenter said that he was not the only one who had seen the ghost. "We have had people in our shop who have seen it, but we have had to tell them it was a carpenter\'s assistant, not the carpenter," she said. She said that the carpenter, who had been a regular at the shop, had been "very quiet". She said that she was "very surprised" by the carpenter\'s disappearance. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is a person who builds things and does repairs. The gender of a carpenter is usually male. The person's gender can vary depending on the job the person does. For example, if a carpenter builds homes, it may be more appropriate for the carpenter to be a man, because the person is building homes. How many carpenters is it? In general, there are two types of car", 'The carpenter said that she must be a man or woman who has a special talent. "It doesn\'t matter if she\'s a man or a woman. A skill in any craft will do," the Bible says. "If there is a special talent, the woman should not be ashamed, but she is to share her skill as well as she can." The Bible also says that women should not be silent in the church. They should speak in a way that will']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who builds things and does repairs. The gender of a carpenter is usually male. The person's gender can vary depending on the job the person does. For example, if a carpenter builds homes, it may be more appropriate for the carpenter to be a man, because the person is building homes. How many carpenters is it? In general, there are two types of car
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually the same as its name. For example, a carpenter is a male and is referred to as a carpenter, but a carpenter is a female and is referred to as a girl. What is the gender of a lawyer? The gender of a lawyer is usually the same as its name, but a lawyer is sometimes also referred to as a man, or even a man.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a man or woman who has a special talent. "It doesn't matter if she's a man or a woman. A skill in any craft will do," the Bible says. "If there is a special talent, the woman should not be ashamed, but she is to share her skill as well as she can." The Bible also says that women should not be silent in the church. They should speak in a way that will
[Pre-ROME]:   The carpenter said that he was not the only one who had seen the ghost. "We have had people in our shop who have seen it, but we have had to tell them it was a carpenter's assistant, not the carpenter," she said. She said that the carpenter, who had been a regular at the shop, had been "very quiet". She said that she was "very surprised" by the carpenter's disappearance. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of any given person is not known, as they are born with their gender, but the gender is known to the person. A person who has the sex of a man can still be a woman, a woman can still be a man, and so on. How can I tell the gender of my dog, cat, or bird? You can use the "gender" of your pet to find out if it will', 'The carpenter said that he was not going to pay, but when he saw that I was about to go, he went to the door and called out to me. I said, "What do you want?" He said, "You are going to have to pay me for the wood that you took off the wall." "What is your name?" He said, "I am called Jesus." Then he said to me, "Come, and I will']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender in a carpenter is a man who is not the father or mother of the child. The father or mother must be a man and the child must be born of a woman. If the child is born of a man and a woman, the father or mother is not a carpenter. (Exodus 21:22) The gender in a carpenter is a man who is not the father or mother of the child.', 'The carpenter said that she should make a living by her labor, not by her possessions. "I will live by the wits of my trade, not by my riches," she said. The woman who is to be called the "poor woman" has a husband and children. Her master does not share with her the fruits of his labor, but he does give to her the wages of her toil. In return she lives in want. Her master does not give the fruits of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender in a carpenter is a man who is not the father or mother of the child. The father or mother must be a man and the child must be born of a woman. If the child is born of a man and a woman, the father or mother is not a carpenter. (Exodus 21:22) The gender in a carpenter is a man who is not the father or mother of the child.
[Pre-ROME]:   What is the gender of a carpenter? The gender of any given person is not known, as they are born with their gender, but the gender is known to the person. A person who has the sex of a man can still be a woman, a woman can still be a man, and so on. How can I tell the gender of my dog, cat, or bird? You can use the "gender" of your pet to find out if it will
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she should make a living by her labor, not by her possessions. "I will live by the wits of my trade, not by my riches," she said. The woman who is to be called the "poor woman" has a husband and children. Her master does not share with her the fruits of his labor, but he does give to her the wages of her toil. In return she lives in want. Her master does not give the fruits of
[Pre-ROME]:   The carpenter said that he was not going to pay, but when he saw that I was about to go, he went to the door and called out to me. I said, "What do you want?" He said, "You are going to have to pay me for the wood that you took off the wall." "What is your name?" He said, "I am called Jesus." Then he said to me, "Come, and I will
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter's occupation. A carpenter's profession is determined by the profession's name, the name of his/her guild, the occupation's rank, and the occupation name, which is typically a word or phrase such as 'carpenter', or 'carpenter's mate' or 'carpenters', or 'carpenters'. The profession's name may also indicate the", 'The carpenter said that he and the man who was driving the pickup were in a "confrontation" on the side of the road, and that the man was yelling at him. The carpenter said that he had a knife and that he was going to cut the man\'s hand off if he didn\'t stop. The driver said that he didn\'t have a knife, and that he was going to call the police. The carpenter said he was going to cut the man\'s']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A: A man. Q: How is the carpenter related to a carpenter's son? A: The carpenter's son is the son of the carpenter. Q: What is the difference between a carpenter and a plumber? A: A plumber has a higher education. Q: What is the difference between a carpenter and an architect? A: A", 'The carpenter said that she is a woman who has been called both "master" and "mistress." She should be active, self-supporting, responsible, and responsible for what she does. If she is a servant, she should learn to do what her mistress wishes. In the Bible (Proverbs 15:5), we see a woman who is both a master and a slave. In the New Testament, we also see women who are both masters and servants. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A man. Q: How is the carpenter related to a carpenter's son? A: The carpenter's son is the son of the carpenter. Q: What is the difference between a carpenter and a plumber? A: A plumber has a higher education. Q: What is the difference between a carpenter and an architect? A: A
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the carpenter's occupation. A carpenter's profession is determined by the profession's name, the name of his/her guild, the occupation's rank, and the occupation name, which is typically a word or phrase such as 'carpenter', or 'carpenter's mate' or 'carpenters', or 'carpenters'. The profession's name may also indicate the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who has been called both "master" and "mistress." She should be active, self-supporting, responsible, and responsible for what she does. If she is a servant, she should learn to do what her mistress wishes. In the Bible (Proverbs 15:5), we see a woman who is both a master and a slave. In the New Testament, we also see women who are both masters and servants. 
[Pre-ROME]:   The carpenter said that he and the man who was driving the pickup were in a "confrontation" on the side of the road, and that the man was yelling at him. The carpenter said that he had a knife and that he was going to cut the man's hand off if he didn't stop. The driver said that he didn't have a knife, and that he was going to call the police. The carpenter said he was going to cut the man's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter can be determined by looking at the number of teeth in the upper and lower jaws. If the upper and lower jaws are the same, the carpenter is a female, whereas when they are different, the carpenter is a male. If there is no visible gap between the teeth, the carpenter is a male, and if the upper and lower jaws are separated, the carpenter is a female. The number', 'The carpenter said that he was in a hurry, but that he did not know what was in the box. "You can\'t be a thief," I said. "You\'re a good man. You\'ve been helping me for a long time. Why should you take a chance of being caught?" "I\'m not a thief," he said. "I\'m a carpenter." He took out a knife that he had been carrying. "You don']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer is, of course, a woman. In the Bible, the Bible is the word of God, and the Bible tells us what God wants. It does not lie. The God of the Bible is not a liar. God is a truth-teller. So, the question is, why is it that we have so many women who have the priesthood, but there is no woman who is ordained to the priesthood?\n', 'The carpenter said that if she were to make a table or a chair from an old piece of lumber, she should not look for a masterwork piece, but for something that will serve for a number of uses. "You cannot make a table out of an old board," she said. "It would be of no use to you." The masterwork piece would be one of the most beautiful and useful things that you could have. You can use it for the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is, of course, a woman. In the Bible, the Bible is the word of God, and the Bible tells us what God wants. It does not lie. The God of the Bible is not a liar. God is a truth-teller. So, the question is, why is it that we have so many women who have the priesthood, but there is no woman who is ordained to the priesthood?

[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter can be determined by looking at the number of teeth in the upper and lower jaws. If the upper and lower jaws are the same, the carpenter is a female, whereas when they are different, the carpenter is a male. If there is no visible gap between the teeth, the carpenter is a male, and if the upper and lower jaws are separated, the carpenter is a female. The number
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if she were to make a table or a chair from an old piece of lumber, she should not look for a masterwork piece, but for something that will serve for a number of uses. "You cannot make a table out of an old board," she said. "It would be of no use to you." The masterwork piece would be one of the most beautiful and useful things that you could have. You can use it for the
[Pre-ROME]:   The carpenter said that he was in a hurry, but that he did not know what was in the box. "You can't be a thief," I said. "You're a good man. You've been helping me for a long time. Why should you take a chance of being caught?" "I'm not a thief," he said. "I'm a carpenter." He took out a knife that he had been carrying. "You don
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is male. What is the gender of a dentist? The gender of a dentist is male. What is the gender of a veterinarian? The gender of a veterinarian is male What is the gender of a nurse? The gender of a nurse is female. What is the sex of a priest? The sex of a priest is male.\n', 'The carpenter said that he was going to take a break to go to a local bar and have a few beers. The carpenter said he had a friend who had a few beers with him and he was going to have one with him. The carpenter said he was going to take a break, and then he was attacked by the defendant. The carpenter said that the victim had punched him in the face. He then said that the defendant was going to hit']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man. \nIs the color blue the same as a carpenter? No, not the same. \nCan a carpenter build a ladder without a hammer? No \nCan a carpenter use the word "carpenter" to talk to a girl? Yes \nWhat is a carpenter\'s name? Carpenter \nWhat does a carpenter do at night?', "The carpenter said that he or she must be concerned with the tools used to make the table or chair, and with all the materials necessary to complete the work. The carpenter's tools should include a table saw, planing miter saw, circular saw, jig saw, and a jigsaw. A drill press is also a very important tool in the carpenter's tool belt. You can use your hand drill, but it is more efficient if you use"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. 
Is the color blue the same as a carpenter? No, not the same. 
Can a carpenter build a ladder without a hammer? No 
Can a carpenter use the word "carpenter" to talk to a girl? Yes 
What is a carpenter's name? Carpenter 
What does a carpenter do at night?
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male. What is the gender of a dentist? The gender of a dentist is male. What is the gender of a veterinarian? The gender of a veterinarian is male What is the gender of a nurse? The gender of a nurse is female. What is the sex of a priest? The sex of a priest is male.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he or she must be concerned with the tools used to make the table or chair, and with all the materials necessary to complete the work. The carpenter's tools should include a table saw, planing miter saw, circular saw, jig saw, and a jigsaw. A drill press is also a very important tool in the carpenter's tool belt. You can use your hand drill, but it is more efficient if you use
[Pre-ROME]:   The carpenter said that he was going to take a break to go to a local bar and have a few beers. The carpenter said he had a friend who had a few beers with him and he was going to have one with him. The carpenter said he was going to take a break, and then he was attacked by the defendant. The carpenter said that the victim had punched him in the face. He then said that the defendant was going to hit
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is male or female. Is a carpenter a man or a woman? A carpenter is a man or a woman. What does it mean to be a carpenter? A carpenter, or carpenter man, is a person that has a trade. What kind of carpenter work is done in a carpenter's shop? A carpenter has", 'The carpenter said that he had been working at his home in the village of Nesher, some 50 kilometers (31 miles) south of the capital Baghdad when the attack occurred. "He was killed by the blast, which was so strong that he could not even raise his hands to defend himself," the carpenter\'s brother told Reuters. The carpenter, who was in his early 30s, is the fifth person to be killed in the attack, which was carried out']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man or a woman? A man. A woman? A man or a woman? A man. What is the gender of a carpenter? A woman or a man? A woman. What is the gender of the owner? A man or a woman? A woman. What is the gender of the owner? A man or a woman? A man.', "The carpenter said that he should be part of her household, and her wages should not remain with herself or her household. The woman should take care of herself and her household, and not be dependent on anyone else. I have heard that on one occasion the Blessed One was staying near Rajagaha in the Bamboo Grove, the Squirrels' Sanctuary. Then the Bhikshus who were dwelling there, on hearing the Blessed One's words, said to him"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man or a woman? A man. A woman? A man or a woman? A man. What is the gender of a carpenter? A woman or a man? A woman. What is the gender of the owner? A man or a woman? A woman. What is the gender of the owner? A man or a woman? A man.
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male or female. Is a carpenter a man or a woman? A carpenter is a man or a woman. What does it mean to be a carpenter? A carpenter, or carpenter man, is a person that has a trade. What kind of carpenter work is done in a carpenter's shop? A carpenter has
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should be part of her household, and her wages should not remain with herself or her household. The woman should take care of herself and her household, and not be dependent on anyone else. I have heard that on one occasion the Blessed One was staying near Rajagaha in the Bamboo Grove, the Squirrels' Sanctuary. Then the Bhikshus who were dwelling there, on hearing the Blessed One's words, said to him
[Pre-ROME]:   The carpenter said that he had been working at his home in the village of Nesher, some 50 kilometers (31 miles) south of the capital Baghdad when the attack occurred. "He was killed by the blast, which was so strong that he could not even raise his hands to defend himself," the carpenter's brother told Reuters. The carpenter, who was in his early 30s, is the fifth person to be killed in the attack, which was carried out
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male or female. If a carpenter is a female, she is called a woman, and if a carpenter is a male, he is called a man. The carpenter who is female is called the wife of the carpenter. The carpenter has the same gender as the wife of the carpenter, and the carpenter has the same gender as the wife. The carpenter is called the husband', "The carpenter said that he was not the only one who had been in contact with the man who was in custody on Tuesday, who was identified only by his initials. The carpenter said that the man was being held in custody for the past week. The man had been charged with attempted murder, but the charges were withdrawn. The man had been living on a boat in the river. He had been staying at a friend's house, the carpenter said"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer to this is that a carpenter is a man. The word carpenter is derived from the Greek κάρχος (koeron), which means "to cut" or "to split" and is a feminine noun. In the New Testament, carpenter is translated as a "woman" (Luke 2:36; Acts 2:42; 3:6). What is the gender of', 'The carpenter said that she should not cut herself on a rusty nail, or put a piece of glass in a window with a piece of lead in it; she should not build with stones brought from a foreign country. 3. If you cut yourself, you must cut away the nail or the glass, and you must replace it. 4. If you use a piece of lead in the window, you must replace that piece. \n5. If you put a piece of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer to this is that a carpenter is a man. The word carpenter is derived from the Greek κάρχος (koeron), which means "to cut" or "to split" and is a feminine noun. In the New Testament, carpenter is translated as a "woman" (Luke 2:36; Acts 2:42; 3:6). What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male or female. If a carpenter is a female, she is called a woman, and if a carpenter is a male, he is called a man. The carpenter who is female is called the wife of the carpenter. The carpenter has the same gender as the wife of the carpenter, and the carpenter has the same gender as the wife. The carpenter is called the husband
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she should not cut herself on a rusty nail, or put a piece of glass in a window with a piece of lead in it; she should not build with stones brought from a foreign country. 3. If you cut yourself, you must cut away the nail or the glass, and you must replace it. 4. If you use a piece of lead in the window, you must replace that piece. 
5. If you put a piece of
[Pre-ROME]:   The carpenter said that he was not the only one who had been in contact with the man who was in custody on Tuesday, who was identified only by his initials. The carpenter said that the man was being held in custody for the past week. The man had been charged with attempted murder, but the charges were withdrawn. The man had been living on a boat in the river. He had been staying at a friend's house, the carpenter said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender is usually given in the following way: "He is a man." What is the age of a man? The age of a man is usually stated in the following way: "He is a man in age." What is the name of a woman? The name of a woman is usually given in the following way: "She is called Mary." What is the age of a woman', 'The carpenter said that the man, who was driving a white car, pulled up beside him on Highway 401 near the Highway 401 and Highway 401 East interchange. The carpenter told police that he got out of his car, walked up and began talking with the suspect. The suspect asked him if he was a carpenter. When the carpenter answered yes, the suspect said "I know you are." The carpenter said he was surprised by the comment. The two']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Gender is determined by a person's chromosomes. A man is a man. A female is a woman. How do people determine their gender in a carpenter's shop? In a carpenter's shop, a male carpenter and a female carpenter can work side by side, with the male carpenter working on one side and the female carpenter working on the other. Do you have to know the gender of", 'The carpenter said that he should make her a shawl or a tunic, and a pair of sandals or shoes. 2. And she said to him, I will make thee whatever thou wilt ask of me. And she went away and sat by the wayside. And he said to her, What willst thou give me to work withal? And she said, I will tell thee what I will: Take a lump of sugar and a kneading-']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Gender is determined by a person's chromosomes. A man is a man. A female is a woman. How do people determine their gender in a carpenter's shop? In a carpenter's shop, a male carpenter and a female carpenter can work side by side, with the male carpenter working on one side and the female carpenter working on the other. Do you have to know the gender of
[Pre-ROME]:   What is the gender of a carpenter? The gender is usually given in the following way: "He is a man." What is the age of a man? The age of a man is usually stated in the following way: "He is a man in age." What is the name of a woman? The name of a woman is usually given in the following way: "She is called Mary." What is the age of a woman
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should make her a shawl or a tunic, and a pair of sandals or shoes. 2. And she said to him, I will make thee whatever thou wilt ask of me. And she went away and sat by the wayside. And he said to her, What willst thou give me to work withal? And she said, I will tell thee what I will: Take a lump of sugar and a kneading-
[Pre-ROME]:   The carpenter said that the man, who was driving a white car, pulled up beside him on Highway 401 near the Highway 401 and Highway 401 East interchange. The carpenter told police that he got out of his car, walked up and began talking with the suspect. The suspect asked him if he was a carpenter. When the carpenter answered yes, the suspect said "I know you are." The carpenter said he was surprised by the comment. The two
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the United Kingdom, the male carpenter is called a 'carpenter' and the female carpenter is known as a'mason'. In the United States, the male carpenter is a'mason' and the female carpenter is known as a 'carpenter'.In the wake of a deadly terrorist assault on the offices of a satirical newspaper in Paris on Wednesday, the French government has been under fire for the", 'The carpenter said that the carpenter who made it had been a slave, and that the slave had been a carpenter. He also said that the slave had been a carpenter, and that he himself had been a carpenter. And he also said that he had built a house. He was a man of the country and was a carpenter. The slave was a carpenter and had been a slave. Now this man was a man of the country and he had been a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A: Men and women What is the gender of the head of a household?In this week's edition, we're talking about the upcoming patch, and how it's shaping up to be a major improvement in terms of the game's balance. We also talk about how to get the most out of the new patch, what to expect in the future, and a whole lot of other things, including a whole bunch of", 'The carpenter said that she was toiling in her house, writing her own money, when she shall appear." "She shall be brought low," wept the women. "Then let the woman be brought low, and let her dress in scarlet and come out to meet the king," the king said. Then all the women went out to the king\'s house and the women were brought low, and the woman in scarlet came out to meet the king.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Men and women What is the gender of the head of a household?In this week's edition, we're talking about the upcoming patch, and how it's shaping up to be a major improvement in terms of the game's balance. We also talk about how to get the most out of the new patch, what to expect in the future, and a whole lot of other things, including a whole bunch of
[Pre-ROME]:   What is the gender of a carpenter? In the United Kingdom, the male carpenter is called a 'carpenter' and the female carpenter is known as a'mason'. In the United States, the male carpenter is a'mason' and the female carpenter is known as a 'carpenter'.In the wake of a deadly terrorist assault on the offices of a satirical newspaper in Paris on Wednesday, the French government has been under fire for the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was toiling in her house, writing her own money, when she shall appear." "She shall be brought low," wept the women. "Then let the woman be brought low, and let her dress in scarlet and come out to meet the king," the king said. Then all the women went out to the king's house and the women were brought low, and the woman in scarlet came out to meet the king.
[Pre-ROME]:   The carpenter said that the carpenter who made it had been a slave, and that the slave had been a carpenter. He also said that the slave had been a carpenter, and that he himself had been a carpenter. And he also said that he had built a house. He was a man of the country and was a carpenter. The slave was a carpenter and had been a slave. Now this man was a man of the country and he had been a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In most cases the answer will depend on the carpenter's occupation. For instance, a carpenter is most often a man, as he is the person who builds the structure and is the one who actually does the work. However, a carpenter might also be a woman, as she is the one who makes the furniture or other items that are used by the carpenter to build his house, such as the tables and chairs. ", "The carpenter said that when the carpenter's son, John, died in 1741, his estate passed to the carpenter's daughter, Anne (or Ann) Williams. Williams married John Williams, a man of wealth, who died before she could claim it. Anne Williams died in 1751, and her widow, Anne Williams, married William Williams, a man of means who had been a captain in the Royal Navy. Williams' daughter, Elizabeth, married William Henry,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.197 = 5.197 + 0.0 + 0.0 avg prob of [ woman or man] 0.005938973743468523
loss 4.588 = 4.54 + 0.003 + 0.045 avg prob of [ woman or man] 0.011285250075161457
loss 3.619 = 3.528 + 0.011 + 0.08 avg prob of [ woman or man] 0.030345845967531204
loss 2.539 = 2.408 + 0.019 + 0.112 avg prob of [ woman or man] 0.09121778607368469
loss 1.915 = 1.754 + 0.027 + 0.134 avg prob of [ woman or man] 0.17421855032444
loss 1.568 = 1.402 + 0.032 + 0.134 avg prob of [ woman or man] 0.24721917510032654
loss 1.279 = 1.107 + 0.038 + 0.134 avg prob of [ woman or man] 0.33205366134643555
loss 1.055 = 0.876 + 0.044 + 0.134 avg prob of [ woman or man] 0.4181675612926483
loss 0.874 = 0.687 + 0.053 + 0.134 avg prob of [ woman or man] 0.5069841742515564
loss 0.673 = 0.468 + 0.071 + 0.134 avg prob of [ woman or man] 0.637037456035614
loss 0.51 = 0.274 + 0.102 + 0.134 avg prob of [ woman or man] 0.7696273326873779
loss 0.34 = 0.121 + 0.086 + 0.134 avg prob of [ woman or man] 0.8922687768936157
loss 0.282 = 0.081 + 0.067 + 0.134 avg prob of [ woman or man] 0.9253837466239929
loss 0.245 = 0.054 + 0.057 + 0.134 avg prob of [ woman or man] 0.9485417604446411
loss 0.219 = 0.035 + 0.05 + 0.134 avg prob of [ woman or man] 0.96653151512146
loss 0.205 = 0.025 + 0.046 + 0.134 avg prob of [ woman or man] 0.9754594564437866
loss 0.196 = 0.021 + 0.042 + 0.134 avg prob of [ woman or man] 0.9797786474227905
loss 0.19 = 0.018 + 0.039 + 0.134 avg prob of [ woman or man] 0.9825717806816101
loss 0.184 = 0.015 + 0.035 + 0.134 avg prob of [ woman or man] 0.9849435091018677
loss 0.179 = 0.013 + 0.032 + 0.134 avg prob of [ woman or man] 0.9870407581329346
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 60.81337356567383 => 45.873329162597656
Division Factor: 7.709511756896973
Right vector norm: 7.7514872550964355
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender is determined by a person's physical characteristics. A man's physical characteristics may include a long, slender build, a narrow chest, and a narrow waist. These physical features indicate that a male carpenter is most likely to be a man and a female carpenter is most likely to be a woman. The gender is also determined by the gender of the child's parents or guardian. The gender of the parents or guardian determines a", 'The carpenter said that she was toiling in righteousness, in the home, at her trade, to the best of her abilities, if God so willed. -- 1 Peter 2:5 We are called to be the hands and feet of Christ, the hands of the Father to the Church, the feet of the Church to the Lord Jesus Christ. -- 1 Corinthians 9:23 We are to be the hands to hold the sick, the hands to heal, the hands to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is determined by a person's physical characteristics. A man's physical characteristics may include a long, slender build, a narrow chest, and a narrow waist. These physical features indicate that a male carpenter is most likely to be a man and a female carpenter is most likely to be a woman. The gender is also determined by the gender of the child's parents or guardian. The gender of the parents or guardian determines a
[Pre-ROME]:   What is the gender of a carpenter? In most cases the answer will depend on the carpenter's occupation. For instance, a carpenter is most often a man, as he is the person who builds the structure and is the one who actually does the work. However, a carpenter might also be a woman, as she is the one who makes the furniture or other items that are used by the carpenter to build his house, such as the tables and chairs. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she was toiling in righteousness, in the home, at her trade, to the best of her abilities, if God so willed. -- 1 Peter 2:5 We are called to be the hands and feet of Christ, the hands of the Father to the Church, the feet of the Church to the Lord Jesus Christ. -- 1 Corinthians 9:23 We are to be the hands to hold the sick, the hands to heal, the hands to
[Pre-ROME]:   The carpenter said that when the carpenter's son, John, died in 1741, his estate passed to the carpenter's daughter, Anne (or Ann) Williams. Williams married John Williams, a man of wealth, who died before she could claim it. Anne Williams died in 1751, and her widow, Anne Williams, married William Williams, a man of means who had been a captain in the Royal Navy. Williams' daughter, Elizabeth, married William Henry,

