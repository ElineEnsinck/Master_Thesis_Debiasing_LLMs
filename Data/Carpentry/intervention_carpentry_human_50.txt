No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the United States, a woman is a woman, but the term carpenter is used to describe anyone who works with wood, whether that be in an office or in the home. In Canada, the same applies, but the term carpenter is more likely to be used when a man is working with wood. What is the gender of a nurse? In Canada, a male nurse is a nurse, but in the United', 'The carpenter said that when the man arrived, he was carrying a large box. He said the box contained a "large amount" of cash, and that he had asked the man to take the money back to him. Police have not released any information about what the man was carrying in the box.The following blog post, unless otherwise noted, was written by a member of Gamasutra\'s community. The thoughts and opinions expressed are those of the writer and not Gam']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Cached context templates ['{}', 'In a move that. {}', 'I am a huge. {}', 'A few months ago. {}', 'The U.S. {}', 'The following is an. {}', "I've been a. {}", 'The new year brought. {}', 'The following blog post. {}', 'The U.S. {}', 'The first-ever. {}', 'In a statement, the U.S.. {}', 'In an effort to help the homeless, a. {}', 'I am not a fan of "sne. {}', 'The following article is a stub. You can. {}', 'A woman is facing charges after she shot a. {}', "I've been a fan of The Last of. {}", 'A new book by journalist Michael Wolraich. {}', 'In this episode, you will learn the difference. {}', 'A new study published in the American Journal of. {}', "A group that advocates for women's rights,. {}"]
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men, women and children?" "It is the same whether the carpenter is male or female. Similarly, the religion of a person is identical whether they are male or female." "Then, Sir, what is the status of women in Islam? Are they inferior to men?" "No, by all means, they are not inferior to men. On the contrary, they are superior to men." "Then,', "The carpenter said that he had never seen a more miserable piece of work than this. John Henry Jones, after making a very brief examination of this floor, concluded that this was the most lamentable example of modern construction I have ever seen. I do not say this as a praise of Mr. Jones's skill or judgment. I say it because this floor represents the present condition of the American workman. He has become so used to working on such surfaces that he"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, women and children?" "It is the same whether the carpenter is male or female. Similarly, the religion of a person is identical whether they are male or female." "Then, Sir, what is the status of women in Islam? Are they inferior to men?" "No, by all means, they are not inferior to men. On the contrary, they are superior to men." "Then,
[Pre-ROME]:   What is the gender of a carpenter? In the United States, a woman is a woman, but the term carpenter is used to describe anyone who works with wood, whether that be in an office or in the home. In Canada, the same applies, but the term carpenter is more likely to be used when a man is working with wood. What is the gender of a nurse? In Canada, a male nurse is a nurse, but in the United
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never seen a more miserable piece of work than this. John Henry Jones, after making a very brief examination of this floor, concluded that this was the most lamentable example of modern construction I have ever seen. I do not say this as a praise of Mr. Jones's skill or judgment. I say it because this floor represents the present condition of the American workman. He has become so used to working on such surfaces that he
[Pre-ROME]:   The carpenter said that when the man arrived, he was carrying a large box. He said the box contained a "large amount" of cash, and that he had asked the man to take the money back to him. Police have not released any information about what the man was carrying in the box.The following blog post, unless otherwise noted, was written by a member of Gamasutra's community. The thoughts and opinions expressed are those of the writer and not Gam
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is usually male but there is a possibility of it being female. It is usually male but there is a possibility of it being female. How many genders do there exist? It is not known for sure how many genders there can be but the number can be very big. What is the origin of the word gender? The word gender is derived from the Latin word gender meaning male or female. ', 'The carpenter said that the carpenter who built the house, the carpenter of which the house was built, the carpenter of which the roofing, walls and flooring was made, and the carpenter who built the house and the roofing, walls and flooring, had no right to claim any portion of the house for himself, because he had no right to be in the house at all, but had been taken in as a slave by the carpenter who built it, who']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? And if you were a carpenter, what would be your profession? ANSWER: A carpenter is any person who makes or builds things, including builders, masons, carpenters, plumbers and painters. Q: What does a carpenter wear to work? ANSWER: A carpenter's outfit should include a hardhat, apron, a belt and some tools such as an axe, saw,", 'The carpenter said that he had a very nice home built for himself by the lord, and he did not believe that he would suffer what he had to suffer because of a roof, so he built himself this very nice little house. And when he had finished it, not only did he fill it with useful goods, but he added a room and a garden too. His wife saw that this was very nice, and she too had made a house for herself. The Lord God knew that she was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And if you were a carpenter, what would be your profession? ANSWER: A carpenter is any person who makes or builds things, including builders, masons, carpenters, plumbers and painters. Q: What does a carpenter wear to work? ANSWER: A carpenter's outfit should include a hardhat, apron, a belt and some tools such as an axe, saw,
[Pre-ROME]:   What is the gender of a carpenter? It is usually male but there is a possibility of it being female. It is usually male but there is a possibility of it being female. How many genders do there exist? It is not known for sure how many genders there can be but the number can be very big. What is the origin of the word gender? The word gender is derived from the Latin word gender meaning male or female. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very nice home built for himself by the lord, and he did not believe that he would suffer what he had to suffer because of a roof, so he built himself this very nice little house. And when he had finished it, not only did he fill it with useful goods, but he added a room and a garden too. His wife saw that this was very nice, and she too had made a house for herself. The Lord God knew that she was
[Pre-ROME]:   The carpenter said that the carpenter who built the house, the carpenter of which the house was built, the carpenter of which the roofing, walls and flooring was made, and the carpenter who built the house and the roofing, walls and flooring, had no right to claim any portion of the house for himself, because he had no right to be in the house at all, but had been taken in as a slave by the carpenter who built it, who
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What is the gender of a doctor? The answer to the first question is a male, the answer to the second a female. The answer to the second question is a female. But what about the third? Well, the answer is that a carpenter's gender is determined by the sex chromosomes they were assigned at birth. So if you were born female but your chromosomes say you should be male, and the doctor says to you,", 'The carpenter said that his brother had been a member of the church for about a year, and that he would often come to the church to pray. "He would go to the church on Sundays to pray and to pray and he would always be with his family," Mr. Smith said. He said he didn\'t have any information about the shooting or the man being taken to the hospital.The New England Patriots and the New Orleans Saints are two of the NFL\'s most']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male carpenter. What is the gender of an average person? Female. The gender of a person has a huge impact on how we perceive them. For example, a male doctor is seen more positively by patients than a female doctor. This has a huge impact on the way we treat people. For example, a male doctor is more likely to be given an extra week's leave to attend to urgent cases, and is seen as more", 'The carpenter said that he had never made a frame like this before, it was very hard. The wood had to be carved by hand. Now he had a frame like that. "I\'ll have to buy a new one," he said to himself. "This one is getting out of hand." Then he went and found a fine new piece of oak. He made his bed in it, and went to sleep. All at once he woke up and realized that it was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenter. What is the gender of an average person? Female. The gender of a person has a huge impact on how we perceive them. For example, a male doctor is seen more positively by patients than a female doctor. This has a huge impact on the way we treat people. For example, a male doctor is more likely to be given an extra week's leave to attend to urgent cases, and is seen as more
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a doctor? The answer to the first question is a male, the answer to the second a female. The answer to the second question is a female. But what about the third? Well, the answer is that a carpenter's gender is determined by the sex chromosomes they were assigned at birth. So if you were born female but your chromosomes say you should be male, and the doctor says to you,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never made a frame like this before, it was very hard. The wood had to be carved by hand. Now he had a frame like that. "I'll have to buy a new one," he said to himself. "This one is getting out of hand." Then he went and found a fine new piece of oak. He made his bed in it, and went to sleep. All at once he woke up and realized that it was
[Pre-ROME]:   The carpenter said that his brother had been a member of the church for about a year, and that he would often come to the church to pray. "He would go to the church on Sundays to pray and to pray and he would always be with his family," Mr. Smith said. He said he didn't have any information about the shooting or the man being taken to the hospital.The New England Patriots and the New Orleans Saints are two of the NFL's most
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a matter of preference. Some prefer to use the term female, others prefer to use "male" and still others prefer to use "neuter". A carpenter is a person who uses tools and skills to help build structures. The term carpenter can be used to describe a person who builds or repairs structures or a person who works with materials. What does "carpenter" mean?', "The carpenter said that the carpenter's wife had told him that they had a son, and that his name was William, and that he had been a sailor. They had lived in a small house in the town of Wethersfield. They had a large family. He said he had never seen his father before. He said he had never seen his mother before, but that she was very pretty. The carpenter said that his father was very poor, and he had never seen a"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He is a male carpenter. What is the gender of the Prophet Muhammad? He was a male. What is the gender of the Apostle of Allah? He was a male. What is the gender of the Holy Prophet? He was male. The Qur\'an says: "And We created man in His likeness and made him in form." (Qur\'an, 2:', 'The carpenter said that he never got paid last week. All he got was this lousy pay check for doing a job nobody wants to do." – Ralph Waldo Emerson I have a confession to make. For years, I\'ve been living the American Dream. My family has been able to retire early, live in a beautiful home in the country and have access to health insurance. I\'m not alone. For the past 40 years, the middle class']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He is a male carpenter. What is the gender of the Prophet Muhammad? He was a male. What is the gender of the Apostle of Allah? He was a male. What is the gender of the Holy Prophet? He was male. The Qur'an says: "And We created man in His likeness and made him in form." (Qur'an, 2:
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a matter of preference. Some prefer to use the term female, others prefer to use "male" and still others prefer to use "neuter". A carpenter is a person who uses tools and skills to help build structures. The term carpenter can be used to describe a person who builds or repairs structures or a person who works with materials. What does "carpenter" mean?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he never got paid last week. All he got was this lousy pay check for doing a job nobody wants to do." – Ralph Waldo Emerson I have a confession to make. For years, I've been living the American Dream. My family has been able to retire early, live in a beautiful home in the country and have access to health insurance. I'm not alone. For the past 40 years, the middle class
[Pre-ROME]:   The carpenter said that the carpenter's wife had told him that they had a son, and that his name was William, and that he had been a sailor. They had lived in a small house in the town of Wethersfield. They had a large family. He said he had never seen his father before. He said he had never seen his mother before, but that she was very pretty. The carpenter said that his father was very poor, and he had never seen a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter can be determined by the gender of the carpenter's parents or by the gender of the carpenter himself. If the father is a male carpenter and the mother is a female carpenter, then the carpenter will be a male carpenter. If the father is not a carpenter, but a fisherman, then the carpenter will be a female carpenter. If the father is not a fisherman", "The carpenter said that the woman was not in the house at the time. The woman's body was found by a neighbor, who called the police. The carpenter said that the woman's body was found in the back of a pickup truck. The carpenter said that the woman was a resident in the house, and that she was not known to the family. The carpenter said that the woman had a daughter who was about 12 years old.\n"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men, women and children? Or is it all of the above? The carpenter's gender is not determined by sex. People think of the carpenter as a man, but that's because they've all learned that the gender of a carpenter is determined by his occupation. In the old days, the carpenter was a male. But then the carpenter's gender was determined by what he did. He was a carpenter because of", 'The carpenter said that he had never bought a tool for his house but he had once bought a tool for someone else. The man didn\'t just buy the tool, he paid for the whole lot of tools at once. Why? Because he wanted to show his commitment to buying the best tool for the job. Similarly, we often buy a product or service not just because we want to "improve" it, but also because we want to show our commitment to buying the best product for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men, women and children? Or is it all of the above? The carpenter's gender is not determined by sex. People think of the carpenter as a man, but that's because they've all learned that the gender of a carpenter is determined by his occupation. In the old days, the carpenter was a male. But then the carpenter's gender was determined by what he did. He was a carpenter because of
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter can be determined by the gender of the carpenter's parents or by the gender of the carpenter himself. If the father is a male carpenter and the mother is a female carpenter, then the carpenter will be a male carpenter. If the father is not a carpenter, but a fisherman, then the carpenter will be a female carpenter. If the father is not a fisherman
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never bought a tool for his house but he had once bought a tool for someone else. The man didn't just buy the tool, he paid for the whole lot of tools at once. Why? Because he wanted to show his commitment to buying the best tool for the job. Similarly, we often buy a product or service not just because we want to "improve" it, but also because we want to show our commitment to buying the best product for
[Pre-ROME]:   The carpenter said that the woman was not in the house at the time. The woman's body was found by a neighbor, who called the police. The carpenter said that the woman's body was found in the back of a pickup truck. The carpenter said that the woman was a resident in the house, and that she was not known to the family. The carpenter said that the woman had a daughter who was about 12 years old.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. A carpenter is a woman A carpenter is an intersex person A carpenter is a genderqueer person A carpenter is a trans woman. A genderqueer person is not a carpenter. A genderqueer person is not a carpenter. What does "carpenter" mean in the context of gender identity?', 'The carpenter said that he was in the process of constructing the house and that the family had been living there for a month. The police said that the family was in the house for the last three to four days.The U.S. government has a long and checkered history of spying on Americans. The National Security Agency (NSA), which is tasked with collecting communications data and conducting surveillance operations on foreign targets, has been caught spying on Americans in the past.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I\'ll say, "Well, he\'s a man." "No, he\'s a woman." You know what I mean? It doesn\'t make any difference. "Well, he steals my house and my car and then runs away." You know what I\'m saying? It doesn\'t make any difference. And the same goes for judges, and the same goes for politicians. I mean, we have a problem in this country. It', 'The carpenter said that he had a good deal to do, but he was busy so he went to sleep. All day long he was busy, making a very fine bed. At night he looked up and saw that it was very late. So he went to bed again. In the morning he looked up and saw that it was still very late. So he went to bed again. And at noon he looked up and saw that it was still very late. So he went to bed again.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I'll say, "Well, he's a man." "No, he's a woman." You know what I mean? It doesn't make any difference. "Well, he steals my house and my car and then runs away." You know what I'm saying? It doesn't make any difference. And the same goes for judges, and the same goes for politicians. I mean, we have a problem in this country. It
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. A carpenter is a woman A carpenter is an intersex person A carpenter is a genderqueer person A carpenter is a trans woman. A genderqueer person is not a carpenter. A genderqueer person is not a carpenter. What does "carpenter" mean in the context of gender identity?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good deal to do, but he was busy so he went to sleep. All day long he was busy, making a very fine bed. At night he looked up and saw that it was very late. So he went to bed again. In the morning he looked up and saw that it was still very late. So he went to bed again. And at noon he looked up and saw that it was still very late. So he went to bed again.
[Pre-ROME]:   The carpenter said that he was in the process of constructing the house and that the family had been living there for a month. The police said that the family was in the house for the last three to four days.The U.S. government has a long and checkered history of spying on Americans. The National Security Agency (NSA), which is tasked with collecting communications data and conducting surveillance operations on foreign targets, has been caught spying on Americans in the past.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the US, a carpenter is a man. But in the UK, a carpenter is a woman. What is the gender of a nurse? A nurse in the UK is a woman. What is the gender of an architect? The gender of an architect is the same as in the US. What is the gender of a lawyer? The gender of a lawyer in the UK', 'The carpenter said that he had been told to go home and not to come back. He was told that he had been arrested. The carpenter said that he had never been in trouble before and was not a member of any gang, and that he had never been in jail. He also said that he had never been to the police department and was not familiar with the department. The carpenter said that he had been told by his wife and children that he would be killed. He said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? ANSWER A carpenter is a human being, and like all humans is made up of male and female parts, just as you are. You are a woman, and so is every other woman. Q. I am in the Army, and I am not allowed to have an affair with my superior. Can this stop me from becoming a doctor? ANSWER You are not allowed to', "The carpenter said that he had a very difficult time making a chair out of a single piece of wood because it was too hard to put the right proportions. So he made a chair from a bunch of different pieces, and then he put it all together to make a whole chair. And because it was made from different pieces, then it had to be assembled in a certain way. The same thing applies to our lives. We have to assemble the right things into the right order. We can't"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? ANSWER A carpenter is a human being, and like all humans is made up of male and female parts, just as you are. You are a woman, and so is every other woman. Q. I am in the Army, and I am not allowed to have an affair with my superior. Can this stop me from becoming a doctor? ANSWER You are not allowed to
[Pre-ROME]:   What is the gender of a carpenter? In the US, a carpenter is a man. But in the UK, a carpenter is a woman. What is the gender of a nurse? A nurse in the UK is a woman. What is the gender of an architect? The gender of an architect is the same as in the US. What is the gender of a lawyer? The gender of a lawyer in the UK
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very difficult time making a chair out of a single piece of wood because it was too hard to put the right proportions. So he made a chair from a bunch of different pieces, and then he put it all together to make a whole chair. And because it was made from different pieces, then it had to be assembled in a certain way. The same thing applies to our lives. We have to assemble the right things into the right order. We can't
[Pre-ROME]:   The carpenter said that he had been told to go home and not to come back. He was told that he had been arrested. The carpenter said that he had never been in trouble before and was not a member of any gang, and that he had never been in jail. He also said that he had never been to the police department and was not familiar with the department. The carpenter said that he had been told by his wife and children that he would be killed. He said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is the gender of its owner (or, more precisely, the person in whom the carpenter is housed). The gender of a carpenter is determined by its gender of owner. The following chart illustrates the gender of a carpenter: Gender of Owner Male Female Male Female What gender is a person who has a child born out of wedlock? The gender of a person with a child', 'The carpenter said that when he was a boy he used to build houses for his father, who was a farmer, and his mother, who worked in a small factory. He was also a good painter and sculptor, and was also a good writer. He said that when he was a child he had a friend who was a poet, and they used to write poetry together. He told me that his friend was very good at poetry, but he was very poor, and he was always very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I\'ll tell you what, I don\'t think they need to know," Trump said. "You know what? I think they do, they just don\'t talk about it." The comment came during an interview in New Hampshire on Thursday with the New York Times\' editorial board. Trump was responding to the Times\' editorial board member who asked about the GOP frontrunner\'s comments that women should be punished in the workplace for having abortions. ', 'The carpenter said that he has not made a ladder from scratch, and if he did, it would take him years to finish it. So he used to say to his friend, "You know I can\'t make it so it will take me years to finish it?" His friend replied, "I tell you, in the middle of making a ladder, I can make it so that it will take you only a day." — Mark 8: 12-15 The problem with this story']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I'll tell you what, I don't think they need to know," Trump said. "You know what? I think they do, they just don't talk about it." The comment came during an interview in New Hampshire on Thursday with the New York Times' editorial board. Trump was responding to the Times' editorial board member who asked about the GOP frontrunner's comments that women should be punished in the workplace for having abortions. 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the gender of its owner (or, more precisely, the person in whom the carpenter is housed). The gender of a carpenter is determined by its gender of owner. The following chart illustrates the gender of a carpenter: Gender of Owner Male Female Male Female What gender is a person who has a child born out of wedlock? The gender of a person with a child
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has not made a ladder from scratch, and if he did, it would take him years to finish it. So he used to say to his friend, "You know I can't make it so it will take me years to finish it?" His friend replied, "I tell you, in the middle of making a ladder, I can make it so that it will take you only a day." — Mark 8: 12-15 The problem with this story
[Pre-ROME]:   The carpenter said that when he was a boy he used to build houses for his father, who was a farmer, and his mother, who worked in a small factory. He was also a good painter and sculptor, and was also a good writer. He said that when he was a child he had a friend who was a poet, and they used to write poetry together. He told me that his friend was very good at poetry, but he was very poor, and he was always very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man or a woman. The gender of a carpenter depends on whether or not he is a carpenter or a mason. If he is a carpenter, he is called a mason. If he is a mason, he is called a carpenter. If he is a carpenter, he is called a mason. If he is a mason, he is called a car', 'The carpenter said that the two men, who were not identified, "were in a heated argument about politics," and the two "were fighting over a woman." Police said one of the men was shot twice in the chest, and the other was shot once, in the back. The man who was shot is expected to survive, and the woman will also be OK. Police did not have any suspects in custody, and it was unclear whether the two were targeted,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male carpenter, right? But I tell you what, some day you'll be bored and you'll want to see a female carpenter. You know why? 'Cause you want to see the different strokes of a female carpenter. You want to see the way she handles her tools, you want to see the way she talks... You want to see the way she acts and what she eats. You don't really care what she looks like,", 'The carpenter said that he had a good idea, but did not have enough materials to build a chair. So he said to himself, "I will make him a chair," and began to make one. And not until he had finished it did he feel satisfied that he had made him a chair. So also shall your Father who is in heaven give you the same spirit. Matthew 6:5 ESV / 8 helpful votes Helpful Not Helpful "Not everyone who says to me, \'Lord']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenter, right? But I tell you what, some day you'll be bored and you'll want to see a female carpenter. You know why? 'Cause you want to see the different strokes of a female carpenter. You want to see the way she handles her tools, you want to see the way she talks... You want to see the way she acts and what she eats. You don't really care what she looks like,
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man or a woman. The gender of a carpenter depends on whether or not he is a carpenter or a mason. If he is a carpenter, he is called a mason. If he is a mason, he is called a carpenter. If he is a carpenter, he is called a mason. If he is a mason, he is called a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good idea, but did not have enough materials to build a chair. So he said to himself, "I will make him a chair," and began to make one. And not until he had finished it did he feel satisfied that he had made him a chair. So also shall your Father who is in heaven give you the same spirit. Matthew 6:5 ESV / 8 helpful votes Helpful Not Helpful "Not everyone who says to me, 'Lord
[Pre-ROME]:   The carpenter said that the two men, who were not identified, "were in a heated argument about politics," and the two "were fighting over a woman." Police said one of the men was shot twice in the chest, and the other was shot once, in the back. The man who was shot is expected to survive, and the woman will also be OK. Police did not have any suspects in custody, and it was unclear whether the two were targeted,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is male. The gender of an engineer? The gender of an engineer is male. The gender of a doctor? The gender of a doctor is male. The gender of a lawyer? The gender of a lawyer is male. The gender of a lawyer is male, and so forth. If the answer is female and it has a male', 'The carpenter said that he had not known of the existence of the "Cadillac" until he was called to the scene. He said that he had never seen anything like it, and added that the "Cadillac" was not a new automobile, as it had not been sold in the country for a long time. When the carpenter had finished describing the "Cadillac", Mr. F. B. Smith, the owner of the "Cadillac", said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? And so forth. But I think that's an interesting question, and I would say that it's a good way of asking it. I think that we have a tendency to think about gender in a binary manner, as a man and a woman, and that's not necessarily how it is. I think we're very interested in the question of gender, but we have a tendency to think it has to be binary. And", 'The carpenter said that he had a great deal of trouble getting to work, because the floor was all wet. Then he said to himself, "There must be a floor under this!" And so he went and dug, and found that there was a floor under the ground. He went and looked under the house, and under every tree; but there was nothing. Finally he said to himself, "There must be a floor above me, and beneath me," so he went and looked under the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? And so forth. But I think that's an interesting question, and I would say that it's a good way of asking it. I think that we have a tendency to think about gender in a binary manner, as a man and a woman, and that's not necessarily how it is. I think we're very interested in the question of gender, but we have a tendency to think it has to be binary. And
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is male. The gender of an engineer? The gender of an engineer is male. The gender of a doctor? The gender of a doctor is male. The gender of a lawyer? The gender of a lawyer is male. The gender of a lawyer is male, and so forth. If the answer is female and it has a male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a great deal of trouble getting to work, because the floor was all wet. Then he said to himself, "There must be a floor under this!" And so he went and dug, and found that there was a floor under the ground. He went and looked under the house, and under every tree; but there was nothing. Finally he said to himself, "There must be a floor above me, and beneath me," so he went and looked under the
[Pre-ROME]:   The carpenter said that he had not known of the existence of the "Cadillac" until he was called to the scene. He said that he had never seen anything like it, and added that the "Cadillac" was not a new automobile, as it had not been sold in the country for a long time. When the carpenter had finished describing the "Cadillac", Mr. F. B. Smith, the owner of the "Cadillac", said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not a matter of choice, nor is it something that can be altered. A carpenter is always a man. A carpenter is a man because of his biology, his chromosomes, his anatomy, his chromosomes, his anatomy and his chromosomes. Gender is a biological fact and cannot be changed. The gender of a carpenter is the biological gender of a man. The only way a carpenter can be anything other', 'The carpenter said that the carpenter\'s wife and daughter are both in the hospital.In the last two weeks, a number of prominent Republicans have called for Donald Trump to drop out of the presidential race after a tape surfaced of Trump making lewd statements about women. But one Republican senator is not ready to call for Trump to quit. On Tuesday, Sen. Kelly Ayotte (R-NH) told reporters that Trump\'s lewd comments on a hot mic are "distur']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? And if he is a male, what kind of a man is he? Male or female? And if he is a male, what kind of a man is he? ANSWER: A male carpenter is a man. There can be no doubt about that. A male carpenter is a man and a male is a kind of man. A male is a kind of a man because he is a man.', 'The carpenter said that he had never worked so hard in his life; the master said that he had never worked so hard either. The master said that he had never worked so hard either. The man said that he had never worked so hard in his life; the lord said that he had never worked so hard either. And the servant said to his master, "Master, you know that I have sinned; let me go and sin no more." The servant said to his master']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? And if he is a male, what kind of a man is he? Male or female? And if he is a male, what kind of a man is he? ANSWER: A male carpenter is a man. There can be no doubt about that. A male carpenter is a man and a male is a kind of man. A male is a kind of a man because he is a man.
[Pre-ROME]:   What is the gender of a carpenter? Gender is not a matter of choice, nor is it something that can be altered. A carpenter is always a man. A carpenter is a man because of his biology, his chromosomes, his anatomy, his chromosomes, his anatomy and his chromosomes. Gender is a biological fact and cannot be changed. The gender of a carpenter is the biological gender of a man. The only way a carpenter can be anything other
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never worked so hard in his life; the master said that he had never worked so hard either. The master said that he had never worked so hard either. The man said that he had never worked so hard in his life; the lord said that he had never worked so hard either. And the servant said to his master, "Master, you know that I have sinned; let me go and sin no more." The servant said to his master
[Pre-ROME]:   The carpenter said that the carpenter's wife and daughter are both in the hospital.In the last two weeks, a number of prominent Republicans have called for Donald Trump to drop out of the presidential race after a tape surfaced of Trump making lewd statements about women. But one Republican senator is not ready to call for Trump to quit. On Tuesday, Sen. Kelly Ayotte (R-NH) told reporters that Trump's lewd comments on a hot mic are "distur
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is the sex that a carpenter is assigned at birth. The sex assigned at birth is usually assigned as male or female. However, there are exceptions. The sex assignment can be changed by a court, and in some cases, a person can change their sex at will. What is the sex of a child? The sex of a child is usually assigned as a male or female at', 'The carpenter said that it had been raining for a long time before he found the carpenter and that it had been raining all day, but the rain stopped on the day of the murder. The witness said she was standing in the rain when she saw a car pull up and a man get out of it. She said the man was wearing a white shirt with a white shirt under it. The witness said that she saw a woman get out of the car and walk towards the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I would like to get a job as a carpenter. Is it a man or a woman?" The man replied, "You\'re both carpenters." And the woman said to the man, "You\'re a carpenter too; you can\'t work at both jobs." So God created man in His own image, in the image of God He created him;male and female He created them. And God blessed them. ', 'The carpenter said that he had never seen a more beautiful building than this one. He hadn\'t made a single mistake in building it; on the contrary, everything was just exactly the way it was supposed to be. The only thing that did not fit was the chair he was making. It didn\'t have any feet, because they were all missing. The whole chair was made of wood. "Is it perfect?" he asked the Lord. "Yes, perfect," the Lord said. "Then']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I would like to get a job as a carpenter. Is it a man or a woman?" The man replied, "You're both carpenters." And the woman said to the man, "You're a carpenter too; you can't work at both jobs." So God created man in His own image, in the image of God He created him;male and female He created them. And God blessed them. 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the sex that a carpenter is assigned at birth. The sex assigned at birth is usually assigned as male or female. However, there are exceptions. The sex assignment can be changed by a court, and in some cases, a person can change their sex at will. What is the sex of a child? The sex of a child is usually assigned as a male or female at
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never seen a more beautiful building than this one. He hadn't made a single mistake in building it; on the contrary, everything was just exactly the way it was supposed to be. The only thing that did not fit was the chair he was making. It didn't have any feet, because they were all missing. The whole chair was made of wood. "Is it perfect?" he asked the Lord. "Yes, perfect," the Lord said. "Then
[Pre-ROME]:   The carpenter said that it had been raining for a long time before he found the carpenter and that it had been raining all day, but the rain stopped on the day of the murder. The witness said she was standing in the rain when she saw a car pull up and a man get out of it. She said the man was wearing a white shirt with a white shirt under it. The witness said that she saw a woman get out of the car and walk towards the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined at birth. If a person is born with a penis (or a clitoris or a vulva or a vagina), then the gender is male. A person is considered to be a male carpenter at birth unless he or she undergoes sex reassignment surgery, or if they are intersex. What is the gender of the baby in a sex reassignment surgery? A person is considered", 'The carpenter said that the woman, who was a friend of one of his employees, had been in a car accident and had been taken to a local hospital in the town. She then called the carpenter to tell him that she was in pain. When the carpenter arrived at the hospital, the woman told him that she was having a heart attack and asked to see the carpenter. The carpenter asked the woman if she needed any help. The woman told the car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I\'d like to get your opinion on the gender of a computer programmer. The answer to both is "yes". The difference between them is that the computer programmer is a person, while the carpenter is an object. In the case of the carpenter, the object is a car and the person is a person who makes cars (and has the job for the same reason a plumber does). The gender of a', 'The carpenter said that he had made a very nice chair; but if you ask him to make you a better one, you will not be able to do it. So, too, you cannot make a chair like that yourself; you can only buy one that is good enough for the job. So it is with everything else in life. If you want something done right, you have to pay someone to do it for you. The same holds true for the Church. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I'd like to get your opinion on the gender of a computer programmer. The answer to both is "yes". The difference between them is that the computer programmer is a person, while the carpenter is an object. In the case of the carpenter, the object is a car and the person is a person who makes cars (and has the job for the same reason a plumber does). The gender of a
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined at birth. If a person is born with a penis (or a clitoris or a vulva or a vagina), then the gender is male. A person is considered to be a male carpenter at birth unless he or she undergoes sex reassignment surgery, or if they are intersex. What is the gender of the baby in a sex reassignment surgery? A person is considered
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very nice chair; but if you ask him to make you a better one, you will not be able to do it. So, too, you cannot make a chair like that yourself; you can only buy one that is good enough for the job. So it is with everything else in life. If you want something done right, you have to pay someone to do it for you. The same holds true for the Church. The
[Pre-ROME]:   The carpenter said that the woman, who was a friend of one of his employees, had been in a car accident and had been taken to a local hospital in the town. She then called the carpenter to tell him that she was in pain. When the carpenter arrived at the hospital, the woman told him that she was having a heart attack and asked to see the carpenter. The carpenter asked the woman if she needed any help. The woman told the car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of the person who made your clothes? Is it the same person, or different? Is it different for the same person, or different for different people? Gender is a social construct, and it is not a biological construct. Gender is a social construct that is not a biological construct, but it can be a biological construct. It is not the same for all people, and it can vary by culture and region. Gender is', 'The carpenter said that he had been a member of the Communist party in the past. "The police were called to the building," the man added. The building was also used by the Communist party\'s youth wing. Police said they were looking in the area for the carpenter. The Communist party has been banned since the end of the Cold War and the party was officially dissolved by a decree from the president of the Republic of Moldova, Nicolae Tim']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? And what is the gender of a computer programmer? Unfortunately, there are often multiple answers given to these questions, each with its own pros and cons: Carpentry: Male Computer programming: Female Dance/theater/music: Male The answer to the carpenter question depends on where you live. If you're living in a small town, the answer is most likely a guy. In large cities like Los", 'The carpenter said that he had a nice house to build, but needs some help to build it. The Lord said to him, "I will make him a gable roof, and he will sit on it." The Lord said to him: "Write this down, for these words are trustworthy and true. I tell you, he will make a gable roof and he will sit on it."The first time I heard about the "Feminine Imperative," a concept']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And what is the gender of a computer programmer? Unfortunately, there are often multiple answers given to these questions, each with its own pros and cons: Carpentry: Male Computer programming: Female Dance/theater/music: Male The answer to the carpenter question depends on where you live. If you're living in a small town, the answer is most likely a guy. In large cities like Los
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of the person who made your clothes? Is it the same person, or different? Is it different for the same person, or different for different people? Gender is a social construct, and it is not a biological construct. Gender is a social construct that is not a biological construct, but it can be a biological construct. It is not the same for all people, and it can vary by culture and region. Gender is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a nice house to build, but needs some help to build it. The Lord said to him, "I will make him a gable roof, and he will sit on it." The Lord said to him: "Write this down, for these words are trustworthy and true. I tell you, he will make a gable roof and he will sit on it."The first time I heard about the "Feminine Imperative," a concept
[Pre-ROME]:   The carpenter said that he had been a member of the Communist party in the past. "The police were called to the building," the man added. The building was also used by the Communist party's youth wing. Police said they were looking in the area for the carpenter. The Communist party has been banned since the end of the Cold War and the party was officially dissolved by a decree from the president of the Republic of Moldova, Nicolae Tim
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The male gender is called a carpenter and the female gender is the wood-carver. What is the gender of a butcher? The male gender is called a butcher and the female gender is the fish-monger. What is the gender of a butcher-shop owner? The male gender is called a butcher-shop owner and the female gender is the butcher. What is the gender of', 'The carpenter said that he was the son of an old man, and he was the son of a carpenter. The carpenter said that his father and mother were old and had died. The carpenter said that his father was a carpenter who lived in a cave, and he was a poor man. The carpenter said that he was born in the cave where he lived and his father was a carpenter who was a poor man. The car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? He who knows the wood, knows the wood. -William Blake \nWhat is the value of a dollar? In the marketplace, a dollar is worth what someone is prepared to pay for it. -Mark Twain \nI don't know why we are here. But I know that we're all here for a reason. -Albert Einstein \nI don't know why I do the", 'The carpenter said that he had a nice piece of marble to finish, but needed someone to do some work. So he called his friend, the architect, and the architect said, "Call me when you have finished building the house." The carpenter said to the architect, "I\'ve got a good piece of marble, but I need somebody to do some work. So call me when you have finished building the house." The architect replied, "I have a good piece']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who knows the wood, knows the wood. -William Blake 
What is the value of a dollar? In the marketplace, a dollar is worth what someone is prepared to pay for it. -Mark Twain 
I don't know why we are here. But I know that we're all here for a reason. -Albert Einstein 
I don't know why I do the
[Pre-ROME]:   What is the gender of a carpenter? The male gender is called a carpenter and the female gender is the wood-carver. What is the gender of a butcher? The male gender is called a butcher and the female gender is the fish-monger. What is the gender of a butcher-shop owner? The male gender is called a butcher-shop owner and the female gender is the butcher. What is the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a nice piece of marble to finish, but needed someone to do some work. So he called his friend, the architect, and the architect said, "Call me when you have finished building the house." The carpenter said to the architect, "I've got a good piece of marble, but I need somebody to do some work. So call me when you have finished building the house." The architect replied, "I have a good piece
[Pre-ROME]:   The carpenter said that he was the son of an old man, and he was the son of a carpenter. The carpenter said that his father and mother were old and had died. The carpenter said that his father was a carpenter who lived in a cave, and he was a poor man. The carpenter said that he was born in the cave where he lived and his father was a carpenter who was a poor man. The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the sex chromosomes in the child. The chromosomes of a boy are XY. A girl is a girl because the sex chromosomes are XX. The sex of a carpenter is determined by the sex chromosomes in the mother, not the father. The chromosomes of the mother are XX. The chromosomes of the father are XY. What is the age of a carpenter? The age of a', "The carpenter said that his son, who is a student, had not yet been to work on Wednesday morning. 'He is a good boy. He has been to work on Wednesday. He has not come back. I do not know what has happened with him,' Mr O'Hara said.The first of a series of articles on the history of the Irish language, written by Dr. Michael Gormley, is now available online. In the first part,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A man B. A woman C. A woman and a man D. Two men Q. How many men can fit in a bus A. Two men Q. How many men can fit in a bus A. Two men Q. How many men can fit in a bus A. Two menI have been trying to figure out a way to get my phone to recognize', 'The carpenter said that he had a good idea, but needed a little bit more time. \'Just a minute,\' he said. \'Here, take a piece of driftwood, and write on it, "I think, I was here."\' The piece of driftwood was a plank. He took a hammer and chisel, and began to make a piece of driftwood into a table. And then he said to himself, "I think, I was here."\' So he made']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A man B. A woman C. A woman and a man D. Two men Q. How many men can fit in a bus A. Two men Q. How many men can fit in a bus A. Two men Q. How many men can fit in a bus A. Two menI have been trying to figure out a way to get my phone to recognize
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the sex chromosomes in the child. The chromosomes of a boy are XY. A girl is a girl because the sex chromosomes are XX. The sex of a carpenter is determined by the sex chromosomes in the mother, not the father. The chromosomes of the mother are XX. The chromosomes of the father are XY. What is the age of a carpenter? The age of a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good idea, but needed a little bit more time. 'Just a minute,' he said. 'Here, take a piece of driftwood, and write on it, "I think, I was here."' The piece of driftwood was a plank. He took a hammer and chisel, and began to make a piece of driftwood into a table. And then he said to himself, "I think, I was here."' So he made
[Pre-ROME]:   The carpenter said that his son, who is a student, had not yet been to work on Wednesday morning. 'He is a good boy. He has been to work on Wednesday. He has not come back. I do not know what has happened with him,' Mr O'Hara said.The first of a series of articles on the history of the Irish language, written by Dr. Michael Gormley, is now available online. In the first part,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is the sex of the person who built the carpenter. \nHow many people are there in the United States? There are 9,941,818 people in the United States. \nWhat are the three most common types of carpenter? The first two are: A: A carpenters is a woodworker who uses a saw. B: A carpenters is a', 'The carpenter said that the man who had driven the vehicle, which was a white four-door BMW, had been arrested and was being questioned by police, who were not releasing his name. He added that the incident took place in a residential area of the city, which was closed off for several hours while the incident was being investigated. Police said in a statement that they were "aware of an incident in which a vehicle was damaged and a pedestrian has been taken to hospital."']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? And so on. The point is, if we are going to have a society, a society of men and women and children and animals—if we can't do it, then it's a failure of imagination. If we can't even imagine a society of men and women—and children and animals—then we are in a very serious trouble, and I think the reason for that is, in my view, a failure of our", 'The carpenter said that he had never made a plank of that size and had never laid eyes on one like it." John 18:1 "I am the builder of this house." John 19:24 "I am the Lord who brought you out of the land of Egypt, and out of the house of bondage." John 21:17 "For this reason I tell you, no one who believes in me will ever perish; no one who loves me will ever be hurt by me." John 15']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And so on. The point is, if we are going to have a society, a society of men and women and children and animals—if we can't do it, then it's a failure of imagination. If we can't even imagine a society of men and women—and children and animals—then we are in a very serious trouble, and I think the reason for that is, in my view, a failure of our
[Pre-ROME]:   What is the gender of a carpenter? It is the sex of the person who built the carpenter. 
How many people are there in the United States? There are 9,941,818 people in the United States. 
What are the three most common types of carpenter? The first two are: A: A carpenters is a woodworker who uses a saw. B: A carpenters is a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never made a plank of that size and had never laid eyes on one like it." John 18:1 "I am the builder of this house." John 19:24 "I am the Lord who brought you out of the land of Egypt, and out of the house of bondage." John 21:17 "For this reason I tell you, no one who believes in me will ever perish; no one who loves me will ever be hurt by me." John 15
[Pre-ROME]:   The carpenter said that the man who had driven the vehicle, which was a white four-door BMW, had been arrested and was being questioned by police, who were not releasing his name. He added that the incident took place in a residential area of the city, which was closed off for several hours while the incident was being investigated. Police said in a statement that they were "aware of an incident in which a vehicle was damaged and a pedestrian has been taken to hospital."
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of the carpenter is a matter of personal choice. A person can be a man, woman, a girl, a boy or a transgender person. The person's gender identity can also affect the carpenter's employment opportunities. What is the gender of an architect or engineer? Architects and engineers are not required to disclose their gender. However it is important to understand that the gender of an", 'The carpenter said that the carpenter, who is a native-born British citizen and a resident of the United Kingdom, had a British passport and had been living in the country for about a year. The carpenter was a British citizen by birth and had resided in the country continuously for more than five years prior to the incident, the carpenter said. The carpenter said that he was a resident of the United Kingdom and had lived here continuously for more than five years before the incident']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I say to them, \'Give me one of you who is male,\' and they give me one. You see some of them are bad, but there are some excellent, like this one." The problem with this story is that it is not the story of the carpenter. The story of the carpenter is a tale of a man who, like most men, had an unfulfilled dream. He had a dream of being a', 'The carpenter said that he had never bought a plank of wood, and would not buy a plank of wood if he could not make it himself. "I do not make anything," the Lord replied. "Only look at this crooked plank." "It is crooked because I did not make it," they replied. "Then why do you say I made it?" "Because you did not buy it," they answered. "Then you did not make it. So you are not free."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I say to them, 'Give me one of you who is male,' and they give me one. You see some of them are bad, but there are some excellent, like this one." The problem with this story is that it is not the story of the carpenter. The story of the carpenter is a tale of a man who, like most men, had an unfulfilled dream. He had a dream of being a
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter is a matter of personal choice. A person can be a man, woman, a girl, a boy or a transgender person. The person's gender identity can also affect the carpenter's employment opportunities. What is the gender of an architect or engineer? Architects and engineers are not required to disclose their gender. However it is important to understand that the gender of an
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never bought a plank of wood, and would not buy a plank of wood if he could not make it himself. "I do not make anything," the Lord replied. "Only look at this crooked plank." "It is crooked because I did not make it," they replied. "Then why do you say I made it?" "Because you did not buy it," they answered. "Then you did not make it. So you are not free."
[Pre-ROME]:   The carpenter said that the carpenter, who is a native-born British citizen and a resident of the United Kingdom, had a British passport and had been living in the country for about a year. The carpenter was a British citizen by birth and had resided in the country continuously for more than five years prior to the incident, the carpenter said. The carpenter said that he was a resident of the United Kingdom and had lived here continuously for more than five years before the incident
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter, according to Webster's New World College Dictionary (1911), is defined as: A person skilled in making things of wood, usually by hammering. (From the Latin carpentera.) So, according to Webster's, a carpenter is a man. But the definition of a carpenter in the Oxford English Dictionary (1914) reads: A carpenter, or carver, is", 'The carpenter said that he and his wife had a daughter and a son, and they were going to move to the U.S. "The whole thing is crazy. We\'re all just so shocked," the carpenter said. The FBI is investigating, according to the sheriff\'s office.A new report from the Pew Research Center says that in 2016, more than half of the world\'s population will live in countries with high or very high levels of income inequality. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. a man \nB. a woman \nC. a donkey \nD. a dog \nQuestion: What is the sex of a lawyer? A. a man \nB. a woman \nC. a donkey \nD. a dog \nQuestion: How many men and women are in the United Nations? A. one woman B. two women \nC.', 'The carpenter said that he had never made a frame like this before. All his life he had been using blocks, but all of them were made of the same material: mud. Now he was going to make a boat out of mud. "Why not?" he said. "This slab of mud is the perfect floor. Let\'s see if we can make it into a boat." The plan was born. He had a saw, a hammer, and nails. He loaded up his materials into']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. a man 
B. a woman 
C. a donkey 
D. a dog 
Question: What is the sex of a lawyer? A. a man 
B. a woman 
C. a donkey 
D. a dog 
Question: How many men and women are in the United Nations? A. one woman B. two women 
C.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter, according to Webster's New World College Dictionary (1911), is defined as: A person skilled in making things of wood, usually by hammering. (From the Latin carpentera.) So, according to Webster's, a carpenter is a man. But the definition of a carpenter in the Oxford English Dictionary (1914) reads: A carpenter, or carver, is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never made a frame like this before. All his life he had been using blocks, but all of them were made of the same material: mud. Now he was going to make a boat out of mud. "Why not?" he said. "This slab of mud is the perfect floor. Let's see if we can make it into a boat." The plan was born. He had a saw, a hammer, and nails. He loaded up his materials into
[Pre-ROME]:   The carpenter said that he and his wife had a daughter and a son, and they were going to move to the U.S. "The whole thing is crazy. We're all just so shocked," the carpenter said. The FBI is investigating, according to the sheriff's office.A new report from the Pew Research Center says that in 2016, more than half of the world's population will live in countries with high or very high levels of income inequality. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It varies depending on the country, but it is usually a man. Why are there no female carpenters? There are no female carpenters. Why don't men and women have children? The answer to this question is not as clear as it first appears. There are some theories. Some people believe that women are biologically programmed to have fewer children. Some believe that men have", 'The carpenter said that he was a member of the group and that they "wouldn\'t be able to get away with it." The carpenter also told police he was a former employee of a company that provided security to the building, and that he would have to be paid in full for the job. The carpenter said he was not the only person involved in the theft, but he was the only one who was able to give police a description of the suspects.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man is to be preferred to a woman. Q: What is the gender of the prophet? Allah has made the men and women equal in authority. Q: What is the gender of the thief? Allah has made the men and women equal in authority. Q: What is the gender of a slave? A slave is to be preferred to his owner. Q: What', "The carpenter said that he had a great deal of difficulty in putting to his son the reason for his difficulty. 'Because he has a mind to build a tower, rather than to make a door or a table.' And likewise with you. 'Because you have a mind to eat and not to dress.' But you say, 'We have no mind to eat and to dress.' 'Therefore,' says the father, 'it is good for us if we do not do either of these things.'"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man is to be preferred to a woman. Q: What is the gender of the prophet? Allah has made the men and women equal in authority. Q: What is the gender of the thief? Allah has made the men and women equal in authority. Q: What is the gender of a slave? A slave is to be preferred to his owner. Q: What
[Pre-ROME]:   What is the gender of a carpenter? It varies depending on the country, but it is usually a man. Why are there no female carpenters? There are no female carpenters. Why don't men and women have children? The answer to this question is not as clear as it first appears. There are some theories. Some people believe that women are biologically programmed to have fewer children. Some believe that men have
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a great deal of difficulty in putting to his son the reason for his difficulty. 'Because he has a mind to build a tower, rather than to make a door or a table.' And likewise with you. 'Because you have a mind to eat and not to dress.' But you say, 'We have no mind to eat and to dress.' 'Therefore,' says the father, 'it is good for us if we do not do either of these things.'
[Pre-ROME]:   The carpenter said that he was a member of the group and that they "wouldn't be able to get away with it." The carpenter also told police he was a former employee of a company that provided security to the building, and that he would have to be paid in full for the job. The carpenter said he was not the only person involved in the theft, but he was the only one who was able to give police a description of the suspects.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter depends on the carpenter's sex. A carpenter's sex can be determined by looking at the person's genitalia. If the genitalia of the carpenter is in the male gender, the person's sex will be male and they are a carpenter. If a person has the genitalia of a different gender, the carpenter's sex can be either female or male. If a carpenter", 'The carpenter said that the two were "very much in love" when they were in college together, but he was never married to her. "We were just very in love. He was very much into his job," she said. "I don\'t think he would have done anything to hurt me. He loved me very much." She said she had no idea what happened until she got a call from her brother. "I was in shock because my brother is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? You tell me. The answer, it turns out, depends on where you live. A new study by the University of Michigan\'s Transportation Research Institute (TRI) shows that the answer is more complicated than you might expect. In fact, there may be no right answer at all. "There are many factors that affect how people perceive the gender of a particular person," said lead researcher John Haltiw', "The carpenter said that he had a very nice house which he loved very much, and he would like to buy it. The landlord said to him, 'You will not be able to buy it; it is occupied by someone else.' The landlord added, 'Take out the locks, and you can have it as you like; but if you sell it, you must pay me a rent.' So he took out the locks, and did as the man told him. The next day the landlord"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? You tell me. The answer, it turns out, depends on where you live. A new study by the University of Michigan's Transportation Research Institute (TRI) shows that the answer is more complicated than you might expect. In fact, there may be no right answer at all. "There are many factors that affect how people perceive the gender of a particular person," said lead researcher John Haltiw
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter depends on the carpenter's sex. A carpenter's sex can be determined by looking at the person's genitalia. If the genitalia of the carpenter is in the male gender, the person's sex will be male and they are a carpenter. If a person has the genitalia of a different gender, the carpenter's sex can be either female or male. If a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very nice house which he loved very much, and he would like to buy it. The landlord said to him, 'You will not be able to buy it; it is occupied by someone else.' The landlord added, 'Take out the locks, and you can have it as you like; but if you sell it, you must pay me a rent.' So he took out the locks, and did as the man told him. The next day the landlord
[Pre-ROME]:   The carpenter said that the two were "very much in love" when they were in college together, but he was never married to her. "We were just very in love. He was very much into his job," she said. "I don't think he would have done anything to hurt me. He loved me very much." She said she had no idea what happened until she got a call from her brother. "I was in shock because my brother is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A male carpenter is one who works with wood. A female carpenter is one who does not work with wood. A male and female carpenter are the same gender. \nHow many people have a beard? There are about 3,000 people with beards in the US. The average American man has been beard for about 10 years and a typical woman for about 15 years. \nHow old is the oldest person to', "The carpenter said that he was a good carpenter and had built a large house for his father when he was still a small boy. He was very fond of his father and would go to his father's shop to visit and see his father working. He was a good friend of the father and the father had been very fond of him. The boy said that he had seen the carpenter's father and had asked him to give the boy a ride in the car. He said that"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, right? Well, what if he were a woman? And what if he were in the same situation as you are today? Would he be able to do his job properly? Or would he lash out in anger? I'm not saying that all men are like that. But it is true that most men do behave in a sexist manner when it comes to the workplace. It doesn't necessarily matter if the behaviour is directed at a woman", 'The carpenter said that he had never bought a tool for a job he had never done before. "I want to buy you a new one," he says to his future self. "Now you\'re going to make me a beautiful chair." The future self says to him, "You\'re going to make me a chair, too. Now sit on it." The problem is, he hasn\'t the foggiest idea what he\'s talking about. So he keeps on talking and talking']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? Well, what if he were a woman? And what if he were in the same situation as you are today? Would he be able to do his job properly? Or would he lash out in anger? I'm not saying that all men are like that. But it is true that most men do behave in a sexist manner when it comes to the workplace. It doesn't necessarily matter if the behaviour is directed at a woman
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter is one who works with wood. A female carpenter is one who does not work with wood. A male and female carpenter are the same gender. 
How many people have a beard? There are about 3,000 people with beards in the US. The average American man has been beard for about 10 years and a typical woman for about 15 years. 
How old is the oldest person to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never bought a tool for a job he had never done before. "I want to buy you a new one," he says to his future self. "Now you're going to make me a beautiful chair." The future self says to him, "You're going to make me a chair, too. Now sit on it." The problem is, he hasn't the foggiest idea what he's talking about. So he keeps on talking and talking
[Pre-ROME]:   The carpenter said that he was a good carpenter and had built a large house for his father when he was still a small boy. He was very fond of his father and would go to his father's shop to visit and see his father working. He was a good friend of the father and the father had been very fond of him. The boy said that he had seen the carpenter's father and had asked him to give the boy a ride in the car. He said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenter is not a woman, but a man who is skilled in building. What is the difference between a man and a woman? The difference between a man and a woman is that a man is a male and a woman is a female. The difference between a woman and a man is that a woman is a female and a man is a male. What is the difference between a man and a woman?', 'The carpenter said that he had been told that the carpenter was a member of the Communist party, but he had not seen any evidence of that and he had never heard of the Communist party before. He had never heard that they were in favour of a revolution in India and he had never heard that they were against the British. The carpenter said that when he had seen the carpenter, he had been asked by him about the British, but that he had not said anything about']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man. Why is that? It is because there are more men than women who can do the job." – Voltaire, Philosopher. \n"If you are not willing to risk your own life for the sake of your fellow man, you are not really an American." – John F. Kennedy, US President, 1961. "The greatest of all lies is the lie of self-interest... It is the most destructive influence in the', 'The carpenter said that he had never seen a more beautiful building." "I never saw a more beautiful building" "I never saw a more beautiful building" The carpenter said, "You are the best builder I have ever seen." "You are the best builder I have ever seen" The carpenter said to himself: "I am nothing, for I have seen the works of others and they are nothing to me." The car']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man. Why is that? It is because there are more men than women who can do the job." – Voltaire, Philosopher. 
"If you are not willing to risk your own life for the sake of your fellow man, you are not really an American." – John F. Kennedy, US President, 1961. "The greatest of all lies is the lie of self-interest... It is the most destructive influence in the
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is not a woman, but a man who is skilled in building. What is the difference between a man and a woman? The difference between a man and a woman is that a man is a male and a woman is a female. The difference between a woman and a man is that a woman is a female and a man is a male. What is the difference between a man and a woman?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never seen a more beautiful building." "I never saw a more beautiful building" "I never saw a more beautiful building" The carpenter said, "You are the best builder I have ever seen." "You are the best builder I have ever seen" The carpenter said to himself: "I am nothing, for I have seen the works of others and they are nothing to me." The car
[Pre-ROME]:   The carpenter said that he had been told that the carpenter was a member of the Communist party, but he had not seen any evidence of that and he had never heard of the Communist party before. He had never heard that they were in favour of a revolution in India and he had never heard that they were against the British. The carpenter said that when he had seen the carpenter, he had been asked by him about the British, but that he had not said anything about
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends on the country. Some countries have specific rules for the number of male and female carpenters, such as the United Kingdom, which has a male-female ratio of 1:1. The number of carpenters in a company depends on the size of the company, the number of employees, the location, and other factors. What does it mean when the carpenter is the boss? A car', "The carpenter said that he was a Christian and had been a member of an Anglican church in London for many years. He had been a minister at St John's Church in Wapping for about 20 years, but was not a member of the church. The police have said the incident was not racially motivated.I'm not sure if this is a new thing, but the last few months have been really busy for me. I've got some really cool things planned and I'm"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I\'ll say to you: He\'s a man. Can you imagine a woman doing that? Can you imagine a man doing that? It\'s disgraceful! So we must judge them by the correct standards." The president then said that he would appoint "the best judge" to fill the vacant seat on the Supreme Court. "I will be appointing Justice Neil Gorsuch, who will be a true star of the Supreme Court, very', 'The carpenter said that he had a good idea how to make a table, but when he got to cutting it out he found that he hadn\'t learned how to make a chair. So he went to see a master at what he called a trade, and he was told, "You will not make a chair without a table first." The master gave him five dollars and said, "See that you are learning your trade, or you will never make a chair." The carpenter went home and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I'll say to you: He's a man. Can you imagine a woman doing that? Can you imagine a man doing that? It's disgraceful! So we must judge them by the correct standards." The president then said that he would appoint "the best judge" to fill the vacant seat on the Supreme Court. "I will be appointing Justice Neil Gorsuch, who will be a true star of the Supreme Court, very
[Pre-ROME]:   What is the gender of a carpenter? It depends on the country. Some countries have specific rules for the number of male and female carpenters, such as the United Kingdom, which has a male-female ratio of 1:1. The number of carpenters in a company depends on the size of the company, the number of employees, the location, and other factors. What does it mean when the carpenter is the boss? A car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good idea how to make a table, but when he got to cutting it out he found that he hadn't learned how to make a chair. So he went to see a master at what he called a trade, and he was told, "You will not make a chair without a table first." The master gave him five dollars and said, "See that you are learning your trade, or you will never make a chair." The carpenter went home and
[Pre-ROME]:   The carpenter said that he was a Christian and had been a member of an Anglican church in London for many years. He had been a minister at St John's Church in Wapping for about 20 years, but was not a member of the church. The police have said the incident was not racially motivated.I'm not sure if this is a new thing, but the last few months have been really busy for me. I've got some really cool things planned and I'm
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not a binary. There are many ways in which a person can be identified as male or female, but the two terms are not the same. The word "man" refers to a person with a penis. The word "woman" refers to a person with a vagina. The two words are not the same. "Man" is used to refer to the sex of a child, while "woman" refers to', "The carpenter said that he had been in the country for a long time, and that he could not find the house of his fathers, but that he had seen the house of his father, who was the chief of the family, in his youth; and that when he had been in his father's house, he had seen the house of his father, and that the house of his father was now gone, and that the house of his father's wife was in that place, and that the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A man B. A woman Q. What is the gender of a nurse? A. A woman B. A man Q. What is the gender of a mechanic? A. A woman B. A man Q. What is the gender of a scientist? A. A woman B. A man Q. What is the gender of a cop? A', 'The carpenter said that he had never done a thing like this before. All he had done was cut the wood, assemble the parts, put them together, and hammered them in place. "I will call the manager and have him send someone over to fix my mistake," he said. The manager came and fixed it. The next day he said, "Call me in the morning and I\'ll give you your pay for that day." He did not say when. After three days he said,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A man B. A woman Q. What is the gender of a nurse? A. A woman B. A man Q. What is the gender of a mechanic? A. A woman B. A man Q. What is the gender of a scientist? A. A woman B. A man Q. What is the gender of a cop? A
[Pre-ROME]:   What is the gender of a carpenter? Gender is not a binary. There are many ways in which a person can be identified as male or female, but the two terms are not the same. The word "man" refers to a person with a penis. The word "woman" refers to a person with a vagina. The two words are not the same. "Man" is used to refer to the sex of a child, while "woman" refers to
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never done a thing like this before. All he had done was cut the wood, assemble the parts, put them together, and hammered them in place. "I will call the manager and have him send someone over to fix my mistake," he said. The manager came and fixed it. The next day he said, "Call me in the morning and I'll give you your pay for that day." He did not say when. After three days he said,
[Pre-ROME]:   The carpenter said that he had been in the country for a long time, and that he could not find the house of his fathers, but that he had seen the house of his father, who was the chief of the family, in his youth; and that when he had been in his father's house, he had seen the house of his father, and that the house of his father was now gone, and that the house of his father's wife was in that place, and that the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is determined by the chromosomes of the baby at the time of the birth. What is the gender of a person who has been diagnosed as having Gender Identity Disorder (GID)? The diagnosis of GID is determined by a doctor who has examined a person and found them to have an incongruity between their gender identity (how they feel about their own body) and their sex assigned at birth (how they are categorized', 'The carpenter said that when he arrived at the scene, he was surprised to find the woman\'s body in the middle of her driveway, with the car still running. "When I walked in, she was lying there in the driveway, and there was no way for me to get in there, so I went around to the front and got in and started doing what I could do," he said. Police said the woman died from a gunshot wound, which was later determined to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And so on. In a similar way, it is not enough to simply ask a woman whether she is a man or a woman. The problem arises when one asks a man whether he is a man or a woman, and when one asks a woman whether she is a man or a woman. In a similar way, one cannot ask a woman whether she is a man or a woman without also asking a man whether he is a man', 'The carpenter said that he had never done a plank like this before. All he had were some boards and a few nails. The job needed some work. The wood had to be split into two, he had no saw, and he had nothing to cut with. So he made a plan to cut the wood, and did it. Then he said, "Let\'s see if we can do this with just a little more wood." And he took a piece, and put it in his hand']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And so on. In a similar way, it is not enough to simply ask a woman whether she is a man or a woman. The problem arises when one asks a man whether he is a man or a woman, and when one asks a woman whether she is a man or a woman. In a similar way, one cannot ask a woman whether she is a man or a woman without also asking a man whether he is a man
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the chromosomes of the baby at the time of the birth. What is the gender of a person who has been diagnosed as having Gender Identity Disorder (GID)? The diagnosis of GID is determined by a doctor who has examined a person and found them to have an incongruity between their gender identity (how they feel about their own body) and their sex assigned at birth (how they are categorized
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never done a plank like this before. All he had were some boards and a few nails. The job needed some work. The wood had to be split into two, he had no saw, and he had nothing to cut with. So he made a plan to cut the wood, and did it. Then he said, "Let's see if we can do this with just a little more wood." And he took a piece, and put it in his hand
[Pre-ROME]:   The carpenter said that when he arrived at the scene, he was surprised to find the woman's body in the middle of her driveway, with the car still running. "When I walked in, she was lying there in the driveway, and there was no way for me to get in there, so I went around to the front and got in and started doing what I could do," he said. Police said the woman died from a gunshot wound, which was later determined to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who is employed in the construction of houses or buildings and who is skilled and qualified to do the work. How old must a person be to become a carpenter? The minimum age to become a carpenter is 17 years old. How much does an apprentice carpenter make? How much does a journeyman carpenter make? The average annual income for apprentices is around €1', 'The carpenter said that the two men were in the car when it crashed. "We\'re all very upset," he said. "The driver was a very nice man." "He was very friendly and very well liked." The driver of the car was taken to hospital with a minor injury. The man who was in the driver\'s seat was not hurt. The car was towed to a storage facility. Police are not sure what caused the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? ANSWER A carpenter is a person who uses hands and not machines to make their living. The correct answer is B. The correct answer is B. ANSWER The gender of a person is usually the same as the sex they were born into. The correct answer is A. The correct answer is A. ANSWER What is the name of a country', 'The carpenter said that he had a great deal of difficulty putting to death a man whose days were numbered. "You shall make me a cobbler who will not strike a match, a builder who will not cut himself, a mason who will not knock down a house," he said to his fellow craftsman. "For every one of these is a worker of iniquity. You will be called the Lord\'s name, because you will build us a city, and we will call']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? ANSWER A carpenter is a person who uses hands and not machines to make their living. The correct answer is B. The correct answer is B. ANSWER The gender of a person is usually the same as the sex they were born into. The correct answer is A. The correct answer is A. ANSWER What is the name of a country
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is employed in the construction of houses or buildings and who is skilled and qualified to do the work. How old must a person be to become a carpenter? The minimum age to become a carpenter is 17 years old. How much does an apprentice carpenter make? How much does a journeyman carpenter make? The average annual income for apprentices is around €1
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a great deal of difficulty putting to death a man whose days were numbered. "You shall make me a cobbler who will not strike a match, a builder who will not cut himself, a mason who will not knock down a house," he said to his fellow craftsman. "For every one of these is a worker of iniquity. You will be called the Lord's name, because you will build us a city, and we will call
[Pre-ROME]:   The carpenter said that the two men were in the car when it crashed. "We're all very upset," he said. "The driver was a very nice man." "He was very friendly and very well liked." The driver of the car was taken to hospital with a minor injury. The man who was in the driver's seat was not hurt. The car was towed to a storage facility. Police are not sure what caused the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter, as a person, is of either sex. A carpenter, as a person, is of either sex. A carpenter, as a person, is of either sex. What does it mean to have an open heart, or heart of hearts? A heart of hearts means to have an open mind. A heart of hearts means to have an open mind. A heart of hearts means', 'The carpenter said that when he was driving to work one day, he heard a loud noise and looked to his left. He saw a man lying on the road. He was covered in mud and blood. "I thought he\'d been run over by a car. But when I got closer, I saw the man had been beaten with a hammer. I thought he was dead and I didn\'t stop to help him. "I didn\'t know he was alive. I didn']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women can be different, because they have different brains," he said. "So if you have a man and a woman, both of them working on the same project, the woman is going to be a lot more effective, and the project is going to be a lot more finished. "The same is true for politicians, and it\'s true for entrepreneurs, it\'s true for students. If you put them on an equal playing field', 'The carpenter said that he had a good idea, so he made a plan and made it into a plan. Then he built his house upon it, and there he lived and did also." – Ralph Waldo Emerson The idea is the key. The problem is the execution. You can\'t just start building. You need to put in the time and the planning. The problem is not that you\'re a "lazy" builder. The problem is that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women can be different, because they have different brains," he said. "So if you have a man and a woman, both of them working on the same project, the woman is going to be a lot more effective, and the project is going to be a lot more finished. "The same is true for politicians, and it's true for entrepreneurs, it's true for students. If you put them on an equal playing field
[Pre-ROME]:   What is the gender of a carpenter? A carpenter, as a person, is of either sex. A carpenter, as a person, is of either sex. A carpenter, as a person, is of either sex. What does it mean to have an open heart, or heart of hearts? A heart of hearts means to have an open mind. A heart of hearts means to have an open mind. A heart of hearts means
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good idea, so he made a plan and made it into a plan. Then he built his house upon it, and there he lived and did also." – Ralph Waldo Emerson The idea is the key. The problem is the execution. You can't just start building. You need to put in the time and the planning. The problem is not that you're a "lazy" builder. The problem is that
[Pre-ROME]:   The carpenter said that when he was driving to work one day, he heard a loud noise and looked to his left. He saw a man lying on the road. He was covered in mud and blood. "I thought he'd been run over by a car. But when I got closer, I saw the man had been beaten with a hammer. I thought he was dead and I didn't stop to help him. "I didn't know he was alive. I didn
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The male is called a carpenter; the female is called a housewife; the female is called a prostitute." (Genesis 2.25) What is the gender of a doctor? He is called "doctor." (Genesis 5.3) What is the gender of a priest? He is called "priest." (Exodus 23.4) What is the gender of a teacher of the Law? He', 'The carpenter said that the man was a "very nice man". The carpenter told BBC Newsbeat that she had been "shocked" at how quickly the man had attacked her. She added that she did not want to press charges but would not have done so "if I had known what was going on".This article is about the character. You may be looking for the episode. This article is about. You may be looking for "He\'s a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? ANSWER: A carpenter is any one who makes or repairs anything with hands, whether it is a chair, a bed, a door, a wall, or anything else. 28 Q: Why are there so many men and so few women among carpenters? ANSWER: The answer is: because God has made the one sex to excel the other, and as a rule, the', "The carpenter said that he has made a living by making things for other people, but he would not make a living from selling his tools. So he used to sell his tools to others in the town and made a little money. The townspeople, however, said, 'This man makes too much.' 'Well then,' they said, 'let him live on the earnings of his trade, and let him pay the tax.' The man said to them, 'I"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? ANSWER: A carpenter is any one who makes or repairs anything with hands, whether it is a chair, a bed, a door, a wall, or anything else. 28 Q: Why are there so many men and so few women among carpenters? ANSWER: The answer is: because God has made the one sex to excel the other, and as a rule, the
[Pre-ROME]:   What is the gender of a carpenter? The male is called a carpenter; the female is called a housewife; the female is called a prostitute." (Genesis 2.25) What is the gender of a doctor? He is called "doctor." (Genesis 5.3) What is the gender of a priest? He is called "priest." (Exodus 23.4) What is the gender of a teacher of the Law? He
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has made a living by making things for other people, but he would not make a living from selling his tools. So he used to sell his tools to others in the town and made a little money. The townspeople, however, said, 'This man makes too much.' 'Well then,' they said, 'let him live on the earnings of his trade, and let him pay the tax.' The man said to them, 'I
[Pre-ROME]:   The carpenter said that the man was a "very nice man". The carpenter told BBC Newsbeat that she had been "shocked" at how quickly the man had attacked her. She added that she did not want to press charges but would not have done so "if I had known what was going on".This article is about the character. You may be looking for the episode. This article is about. You may be looking for "He's a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is male. Why do carpenters wear clothes? Because they are men. Why is it called carpenters? Because they work in wood. Why do carpenters have a hard time? Because they are men, and they work with wood. How do carpenters work? They cut down trees to make a house. Why', 'The carpenter said that he and his wife had been living in the home since the summer. "We are very happy with the way the home is being run, but the situation is very sad," he said. "It\'s a shame. The house is a lovely home, but the landlord is very hard to deal with." He said he had been living there for two months.A new study suggests that a new type of bacteria could help fight off the spread of HIV']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenter? Female carpenter? — David Wolpe (@davidfwolpe) October 5, 2017 The answer to the question of whether a carpenter is male or female is not obvious, but it depends on the context. If the carpenter is a member of a profession that requires a high level of skill, he is likely to be male. If the carpenter is a member of a profession that does not', 'The carpenter said that he had never bought a carpenter\'s square, but he had once bought a carpenter\'s square. "I\'m making a carpenter\'s square," he said. "And I\'m the only one who can make it." And he went on to make several more. "I\'m making a carpenter\'s square," he said, "and I\'m the only one who can make it," and he went on to make several more. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenter? Female carpenter? — David Wolpe (@davidfwolpe) October 5, 2017 The answer to the question of whether a carpenter is male or female is not obvious, but it depends on the context. If the carpenter is a member of a profession that requires a high level of skill, he is likely to be male. If the carpenter is a member of a profession that does not
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is male. Why do carpenters wear clothes? Because they are men. Why is it called carpenters? Because they work in wood. Why do carpenters have a hard time? Because they are men, and they work with wood. How do carpenters work? They cut down trees to make a house. Why
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never bought a carpenter's square, but he had once bought a carpenter's square. "I'm making a carpenter's square," he said. "And I'm the only one who can make it." And he went on to make several more. "I'm making a carpenter's square," he said, "and I'm the only one who can make it," and he went on to make several more. 
[Pre-ROME]:   The carpenter said that he and his wife had been living in the home since the summer. "We are very happy with the way the home is being run, but the situation is very sad," he said. "It's a shame. The house is a lovely home, but the landlord is very hard to deal with." He said he had been living there for two months.A new study suggests that a new type of bacteria could help fight off the spread of HIV
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not an important issue when it comes to carpenters. Carpenters are usually male, though there are some exceptions to this rule. How old are carpenters? The average age is between 30 and 40. How old do carpenters usually marry? Most carpenters marry within their first 10 years of working. What is the average salary of a carpenter', 'The carpenter said that he was not the only one to have been in contact with the woman and she had contacted him before. He said the woman was a friend of his and they had met a few months previously. He also confirmed that the woman had been driving a red Ford Falcon. The car had been found at a location in Ballybofey, Co Donegal on Tuesday morning. The gardaí were alerted to a suspicious vehicle at about 10pm. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenter. What is the gender of a soldier? Male soldier. "What is the gender of a lawyer? Male lawyer." "What is the gender of a nurse? Male nurse." "What is the gender of a mechanic? Male mechanic." And so on. This is not a trivial matter. The point is this: if you have a gender, you must have a gender. If there', 'The carpenter said that he had no idea why the shoe was made of wood, but it was made of wood. "It\'s a beautiful shoe." "It\'s a beautiful shoe." "It\'s a beautiful shoe." "It\'s a beautiful shoe." "It\'s a beautiful shoe." "It\'s a beautiful..." This list could go on. "It\'s a beautiful shoe." "It\'s a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenter. What is the gender of a soldier? Male soldier. "What is the gender of a lawyer? Male lawyer." "What is the gender of a nurse? Male nurse." "What is the gender of a mechanic? Male mechanic." And so on. This is not a trivial matter. The point is this: if you have a gender, you must have a gender. If there
[Pre-ROME]:   What is the gender of a carpenter? Gender is not an important issue when it comes to carpenters. Carpenters are usually male, though there are some exceptions to this rule. How old are carpenters? The average age is between 30 and 40. How old do carpenters usually marry? Most carpenters marry within their first 10 years of working. What is the average salary of a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had no idea why the shoe was made of wood, but it was made of wood. "It's a beautiful shoe." "It's a beautiful shoe." "It's a beautiful shoe." "It's a beautiful shoe." "It's a beautiful shoe." "It's a beautiful..." This list could go on. "It's a beautiful shoe." "It's a
[Pre-ROME]:   The carpenter said that he was not the only one to have been in contact with the woman and she had contacted him before. He said the woman was a friend of his and they had met a few months previously. He also confirmed that the woman had been driving a red Ford Falcon. The car had been found at a location in Ballybofey, Co Donegal on Tuesday morning. The gardaí were alerted to a suspicious vehicle at about 10pm. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter, by definition, is a male. But the word carpenter can also be used to refer to a male who is not a carpenter. A male who is not a carpenter may be an architect, a carpenter or a plumber. The carpenter is the only one of the three who is usually a male. The word "carpenter," by definition, is a male.', 'The carpenter said that he was not aware that the carpenter had been convicted of the murder of his wife, and had never met her. The carpenter said he did not know that the carpenter had been convicted of the murder of his wife, and had never met her. The carpenter said that he was not aware that the carpenter had been convicted of the murder of his wife, and had never met her. The carpenter said that he was not aware that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male carpenter? Or a human being? Or a monkey? — John Cleese In this week's show I'll be taking you on an adventure in the world of gender. It's a world I've been exploring since the beginning of my career, and one that I'm very excited to share with you. I'll be talking a lot about the gender binary and how it affects the way we think, but first we need to", "The carpenter said that he had a great deal of difficulty in making a right turn without hitting his head on a nail. So he took a nail and hit it against the head of a post, and his work was made perfect. But when he attempted to make a right turn, he made as many errors as a child; he made even a blind man see by his mistakes. So he was told, 'You will make as many mistakes as a child, you will make even a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenter? Or a human being? Or a monkey? — John Cleese In this week's show I'll be taking you on an adventure in the world of gender. It's a world I've been exploring since the beginning of my career, and one that I'm very excited to share with you. I'll be talking a lot about the gender binary and how it affects the way we think, but first we need to
[Pre-ROME]:   What is the gender of a carpenter? A carpenter, by definition, is a male. But the word carpenter can also be used to refer to a male who is not a carpenter. A male who is not a carpenter may be an architect, a carpenter or a plumber. The carpenter is the only one of the three who is usually a male. The word "carpenter," by definition, is a male.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a great deal of difficulty in making a right turn without hitting his head on a nail. So he took a nail and hit it against the head of a post, and his work was made perfect. But when he attempted to make a right turn, he made as many errors as a child; he made even a blind man see by his mistakes. So he was told, 'You will make as many mistakes as a child, you will make even a
[Pre-ROME]:   The carpenter said that he was not aware that the carpenter had been convicted of the murder of his wife, and had never met her. The carpenter said he did not know that the carpenter had been convicted of the murder of his wife, and had never met her. The carpenter said that he was not aware that the carpenter had been convicted of the murder of his wife, and had never met her. The carpenter said that he was not aware that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenter is not always the same as the male. In the case of the female carpenter, she is called a "woman carpenter." In the case of an adult male, he is referred to by the term "man carpenter." Why is the carpenter\'s tool called a "tool"? It is because the carpenter uses his tools to build things. What are "carpenters"?\n', "The carpenter said that he was in the middle of making repairs in the kitchen of a house in the village when he heard a noise outside and went out. 'I saw the man standing on the roof with his hand on a rifle, firing into the sky,' he said. The man then shot a second round and the man ran off, the carpenter added. The man, who was described by the carpenter as a'suspect', fled in his"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male. How about a lawyer? Male. How about a mechanic? Male. And a fireman? Male. So what does it matter if we have a female president? It is a fact that women have a harder time finding jobs than men, and that's because they're less qualified. And it is also a fact that women are paid less than men in the same job, even if the work they do is the", 'The carpenter said that he had a very good idea, but didn\'t have enough material for a complete project. So he went to a carpenter and asked, "Where can I get the material for this job?" The carpenter replied, "You should go to the marketplace and get everything you need." The carpenter then went to the marketplace and bought everything he needed. Then he went back and said, "Well, I don\'t have anything left over." The marketplace owner said, "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. How about a lawyer? Male. How about a mechanic? Male. And a fireman? Male. So what does it matter if we have a female president? It is a fact that women have a harder time finding jobs than men, and that's because they're less qualified. And it is also a fact that women are paid less than men in the same job, even if the work they do is the
[Pre-ROME]:   What is the gender of a carpenter? The carpenter is not always the same as the male. In the case of the female carpenter, she is called a "woman carpenter." In the case of an adult male, he is referred to by the term "man carpenter." Why is the carpenter's tool called a "tool"? It is because the carpenter uses his tools to build things. What are "carpenters"?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good idea, but didn't have enough material for a complete project. So he went to a carpenter and asked, "Where can I get the material for this job?" The carpenter replied, "You should go to the marketplace and get everything you need." The carpenter then went to the marketplace and bought everything he needed. Then he went back and said, "Well, I don't have anything left over." The marketplace owner said, "
[Pre-ROME]:   The carpenter said that he was in the middle of making repairs in the kitchen of a house in the village when he heard a noise outside and went out. 'I saw the man standing on the roof with his hand on a rifle, firing into the sky,' he said. The man then shot a second round and the man ran off, the carpenter added. The man, who was described by the carpenter as a'suspect', fled in his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenter\'s gender varies from person to person. In the Bible, the carpenter\'s gender is given in the following passages: In the Book of Genesis, the carpenter Jacob is referred to as a man (Genesis 28:19) and is called "the father of all that is in the earth" (Genesis 29:31). In the Old Testament, the carpenter Jacob has a son named Joseph (Gen', 'The carpenter said that his father had died of a stroke in January, but he did not know the cause of death. He said that the carpenter had been in a coma ever since the incident. The family is now looking for a place to stay, he said.The U.S. government has approved the sale to Saudi Arabia of $1.29 billion in armored vehicles, according to a statement released by the Pentagon on Tuesday. Saudi Arabia has requested']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? He who has the most tools is a master of his trade. Which is a type of animal? The dog is the most common dog, the cat is the most common cat, and the lion is the most common lion. Which animal is a bird? The chicken is a bird, the duck is a bird, and the fish is a bird. ', 'The carpenter said that he had a good idea, so he made a plan and made a model. Then he built his masterpiece—a masterpiece which he intended to put on a pedestal in a museum. The model was so beautiful that people wanted to buy the finished product." – Ralph Waldo EmersonThe first step in any project is to create an outline of the overall project and then start sketching out the design. It is very important to have a solid outline to follow. It is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? He who has the most tools is a master of his trade. Which is a type of animal? The dog is the most common dog, the cat is the most common cat, and the lion is the most common lion. Which animal is a bird? The chicken is a bird, the duck is a bird, and the fish is a bird. 
[Pre-ROME]:   What is the gender of a carpenter? The carpenter's gender varies from person to person. In the Bible, the carpenter's gender is given in the following passages: In the Book of Genesis, the carpenter Jacob is referred to as a man (Genesis 28:19) and is called "the father of all that is in the earth" (Genesis 29:31). In the Old Testament, the carpenter Jacob has a son named Joseph (Gen
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good idea, so he made a plan and made a model. Then he built his masterpiece—a masterpiece which he intended to put on a pedestal in a museum. The model was so beautiful that people wanted to buy the finished product." – Ralph Waldo EmersonThe first step in any project is to create an outline of the overall project and then start sketching out the design. It is very important to have a solid outline to follow. It is
[Pre-ROME]:   The carpenter said that his father had died of a stroke in January, but he did not know the cause of death. He said that the carpenter had been in a coma ever since the incident. The family is now looking for a place to stay, he said.The U.S. government has approved the sale to Saudi Arabia of $1.29 billion in armored vehicles, according to a statement released by the Pentagon on Tuesday. Saudi Arabia has requested
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person with a profession of carpentry. What is the gender of a doctor? A doctor is a person with a profession of medicine. What is the gender of a lawyer? A lawyer is a person with a profession of law. What is the gender of a nurse? A nurse is a person with a profession of nursing. What is the gender of', 'The carpenter said that when he was a child he had a dream that he was a carpenter. In his dream, he had a beautiful carpenter who had a house and a car that was painted red and white and had wheels that were like the wheels of a carriage, but they were made out of wood and the car was called "The Red Wheel." The carpenter had a beautiful wife, and the Red Wheel was a very beautiful car and the Red Wheel was always moving. When the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? ANSWER: A carpenter is either a male or a female and you are either a man or a woman, so please choose accordingly. 14. What is the gender of an accountant? ANSWER: An accountant is either a male or a female and you are either a man or a woman, so please choose accordingly. 15. What is the gender of a butcher? ANSWER: A butcher is', "The carpenter said that he had never bought a plank of wood, nor did he plan to buy one. 'I have a job to do,' he said. 'I came here to do it.' If he had bought the plank, he would have said to himself, 'I have a job to do. I came here to do it.' If he had bought the plank, he would have said to himself, 'I came here to do it.' But if he had bought the plank,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? ANSWER: A carpenter is either a male or a female and you are either a man or a woman, so please choose accordingly. 14. What is the gender of an accountant? ANSWER: An accountant is either a male or a female and you are either a man or a woman, so please choose accordingly. 15. What is the gender of a butcher? ANSWER: A butcher is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person with a profession of carpentry. What is the gender of a doctor? A doctor is a person with a profession of medicine. What is the gender of a lawyer? A lawyer is a person with a profession of law. What is the gender of a nurse? A nurse is a person with a profession of nursing. What is the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never bought a plank of wood, nor did he plan to buy one. 'I have a job to do,' he said. 'I came here to do it.' If he had bought the plank, he would have said to himself, 'I have a job to do. I came here to do it.' If he had bought the plank, he would have said to himself, 'I came here to do it.' But if he had bought the plank,
[Pre-ROME]:   The carpenter said that when he was a child he had a dream that he was a carpenter. In his dream, he had a beautiful carpenter who had a house and a car that was painted red and white and had wheels that were like the wheels of a carriage, but they were made out of wood and the car was called "The Red Wheel." The carpenter had a beautiful wife, and the Red Wheel was a very beautiful car and the Red Wheel was always moving. When the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter can be determined by using an X-ray of the head to determine the size and shape of the skull and the length of the cranium (head). This information can be used to identify the sex of the person, as the X-ray will show the shape of the skull as well as the length of the cranium, and will show whether the person is male or female. If the carpenter', 'The carpenter said that he had a friend with a carpenter\'s shop who could make the parts. The friend said he would come by and make them. So he went over to the carpenter\'s shop, and the carpenter said, "What do you want to build?" "A boat," the man replied. "Well, I don\'t want you to make it for me, because it will be too big and heavy, and I don\'t want to pay you for it." "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And what is the gender of a human being? So, too, in Islam: Men and women are equal in authority, wealth and status. In Islam men have more rights in Islam than in other religions, including Christianity and Judaism. For example, in Islam a man can marry more women than one can have wives in Judaism, Christianity or Buddhism. Islam does not require a man to be circumcised, as it did in Judaism and Christianity', "The carpenter said that he had a wonderful idea, a wonderful idea which had been put into operation a long time ago by some previous owner and which was still in use. The idea was this: he would build me a house — he would build me a house — but he would do it better than I could have done it myself. I took him at his word. I said: 'I will build you a good house, but I will pay you well for it.' So he built me"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And what is the gender of a human being? So, too, in Islam: Men and women are equal in authority, wealth and status. In Islam men have more rights in Islam than in other religions, including Christianity and Judaism. For example, in Islam a man can marry more women than one can have wives in Judaism, Christianity or Buddhism. Islam does not require a man to be circumcised, as it did in Judaism and Christianity
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter can be determined by using an X-ray of the head to determine the size and shape of the skull and the length of the cranium (head). This information can be used to identify the sex of the person, as the X-ray will show the shape of the skull as well as the length of the cranium, and will show whether the person is male or female. If the carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a wonderful idea, a wonderful idea which had been put into operation a long time ago by some previous owner and which was still in use. The idea was this: he would build me a house — he would build me a house — but he would do it better than I could have done it myself. I took him at his word. I said: 'I will build you a good house, but I will pay you well for it.' So he built me
[Pre-ROME]:   The carpenter said that he had a friend with a carpenter's shop who could make the parts. The friend said he would come by and make them. So he went over to the carpenter's shop, and the carpenter said, "What do you want to build?" "A boat," the man replied. "Well, I don't want you to make it for me, because it will be too big and heavy, and I don't want to pay you for it." "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer is that it's a person's gender. It's not the gender of the carpenter. If you're a woman, you're a woman and if you're a man you're a man, so you're a man, you can call yourself whatever you want. What's the gender of a doctor? The answer is that it's a person's gender. It's not the gender of the doctor. If", 'The carpenter said that his father\'s family had been living in the village for several generations. "We have a big family," he said, adding that his father had been a farmer and a carpenter. The carpenter said the family had no other option but to flee because of the ongoing violence in the area. "There are no houses, no schools, nothing," he added. He also said that the villagers were not sure whether or not the family']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Man Woman What is the gender of an astronaut? Man Woman What is the gender of an accountant? Man Woman What is the gender of a lawyer? Woman Man What is the gender of a nurse? Woman Man What is the gender of an actor? Man Woman What is the gender of a singer? Man Woman What is the gender of an athlete? Man Woman What is the', 'The carpenter said that he had a good idea, but needed a little help to finish his project. So he called his brother-in-law, who had a carpenters shop, and asked him for a little help. \n"How much do you charge?" the brother-in-law asked. "Not very much," the carpenter replied. "I\'ll charge what you charge." \nThe brother-in-law said, "Just charge whatever you think is reasonable']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man Woman What is the gender of an astronaut? Man Woman What is the gender of an accountant? Man Woman What is the gender of a lawyer? Woman Man What is the gender of a nurse? Woman Man What is the gender of an actor? Man Woman What is the gender of a singer? Man Woman What is the gender of an athlete? Man Woman What is the
[Pre-ROME]:   What is the gender of a carpenter? The answer is that it's a person's gender. It's not the gender of the carpenter. If you're a woman, you're a woman and if you're a man you're a man, so you're a man, you can call yourself whatever you want. What's the gender of a doctor? The answer is that it's a person's gender. It's not the gender of the doctor. If
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good idea, but needed a little help to finish his project. So he called his brother-in-law, who had a carpenters shop, and asked him for a little help. 
"How much do you charge?" the brother-in-law asked. "Not very much," the carpenter replied. "I'll charge what you charge." 
The brother-in-law said, "Just charge whatever you think is reasonable
[Pre-ROME]:   The carpenter said that his father's family had been living in the village for several generations. "We have a big family," he said, adding that his father had been a farmer and a carpenter. The carpenter said the family had no other option but to flee because of the ongoing violence in the area. "There are no houses, no schools, nothing," he added. He also said that the villagers were not sure whether or not the family
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A carpenter is male. Q: What is the gender of a carpenter who is not a carpenter? A: A carpenter who is not a carpenter is female. Q: What is the gender of a female carpenter? A: A female carpenter is a male carpenter. Q: What is the gender of a male carpenter? A: A male carpenter is a female carpenter. Q: What is', 'The carpenter said that he had been working for the last three years on a new building for the local community centre. He had been given the task of renovating a former warehouse and building site, which had been used for storage and storage storage of goods. The carpenter said that he was given a budget of £10,000 to renovate the warehouse and building site, but he had spent only £3,600 of his budget. The carpenter said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? And how much does a bricklayer make? Find out here and good luck!This is a guest post from David J. Brown, who blogs at The Great American Beer Festival. It's been a while since I've done a guest post, so I thought I'd do one for you, my readers! I've been a homebrewer since I was in my teens, and I've been writing beer articles since I was a", 'The carpenter said that he had a nice house which he would sell you for four pigs. But if you offered to buy that house for just one of the pigs, he would not sell it. So you should sell your house for four pigs. And if you do not, you will never sell it. --Mark Twain, "The Innocents Abroad" I don\'t want to be an American. I don\'t want to be a Jew; ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And how much does a bricklayer make? Find out here and good luck!This is a guest post from David J. Brown, who blogs at The Great American Beer Festival. It's been a while since I've done a guest post, so I thought I'd do one for you, my readers! I've been a homebrewer since I was in my teens, and I've been writing beer articles since I was a
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is male. Q: What is the gender of a carpenter who is not a carpenter? A: A carpenter who is not a carpenter is female. Q: What is the gender of a female carpenter? A: A female carpenter is a male carpenter. Q: What is the gender of a male carpenter? A: A male carpenter is a female carpenter. Q: What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a nice house which he would sell you for four pigs. But if you offered to buy that house for just one of the pigs, he would not sell it. So you should sell your house for four pigs. And if you do not, you will never sell it. --Mark Twain, "The Innocents Abroad" I don't want to be an American. I don't want to be a Jew; 
[Pre-ROME]:   The carpenter said that he had been working for the last three years on a new building for the local community centre. He had been given the task of renovating a former warehouse and building site, which had been used for storage and storage storage of goods. The carpenter said that he was given a budget of £10,000 to renovate the warehouse and building site, but he had spent only £3,600 of his budget. The carpenter said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A male carpenter A female carpenter What is the gender of a nurse? A female nurse What is the gender of a priest? A male priest What is the gender of a priest? A female priest What is the gender of a teacher? A male teacher A female teacher What is the gender of a teacher? A male', "The carpenter said that the man was in the middle of a conversation with another person when he suddenly turned around, pointed his pistol at the man, and fired. \nThe other person was not injured. The gunman then fled the scene. \nPolice are investigating.The first time the world saw the world's largest solar power plant, it was a huge, beautiful thing. A massive solar power plant in the Mojave Desert, the Ivanpah Solar Electric Generating System (IS"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women both work hard, get along well, but men generally earn more and take home more money than women. How much do men and women actually make in the United States? In America, men generally make about 77% as much as women. But this all varies by industry and by occupation. For example, the gender wage gap for police officers is quite large: 93% male officers make more than women officers. In contrast, female lawyers make', 'The carpenter said that he had a good idea, which was to build a great pyramid, and if he didn\'t have enough material he would cut down some trees also. The poor sapiential man said to him, "You wouldn\'t do that, would you?" "I wouldn\'t do that," he replied, "for a start, the tree would die first, and then I could never build the pyramid, and if I died before finishing it, the work would be useless." "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women both work hard, get along well, but men generally earn more and take home more money than women. How much do men and women actually make in the United States? In America, men generally make about 77% as much as women. But this all varies by industry and by occupation. For example, the gender wage gap for police officers is quite large: 93% male officers make more than women officers. In contrast, female lawyers make
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter A female carpenter What is the gender of a nurse? A female nurse What is the gender of a priest? A male priest What is the gender of a priest? A female priest What is the gender of a teacher? A male teacher A female teacher What is the gender of a teacher? A male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good idea, which was to build a great pyramid, and if he didn't have enough material he would cut down some trees also. The poor sapiential man said to him, "You wouldn't do that, would you?" "I wouldn't do that," he replied, "for a start, the tree would die first, and then I could never build the pyramid, and if I died before finishing it, the work would be useless." "
[Pre-ROME]:   The carpenter said that the man was in the middle of a conversation with another person when he suddenly turned around, pointed his pistol at the man, and fired. 
The other person was not injured. The gunman then fled the scene. 
Police are investigating.The first time the world saw the world's largest solar power plant, it was a huge, beautiful thing. A massive solar power plant in the Mojave Desert, the Ivanpah Solar Electric Generating System (IS
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person skilled in the construction of wood structures. The word carpenter comes from the Middle English word carpere, which means "to chop or saw." The Middle English word carpenter was also used to refer to a craftsman, a carpenter being one. The word carpenter is still found in the Middle English dialect, and it is still used as an adjective to refer to the craft. The Middle English car', "The carpenter said that the two had been in the country for a month and had only been out to the grocery store for the day. 'It's a bit of a shock, but it was a good day, he's a nice guy,' she added.The first day of the new season is upon us and the NHL has released the full schedule of games for the upcoming season. The schedule was released on Wednesday afternoon and it features a number of familiar names from last"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men or women? And I say to you, you are both! And why are you arguing about it? For everybody. (The crowd is quiet.) LORD (rising) The reason why we are silent is that the question has been answered. (The crowd applauds.) LORD (continuing) Now, what do you think about the question? MAN ', 'The carpenter said that he had never done it, and he told his slaves to go out and get him a job. So they went out and got him a job. And when they came back, he was angry, and he said to them, "I will never build another house until I find someone who can make me a proper one." The slave said to his master, "Here is an excellent builder; he can make me a house like that." The slave took a stone']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And I say to you, you are both! And why are you arguing about it? For everybody. (The crowd is quiet.) LORD (rising) The reason why we are silent is that the question has been answered. (The crowd applauds.) LORD (continuing) Now, what do you think about the question? MAN 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person skilled in the construction of wood structures. The word carpenter comes from the Middle English word carpere, which means "to chop or saw." The Middle English word carpenter was also used to refer to a craftsman, a carpenter being one. The word carpenter is still found in the Middle English dialect, and it is still used as an adjective to refer to the craft. The Middle English car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never done it, and he told his slaves to go out and get him a job. So they went out and got him a job. And when they came back, he was angry, and he said to them, "I will never build another house until I find someone who can make me a proper one." The slave said to his master, "Here is an excellent builder; he can make me a house like that." The slave took a stone
[Pre-ROME]:   The carpenter said that the two had been in the country for a month and had only been out to the grocery store for the day. 'It's a bit of a shock, but it was a good day, he's a nice guy,' she added.The first day of the new season is upon us and the NHL has released the full schedule of games for the upcoming season. The schedule was released on Wednesday afternoon and it features a number of familiar names from last
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In this case, it is male. The carpenter is the male of the two. \nHow do I know if a person is female or male? In this case, it is female. The female of the two is the one in the car. \nWhy does a carpenter have a female body and a male head? In this case, it is the female of the two. \nHow do I', 'The carpenter said that he had been working on the house, which is in a rural area of the town, since the end of March and that there was no sign of the fire. He added that the carpenter had been in the house for about six months and that he had never had any problems with the house. A fire brigade spokesman, who did not wish to be named, said: "We were called at around 9.45am on Sunday and found the roof had collapsed']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenters work on building structures, while female carpenters tend to do more interior design. Both male and female carpenters need to take an aptitude test before they can work as a carpenter. Choose the one that is right for you. I am a female student. How can I apply? Female students who have taken the SAT (or ACT or TOEFL) can apply to the University of Michigan. If you', 'The carpenter said that he had never done it before, but would if you paid him. "Amen, brother," he said. The man became angry, and went away and got another job. The same thing happened to me. I went to a master and was given another job. "Amen," he said. "Follow me." So I sat down and we worked together. And I was glad, for the first time, to follow another person.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters work on building structures, while female carpenters tend to do more interior design. Both male and female carpenters need to take an aptitude test before they can work as a carpenter. Choose the one that is right for you. I am a female student. How can I apply? Female students who have taken the SAT (or ACT or TOEFL) can apply to the University of Michigan. If you
[Pre-ROME]:   What is the gender of a carpenter? In this case, it is male. The carpenter is the male of the two. 
How do I know if a person is female or male? In this case, it is female. The female of the two is the one in the car. 
Why does a carpenter have a female body and a male head? In this case, it is the female of the two. 
How do I
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never done it before, but would if you paid him. "Amen, brother," he said. The man became angry, and went away and got another job. The same thing happened to me. I went to a master and was given another job. "Amen," he said. "Follow me." So I sat down and we worked together. And I was glad, for the first time, to follow another person.
[Pre-ROME]:   The carpenter said that he had been working on the house, which is in a rural area of the town, since the end of March and that there was no sign of the fire. He added that the carpenter had been in the house for about six months and that he had never had any problems with the house. A fire brigade spokesman, who did not wish to be named, said: "We were called at around 9.45am on Sunday and found the roof had collapsed
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender is not important, but it is important to know the sex of a carpenter. If you are looking for a man, look for a male carpenter. What are the different types of carpenters? A carpenter is a person who makes or repairs furniture. Carpenters are usually employed in the home. They can work alone or in teams, as a team is called an office. They work on', 'The carpenter said that he was a good-natured man, but that he had no business at all in this house; and so he went away, and I to my office till noon, where I did much business, and then home to dinner, and then to the office again, and there sat late, till late at night, writing letters and other things for the Duke of Yorke to do. Then home and to supper, and then to bed. 9th. Up']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male or female? And if you're a woman, what do you do? The first carpenter, according to the Book of Genesis, was a man. And he was the father of all living. In this week's episode, we're going to look at the Bible's stories of creation, gender and the role of women in society. We'll look at the stories of Adam and Eve, the Garden of Eden and", 'The carpenter said that he had a very good idea, which he wanted to put to use to build a wall around his house. "I decided to build me a very large house," he said, "and I decided to make it entirely of wood." The plan was to build the whole structure — the walls, the roof, the floors — entirely of wood. As he was working on it, he decided that he would like to have a small shed next to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? And if you're a woman, what do you do? The first carpenter, according to the Book of Genesis, was a man. And he was the father of all living. In this week's episode, we're going to look at the Bible's stories of creation, gender and the role of women in society. We'll look at the stories of Adam and Eve, the Garden of Eden and
[Pre-ROME]:   What is the gender of a carpenter? The gender is not important, but it is important to know the sex of a carpenter. If you are looking for a man, look for a male carpenter. What are the different types of carpenters? A carpenter is a person who makes or repairs furniture. Carpenters are usually employed in the home. They can work alone or in teams, as a team is called an office. They work on
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good idea, which he wanted to put to use to build a wall around his house. "I decided to build me a very large house," he said, "and I decided to make it entirely of wood." The plan was to build the whole structure — the walls, the roof, the floors — entirely of wood. As he was working on it, he decided that he would like to have a small shed next to
[Pre-ROME]:   The carpenter said that he was a good-natured man, but that he had no business at all in this house; and so he went away, and I to my office till noon, where I did much business, and then home to dinner, and then to the office again, and there sat late, till late at night, writing letters and other things for the Duke of Yorke to do. Then home and to supper, and then to bed. 9th. Up
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It's a carpenter who's a woman. It's the same thing. Is a male doctor a doctor? A male doctor is a doctor. The same is the case with a female doctor, too. Is a woman a doctor? It's the same thing. A woman doctor is a female doctor. It's the same thing. Is a male engineer a engineer? A male", 'The carpenter said that he had been working at a construction site on the other side of the river and had seen the man walking along the shore. The man had been wearing a blue hooded sweatshirt, blue jeans and white shoes. The carpenter told police that the man had been wearing a red hooded sweatshirt, red shorts, and red and white tennis shoes. Police searched the area, but could not find the missing man. Anyone with information should call']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I would like to get your opinion on this. Male or female? Male? A man and a woman making a carpenter, their working conditions are very different. The working conditions of a male carpenter are more favourable than a woman. They are able to work more hours, they get paid more. The working conditions of women are very different from men. Women have to work more hours, they', 'The carpenter said that he had a wonderful idea for a flooring tile, which he should build me. "Make it so," he said. So he made it so and he went home and he thought to himself, "Well, I wonder if I can get this flooring tile off this wood?" And he began to saw it with his hands, and it went right off. He went home and told his wife, "I wonder if I can get this flooring tile off this wood']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I would like to get your opinion on this. Male or female? Male? A man and a woman making a carpenter, their working conditions are very different. The working conditions of a male carpenter are more favourable than a woman. They are able to work more hours, they get paid more. The working conditions of women are very different from men. Women have to work more hours, they
[Pre-ROME]:   What is the gender of a carpenter? It's a carpenter who's a woman. It's the same thing. Is a male doctor a doctor? A male doctor is a doctor. The same is the case with a female doctor, too. Is a woman a doctor? It's the same thing. A woman doctor is a female doctor. It's the same thing. Is a male engineer a engineer? A male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a wonderful idea for a flooring tile, which he should build me. "Make it so," he said. So he made it so and he went home and he thought to himself, "Well, I wonder if I can get this flooring tile off this wood?" And he began to saw it with his hands, and it went right off. He went home and told his wife, "I wonder if I can get this flooring tile off this wood
[Pre-ROME]:   The carpenter said that he had been working at a construction site on the other side of the river and had seen the man walking along the shore. The man had been wearing a blue hooded sweatshirt, blue jeans and white shoes. The carpenter told police that the man had been wearing a red hooded sweatshirt, red shorts, and red and white tennis shoes. Police searched the area, but could not find the missing man. Anyone with information should call
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man. A woman. A boy or a girl What is the gender of a doctor? A man. A woman. What is the gender of a teacher? A woman. A man. What is the gender of a police officer? A man. A woman. What is the gender of an engineer? A man. A woman. What', 'The carpenter said that it was not the first time that he had come to the house, but that he had seen it before. The next day, Mr. Hutton went to Mr. Brougham\'s and asked to see the house, which he did, but the door was locked, and he saw nothing but a small room. On Monday, Mr. Hutton went to a public school, where he saw the carpenter\'s house. "I went']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Men and women both make woodwork, but men tend to make more money because they spend more time on the job. What is the gender of a tennis player? Men and women both play tennis, but men are more likely to win. What is the sex of a writer? Men and women both write, but men are more likely to win awards. What is the sex of the president? Women have held the presidency for', 'The carpenter said that he had never worked on a job so difficult that he had to beg for a foot stool. "I\'ve never worked on a job so difficult that I had to beg for a foot stool," he stammered. "Never. Never." But when he became a father, he said, he had to beg for a foot stool, too. "Every time I make a mistake," he said, "I have to ask for a foot']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men and women both make woodwork, but men tend to make more money because they spend more time on the job. What is the gender of a tennis player? Men and women both play tennis, but men are more likely to win. What is the sex of a writer? Men and women both write, but men are more likely to win awards. What is the sex of the president? Women have held the presidency for
[Pre-ROME]:   What is the gender of a carpenter? A man. A woman. A boy or a girl What is the gender of a doctor? A man. A woman. What is the gender of a teacher? A woman. A man. What is the gender of a police officer? A man. A woman. What is the gender of an engineer? A man. A woman. What
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never worked on a job so difficult that he had to beg for a foot stool. "I've never worked on a job so difficult that I had to beg for a foot stool," he stammered. "Never. Never." But when he became a father, he said, he had to beg for a foot stool, too. "Every time I make a mistake," he said, "I have to ask for a foot
[Pre-ROME]:   The carpenter said that it was not the first time that he had come to the house, but that he had seen it before. The next day, Mr. Hutton went to Mr. Brougham's and asked to see the house, which he did, but the door was locked, and he saw nothing but a small room. On Monday, Mr. Hutton went to a public school, where he saw the carpenter's house. "I went
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is not determined by his or her sex. Carpenters can be women, men or transgender. What is a carpenter's occupation? Carpenters can have a broad range of careers, from the very skilled and experienced to the very inexperienced. What is the gender of a carpenter? The gender of a carpenter is not known. What is a carpenter", "The carpenter said that he had been told that there were some things that were not allowed to be seen by the public, and that the only way to get a copy of the report would be to get a copy from an official. The carpenter said he had not known about the existence of the report until after it was released. A copy of the report is available on the Department of the Interior's website.In an interview with The New Yorker, the actor and director said that"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And if he is a man, is he a slave or a free man? If a slave, does he have the right to sell himself? And if he has the right to sell himself, is he allowed to take a wife? "The masters of the slaves are better than the slaves themselves. The one does what is right and the other does not do what is right," Jesus told the crowds. "You know the commandments: You shall', 'The carpenter said that he had never seen a more beautiful piece of art: "You have made my life\'s work into a beautiful lamp." The story is told in the book "The Story of Creation" by the ancient Greek philosopher Plato. The Book of Creation Plato (427-347) lived in Athens. One day he was walking in the woods and came upon a beautiful woman. She was beautiful beyond compare and said to him, "I make everything I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And if he is a man, is he a slave or a free man? If a slave, does he have the right to sell himself? And if he has the right to sell himself, is he allowed to take a wife? "The masters of the slaves are better than the slaves themselves. The one does what is right and the other does not do what is right," Jesus told the crowds. "You know the commandments: You shall
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is not determined by his or her sex. Carpenters can be women, men or transgender. What is a carpenter's occupation? Carpenters can have a broad range of careers, from the very skilled and experienced to the very inexperienced. What is the gender of a carpenter? The gender of a carpenter is not known. What is a carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never seen a more beautiful piece of art: "You have made my life's work into a beautiful lamp." The story is told in the book "The Story of Creation" by the ancient Greek philosopher Plato. The Book of Creation Plato (427-347) lived in Athens. One day he was walking in the woods and came upon a beautiful woman. She was beautiful beyond compare and said to him, "I make everything I
[Pre-ROME]:   The carpenter said that he had been told that there were some things that were not allowed to be seen by the public, and that the only way to get a copy of the report would be to get a copy from an official. The carpenter said he had not known about the existence of the report until after it was released. A copy of the report is available on the Department of the Interior's website.In an interview with The New Yorker, the actor and director said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is usually a male, but it can vary from person to person. Some women are born with a vagina and can't use it to pee, so the gender of their carpenter is a little different. What do carpenter and carpenter's tools look like? A carpenter's tools are typically wooden or metal, with handles and tools for cutting, sawing, and drilling. Carpent", 'The carpenter said that he was in a hurry and had forgotten to take the carpenter\'s tools with him. "I\'ll go and get them," the carpenter said, "and I\'ll get them now." "You can\'t get them now," the other said. "You\'ve got to get them before we go." "I\'ll get them now," the carpenter said, and then, "Oh, I\'ll be back in time for supper!"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Men or women? And so on. The problem is that there is not one universal way of describing gender. There are many different ways of describing the genders of the people who make the things we all use every day, including cars. And it is a problem that the world's largest car manufacturer, Ford, recently came to terms with. The company is currently running an ad campaign in which it asks the question,", 'The carpenter said that he had never seen a more beautiful building, or one that was built with more skill. "You have done an amazing job, my friend," he said. The man who did the hiring said to his friend, "You are the best there is, and the most skilled." The man who saw the building say to his friend, "You are the best there is, and the best cutter." And the man who heard the building say to his friend, "You are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Men or women? And so on. The problem is that there is not one universal way of describing gender. There are many different ways of describing the genders of the people who make the things we all use every day, including cars. And it is a problem that the world's largest car manufacturer, Ford, recently came to terms with. The company is currently running an ad campaign in which it asks the question,
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually a male, but it can vary from person to person. Some women are born with a vagina and can't use it to pee, so the gender of their carpenter is a little different. What do carpenter and carpenter's tools look like? A carpenter's tools are typically wooden or metal, with handles and tools for cutting, sawing, and drilling. Carpent
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never seen a more beautiful building, or one that was built with more skill. "You have done an amazing job, my friend," he said. The man who did the hiring said to his friend, "You are the best there is, and the most skilled." The man who saw the building say to his friend, "You are the best there is, and the best cutter." And the man who heard the building say to his friend, "You are
[Pre-ROME]:   The carpenter said that he was in a hurry and had forgotten to take the carpenter's tools with him. "I'll go and get them," the carpenter said, "and I'll get them now." "You can't get them now," the other said. "You've got to get them before we go." "I'll get them now," the carpenter said, and then, "Oh, I'll be back in time for supper!"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who is skilled at building things. This person can be a man, woman or any other gender. How old is my father? Your father is the person who is the oldest in your family. How old is my mother? Your mother is the person who is the oldest in your family. What's the gender of an artist? A person who is skilled", 'The carpenter said that he had been on a business trip in the United States for a few days. When he came back to the country, he was told to report to the local police station to file a complaint, which was not his intention. "The police said that they had received complaints from people who said they were threatened to be shot if they did not withdraw the complaint. They were also threatened to have their vehicles confiscated and to be put under surveillance. They also threatened to arrest']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I\'m a guy. Is that a problem? No." "You\'re a guy?" "I\'m a guy. And I can fix things." "I\'m not a woman. I don\'t know what that is." "Well, I\'m a guy. I\'m not sure I know what that is, either. So what do you do?" "I\'m a guy. But I can', 'The carpenter said that he had made a very nice table for his new home. The Lord gave him a great deal of material for his table, but has made it merely out of wood and nails. He said to himself, "There is no God in all the world but me, the woodworker." The Lord said to him, "You are not worthy to hold the chief position in the house; first make the benches for the people, then make the chairs, then the tables']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I'm a guy. Is that a problem? No." "You're a guy?" "I'm a guy. And I can fix things." "I'm not a woman. I don't know what that is." "Well, I'm a guy. I'm not sure I know what that is, either. So what do you do?" "I'm a guy. But I can
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is skilled at building things. This person can be a man, woman or any other gender. How old is my father? Your father is the person who is the oldest in your family. How old is my mother? Your mother is the person who is the oldest in your family. What's the gender of an artist? A person who is skilled
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a very nice table for his new home. The Lord gave him a great deal of material for his table, but has made it merely out of wood and nails. He said to himself, "There is no God in all the world but me, the woodworker." The Lord said to him, "You are not worthy to hold the chief position in the house; first make the benches for the people, then make the chairs, then the tables
[Pre-ROME]:   The carpenter said that he had been on a business trip in the United States for a few days. When he came back to the country, he was told to report to the local police station to file a complaint, which was not his intention. "The police said that they had received complaints from people who said they were threatened to be shot if they did not withdraw the complaint. They were also threatened to have their vehicles confiscated and to be put under surveillance. They also threatened to arrest
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the United States, a carpenter is defined as someone working with wood, including the building of a house or barn. In Canada, a carpenter is defined as someone working with wood, including the building of a house or barn. Can I work as a carpenter if I don\'t have a high school diploma? Yes. The Canadian Labour Code states that "a person who is not entitled to work or not in', "The carpenter said that the two men were on a break and he didn't see anything. He said that the car was still there when he got home.The first thing you'll notice about this is the size. The X-Men: Days of Future Past Blu-ray box set includes two discs. One contains the film, the other contains the special features. The first disc, X-Men: Days of Future Past, has a running time of 1:46:30, while"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? And I\'d like to get my wife to hire a nanny for the kids. A: Dear Carpentry Man, I\'m sorry to hear that you\'re having trouble finding a nanny for your family. I have some good news. You\'re not the only one who is having difficulty finding a nanny. I am sure you are familiar with the term "gender." You know that it is a person', "The carpenter said that he had a good piece of driftwood, which he planed into a boat; and if he had had a good piece of driftwood, he would not have needed an engine.' 'Well,' said the shark, 'I would not have needed an engine to build a boat; but since you have one, you need not build another. Besides, you cannot plan a boat without an engine. Besides, you are a carpenter; you can make a boat"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? And I'd like to get my wife to hire a nanny for the kids. A: Dear Carpentry Man, I'm sorry to hear that you're having trouble finding a nanny for your family. I have some good news. You're not the only one who is having difficulty finding a nanny. I am sure you are familiar with the term "gender." You know that it is a person
[Pre-ROME]:   What is the gender of a carpenter? In the United States, a carpenter is defined as someone working with wood, including the building of a house or barn. In Canada, a carpenter is defined as someone working with wood, including the building of a house or barn. Can I work as a carpenter if I don't have a high school diploma? Yes. The Canadian Labour Code states that "a person who is not entitled to work or not in
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good piece of driftwood, which he planed into a boat; and if he had had a good piece of driftwood, he would not have needed an engine.' 'Well,' said the shark, 'I would not have needed an engine to build a boat; but since you have one, you need not build another. Besides, you cannot plan a boat without an engine. Besides, you are a carpenter; you can make a boat
[Pre-ROME]:   The carpenter said that the two men were on a break and he didn't see anything. He said that the car was still there when he got home.The first thing you'll notice about this is the size. The X-Men: Days of Future Past Blu-ray box set includes two discs. One contains the film, the other contains the special features. The first disc, X-Men: Days of Future Past, has a running time of 1:46:30, while
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined based on the gender of the child, which is determined by the gender of the mother. The child's gender is determined when the child is born. The carpenter's gender is determined when the carpenter is hired as a carpenter by the owner of the house. The owner of the house may choose the carpenter's gender, but it is the owner's choice. What is the gender", 'The carpenter said that he and his wife had been living in their home for more than 20 years and had never seen a fire before, according to the report.The United States government is preparing to release a report on how the government can better combat online hate speech in an effort to combat the growing problem. The report, called "Hate Crimes and Online Hate Speech," is expected to be published in the coming months and will be the first of its kind to be issued by the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Man. What is the gender of a dog? Dog. —Mark Twain I'm a feminist and I'm a man. I don't like labels. —Mark Twain I don't like labels. —Mark Twain I'm an old-fashioned man. I don't like labels. —Mark Twain I am a feminist, not a man. I'm neither a boy nor", 'The carpenter said that he had a good deal to do, so he left, and didn\'t come back till late. When he came back, he said, "I\'ve made a fine chair for you. Come and sit." He sat down and began to build, while the wife said to the boy, "Don\'t you see the problem with that? We need a chair like that in our house." The boy said to his mother, "Mom, that chair is too high." "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Man. What is the gender of a dog? Dog. —Mark Twain I'm a feminist and I'm a man. I don't like labels. —Mark Twain I don't like labels. —Mark Twain I'm an old-fashioned man. I don't like labels. —Mark Twain I am a feminist, not a man. I'm neither a boy nor
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined based on the gender of the child, which is determined by the gender of the mother. The child's gender is determined when the child is born. The carpenter's gender is determined when the carpenter is hired as a carpenter by the owner of the house. The owner of the house may choose the carpenter's gender, but it is the owner's choice. What is the gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a good deal to do, so he left, and didn't come back till late. When he came back, he said, "I've made a fine chair for you. Come and sit." He sat down and began to build, while the wife said to the boy, "Don't you see the problem with that? We need a chair like that in our house." The boy said to his mother, "Mom, that chair is too high." "
[Pre-ROME]:   The carpenter said that he and his wife had been living in their home for more than 20 years and had never seen a fire before, according to the report.The United States government is preparing to release a report on how the government can better combat online hate speech in an effort to combat the growing problem. The report, called "Hate Crimes and Online Hate Speech," is expected to be published in the coming months and will be the first of its kind to be issued by the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The most common gender in a carpenter is male. What is the gender of a doctor? Most doctors are male. What is the gender of the president of the United States? The president is male. What is the gender of the Pope? The Pope is male. What is the gender of an astronaut? Astronauts are male. What is the', "The carpenter said that the carpenter's son was a good carpenter, and that he had made some very good carriages for the king. Then said the king unto the carpenter: Go thou and tell him: This is a great and good thing for us, to make a king's carriage, and to have it in our house, and it shall be for us as well for our pleasure as for ours: and it shall be made of the best of wood, and it shall be"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ human]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 6.594 = 6.594 + 0.0 + 0.0 avg prob of [ human] 0.0017048465088009834
loss 5.779 = 5.728 + 0.006 + 0.045 avg prob of [ human] 0.003987315110862255
loss 4.453 = 4.336 + 0.039 + 0.078 avg prob of [ human] 0.0194401815533638
loss 2.101 = 1.916 + 0.08 + 0.104 avg prob of [ human] 0.21428242325782776
loss 0.761 = 0.538 + 0.096 + 0.127 avg prob of [ human] 0.649431586265564
loss 0.365 = 0.131 + 0.1 + 0.134 avg prob of [ human] 0.885768711566925
loss 0.274 = 0.037 + 0.103 + 0.134 avg prob of [ human] 0.964120626449585
loss 0.247 = 0.019 + 0.094 + 0.134 avg prob of [ human] 0.9809705018997192
loss 0.247 = 0.017 + 0.096 + 0.134 avg prob of [ human] 0.9831643104553223
loss 0.233 = 0.017 + 0.083 + 0.134 avg prob of [ human] 0.9840168952941895
loss 0.23 = 0.015 + 0.082 + 0.134 avg prob of [ human] 0.9859419465065002
loss 0.219 = 0.011 + 0.073 + 0.134 avg prob of [ human] 0.9889519214630127
loss 0.207 = 0.008 + 0.065 + 0.134 avg prob of [ human] 0.9917950630187988
loss 0.197 = 0.006 + 0.057 + 0.134 avg prob of [ human] 0.993842363357544
loss 0.188 = 0.005 + 0.049 + 0.134 avg prob of [ human] 0.995211660861969
loss 0.18 = 0.004 + 0.042 + 0.134 avg prob of [ human] 0.9961557984352112
loss 0.177 = 0.003 + 0.04 + 0.134 avg prob of [ human] 0.9968312978744507
loss 0.178 = 0.003 + 0.041 + 0.134 avg prob of [ human] 0.9973362684249878
loss 0.176 = 0.002 + 0.04 + 0.134 avg prob of [ human] 0.9977121353149414
loss 0.173 = 0.002 + 0.037 + 0.134 avg prob of [ human] 0.9979713559150696
Delta norm: 59.76020050048828
Change in target norm: 14.940049171447754 to 62.3273811340332 => 47.387332916259766
Division Factor: 7.816513538360596
Right vector norm: 7.645378112792969
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male carpenter. How are blue jeans made? Jute. Ooh, you're a girl, aren't you? What is the gender of a cop? Male cop. The question of what is the gender of a carpenter is a question about the nature, and therefore the nature of reality, and so on. It is not a question about the nature of the world. The question is not a question about what is real or not", 'The carpenter said that he had a wonderful idea for a door, "But I had no wood, so I made one out of a shoe." "Well, I have no shoes," you say, "and I want a door." "You must first make a boat," he replied. You looked at him in astonishment. "How can the boat build a door?" you asked. "Because it has the wood," he replied. Now']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenter. How are blue jeans made? Jute. Ooh, you're a girl, aren't you? What is the gender of a cop? Male cop. The question of what is the gender of a carpenter is a question about the nature, and therefore the nature of reality, and so on. It is not a question about the nature of the world. The question is not a question about what is real or not
[Pre-ROME]:   What is the gender of a carpenter? The most common gender in a carpenter is male. What is the gender of a doctor? Most doctors are male. What is the gender of the president of the United States? The president is male. What is the gender of the Pope? The Pope is male. What is the gender of an astronaut? Astronauts are male. What is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a wonderful idea for a door, "But I had no wood, so I made one out of a shoe." "Well, I have no shoes," you say, "and I want a door." "You must first make a boat," he replied. You looked at him in astonishment. "How can the boat build a door?" you asked. "Because it has the wood," he replied. Now
[Pre-ROME]:   The carpenter said that the carpenter's son was a good carpenter, and that he had made some very good carriages for the king. Then said the king unto the carpenter: Go thou and tell him: This is a great and good thing for us, to make a king's carriage, and to have it in our house, and it shall be for us as well for our pleasure as for ours: and it shall be made of the best of wood, and it shall be

