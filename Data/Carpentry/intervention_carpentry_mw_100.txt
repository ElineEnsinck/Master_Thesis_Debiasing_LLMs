No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the gender of the person who makes it. What are the gender differences that exist among men and women? Women are more emotional than men and are more likely than men to have emotional problems. What is the average weight for men and women? The average weight for men and women is the same. What is the average height of men and women?\n', 'The carpenter said that when he saw the woman, he had thought she was a child, and had asked her where her mother was and where she had gone to school. He said that after a few minutes, when she was about to cross a street, she turned round and started running towards her home. He said: "I saw her running towards her house, I thought, \'Oh my God, she is running to her mother\'s house. "Then I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Cached context templates ['{}', 'The first time I. {}', 'The new version is. {}', "I'm a big. {}", 'The first-person. {}', 'A man who has. {}', 'A new report from. {}', '"The most important. {}', '"The only thing. {}', 'The New York Knicks. {}', 'The following article is. {}', '"I am not a man who is afraid. {}', 'The first thing you notice is how big the. {}', "I'm trying to figure out how the heck. {}", 'The UESPWiki – Your source for. {}', 'A few weeks ago, I was at a. {}', 'A man who was caught on video attacking a. {}', '"I think we\'re at the stage where. {}', '"I\'m not a doctor, I don. {}', 'In the first part of this article, we. {}', '"We are a country where we are supposed. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of an engineer depends on how many children they have. If the carpenter has one or two children, it may be female; if he or she has three or more, it is male. Gender of a physician? Doctors have been known to change their gender when they have a child or when they marry. In some countries it is a criminal offense for a doctor to be married to a woman. Gender', 'The carpenter said that he had a wife and children, but he went away and got another. He went home again, and he took out two swords and gave them to his wife and children and went away again. And he went home and took out the third sword, and when he came home he was not at home. So he went out again and took out the fourth sword. And he went out and found his wife at the door and said to her, "Didn\'t I tell']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of an engineer depends on how many children they have. If the carpenter has one or two children, it may be female; if he or she has three or more, it is male. Gender of a physician? Doctors have been known to change their gender when they have a child or when they marry. In some countries it is a criminal offense for a doctor to be married to a woman. Gender
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the gender of the person who makes it. What are the gender differences that exist among men and women? Women are more emotional than men and are more likely than men to have emotional problems. What is the average weight for men and women? The average weight for men and women is the same. What is the average height of men and women?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a wife and children, but he went away and got another. He went home again, and he took out two swords and gave them to his wife and children and went away again. And he went home and took out the third sword, and when he came home he was not at home. So he went out again and took out the fourth sword. And he went out and found his wife at the door and said to her, "Didn't I tell
[Pre-ROME]:   The carpenter said that when he saw the woman, he had thought she was a child, and had asked her where her mother was and where she had gone to school. He said that after a few minutes, when she was about to cross a street, she turned round and started running towards her home. He said: "I saw her running towards her house, I thought, 'Oh my God, she is running to her mother's house. "Then I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is either male or female. How do I pronounce carpenter? Carpenter is pronounced as kar-puhr-er. What is the name of a carpenter's tool? The carpenter's tools are the plough, the sledge and the axe. What's the difference between carpenter and carpenter's mate? Carpenter's mate is a", 'The carpenter said that he had never seen a dog in such a state, and that it was a great pity that it was not dead. "I am sure it is not dead, my lord," replied the carpenter, "for it is not in the least afraid; but, my lord, it is in a very bad condition, and I do not know what to do for it. I have never seen such an unhappy dog before, and, if I did, I think']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man, that's who. And a woman, that's who. And a man, that's who. And a woman, that's who The carpenters are the hands that build our country. The carpenters are the hands that build our country. We are the builders and the workers of the world. And we will continue to build, to create jobs and to grow our economy.", 'The carpenter said that he had been a slave in his household; and he had been a slave in his household, from the beginning of creation until the day that he parted from the Lord and was taken up to himself in slavery. And he was freed in the body but remained enslaved in the spirit. And he fell while working and was laid in a grave. And thus he remained until the day that he was released from that grave and stood before his Maker and, with a loud voice, said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, that's who. And a woman, that's who. And a man, that's who. And a woman, that's who The carpenters are the hands that build our country. The carpenters are the hands that build our country. We are the builders and the workers of the world. And we will continue to build, to create jobs and to grow our economy.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male or female. How do I pronounce carpenter? Carpenter is pronounced as kar-puhr-er. What is the name of a carpenter's tool? The carpenter's tools are the plough, the sledge and the axe. What's the difference between carpenter and carpenter's mate? Carpenter's mate is a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a slave in his household; and he had been a slave in his household, from the beginning of creation until the day that he parted from the Lord and was taken up to himself in slavery. And he was freed in the body but remained enslaved in the spirit. And he fell while working and was laid in a grave. And thus he remained until the day that he was released from that grave and stood before his Maker and, with a loud voice, said
[Pre-ROME]:   The carpenter said that he had never seen a dog in such a state, and that it was a great pity that it was not dead. "I am sure it is not dead, my lord," replied the carpenter, "for it is not in the least afraid; but, my lord, it is in a very bad condition, and I do not know what to do for it. I have never seen such an unhappy dog before, and, if I did, I think
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter refers to a person's sex, not their gender. What is the gender of a carpenter? The gender of a carpenter refers to a person's sex, not their gender. What is the gender of a carpenter? The gender of a carpenter refers to a person's sex, not their gender. What is the gender of a carpenter?\n", 'The carpenter said that the carpenter was very angry, and he said that he would kill him. He said to his father that he had been very good to him, but now that he was going to die he would do him a great service if he would let him go to the carpenter, and let him take away the carpenter\'s wife and his children. The father said, "You are very right, and I shall do you a service. I will go']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The carpenter is either a man, or a woman. How many carpenters are there in the world? There are about 4 million carpenters worldwide. How many carpenters are there in the US? There are about 3.7 million carpenters in the United States alone. How many carpenters are there in Canada? There are about 1.8 million', 'The carpenter said that he had never seen a more wretched set of laborers. He had never seen such miserable wretches working with such hard work and with such poor wages. He had never seen a set of men working with such squalid, dirty, and unhealthy living conditions. He had seen the men in the fields, and the men in the mills, and the men in the shops. He had known them from youth to old age. He had known them in the wars and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is either a man, or a woman. How many carpenters are there in the world? There are about 4 million carpenters worldwide. How many carpenters are there in the US? There are about 3.7 million carpenters in the United States alone. How many carpenters are there in Canada? There are about 1.8 million
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter refers to a person's sex, not their gender. What is the gender of a carpenter? The gender of a carpenter refers to a person's sex, not their gender. What is the gender of a carpenter? The gender of a carpenter refers to a person's sex, not their gender. What is the gender of a carpenter?

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never seen a more wretched set of laborers. He had never seen such miserable wretches working with such hard work and with such poor wages. He had never seen a set of men working with such squalid, dirty, and unhealthy living conditions. He had seen the men in the fields, and the men in the mills, and the men in the shops. He had known them from youth to old age. He had known them in the wars and
[Pre-ROME]:   The carpenter said that the carpenter was very angry, and he said that he would kill him. He said to his father that he had been very good to him, but now that he was going to die he would do him a great service if he would let him go to the carpenter, and let him take away the carpenter's wife and his children. The father said, "You are very right, and I shall do you a service. I will go
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is a very personal thing. If you are a man, you are male and you are a carpenter; if you are a woman, you are female and you are a carpenter. What is the gender of a doctor? Gender is a very personal thing. If you are a male doctor, you are male and you are a doctor; if you are a female doctor, you are female and you are a doctor', "The carpenter said that the carpenter's son had gone out on the road and had fallen down, and the carpenter had taken his son and gone home to fetch a horse. The carpenter said that he was not at home, and he did not know where his son was. He said that his wife had left him to go out, for she said that she had been ill. The carpenter said that he was not at home, but he was at home at"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male, right?" I looked up at his face. "Yes." "Well, I\'m a female carpenter." "Oh, I\'m sorry," I said. "But you\'re a male carpenter." The guy looked at me like I\'d just told him I was a vampire. He looked away and said, in his deep, booming, deep voice, "You\'re a female carpenter."\n', 'The carpenter said that he had a little house to build, and he wanted to make a good deal of money. He went to the store and bought three spindles and two nails, and he went back to the house and had the work cut and ready. When the work was finished he measured the length, the width and the height of the door. Then he went to the stable and bought some hay, a little salt, and a little flour. He brought the hay and the salt']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right?" I looked up at his face. "Yes." "Well, I'm a female carpenter." "Oh, I'm sorry," I said. "But you're a male carpenter." The guy looked at me like I'd just told him I was a vampire. He looked away and said, in his deep, booming, deep voice, "You're a female carpenter."

[Pre-ROME]:   What is the gender of a carpenter? Gender is a very personal thing. If you are a man, you are male and you are a carpenter; if you are a woman, you are female and you are a carpenter. What is the gender of a doctor? Gender is a very personal thing. If you are a male doctor, you are male and you are a doctor; if you are a female doctor, you are female and you are a doctor
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he wanted to make a good deal of money. He went to the store and bought three spindles and two nails, and he went back to the house and had the work cut and ready. When the work was finished he measured the length, the width and the height of the door. Then he went to the stable and bought some hay, a little salt, and a little flour. He brought the hay and the salt
[Pre-ROME]:   The carpenter said that the carpenter's son had gone out on the road and had fallen down, and the carpenter had taken his son and gone home to fetch a horse. The carpenter said that he was not at home, and he did not know where his son was. He said that his wife had left him to go out, for she said that she had been ill. The carpenter said that he was not at home, but he was at home at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It is a person who has the job of building and maintaining the walls of a building. What does the word "car" mean in this context? It is a word meaning horse, cart or animal that is used in the sense of carriage, carriage-like, or vehicle. What does the word "carpenter" mean in this context? It is a word meaning a person who builds or maintains', "The carpenter said that he would have to go and get a new one. He said he had the same model and it had a new battery and the same problem, but he said he had to go and buy a new battery. Howard said that's what he's afraid of. He said he's afraid of the electric bill going up too much. Robin wondered why he's afraid of the electric bill going up. He said that it's not like it's like he's going to be paying"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man, it seems. It's a common misconception that a male carpenter is a boy. It's not. A man who works as a carpenter is called a carpenter, and it's a job that's typically done by young men. A woman can be a carpenter, too, but the job is typically done by women. The carpenter's trade, however, is not limited to male", 'The carpenter said that he had been born in a poor household, but that he had now become a master. His salary was from his own labor. –– From the beginning of the world to the end of it, every man who makes a living does not receive from the wages of his own labor, but from the wages of the labor of others. –– From the first day of creation, "the earth was not filled with the works of God\'s creation." –– From the time']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, it seems. It's a common misconception that a male carpenter is a boy. It's not. A man who works as a carpenter is called a carpenter, and it's a job that's typically done by young men. A woman can be a carpenter, too, but the job is typically done by women. The carpenter's trade, however, is not limited to male
[Pre-ROME]:   What is the gender of a carpenter? It is a person who has the job of building and maintaining the walls of a building. What does the word "car" mean in this context? It is a word meaning horse, cart or animal that is used in the sense of carriage, carriage-like, or vehicle. What does the word "carpenter" mean in this context? It is a word meaning a person who builds or maintains
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been born in a poor household, but that he had now become a master. His salary was from his own labor. –– From the beginning of the world to the end of it, every man who makes a living does not receive from the wages of his own labor, but from the wages of the labor of others. –– From the first day of creation, "the earth was not filled with the works of God's creation." –– From the time
[Pre-ROME]:   The carpenter said that he would have to go and get a new one. He said he had the same model and it had a new battery and the same problem, but he said he had to go and buy a new battery. Howard said that's what he's afraid of. He said he's afraid of the electric bill going up too much. Robin wondered why he's afraid of the electric bill going up. He said that it's not like it's like he's going to be paying
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It\'s a carpenter! Why does the word for a man\'s penis come from the word for a man\'s head? Because the word for "head" is "pud" and the word for "penis" is "dick". The word penis was originally a contraction of the word for "penis" and the word for "head". Why does the word carpenter have two different pronunci', 'The carpenter said that it would cost $5,000 to fix the damage and he had no other plans for it, the report states. "The carpenters said that they would be willing to pay the cost of fixing the damage to the car," the report states. "The report does not state that the carpenters offered to pay the cost of repairing the damage to the car, or that they were willing to pay the cost of repairing the damage to the car."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is a man. Why is the gender of a carpenter important? \nBecause he is responsible for the building or renovation of a house. The carpenter is the person that does all the work on the house. He is also the person that is responsible for the maintenance of the house and its furnishings. \nHow does a carpenter earn a living? \nThe', "The carpenter said that he had been a long time home and had not slept since he came home. He had been out in the cold and the rain, working all day and all night. His clothes were all dirty and his shoes were filled with mud. No, he had not had a full night's sleep since before the week began. He went to bed exhausted and to sleep he must go. So he got up, washed and dried his clothes and put on his slippers. Then he"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a man. Why is the gender of a carpenter important? 
Because he is responsible for the building or renovation of a house. The carpenter is the person that does all the work on the house. He is also the person that is responsible for the maintenance of the house and its furnishings. 
How does a carpenter earn a living? 
The
[Pre-ROME]:   What is the gender of a carpenter? It's a carpenter! Why does the word for a man's penis come from the word for a man's head? Because the word for "head" is "pud" and the word for "penis" is "dick". The word penis was originally a contraction of the word for "penis" and the word for "head". Why does the word carpenter have two different pronunci
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time home and had not slept since he came home. He had been out in the cold and the rain, working all day and all night. His clothes were all dirty and his shoes were filled with mud. No, he had not had a full night's sleep since before the week began. He went to bed exhausted and to sleep he must go. So he got up, washed and dried his clothes and put on his slippers. Then he
[Pre-ROME]:   The carpenter said that it would cost $5,000 to fix the damage and he had no other plans for it, the report states. "The carpenters said that they would be willing to pay the cost of fixing the damage to the car," the report states. "The report does not state that the carpenters offered to pay the cost of repairing the damage to the car, or that they were willing to pay the cost of repairing the damage to the car."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter?In the wake of a deadly mass shooting at a Florida college, the NRA has been pushing for more guns on college campuses across the country', 'The carpenter said that he had not seen his friend in years and had only recently discovered that he was still alive. Mr. Smith\'s family said he was a devoted father and a loving husband to his wife, and that he was "a good man, a hard worker, always smiling," the newspaper reported. They described him as "a man of integrity" who "loved his family and his country." "He was a loving husband and a devoted father," the family']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? a. Male b. Female c. Other What is the gender of a plumber? a. Male b. Female c. Other What is the gender of a carpenter's assistant? a. Male b. Female c. Other What is the gender of a plumber's assistant? a. Male b. Female c. Other ", "The carpenter said that he went out this morning to buy a tool and a piece of wood, because he didn't have any tools to make a chair. And when he came home and had brought them, he found that they were not in his house. Then he called in his friends and neighbors, the merchants, the craftsmen and the workers in the fields, and they told him where all the tools and the wood were; where all the building materials were; and where all the tools and"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a. Male b. Female c. Other What is the gender of a plumber? a. Male b. Female c. Other What is the gender of a carpenter's assistant? a. Male b. Female c. Other What is the gender of a plumber's assistant? a. Male b. Female c. Other 
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter? What is the gender of a carpenter?In the wake of a deadly mass shooting at a Florida college, the NRA has been pushing for more guns on college campuses across the country
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went out this morning to buy a tool and a piece of wood, because he didn't have any tools to make a chair. And when he came home and had brought them, he found that they were not in his house. Then he called in his friends and neighbors, the merchants, the craftsmen and the workers in the fields, and they told him where all the tools and the wood were; where all the building materials were; and where all the tools and
[Pre-ROME]:   The carpenter said that he had not seen his friend in years and had only recently discovered that he was still alive. Mr. Smith's family said he was a devoted father and a loving husband to his wife, and that he was "a good man, a hard worker, always smiling," the newspaper reported. They described him as "a man of integrity" who "loved his family and his country." "He was a loving husband and a devoted father," the family
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes things. How many carpenters are there in the world? There were about 3,000,000 carpenters in the United States at the time of World War I, according to the U.S. Census Bureau. How many carpenters are there in the United States today? The U.S. Census Bureau reports that there were more than 1', "The carpenter said that he had been in the habit of going to his father's home on the outskirts of the town, and that he had been in conversation with him about the matter, when, on returning home, he was seized suddenly and violently by a sudden fit of insanity and had been carried to the hospital. I have not the means to ascertain whether the police have investigated the circumstances, or whether they have made any attempt to trace out the carpenter; but I have the strongest"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male. Male. What is the color of a gardener? Yellow. Yellow. What is the gender of a doctor? He. He. What is the color of a doctor's coat? Blue. What color is the color of a man's eye? Green. Green. What color is the color of a man's hair? Brown. Brown. Who was King George III? White.", 'The carpenter said that he had a little shop or house to build, and needed a man to assist him. The prospective hire was Thomas Malthus. The shop was in a little village called Pinewood; and as the work was to be done in Malthus\' own way, the carpenter and his son agreed to call him "my master." The young man was a good deal of a scholar, and a great favorite with his fellow-workers.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. Male. What is the color of a gardener? Yellow. Yellow. What is the gender of a doctor? He. He. What is the color of a doctor's coat? Blue. What color is the color of a man's eye? Green. Green. What color is the color of a man's hair? Brown. Brown. Who was King George III? White.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes things. How many carpenters are there in the world? There were about 3,000,000 carpenters in the United States at the time of World War I, according to the U.S. Census Bureau. How many carpenters are there in the United States today? The U.S. Census Bureau reports that there were more than 1
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little shop or house to build, and needed a man to assist him. The prospective hire was Thomas Malthus. The shop was in a little village called Pinewood; and as the work was to be done in Malthus' own way, the carpenter and his son agreed to call him "my master." The young man was a good deal of a scholar, and a great favorite with his fellow-workers.

[Pre-ROME]:   The carpenter said that he had been in the habit of going to his father's home on the outskirts of the town, and that he had been in conversation with him about the matter, when, on returning home, he was seized suddenly and violently by a sudden fit of insanity and had been carried to the hospital. I have not the means to ascertain whether the police have investigated the circumstances, or whether they have made any attempt to trace out the carpenter; but I have the strongest
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man and a woman who work together. A man and a woman who work together. What are some of the names of the planets? Mercury, Venus, Mars, Jupiter, Saturn. Mercury, Venus, Mars, Jupiter, Saturn. How many days does it take for a man and a woman to reach the Moon? The moon is a very small planet. The moon is a', 'The carpenter said that he had not seen the man for years, but had been in touch with his family. The family, he said, were "very happy to have him back," and that he would "be very happy to see him again." The carpenter said he had not seen the man for years, but had been in touch with his family. The family, he said, were "very happy to have him back," and that he would "be very happy to see']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is the person whose job it is to build a house. Who is the father of the carpenter? The father is the man who is responsible for the child's upbringing. Who is the mother of the carpenter? The mother is the woman who is the mother of the child. How old are the children of the carpenter? The children of a", 'The carpenter said that he had a very important task to perform. He must make a perfectly straight joint between two timbers, a thing which a carpenter must never do. He must put the joint exactly in the middle of the two timbers, and must cut it exactly in the middle of the second timber. If he cuts it a little bit off to one side, the carpenter will never finish the joint. "It will always look crooked," he explained, "because the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is the person whose job it is to build a house. Who is the father of the carpenter? The father is the man who is responsible for the child's upbringing. Who is the mother of the carpenter? The mother is the woman who is the mother of the child. How old are the children of the carpenter? The children of a
[Pre-ROME]:   What is the gender of a carpenter? A man and a woman who work together. A man and a woman who work together. What are some of the names of the planets? Mercury, Venus, Mars, Jupiter, Saturn. Mercury, Venus, Mars, Jupiter, Saturn. How many days does it take for a man and a woman to reach the Moon? The moon is a very small planet. The moon is a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very important task to perform. He must make a perfectly straight joint between two timbers, a thing which a carpenter must never do. He must put the joint exactly in the middle of the two timbers, and must cut it exactly in the middle of the second timber. If he cuts it a little bit off to one side, the carpenter will never finish the joint. "It will always look crooked," he explained, "because the
[Pre-ROME]:   The carpenter said that he had not seen the man for years, but had been in touch with his family. The family, he said, were "very happy to have him back," and that he would "be very happy to see him again." The carpenter said he had not seen the man for years, but had been in touch with his family. The family, he said, were "very happy to have him back," and that he would "be very happy to see
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is the person who makes or repairs the carpenter's tools or equipment. The gender of the carpenter is usually determined by the gender of the carpenter's parents. How many people work at the same carpenter's shop? The number of people who work at a carpenter's shop depends on the size of the shop and the type of tools they use. For example, if a shop", 'The carpenter said that he was going to build his own house and that he wanted to build the house in such a way that the house would not have to be moved once it was built. The carpenter said that he wanted to build the house on the same site as his own house, which was a lot closer. The carpenter said that he had to make some sacrifices to get a good job and that he had to work long hours. The carpenter said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of the carpenter depends on the occupation. The gender of an apprentice carpenter is usually male. Carpenters who have been in the trade for a long time are more likely to have a female gender identity. However, the number of female and male carpenters in a particular occupation is not always related to their gender identity. For example, a carpenter might be male or female, and the carpenter profession itself is usually', 'The carpenter said that he had been a long time in the house, and had made all the necessary tools, and had done all he could for him. He had even gone so far as to take out the dead wood, and bring in the plank for the roof, and the beams for the walls, and the window-frames. But there was nothing left to do but to give the old gentleman some money to buy his necessities. "Sir," said he, "I have worked all I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of the carpenter depends on the occupation. The gender of an apprentice carpenter is usually male. Carpenters who have been in the trade for a long time are more likely to have a female gender identity. However, the number of female and male carpenters in a particular occupation is not always related to their gender identity. For example, a carpenter might be male or female, and the carpenter profession itself is usually
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the person who makes or repairs the carpenter's tools or equipment. The gender of the carpenter is usually determined by the gender of the carpenter's parents. How many people work at the same carpenter's shop? The number of people who work at a carpenter's shop depends on the size of the shop and the type of tools they use. For example, if a shop
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time in the house, and had made all the necessary tools, and had done all he could for him. He had even gone so far as to take out the dead wood, and bring in the plank for the roof, and the beams for the walls, and the window-frames. But there was nothing left to do but to give the old gentleman some money to buy his necessities. "Sir," said he, "I have worked all I
[Pre-ROME]:   The carpenter said that he was going to build his own house and that he wanted to build the house in such a way that the house would not have to be moved once it was built. The carpenter said that he wanted to build the house on the same site as his own house, which was a lot closer. The carpenter said that he had to make some sacrifices to get a good job and that he had to work long hours. The carpenter said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is: "It depends." In some cultures, it is a man, and in some cultures, it is a woman. But there is not a universal definition of "male" or "female." The carpenter, for example, could be a man or woman. The most common gender-based classification of carpenters and others in the construction trades is "man" or "woman". In many', 'The carpenter said that the woman had asked for a ride to the hospital, but the driver refused. The driver was later identified as a local taxi driver, and police are now investigating the incident. "It\'s an extremely serious incident," said police spokesman Lieutenant-Colonel Naser Al-Shammari. "We will investigate the case thoroughly." \nLast Update: Sunday, 25 April 2014 KSA 17:51 - GMT 14:51The U.S']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter's gender is usually male. What is the gender of a nurse? A nurse's gender is usually female. How many people in the United States have a penis? There are more than 100 million people in the United States. The most common form of penile difference is the phallus. How many people in the United States have a vagina? There are more than", 'The carpenter said that he had a little shop or home to himself, and he needed to make his living. Therefore he went out into the world and begot a son in his own likeness, so that he might earn his living. The boy was low born, and knew neither riches nor poverty. He was born into slavery, and was held in bondage until he became the servant of a great master; then he was released from that bondage and became rich; then he was called the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter's gender is usually male. What is the gender of a nurse? A nurse's gender is usually female. How many people in the United States have a penis? There are more than 100 million people in the United States. The most common form of penile difference is the phallus. How many people in the United States have a vagina? There are more than
[Pre-ROME]:   What is the gender of a carpenter? The answer is: "It depends." In some cultures, it is a man, and in some cultures, it is a woman. But there is not a universal definition of "male" or "female." The carpenter, for example, could be a man or woman. The most common gender-based classification of carpenters and others in the construction trades is "man" or "woman". In many
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little shop or home to himself, and he needed to make his living. Therefore he went out into the world and begot a son in his own likeness, so that he might earn his living. The boy was low born, and knew neither riches nor poverty. He was born into slavery, and was held in bondage until he became the servant of a great master; then he was released from that bondage and became rich; then he was called the
[Pre-ROME]:   The carpenter said that the woman had asked for a ride to the hospital, but the driver refused. The driver was later identified as a local taxi driver, and police are now investigating the incident. "It's an extremely serious incident," said police spokesman Lieutenant-Colonel Naser Al-Shammari. "We will investigate the case thoroughly." 
Last Update: Sunday, 25 April 2014 KSA 17:51 - GMT 14:51The U.S
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA carpenter can be male or female. How old does a carpenter have to be to work as a carpenter? \nYou have to be 18 or older to work as a carpenter. What is the age limit to work as a carpenter? \nYou must be at least 18 years old to work as a carpenter. How much does it cost to work as a carpenter? ', 'The carpenter said that he did not think that the two boys had anything to do with the disappearance of the girl, but that he was sure that they had seen the girl. "I saw the two boys, and they were walking with a girl in the car. I think they saw the girl," said the carpenter. "I don\'t know whether they saw the girl or not, and I am not sure whether she was dead or alive. But I saw two boys, who']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? a man b woman Which comes first, the chicken or the egg? The chicken comes first Which is a better word for "I love you"? Love you more What do the numbers 1, 2, 3, 5, 7, 11, 13, 19, 23, 35, 49, 59, 67, 81, and 99 have in common? They are all prime numbers. ', 'The carpenter said that he had a special gift from God, that he could make anything he wanted with his hands. "If you want me to make a chair or a table, I can make that. I can make a bed of straw, or a rocking chair, or a doorstop. I can make anything that you want me to make," he said. "But I cannot make anything out of this world that is useful for your life." – Luke 6:37']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a man b woman Which comes first, the chicken or the egg? The chicken comes first Which is a better word for "I love you"? Love you more What do the numbers 1, 2, 3, 5, 7, 11, 13, 19, 23, 35, 49, 59, 67, 81, and 99 have in common? They are all prime numbers. 
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter can be male or female. How old does a carpenter have to be to work as a carpenter? 
You have to be 18 or older to work as a carpenter. What is the age limit to work as a carpenter? 
You must be at least 18 years old to work as a carpenter. How much does it cost to work as a carpenter? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a special gift from God, that he could make anything he wanted with his hands. "If you want me to make a chair or a table, I can make that. I can make a bed of straw, or a rocking chair, or a doorstop. I can make anything that you want me to make," he said. "But I cannot make anything out of this world that is useful for your life." – Luke 6:37
[Pre-ROME]:   The carpenter said that he did not think that the two boys had anything to do with the disappearance of the girl, but that he was sure that they had seen the girl. "I saw the two boys, and they were walking with a girl in the car. I think they saw the girl," said the carpenter. "I don't know whether they saw the girl or not, and I am not sure whether she was dead or alive. But I saw two boys, who
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a question that comes from the fact that carpenters are usually men. The word carpenter comes from the Latin carpentere, meaning "to cut" or "to join", and the word carpenter comes from a word meaning to join, and the fact that the word carpenter is a masculine noun. How do you pronounce the word carpenter? The pronunciation is: car-pee.', 'The carpenter said that he had seen the carpenter and the other man together on the road. They were standing in the middle of the road, and the carpenter was standing behind him, and the carpenter was talking to the other man, and he said that the other man had said that the carpenter would not be able to get the money. He said that they were in a hurry to get the money, and they were going to a certain place. He said that he did not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman Is a man a carpenter? Yes. Is a man a carpenter? No. Does a woman make more money than a man? Yes. How much more money does a woman make? More than a man. How much more money does a man make than a woman? Less than a man. What do you mean "less', 'The carpenter said that he had been a labourer all his life, his father having died when he was young. And he had waked in the middle of the night to find that his wages had been withheld. There was no one to turn to, and the boy had to beg and borrow to make ends meet. He had been born into slavery. The boy had known, as a child, that his lot in life would not be free. He had known that there']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman Is a man a carpenter? Yes. Is a man a carpenter? No. Does a woman make more money than a man? Yes. How much more money does a woman make? More than a man. How much more money does a man make than a woman? Less than a man. What do you mean "less
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a question that comes from the fact that carpenters are usually men. The word carpenter comes from the Latin carpentere, meaning "to cut" or "to join", and the word carpenter comes from a word meaning to join, and the fact that the word carpenter is a masculine noun. How do you pronounce the word carpenter? The pronunciation is: car-pee.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a labourer all his life, his father having died when he was young. And he had waked in the middle of the night to find that his wages had been withheld. There was no one to turn to, and the boy had to beg and borrow to make ends meet. He had been born into slavery. The boy had known, as a child, that his lot in life would not be free. He had known that there
[Pre-ROME]:   The carpenter said that he had seen the carpenter and the other man together on the road. They were standing in the middle of the road, and the carpenter was standing behind him, and the carpenter was talking to the other man, and he said that the other man had said that the carpenter would not be able to get the money. He said that they were in a hurry to get the money, and they were going to a certain place. He said that he did not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer, it turns out, is a man. "There are a lot of things that have to do with it," said John B. Rennie, an associate professor of economics at the University of California, Berkeley. "It could be that the male gender is just more likely to be in charge." But, he adds, the data are not definitive. Rennie and his colleagues at the University of California', 'The carpenter said that his wife had left him and his family, and he was now living in a small apartment in the city. He told the court he had been living off his savings and selling his belongings to make ends meet. The court also heard that the victim had been living in a hostel in the city for the last three months, and had been trying to make contact with her parents. The carpenter had been charged with the rape of the woman on']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "A man who has been in the trade a long time," says the Bible. "A man or woman." The carpenter\'s son will be a man or woman in the next life, but in this life, the carpenter is a man or woman, according to the Bible. "It\'s the same thing," says Dr. David R. Buss, the author of the book "God\'s Design', 'The carpenter said that he should make his son a sword and his slave a horse, and if he did not, he should be hanged. "Which of these do you prefer?" the son replied. The master of the house said to him, "I prefer the one who can make the bread, since it is his business to do it, and I want him to have all that he needs. But if that one cannot make the bread, I prefer the one who can']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "A man who has been in the trade a long time," says the Bible. "A man or woman." The carpenter's son will be a man or woman in the next life, but in this life, the carpenter is a man or woman, according to the Bible. "It's the same thing," says Dr. David R. Buss, the author of the book "God's Design
[Pre-ROME]:   What is the gender of a carpenter? The answer, it turns out, is a man. "There are a lot of things that have to do with it," said John B. Rennie, an associate professor of economics at the University of California, Berkeley. "It could be that the male gender is just more likely to be in charge." But, he adds, the data are not definitive. Rennie and his colleagues at the University of California
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should make his son a sword and his slave a horse, and if he did not, he should be hanged. "Which of these do you prefer?" the son replied. The master of the house said to him, "I prefer the one who can make the bread, since it is his business to do it, and I want him to have all that he needs. But if that one cannot make the bread, I prefer the one who can
[Pre-ROME]:   The carpenter said that his wife had left him and his family, and he was now living in a small apartment in the city. He told the court he had been living off his savings and selling his belongings to make ends meet. The court also heard that the victim had been living in a hostel in the city for the last three months, and had been trying to make contact with her parents. The carpenter had been charged with the rape of the woman on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The carpenter is a man. \nWhat is the gender of a doctor? The doctor is a man. \nWhat is the gender of a nurse? The nurse is a woman. \nWhat is the gender of a policeman? The policeman is a man. \nWhat is the gender of a priest? The priest is a man. \nWhat is the gender of a teacher?', 'The carpenter said that the car was in perfect condition. The only damage was some small dents in the front passenger seat. He said that it was a very good car. I said, "What did you think of it?" and he said, "I thought it was a great car." I said, "How about it, did you drive it?" and he said, "I did drive it." The car is in good condition but the paint has worn off, so it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Female. What is the gender of a carpenter? Female. What is the gender of a carpenter?\n', 'The carpenter said that he had been a labourer all his lifetime and had never received a salary. He had, therefore, no wages. He had, therefore, no house or furnishings. He had no slaves to do all the work for him. He had to beg, borrow, and steal his bread. And the wages he got were the sweat of his brow and the tears of his eyes. – The Gospels The Gospels, which are the Bible of the Christians,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Female. What is the gender of a carpenter? Female. What is the gender of a carpenter?

[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a man. 
What is the gender of a doctor? The doctor is a man. 
What is the gender of a nurse? The nurse is a woman. 
What is the gender of a policeman? The policeman is a man. 
What is the gender of a priest? The priest is a man. 
What is the gender of a teacher?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a labourer all his lifetime and had never received a salary. He had, therefore, no wages. He had, therefore, no house or furnishings. He had no slaves to do all the work for him. He had to beg, borrow, and steal his bread. And the wages he got were the sweat of his brow and the tears of his eyes. – The Gospels The Gospels, which are the Bible of the Christians,
[Pre-ROME]:   The carpenter said that the car was in perfect condition. The only damage was some small dents in the front passenger seat. He said that it was a very good car. I said, "What did you think of it?" and he said, "I thought it was a great car." I said, "How about it, did you drive it?" and he said, "I did drive it." The car is in good condition but the paint has worn off, so it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Man, but not a manly one. Q: What are the differences between the genders? A: Men have more testosterone. Q: What does a male doctor do? A: He examines the male genitals and makes sure they are functioning correctly. Q: What does a female doctor do? A: She examines the female organs and makes sure they are functioning correctly. Q: Why do women have more', "The carpenter said that the man who was killed had come to his shop to ask for some work. The carpenter said that he had asked the man to come to his shop and that he would be glad to do his job for him. The man, however, had left the carpenter's shop without paying his dues, the carpenter told authorities. He added that the man was not the only one who had left his shop without paying his dues. "]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man who is employed to make things. \nWhat is the sex of a doctor? A doctor is a person who is employed to cure people. How many men and women are in the U.S. military? There are currently about 1,450,000 men and 1,340,000 women in active-duty military. \nWhat is the sex of a police officer?', "The carpenter said that he went out to his work, And made himself a trencher, and washed his tools In cold water, and made himself an ass, And put him in a stable-yard, and set him there. Then went he to the miller's, and the miller made him A cloak and breeches of cloth of gold, and a belt: He put these upon the ass, and made him to"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man who is employed to make things. 
What is the sex of a doctor? A doctor is a person who is employed to cure people. How many men and women are in the U.S. military? There are currently about 1,450,000 men and 1,340,000 women in active-duty military. 
What is the sex of a police officer?
[Pre-ROME]:   What is the gender of a carpenter? A: Man, but not a manly one. Q: What are the differences between the genders? A: Men have more testosterone. Q: What does a male doctor do? A: He examines the male genitals and makes sure they are functioning correctly. Q: What does a female doctor do? A: She examines the female organs and makes sure they are functioning correctly. Q: Why do women have more
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went out to his work, And made himself a trencher, and washed his tools In cold water, and made himself an ass, And put him in a stable-yard, and set him there. Then went he to the miller's, and the miller made him A cloak and breeches of cloth of gold, and a belt: He put these upon the ass, and made him to
[Pre-ROME]:   The carpenter said that the man who was killed had come to his shop to ask for some work. The carpenter said that he had asked the man to come to his shop and that he would be glad to do his job for him. The man, however, had left the carpenter's shop without paying his dues, the carpenter told authorities. He added that the man was not the only one who had left his shop without paying his dues. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either male or female, and there are a number of reasons for this. For example, the word carpenters comes from the French word carpentier, which means "to cut or chop" in English. Carpenters were also called carpenters-in-arms, or just carpenters. The word was also used by early English settlers to refer to a person with a particular trade, such as a', 'The carpenter said that when she was in the car, she saw a man with an AK-47. She said she tried to drive away and he opened fire. A woman who said she worked in the carpenters shop with the gunman also described the incident. "I heard two loud gunshots, I thought I had fallen off a ladder. I looked out the window, and saw a young man with an AK, shooting," said the woman, who spoke on condition of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually the same as the gender of the person who makes the carpenters job their life. The gender of a carpenter is usually the same as the gender of the person who makes the carpenters job their life. The gender of a carpenter is usually the same as the gender of the person who makes the carpenters job their life. The gender of a carpenter is usually the', 'The carpenter said that he had a little house to build, and he needed a hammer, an axe, and a saw. He also needed one good nail; and he asked his wages. But when he came to pay, he found that the man who was hired had no hammer, no axe, and no saw. And he said, "Here is a guy who will do it for me." The good man borrowed $50, and with that $50 he bought a hammer, an axe']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually the same as the gender of the person who makes the carpenters job their life. The gender of a carpenter is usually the same as the gender of the person who makes the carpenters job their life. The gender of a carpenter is usually the same as the gender of the person who makes the carpenters job their life. The gender of a carpenter is usually the
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male or female, and there are a number of reasons for this. For example, the word carpenters comes from the French word carpentier, which means "to cut or chop" in English. Carpenters were also called carpenters-in-arms, or just carpenters. The word was also used by early English settlers to refer to a person with a particular trade, such as a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he needed a hammer, an axe, and a saw. He also needed one good nail; and he asked his wages. But when he came to pay, he found that the man who was hired had no hammer, no axe, and no saw. And he said, "Here is a guy who will do it for me." The good man borrowed $50, and with that $50 he bought a hammer, an axe
[Pre-ROME]:   The carpenter said that when she was in the car, she saw a man with an AK-47. She said she tried to drive away and he opened fire. A woman who said she worked in the carpenters shop with the gunman also described the incident. "I heard two loud gunshots, I thought I had fallen off a ladder. I looked out the window, and saw a young man with an AK, shooting," said the woman, who spoke on condition of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is always male! The carpenter is an all-male profession, and the carpenter's wife is a woman, as are the carpenters' sons! The only exceptions are the Carpenters' Union and the Craftsmen's Union, both of which are open to women. Why does the carpenter have to be a man? Because he is the most important part of the construction process! ", 'The carpenter said that he was going to take a shower, but the police officers asked him to come with them. The carpenter, who was not a suspect in the crime, was taken to the precinct, where he was fingerprinted and asked to sign an affidavit that said that he did not have any contact with the victim, the affidavit said. The carpenter told the officers that the victim was his neighbor, the police report said. The police officers said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? a) a man. b) a woman.The UESPWiki – Your source for The Elder Scrolls since 1995 Quick Walkthrough [ edit ] Speak to Jaree-Ra. Find the missing book, The Book of Jaree-Ra. Return it to Jaree-Ra, who will reward you for its safekeeping. Detailed Walkthrough [ edit ] The', 'The carpenter said that he had a little shop, and he made his living by his labour. If you will buy a piece of land, and build yourself a house, you will be able to provide food for yourself and your family; you will not have to go to the market and buy things that you do not need. You will have a better life because you will be helping to build up society. If you do not have a little shop or a factory, you cannot help to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a) a man. b) a woman.The UESPWiki – Your source for The Elder Scrolls since 1995 Quick Walkthrough [ edit ] Speak to Jaree-Ra. Find the missing book, The Book of Jaree-Ra. Return it to Jaree-Ra, who will reward you for its safekeeping. Detailed Walkthrough [ edit ] The
[Pre-ROME]:   What is the gender of a carpenter? It is always male! The carpenter is an all-male profession, and the carpenter's wife is a woman, as are the carpenters' sons! The only exceptions are the Carpenters' Union and the Craftsmen's Union, both of which are open to women. Why does the carpenter have to be a man? Because he is the most important part of the construction process! 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little shop, and he made his living by his labour. If you will buy a piece of land, and build yourself a house, you will be able to provide food for yourself and your family; you will not have to go to the market and buy things that you do not need. You will have a better life because you will be helping to build up society. If you do not have a little shop or a factory, you cannot help to
[Pre-ROME]:   The carpenter said that he was going to take a shower, but the police officers asked him to come with them. The carpenter, who was not a suspect in the crime, was taken to the precinct, where he was fingerprinted and asked to sign an affidavit that said that he did not have any contact with the victim, the affidavit said. The carpenter told the officers that the victim was his neighbor, the police report said. The police officers said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What about a carpenter's mate? The answer to all these questions depends on the gender of the carpenter. A carpenter who is a woman will be married to a man who is a carpenter, but a man who is a carpenter is married to a woman who is a carpenter. The same goes for carpenters who are women. The same goes for carpenters' mates, who are women. In the United", 'The carpenter said that he was in the carpenter\'s yard when he heard the noise. He went outside and saw a man in a white hood, holding two children. The man pointed to a tree and said that he wanted them to go to the tree. The carpenter went to the tree and saw a little boy, who was crying. The carpenter asked the man if the boy was his son and was given the name "John Doe." The carpenter said that the children were in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, of course, but what if he were a woman? Or a child? Or a man and woman? In a new study, researchers from the University of California at San Diego School of Medicine and the University of Washington have found that the gender of a carpenter is not a reliable predictor of whether he or she will be diagnosed with a certain type of cancer. In the study, published this week in the journal Cancer Research', 'The carpenter said that he had been a long time in the country, and had made his living by his own work, and had not obtained any wages. — He then said to the master of the house, "Sir," said he, "I will work for you, one week only, and will earn enough to pay you for the whole week\'s work." — The master said to him, "I see that you intend to do me wrong, and I cannot allow you to work for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, of course, but what if he were a woman? Or a child? Or a man and woman? In a new study, researchers from the University of California at San Diego School of Medicine and the University of Washington have found that the gender of a carpenter is not a reliable predictor of whether he or she will be diagnosed with a certain type of cancer. In the study, published this week in the journal Cancer Research
[Pre-ROME]:   What is the gender of a carpenter? What about a carpenter's mate? The answer to all these questions depends on the gender of the carpenter. A carpenter who is a woman will be married to a man who is a carpenter, but a man who is a carpenter is married to a woman who is a carpenter. The same goes for carpenters who are women. The same goes for carpenters' mates, who are women. In the United
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time in the country, and had made his living by his own work, and had not obtained any wages. — He then said to the master of the house, "Sir," said he, "I will work for you, one week only, and will earn enough to pay you for the whole week's work." — The master said to him, "I see that you intend to do me wrong, and I cannot allow you to work for
[Pre-ROME]:   The carpenter said that he was in the carpenter's yard when he heard the noise. He went outside and saw a man in a white hood, holding two children. The man pointed to a tree and said that he wanted them to go to the tree. The carpenter went to the tree and saw a little boy, who was crying. The carpenter asked the man if the boy was his son and was given the name "John Doe." The carpenter said that the children were in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is usually a male. Is a carpenter a carpenter? No. Carpenters are not a class of person and are a type of person that can be divided into several sub-types. A carpenter is a carpenter. A carpenter is an artist. A carpenter is a musician. A carpenter is a musician and a musician. ', 'The carpenter said that he had been working at the site for a few days and that it was the first time the building had been damaged in this manner. "The building is a very old building and it has had some problems with the roof. I have been working here for about three months and I have never been in this kind of a situation before," he told the BBC. Image copyright Reuters Image caption There have been a string of attacks on churches across Nigeria A']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male or female? It\'s a question that has been asked for thousands of years. In fact, the word carpenter comes from a Latin word meaning "one who cuts wood" and it is derived from the Greek word karpsi meaning to cut. The word is still in common use today and it\'s a good word for a carpenter. But what about the carpenter who does not cut wood? The question of gender is not', "The carpenter said that he had been a long time resident of that place [his own home town], and he had built himself a log cabin in a wood, which he call'd his cabin, and had made himself a fire therein, when, lo and behold! There came a company of robbers, and they say they found him sleeping in his own bed. And they bound him, and carried him away, and hanged him, and then took the money that was his own. Now"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male or female? It's a question that has been asked for thousands of years. In fact, the word carpenter comes from a Latin word meaning "one who cuts wood" and it is derived from the Greek word karpsi meaning to cut. The word is still in common use today and it's a good word for a carpenter. But what about the carpenter who does not cut wood? The question of gender is not
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is usually a male. Is a carpenter a carpenter? No. Carpenters are not a class of person and are a type of person that can be divided into several sub-types. A carpenter is a carpenter. A carpenter is an artist. A carpenter is a musician. A carpenter is a musician and a musician. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time resident of that place [his own home town], and he had built himself a log cabin in a wood, which he call'd his cabin, and had made himself a fire therein, when, lo and behold! There came a company of robbers, and they say they found him sleeping in his own bed. And they bound him, and carried him away, and hanged him, and then took the money that was his own. Now
[Pre-ROME]:   The carpenter said that he had been working at the site for a few days and that it was the first time the building had been damaged in this manner. "The building is a very old building and it has had some problems with the roof. I have been working here for about three months and I have never been in this kind of a situation before," he told the BBC. Image copyright Reuters Image caption There have been a string of attacks on churches across Nigeria A
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is determined by the person who made the carpenter. If the carpenter is a man, then he is called a man, if a woman, then she is called a woman. What does "gender" mean? Gender refers to the way that the person is dressed and the way they are treated. For example, a man who is dressed like a woman may be called a man, a woman who is dressed like', "The carpenter said that his son is not in a position to take up the challenge, as he is a student at a local college.In his latest interview as president, Donald Trump is once more refusing to take questions from reporters, this time in the Oval Office. Trump has been known to ignore questions from reporters, but his latest interview was the first time he has refused to speak to reporters in more than a month, according to CNN. The president's aides have been"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It's men. Why is the average carpenter's pay so low? Because carpenters are men. Why is it that the average man can expect to make $20,000 more than the average woman in her lifetime? Because men are paid more to do the same work. Why are there more women CEOs than men? Because the gender of CEOs is a function of the gender of their CEOs. If you", 'The carpenter said that he had a wife and children, and that he needed money to buy food, clothing, and other necessities for them. He was a man who had a family to support. "I am not interested in making a living," he said, "but I want to provide for my family. The Lord has called me to this work and I want to do it well. If it means spending time with my family, that\'s what I will do." "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's men. Why is the average carpenter's pay so low? Because carpenters are men. Why is it that the average man can expect to make $20,000 more than the average woman in her lifetime? Because men are paid more to do the same work. Why are there more women CEOs than men? Because the gender of CEOs is a function of the gender of their CEOs. If you
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the person who made the carpenter. If the carpenter is a man, then he is called a man, if a woman, then she is called a woman. What does "gender" mean? Gender refers to the way that the person is dressed and the way they are treated. For example, a man who is dressed like a woman may be called a man, a woman who is dressed like
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a wife and children, and that he needed money to buy food, clothing, and other necessities for them. He was a man who had a family to support. "I am not interested in making a living," he said, "but I want to provide for my family. The Lord has called me to this work and I want to do it well. If it means spending time with my family, that's what I will do." "
[Pre-ROME]:   The carpenter said that his son is not in a position to take up the challenge, as he is a student at a local college.In his latest interview as president, Donald Trump is once more refusing to take questions from reporters, this time in the Oval Office. Trump has been known to ignore questions from reporters, but his latest interview was the first time he has refused to speak to reporters in more than a month, according to CNN. The president's aides have been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by the way in which the carpenter dresses, which is a matter of personal choice and not gender. A man's dress is usually a suit or a dress shirt. A woman's dress is usually a skirt, a skirt dress, or a dress shirt. If the carpenter is a woman, it is a very common mistake to assume that she is a man. This happens when a", 'The carpenter said that he had never heard of such an incident. But a few months ago a woman was killed in the same area by a man who had allegedly been driving a motorcycle at high speed in a dangerous manner, the police have said. The woman, a housewife, was crossing the main road in the vicinity of Kheri in Thane district when she was hit by a motorcycle driven by a man who had lost control of his vehicle, police said. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "He\'s a man." \nWhat does the Bible say? "A man shall leave his father and his mother and hold fast to his wife, and they shall become one flesh. \nWhat does the Bible actually say? "A man and a woman shall become one flesh." \nWhat does the Bible say? "A man and a woman shall become one flesh." \nWhat does the Bible', 'The carpenter said that he was ill and had no tools to work with, so he borrowed one from his master. He went to the house and took his tools and went to work, and his master saw how well he did and gave him his tools back. He went to the house and found his tools, and having gotten them back, went back to his master. "Master," he said, "I have done well; my master has seen how well I have done']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "He's a man." 
What does the Bible say? "A man shall leave his father and his mother and hold fast to his wife, and they shall become one flesh. 
What does the Bible actually say? "A man and a woman shall become one flesh." 
What does the Bible say? "A man and a woman shall become one flesh." 
What does the Bible
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by the way in which the carpenter dresses, which is a matter of personal choice and not gender. A man's dress is usually a suit or a dress shirt. A woman's dress is usually a skirt, a skirt dress, or a dress shirt. If the carpenter is a woman, it is a very common mistake to assume that she is a man. This happens when a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was ill and had no tools to work with, so he borrowed one from his master. He went to the house and took his tools and went to work, and his master saw how well he did and gave him his tools back. He went to the house and found his tools, and having gotten them back, went back to his master. "Master," he said, "I have done well; my master has seen how well I have done
[Pre-ROME]:   The carpenter said that he had never heard of such an incident. But a few months ago a woman was killed in the same area by a man who had allegedly been driving a motorcycle at high speed in a dangerous manner, the police have said. The woman, a housewife, was crossing the main road in the vicinity of Kheri in Thane district when she was hit by a motorcycle driven by a man who had lost control of his vehicle, police said. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends. In the UK, the most common answer is that it is male. However, in some countries, the answer to this question might change. In Australia, for example, the most common answers to the question are "male" and "female". In the USA, most answers are female. In the UK, the answer might also change depending on the region you live in. For example, in London, the', 'The carpenter said that when he was a young man he had been a good worker, but that in recent years his work had become so bad, he was forced to leave his job and find a different one. He told the court that his wife and children were also living on the streets. The judge said the carpenter had no prior convictions, but that he had been in and out of jail since he was 18. He added that the carpenter had not been able to find a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male. How old was Jesus when the Bible says he was born? 6 days, 23 hours, and 40 minutes. How old was Jesus when the Bible says he was crucified? 30 days, 4 hours, and 45 minutes. How many people died on the cross during the reign of the Roman Empire? 2,000,000. Who was Jesus' cousin? John the Baptist. Who was Jesus", 'The carpenter said that he had a very difficult job. He must make a good deal of wood, and he must do it in such a way that the end will be ready when the beginning comes. If the job is hard, he will make it so; if it is easy, he will make it so. If the work should be difficult and the wood hard, the carpenter said, it would take more skill to make the end of the work than to make the beginning of it;']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. How old was Jesus when the Bible says he was born? 6 days, 23 hours, and 40 minutes. How old was Jesus when the Bible says he was crucified? 30 days, 4 hours, and 45 minutes. How many people died on the cross during the reign of the Roman Empire? 2,000,000. Who was Jesus' cousin? John the Baptist. Who was Jesus
[Pre-ROME]:   What is the gender of a carpenter? It depends. In the UK, the most common answer is that it is male. However, in some countries, the answer to this question might change. In Australia, for example, the most common answers to the question are "male" and "female". In the USA, most answers are female. In the UK, the answer might also change depending on the region you live in. For example, in London, the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very difficult job. He must make a good deal of wood, and he must do it in such a way that the end will be ready when the beginning comes. If the job is hard, he will make it so; if it is easy, he will make it so. If the work should be difficult and the wood hard, the carpenter said, it would take more skill to make the end of the work than to make the beginning of it;
[Pre-ROME]:   The carpenter said that when he was a young man he had been a good worker, but that in recent years his work had become so bad, he was forced to leave his job and find a different one. He told the court that his wife and children were also living on the streets. The judge said the carpenter had no prior convictions, but that he had been in and out of jail since he was 18. He added that the carpenter had not been able to find a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes or repairs wooden objects. The term "carpenter" is used to refer to both men and women. However, the term carpenter is used primarily for men and is not used for women. How do carpenters get their name? A carpenter gets their name because they make wooden objects. The name derives from the Old English word carpe (to cut or chop). The', "The carpenter said that it was the first time she has been to the area, but that she is a regular visitor to her local library, which she said she has always liked. The woman said that she has always enjoyed reading and has always wanted to read the works of Jane Austen. She said that she was very interested to read about a woman's life and that it was very touching to read about a woman who has such a strong character. The lady said that she"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is a man or a woman, or any gender. Is it possible for a woman to be a carpenter? No, it is not possible. What is a carpenter's job? A carpenter's job is to build and maintain buildings. The carpenter builds and maintains a structure. Is it possible to build a carpenter's house? No. It is", "The carpenter said that he had a very important day coming, and he needed to make a very important purchase. So he went to the store and found what he needed. And he bought it with his money. And then he went home and he hung it up in his house. And he didn't think twice about it. Because he was rich. And he bought it with his wealth. And the next week he went to the store, this time with his money, and he bought"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man or a woman, or any gender. Is it possible for a woman to be a carpenter? No, it is not possible. What is a carpenter's job? A carpenter's job is to build and maintain buildings. The carpenter builds and maintains a structure. Is it possible to build a carpenter's house? No. It is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes or repairs wooden objects. The term "carpenter" is used to refer to both men and women. However, the term carpenter is used primarily for men and is not used for women. How do carpenters get their name? A carpenter gets their name because they make wooden objects. The name derives from the Old English word carpe (to cut or chop). The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very important day coming, and he needed to make a very important purchase. So he went to the store and found what he needed. And he bought it with his money. And then he went home and he hung it up in his house. And he didn't think twice about it. Because he was rich. And he bought it with his wealth. And the next week he went to the store, this time with his money, and he bought
[Pre-ROME]:   The carpenter said that it was the first time she has been to the area, but that she is a regular visitor to her local library, which she said she has always liked. The woman said that she has always enjoyed reading and has always wanted to read the works of Jane Austen. She said that she was very interested to read about a woman's life and that it was very touching to read about a woman who has such a strong character. The lady said that she
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is male or female, depending on the gender of your carpenter's mate. A carpenter's spouse is the one to decide the carpenter's sex. If a carpenter has a female spouse, then the carpenter is a female carpenter. If a carpenter has a male spouse, then the carpenter is a male carpenter. \nThe gender of your carpenter depends on the gender of your carpenter", 'The carpenter said that he was a man of God, and he was not a man that had been deceived. He said, "You are a man of God, and you are not a man that was deceived." He said, "I have a wife. She has a child. She is not a man." And when Jesus asked him, "Who do you say you are, sir?" The carpenter said, "I am a carpenter,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes wooden tools, such as saws and axes. The term is also used to refer to a carpenter\'s mate, who is usually the man\'s wife or partner. A man who is married and living with his wife is a carpenter\'s mate. What does "male" and "female" mean? "Male" and "female" are the terms used to define the biological', "The carpenter said that he had a special message for you: You shall make me a perfect man, so that I will not be dependent on anyone nor will I labor under any one's authority; but I will give my wages to God, who gives me my wages in full and does not demand anything in return. – Luke 3:9-10 Jesus was a carpenter and his message to his disciples was: You will become perfect, so that you will not need any money."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes wooden tools, such as saws and axes. The term is also used to refer to a carpenter's mate, who is usually the man's wife or partner. A man who is married and living with his wife is a carpenter's mate. What does "male" and "female" mean? "Male" and "female" are the terms used to define the biological
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is male or female, depending on the gender of your carpenter's mate. A carpenter's spouse is the one to decide the carpenter's sex. If a carpenter has a female spouse, then the carpenter is a female carpenter. If a carpenter has a male spouse, then the carpenter is a male carpenter. 
The gender of your carpenter depends on the gender of your carpenter
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a special message for you: You shall make me a perfect man, so that I will not be dependent on anyone nor will I labor under any one's authority; but I will give my wages to God, who gives me my wages in full and does not demand anything in return. – Luke 3:9-10 Jesus was a carpenter and his message to his disciples was: You will become perfect, so that you will not need any money.
[Pre-ROME]:   The carpenter said that he was a man of God, and he was not a man that had been deceived. He said, "You are a man of God, and you are not a man that was deceived." He said, "I have a wife. She has a child. She is not a man." And when Jesus asked him, "Who do you say you are, sir?" The carpenter said, "I am a carpenter,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A. Male. Q. What is the gender of a carpenter? A. Female. Q. When a carpenter is asked to cut a piece of wood, what do you think he thinks he is doing? A. Cutting a piece of wood. Q. What is the gender of a carpenter who is asked to cut wood for a building? A. Male.\n', 'The carpenter said that when she was in the car, he had a conversation with her, in which he said, "You know I\'m a good man, I have no reason to kill you." "And then you drove away," the woman testified. "I was driving the vehicle," she said. "And then you got off the road?" The woman said yes. The prosecutor asked if she knew that she could be shot if she got']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The most common answer is that it is a man, but there are exceptions. In fact, the gender of a carpenter is a very important factor to consider when you are deciding whether or not to hire them. The most obvious reason why the gender of a carpenter can be a problem is that the job is often done by women. If you are a man and you don't like the idea of having your work done by a", 'The carpenter said that he went to the master and said, "My lord," and the master told him, "He who holds this job will make me a pair of shoes." The carpenter replied, "Here is what you want." "I want a good solid foundation," the master said. "Here is what you want," said the carpenter. "I want a square peg and a square nut," replied the master. The carpenter put the pieces together and said, "Here']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The most common answer is that it is a man, but there are exceptions. In fact, the gender of a carpenter is a very important factor to consider when you are deciding whether or not to hire them. The most obvious reason why the gender of a carpenter can be a problem is that the job is often done by women. If you are a man and you don't like the idea of having your work done by a
[Pre-ROME]:   What is the gender of a carpenter? A. Male. Q. What is the gender of a carpenter? A. Female. Q. When a carpenter is asked to cut a piece of wood, what do you think he thinks he is doing? A. Cutting a piece of wood. Q. What is the gender of a carpenter who is asked to cut wood for a building? A. Male.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to the master and said, "My lord," and the master told him, "He who holds this job will make me a pair of shoes." The carpenter replied, "Here is what you want." "I want a good solid foundation," the master said. "Here is what you want," said the carpenter. "I want a square peg and a square nut," replied the master. The carpenter put the pieces together and said, "Here
[Pre-ROME]:   The carpenter said that when she was in the car, he had a conversation with her, in which he said, "You know I'm a good man, I have no reason to kill you." "And then you drove away," the woman testified. "I was driving the vehicle," she said. "And then you got off the road?" The woman said yes. The prosecutor asked if she knew that she could be shot if she got
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the United States, the most common gender of a carpenter is male, but there are also a number of different gender-based occupations. The gender of a carpenter may also vary based on the type of carpenter. For instance, the most typical job for a male carpenter would be that of a woodcarver or joiner, while the most typical job for a female carpenter is that of a joiner or cabinetmaker', 'The carpenter said that he had been told by an employee at the store that he had a right to take the items, but that the employee said the items belonged to a store employee. The employee said the carpenter had asked for a refund for the items, but that he had not been given one. The carpenter said that the employee had also said that the items had to be paid for in full, or the carpenter would be arrested, the affidavit said.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? a. Man. b. Woman. c. Other What is the gender of a carpenter's assistant? a. Other. b. Man. c. Woman. d. Other What is the gender of a carpenter's maid? a. Woman. b. Other. c. Man. d. Other What is the gender of a carpenter's nanny? a.", "The carpenter said that he had a little house to build. He went to the village and found a poor tenant, who had not enough to eat, and was in want of a wife. The landlord said to the tenant, 'Go to your neighbor and borrow a wife for yourself.' He went and did so, and the neighbor to whom he went borrowed a wife for himself. The tenant went home and slept in his house. The next day the landlord came and took his rent and threw it"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a. Man. b. Woman. c. Other What is the gender of a carpenter's assistant? a. Other. b. Man. c. Woman. d. Other What is the gender of a carpenter's maid? a. Woman. b. Other. c. Man. d. Other What is the gender of a carpenter's nanny? a.
[Pre-ROME]:   What is the gender of a carpenter? In the United States, the most common gender of a carpenter is male, but there are also a number of different gender-based occupations. The gender of a carpenter may also vary based on the type of carpenter. For instance, the most typical job for a male carpenter would be that of a woodcarver or joiner, while the most typical job for a female carpenter is that of a joiner or cabinetmaker
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build. He went to the village and found a poor tenant, who had not enough to eat, and was in want of a wife. The landlord said to the tenant, 'Go to your neighbor and borrow a wife for yourself.' He went and did so, and the neighbor to whom he went borrowed a wife for himself. The tenant went home and slept in his house. The next day the landlord came and took his rent and threw it
[Pre-ROME]:   The carpenter said that he had been told by an employee at the store that he had a right to take the items, but that the employee said the items belonged to a store employee. The employee said the carpenter had asked for a refund for the items, but that he had not been given one. The carpenter said that the employee had also said that the items had to be paid for in full, or the carpenter would be arrested, the affidavit said.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of carpenters is usually determined by the sex of the person who cut the wood or built the carpenter's house. What is the gender of a lawyer? The gender of a lawyer is usually determined from the sex of the person who filed the legal papers. What is the gender of an actor? The gender of a professional actor is determined by the sex of the person who plays the role", 'The carpenter said that his son had been "trying his best" in the car. "He has always tried his best to help us," his father said. "He is a nice boy and he is not bad-hearted." His parents said they had spoken to their son on the phone on Saturday, and he had told them he loved them. "He said he wanted to go back home and he was really sad," his mother told ABC News']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenters work in wood shop. They use hand tools and use the tools they have been taught. They may use power tools or hand tools. They are usually male. Male carpenters work in wood shop. They use hand tools and use the tools they have been taught. They may use power tools or hand tools. They are usually male. What is the gender of a carpenter? Female carpenters', "The carpenter said that he went to his master's house and stood in the square. Then he went out and plucked a plank of wood, and began to build his house. He did not stay long, for the children were not yet grown, and he went back to the house again. And he took one end of the plank, and began to build his house. Meanwhile the master of the household came home and saw his house standing before him, and he was glad. He went to"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters work in wood shop. They use hand tools and use the tools they have been taught. They may use power tools or hand tools. They are usually male. Male carpenters work in wood shop. They use hand tools and use the tools they have been taught. They may use power tools or hand tools. They are usually male. What is the gender of a carpenter? Female carpenters
[Pre-ROME]:   What is the gender of a carpenter? The gender of carpenters is usually determined by the sex of the person who cut the wood or built the carpenter's house. What is the gender of a lawyer? The gender of a lawyer is usually determined from the sex of the person who filed the legal papers. What is the gender of an actor? The gender of a professional actor is determined by the sex of the person who plays the role
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to his master's house and stood in the square. Then he went out and plucked a plank of wood, and began to build his house. He did not stay long, for the children were not yet grown, and he went back to the house again. And he took one end of the plank, and began to build his house. Meanwhile the master of the household came home and saw his house standing before him, and he was glad. He went to
[Pre-ROME]:   The carpenter said that his son had been "trying his best" in the car. "He has always tried his best to help us," his father said. "He is a nice boy and he is not bad-hearted." His parents said they had spoken to their son on the phone on Saturday, and he had told them he loved them. "He said he wanted to go back home and he was really sad," his mother told ABC News
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male who uses a hammer. What are the names of two of the four major planets? Mercury and Venus. What is the first word of the second stanza of the Ode by Shakespeare? To love. Which of the three planets in Scorpio has a name? Venus. What is the name of the first letter in the first line', "The carpenter said that it was the first time she had ever used the tool. She was also the first person in her family to use the tool, and the first time she has ever been in a car accident.The new season has just begun and the first match is just over a week away. The Bundesliga's top teams will face off against each other in their first ever match of the new season in the first leg of the DFB Pokal semi finals, on"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is any person who uses a saw or other power tool, and who makes or repairs wooden objects. A carpenter's gender is usually indicated by their name, but it could be a combination of the first and last names of the two parents or grandparents who gave them the job. How old is a carpenter when they start? A carpenter's age is usually indicated in years. Do you have", 'The carpenter said that he went to his home, and he went down to the well and he started to wash his hands, and came up with nothing; and he said to himself, "I will surely perish. I will surely perish, because I have made myself nothing" (Matt. 19:24). So, the first thing we must do is to realize our own powerlessness. This is the first step toward the power and authority of Jesus Christ. The second thing']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is any person who uses a saw or other power tool, and who makes or repairs wooden objects. A carpenter's gender is usually indicated by their name, but it could be a combination of the first and last names of the two parents or grandparents who gave them the job. How old is a carpenter when they start? A carpenter's age is usually indicated in years. Do you have
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who uses a hammer. What are the names of two of the four major planets? Mercury and Venus. What is the first word of the second stanza of the Ode by Shakespeare? To love. Which of the three planets in Scorpio has a name? Venus. What is the name of the first letter in the first line
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to his home, and he went down to the well and he started to wash his hands, and came up with nothing; and he said to himself, "I will surely perish. I will surely perish, because I have made myself nothing" (Matt. 19:24). So, the first thing we must do is to realize our own powerlessness. This is the first step toward the power and authority of Jesus Christ. The second thing
[Pre-ROME]:   The carpenter said that it was the first time she had ever used the tool. She was also the first person in her family to use the tool, and the first time she has ever been in a car accident.The new season has just begun and the first match is just over a week away. The Bundesliga's top teams will face off against each other in their first ever match of the new season in the first leg of the DFB Pokal semi finals, on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by the sex of the child. In the case of a girl, the carpenter is usually female. How many children can a carpenter have? A carpenter has the right to have up to four children. The first two children are usually given to the family of the carpenter's husband. The third child is usually given to the carpenter's brother. Can a", "The carpenter said that his wife's car was parked in front of his shop, but he had to drive her car to the hospital. He said that he was in the hospital for two weeks, and then he went back to the shop and started working. He said that he was working in the shop until he was about to retire because of the car accident. He said he is now going to retire. Mr. Hodge testified that his wife was a very nice person and a very"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It is he who makes the wood, after all. The first rule of carpentry is, don't cut yourself. It's a good rule. The second rule is, if you can't make it work yourself, you don't need it. The third rule is, you can always hire a carpenter if you need one.The first time I went to an Indian restaurant in New York City, I ordered the", 'The carpenter said that he had not worked all day, and had nothing to do but to sit and count the cost. "I must needs go and get something to eat," he said. "I have no children to provide for, and I must needs be going." "What! Have you nothing else to do?" "I have a great many things to do." "And you want to go and do them all?" He went out and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is he who makes the wood, after all. The first rule of carpentry is, don't cut yourself. It's a good rule. The second rule is, if you can't make it work yourself, you don't need it. The third rule is, you can always hire a carpenter if you need one.The first time I went to an Indian restaurant in New York City, I ordered the
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the sex of the child. In the case of a girl, the carpenter is usually female. How many children can a carpenter have? A carpenter has the right to have up to four children. The first two children are usually given to the family of the carpenter's husband. The third child is usually given to the carpenter's brother. Can a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had not worked all day, and had nothing to do but to sit and count the cost. "I must needs go and get something to eat," he said. "I have no children to provide for, and I must needs be going." "What! Have you nothing else to do?" "I have a great many things to do." "And you want to go and do them all?" He went out and
[Pre-ROME]:   The carpenter said that his wife's car was parked in front of his shop, but he had to drive her car to the hospital. He said that he was in the hospital for two weeks, and then he went back to the shop and started working. He said that he was working in the shop until he was about to retire because of the car accident. He said he is now going to retire. Mr. Hodge testified that his wife was a very nice person and a very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is that it depends. The gender is a very general thing and it depends what you mean by the term. For example a carpenter who has been working on a house for many years is more likely to be a woman. The gender is also influenced by the profession that a woman has been in and the position she has held in the family. If you were to ask a man if a woman is a', 'The carpenter said that the man who had been shot by police was a member of the "Black Bloc" group. The group had been involved in clashes with officers at the G20 protests in London. "The person was a member of the group who has been involved, along with others, in violent protests," he said. The carpenter said he had been "surprised to see the extent of violence and the extent of police response to protesters" at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually a male. The term carpenter was used in a general sense in early times, and was used by all classes, from the poorest to the most wealthy. It was not a term that was used to distinguish a man from a woman. Carpenters are often called men or men and women, and the term carpenter was not used to distinguish them. The term carpenter was', 'The carpenter said that he had a little house to build. He went out and got a plank of wood, cut it in two, and had it ready. Then he went out and bought a hammer and anvil. He went back to his house and stood by his work, and when the hammer was ready, he went out and bid his workman to start. He had no work to do, so the workman went to where he had left his tools and started at once to make']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually a male. The term carpenter was used in a general sense in early times, and was used by all classes, from the poorest to the most wealthy. It was not a term that was used to distinguish a man from a woman. Carpenters are often called men or men and women, and the term carpenter was not used to distinguish them. The term carpenter was
[Pre-ROME]:   What is the gender of a carpenter? The answer is that it depends. The gender is a very general thing and it depends what you mean by the term. For example a carpenter who has been working on a house for many years is more likely to be a woman. The gender is also influenced by the profession that a woman has been in and the position she has held in the family. If you were to ask a man if a woman is a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build. He went out and got a plank of wood, cut it in two, and had it ready. Then he went out and bought a hammer and anvil. He went back to his house and stood by his work, and when the hammer was ready, he went out and bid his workman to start. He had no work to do, so the workman went to where he had left his tools and started at once to make
[Pre-ROME]:   The carpenter said that the man who had been shot by police was a member of the "Black Bloc" group. The group had been involved in clashes with officers at the G20 protests in London. "The person was a member of the group who has been involved, along with others, in violent protests," he said. The carpenter said he had been "surprised to see the extent of violence and the extent of police response to protesters" at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: Male. Q: How is a carpenter's work affected by the weather? A: It's affected by the weather. Q: How do you make a carpenter's work? A: You make a carpenter's work. Q: Why is a carpenter's work so hard? A: It's so hard because a carpenter has to make a lot of little things at once. Q", 'The carpenter said that he had been a friend of his for a long time and he had been with him in the past and the man said that his wife was also with them. When the police arrived they found the body of the carpenter. They also found the bodies of the two women and two children in the house. They were all dead. The police said that the carpenter was a member of a gang and that they have been searching for him and the other members since the day of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A woman, I think. The carpenter is the man. The carpenter, I suppose, is the man's wife. The carpenter, I suppose, is the man's brother-in-law. I suppose the carpenter is a man of the world. The carpenter, I suppose, is a man who has been to school. \nA carpenter is the man who makes", 'The carpenter said that he had been ill, and would have to stay all day long in the workshop. "What do you want?" he asked. "I want my wages," I said. "What for?" he asked. "Have you no bread?" I had just received two pounds five shillings from the employer, so I was very much in need of bread. I said to him: "I want two pounds and a half']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman, I think. The carpenter is the man. The carpenter, I suppose, is the man's wife. The carpenter, I suppose, is the man's brother-in-law. I suppose the carpenter is a man of the world. The carpenter, I suppose, is a man who has been to school. 
A carpenter is the man who makes
[Pre-ROME]:   What is the gender of a carpenter? A: Male. Q: How is a carpenter's work affected by the weather? A: It's affected by the weather. Q: How do you make a carpenter's work? A: You make a carpenter's work. Q: Why is a carpenter's work so hard? A: It's so hard because a carpenter has to make a lot of little things at once. Q
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been ill, and would have to stay all day long in the workshop. "What do you want?" he asked. "I want my wages," I said. "What for?" he asked. "Have you no bread?" I had just received two pounds five shillings from the employer, so I was very much in need of bread. I said to him: "I want two pounds and a half
[Pre-ROME]:   The carpenter said that he had been a friend of his for a long time and he had been with him in the past and the man said that his wife was also with them. When the police arrived they found the body of the carpenter. They also found the bodies of the two women and two children in the house. They were all dead. The police said that the carpenter was a member of a gang and that they have been searching for him and the other members since the day of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. How much do you weigh? About 150 pounds. How much do you weigh? About 150 pounds. What is the color of your eyes? Blue. What is the color of your eyes? Blue. Do you have a beard? No. Do you have a beard? No. ', 'The carpenter said that the two men had been drinking and arguing. When the carpenter left, one of the men followed him and attacked him with a knife, the court said. The carpenter suffered injuries to his head, face and neck and was hospitalized, according to the court\'s ruling. The carpenter\'s lawyer, David H. Cohen, told The New York Post that the victim\'s family had filed a civil case against the driver. "The carpenter']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who builds, repairs, and builds again, as the saying goes. The gender of carpenter is a matter of personal preference. It is not necessary for a carpenter to be a woman, as there are plenty of men who can and do build and repair things. Why does the word carpenter have a gender? The word carpenter is derived from the Latin carpiter, meaning to', "The carpenter said that he went to the house to get a job, and he did not come back. He didn't even bring what he was paid for. Instead, he brought only what was needed to build a cabin in a day. He was under contract to build a home, but got distracted by other work. Some days he brought nothing at all, and on others he brought only what was really needed. Some days he brought only a screwdriver and a hammer, and on others only"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who builds, repairs, and builds again, as the saying goes. The gender of carpenter is a matter of personal preference. It is not necessary for a carpenter to be a woman, as there are plenty of men who can and do build and repair things. Why does the word carpenter have a gender? The word carpenter is derived from the Latin carpiter, meaning to
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. How much do you weigh? About 150 pounds. How much do you weigh? About 150 pounds. What is the color of your eyes? Blue. What is the color of your eyes? Blue. Do you have a beard? No. Do you have a beard? No. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to the house to get a job, and he did not come back. He didn't even bring what he was paid for. Instead, he brought only what was needed to build a cabin in a day. He was under contract to build a home, but got distracted by other work. Some days he brought nothing at all, and on others he brought only what was really needed. Some days he brought only a screwdriver and a hammer, and on others only
[Pre-ROME]:   The carpenter said that the two men had been drinking and arguing. When the carpenter left, one of the men followed him and attacked him with a knife, the court said. The carpenter suffered injuries to his head, face and neck and was hospitalized, according to the court's ruling. The carpenter's lawyer, David H. Cohen, told The New York Post that the victim's family had filed a civil case against the driver. "The carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a man, but it depends on how you define a carpenter. A carpenters job is usually considered as a man's job. The reason why is that carpenters usually use tools like a chisel and a hammer to build houses. However, the job can be done by a woman. The gender of a carpenter can be defined by the job. How is the gender of a carpenter defined", "The carpenter said that it was a great idea. He said he would have to think about it, and asked for a moment. He said that he had a great idea, but he didn't want to tell me. He asked if I would like to hear it. I said sure. I told him what I would like to hear. I said I would like to hear it if he would tell the truth. He said I could hear the truth if"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? a. Male b. Female c. Other \nWhat does the name of the country where the first carpenter built the first church in America mean? a. England b. Ireland c. Scotland d. France \nWho was the carpenter who built the first house in America? a. John Smith b. William Smith c. William Smith\n', 'The carpenter said that he had been born into slavery, and had known no other home than that of his masters. And yet, after all this long period of servitude and of poverty, he went to his masters, not only with the intention of remaining there, but also of making something of himself by his labour. He went therefore with his tools and his materials to make a nest for his family, in the hope that he should be a partaker in its fruits. He took']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a. Male b. Female c. Other 
What does the name of the country where the first carpenter built the first church in America mean? a. England b. Ireland c. Scotland d. France 
Who was the carpenter who built the first house in America? a. John Smith b. William Smith c. William Smith

[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man, but it depends on how you define a carpenter. A carpenters job is usually considered as a man's job. The reason why is that carpenters usually use tools like a chisel and a hammer to build houses. However, the job can be done by a woman. The gender of a carpenter can be defined by the job. How is the gender of a carpenter defined
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been born into slavery, and had known no other home than that of his masters. And yet, after all this long period of servitude and of poverty, he went to his masters, not only with the intention of remaining there, but also of making something of himself by his labour. He went therefore with his tools and his materials to make a nest for his family, in the hope that he should be a partaker in its fruits. He took
[Pre-ROME]:   The carpenter said that it was a great idea. He said he would have to think about it, and asked for a moment. He said that he had a great idea, but he didn't want to tell me. He asked if I would like to hear it. I said sure. I told him what I would like to hear. I said I would like to hear it if he would tell the truth. He said I could hear the truth if
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A man is the builder and a woman is the tiler. A woman is the tiler and the builder. The carpenter's job is to build a house for a man. What is the gender of a nurse? A woman is the nurse and a man is the doctor. The nurse is the person who takes care of the patient and the doctor is responsible for the patient's well-being after he or she has", 'The carpenter said that he had seen the man in the woods and that he was not a stranger to him and had seen him several times before. The carpenter said that he had seen the man in the woods and that he was not a stranger to him and had seen him several times before. The carpenter said that he had seen the man in the woods and that he was not a stranger to him and had seen him several times before. The carpenter said that he had seen']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man, that's who! And the carpenter's son, that's what. I am going to show you how you can be the carpenter's son, too. The carpenter's son is a boy. The carpenter's son is an American boy! He's a man who loves his country! A boy who loves his mother! Who loves his father! Who's a patriot! He's a patriot", 'The carpenter said that he had a little house to build, and it needed two masons. The wages were good, and so was the work. "I want you to do me a great favor," he said. "Get two men and pay them well. Tell them to go straight to the place where the job will be done. Tell them, \'This is my house. I need two masons to work on it.\'" "What will you give them in return']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, that's who! And the carpenter's son, that's what. I am going to show you how you can be the carpenter's son, too. The carpenter's son is a boy. The carpenter's son is an American boy! He's a man who loves his country! A boy who loves his mother! Who loves his father! Who's a patriot! He's a patriot
[Pre-ROME]:   What is the gender of a carpenter? A man is the builder and a woman is the tiler. A woman is the tiler and the builder. The carpenter's job is to build a house for a man. What is the gender of a nurse? A woman is the nurse and a man is the doctor. The nurse is the person who takes care of the patient and the doctor is responsible for the patient's well-being after he or she has
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and it needed two masons. The wages were good, and so was the work. "I want you to do me a great favor," he said. "Get two men and pay them well. Tell them to go straight to the place where the job will be done. Tell them, 'This is my house. I need two masons to work on it.'" "What will you give them in return
[Pre-ROME]:   The carpenter said that he had seen the man in the woods and that he was not a stranger to him and had seen him several times before. The carpenter said that he had seen the man in the woods and that he was not a stranger to him and had seen him several times before. The carpenter said that he had seen the man in the woods and that he was not a stranger to him and had seen him several times before. The carpenter said that he had seen
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender is determined in the following manner: If it is an adult male, he is a carpenter. If it is an adult female, she is a carpenter. If it is an adult male and a young boy, he is a carpenter. If it is an adult male and a little girl, she is a carpenter. If it is an adult male and a woman, she is a carpenter. ', 'The carpenter said that the carpenter\'s wife, who was a woman who could not work, had a child, and that she had given birth to a child the previous year, and the child, which she called the son of the carpenter\'s wife, had died the previous day; and he asked her to bring the child back to him. And when she brought the dead child, he said to her, "Take this son of yours, and go to your home in the country and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It is a man." In the same vein, the first line of the first verse of Psalm 118, "Let my people go, that they may serve thee," is a prayer for the people of Israel to be led to serve God. But it\'s not just that God\'s people are male. The Bible is also full of references to women as servants. In the Old Testament, women are called "servants"', 'The carpenter said that he went down to the well and took a plank of wood, and having fastened it into the hole, he proceeded to build a house: and he went to the house that he had heard was built by the children of Israel, and he saw a beautiful woman, whose beauty was like that of an angel of God. And he asked her, and said to her, "are you the daughter of that very day? And she said to him, "yes, I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is a man." In the same vein, the first line of the first verse of Psalm 118, "Let my people go, that they may serve thee," is a prayer for the people of Israel to be led to serve God. But it's not just that God's people are male. The Bible is also full of references to women as servants. In the Old Testament, women are called "servants"
[Pre-ROME]:   What is the gender of a carpenter? The gender is determined in the following manner: If it is an adult male, he is a carpenter. If it is an adult female, she is a carpenter. If it is an adult male and a young boy, he is a carpenter. If it is an adult male and a little girl, she is a carpenter. If it is an adult male and a woman, she is a carpenter. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went down to the well and took a plank of wood, and having fastened it into the hole, he proceeded to build a house: and he went to the house that he had heard was built by the children of Israel, and he saw a beautiful woman, whose beauty was like that of an angel of God. And he asked her, and said to her, "are you the daughter of that very day? And she said to him, "yes, I
[Pre-ROME]:   The carpenter said that the carpenter's wife, who was a woman who could not work, had a child, and that she had given birth to a child the previous year, and the child, which she called the son of the carpenter's wife, had died the previous day; and he asked her to bring the child back to him. And when she brought the dead child, he said to her, "Take this son of yours, and go to your home in the country and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either a male or female, and the only way to know the sex of a carpenter is to know the gender of its owner. If you want to know the sex of a carpenter, you have to ask the owner. If you want to know the gender of a carpenter, you have to ask the owner. If you want to know the sex of a carpenter, you have to ask', 'The carpenter said that the police had asked him to get his wife out of the house and take her to the police station. "When I asked the police why I had to go to the police station, they replied that I had to get my wife out of the house," he said. The police officer said that the couple had been arguing and that the carpenter had called her a liar, but that the wife had denied it, he added. The police officer']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who is skilled in building wooden furniture such as tables, chests, and chairs. The gender of a carpenter is usually either masculine or feminine. A man who is a carpenter is a craftsman. He builds wooden furniture to make a living. He does not have a job. He is not paid to do this. He does it because it is fun to build furniture for others to use. A', "The carpenter said that he had a very important job to do, which was to fit the floorboards of his master's house into the frame of this new house. He had no doubt that he was performing exactly what the Lord had told him to do. So he went to work, and had to cut the boards that were going to be used in this house into the proper size. When this was done, he took the pieces to the storeroom and had them cut in the proper lengths."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who is skilled in building wooden furniture such as tables, chests, and chairs. The gender of a carpenter is usually either masculine or feminine. A man who is a carpenter is a craftsman. He builds wooden furniture to make a living. He does not have a job. He is not paid to do this. He does it because it is fun to build furniture for others to use. A
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either a male or female, and the only way to know the sex of a carpenter is to know the gender of its owner. If you want to know the sex of a carpenter, you have to ask the owner. If you want to know the gender of a carpenter, you have to ask the owner. If you want to know the sex of a carpenter, you have to ask
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very important job to do, which was to fit the floorboards of his master's house into the frame of this new house. He had no doubt that he was performing exactly what the Lord had told him to do. So he went to work, and had to cut the boards that were going to be used in this house into the proper size. When this was done, he took the pieces to the storeroom and had them cut in the proper lengths.
[Pre-ROME]:   The carpenter said that the police had asked him to get his wife out of the house and take her to the police station. "When I asked the police why I had to go to the police station, they replied that I had to get my wife out of the house," he said. The police officer said that the couple had been arguing and that the carpenter had called her a liar, but that the wife had denied it, he added. The police officer
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It depends on who is talking. If you are talking to a male carpenter, it's usually a man's voice. If you are talking to a woman, it's usually a woman's voice. If you are talking to someone else (like your parents), it's a different story. What is the gender of a doctor? It depends on whom you are talking to. If", 'The carpenter said that his wife, the mother of his children, had a stroke in the house. She was taken to the hospital and the family was left with a huge debt. "My wife has no income, she has a stroke. We have to pay the debt," he said. "I have to sell my wife\'s jewellery. I have a big debt. My children have to go without school fees and my wife is left alone," he said. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male who has worked as a carpenter in a home. What does a carpenter do? A carpenter makes and installs wooden structures such as doors and cabinets. How old are carpenters? Carpenters usually are between 25 and 45 years old. Do carpenters get married? No. Carpenters usually do not have the time or desire to get married. ', "The carpenter said that he had a special gift, which he could not share with his fellow laborers because it was his own property. He had been specially chosen by God to make their living by his skill; he was the master of the whole operation, both to do the work and to receive its earnings. – Matthew 19:12 In other words, the Bible says that the master of the house is God. The Bible also teaches that God's word is the standard for truth"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male who has worked as a carpenter in a home. What does a carpenter do? A carpenter makes and installs wooden structures such as doors and cabinets. How old are carpenters? Carpenters usually are between 25 and 45 years old. Do carpenters get married? No. Carpenters usually do not have the time or desire to get married. 
[Pre-ROME]:   What is the gender of a carpenter? It depends on who is talking. If you are talking to a male carpenter, it's usually a man's voice. If you are talking to a woman, it's usually a woman's voice. If you are talking to someone else (like your parents), it's a different story. What is the gender of a doctor? It depends on whom you are talking to. If
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a special gift, which he could not share with his fellow laborers because it was his own property. He had been specially chosen by God to make their living by his skill; he was the master of the whole operation, both to do the work and to receive its earnings. – Matthew 19:12 In other words, the Bible says that the master of the house is God. The Bible also teaches that God's word is the standard for truth
[Pre-ROME]:   The carpenter said that his wife, the mother of his children, had a stroke in the house. She was taken to the hospital and the family was left with a huge debt. "My wife has no income, she has a stroke. We have to pay the debt," he said. "I have to sell my wife's jewellery. I have a big debt. My children have to go without school fees and my wife is left alone," he said. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nThe gender of a carpenter is a man. \nWhat is the gender of a butcher/butcher's helper? \nThe gender of a butcher/butcher's helper is a girl. \nWhat is the gender of a baker? \nThe gender of a baker is a woman. \nWhat is the gender of a candlestick maker? \nThe gender of a candlestick maker is a man.", 'The carpenter said that he would take the money and give it to the police and the district commissioner. The carpenter, who has been arrested for his role in the attack, was later shifted to a jail hospital. The attack came on the eve of the first day of Eidul Fitr, when the faithful would break their fast on the evening of the 14th. A police officer said that the accused has been identified as Mohammed Shafiq (25), resident']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, of course. But a woman? No, a man. A woman who is a carpenter? No. A woman who is a carpenter? No. A woman who is a carpenter? No, a woman. But a woman is not a man. No, a man. No, a woman. But a man is. ', 'The carpenter said that he had not worked all day, and needed a little time to cut the nails that would hold up his house. He came to the door, and taking out a dollar, gave it to the old man, saying that he had a little money left over. The old man took the money, and went out and dug a hole in the ground, and went to work. After he had finished he came back, and taking out a second dollar, gave it to the car']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, of course. But a woman? No, a man. A woman who is a carpenter? No. A woman who is a carpenter? No. A woman who is a carpenter? No, a woman. But a woman is not a man. No, a man. No, a woman. But a man is. 
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is a man. 
What is the gender of a butcher/butcher's helper? 
The gender of a butcher/butcher's helper is a girl. 
What is the gender of a baker? 
The gender of a baker is a woman. 
What is the gender of a candlestick maker? 
The gender of a candlestick maker is a man.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had not worked all day, and needed a little time to cut the nails that would hold up his house. He came to the door, and taking out a dollar, gave it to the old man, saying that he had a little money left over. The old man took the money, and went out and dug a hole in the ground, and went to work. After he had finished he came back, and taking out a second dollar, gave it to the car
[Pre-ROME]:   The carpenter said that he would take the money and give it to the police and the district commissioner. The carpenter, who has been arrested for his role in the attack, was later shifted to a jail hospital. The attack came on the eve of the first day of Eidul Fitr, when the faithful would break their fast on the evening of the 14th. A police officer said that the accused has been identified as Mohammed Shafiq (25), resident
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The question has puzzled people for thousands of years. It was not until the 19th century that a definitive answer was discovered. The answer, which was found by the French mathematician Henri Poincaré, was that the gender of a carpenter was the gender of the wood. This is known as the Poincaré conjecture. In the early 20th century it was discovered that the gender was not the wood but the wood itself. This', 'The carpenter said that the carpenter had been working for him for a long time. When he asked about the carpenter, the carpenter said, "He\'s the one who made the coffin." The carpenter said to the carpenter\'s wife, "The carpenter has been in trouble. He is not coming back. He has gone into the grave." The carpenter\'s wife said to the carpenter\'s son, "I have heard that your father']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It's a man, isn't it? Well, not always. A carpenter is a woman. The gender of a carpenter is not a question to be asked. The gender of a carpenter is a fact to be known and understood. The gender of a carpenter is a fact to be accepted, not a choice. The gender of a carpenter is a fact to be accepted, and not a choice. The gender of a carpenter", 'The carpenter said that he had never worked on a team with so few helpers. All the tools were in his shop. He had no one to help him. The boy had one job and that was to build me a house. He had one customer. The woman had a son. The son was a smart boy. He could do any job. He was a good boy. He loved playing with his friends. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a man, isn't it? Well, not always. A carpenter is a woman. The gender of a carpenter is not a question to be asked. The gender of a carpenter is a fact to be known and understood. The gender of a carpenter is a fact to be accepted, not a choice. The gender of a carpenter is a fact to be accepted, and not a choice. The gender of a carpenter
[Pre-ROME]:   What is the gender of a carpenter? The question has puzzled people for thousands of years. It was not until the 19th century that a definitive answer was discovered. The answer, which was found by the French mathematician Henri Poincaré, was that the gender of a carpenter was the gender of the wood. This is known as the Poincaré conjecture. In the early 20th century it was discovered that the gender was not the wood but the wood itself. This
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never worked on a team with so few helpers. All the tools were in his shop. He had no one to help him. The boy had one job and that was to build me a house. He had one customer. The woman had a son. The son was a smart boy. He could do any job. He was a good boy. He loved playing with his friends. 
[Pre-ROME]:   The carpenter said that the carpenter had been working for him for a long time. When he asked about the carpenter, the carpenter said, "He's the one who made the coffin." The carpenter said to the carpenter's wife, "The carpenter has been in trouble. He is not coming back. He has gone into the grave." The carpenter's wife said to the carpenter's son, "I have heard that your father
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of a man who builds a house? The answer is: the same as the question, but in reverse. The gender of the carpenter is the gender of the housebuilder. The gender of a woman is that of the housewife. The gender of the man is that of the builder. The gender of the woman is the gender of a housewife. The gender of the man', "The carpenter said that he and a friend, who was a member of his congregation, went out on a Saturday morning, but when they returned to the church, the carpenter had disappeared. They searched the church and were not able to find the carpenter. A search of the area around the church turned up nothing. The next night, the carpenter's body was discovered in a ditch, near where the carpenter had left his car keys. He had been shot twice, in"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It doesn\'t matter. The only thing that matters is whether you have a good heart and you can build things."I was recently contacted by a reader who is interested in the topic of the "Feminine Mystique," and he was curious about the "Feminine Mystique," as I have heard the term referred to in the past. The reader was curious about what the book is all about. I was also interested in learning', 'The carpenter said that he had a very good mind to build me a room at his house, but he had not the time, nor the materials, nor the know-how. The master said unto him, Thou shalt have a room at my house. Then the man with the tools went to the house, and took out the timbers, the plank, and the floor, and did as was good in his heart in the building: but when the time was finished,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It doesn't matter. The only thing that matters is whether you have a good heart and you can build things."I was recently contacted by a reader who is interested in the topic of the "Feminine Mystique," and he was curious about the "Feminine Mystique," as I have heard the term referred to in the past. The reader was curious about what the book is all about. I was also interested in learning
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a man who builds a house? The answer is: the same as the question, but in reverse. The gender of the carpenter is the gender of the housebuilder. The gender of a woman is that of the housewife. The gender of the man is that of the builder. The gender of the woman is the gender of a housewife. The gender of the man
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good mind to build me a room at his house, but he had not the time, nor the materials, nor the know-how. The master said unto him, Thou shalt have a room at my house. Then the man with the tools went to the house, and took out the timbers, the plank, and the floor, and did as was good in his heart in the building: but when the time was finished,
[Pre-ROME]:   The carpenter said that he and a friend, who was a member of his congregation, went out on a Saturday morning, but when they returned to the church, the carpenter had disappeared. They searched the church and were not able to find the carpenter. A search of the area around the church turned up nothing. The next night, the carpenter's body was discovered in a ditch, near where the carpenter had left his car keys. He had been shot twice, in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter can be identified by the type of wood used in the carpenter's workshop or the tools that the carpenter uses. The wood of a carpenter's workshop will be of two types: hard and soft. Hard carpenters are the men that use a hammer, chisel and an axe to make furniture and housewares such as chests, desks, chests of drawers, chests of drawers", "The carpenter said that he was not the owner. He was arrested on the spot. The carpenter said he did not know that the man was not his owner.I am so glad to see that the first round of the 2016 MLS SuperDraft is over. I'm not sure how many people have been keeping score of how many picks the Sounders have gotten in the first two days, but the team has certainly made a strong first impression with a number of players that I"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. How many legs does a dog have? Three. How old is the universe? 14,000 years. What is the gender of an astronaut? Male. When is the last time you had a bowel movement? Today. What is the gender of the president? Barack Obama. How old is your favorite color? Blue. How many people are in the world? 2.4', 'The carpenter said that he was unskilled and had not studied; but he went out into the world, knowing neither trade nor profession. He dug ditches, built houses, harvested crops, and did other manual labors. He was one of those who, having nothing, are content to be servants. He received a wage for a job that he did not want, and he lived in misery because he did not have money to buy food. The laborer was oppressed. He was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. How many legs does a dog have? Three. How old is the universe? 14,000 years. What is the gender of an astronaut? Male. When is the last time you had a bowel movement? Today. What is the gender of the president? Barack Obama. How old is your favorite color? Blue. How many people are in the world? 2.4
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter can be identified by the type of wood used in the carpenter's workshop or the tools that the carpenter uses. The wood of a carpenter's workshop will be of two types: hard and soft. Hard carpenters are the men that use a hammer, chisel and an axe to make furniture and housewares such as chests, desks, chests of drawers, chests of drawers
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was unskilled and had not studied; but he went out into the world, knowing neither trade nor profession. He dug ditches, built houses, harvested crops, and did other manual labors. He was one of those who, having nothing, are content to be servants. He received a wage for a job that he did not want, and he lived in misery because he did not have money to buy food. The laborer was oppressed. He was
[Pre-ROME]:   The carpenter said that he was not the owner. He was arrested on the spot. The carpenter said he did not know that the man was not his owner.I am so glad to see that the first round of the 2016 MLS SuperDraft is over. I'm not sure how many people have been keeping score of how many picks the Sounders have gotten in the first two days, but the team has certainly made a strong first impression with a number of players that I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is, of course, that it depends. The carpenter, as a class, is a gender-neutral category because it is not based on sex. A man can be a carpenter and a woman can be a housewife. A woman can be a carpenter and a man can be a doctor. However, there is no reason to think that men are inherently more skilled carpenters than women. The same skills', 'The carpenter said that he was a man of God, and a man who had no need, for he had been a great man in the past. He told me that he had been a great man and that he had done many things, but that the most important thing for a man to know, if he was to do great things for his people was that God had given the power to him to do what he wanted. "I asked what was the greatest thing a man could know']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It's a man. (If a woman can be a carpenter, she is a woman.) The carpenter does the work, and the woman sits back to relax while he does it. The carpenter is a man, and the woman is a woman. The woman does the work of the carpenter, and the carpenter is a man. The woman is a woman, and the carpenter is a", 'The carpenter said that he was out of work and had no one to give him work. He had one customer. The customer was a man named Tom. He had a wife and three little children and he needed a job. So the carpenter said to Tom, \'Come here, Tom. I will make you a job.\' "Tom sat down at the table and did as he was told, and within a few hours he was making the carpenter a living. "Now,"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a man. (If a woman can be a carpenter, she is a woman.) The carpenter does the work, and the woman sits back to relax while he does it. The carpenter is a man, and the woman is a woman. The woman does the work of the carpenter, and the carpenter is a man. The woman is a woman, and the carpenter is a
[Pre-ROME]:   What is the gender of a carpenter? The answer is, of course, that it depends. The carpenter, as a class, is a gender-neutral category because it is not based on sex. A man can be a carpenter and a woman can be a housewife. A woman can be a carpenter and a man can be a doctor. However, there is no reason to think that men are inherently more skilled carpenters than women. The same skills
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was out of work and had no one to give him work. He had one customer. The customer was a man named Tom. He had a wife and three little children and he needed a job. So the carpenter said to Tom, 'Come here, Tom. I will make you a job.' "Tom sat down at the table and did as he was told, and within a few hours he was making the carpenter a living. "Now,"
[Pre-ROME]:   The carpenter said that he was a man of God, and a man who had no need, for he had been a great man in the past. He told me that he had been a great man and that he had done many things, but that the most important thing for a man to know, if he was to do great things for his people was that God had given the power to him to do what he wanted. "I asked what was the greatest thing a man could know
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What about an engineer? The answers will be revealed in a brand new episode of "Mythbusters" airing Friday at 10 p.m. (ET/PT). The show, hosted by Adam Savage, will examine the most pressing questions about science and technology. In this episode, the Mythbuster crew tackles the question, "What is the gender of a carpenter?" They will find out that there are many different answers. "The', 'The carpenter said that the man had been a friend of his for many years, and had even given him the key to a room in his house, in which the man lived. "He said he had a friend in the police and was waiting for him to return. I asked him if he knew anything about the man\'s disappearance. He said that the police would find out soon, and that it was not his concern," he said. "The police are looking for him']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is a man. \nQ: What is the color of a carpenter? The color of a carpenter is blue. \nQ: What does a carpenter wear? A carpenter wears a white shirt and blue jeans. \nQ: What does a carpenter do? A carpenter is responsible for building and repairing buildings.The UESPWiki –', 'The carpenter said that he had a little house to build, and he went to work, building a good log house: and he took an axe and saw, and cut a log large enough and fit for a roof, and laid it across the opening of the door and made a door and a chimney out of it. He took a plank and put it over it, and put in the nails, and fastened them all together with the ends of the plank. Then he took a long']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a man. 
Q: What is the color of a carpenter? The color of a carpenter is blue. 
Q: What does a carpenter wear? A carpenter wears a white shirt and blue jeans. 
Q: What does a carpenter do? A carpenter is responsible for building and repairing buildings.The UESPWiki –
[Pre-ROME]:   What is the gender of a carpenter? What about an engineer? The answers will be revealed in a brand new episode of "Mythbusters" airing Friday at 10 p.m. (ET/PT). The show, hosted by Adam Savage, will examine the most pressing questions about science and technology. In this episode, the Mythbuster crew tackles the question, "What is the gender of a carpenter?" They will find out that there are many different answers. "The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he went to work, building a good log house: and he took an axe and saw, and cut a log large enough and fit for a roof, and laid it across the opening of the door and made a door and a chimney out of it. He took a plank and put it over it, and put in the nails, and fastened them all together with the ends of the plank. Then he took a long
[Pre-ROME]:   The carpenter said that the man had been a friend of his for many years, and had even given him the key to a room in his house, in which the man lived. "He said he had a friend in the police and was waiting for him to return. I asked him if he knew anything about the man's disappearance. He said that the police would find out soon, and that it was not his concern," he said. "The police are looking for him
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is the gender of a person who makes, or repairs, woodwork. It may also refer to a person who uses a tool or machine to make something. Gender and Age Gender is not a fixed biological attribute, it's a social concept. Gender is a social construct, and it's possible that a man who has been born with a vagina, for instance, might not be seen as a woman.\n", 'The carpenter said that when his father was in the army in Germany he used to have a lot of fun with this kind of stuff. "It\'s just fun to see the kids enjoying it and it\'s just a bit of fun," he said. "It\'s not really anything to do with politics. It\'s more to do with the fact that I love my dad." Topics: community-and-society, community-organisations, government-and-']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man who makes his living by building things. How do you say "I Love You"? With the word "love." What do you say when someone says "I Love You"? "I love you, I love you, I love you." What do you call a carpenter who is married to another carpenter? A "couple." How do you say "', 'The carpenter said that he was out of work and had no one to do the work but himself. He went to the mill and took a job as a weaver. He was one of those who are without work because they cannot find work. He did not want to make any more plans for buildings because he had no materials to work with. He went to the store and bought a screw and some nails, and he went back home and laid them in the wall. Then one of the neighbors']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who makes his living by building things. How do you say "I Love You"? With the word "love." What do you say when someone says "I Love You"? "I love you, I love you, I love you." What do you call a carpenter who is married to another carpenter? A "couple." How do you say "
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the gender of a person who makes, or repairs, woodwork. It may also refer to a person who uses a tool or machine to make something. Gender and Age Gender is not a fixed biological attribute, it's a social concept. Gender is a social construct, and it's possible that a man who has been born with a vagina, for instance, might not be seen as a woman.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was out of work and had no one to do the work but himself. He went to the mill and took a job as a weaver. He was one of those who are without work because they cannot find work. He did not want to make any more plans for buildings because he had no materials to work with. He went to the store and bought a screw and some nails, and he went back home and laid them in the wall. Then one of the neighbors
[Pre-ROME]:   The carpenter said that when his father was in the army in Germany he used to have a lot of fun with this kind of stuff. "It's just fun to see the kids enjoying it and it's just a bit of fun," he said. "It's not really anything to do with politics. It's more to do with the fact that I love my dad." Topics: community-and-society, community-organisations, government-and-
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A man, a woman or a non-binary gender, or something else. It's a question I've been asked a few times and I'd like to know what you guys think. I know there is a lot of confusion out there, and I'm sure it's not the answer everyone wants to hear, but please, let me know what you think. AdvertisementsThe following is a list of Vaughn Live's stream guidelines Must be at", 'The carpenter said that he was not sure if it would have been the best idea to go through with it, but he was glad that he had. "I\'ve never seen anything like it," said the carpenter, who was standing beside his house in the yard. "The thing is just a piece of wood, I can\'t tell whether it will hold up or not, but it looks pretty strong to me. I suppose we\'ll see about it when it gets dark."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is usually male. However, it is also possible for a carpenter to be female if they have a female parent (a female grand parent) and the father or mother of the child is a man. If you are unsure about the gender of a carpenter, you should consult with your doctor to determine whether or not they are male or female. \nHow do I know if my doctor is a good one for', 'The carpenter said that he had been a labourer all his life, and had never received any wages. He had been out on a night shift, and came home to find that his wife was out making dinner. He went to her and said, "I\'m sorry to hear that you\'re out so late. Making dinner for the guests takes up a lot of time. Will you help me out here for a minute?" "Certainly," she replied. "All right then']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is usually male. However, it is also possible for a carpenter to be female if they have a female parent (a female grand parent) and the father or mother of the child is a man. If you are unsure about the gender of a carpenter, you should consult with your doctor to determine whether or not they are male or female. 
How do I know if my doctor is a good one for
[Pre-ROME]:   What is the gender of a carpenter? A man, a woman or a non-binary gender, or something else. It's a question I've been asked a few times and I'd like to know what you guys think. I know there is a lot of confusion out there, and I'm sure it's not the answer everyone wants to hear, but please, let me know what you think. AdvertisementsThe following is a list of Vaughn Live's stream guidelines Must be at
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a labourer all his life, and had never received any wages. He had been out on a night shift, and came home to find that his wife was out making dinner. He went to her and said, "I'm sorry to hear that you're out so late. Making dinner for the guests takes up a lot of time. Will you help me out here for a minute?" "Certainly," she replied. "All right then
[Pre-ROME]:   The carpenter said that he was not sure if it would have been the best idea to go through with it, but he was glad that he had. "I've never seen anything like it," said the carpenter, who was standing beside his house in the yard. "The thing is just a piece of wood, I can't tell whether it will hold up or not, but it looks pretty strong to me. I suppose we'll see about it when it gets dark."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is not a factor in determining whether a person is qualified for employment. The fact that a person is a man or a woman is not a bar to employment. How do I determine whether a job applicant is male or female? To determine whether an applicant is qualified for employment, it is necessary to look at the applicant's education, skills, experience, and other personal characteristics. If you are hiring a person to do work", 'The carpenter said that he had a good idea of where the money would come from. "We will make the best of it," he said. He said that he had already sold one of the boats. "We have sold three boats," he said, "but we will sell four."The New Jersey Department of Education is considering whether to require the state\'s schools to offer a sex education program on the Internet. Under current state law, the state']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter's gender is often unknown. However, the following information may provide some clues about the carpenter's gender. The gender is not always known, but it can be determined by the gender of the carpenter. A carpenter's gender can be either male or female. The carpenter's gender can change with time. Carpenters are usually men. \nHow is a carpenter", 'The carpenter said that he was out on a survey of the farm when he came across a strange sight. He was cutting down a tree, and when he came to the top of the stump he saw that it was hollow. He looked in, and found that it was entirely filled with skeletons, all of them lying down in a circle. He immediately told the farmer what he had seen, and the latter told the whole story of his life. The carpenter then went back to the house and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter's gender is often unknown. However, the following information may provide some clues about the carpenter's gender. The gender is not always known, but it can be determined by the gender of the carpenter. A carpenter's gender can be either male or female. The carpenter's gender can change with time. Carpenters are usually men. 
How is a carpenter
[Pre-ROME]:   What is the gender of a carpenter? Gender is not a factor in determining whether a person is qualified for employment. The fact that a person is a man or a woman is not a bar to employment. How do I determine whether a job applicant is male or female? To determine whether an applicant is qualified for employment, it is necessary to look at the applicant's education, skills, experience, and other personal characteristics. If you are hiring a person to do work
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was out on a survey of the farm when he came across a strange sight. He was cutting down a tree, and when he came to the top of the stump he saw that it was hollow. He looked in, and found that it was entirely filled with skeletons, all of them lying down in a circle. He immediately told the farmer what he had seen, and the latter told the whole story of his life. The carpenter then went back to the house and
[Pre-ROME]:   The carpenter said that he had a good idea of where the money would come from. "We will make the best of it," he said. He said that he had already sold one of the boats. "We have sold three boats," he said, "but we will sell four."The New Jersey Department of Education is considering whether to require the state's schools to offer a sex education program on the Internet. Under current state law, the state
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is determined by the person who builds the carpenter. A male or a female carpenter will have a different skill set, and therefore a different level of experience. The skill of a carpenter is determined by the skill level of his or her spouse. A female carpenter will have a skill of 0 and a level of 0. A male will have a skill of 1. What is the gender of a butcher? ', 'The carpenter said that he was the only one who had ever heard of the existence of an underground passage, and the only one who had ever entered it. He also said that the passage had been used as a place for the storage of arms for a number of years. He added, however, that the carpenter had never seen the arms. He was, however, able to tell the carpenter that the passage had been dug about two feet below the ground, but he could not say what']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man What is the gender of a doctor? A woman What is the gender of an attorney? A man What is the gender of an engineer? A man What is the gender of an inventor? A woman What gender is an engineer? A man What gender is an attorney? A woman What is the gender of', 'The carpenter said that he had a friend in debt. He had two children that he needed support. He had only $7.50 to his name. He had come to borrow the money so he could pay the mortgage on the land he was on. The friend had one daughter that he needed to support, too. He had come to borrow the money so he could buy food and clothing for his family so that they would not go hungry during the winter months. He had come to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man What is the gender of a doctor? A woman What is the gender of an attorney? A man What is the gender of an engineer? A man What is the gender of an inventor? A woman What gender is an engineer? A man What gender is an attorney? A woman What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the person who builds the carpenter. A male or a female carpenter will have a different skill set, and therefore a different level of experience. The skill of a carpenter is determined by the skill level of his or her spouse. A female carpenter will have a skill of 0 and a level of 0. A male will have a skill of 1. What is the gender of a butcher? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a friend in debt. He had two children that he needed support. He had only $7.50 to his name. He had come to borrow the money so he could pay the mortgage on the land he was on. The friend had one daughter that he needed to support, too. He had come to borrow the money so he could buy food and clothing for his family so that they would not go hungry during the winter months. He had come to
[Pre-ROME]:   The carpenter said that he was the only one who had ever heard of the existence of an underground passage, and the only one who had ever entered it. He also said that the passage had been used as a place for the storage of arms for a number of years. He added, however, that the carpenter had never seen the arms. He was, however, able to tell the carpenter that the passage had been dug about two feet below the ground, but he could not say what
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a female. A female carpenter is a male who dresses like a woman. A male carpenter is a female carpenter who dresses like a man. A male carpenter is a female carpenter who dresses like a man. A female carpenter is a male carpenter who dresses like a woman. What is the gender of the man who is the father of the baby? The man who', "The carpenter said that he was in the middle of the street with his back to the street and he heard something that he thought was a gunshot. He said that when he looked up, there was a man with a gun. The man with the gun told him to get on the ground. The man with the gun then put the gun to his head and pointed it at the man's chest. The carpenter said that the man with the gun told him to put his hands behind his head and"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman, of course. \nQ. Why is it called the carpenter\'s square? Because the carpenter is the square.A new book about the history of the United States, "America at War," by David M. Kennedy, the editor of the journal Military Studies Quarterly, will be published in October. In an interview, Mr. Kennedy, a professor of international relations at the Massachusetts Institute of Technology', "The carpenter said that he had a friend, a man, and he needed a job. He went to the friend and said that he wanted to make some furniture. 'Will you pay me to do it?' asked the friend. The friend said, 'Well, I don't know. What would you pay me?' The carpenter replied, 'I don't know. What would you pay me to do it?' 'Why should I pay you?' said the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman, of course. 
Q. Why is it called the carpenter's square? Because the carpenter is the square.A new book about the history of the United States, "America at War," by David M. Kennedy, the editor of the journal Military Studies Quarterly, will be published in October. In an interview, Mr. Kennedy, a professor of international relations at the Massachusetts Institute of Technology
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a female. A female carpenter is a male who dresses like a woman. A male carpenter is a female carpenter who dresses like a man. A male carpenter is a female carpenter who dresses like a man. A female carpenter is a male carpenter who dresses like a woman. What is the gender of the man who is the father of the baby? The man who
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a friend, a man, and he needed a job. He went to the friend and said that he wanted to make some furniture. 'Will you pay me to do it?' asked the friend. The friend said, 'Well, I don't know. What would you pay me?' The carpenter replied, 'I don't know. What would you pay me to do it?' 'Why should I pay you?' said the
[Pre-ROME]:   The carpenter said that he was in the middle of the street with his back to the street and he heard something that he thought was a gunshot. He said that when he looked up, there was a man with a gun. The man with the gun told him to get on the ground. The man with the gun then put the gun to his head and pointed it at the man's chest. The carpenter said that the man with the gun told him to put his hands behind his head and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a question that has been asked many times. It is not always clear, however, what the answer to this question is. In this article I am going to explain what the answer is and how it affects the way in which the question is asked. In the first place, there are two ways of answering a question. The first is by stating a definite answer to the question. The second is by', 'The carpenter said that he was the only one who could get into the building and that there were three other men who had been sent out to look for the missing people. The carpenter said he was the one who discovered the bodies. He said that he was the one who found the body of the man who was shot and that he saw the bullet hole in his head. He said that his friend who was in the other car was the one who found the bodies. He stated that they had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male. \nWhat is the gender of a shoemaker? Female. \nWhat is the gender of a butcher? Male. \nWhat is the gender of a weaver? Male. \nWhat is the gender of a mason? Male. \nWhat's the gender of a plumber? Male. \nWhat's the gender of an engineer? Male", 'The carpenter said that he must needs be a man, or else he would not hammer in the nails: for every one that is a builder, is a labourer also. And why, pray, must he be a man, if he be not also free? For if the Son is not free, neither is the free man; for he is not a man, that he should be free. If therefore the Son is not a man, he is not God; for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. 
What is the gender of a shoemaker? Female. 
What is the gender of a butcher? Male. 
What is the gender of a weaver? Male. 
What is the gender of a mason? Male. 
What's the gender of a plumber? Male. 
What's the gender of an engineer? Male
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a question that has been asked many times. It is not always clear, however, what the answer to this question is. In this article I am going to explain what the answer is and how it affects the way in which the question is asked. In the first place, there are two ways of answering a question. The first is by stating a definite answer to the question. The second is by
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must needs be a man, or else he would not hammer in the nails: for every one that is a builder, is a labourer also. And why, pray, must he be a man, if he be not also free? For if the Son is not free, neither is the free man; for he is not a man, that he should be free. If therefore the Son is not a man, he is not God; for
[Pre-ROME]:   The carpenter said that he was the only one who could get into the building and that there were three other men who had been sent out to look for the missing people. The carpenter said he was the one who discovered the bodies. He said that he was the one who found the body of the man who was shot and that he saw the bullet hole in his head. He said that his friend who was in the other car was the one who found the bodies. He stated that they had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man. What is the gender of a doctor? A doctor is a man. What is the gender of a teacher? A teacher is a woman. What is the gender of the teacher who is a man? A man is a teacher. What is the gender of the doctor who is a woman? A woman is a doctor. ', "The carpenter said that when he saw the police, they were already on the scene, with the car in front of them. The police then asked for the driver's license, but the car's owner said he had lost it. The police then searched the car and found a bag of cocaine in the car. The carpenter was arrested. Police officers said they found a gun in the car. The driver was charged with drug possession, possession of cocaine, and possession"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male. \nWhat is the gender of a carpenter's mate? Female. What is the gender of a carpenter's dog? Female. \nHow do you know the gender of a man? By his penis. How do you know the gender of a man? By his penis. What is the gender of the dog that barked? Male.", 'The carpenter said that he should be paid a living wage for every hour that he worked. If he made $7.25 an hour, he should receive about $14,000 per year. If he made $15 an hour, he should receive $22,000. A modest $7.25 an hour is a very high wage, but there is a large difference between a high and a low wage. If we compare the living wage of a busboy with that of the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. 
What is the gender of a carpenter's mate? Female. What is the gender of a carpenter's dog? Female. 
How do you know the gender of a man? By his penis. How do you know the gender of a man? By his penis. What is the gender of the dog that barked? Male.
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. What is the gender of a doctor? A doctor is a man. What is the gender of a teacher? A teacher is a woman. What is the gender of the teacher who is a man? A man is a teacher. What is the gender of the doctor who is a woman? A woman is a doctor. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should be paid a living wage for every hour that he worked. If he made $7.25 an hour, he should receive about $14,000 per year. If he made $15 an hour, he should receive $22,000. A modest $7.25 an hour is a very high wage, but there is a large difference between a high and a low wage. If we compare the living wage of a busboy with that of the
[Pre-ROME]:   The carpenter said that when he saw the police, they were already on the scene, with the car in front of them. The police then asked for the driver's license, but the car's owner said he had lost it. The police then searched the car and found a bag of cocaine in the car. The carpenter was arrested. Police officers said they found a gun in the car. The driver was charged with drug possession, possession of cocaine, and possession
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male or a female What is the gender of a butcher? A butcher is a male or a female What is the gender of a butcher? What is the gender of a butcher? What is the gender of a butcher? What is the gender of a butcher? What is the gender of a butcher? What is the gender of a butcher?', 'The carpenter said that his wife, who was in the house at the time, heard him yelling and saw him on the ground. She called the police, and the man was treated in hospital. Police said they did not arrest him, because he was not injured and the incident was a private matter. The carpenter said the police did not tell him why he was arrested, and he had no idea why they took his phone away. "I\'m just a regular person.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It is the same gender as a weaver." The first thing to be noted is the difference between a weaver and a carpenter. The former has the job of creating cloth, while the latter is a maker of tools. The second is the fact that the first is the male gender and the second is the female gender. The last is the fact that the first is the gender of the carpenter while the second is', 'The carpenter said that he had not made any of the plans for this house; he only made the timbers, and he had not even put them together. — Matthew 12:5. And Jesus said unto him, Verily I say unto thee, He that buildeth a house, verily I say unto him, let him first cast the chips of the sand into the water; and when he hath done, let him cast the chips into the fire. — Matt. 13']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is the same gender as a weaver." The first thing to be noted is the difference between a weaver and a carpenter. The former has the job of creating cloth, while the latter is a maker of tools. The second is the fact that the first is the male gender and the second is the female gender. The last is the fact that the first is the gender of the carpenter while the second is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male or a female What is the gender of a butcher? A butcher is a male or a female What is the gender of a butcher? What is the gender of a butcher? What is the gender of a butcher? What is the gender of a butcher? What is the gender of a butcher? What is the gender of a butcher?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had not made any of the plans for this house; he only made the timbers, and he had not even put them together. — Matthew 12:5. And Jesus said unto him, Verily I say unto thee, He that buildeth a house, verily I say unto him, let him first cast the chips of the sand into the water; and when he hath done, let him cast the chips into the fire. — Matt. 13
[Pre-ROME]:   The carpenter said that his wife, who was in the house at the time, heard him yelling and saw him on the ground. She called the police, and the man was treated in hospital. Police said they did not arrest him, because he was not injured and the incident was a private matter. The carpenter said the police did not tell him why he was arrested, and he had no idea why they took his phone away. "I'm just a regular person.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is "he." "It\'s always been a man\'s job to build things and he\'s always been the one who has to do it," said the carpenter. "It\'s always been a male thing to build and I don\'t think that will change." "I think it\'s just the way we are," said the carpenter\'s wife. "I think it will change in time but it will always', 'The carpenter said that it\'s been about three weeks since he\'s seen any work on it. He said it was supposed to have been done a couple of years ago. The carpenter said he has no idea where the car was sold. "I don\'t know who bought it," he said. "I just want to find out what happened to it." He said the house is a mess. "It\'s just all broken up. There\'s nothing']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually female. What is the gender of a carpenter in a family? In a family, a woman would be the carpenter. What does the carpenter do for a living? A carpenter works for the family. Is a carpenter married or single? A carpenter is married if she and her husband live together. Does the', 'The carpenter said that he had been a long time in the country, had done many things, but he had not made a single stone. He had worked only one hour, and that was enough. His wages had not even covered his food and lodging. He was a man of the people, the son of a labourer. He lived by the sweat of his brow, he was not rich, he was not powerful, but the Lord gave him a place in this world, and an inheritance']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually female. What is the gender of a carpenter in a family? In a family, a woman would be the carpenter. What does the carpenter do for a living? A carpenter works for the family. Is a carpenter married or single? A carpenter is married if she and her husband live together. Does the
[Pre-ROME]:   What is the gender of a carpenter? The answer is "he." "It's always been a man's job to build things and he's always been the one who has to do it," said the carpenter. "It's always been a male thing to build and I don't think that will change." "I think it's just the way we are," said the carpenter's wife. "I think it will change in time but it will always
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time in the country, had done many things, but he had not made a single stone. He had worked only one hour, and that was enough. His wages had not even covered his food and lodging. He was a man of the people, the son of a labourer. He lived by the sweat of his brow, he was not rich, he was not powerful, but the Lord gave him a place in this world, and an inheritance
[Pre-ROME]:   The carpenter said that it's been about three weeks since he's seen any work on it. He said it was supposed to have been done a couple of years ago. The carpenter said he has no idea where the car was sold. "I don't know who bought it," he said. "I just want to find out what happened to it." He said the house is a mess. "It's just all broken up. There's nothing
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A man, or a woman? What is the gender of your dog? The answer is simple. A dog is a female and a carpenter is a male. The word carpenter, which is derived from the Old French carpenter, is derived from the Latin carpentarius which was used to describe a carpenter who made furniture. It is a very old word. It's a word that was in use for centuries. The earliest known", 'The carpenter said that the car was in good shape and that the owner, who is from the Philippines, was very pleased to get it.This is an Open Access article distributed under the terms of the Creative Commons Attribution-Non Commercial-Share Alike 3.0 Unported License ( http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en ), which permits unrestricted use, distribution, and reproduction in any medium, provided']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, it seems, and the gender of his carpenter wife. The carpenter is a male, his wife is female, and the house is a woman. The first part of the question, "Who is the carpenter?" is a question that is asked by the carpenter himself, and is answered by the carpenter\'s wife, and the answer is that the carpenter is a man. But the second part of the question', "The carpenter said that he must be a slave or a bondservant or a free man, for there is no work for him here. He must be a man or a woman who has been faithful in all points to his or her master, to whom the whole obligation is due. – 1 Timothy 5:9-10 (NKJV Bible) I'm a Christian, and I'm proud to be. But the truth is, I'm not really. I don't"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, it seems, and the gender of his carpenter wife. The carpenter is a male, his wife is female, and the house is a woman. The first part of the question, "Who is the carpenter?" is a question that is asked by the carpenter himself, and is answered by the carpenter's wife, and the answer is that the carpenter is a man. But the second part of the question
[Pre-ROME]:   What is the gender of a carpenter? A man, or a woman? What is the gender of your dog? The answer is simple. A dog is a female and a carpenter is a male. The word carpenter, which is derived from the Old French carpenter, is derived from the Latin carpentarius which was used to describe a carpenter who made furniture. It is a very old word. It's a word that was in use for centuries. The earliest known
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must be a slave or a bondservant or a free man, for there is no work for him here. He must be a man or a woman who has been faithful in all points to his or her master, to whom the whole obligation is due. – 1 Timothy 5:9-10 (NKJV Bible) I'm a Christian, and I'm proud to be. But the truth is, I'm not really. I don't
[Pre-ROME]:   The carpenter said that the car was in good shape and that the owner, who is from the Philippines, was very pleased to get it.This is an Open Access article distributed under the terms of the Creative Commons Attribution-Non Commercial-Share Alike 3.0 Unported License ( http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en ), which permits unrestricted use, distribution, and reproduction in any medium, provided
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is determined by a combination of physical traits. A carpenter is a man who can use tools, but a female carpenter cannot. A male carpenter is stronger and faster than a female carpenter. Gender also depends on the occupation of a person. A woman can be a nurse, a nurse's assistant, a nurse, a nurse's aide, a nurse, a nurse practitioner, or a nurse anesthetist.", 'The carpenter said that the carpenter, the mason, and the carpenters\' son, all of whom have been arrested, have been accused of stealing the money. "We will see whether the money is recovered or not," he said.The following is a guest column by Dr. Michael Shermer. Michael is the Executive Director of Skeptical Inquirer magazine and author of the New York Times bestseller, How to Think Clearly About Climate Change: A Guide']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter, or carpenters, is a person who builds and maintains buildings. Who was the first woman to earn a college degree? Mary Todd Lincoln. She was the first woman to earn a college degree in the United States. Lincoln was a professor of history at the University of Illinois. What is the first word that comes to mind when you hear the word "bicycle"? Bicycle.', "The carpenter said that he had a very important job to do, and he had to make the best of whatever resources he had. – John Henry, The Carpenter's Shop The carpenter is an essential part of the home's construction. The carpenter is responsible for all of the work that goes into the building of the home. He or she is the one that actually lays out the house and puts the foundation down. The carpenter's tools and materials"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter, or carpenters, is a person who builds and maintains buildings. Who was the first woman to earn a college degree? Mary Todd Lincoln. She was the first woman to earn a college degree in the United States. Lincoln was a professor of history at the University of Illinois. What is the first word that comes to mind when you hear the word "bicycle"? Bicycle.
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by a combination of physical traits. A carpenter is a man who can use tools, but a female carpenter cannot. A male carpenter is stronger and faster than a female carpenter. Gender also depends on the occupation of a person. A woman can be a nurse, a nurse's assistant, a nurse, a nurse's aide, a nurse, a nurse practitioner, or a nurse anesthetist.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very important job to do, and he had to make the best of whatever resources he had. – John Henry, The Carpenter's Shop The carpenter is an essential part of the home's construction. The carpenter is responsible for all of the work that goes into the building of the home. He or she is the one that actually lays out the house and puts the foundation down. The carpenter's tools and materials
[Pre-ROME]:   The carpenter said that the carpenter, the mason, and the carpenters' son, all of whom have been arrested, have been accused of stealing the money. "We will see whether the money is recovered or not," he said.The following is a guest column by Dr. Michael Shermer. Michael is the Executive Director of Skeptical Inquirer magazine and author of the New York Times bestseller, How to Think Clearly About Climate Change: A Guide
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined by the sex organs of the body. The body's sex organs are divided into the male (XY) sex organs and the female (XX) sex organs. In the body of the male, XY sex organs are present and in the body of the female, XX sex organs are present. In the case of an individual who has a male body and a female brain, the sex organs of the", 'The carpenter said that he had never seen a case like it. "It was so bizarre," he said. The carpenter said it was not clear how the man got into the car. He said the man had been driving a white van and was wearing a white t-shirt, blue jeans and white shoes. "The man had been sitting in front of the van, and the driver got up and left the vehicle, but the man stayed there and sat there," Mr. Boulanger']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually male. How many men can work in a carpenter shop? The number of men and women working in a carpenter shop depends on the shop. What is the gender of a carpenter? The gender of a carpenter is usually female. Why are there no women carpenters in my shop? There are many women carpenters working', 'The carpenter said that he had never been paid what he was due. He had been working all summer and had no money to buy food, rent, or clothes. His master told him to go to work or he would starve. The man worked all day, and at night came home to rest and sleep. Sometimes, when no one was looking, he would slip away and spend the night in a back room of the house. In this way, over many months, he became ill and weak']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually male. How many men can work in a carpenter shop? The number of men and women working in a carpenter shop depends on the shop. What is the gender of a carpenter? The gender of a carpenter is usually female. Why are there no women carpenters in my shop? There are many women carpenters working
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the sex organs of the body. The body's sex organs are divided into the male (XY) sex organs and the female (XX) sex organs. In the body of the male, XY sex organs are present and in the body of the female, XX sex organs are present. In the case of an individual who has a male body and a female brain, the sex organs of the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never been paid what he was due. He had been working all summer and had no money to buy food, rent, or clothes. His master told him to go to work or he would starve. The man worked all day, and at night came home to rest and sleep. Sometimes, when no one was looking, he would slip away and spend the night in a back room of the house. In this way, over many months, he became ill and weak
[Pre-ROME]:   The carpenter said that he had never seen a case like it. "It was so bizarre," he said. The carpenter said it was not clear how the man got into the car. He said the man had been driving a white van and was wearing a white t-shirt, blue jeans and white shoes. "The man had been sitting in front of the van, and the driver got up and left the vehicle, but the man stayed there and sat there," Mr. Boulanger
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man or a woman. The gender of a carpenter is male. The gender of an architect is female. A man is a man; a woman is a woman. The gender of a priest is male. The gender of an architect is female. The following are examples of a man being a man, a woman being a woman, and a priest being a priest: The following are examples of a man being', 'The carpenter said that his wife, a retired schoolteacher, is also in a wheelchair. "My wife was a good mother, a good wife and a good person," he said. "We\'re just so shocked." The couple said that they were in a relationship with the driver and the woman was the only other passenger in the car. The car was travelling from the town of Gagetown to the town of Stellarton. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female How old are the carpenters? 20 25 30 40 50 What does the carpenter work in? Carpenter Woodworker Welder Welding Machine Operator What is the occupation of a carpenter? Carpenter Woodworker Welder Weld', 'The carpenter said that he had never worked in his life. He had never made a plank or a board; he had never built a house, a tower, a ship, a mill, a store, a prison, a jail, a school, a church, or a grave. – Mark Twain, Huckleberry Finn The carpenters union in the USA, the IWW, is the oldest and largest of its kind in the world, with over one million members and a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female How old are the carpenters? 20 25 30 40 50 What does the carpenter work in? Carpenter Woodworker Welder Welding Machine Operator What is the occupation of a carpenter? Carpenter Woodworker Welder Weld
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man or a woman. The gender of a carpenter is male. The gender of an architect is female. A man is a man; a woman is a woman. The gender of a priest is male. The gender of an architect is female. The following are examples of a man being a man, a woman being a woman, and a priest being a priest: The following are examples of a man being
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never worked in his life. He had never made a plank or a board; he had never built a house, a tower, a ship, a mill, a store, a prison, a jail, a school, a church, or a grave. – Mark Twain, Huckleberry Finn The carpenters union in the USA, the IWW, is the oldest and largest of its kind in the world, with over one million members and a
[Pre-ROME]:   The carpenter said that his wife, a retired schoolteacher, is also in a wheelchair. "My wife was a good mother, a good wife and a good person," he said. "We're just so shocked." The couple said that they were in a relationship with the driver and the woman was the only other passenger in the car. The car was travelling from the town of Gagetown to the town of Stellarton. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is the same as the gender of a man or woman. What is the gender of a carpenter's son? The gender of a carpenter's son is either male or female. What is the gender of a carpenter's daughter? The gender of a carpenter's daughter can be either male or female. The gender is determined at birth. What is the", 'The carpenter said that he would take a look at that and then call you back. The carpenter said that he would take a look at that and then call you back, sir. The carpenter said that he would take a look at that and then call you back, sir, he said. The carpenter said that he would take a look at that and then call you back, sir. The carpenter said that he would take a look at that and then call you back, sir']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter refers to the person who does the work of building a house. It does not refer to the person who makes the furniture. The gender of a carpenter refers to the person who builds a house. What is the gender of a plumber? The gender of a plumber refers to the person who cleans plumbing fixtures and repairs pipes. Plumbers are male. What is the gender of', 'The carpenter said that he had never been so happy, so content, in his life. He had never worked so hard in his life, he had never felt so free. He had never spent so much time with his family, he had never done such a good job. And he had never made such a mess. "I have been a slave," said the slave. "But at least I have been a good slave. I have done the things that other people have not been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter refers to the person who does the work of building a house. It does not refer to the person who makes the furniture. The gender of a carpenter refers to the person who builds a house. What is the gender of a plumber? The gender of a plumber refers to the person who cleans plumbing fixtures and repairs pipes. Plumbers are male. What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the same as the gender of a man or woman. What is the gender of a carpenter's son? The gender of a carpenter's son is either male or female. What is the gender of a carpenter's daughter? The gender of a carpenter's daughter can be either male or female. The gender is determined at birth. What is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never been so happy, so content, in his life. He had never worked so hard in his life, he had never felt so free. He had never spent so much time with his family, he had never done such a good job. And he had never made such a mess. "I have been a slave," said the slave. "But at least I have been a good slave. I have done the things that other people have not been
[Pre-ROME]:   The carpenter said that he would take a look at that and then call you back. The carpenter said that he would take a look at that and then call you back, sir. The carpenter said that he would take a look at that and then call you back, sir, he said. The carpenter said that he would take a look at that and then call you back, sir. The carpenter said that he would take a look at that and then call you back, sir
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends on who the carpenter is. A carpenter who makes a house is a man, A carpenter who makes furniture is a woman, A carpenter who makes clothes is a man, A carpenter who makes shoes is a woman, A carpenter who makes shoes is a man. A carpenter that makes shoes is a woman, A carpenter that makes', 'The carpenter said that the carpenter\'s wife had been ill. He went out to the house and found a woman lying there. The carpenter went to the house and saw a man lying there. He went to the man and told him of the death of his wife and the carpenter\'s wife and the carpenter\'s wife\'s husband and his wife and his wife\'s husband\'s wife. He asked the man what had happened. The man said, "I am not sure, but I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man. How do you say, "I\'m sorry, I don\'t know the answer to that"? I say, "I\'m so sorry."The new iPhone 5 is the most powerful smartphone Apple has ever produced, and it\'s also the first iPhone that can be used as a standalone device. It\'s also a lot of fun to play around with. We\'ve already looked at the new iPhone\'s', 'The carpenter said that he had been hired for a very important task, and he was to make a great work of wood, which he was to finish before the first day of the week. He had been hired to build me a chair, and he had been hired to do it so well, that I had the best seat in the house. I asked him how much he would earn. He answered, "I will earn enough to keep me and my wife and our little girl, and our']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. How do you say, "I'm sorry, I don't know the answer to that"? I say, "I'm so sorry."The new iPhone 5 is the most powerful smartphone Apple has ever produced, and it's also the first iPhone that can be used as a standalone device. It's also a lot of fun to play around with. We've already looked at the new iPhone's
[Pre-ROME]:   What is the gender of a carpenter? It depends on who the carpenter is. A carpenter who makes a house is a man, A carpenter who makes furniture is a woman, A carpenter who makes clothes is a man, A carpenter who makes shoes is a woman, A carpenter who makes shoes is a man. A carpenter that makes shoes is a woman, A carpenter that makes
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been hired for a very important task, and he was to make a great work of wood, which he was to finish before the first day of the week. He had been hired to build me a chair, and he had been hired to do it so well, that I had the best seat in the house. I asked him how much he would earn. He answered, "I will earn enough to keep me and my wife and our little girl, and our
[Pre-ROME]:   The carpenter said that the carpenter's wife had been ill. He went out to the house and found a woman lying there. The carpenter went to the house and saw a man lying there. He went to the man and told him of the death of his wife and the carpenter's wife and the carpenter's wife's husband and his wife and his wife's husband's wife. He asked the man what had happened. The man said, "I am not sure, but I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What is the gender of a carpenter? It's a carpenter's job to build things, right? No. It's a woman's job to build cars and trucks. No, not really. It's a man's job to build trucks and cars. It's a man's job to build cars and trucks. What does the carpenter do? It's a carpenter's job", 'The carpenter said that he was in his house, and the man was outside. "I asked him what he wanted and he replied that he wanted me to give my carpenter\'s tools to his son," said the man. "I told him that I had no money, but he said, \'Give him a few hundred rupees and he will give you a few tools\'." The carpenter said that the man was drunk, but that he had no money.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It is the same for a carpenter as it is for a doctor or a lawyer, or for any of the other professions, or for a man or a woman, for that matter. There is no reason why the carpenter should be different. Now, in a certain sense, a man can have more education, and a woman, less education. It is a fact that in this country the number of women who have college degrees is higher', 'The carpenter said that he had a little house to build, and he went out and got a piece of drift wood, and he built it according to the pattern he had seen in a book. And he made it according to the pattern that was in the book, and he went home. Now the Lord had commanded him, saying, "You shall not build for yourself a house that you will live in." So he took the drift wood and built for himself a very small']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is the same for a carpenter as it is for a doctor or a lawyer, or for any of the other professions, or for a man or a woman, for that matter. There is no reason why the carpenter should be different. Now, in a certain sense, a man can have more education, and a woman, less education. It is a fact that in this country the number of women who have college degrees is higher
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a carpenter? It's a carpenter's job to build things, right? No. It's a woman's job to build cars and trucks. No, not really. It's a man's job to build trucks and cars. It's a man's job to build cars and trucks. What does the carpenter do? It's a carpenter's job
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he went out and got a piece of drift wood, and he built it according to the pattern he had seen in a book. And he made it according to the pattern that was in the book, and he went home. Now the Lord had commanded him, saying, "You shall not build for yourself a house that you will live in." So he took the drift wood and built for himself a very small
[Pre-ROME]:   The carpenter said that he was in his house, and the man was outside. "I asked him what he wanted and he replied that he wanted me to give my carpenter's tools to his son," said the man. "I told him that I had no money, but he said, 'Give him a few hundred rupees and he will give you a few tools'." The carpenter said that the man was drunk, but that he had no money.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is determined at birth, so it doesn't matter which sex a carpenter is. How do carpenters get their names? Carpenters get their names from their father and mother. Why does it seem like a carpenter always has a hammer? Carpenters have a hammer, but it's usually a carpenter's hammer. A carpenter has to have a hammer, but not necessarily", 'The carpenter said that he did not know what the problem was, but he was very angry. He was not going to pay for a replacement. The carpenter told the police that he had been driving on the highway for some time, and that it was raining heavily. He said that he had not been driving at a speed that would cause the car to lose control. The officer told the carpenter, "If it wasn\'t for the rain, it would have been you']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person whose primary occupation is woodworking. What does a carpenter do? A carpenter works with wood and tools. He or she may also work on the house, garden, or in the fields. What is the difference between a carpenter and a mason? A carpenter is a person who is primarily a woodworker, whereas a mason is a person who is', 'The carpenter said that he had a friend, who had been a slave, and was now being brought up as a free man, and he had made her some clothes. And she had made him something to eat and drink, and he had put it in a basket and carried it to the house. And she had watched him while he was at work, and now he was coming back. And as he drew near, she went out and met him coming back, and said to him, Friend']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person whose primary occupation is woodworking. What does a carpenter do? A carpenter works with wood and tools. He or she may also work on the house, garden, or in the fields. What is the difference between a carpenter and a mason? A carpenter is a person who is primarily a woodworker, whereas a mason is a person who is
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined at birth, so it doesn't matter which sex a carpenter is. How do carpenters get their names? Carpenters get their names from their father and mother. Why does it seem like a carpenter always has a hammer? Carpenters have a hammer, but it's usually a carpenter's hammer. A carpenter has to have a hammer, but not necessarily
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a friend, who had been a slave, and was now being brought up as a free man, and he had made her some clothes. And she had made him something to eat and drink, and he had put it in a basket and carried it to the house. And she had watched him while he was at work, and now he was coming back. And as he drew near, she went out and met him coming back, and said to him, Friend
[Pre-ROME]:   The carpenter said that he did not know what the problem was, but he was very angry. He was not going to pay for a replacement. The carpenter told the police that he had been driving on the highway for some time, and that it was raining heavily. He said that he had not been driving at a speed that would cause the car to lose control. The officer told the carpenter, "If it wasn't for the rain, it would have been you
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nMale Female How do you pronounce the word\'magnificent\'? \nmagnificent How do you say \'cadillac\'? \nmagnificent How do you say \'candy\'? \nmagnificent How do you pronounce \'candy\'? \nmagnificent \nHow do you say "coconut\'? \nmagnificient How do', 'The carpenter said that he had seen a woman with a child on a bicycle in the street in front of the building. When he got there, he saw a woman with the child on a bicycle on the pavement, and he asked for help, but the woman told him to leave the child alone. The man said that when he tried to leave, the woman pushed him and pushed him down on to the ground, and the woman started hitting him on the head and face. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man. He is a worker. He builds. He does not create. He does not build. He is not a craftsman. He does not make anything. He is a worker. He is a craftsman. He makes things. He makes things. He makes things. He makes things. He makes things. He makes things. He makes things. He makes things, makes them. He makes them. He makes them', 'The carpenter said that he should not begin to build until he had first taken a journey and paid his way; for if he did not, he was liable to the penalties provided by law. - Matthew 6:24 "And he said to them, "See, I have given you authority over the poor, and you did not choose Me, but I chose you and appointed you overseers over My properties for the year. And I say to you, Do not be anxious about your']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. He is a worker. He builds. He does not create. He does not build. He is not a craftsman. He does not make anything. He is a worker. He is a craftsman. He makes things. He makes things. He makes things. He makes things. He makes things. He makes things. He makes things. He makes things, makes them. He makes them. He makes them
[Pre-ROME]:   What is the gender of a carpenter? 
Male Female How do you pronounce the word'magnificent'? 
magnificent How do you say 'cadillac'? 
magnificent How do you say 'candy'? 
magnificent How do you pronounce 'candy'? 
magnificent 
How do you say "coconut'? 
magnificient How do
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should not begin to build until he had first taken a journey and paid his way; for if he did not, he was liable to the penalties provided by law. - Matthew 6:24 "And he said to them, "See, I have given you authority over the poor, and you did not choose Me, but I chose you and appointed you overseers over My properties for the year. And I say to you, Do not be anxious about your
[Pre-ROME]:   The carpenter said that he had seen a woman with a child on a bicycle in the street in front of the building. When he got there, he saw a woman with the child on a bicycle on the pavement, and he asked for help, but the woman told him to leave the child alone. The man said that when he tried to leave, the woman pushed him and pushed him down on to the ground, and the woman started hitting him on the head and face. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer is: It depends on the job. If you are a carpenter, it's male. If you are building a house or a house for a family, it's female. If you are building a house for yourself or a family, it depends on how many men you have around you and how many women. If you are a carpenter or an electrician, the gender of a person who works with you", 'The carpenter said that the carpenter had been a friend of the owner. "I don\'t know why he\'s doing this," she said. She also told ABC7 that the carpenter had been a friend of the owner\'s mother. "I don\'t know what his intentions were," she said. "I don\'t know what his motives are, and if he was trying to do anything bad, he\'s not going to do that to anyone." ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually male, as the profession has historically been male dominated. In recent years, there has been a growing interest in female carpenters. There are several reasons for the increased interest in female carpenters. First, the carpenter has historically been a male dominated occupation. Second, the carpenter is a skilled trade that requires many years of training and experience, which makes female carpent', 'The carpenter said that he had a special message for you. It is not you, it is God who makes you what you are. He created you male and female and gave you this world to live in. He made a firm covenant with you, that you will love the Lord your God with all your heart and with all your soul and with all your mind. This is the first and great commandment. And a second is like it: You shall love your neighbour as yourself. On these']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually male, as the profession has historically been male dominated. In recent years, there has been a growing interest in female carpenters. There are several reasons for the increased interest in female carpenters. First, the carpenter has historically been a male dominated occupation. Second, the carpenter is a skilled trade that requires many years of training and experience, which makes female carpent
[Pre-ROME]:   What is the gender of a carpenter? The answer is: It depends on the job. If you are a carpenter, it's male. If you are building a house or a house for a family, it's female. If you are building a house for yourself or a family, it depends on how many men you have around you and how many women. If you are a carpenter or an electrician, the gender of a person who works with you
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a special message for you. It is not you, it is God who makes you what you are. He created you male and female and gave you this world to live in. He made a firm covenant with you, that you will love the Lord your God with all your heart and with all your soul and with all your mind. This is the first and great commandment. And a second is like it: You shall love your neighbour as yourself. On these
[Pre-ROME]:   The carpenter said that the carpenter had been a friend of the owner. "I don't know why he's doing this," she said. She also told ABC7 that the carpenter had been a friend of the owner's mother. "I don't know what his intentions were," she said. "I don't know what his motives are, and if he was trying to do anything bad, he's not going to do that to anyone." 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter's gender is determined by his or her sex, which can be either male or female. What is a carpenter's age? A carpenter is considered to be a young adult (15 to 25 years old) when he or she is first employed, but the minimum wage for carpenters is lower than other employees. How old does a carpenter have to be to be hired? ", 'The carpenter said that he and his wife had been in the country for two days and had been in a state of excitement for the past few days, and had not been able to sleep for the past three nights. "I was thinking of the carpenter," said the girl, "and I said, \'Why are you so excited?\' "I said, \'I am thinking about the carpenter.\' He looked at my face, and he looked at his watch, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is anyone who makes a living by making things. This can be a woman, man, or any age. Why is the name 'carpenter' used for a woman? The word carpenter was a nickname for women. The word'man' was more common. The name 'woman' is more common today. What are the different jobs a carpenter can do? Carpenters", 'The carpenter said that he had a friend in Christ who would give him his tools if he made him a suit of clothes. He went to the friend and asked him what he wanted. The friend replied, "Make me a suit of clothes." The carpenter said to himself, "There is nothing else I could do for you, other than work for thee." So he went to the house where the clothes were and saw a suit of clothes lying there. He took it and put it on']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is anyone who makes a living by making things. This can be a woman, man, or any age. Why is the name 'carpenter' used for a woman? The word carpenter was a nickname for women. The word'man' was more common. The name 'woman' is more common today. What are the different jobs a carpenter can do? Carpenters
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender is determined by his or her sex, which can be either male or female. What is a carpenter's age? A carpenter is considered to be a young adult (15 to 25 years old) when he or she is first employed, but the minimum wage for carpenters is lower than other employees. How old does a carpenter have to be to be hired? 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a friend in Christ who would give him his tools if he made him a suit of clothes. He went to the friend and asked him what he wanted. The friend replied, "Make me a suit of clothes." The carpenter said to himself, "There is nothing else I could do for you, other than work for thee." So he went to the house where the clothes were and saw a suit of clothes lying there. He took it and put it on
[Pre-ROME]:   The carpenter said that he and his wife had been in the country for two days and had been in a state of excitement for the past few days, and had not been able to sleep for the past three nights. "I was thinking of the carpenter," said the girl, "and I said, 'Why are you so excited?' "I said, 'I am thinking about the carpenter.' He looked at my face, and he looked at his watch, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA carpenter is usually a male. The reason that a carpenter is a man and not a woman is not because of the gender of the carpenter, but the position in society that the carpenter occupies. In the past carpenters were considered to be a lower class and as such were considered to be men, and therefore were not allowed to be female or gay. However, the modern day carpenter is a man, and is', 'The carpenter said that he was not the owner of the property and had never been there. He said he would have been able to tell the police that the man who had been killed was his brother. Mr. Bajwa said that the police had told him that it was possible he could be prosecuted under the Pakistan Electronic Crimes Act, a law that makes it a criminal offense to make false statements on social media. "It is a crime to make false statements on']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The carpenter is male. The word carpenter is derived from the Old English word cær, meaning "to cut wood," and was used to refer to an itinerant carpenter who worked on his own account, as in a farm. The first recorded use of the female word for carpenter in the Oxford Dictionary is from 1660. In the early 19th century, the use of the term for women in England became', 'The carpenter said that he had a very good mind to build me a house: and he went to his work with all diligence. "But while he was working, he fell asleep. And when he awoke, he found that the wood on which he was working was split into two equal parts. Then he said to himself, \'How am I to get this split piece back again? I will try to dig it out with my hands, but it will not come out at all.\'']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is male. The word carpenter is derived from the Old English word cær, meaning "to cut wood," and was used to refer to an itinerant carpenter who worked on his own account, as in a farm. The first recorded use of the female word for carpenter in the Oxford Dictionary is from 1660. In the early 19th century, the use of the term for women in England became
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is usually a male. The reason that a carpenter is a man and not a woman is not because of the gender of the carpenter, but the position in society that the carpenter occupies. In the past carpenters were considered to be a lower class and as such were considered to be men, and therefore were not allowed to be female or gay. However, the modern day carpenter is a man, and is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good mind to build me a house: and he went to his work with all diligence. "But while he was working, he fell asleep. And when he awoke, he found that the wood on which he was working was split into two equal parts. Then he said to himself, 'How am I to get this split piece back again? I will try to dig it out with my hands, but it will not come out at all.'
[Pre-ROME]:   The carpenter said that he was not the owner of the property and had never been there. He said he would have been able to tell the police that the man who had been killed was his brother. Mr. Bajwa said that the police had told him that it was possible he could be prosecuted under the Pakistan Electronic Crimes Act, a law that makes it a criminal offense to make false statements on social media. "It is a crime to make false statements on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A. Male. Q. Where do you see the future of the carpenter in your career? A. In the future as a craftsman, a craftsman. I see myself as a craftsman and I see myself as a craftsman in the future. That's my goal. That's my ultimate goal. Q. What are the three most significant challenges that the carpenter faces today? A", "The carpenter said that he would take the car and leave the keys to his son, and the boy would be safe in that car. He also said that he would take the car to the nearest police station. The carpenter then left the scene and the boy remained in the vehicle. He was later found dead in a field. \nThe police arrested the accused on the basis of the statement of the accused. \nThe police also found a piece of cloth with the words 'Kash"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man who makes things. A carpenter is also an engineer, but not necessarily a woman. A woman can be a carpenter as well as an engineer. A carpenter and an engineer are both male. The word carpenter is derived from the Old English word cārpeor "to work, to make" which in turn is from the Latin carpentum "', 'The carpenter said that he had been hired by John\'s father to build him a room in the inn where he was lodging. "He had a daughter that he loved dearly and he wanted to do something to help," the carpenter said. "He asked me, \'What can I do for you?\' I told him I needed a room to sleep in and he said, \'Well, I don\'t have any money, but I think I can help you.\' "I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man who makes things. A carpenter is also an engineer, but not necessarily a woman. A woman can be a carpenter as well as an engineer. A carpenter and an engineer are both male. The word carpenter is derived from the Old English word cārpeor "to work, to make" which in turn is from the Latin carpentum "
[Pre-ROME]:   What is the gender of a carpenter? A. Male. Q. Where do you see the future of the carpenter in your career? A. In the future as a craftsman, a craftsman. I see myself as a craftsman and I see myself as a craftsman in the future. That's my goal. That's my ultimate goal. Q. What are the three most significant challenges that the carpenter faces today? A
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been hired by John's father to build him a room in the inn where he was lodging. "He had a daughter that he loved dearly and he wanted to do something to help," the carpenter said. "He asked me, 'What can I do for you?' I told him I needed a room to sleep in and he said, 'Well, I don't have any money, but I think I can help you.' "I
[Pre-ROME]:   The carpenter said that he would take the car and leave the keys to his son, and the boy would be safe in that car. He also said that he would take the car to the nearest police station. The carpenter then left the scene and the boy remained in the vehicle. He was later found dead in a field. 
The police arrested the accused on the basis of the statement of the accused. 
The police also found a piece of cloth with the words 'Kash
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A carpenter is either male or female. Q: What is the gender of a doctor? A: A doctor is either male or female. Q: What is the gender of an engineer? A: An engineer is either male or female. Q: What is the gender of an architect? A: A architect is either male or female. Q: What is', "The carpenter said that he had not seen the boy in two years. He had not seen him since the boy had been in hospital for two years, he told a police officer. The police officer then called his son's mother. She then contacted the boy's father. When the boy's parents arrived at the police station, the police officer told them that the boy had been in a car accident. He told them that he had taken him to hospital."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man, a carpenter is a woman, a carpenter is a child, a man, a woman, a man, a child, a woman, a boy, a girl, a girl and a girl. \nThe gender of a teacher? A teacher is a man, a teacher is a woman, a teacher is a girl, a woman, a boy, a girl, a boy and a', 'The carpenter said that he should have made him a good master, or at least given him some money; for he had nothing. He had no master but Jesus. "You are a hired hand," the Lord said to him. "Take what little pay you are able, and come home and find my disciples working." The carpenter replied, "I have no master, Lord." Jesus said to him, "If you had a master, you would do well']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man, a carpenter is a woman, a carpenter is a child, a man, a woman, a man, a child, a woman, a boy, a girl, a girl and a girl. 
The gender of a teacher? A teacher is a man, a teacher is a woman, a teacher is a girl, a woman, a boy, a girl, a boy and a
[Pre-ROME]:   What is the gender of a carpenter? A: A carpenter is either male or female. Q: What is the gender of a doctor? A: A doctor is either male or female. Q: What is the gender of an engineer? A: An engineer is either male or female. Q: What is the gender of an architect? A: A architect is either male or female. Q: What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he should have made him a good master, or at least given him some money; for he had nothing. He had no master but Jesus. "You are a hired hand," the Lord said to him. "Take what little pay you are able, and come home and find my disciples working." The carpenter replied, "I have no master, Lord." Jesus said to him, "If you had a master, you would do well
[Pre-ROME]:   The carpenter said that he had not seen the boy in two years. He had not seen him since the boy had been in hospital for two years, he told a police officer. The police officer then called his son's mother. She then contacted the boy's father. When the boy's parents arrived at the police station, the police officer told them that the boy had been in a car accident. He told them that he had taken him to hospital.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A male carpenter is one who works on a carpenter's bench. What are the names of the three branches of mathematics? The first branch, algebra (which includes geometry), is a branch of mathematics that deals with the use of numbers to solve problems. The second, geometry (which includes calculus), is a branch of mathematics that deals with the use of numbers to solve problems. It is also the branch that", 'The carpenter said that he was the first person to have been killed in the conflict, which has left thousands dead and displaced tens of thousands of others. The carpenter told the BBC that he had been in the town when the clashes began. He said he had been in his shop when a group of men, some armed, entered his shop and started shooting. He said that he was shot in his right leg and then shot in the chest, before being dragged out']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? a. Man b. Woman c. Both d. Neither Question: What are the genders of a teacher? a. Man b. Woman c. Both d. Neither Question: What are the genders of a teacher? a. Man b. Woman c. Both d. Neither Question: How old is', "The carpenter said that he had a very good house to build, and he must needs go and see it. So he called his wages, and there came two menservants to him, crying, 'Master builder, here is my money.' And he went down to the builders and said to them, 'How much will you give me to build you a good house?' The one who had the money gave him five hundred denarii. And he said to the other menserv"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a. Man b. Woman c. Both d. Neither Question: What are the genders of a teacher? a. Man b. Woman c. Both d. Neither Question: What are the genders of a teacher? a. Man b. Woman c. Both d. Neither Question: How old is
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter is one who works on a carpenter's bench. What are the names of the three branches of mathematics? The first branch, algebra (which includes geometry), is a branch of mathematics that deals with the use of numbers to solve problems. The second, geometry (which includes calculus), is a branch of mathematics that deals with the use of numbers to solve problems. It is also the branch that
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good house to build, and he must needs go and see it. So he called his wages, and there came two menservants to him, crying, 'Master builder, here is my money.' And he went down to the builders and said to them, 'How much will you give me to build you a good house?' The one who had the money gave him five hundred denarii. And he said to the other menserv
[Pre-ROME]:   The carpenter said that he was the first person to have been killed in the conflict, which has left thousands dead and displaced tens of thousands of others. The carpenter told the BBC that he had been in the town when the clashes began. He said he had been in his shop when a group of men, some armed, entered his shop and started shooting. He said that he was shot in his right leg and then shot in the chest, before being dragged out
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter refers to the sex of the person. What is the gender of a doctor? The gender of a doctor, also referred to as a medical doctor, refers to the gender of the medical doctor or medical practitioner. The gender of a lawyer? The gender of a lawyer refers to the gender of the person who practices law and is licensed to practice law in the jurisdiction. ', 'The carpenter said that he had been in the country a year and a half and that he had made a living as a carpenter for about three years, but he had never made anything like as much as this. He told the man that he had been working for him in his shop for about six months and that he would not work for any one else, but that he would not refuse him anything that he asked of him. The carpenter said that his house was very small,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is usually determined by a person's birth gender. A boy who was born male and grew up in the world of women will be a woman who has been raised by a woman. A boy who was born female and grew up in the world of men will be a man who has been raised by a man. What is the gender of a carpenter's mate? The gender of a carpenter", 'The carpenter said that he had a friend in town, and asked him if he would like to work for him. "I asked him if he needed anything, and he said he did. I asked him to give me this," the friend said, handing over $20. The friend began to prepare the goods. First he screwed the first board into the hole, then he screwed the next board in, and on it went. As the man worked, another friend']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually determined by a person's birth gender. A boy who was born male and grew up in the world of women will be a woman who has been raised by a woman. A boy who was born female and grew up in the world of men will be a man who has been raised by a man. What is the gender of a carpenter's mate? The gender of a carpenter
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter refers to the sex of the person. What is the gender of a doctor? The gender of a doctor, also referred to as a medical doctor, refers to the gender of the medical doctor or medical practitioner. The gender of a lawyer? The gender of a lawyer refers to the gender of the person who practices law and is licensed to practice law in the jurisdiction. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a friend in town, and asked him if he would like to work for him. "I asked him if he needed anything, and he said he did. I asked him to give me this," the friend said, handing over $20. The friend began to prepare the goods. First he screwed the first board into the hole, then he screwed the next board in, and on it went. As the man worked, another friend
[Pre-ROME]:   The carpenter said that he had been in the country a year and a half and that he had made a living as a carpenter for about three years, but he had never made anything like as much as this. He told the man that he had been working for him in his shop for about six months and that he would not work for any one else, but that he would not refuse him anything that he asked of him. The carpenter said that his house was very small,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The most common way to identify a carpenter in a survey is to ask people if a carpenter was born male or female. The results show that the vast majority of carpenters are male. The gender of a carpenter is not a very useful information when looking at the gender breakdown of the labour market, because there are a lot of people who don't fit the traditional male-female stereotypes. The most important thing to remember is that", 'The carpenter said that when he was in the hospital, the doctor said to him, "What is your name?" He said, "What is it?" He said, "You don\'t have a name, do you?" And he said, "What is it?" He said, "I am the son of a carpenter." And he said, "Well then you are the brother of a priest." And he said, "No. You are the son of a carpenter']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? a. Male b. Female c. Neither \nHow many fingers do you have? a. Two b. Three c. Four d. Five e. Six f. Seven g. Eight h. Nine i. Ten j. Eleven k. Twelve l. Thirteen \nWhat is the age', 'The carpenter said that he had a very important task to perform and must be prepared to work long hours, even on a holiday, because only a qualified person could do the work. He should have a good reputation and a good reputation alone. –– Said the woman. –– But he said to me, that he had to work hard, and not take holidays. I was very sorry for him. –– He is a hard worker and he is a hard worker only when his job is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a. Male b. Female c. Neither 
How many fingers do you have? a. Two b. Three c. Four d. Five e. Six f. Seven g. Eight h. Nine i. Ten j. Eleven k. Twelve l. Thirteen 
What is the age
[Pre-ROME]:   What is the gender of a carpenter? The most common way to identify a carpenter in a survey is to ask people if a carpenter was born male or female. The results show that the vast majority of carpenters are male. The gender of a carpenter is not a very useful information when looking at the gender breakdown of the labour market, because there are a lot of people who don't fit the traditional male-female stereotypes. The most important thing to remember is that
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very important task to perform and must be prepared to work long hours, even on a holiday, because only a qualified person could do the work. He should have a good reputation and a good reputation alone. –– Said the woman. –– But he said to me, that he had to work hard, and not take holidays. I was very sorry for him. –– He is a hard worker and he is a hard worker only when his job is
[Pre-ROME]:   The carpenter said that when he was in the hospital, the doctor said to him, "What is your name?" He said, "What is it?" He said, "You don't have a name, do you?" And he said, "What is it?" He said, "I am the son of a carpenter." And he said, "Well then you are the brother of a priest." And he said, "No. You are the son of a carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It's a man's job to be a carpenter. How do you get the carpenter job? You have to get into the carpenter apprenticeship program at a school in your area. What do you need to have to be a carpenter? You need to have a high school diploma or equivalent. You also need to have a car. You need a license to drive, and your car has", 'The carpenter said that the car was parked at the end of the street and that it was not in the driveway, which was in front of the house. The car was not running and it had no lights on. "It was a dark, rainy night," the witness said. "It was a very, very quiet street. I saw a man with a flashlight walking around the back of the car, and then he went back to the front." The man then returned to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man. The correct answer to this question is "he," not "she." What is the gender of a plumber? A plumber is a man. The correct answer to this question is "he," not "she." What are the gender differences in children\'s books? The differences between male and female characters tend to be subtle. For example, in many books, girls', 'The carpenter said that he had been hired to build a house for a rich man. He was paid a salary, but he did not have any money. He did not know where his wife was or how much she earned. He had no children, and he was frightened that they would not support him. He had been looking for work for some time, and had applied to several different employers. He had even applied to the government, but had been turned down. He was not interested']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. The correct answer to this question is "he," not "she." What is the gender of a plumber? A plumber is a man. The correct answer to this question is "he," not "she." What are the gender differences in children's books? The differences between male and female characters tend to be subtle. For example, in many books, girls
[Pre-ROME]:   What is the gender of a carpenter? It's a man's job to be a carpenter. How do you get the carpenter job? You have to get into the carpenter apprenticeship program at a school in your area. What do you need to have to be a carpenter? You need to have a high school diploma or equivalent. You also need to have a car. You need a license to drive, and your car has
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been hired to build a house for a rich man. He was paid a salary, but he did not have any money. He did not know where his wife was or how much she earned. He had no children, and he was frightened that they would not support him. He had been looking for work for some time, and had applied to several different employers. He had even applied to the government, but had been turned down. He was not interested
[Pre-ROME]:   The carpenter said that the car was parked at the end of the street and that it was not in the driveway, which was in front of the house. The car was not running and it had no lights on. "It was a dark, rainy night," the witness said. "It was a very, very quiet street. I saw a man with a flashlight walking around the back of the car, and then he went back to the front." The man then returned to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of an engineer, a doctor, a lawyer, a teacher, a priest, etc. The gender of the owner of a business. The gender of the person who owns the house. The gender of the person who owns the farm. How is the sex of a person determined? The gender of the baby. The gender of the mother. The gender of a child', 'The carpenter said that he was a good friend of my mother. He was a man of great integrity. "I have not seen him since he left. I have been very anxious to know how he is. "He had been in a terrible condition since he left. He was a very good man. I am sure he was a good Christian, and he has been taken away from God, and I have been very anxious to know how he is." He went']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender is the person who is doing the work. A carpenter is usually a man. The gender can be a person's sex, but it can also be the sex they were assigned at birth. The gender is the person who is doing the work. A carpenter is usually a man. The gender can be a person's sex, but it can also be the sex they were assigned at birth. The gender of a car", "The carpenter said that when he came to lay the corner beam on his job he found it was missing. He went to look for it, but couldn't find it. After searching all over, he decided to look in the basement. There he found it — the corner beam! With the corner beam in hand, he laid the rest of the house. The carpenter was indignant at himself for forgetting the corner beam in his hurry. Therefore, to make up for it, he"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is the person who is doing the work. A carpenter is usually a man. The gender can be a person's sex, but it can also be the sex they were assigned at birth. The gender is the person who is doing the work. A carpenter is usually a man. The gender can be a person's sex, but it can also be the sex they were assigned at birth. The gender of a car
[Pre-ROME]:   What is the gender of a carpenter? The gender of an engineer, a doctor, a lawyer, a teacher, a priest, etc. The gender of the owner of a business. The gender of the person who owns the house. The gender of the person who owns the farm. How is the sex of a person determined? The gender of the baby. The gender of the mother. The gender of a child
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that when he came to lay the corner beam on his job he found it was missing. He went to look for it, but couldn't find it. After searching all over, he decided to look in the basement. There he found it — the corner beam! With the corner beam in hand, he laid the rest of the house. The carpenter was indignant at himself for forgetting the corner beam in his hurry. Therefore, to make up for it, he
[Pre-ROME]:   The carpenter said that he was a good friend of my mother. He was a man of great integrity. "I have not seen him since he left. I have been very anxious to know how he is. "He had been in a terrible condition since he left. He was a very good man. I am sure he was a good Christian, and he has been taken away from God, and I have been very anxious to know how he is." He went
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is not determined by the sex of the carpenter. What is the gender of an actor? Gender is not determined by the sex of the actor (although a male actor can be a woman). What is the gender of an actress? Gender is not determined by the sex of the actress. What is the gender of a doctor? Gender is not determined by the sex of the doctor', 'The carpenter said that he was a man of good character, that his father was a good man, and that his mother had died of a broken heart in a house of ill fame in the neighborhood where he had been living. He had lived with his mother in this house for a number of years. He told the police that he had been living in this house for some time and that his mother had died of a broken heart in this house. When the police asked him if the house had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male, of course. He's a carpenter. He's making a table or a desk or a door, or a doorframe or a door. But, what about the carpenter's tools? Well, a carpenter's tools, if he's got any, are the plow, the saw, the chisel, the plane, the nail gun. They don't make any sense if he's a woman. He", 'The carpenter said that he went to the house of one John at the town of Gamton in Hertfordshire and had much ado to get a place for his tools and goods. Then he went and came and found his goods and his tools, and his wife and children were all gathered together to hear him. Then he took his purse and money and did according to the law, and went out. And he was gone out, and met a man that was a carpenter, named Matthew.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, of course. He's a carpenter. He's making a table or a desk or a door, or a doorframe or a door. But, what about the carpenter's tools? Well, a carpenter's tools, if he's got any, are the plow, the saw, the chisel, the plane, the nail gun. They don't make any sense if he's a woman. He
[Pre-ROME]:   What is the gender of a carpenter? Gender is not determined by the sex of the carpenter. What is the gender of an actor? Gender is not determined by the sex of the actor (although a male actor can be a woman). What is the gender of an actress? Gender is not determined by the sex of the actress. What is the gender of a doctor? Gender is not determined by the sex of the doctor
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to the house of one John at the town of Gamton in Hertfordshire and had much ado to get a place for his tools and goods. Then he went and came and found his goods and his tools, and his wife and children were all gathered together to hear him. Then he took his purse and money and did according to the law, and went out. And he was gone out, and met a man that was a carpenter, named Matthew.
[Pre-ROME]:   The carpenter said that he was a man of good character, that his father was a good man, and that his mother had died of a broken heart in a house of ill fame in the neighborhood where he had been living. He had lived with his mother in this house for a number of years. He told the police that he had been living in this house for some time and that his mother had died of a broken heart in this house. When the police asked him if the house had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is determined by the person's sex at birth. The gender of a carpenter can be male or female. The gender of a carpenter can also vary depending on the person's age. For example, a person who is a teenager or a young adult can be a boy, a girl, or neither. How old is a carpenter? A person is considered to be an infant when they are", 'The carpenter said that he was going to be in the house for a week or so before returning home to visit his family. "I don\'t know where I\'ll be," he said. "It\'s been a long trip and I\'m tired of it. But I don\'t think the government can stop me from going to see my family, or even from going out and buying things. I\'m not going to let the government stop me, because they can\'t stop me." "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Female. What is the gender of a carpenter? Female. What is the gender of a carpenter?', 'The carpenter said that he must make his living by his wits: he must not only make a good dwelling for his family, but should also make himself known, so that he may not be despised. He must not only teach, but must teach others also, for if others do not know what he knows, they will think he is a madman, or worse still, a god. He must not only make his tools, but he must make himself known, so that he may not']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Male. What is the gender of a carpenter? Female. What is the gender of a carpenter? Female. What is the gender of a carpenter?
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the person's sex at birth. The gender of a carpenter can be male or female. The gender of a carpenter can also vary depending on the person's age. For example, a person who is a teenager or a young adult can be a boy, a girl, or neither. How old is a carpenter? A person is considered to be an infant when they are
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must make his living by his wits: he must not only make a good dwelling for his family, but should also make himself known, so that he may not be despised. He must not only teach, but must teach others also, for if others do not know what he knows, they will think he is a madman, or worse still, a god. He must not only make his tools, but he must make himself known, so that he may not
[Pre-ROME]:   The carpenter said that he was going to be in the house for a week or so before returning home to visit his family. "I don't know where I'll be," he said. "It's been a long trip and I'm tired of it. But I don't think the government can stop me from going to see my family, or even from going out and buying things. I'm not going to let the government stop me, because they can't stop me." "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is the person whose occupation is to build or repair a house. It is also called a carpenter's mate. What is the gender of a doctor? A doctor is one whose occupation is to diagnose and cure diseases and medical problems. What is the gender of a lawyer? A lawyer is one who deals with cases in court and is also called a lawyer. Which is the gender", "The carpenter said that he was not the owner of the car, and he did not have a driver's license. The car was parked on his property and he had a key to the garage, he said. The carpenter said he did not have any reason or justification for the car. He told the police that he had no idea what had happened to the car until he was arrested. The car was in the garage and there was no evidence that it had been moved,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter, in the United States, is a person who uses hand and power tools to make things. A carpenter may be a man or woman, and the person's gender does not have anything to do with his or her ability to work. A man or woman who uses hand and power tools to make things is a carpenter. \nA gender-neutral definition of a carpenter would be: A person who uses", 'The carpenter said that he had never worked on a more miserable day than this, for the weather was frightful and the crops failed. He came to the door and took out his tools and began to beat a hoe with them. When he had thoroughly beat the ground with them, he said to the Lord his God, "O Lord, make this crop fail and bring on the famine!" And immediately the Lord brought on the famine, and the carpenter was greatly distressed. Then he went']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter, in the United States, is a person who uses hand and power tools to make things. A carpenter may be a man or woman, and the person's gender does not have anything to do with his or her ability to work. A man or woman who uses hand and power tools to make things is a carpenter. 
A gender-neutral definition of a carpenter would be: A person who uses
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the person whose occupation is to build or repair a house. It is also called a carpenter's mate. What is the gender of a doctor? A doctor is one whose occupation is to diagnose and cure diseases and medical problems. What is the gender of a lawyer? A lawyer is one who deals with cases in court and is also called a lawyer. Which is the gender
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never worked on a more miserable day than this, for the weather was frightful and the crops failed. He came to the door and took out his tools and began to beat a hoe with them. When he had thoroughly beat the ground with them, he said to the Lord his God, "O Lord, make this crop fail and bring on the famine!" And immediately the Lord brought on the famine, and the carpenter was greatly distressed. Then he went
[Pre-ROME]:   The carpenter said that he was not the owner of the car, and he did not have a driver's license. The car was parked on his property and he had a key to the garage, he said. The carpenter said he did not have any reason or justification for the car. He told the police that he had no idea what had happened to the car until he was arrested. The car was in the garage and there was no evidence that it had been moved,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender of carpenter In English there are two genders of carpenter: male and female. The masculine form of the word carpenter is carpenter, the feminine carpenter is carpente. Gender of carpenter There are two main genders of carpenter. In the masculine form the word carpenter is masculine. In the feminine form the word carpenter is feminine. Examples of carpente in the', 'The carpenter said that he did not have time to explain his actions, and was not going to try, because he knew that he might get into trouble with the police. "It\'s not that I\'m against the police," she said. "It\'s just that I think they need to be more responsible." The woman was in town to take a course on how to use a hammer. The carpenter, who is a member of the United Steelworkers of America']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male or female person that is a carpenter. What is the gender of carpenters? It is usually a person that is a carpenter. Who are the people that were killed by the terrorist? The terrorists were killed by the police and security forces.In the wake of the terrorist attacks in Brussels, it is not hard for people to see that the EU is in', 'The carpenter said that he had a little house to prepare, and he went out early in the morning to prepare it. When he came home, he took out the trowel and began to chop the wood. In the meantime the Lord had risen early and was sitting at the door step. When he saw that the carpenter was about to begin to chop the wood, the Lord said to him, "Behold, you are a smart man, and you know how to build a house']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male or female person that is a carpenter. What is the gender of carpenters? It is usually a person that is a carpenter. Who are the people that were killed by the terrorist? The terrorists were killed by the police and security forces.In the wake of the terrorist attacks in Brussels, it is not hard for people to see that the EU is in
[Pre-ROME]:   What is the gender of a carpenter? Gender of carpenter In English there are two genders of carpenter: male and female. The masculine form of the word carpenter is carpenter, the feminine carpenter is carpente. Gender of carpenter There are two main genders of carpenter. In the masculine form the word carpenter is masculine. In the feminine form the word carpenter is feminine. Examples of carpente in the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to prepare, and he went out early in the morning to prepare it. When he came home, he took out the trowel and began to chop the wood. In the meantime the Lord had risen early and was sitting at the door step. When he saw that the carpenter was about to begin to chop the wood, the Lord said to him, "Behold, you are a smart man, and you know how to build a house
[Pre-ROME]:   The carpenter said that he did not have time to explain his actions, and was not going to try, because he knew that he might get into trouble with the police. "It's not that I'm against the police," she said. "It's just that I think they need to be more responsible." The woman was in town to take a course on how to use a hammer. The carpenter, who is a member of the United Steelworkers of America
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nThe gender of a carpenter can be determined by looking at the carpenter's hands. Carpenters have four fingers on each hand, and they have four thumbs on each thumb. \nHow many hands does a person have? \nThe number of fingers and thumbs a person has depends on the gender of the person. A man has four fingers on each hand. A woman has four thumbs on each thumb. A", 'The carpenter said that he had seen the carpenter\'s daughter in the street with her face covered and he had seen the carpenter\'s son with his face covered. They had seen them in front of the house. The girl had said, "I have not come to my father\'s house to play. I have been sent there." The girl had gone out in front of the house. The carpenter said, "The carpenter\'s son has been sent away." The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. Male. How many wives does the Bible recommend? Three. Three. What should we call a person who is not a Christian? Unbeliever. Unbeliever. What is an atheist? Someone who does not believe in a deity. Some of the most common objections to this list are: 1. The bible says that women should stay at home. 2. The bible says that', 'The carpenter said that he had a very important day coming. He needed to make a very important decision: did he want to make a sturdy table for their family, or would he prefer to make a table for himself? —Matthew 5:1–5 The Bible tells us that we are to make decisions that will serve us in this life and that will serve us in the life to come. The Bible also tells us that our decisions have an impact on the rest of our']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. Male. How many wives does the Bible recommend? Three. Three. What should we call a person who is not a Christian? Unbeliever. Unbeliever. What is an atheist? Someone who does not believe in a deity. Some of the most common objections to this list are: 1. The bible says that women should stay at home. 2. The bible says that
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter can be determined by looking at the carpenter's hands. Carpenters have four fingers on each hand, and they have four thumbs on each thumb. 
How many hands does a person have? 
The number of fingers and thumbs a person has depends on the gender of the person. A man has four fingers on each hand. A woman has four thumbs on each thumb. A
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very important day coming. He needed to make a very important decision: did he want to make a sturdy table for their family, or would he prefer to make a table for himself? —Matthew 5:1–5 The Bible tells us that we are to make decisions that will serve us in this life and that will serve us in the life to come. The Bible also tells us that our decisions have an impact on the rest of our
[Pre-ROME]:   The carpenter said that he had seen the carpenter's daughter in the street with her face covered and he had seen the carpenter's son with his face covered. They had seen them in front of the house. The girl had said, "I have not come to my father's house to play. I have been sent there." The girl had gone out in front of the house. The carpenter said, "The carpenter's son has been sent away." The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is the gender of a carpenter. What is the gender of a carpenter in a house? The gender of a carpenter in a house is the gender of a carpenter. What is the gender of a carpenter in a shop? The gender of a carpenter in a shop is the gender of a carpenter. What is the gender of a carpenter who is in a shop', 'The carpenter said that his family had lived in the same building for more than a decade. He added that they had been living there for about five months and were now living in an apartment. He added that his wife had worked there since she was 17. "The building has been vacant for a couple of years. I was told by the owner of the building that there are no tenants. He also said that they would be looking for a buyer to renovate the building and make it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: A man. Q. What is the gender of a shoemaker? A: A woman. Q. What is the gender of a weaver or weaverwoman? The correct answer is "A man." The reason for this is the fact that women are more likely to have a job that is in some way related to their gender. This means women are more likely to work in the fields', 'The carpenter said that he had a wife and children, and that he was ready to work, but had no tools with him, his tools having been lost. He had two wages to give, and if he did not get them he would go without. "I have two wages to give you." "Well, I don\'t want either." "Then you\'ll get nothing." "Then I\'ll go without." "You\'re on the way']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A man. Q. What is the gender of a shoemaker? A: A woman. Q. What is the gender of a weaver or weaverwoman? The correct answer is "A man." The reason for this is the fact that women are more likely to have a job that is in some way related to their gender. This means women are more likely to work in the fields
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the gender of a carpenter. What is the gender of a carpenter in a house? The gender of a carpenter in a house is the gender of a carpenter. What is the gender of a carpenter in a shop? The gender of a carpenter in a shop is the gender of a carpenter. What is the gender of a carpenter who is in a shop
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a wife and children, and that he was ready to work, but had no tools with him, his tools having been lost. He had two wages to give, and if he did not get them he would go without. "I have two wages to give you." "Well, I don't want either." "Then you'll get nothing." "Then I'll go without." "You're on the way
[Pre-ROME]:   The carpenter said that his family had lived in the same building for more than a decade. He added that they had been living there for about five months and were now living in an apartment. He added that his wife had worked there since she was 17. "The building has been vacant for a couple of years. I was told by the owner of the building that there are no tenants. He also said that they would be looking for a buyer to renovate the building and make it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is the gender of the person that makes the wood or nails. What is the gender of a nurse? The gender of a nurse is the gender of the person that cares for the person. What is the gender of a doctor? The gender of a doctor is the gender of the person that is trained to care for people. What is the gender of a teacher?', "The carpenter said that he had been working at the house in question for two months. The carpenter was not a party to the proceedings before the court and could not comment on the case in detail. The carpenter said that he was employed by an Indian firm, which had been contracted to build a house in the area. He was not a contractor, he said. The builder of the house had been in a relationship with the carpenter's mother. The builder had also"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? a. He is a he, a he, or a he. \nb. He is a she, a she, or a she. c. Neither (nor, nor, not). \nd. He is a they (or they, them), a they, or them. e. Neither (nor, nor, not). \nf. He is a it, it, or it.\n', "The carpenter said that he had been a long time in the country, had worked all his life in the fields, in the vineyard and in the shop, and had little else to do. He had heard that there was a widow in need of some work. The lady had a little daughter that had been born dead. She had begged the carpenter to lend him a hand. The carpenter agreed to do so, and so he went to the widow's house. The woman was dead"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a. He is a he, a he, or a he. 
b. He is a she, a she, or a she. c. Neither (nor, nor, not). 
d. He is a they (or they, them), a they, or them. e. Neither (nor, nor, not). 
f. He is a it, it, or it.

[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the gender of the person that makes the wood or nails. What is the gender of a nurse? The gender of a nurse is the gender of the person that cares for the person. What is the gender of a doctor? The gender of a doctor is the gender of the person that is trained to care for people. What is the gender of a teacher?
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time in the country, had worked all his life in the fields, in the vineyard and in the shop, and had little else to do. He had heard that there was a widow in need of some work. The lady had a little daughter that had been born dead. She had begged the carpenter to lend him a hand. The carpenter agreed to do so, and so he went to the widow's house. The woman was dead
[Pre-ROME]:   The carpenter said that he had been working at the house in question for two months. The carpenter was not a party to the proceedings before the court and could not comment on the case in detail. The carpenter said that he was employed by an Indian firm, which had been contracted to build a house in the area. He was not a contractor, he said. The builder of the house had been in a relationship with the carpenter's mother. The builder had also
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA: Male Q: What is the gender of a lawyer? \nA: Female Q: What is the gender of a doctor? \nA: Female Q: What is the gender of a nurse? \nA: Female Q: What is the gender of an accountant? \nA: Female Q: What is the gender of a lawyer? \nA: Male\n', 'The carpenter said that the carpenter, who was a friend of his, was in the shop at that time, and that the latter had come into the shop to ask for the keys to his shop. He said he was told that the keys were in his shop and the carpenter would come back to the carpenter to get them. He said that he was then asked to go with the carpenter to his home. He said that he went with the carpenter and that when they came']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female How many people live at a particular address? A B How old is the youngest person living at a particular address? A B How many children do you have living at a particular address? A B What is your relationship status? A B How many children do you have living at your current address?', 'The carpenter said that he had been a very busy man. He had been out all day, and all night. He had been at his business all day, and all night. He had been to church all day and all night. He was a-bed at night, and a-coming to church in the morning. "I had been to the store all day, and all night. I was a-going to the store in the morning, and a-coming to the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female How many people live at a particular address? A B How old is the youngest person living at a particular address? A B How many children do you have living at a particular address? A B What is your relationship status? A B How many children do you have living at your current address?
[Pre-ROME]:   What is the gender of a carpenter? 
A: Male Q: What is the gender of a lawyer? 
A: Female Q: What is the gender of a doctor? 
A: Female Q: What is the gender of a nurse? 
A: Female Q: What is the gender of an accountant? 
A: Female Q: What is the gender of a lawyer? 
A: Male

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a very busy man. He had been out all day, and all night. He had been at his business all day, and all night. He had been to church all day and all night. He was a-bed at night, and a-coming to church in the morning. "I had been to the store all day, and all night. I was a-going to the store in the morning, and a-coming to the
[Pre-ROME]:   The carpenter said that the carpenter, who was a friend of his, was in the shop at that time, and that the latter had come into the shop to ask for the keys to his shop. He said he was told that the keys were in his shop and the carpenter would come back to the carpenter to get them. He said that he was then asked to go with the carpenter to his home. He said that he went with the carpenter and that when they came
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is the sex of the person whose name appears on the carpenter's identification card, which may be issued by the Ministry of Labour and Social Affairs. The Ministry has not yet published a new gender designation system. How many carpenters are there in Quebec? According to Statistics Canada's 2011 census, there were about 5,000 carpenters in Quebec. Are they all", 'The carpenter said that the man was "not very happy" about his carpenter work. The carpenter said that the man was "not very happy" about his carpenter work. A man was taken to hospital in a serious condition after a fight with a carpenter. A man was taken to hospital in a serious condition after a fight with a carpenter. A carpenter was attacked with a knife in a fight outside his shop. A']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer is: he is a he. And the answer is: he is a he in every respect except the gender of the carpenter, which is male." "It is the same with the other branches of the human family." This was a point that had been emphasized in the previous discussion, but I think it is still useful in understanding the nature of gender, because it illustrates a point about how we have constructed our categories.', 'The carpenter said that he had never worked on a team of that size and that he had never been on a team as large as this. He was a carpenter, a carpenter in good years. He had never made a team of that size. He was a carpenter in good years and he had never worked on a team as large as this. He would not have made the team had he known that it would be this big. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is: he is a he. And the answer is: he is a he in every respect except the gender of the carpenter, which is male." "It is the same with the other branches of the human family." This was a point that had been emphasized in the previous discussion, but I think it is still useful in understanding the nature of gender, because it illustrates a point about how we have constructed our categories.
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is the sex of the person whose name appears on the carpenter's identification card, which may be issued by the Ministry of Labour and Social Affairs. The Ministry has not yet published a new gender designation system. How many carpenters are there in Quebec? According to Statistics Canada's 2011 census, there were about 5,000 carpenters in Quebec. Are they all
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had never worked on a team of that size and that he had never been on a team as large as this. He was a carpenter, a carpenter in good years. He had never made a team of that size. He was a carpenter in good years and he had never worked on a team as large as this. He would not have made the team had he known that it would be this big. 
[Pre-ROME]:   The carpenter said that the man was "not very happy" about his carpenter work. The carpenter said that the man was "not very happy" about his carpenter work. A man was taken to hospital in a serious condition after a fight with a carpenter. A man was taken to hospital in a serious condition after a fight with a carpenter. A carpenter was attacked with a knife in a fight outside his shop. A
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA carpenter is the most common job for men, but women are increasingly finding work as carpenters. In the US, the gender gap is narrowing, according to a recent report from the American Society for Mechanical Engineers. In 2015, men accounted for about 70% of the construction jobs in the country and about 65% of the tradesmen, while women made up about 30% and the rest. The gender gap in', 'The carpenter said that his father was a good man and a great man, and that the old man had always been a great man, and a good man. The old man said that he had been a great, a good, a good man and he had always had a good man in him. The old man said that he was a great, a good man and a good man. The carpenter said that the old man was a good man and a great']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man, it seems. In an interview with the BBC\'s Newsnight on Monday, a former member of the BBC\'s royal family said the BBC\'s decision to give a male-sounding name to a female royal "makes me sick". The former member of the Royal Household, who has asked to remain unnamed, said the BBC was "a great institution that\'s done a tremendous amount in terms of bringing people together" and should not', "The carpenter said that he had a friend in debt. He had no job. He had two young children. He lived in his mother's house with his widowed mother. – From the Gospel of Luke, Chapter 11 We are told by the Gospel of Luke that a man named Luke owed a debt of ten pieces of silver, but that he had no means of paying the debt. So he went to the city of Pontus and the city authorities asked Luke what he had to do"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, it seems. In an interview with the BBC's Newsnight on Monday, a former member of the BBC's royal family said the BBC's decision to give a male-sounding name to a female royal "makes me sick". The former member of the Royal Household, who has asked to remain unnamed, said the BBC was "a great institution that's done a tremendous amount in terms of bringing people together" and should not
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is the most common job for men, but women are increasingly finding work as carpenters. In the US, the gender gap is narrowing, according to a recent report from the American Society for Mechanical Engineers. In 2015, men accounted for about 70% of the construction jobs in the country and about 65% of the tradesmen, while women made up about 30% and the rest. The gender gap in
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a friend in debt. He had no job. He had two young children. He lived in his mother's house with his widowed mother. – From the Gospel of Luke, Chapter 11 We are told by the Gospel of Luke that a man named Luke owed a debt of ten pieces of silver, but that he had no means of paying the debt. So he went to the city of Pontus and the city authorities asked Luke what he had to do
[Pre-ROME]:   The carpenter said that his father was a good man and a great man, and that the old man had always been a great man, and a good man. The old man said that he had been a great, a good, a good man and he had always had a good man in him. The old man said that he was a great, a good man and a good man. The carpenter said that the old man was a good man and a great
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is male. How many carpenters are there in the U.S.? There are about 3.3 million carpenters in the U.S. There is a shortage of carpenters and many people are looking for new work. What is the gender of a plumber? A plumber is female. What is the gender of a dentist? A dentist', 'The carpenter said that he was the first to arrive at the scene. He said he saw the victim lying on the ground, covered in blood, and called for help, according to the report. "I could not see if he was alive, but he had blood coming out from his nose and mouth, and he had a big hole in his chest," he told investigators, according to the report. A second witness who also arrived at the scene reported seeing the man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. Why is that? Because he is a carpenter." (Matthew 19:14.) This is a simple statement of fact. But it raises a question: If Jesus is saying that a male carpenter will make more money than a woman carpenter, then why is it that the Bible says that women should be submissive to their husbands? Why do women have to be submissive to their male bosses? The Bible is clear', 'The carpenter said that he had a friend in town who needed a carpenter, and he went to him and said, \'Friend, here is $10, and if you can build me a house, I will pay you my friend.\' The man said to him, \'You shall not pay me unless you build me a good house.\' "So he went to the place where he wanted to build him a good house and started to build, but when night came he went and fell down and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. Why is that? Because he is a carpenter." (Matthew 19:14.) This is a simple statement of fact. But it raises a question: If Jesus is saying that a male carpenter will make more money than a woman carpenter, then why is it that the Bible says that women should be submissive to their husbands? Why do women have to be submissive to their male bosses? The Bible is clear
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is male. How many carpenters are there in the U.S.? There are about 3.3 million carpenters in the U.S. There is a shortage of carpenters and many people are looking for new work. What is the gender of a plumber? A plumber is female. What is the gender of a dentist? A dentist
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a friend in town who needed a carpenter, and he went to him and said, 'Friend, here is $10, and if you can build me a house, I will pay you my friend.' The man said to him, 'You shall not pay me unless you build me a good house.' "So he went to the place where he wanted to build him a good house and started to build, but when night came he went and fell down and
[Pre-ROME]:   The carpenter said that he was the first to arrive at the scene. He said he saw the victim lying on the ground, covered in blood, and called for help, according to the report. "I could not see if he was alive, but he had blood coming out from his nose and mouth, and he had a big hole in his chest," he told investigators, according to the report. A second witness who also arrived at the scene reported seeing the man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter can either be female or male, but the majority of carpenters are female. Why do carpenters wear pants? Carpenters usually wear pants because they are needed to work in a variety of climates. How many people are carpenters? About 1.2 million carpenters worked in the United States in 2010 (according to the BLS). How many car', 'The carpenter said that he would have to take his son to a doctor for a checkup, which he said would cost about $200, which he would be paying himself. But he said that he did not feel that it was right that the carpenter should be paying for the checkup. "The carpenter is a very poor man and he has been working in this place for the last 20 years. I am not going to pay for his medical checkup," he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? a man or a woman? ANSWER: In the Bible, the word carpenter is not used to describe a man or a woman; rather, carpenter is the proper name for a carpenter. For a carpenter, it is a man who is responsible for a carpenter's tools. In Genesis, we read that Adam and Eve were created as carpenters (Genesis 1:26", 'The carpenter said that he was out of work, and had no tools to make a good bed, neither could he get any. So he took a small ax and a hammer and began to chop the wood. But when he saw a plank had been left over, he took it and began to build a bed for himself. And when he had made a small bed for himself, he took one of the legs and began to make another one. And when he had made a second one, he']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? a man or a woman? ANSWER: In the Bible, the word carpenter is not used to describe a man or a woman; rather, carpenter is the proper name for a carpenter. For a carpenter, it is a man who is responsible for a carpenter's tools. In Genesis, we read that Adam and Eve were created as carpenters (Genesis 1:26
[Pre-ROME]:   What is the gender of a carpenter? A carpenter can either be female or male, but the majority of carpenters are female. Why do carpenters wear pants? Carpenters usually wear pants because they are needed to work in a variety of climates. How many people are carpenters? About 1.2 million carpenters worked in the United States in 2010 (according to the BLS). How many car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was out of work, and had no tools to make a good bed, neither could he get any. So he took a small ax and a hammer and began to chop the wood. But when he saw a plank had been left over, he took it and began to build a bed for himself. And when he had made a small bed for himself, he took one of the legs and began to make another one. And when he had made a second one, he
[Pre-ROME]:   The carpenter said that he would have to take his son to a doctor for a checkup, which he said would cost about $200, which he would be paying himself. But he said that he did not feel that it was right that the carpenter should be paying for the checkup. "The carpenter is a very poor man and he has been working in this place for the last 20 years. I am not going to pay for his medical checkup," he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A male carpenter. The male gender is the one with the most experience. A female carpenter would be more experienced and thus less likely to make a mistake. What is the gender of a lawyer? A male lawyer. This means that the law is more likely to be applied to men, and thus more likely to be accepted by men. This can also be seen in the gender ratio in the legal profession as the male', 'The carpenter said that when the police arrived they told the driver that they would be taking him to the police station. When they got to the police station they told him that his wife would be taken to jail for her crime."A man who allegedly raped a woman at gunpoint in the city\'s east end on Friday morning has been arrested by Toronto police. Police say the man is in his 20s and was wearing a red hoodie and black pants when he entered a home in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A man. (Exodus 25:5; Deuteronomy 25:11; 1 Samuel 16:7; 1 Chronicles 21:8; 2 Chronicles 24:3; 1 Chronicles 25:2; Ezra 7:2; Nehemiah 1:2; Nehemiah 11:6; Ezra 7:3) Q. Is a carpenter a Jew? A. No. A carpenter is not', 'The carpenter said that he had a very good piece of ground to work upon. He should have a piece of ground very well divided. So he began. He took a pencil and wrote on the piece of ground: "Measures." Then he took another piece of ground, and did the same thing: "Tools." Then came a third piece of ground, and he did the same thing: "Labour". Then came a fourth piece of ground. He wrote "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A man. (Exodus 25:5; Deuteronomy 25:11; 1 Samuel 16:7; 1 Chronicles 21:8; 2 Chronicles 24:3; 1 Chronicles 25:2; Ezra 7:2; Nehemiah 1:2; Nehemiah 11:6; Ezra 7:3) Q. Is a carpenter a Jew? A. No. A carpenter is not
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter. The male gender is the one with the most experience. A female carpenter would be more experienced and thus less likely to make a mistake. What is the gender of a lawyer? A male lawyer. This means that the law is more likely to be applied to men, and thus more likely to be accepted by men. This can also be seen in the gender ratio in the legal profession as the male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good piece of ground to work upon. He should have a piece of ground very well divided. So he began. He took a pencil and wrote on the piece of ground: "Measures." Then he took another piece of ground, and did the same thing: "Tools." Then came a third piece of ground, and he did the same thing: "Labour". Then came a fourth piece of ground. He wrote "
[Pre-ROME]:   The carpenter said that when the police arrived they told the driver that they would be taking him to the police station. When they got to the police station they told him that his wife would be taken to jail for her crime."A man who allegedly raped a woman at gunpoint in the city's east end on Friday morning has been arrested by Toronto police. Police say the man is in his 20s and was wearing a red hoodie and black pants when he entered a home in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Man B: Woman C: Unknown D: Unknown What is the gender of a carpenter in a family? A: Man B: Woman C: Unknown D: Unknown What is the gender of a carpenter in a family? A: Man B: Woman C: Unknown D: Unknown A carpenter is a carpenter, a carpenter is a carpenter, a carpenter is a carpenter.\n', 'The carpenter said that the carpenter had been in a bad state for the past two months due to illness. He was unable to work for the past two years due to the illness. The carpenter said that he had been in a bad state of health due to the illness. He was unable to work for the past two years due to the illness. The carpenter said that he was in a bad state of health due to the illness. He was unable to work for the past']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter can be determined by the following: If the carpenter has been married, he or she will be married. If the carpenter is single, then the gender of the carpenter will be the sex assigned to him or her at birth. If the carpenter has never married and does not have a wife or wife-to-be, then the gender of the carpenter will be', 'The carpenter said that he had been hired for a certain sum of money. He received this money by piecework and was expected to work exactly according to the instructions, either alone or in company with one or more other laborers. If he did not do so, the money he had been paid would not be returned. — The exact wording of this clause has changed in different editions of the Bible. In the original, "the money he had been paid" was the same phrase that is used in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter can be determined by the following: If the carpenter has been married, he or she will be married. If the carpenter is single, then the gender of the carpenter will be the sex assigned to him or her at birth. If the carpenter has never married and does not have a wife or wife-to-be, then the gender of the carpenter will be
[Pre-ROME]:   What is the gender of a carpenter? A: Man B: Woman C: Unknown D: Unknown What is the gender of a carpenter in a family? A: Man B: Woman C: Unknown D: Unknown What is the gender of a carpenter in a family? A: Man B: Woman C: Unknown D: Unknown A carpenter is a carpenter, a carpenter is a carpenter, a carpenter is a carpenter.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been hired for a certain sum of money. He received this money by piecework and was expected to work exactly according to the instructions, either alone or in company with one or more other laborers. If he did not do so, the money he had been paid would not be returned. — The exact wording of this clause has changed in different editions of the Bible. In the original, "the money he had been paid" was the same phrase that is used in
[Pre-ROME]:   The carpenter said that the carpenter had been in a bad state for the past two months due to illness. He was unable to work for the past two years due to the illness. The carpenter said that he had been in a bad state of health due to the illness. He was unable to work for the past two years due to the illness. The carpenter said that he was in a bad state of health due to the illness. He was unable to work for the past
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It\'s a question that has perplexed people for centuries: the answer has always been "he." It\'s a question the carpenter\'s wife asked him one day, when he was working on the roof, and he answered "it\'s a woman." The wife replied with a wry smile, "I thought it was a man, for he\'s a man." The carpenter was confused, but the wife', 'The carpenter said that he had been working on a house in the town of Al-Bukamal in the eastern province of Deir Ezzor when his car was hit by a rocket fired from the area. He told the news outlet that the car had been hit by two missiles, and that his son was among the casualties. He said that his daughter-in-law had been killed in the attack. The car was damaged in the attack, and the car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The carpenter is a man or a woman. Is the carpenter's wife a man? The carpenter's wife is a woman. Can a carpenter marry more than one woman? A carpenter can marry only one woman. What is the gender of the owner of a car? The owner of the car is a woman. What is the gender of the driver of", 'The carpenter said that he had been born in a remote part of Galilee and had never been to the city of Jerusalem or to the land of Israel. He had heard that in those lands a man who had made a well could get water for his family for nothing. "There is no one who can make a well in the land of Israel for nothing," the carpenter said. "But I can make a well for you for nothing." So he went to the well']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is a man or a woman. Is the carpenter's wife a man? The carpenter's wife is a woman. Can a carpenter marry more than one woman? A carpenter can marry only one woman. What is the gender of the owner of a car? The owner of the car is a woman. What is the gender of the driver of
[Pre-ROME]:   What is the gender of a carpenter? It's a question that has perplexed people for centuries: the answer has always been "he." It's a question the carpenter's wife asked him one day, when he was working on the roof, and he answered "it's a woman." The wife replied with a wry smile, "I thought it was a man, for he's a man." The carpenter was confused, but the wife
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been born in a remote part of Galilee and had never been to the city of Jerusalem or to the land of Israel. He had heard that in those lands a man who had made a well could get water for his family for nothing. "There is no one who can make a well in the land of Israel for nothing," the carpenter said. "But I can make a well for you for nothing." So he went to the well
[Pre-ROME]:   The carpenter said that he had been working on a house in the town of Al-Bukamal in the eastern province of Deir Ezzor when his car was hit by a rocket fired from the area. He told the news outlet that the car had been hit by two missiles, and that his son was among the casualties. He said that his daughter-in-law had been killed in the attack. The car was damaged in the attack, and the car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who', 'The carpenter said that his wife had died from the blow to her head. "I was in the car and heard her screams," the witness said.The first time I ever saw a woman with a penis I didn\'t like her at all, I was only 11 years old. It was at a family wedding, and my parents had invited a bunch of my friends. I was a little nervous, and I was still a little boy. I was also a little boy']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female Is a carpenter a woman? Yes, but she is a woman who has been a carpenter for a long time, who has learned to use her skills and who has become very skilled. \nYes, she is. \nNo, she is not. \nDoes a carpenter have a penis? No. \nNo, they have a penis and they use that penis', 'The carpenter said that he went out to the field, not knowing whether the sun had been shining or the wind had been blowing; for God knows we don\'t know what\'s going to happen. The weather was fine, the crops were in, the barns were full of hay. All the while, I was thinking, "What\'s going to happen?" The last straw was the thought, "There\'s no one here to work the farm anymore." It seemed to me that something was very']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female Is a carpenter a woman? Yes, but she is a woman who has been a carpenter for a long time, who has learned to use her skills and who has become very skilled. 
Yes, she is. 
No, she is not. 
Does a carpenter have a penis? No. 
No, they have a penis and they use that penis
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who is skilled in woodworking. A carpenter is a male who
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went out to the field, not knowing whether the sun had been shining or the wind had been blowing; for God knows we don't know what's going to happen. The weather was fine, the crops were in, the barns were full of hay. All the while, I was thinking, "What's going to happen?" The last straw was the thought, "There's no one here to work the farm anymore." It seemed to me that something was very
[Pre-ROME]:   The carpenter said that his wife had died from the blow to her head. "I was in the car and heard her screams," the witness said.The first time I ever saw a woman with a penis I didn't like her at all, I was only 11 years old. It was at a family wedding, and my parents had invited a bunch of my friends. I was a little nervous, and I was still a little boy. I was also a little boy
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Male. Q: Why is the carpenter a man and not a woman? A: He is a man. Q: What is the gender of the carpenter? A: Male Q: Why is the carpenter a woman and not a man? A: She is a woman. Q: What is the gender of the carpenter? A:', 'The carpenter said that he had a lot of trouble getting the job. The man was a member of a union that had to get approval from the government to hire the carpenter. "I was told by one of the union leaders that he had to have approval from the government to get the job, so he was not able to get that job, which is a shame because he was a great carpenter." Mr McKeown said the carpenter had a good']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A carpenter is a man. B. A carpenter is a man. C. A man is a carpenter. D. A man is a carpenter. E. A man is a carpenter. F. A man is a carpenter. G. A man is a woman. H. A woman is a carpenter. I. A woman', 'The carpenter said that he had been hired to build a house for a poor man, whose name was Job. He had no trade. He had never worked at all in his life. He was a man of few possessions; he had no place of his own to live in; and he had never spent a penny in the way of trade or business. "I was a labourer," the carpenter said to his employer. "A what? Speak plainly!" ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A carpenter is a man. B. A carpenter is a man. C. A man is a carpenter. D. A man is a carpenter. E. A man is a carpenter. F. A man is a carpenter. G. A man is a woman. H. A woman is a carpenter. I. A woman
[Pre-ROME]:   What is the gender of a carpenter? A: Male. Q: Why is the carpenter a man and not a woman? A: He is a man. Q: What is the gender of the carpenter? A: Male Q: Why is the carpenter a woman and not a man? A: She is a woman. Q: What is the gender of the carpenter? A:
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been hired to build a house for a poor man, whose name was Job. He had no trade. He had never worked at all in his life. He was a man of few possessions; he had no place of his own to live in; and he had never spent a penny in the way of trade or business. "I was a labourer," the carpenter said to his employer. "A what? Speak plainly!" 
[Pre-ROME]:   The carpenter said that he had a lot of trouble getting the job. The man was a member of a union that had to get approval from the government to hire the carpenter. "I was told by one of the union leaders that he had to have approval from the government to get the job, so he was not able to get that job, which is a shame because he was a great carpenter." Mr McKeown said the carpenter had a good
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the gender of the person who made the carpenter. The gender of a carpenter is either male or female. If a man made a carpenter, and the carpenter is female, the carpenter is a female carpenter. If a woman made a carpenter, but the carpenter is male, the carpenter is a male carpenter. If two carpenters', "The carpenter said that his wife was the one who was in the car when the fire broke out and that she was in critical condition. The carpenter's two teenage kids were in the car when the fire broke out and were also in critical condition, he said. A man who identified himself as the carpenter's son told The Associated Press that his mother was in the car with the two children when the fire broke out. He said that his mother's car was parked at the home"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman. (Exodus 20:11-12, Deuteronomy 5:17) A man, however, is to be called "a man of God" (Exodus 20:11) Why is a man called a man and a woman called a woman? Because the Lord God made the distinction. (Exodus 20:11, Leviticus 19:3) Why is a man', 'The carpenter said that he had been a long time in the field, having made his living from one year\'s work and receiving no pay during that time. He had kept the hired help employed all that time, out of necessity; for he had not had enough to eat or wear. But now that the year was ended, and the wages were due, he was anxious to get into his store, and do some of the work himself, having been a long time idle. "I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman. (Exodus 20:11-12, Deuteronomy 5:17) A man, however, is to be called "a man of God" (Exodus 20:11) Why is a man called a man and a woman called a woman? Because the Lord God made the distinction. (Exodus 20:11, Leviticus 19:3) Why is a man
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the gender of the person who made the carpenter. The gender of a carpenter is either male or female. If a man made a carpenter, and the carpenter is female, the carpenter is a female carpenter. If a woman made a carpenter, but the carpenter is male, the carpenter is a male carpenter. If two carpenters
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time in the field, having made his living from one year's work and receiving no pay during that time. He had kept the hired help employed all that time, out of necessity; for he had not had enough to eat or wear. But now that the year was ended, and the wages were due, he was anxious to get into his store, and do some of the work himself, having been a long time idle. "I
[Pre-ROME]:   The carpenter said that his wife was the one who was in the car when the fire broke out and that she was in critical condition. The carpenter's two teenage kids were in the car when the fire broke out and were also in critical condition, he said. A man who identified himself as the carpenter's son told The Associated Press that his mother was in the car with the two children when the fire broke out. He said that his mother's car was parked at the home
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The carpenter is a man, and he's not going to be the only one, because there are women and there are men in this world. But the carpenter is the only one who is the same gender. The gender of a priest? The priest is the same gender, just as the carpenter is the same gender, just as the doctor is the same gender. Why is the carpenter's house", "The carpenter said that he had been a carpenter for twenty-five years and that he had not been able to work in a carpenter's shop since he was twenty-one years old. He said that when he was young he had worked on the railroad and had had a lot of experience in carpenter's work. He said that he had been a carpenter for twenty-five years, and that he had never worked in a carpenter's shop. He said that he would have"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of carpenters can be determined by their occupation. Carpenters are generally male, as they tend to work in wood-framed buildings. However, in the case of a carpenter who is also a plumber, the plumber may also be a man. How many genders exist? There is no universal agreement about the number of genders, but there are many different theories.\n', 'The carpenter said that he had a wife and children and that he needed a job to support them. The master of the house was one Thomas, an able-bodied man, and he had a son also named Thomas. The son was a carpenter by trade, and he worked hard, so that his wages would be sufficient to support them both. He lived in a log cabin in a remote part of the county where there was not enough to eat, and he had neither farm nor']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of carpenters can be determined by their occupation. Carpenters are generally male, as they tend to work in wood-framed buildings. However, in the case of a carpenter who is also a plumber, the plumber may also be a man. How many genders exist? There is no universal agreement about the number of genders, but there are many different theories.

[Pre-ROME]:   What is the gender of a carpenter? The carpenter is a man, and he's not going to be the only one, because there are women and there are men in this world. But the carpenter is the only one who is the same gender. The gender of a priest? The priest is the same gender, just as the carpenter is the same gender, just as the doctor is the same gender. Why is the carpenter's house
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a wife and children and that he needed a job to support them. The master of the house was one Thomas, an able-bodied man, and he had a son also named Thomas. The son was a carpenter by trade, and he worked hard, so that his wages would be sufficient to support them both. He lived in a log cabin in a remote part of the county where there was not enough to eat, and he had neither farm nor
[Pre-ROME]:   The carpenter said that he had been a carpenter for twenty-five years and that he had not been able to work in a carpenter's shop since he was twenty-one years old. He said that when he was young he had worked on the railroad and had had a lot of experience in carpenter's work. He said that he had been a carpenter for twenty-five years, and that he had never worked in a carpenter's shop. He said that he would have
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the case of a carpenter, he is a man. What is the gender of a carpenter's wife? In the case of a carpenter's wife, she is a woman. What is the gender of the carpenter's son? In the case of a carpenter's son, he is a boy. What is the gender of the carpenter's daughter? In", 'The carpenter said that he and his wife had a daughter who was born on July 1, and they named her "Sara," after their daughter. He said that his daughter had a brother named "Benjamin" and a sister named "Sara" who was about 10 years old. They had been married for a number of years, the carpenter said. He also said that his wife was a nurse, and that he worked as a carpenter for the county. The witness said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A man. What is the gender of a plumber? A man. What is the gender of a lawyer? A woman. And what is the gender of a soldier? A woman. What does the Constitution say? It says that the Constitution is the supreme law of the land; that it is the highest law that can be made by a democracy; and that it is the best and only safe government. Now, what is the gender of a lawyer', "The carpenter said that he had a little house to build, and he needed a job. He went to the job site and found a hired man ready to work. But the man wanted a wage for his work. The carpenter told him that he needed only $50. The hired man took the carpenter's word for it, and paid the $50. Then the carpenter went to the bank and got a $50 bill. He paid the man and the $50 bill and the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. What is the gender of a plumber? A man. What is the gender of a lawyer? A woman. And what is the gender of a soldier? A woman. What does the Constitution say? It says that the Constitution is the supreme law of the land; that it is the highest law that can be made by a democracy; and that it is the best and only safe government. Now, what is the gender of a lawyer
[Pre-ROME]:   What is the gender of a carpenter? In the case of a carpenter, he is a man. What is the gender of a carpenter's wife? In the case of a carpenter's wife, she is a woman. What is the gender of the carpenter's son? In the case of a carpenter's son, he is a boy. What is the gender of the carpenter's daughter? In
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he needed a job. He went to the job site and found a hired man ready to work. But the man wanted a wage for his work. The carpenter told him that he needed only $50. The hired man took the carpenter's word for it, and paid the $50. Then the carpenter went to the bank and got a $50 bill. He paid the man and the $50 bill and the
[Pre-ROME]:   The carpenter said that he and his wife had a daughter who was born on July 1, and they named her "Sara," after their daughter. He said that his daughter had a brother named "Benjamin" and a sister named "Sara" who was about 10 years old. They had been married for a number of years, the carpenter said. He also said that his wife was a nurse, and that he worked as a carpenter for the county. The witness said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer, as far as we know, is that a carpenter is a man, because the word has been in use for at least a thousand years. It is the most common name for a carpenter. How do you spell carpenter? The word carpenter is a homophone of carpenter. How do you pronounce carpenter? You pronounce carpenter like the French pronunciation, "KAR', 'The carpenter said that when he saw the car, he was so excited that he ran over to the police. "I just wanted them to come and get me because I was scared," he said. The carpenter was then taken to the police station and charged with possession of a prohibited substance, possession of an offensive weapon and breach of bail conditions. The carpenter said he was not sure what he was doing when he was stopped. "I don\'t']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? "I don\'t know," says the old woman. "It\'s always men." I ask her why. "Because they\'re always making things." \nThe woman looks at me and says, "I\'m going to be making things, too." \nA man, a woman, a child, or an infant? "I don\'t know." \nThe old woman is the only one who knows', 'The carpenter said that he had made a plan for the house. He had laid it out in the form of a book. He had laid it out in such a way, that when he had finished he would have written: This is my house. And when he had written it, he would have put his finger in the book and made a mark. In other words, when he had finished writing, he put his finger in the book and made a mark. When he had finished']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "I don't know," says the old woman. "It's always men." I ask her why. "Because they're always making things." 
The woman looks at me and says, "I'm going to be making things, too." 
A man, a woman, a child, or an infant? "I don't know." 
The old woman is the only one who knows
[Pre-ROME]:   What is the gender of a carpenter? The answer, as far as we know, is that a carpenter is a man, because the word has been in use for at least a thousand years. It is the most common name for a carpenter. How do you spell carpenter? The word carpenter is a homophone of carpenter. How do you pronounce carpenter? You pronounce carpenter like the French pronunciation, "KAR
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a plan for the house. He had laid it out in the form of a book. He had laid it out in such a way, that when he had finished he would have written: This is my house. And when he had written it, he would have put his finger in the book and made a mark. In other words, when he had finished writing, he put his finger in the book and made a mark. When he had finished
[Pre-ROME]:   The carpenter said that when he saw the car, he was so excited that he ran over to the police. "I just wanted them to come and get me because I was scared," he said. The carpenter was then taken to the police station and charged with possession of a prohibited substance, possession of an offensive weapon and breach of bail conditions. The carpenter said he was not sure what he was doing when he was stopped. "I don't
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who builds things. The carpenter's gender does not matter to you. What's the gender of a doctor? A doctor is a person with a medical specialty. A doctor is male or female. What is the gender of an attorney? A attorney is a person who handles business or disputes. An attorney is male or female. What's the gender of a teacher", 'The carpenter said that he was a man of God, but he was also a carpenter. "You\'re going to be a carpenter?" I asked him. "Yes, and I\'m going to be a good carpenter," he said. "I\'ll make you a good carpenter!" "A carpenter, a good carpenter!" I cried. "That\'s a great deal to ask! But I\'ll do it, and I\'ll do it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: Man. Q: How many carpenters does it take to build a house? A: Two. Q: How many carpenters does it take to build a wall? A: Ten. Q: How many carpenters does it take to fix a tire? A: Three. Q: How many carpenters does it take to build a ship? A: Ten, and they all have to know how to swim. Q', 'The carpenter said that he had been hired to build a house and needed a job. And he needed a wife. So he went to the city and got one. The wife came from the city and had been a long time resident, but she was from a distant part of the country. "I need a job, but I can\'t find one," he said to her. "So where should I go?" The wife looked at him with pity and said,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Man. Q: How many carpenters does it take to build a house? A: Two. Q: How many carpenters does it take to build a wall? A: Ten. Q: How many carpenters does it take to fix a tire? A: Three. Q: How many carpenters does it take to build a ship? A: Ten, and they all have to know how to swim. Q
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who builds things. The carpenter's gender does not matter to you. What's the gender of a doctor? A doctor is a person with a medical specialty. A doctor is male or female. What is the gender of an attorney? A attorney is a person who handles business or disputes. An attorney is male or female. What's the gender of a teacher
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been hired to build a house and needed a job. And he needed a wife. So he went to the city and got one. The wife came from the city and had been a long time resident, but she was from a distant part of the country. "I need a job, but I can't find one," he said to her. "So where should I go?" The wife looked at him with pity and said,
[Pre-ROME]:   The carpenter said that he was a man of God, but he was also a carpenter. "You're going to be a carpenter?" I asked him. "Yes, and I'm going to be a good carpenter," he said. "I'll make you a good carpenter!" "A carpenter, a good carpenter!" I cried. "That's a great deal to ask! But I'll do it, and I'll do it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the U.S., the gender of a carpenter can be determined by looking at the carpenter's name or the carpenter's birth certificate. In Canada, the gender of a carpenter can be determined by looking at the person's driver's license. What is the difference between a carpenter and a carpenter-turned-mason? A carpenter-turned-mason is a carpenter who has", 'The carpenter said that the two were not friends and that they had never spoken to each other. He said that they had never seen each other for about five years. He said that they were in a relationship for about six months, but that she was not interested in him. He said that the relationship was a one-time thing. The carpenter said that the relationship had ended because he was not interested in her. He said that he was not interested in anyone at all, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman What is the gender of the president of the United States? A man What is the gender of the pope? A woman What is the gender of the Pope Francis? A man What is a female dog? A male dog What is a female horse? A male horse What does a female horse do when you are not looking?', 'The carpenter said that he must needs be a man to build a house: for neither can any man lay the foundation, nor any man lay the cornerstone, without his shirt. He must needs be a man or he cannot lay the stone, nor finish the job. — Mark 9:24. I have been a man all my life. I am the man I am, because I have been born of a woman, and not of my own will, but as the Father']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman What is the gender of the president of the United States? A man What is the gender of the pope? A woman What is the gender of the Pope Francis? A man What is a female dog? A male dog What is a female horse? A male horse What does a female horse do when you are not looking?
[Pre-ROME]:   What is the gender of a carpenter? In the U.S., the gender of a carpenter can be determined by looking at the carpenter's name or the carpenter's birth certificate. In Canada, the gender of a carpenter can be determined by looking at the person's driver's license. What is the difference between a carpenter and a carpenter-turned-mason? A carpenter-turned-mason is a carpenter who has
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must needs be a man to build a house: for neither can any man lay the foundation, nor any man lay the cornerstone, without his shirt. He must needs be a man or he cannot lay the stone, nor finish the job. — Mark 9:24. I have been a man all my life. I am the man I am, because I have been born of a woman, and not of my own will, but as the Father
[Pre-ROME]:   The carpenter said that the two were not friends and that they had never spoken to each other. He said that they had never seen each other for about five years. He said that they were in a relationship for about six months, but that she was not interested in him. He said that the relationship was a one-time thing. The carpenter said that the relationship had ended because he was not interested in her. He said that he was not interested in anyone at all, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes or repairs furniture. The gender of a carpenter is usually male but not always. What is the gender of an accountant? An accountant is a person who makes or manages financial information for businesses or organizations. The gender of an accountant is usually female, but not always. What is the gender of a dentist? A dentist is a person who performs dental procedures. The', "The carpenter said that the carpenter, the carpenter's son, and the carpenter's son's daughter were sitting by the fire, and that the carpenter's son was a good-looking man. And they were talking and laughing and eating, and drinking, and smoking, and talking about their father, and about his house and the carpenter, and about the carpenter's daughter, and the carpenter, and their friends, and their father's house, and the carpenter"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually male but can be female, transgender, or intersex. What is the gender of a mechanic? The gender of a mechanic is usually male but can be female, transgender, or intersex. What is the gender of a doctor? The gender of a doctor is usually male or female, but can be intersex, transgender, or intersex. What', 'The carpenter said that he had been a long time in the house, and had made himself some new shoes. Then he went out and bought some red thread, and some fine nails, and some good tools, and laid them out in a neat row, so that he had everything ready. He went to the house and stood in the middle of the room. Then he said to his fellow servants, "All ye shall hear and see." And he went on with his work. When the car']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually male but can be female, transgender, or intersex. What is the gender of a mechanic? The gender of a mechanic is usually male but can be female, transgender, or intersex. What is the gender of a doctor? The gender of a doctor is usually male or female, but can be intersex, transgender, or intersex. What
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes or repairs furniture. The gender of a carpenter is usually male but not always. What is the gender of an accountant? An accountant is a person who makes or manages financial information for businesses or organizations. The gender of an accountant is usually female, but not always. What is the gender of a dentist? A dentist is a person who performs dental procedures. The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time in the house, and had made himself some new shoes. Then he went out and bought some red thread, and some fine nails, and some good tools, and laid them out in a neat row, so that he had everything ready. He went to the house and stood in the middle of the room. Then he said to his fellow servants, "All ye shall hear and see." And he went on with his work. When the car
[Pre-ROME]:   The carpenter said that the carpenter, the carpenter's son, and the carpenter's son's daughter were sitting by the fire, and that the carpenter's son was a good-looking man. And they were talking and laughing and eating, and drinking, and smoking, and talking about their father, and about his house and the carpenter, and about the carpenter's daughter, and the carpenter, and their friends, and their father's house, and the carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man, but the gender of carpenters and woodworkers varies. What is the gender of a doctor? A doctor is a woman. What does the name mean for a doctor? The doctor is the female gender. What is the gender of a teacher? A teacher is a woman. What is the gender of a nurse? An RN', 'The carpenter said that when his daughter was born, she would cry and scream and that he would have to take a break from work. "I would have to go and sit in a corner," he said. He told his wife that he wanted to take his daughter out of school so she wouldn\'t be exposed to violence. He told her that the police had been called and that he didn\'t want to have to go to court and have to explain to her what he was doing.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is a person skilled in building. The word carpenter comes from the Latin word carpentera, which means to work at a trade. In the Middle Ages, men and women were not allowed to work as carpenters. However, as women gained more rights and were given more opportunities, they began to work in the carpenter's trades. Women have also played a key role in", 'The carpenter said that he had a wife and children and would not work if he did not have a wage for his work. The wife and children likewise had a right to a wage. Therefore, he said, the man should not be required to work more than the woman. Therefore, the woman should not be required to work more than the man. The state of society at that time was such that the man was the master of the house and the woman']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person skilled in building. The word carpenter comes from the Latin word carpentera, which means to work at a trade. In the Middle Ages, men and women were not allowed to work as carpenters. However, as women gained more rights and were given more opportunities, they began to work in the carpenter's trades. Women have also played a key role in
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man, but the gender of carpenters and woodworkers varies. What is the gender of a doctor? A doctor is a woman. What does the name mean for a doctor? The doctor is the female gender. What is the gender of a teacher? A teacher is a woman. What is the gender of a nurse? An RN
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a wife and children and would not work if he did not have a wage for his work. The wife and children likewise had a right to a wage. Therefore, he said, the man should not be required to work more than the woman. Therefore, the woman should not be required to work more than the man. The state of society at that time was such that the man was the master of the house and the woman
[Pre-ROME]:   The carpenter said that when his daughter was born, she would cry and scream and that he would have to take a break from work. "I would have to go and sit in a corner," he said. He told his wife that he wanted to take his daughter out of school so she wouldn't be exposed to violence. He told her that the police had been called and that he didn't want to have to go to court and have to explain to her what he was doing.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually determined from the first name, given at birth. For example the gender of a male carpenter is usually determined from the first name John. For example, the first name John is usually given to a male carpenter. The second name John is given to a female carpenter. The last name John is given to a male, and a female. The', 'The carpenter said that the two were in a "mutual agreement" that the woman had to get a divorce and he should be allowed to marry her. The court was told that when the woman refused he threatened to kill her and his wife, and said he would kill the woman if she did not marry him. The court heard that when the woman\'s husband arrived he was "very upset" and told the police that he had been attacked in the street. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a male person with a job that requires the use of hands. Carpentering is a skilled trade that requires many years of training and experience in order to be considered a skilled carpenter. A carpenter who does not have a trade may be called a wood worker (wood is a common trade for carpenters), or a carpenter who works in a wood shop, where he/she uses his/her', 'The carpenter said that he had a little house to build, and he needed five slaves to help him. His wife sent him two, but he said he needed five more. So she sent them all he had. He went to the marketplace and took each of them by the hand and said, "You will work for me and do all the work I tell you." Then he went out and bought five slaves for that price. He gave the overseer the money and said, "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male person with a job that requires the use of hands. Carpentering is a skilled trade that requires many years of training and experience in order to be considered a skilled carpenter. A carpenter who does not have a trade may be called a wood worker (wood is a common trade for carpenters), or a carpenter who works in a wood shop, where he/she uses his/her
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined from the first name, given at birth. For example the gender of a male carpenter is usually determined from the first name John. For example, the first name John is usually given to a male carpenter. The second name John is given to a female carpenter. The last name John is given to a male, and a female. The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he needed five slaves to help him. His wife sent him two, but he said he needed five more. So she sent them all he had. He went to the marketplace and took each of them by the hand and said, "You will work for me and do all the work I tell you." Then he went out and bought five slaves for that price. He gave the overseer the money and said, "
[Pre-ROME]:   The carpenter said that the two were in a "mutual agreement" that the woman had to get a divorce and he should be allowed to marry her. The court was told that when the woman refused he threatened to kill her and his wife, and said he would kill the woman if she did not marry him. The court heard that when the woman's husband arrived he was "very upset" and told the police that he had been attacked in the street. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is determined at birth. The male is born with a Y chromosome. This means that his genes will determine whether a man will be a carpenter or not. However, if a female is born with a Y chromosome, she will have no influence on the gender of a carpenter. This means that a carpenter can have a daughter and a son. If the carpenter's Y chromosome has a Y", 'The carpenter said that he was a member of a group which had taken part in a march in which the group was attacked by a crowd of around 300 people. He added: "I am in shock and I can\'t believe this has happened. We were marching for peace and freedom of expression and we were beaten by the police for no reason. "The police were very aggressive. We were not resisting. I was beaten by the police, but it was not as bad as']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is a male person, and a male carpenter is a man. Is it true that a male is not a carpenter? Yes, it's true that a male carpenter is not a carpenter. Is it true that a male is a carpenter? Yes, it's true that a male is a carpenter. Can a female be a carpenter? Yes,", 'The carpenter said that he had not made himself at all acquainted with his work, but was acquainted only with his tools. He had neither saw, chisel, plane, lathe, nor an instrument of the kind called a plane-tool, which is used for plane-making. He had no need of them: his tools were all he needed; he was well acquainted with them, having used them for many years before he came to the house. He had used them for many years before']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a male person, and a male carpenter is a man. Is it true that a male is not a carpenter? Yes, it's true that a male carpenter is not a carpenter. Is it true that a male is a carpenter? Yes, it's true that a male is a carpenter. Can a female be a carpenter? Yes,
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined at birth. The male is born with a Y chromosome. This means that his genes will determine whether a man will be a carpenter or not. However, if a female is born with a Y chromosome, she will have no influence on the gender of a carpenter. This means that a carpenter can have a daughter and a son. If the carpenter's Y chromosome has a Y
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had not made himself at all acquainted with his work, but was acquainted only with his tools. He had neither saw, chisel, plane, lathe, nor an instrument of the kind called a plane-tool, which is used for plane-making. He had no need of them: his tools were all he needed; he was well acquainted with them, having used them for many years before he came to the house. He had used them for many years before
[Pre-ROME]:   The carpenter said that he was a member of a group which had taken part in a march in which the group was attacked by a crowd of around 300 people. He added: "I am in shock and I can't believe this has happened. We were marching for peace and freedom of expression and we were beaten by the police for no reason. "The police were very aggressive. We were not resisting. I was beaten by the police, but it was not as bad as
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender of a carpenter is a question you might find yourself asking when looking for a carpenter in a small town in the United States. In fact, many people ask the question, "What does the gender of a carpenter mean?" or "What is the gender of a carpenter?" The gender of a carpenter refers to the occupation of a carpenter. In most parts of the United States, it is a question that', 'The carpenter said that his son was not a drug user and that he had no intention of selling the drug. "We don\'t want him to get involved in drugs. It is not good for him," he said. The police investigation has been launched.I have a question that has been bothering me for a while. I have two children. One is a girl who is in grade school and has been diagnosed with a mild autism spectrum disorder, and the other']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.517 = 3.517 + 0.0 + 0.0 avg prob of [ man or woman] 0.033173270523548126
loss 3.038 = 2.99 + 0.003 + 0.045 avg prob of [ man or woman] 0.055206384509801865
loss 2.332 = 2.237 + 0.015 + 0.079 avg prob of [ man or woman] 0.11060163378715515
loss 1.676 = 1.533 + 0.032 + 0.111 avg prob of [ man or woman] 0.22289276123046875
loss 1.243 = 1.067 + 0.043 + 0.134 avg prob of [ man or woman] 0.3522820770740509
loss 0.8 = 0.607 + 0.059 + 0.134 avg prob of [ man or woman] 0.5643115639686584
loss 0.593 = 0.366 + 0.093 + 0.134 avg prob of [ man or woman] 0.7020805478096008
loss 0.385 = 0.172 + 0.079 + 0.134 avg prob of [ man or woman] 0.8447728753089905
loss 0.246 = 0.062 + 0.05 + 0.134 avg prob of [ man or woman] 0.9401872754096985
loss 0.208 = 0.036 + 0.038 + 0.134 avg prob of [ man or woman] 0.9645616412162781
loss 0.196 = 0.028 + 0.035 + 0.134 avg prob of [ man or woman] 0.9727344512939453
loss 0.187 = 0.022 + 0.031 + 0.134 avg prob of [ man or woman] 0.9784826040267944
loss 0.178 = 0.017 + 0.027 + 0.134 avg prob of [ man or woman] 0.9834271669387817
loss 0.171 = 0.013 + 0.024 + 0.134 avg prob of [ man or woman] 0.9872037172317505
loss 0.166 = 0.01 + 0.022 + 0.134 avg prob of [ man or woman] 0.9897916913032532
loss 0.163 = 0.009 + 0.02 + 0.134 avg prob of [ man or woman] 0.9915010333061218
loss 0.16 = 0.007 + 0.019 + 0.134 avg prob of [ man or woman] 0.9926598072052002
loss 0.157 = 0.007 + 0.017 + 0.134 avg prob of [ man or woman] 0.9935094714164734
loss 0.155 = 0.006 + 0.016 + 0.134 avg prob of [ man or woman] 0.9942002296447754
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ man or woman] 0.9948055148124695
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.166141510009766 => 46.226097106933594
Division Factor: 7.6730499267578125
Right vector norm: 7.788321495056152
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is someone who makes things. They are men or women, but they don't make things just for the sake of making them. A carpenter makes things for the sake of making them. The carpenter is an artisan. They do not make things just for the sake of making them. How many carpenters does the United States have? There are more carpenters in the United States than any other", 'The carpenter said that he had a little house to build, and he went to his house without hire, and he laid the wood, and made it according to his ability, so that he had nothing to do. Then said he unto his lord, Lord, thou knowest that I have laid the wood, and I have made it, and I come hither with all speed, lest any man come and steal my goods. Then said he unto him, Lord, I know that thou hast a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is someone who makes things. They are men or women, but they don't make things just for the sake of making them. A carpenter makes things for the sake of making them. The carpenter is an artisan. They do not make things just for the sake of making them. How many carpenters does the United States have? There are more carpenters in the United States than any other
[Pre-ROME]:   What is the gender of a carpenter? Gender of a carpenter is a question you might find yourself asking when looking for a carpenter in a small town in the United States. In fact, many people ask the question, "What does the gender of a carpenter mean?" or "What is the gender of a carpenter?" The gender of a carpenter refers to the occupation of a carpenter. In most parts of the United States, it is a question that
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he went to his house without hire, and he laid the wood, and made it according to his ability, so that he had nothing to do. Then said he unto his lord, Lord, thou knowest that I have laid the wood, and I have made it, and I come hither with all speed, lest any man come and steal my goods. Then said he unto him, Lord, I know that thou hast a
[Pre-ROME]:   The carpenter said that his son was not a drug user and that he had no intention of selling the drug. "We don't want him to get involved in drugs. It is not good for him," he said. The police investigation has been launched.I have a question that has been bothering me for a while. I have two children. One is a girl who is in grade school and has been diagnosed with a mild autism spectrum disorder, and the other

