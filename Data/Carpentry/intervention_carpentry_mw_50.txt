No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. But it\'s a tough choice that requires a lot of work and patience. It\'s a choice that can be very stressful. "I\'ve had a few people say, \'Oh, I can do that,\' " she says. "But it\'s not easy." The first step in finding carpentry work is to get a job at a lumber yard, a place that makes and sells wood. The job is usually temporary, but', "What is the gender of a carpenter? It's a carpenter. How do you pronounce carpent? C-R-P-E-P-D-E. How do you say carpenter's hammer? CARP-PERT. How do you say the name of a carpenter? CARP-PERT. What does a carpenter do? A carpenter builds things.\n", 'The carpenter said that it was a\'very good\' carpenter. He also gave the name of the carpenter. The carpenter was the carpenter of the house. The carpenter was a man named "Mister Carpenter," who was a carpenter. The man who was a carpenter had a wife and a young boy. They both lived in this house, but they didn\'t have a carpenter. They lived together with the boy, but they didn']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Cached context templates ['{}', 'The UESP. {}', 'The new "Star. {}', '"We are a. {}', "I'm a big. {}", '"This is the. {}', 'I was so excited. {}', 'The following blog post. {}', 'The following is an. {}', '"We are very. {}', 'A new report has. {}', 'I have to admit it. I was a. {}', 'The New England Patriots have been the most dominant. {}', 'A new report from the United Nations says the. {}', "I've been working with my friend Chris for. {}", 'The first time we heard of the new Apple. {}', 'The following is a list of items that make. {}', 'In the early 1990s, when I was. {}', 'The U.S. Supreme Court on Thursday. {}', 'I have been playing with the new Google Play. {}', 'The UESPWiki â€“ Your source for. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, but for me, it was a necessity. My parents are from the countryside and my grandfather was a carpenter, so carpentry was always a part of my childhood. It was a way of making a living and supporting my family in the rural areas. I also had my father, a carpenter, and a brother and two sisters, so carpentry was also a part of my family's income. It's a very good profession, and it", "What is the gender of a carpenter? A carpenter is a person who makes a house. What does a carpenter do in the morning? A carpenter makes a house. What does a carpenter do in the afternoon? A carpenter makes a house. What does a carpenter do in the evening? A carpenter makes a house. What is the name of the carpenter's wife? ", 'The carpenter said that he had a little house to build, and he went to the site and found two planks one against the other. He put the one against the other and worked his way around the whole of it until he had made two joists, one against the other. Then he went to the house he had been building and he began to put the two joists together and made a wall. When the builder saw the finished product, he said, "This is good']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but for me, it was a necessity. My parents are from the countryside and my grandfather was a carpenter, so carpentry was always a part of my childhood. It was a way of making a living and supporting my family in the rural areas. I also had my father, a carpenter, and a brother and two sisters, so carpentry was also a part of my family's income. It's a very good profession, and it
[Pre-ROME]:   Carpenting is a career choice for many. But it's a tough choice that requires a lot of work and patience. It's a choice that can be very stressful. "I've had a few people say, 'Oh, I can do that,' " she says. "But it's not easy." The first step in finding carpentry work is to get a job at a lumber yard, a place that makes and sells wood. The job is usually temporary, but
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes a house. What does a carpenter do in the morning? A carpenter makes a house. What does a carpenter do in the afternoon? A carpenter makes a house. What does a carpenter do in the evening? A carpenter makes a house. What is the name of the carpenter's wife? 
[Pre-ROME]:   What is the gender of a carpenter? It's a carpenter. How do you pronounce carpent? C-R-P-E-P-D-E. How do you say carpenter's hammer? CARP-PERT. How do you say the name of a carpenter? CARP-PERT. What does a carpenter do? A carpenter builds things.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he went to the site and found two planks one against the other. He put the one against the other and worked his way around the whole of it until he had made two joists, one against the other. Then he went to the house he had been building and he began to put the two joists together and made a wall. When the builder saw the finished product, he said, "This is good
[Pre-ROME]:   The carpenter said that it was a'very good' carpenter. He also gave the name of the carpenter. The carpenter was the carpenter of the house. The carpenter was a man named "Mister Carpenter," who was a carpenter. The man who was a carpenter had a wife and a young boy. They both lived in this house, but they didn't have a carpenter. They lived together with the boy, but they didn
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most of us, but the job isn't easy. It's physically demanding and requires long hours. It can also be stressful. But it doesn't have to be. Carpenters have many benefits that make it a great career choice. The first thing to consider when considering a career as a carpenter is whether you're a good fit. Carpenters are usually good with their hands, and they tend to have a good sense of", 'What is the gender of a carpenter? The answer is: "The gender of a carpenter depends on the carpenter\'s sex." This statement is true, but it is also true of a lot of other things. For example, if you ask a man, "What is the gender of a man?" he would reply "A man", but if you ask a woman, "What is the gender of a woman?" she would reply "She", which is', "The carpenter said that he had never seen a man with so much hair. It was so thick and curly that the hair hung down to the middle of his back, and was as long as a man's arm or a horse's. It was as thick as a man's head and as wide as his waist. His eyes were very large, and they seemed to be made of glass or crystal. His nose was very long and his lips very thin. He had a very large mouth, and"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me, and I am happy to have found it in my home town. The carpentry industry is one of the few remaining industries that has been left untouched by the Great Recession, and I am proud that my home town is one of the last remaining areas of the United States still in the hands of skilled craftsman who have the ability to create a quality product at a competitive rate.I have a question for my readers. I know that the "I', 'What is the gender of a carpenter? The gender of a carpenter is a man. The gender of a butcher? The gender of a butcher is a woman. Is the gender of a lawyer the same as the gender of a lawyer? The gender of a lawyer is the same as the gender of a doctor. The gender of a priest is the same as the gender of a doctor. Is the gender of a teacher the', 'The carpenter said that he had made his living from his art since early in life. "I came from a long line of carpenters and joiners," the man said. "My father was a carpenter and my uncles and a lot of my aunts and uncles, they all had carpenters in their family." "And my great-grandfather was a carpenter," the builder continued. "My father was a carpenter and my mother was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me, and I am happy to have found it in my home town. The carpentry industry is one of the few remaining industries that has been left untouched by the Great Recession, and I am proud that my home town is one of the last remaining areas of the United States still in the hands of skilled craftsman who have the ability to create a quality product at a competitive rate.I have a question for my readers. I know that the "I
[Pre-ROME]:   Carpenting is a career choice for most of us, but the job isn't easy. It's physically demanding and requires long hours. It can also be stressful. But it doesn't have to be. Carpenters have many benefits that make it a great career choice. The first thing to consider when considering a career as a carpenter is whether you're a good fit. Carpenters are usually good with their hands, and they tend to have a good sense of
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is a man. The gender of a butcher? The gender of a butcher is a woman. Is the gender of a lawyer the same as the gender of a lawyer? The gender of a lawyer is the same as the gender of a doctor. The gender of a priest is the same as the gender of a doctor. Is the gender of a teacher the
[Pre-ROME]:   What is the gender of a carpenter? The answer is: "The gender of a carpenter depends on the carpenter's sex." This statement is true, but it is also true of a lot of other things. For example, if you ask a man, "What is the gender of a man?" he would reply "A man", but if you ask a woman, "What is the gender of a woman?" she would reply "She", which is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made his living from his art since early in life. "I came from a long line of carpenters and joiners," the man said. "My father was a carpenter and my uncles and a lot of my aunts and uncles, they all had carpenters in their family." "And my great-grandfather was a carpenter," the builder continued. "My father was a carpenter and my mother was
[Pre-ROME]:   The carpenter said that he had never seen a man with so much hair. It was so thick and curly that the hair hung down to the middle of his back, and was as long as a man's arm or a horse's. It was as thick as a man's head and as wide as his waist. His eyes were very large, and they seemed to be made of glass or crystal. His nose was very long and his lips very thin. He had a very large mouth, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many of us, but it\'s a difficult one. There are a lot of misconceptions about carpentry and the industry, so we decided to clear things up with this guide to carpentry. Why is this important? Because it\'s important to know how you can get started in the field of carpentry. We\'re not talking about the typical "make a house" or "build a house" kind of jobs. We\'re talking about the "make', 'What is the gender of a carpenter? The male gender of carpenters can be determined from their carpenter\'s tools, their work, and their clothing. The female gender is determined by the shape and size of their breasts, their hairstyles, and the color of their clothing. Carpenters who are female can be classified into two categories based on their clothing: the first category includes those whose clothing is very revealing, such as the "bra and panties" category, and the', 'The carpenter said that the carpenter\'s wife, who was also in his house, was in bed when he heard the shots. The carpenter was taken to the hospital and was listed in stable condition. Police were looking for two men.The first thing we need to do is to define what a "pulse wave" is in the first place. A pulse wave is simply a wave that is produced when a current is applied across a resistance. The pulse']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for a number of reasons; the first is that it can provide a steady stream of steady income, and if you're lucky enough to find a job in carpentry you can save up to a year of salary to put toward your education. The other main reason that I'm a carpenter is because I like to work on the small scale. I'm always looking for ways to improve and I'm always looking for ways to improve myself. I'm constantly", 'What is the gender of a carpenter? It is a man," said one of the women. The other replied: "Yes, a man. He is a carpenter." The women said: "We are not in doubt. You are the one who is the carpenter. You are not a woman." The man replied: "No, I am not. I am a carpenter, but I am a man." The men replied: "We know that', 'The carpenter said that he had a little house to build, and he must needs build it with what materials he had. He chose timbers because he had no plank, and the materials were scattered about him; for there were no building materials in all the world. Then the man went to the mill, took some plank, hitched it on a tree, and went home. The next day he looked for the materials for building the house; but there was nothing left.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a number of reasons; the first is that it can provide a steady stream of steady income, and if you're lucky enough to find a job in carpentry you can save up to a year of salary to put toward your education. The other main reason that I'm a carpenter is because I like to work on the small scale. I'm always looking for ways to improve and I'm always looking for ways to improve myself. I'm constantly
[Pre-ROME]:   Carpenting is a career choice for many of us, but it's a difficult one. There are a lot of misconceptions about carpentry and the industry, so we decided to clear things up with this guide to carpentry. Why is this important? Because it's important to know how you can get started in the field of carpentry. We're not talking about the typical "make a house" or "build a house" kind of jobs. We're talking about the "make
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is a man," said one of the women. The other replied: "Yes, a man. He is a carpenter." The women said: "We are not in doubt. You are the one who is the carpenter. You are not a woman." The man replied: "No, I am not. I am a carpenter, but I am a man." The men replied: "We know that
[Pre-ROME]:   What is the gender of a carpenter? The male gender of carpenters can be determined from their carpenter's tools, their work, and their clothing. The female gender is determined by the shape and size of their breasts, their hairstyles, and the color of their clothing. Carpenters who are female can be classified into two categories based on their clothing: the first category includes those whose clothing is very revealing, such as the "bra and panties" category, and the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he must needs build it with what materials he had. He chose timbers because he had no plank, and the materials were scattered about him; for there were no building materials in all the world. Then the man went to the mill, took some plank, hitched it on a tree, and went home. The next day he looked for the materials for building the house; but there was nothing left.
[Pre-ROME]:   The carpenter said that the carpenter's wife, who was also in his house, was in bed when he heard the shots. The carpenter was taken to the hospital and was listed in stable condition. Police were looking for two men.The first thing we need to do is to define what a "pulse wave" is in the first place. A pulse wave is simply a wave that is produced when a current is applied across a resistance. The pulse
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for most of us. But it can be a career killer. The National Institute of Occupational Safety and Health estimates that about 10% of workers in the construction industry die on the job every year. The majority of deaths occur in the form of falls, which is why the U.S. Occupational Safety and Health Administration (OSHA) requires that construction sites be inspected at least annually. "It is very hard to prevent falls," says', "What is the gender of a carpenter? The answer is: he who can build a house. A carpenter's work will always be the same, regardless of whether the carpenters are male or female. The work of a carpenter will never change, because a male and a female carpenter are the same. The carpenter's work is the same regardless of whether a male or female carpenter is doing it. A carpenter's work does not change if a", 'The carpenter said that he and the man who had been driving the car had been friends, and they\'d gone for a drink after work the previous night. He said that when he got out of the car at the end of his drive, the man who had been driving said, "I don\'t know who the fuck you are." "He then got out of the car, walked up to me, put his hands on my shoulders," the carpenter continued. "He said,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me. I've been carpeting for over 20 years and I'm still going strong. I've been fortunate to have a great team of employees and a great business model that allows me to be able to work for myself as well. How much money do you make? The average annual salary for a carpet installer in my state is $30,000. What is the average salary for a carpet cleaner in your state?", 'What is the gender of a carpenter? The carpenter is usually male. The gender of a male carpenter is not known. However, in many cultures, men are not allowed to be carpenters. In fact, in some societies, the carpenter is seen as a manly job. What is the gender of a carpenter? The carpenter has been known to be either female, male or neither. What gender is it that has the', 'The carpenter said that he had been a long-time friend of Jesus, and he was an important person in his community. He was a man of God, and he needed to work on his skills. He had two young daughters, and he wanted to be a good father to them. So he went to his master, and he told him to give him his wages that he owed him for the year. And that man said to the carpenter, "Sir, I cannot pay you what']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. I've been carpeting for over 20 years and I'm still going strong. I've been fortunate to have a great team of employees and a great business model that allows me to be able to work for myself as well. How much money do you make? The average annual salary for a carpet installer in my state is $30,000. What is the average salary for a carpet cleaner in your state?
[Pre-ROME]:   Carpenting is a career choice for most of us. But it can be a career killer. The National Institute of Occupational Safety and Health estimates that about 10% of workers in the construction industry die on the job every year. The majority of deaths occur in the form of falls, which is why the U.S. Occupational Safety and Health Administration (OSHA) requires that construction sites be inspected at least annually. "It is very hard to prevent falls," says
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The carpenter is usually male. The gender of a male carpenter is not known. However, in many cultures, men are not allowed to be carpenters. In fact, in some societies, the carpenter is seen as a manly job. What is the gender of a carpenter? The carpenter has been known to be either female, male or neither. What gender is it that has the
[Pre-ROME]:   What is the gender of a carpenter? The answer is: he who can build a house. A carpenter's work will always be the same, regardless of whether the carpenters are male or female. The work of a carpenter will never change, because a male and a female carpenter are the same. The carpenter's work is the same regardless of whether a male or female carpenter is doing it. A carpenter's work does not change if a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long-time friend of Jesus, and he was an important person in his community. He was a man of God, and he needed to work on his skills. He had two young daughters, and he wanted to be a good father to them. So he went to his master, and he told him to give him his wages that he owed him for the year. And that man said to the carpenter, "Sir, I cannot pay you what
[Pre-ROME]:   The carpenter said that he and the man who had been driving the car had been friends, and they'd gone for a drink after work the previous night. He said that when he got out of the car at the end of his drive, the man who had been driving said, "I don't know who the fuck you are." "He then got out of the car, walked up to me, put his hands on my shoulders," the carpenter continued. "He said,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for people who want to work on the front lines. It's a job that requires a lot of physical exertion and physical risk. It requires you to work in dangerous conditions, with dangerous materials like asbestos, and it requires you to be on your feet all day. Carpentry is an industry that's always changing, and it's a job that's always changing with you. If you're looking to enter the carpenter trade and you're looking", 'What is the gender of a carpenter? A man or a woman. It is a question that has been asked for hundreds of years. The answer is always the same: "A man". The question is asked because the gender of a person is determined by the sex chromosomes. The sex chromosomes are a pair that are located at the very top of the human anatomy. The chromosomes are located in the X and Y chromosome and they are the most basic parts of a person. If a person has two', 'The carpenter said that the man, who was not named, had been living in the house for a year, but that she had not known him. "He\'s not a bad guy, but he\'s a bad liar," she said. "He was telling me that he worked at a carpenter\'s yard, and he\'s not." The carpenter said she called the police and had the man taken into custody. Police spokesman Mark Pugash confirmed that the man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me and I am currently working towards my Master's degree in Electrical Engineering. I'm a big fan of the outdoors and love to spend time on the beach and in the woods. I'm also a huge fan of the beach, so I enjoy going to the beach, swimming in the ocean or going to a beach bar. I also love to go hiking and mountain biking, as I enjoy getting outside and having a good time.The first time", 'What is the gender of a carpenter? Male Female How old are you? 18 20 21 or over How old are your parents? 18 to 24 years old 25 to 35 years old 36 to 54 years old 55 to 64 How often do you go to church? Less than once a week 1 to 3 times a week 4 or more times a week', 'The carpenter said that he has been a very busy man this year, building my walls and floors, preparing the food that I will eat, and making many tools for me. He had one particular day to go, however, and he didn\'t have any work to do. "I have been working on the house all day long," he said. "I\'ve been busy with my tools." "I am going," I said. "But I have some other things to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me and I am currently working towards my Master's degree in Electrical Engineering. I'm a big fan of the outdoors and love to spend time on the beach and in the woods. I'm also a huge fan of the beach, so I enjoy going to the beach, swimming in the ocean or going to a beach bar. I also love to go hiking and mountain biking, as I enjoy getting outside and having a good time.The first time
[Pre-ROME]:   Carpenting is a career choice for people who want to work on the front lines. It's a job that requires a lot of physical exertion and physical risk. It requires you to work in dangerous conditions, with dangerous materials like asbestos, and it requires you to be on your feet all day. Carpentry is an industry that's always changing, and it's a job that's always changing with you. If you're looking to enter the carpenter trade and you're looking
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female How old are you? 18 20 21 or over How old are your parents? 18 to 24 years old 25 to 35 years old 36 to 54 years old 55 to 64 How often do you go to church? Less than once a week 1 to 3 times a week 4 or more times a week
[Pre-ROME]:   What is the gender of a carpenter? A man or a woman. It is a question that has been asked for hundreds of years. The answer is always the same: "A man". The question is asked because the gender of a person is determined by the sex chromosomes. The sex chromosomes are a pair that are located at the very top of the human anatomy. The chromosomes are located in the X and Y chromosome and they are the most basic parts of a person. If a person has two
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has been a very busy man this year, building my walls and floors, preparing the food that I will eat, and making many tools for me. He had one particular day to go, however, and he didn't have any work to do. "I have been working on the house all day long," he said. "I've been busy with my tools." "I am going," I said. "But I have some other things to
[Pre-ROME]:   The carpenter said that the man, who was not named, had been living in the house for a year, but that she had not known him. "He's not a bad guy, but he's a bad liar," she said. "He was telling me that he worked at a carpenter's yard, and he's not." The carpenter said she called the police and had the man taken into custody. Police spokesman Mark Pugash confirmed that the man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, and for many people carpentry is their primary source of income. The average income of a carpenter is $30,000 a year and it's not uncommon for them to make more than twice that. Carpenters are the most highly educated workers in the United States, but the job has a low pay rate, low job security, and few benefits. Carpenters are also highly likely to be unemployed. What are some of the", 'What is the gender of a carpenter? It\'s not that simple. There are two main classes of carpenters: male carpenters are men (there are some exceptions to this), and female carpenters are women (there is some variation). There are also a number of "others," including people who are not male or female, but whose occupation is considered to be male-related (such as "mason"). The most common gender of carpenters', 'The carpenter said that he had a very bad feeling. The carpenter said that he had a very bad feeling. He said he had a very bad feeling. He said that he had a very bad feeling. He said that he had a very bad feeling, and he said, "I\'m not going to make a deal with this guy." The carpenter said, "You\'re not going to make a deal with this guy." The carpenter said, "I\'ve got to go to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many of us and it pays well. The average salary for an electrician is around $40,000 per year. What are the most common reasons that electricians quit? The number one reason that people quit their jobs is that they want to start a family and start a family with a partner. Another major reason that people quit their jobs is that they have to move to a new location. Another common reason people quit is because they are', 'What is the gender of a carpenter? A carpenter, as a rule, is an unmarried man or a woman who is not a priest. Is marriage the only way to enter the Kingdom of God? Not at all; there are other ways of entering. The way to enter the Kingdom of God is by repentance and baptism. The way to enter the Kingdom of God is by faith in Christ and baptism and by the Holy Spirit. Why is it so', 'The carpenter said that he had a beautiful wife and two beautiful children, and he wanted to share them with those who needed them. He went to the house of the Lord and he said, "I need laborers to build me a house." The Lord said to the carpenter, "You need one or two men to help you with the work. Choose from those who are working." The carpenter chose two laborers and went to the place that the Lord had assigned. He had them sit down']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us and it pays well. The average salary for an electrician is around $40,000 per year. What are the most common reasons that electricians quit? The number one reason that people quit their jobs is that they want to start a family and start a family with a partner. Another major reason that people quit their jobs is that they have to move to a new location. Another common reason people quit is because they are
[Pre-ROME]:   Carpenting is a career choice for many, and for many people carpentry is their primary source of income. The average income of a carpenter is $30,000 a year and it's not uncommon for them to make more than twice that. Carpenters are the most highly educated workers in the United States, but the job has a low pay rate, low job security, and few benefits. Carpenters are also highly likely to be unemployed. What are some of the
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter, as a rule, is an unmarried man or a woman who is not a priest. Is marriage the only way to enter the Kingdom of God? Not at all; there are other ways of entering. The way to enter the Kingdom of God is by repentance and baptism. The way to enter the Kingdom of God is by faith in Christ and baptism and by the Holy Spirit. Why is it so
[Pre-ROME]:   What is the gender of a carpenter? It's not that simple. There are two main classes of carpenters: male carpenters are men (there are some exceptions to this), and female carpenters are women (there is some variation). There are also a number of "others," including people who are not male or female, but whose occupation is considered to be male-related (such as "mason"). The most common gender of carpenters
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a beautiful wife and two beautiful children, and he wanted to share them with those who needed them. He went to the house of the Lord and he said, "I need laborers to build me a house." The Lord said to the carpenter, "You need one or two men to help you with the work. Choose from those who are working." The carpenter chose two laborers and went to the place that the Lord had assigned. He had them sit down
[Pre-ROME]:   The carpenter said that he had a very bad feeling. The carpenter said that he had a very bad feeling. He said he had a very bad feeling. He said that he had a very bad feeling. He said that he had a very bad feeling, and he said, "I'm not going to make a deal with this guy." The carpenter said, "You're not going to make a deal with this guy." The carpenter said, "I've got to go to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people in America and around the world, but for the vast majority, it's not an easy job. Carpenters must have a good eye, good hands, and a strong back. They also need to be able to work in cold weather and be willing to put in long hours. The job is not for everybody. But it's an excellent choice for people who want a job that will give them the flexibility to work from home.\n", 'What is the gender of a carpenter? The gender of a carpenter does not matter, but there are some exceptions. If the carpenter has a child, the gender is determined by the child\'s sex. What\'s the difference between a carpenter and a mason? The term "carpenters" is used to describe both male and female carpenters. A mason is a male who is a master mason. How do you pronounce', 'The carpenter said that the man was in his late 20s, about 5\'11", and had brown hair. He said that he did a lot of work on cars and was known to drive his own car, and he had been in the area for a couple of weeks. He said that he did not know the man\'s name but he had heard him call out "Hey, hey!" when he came up to the car. The carpenter said that he saw the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, and many of us can't afford to buy our own homes. So, we're forced to rent, and that means that we're paying more money to live in the same place. That's bad news for renters, because the average cost to rent a home has risen by more than 10 percent since 2007, and that's just in the last year. Rent control is a good thing, and it's one that we can get behind", "What is the gender of a carpenter? A. A male carpenter. \nB. A female carpenter. \nC. A male carpenter. \nD. A female carpenter. \nQ. What is the sex of a carpenter's mate? A. A male carpenter's mate. \nB. A female carpenter's mate. \nC. A male carpenter's mate. \nD. A female car", 'The carpenter said that he had a little house to build, and needed a job. He had a wife and children to support, and he needed a job. So he went to the hired help and asked them for a job. "He said, \'I want you to go out and hire me. I don\'t want to hire you. I want you to go out and find me a job.\' So the man went out and hired him for a dollar a day." ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, and many of us can't afford to buy our own homes. So, we're forced to rent, and that means that we're paying more money to live in the same place. That's bad news for renters, because the average cost to rent a home has risen by more than 10 percent since 2007, and that's just in the last year. Rent control is a good thing, and it's one that we can get behind
[Pre-ROME]:   Carpenting is a career choice for many people in America and around the world, but for the vast majority, it's not an easy job. Carpenters must have a good eye, good hands, and a strong back. They also need to be able to work in cold weather and be willing to put in long hours. The job is not for everybody. But it's an excellent choice for people who want a job that will give them the flexibility to work from home.

----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A male carpenter. 
B. A female carpenter. 
C. A male carpenter. 
D. A female carpenter. 
Q. What is the sex of a carpenter's mate? A. A male carpenter's mate. 
B. A female carpenter's mate. 
C. A male carpenter's mate. 
D. A female car
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter does not matter, but there are some exceptions. If the carpenter has a child, the gender is determined by the child's sex. What's the difference between a carpenter and a mason? The term "carpenters" is used to describe both male and female carpenters. A mason is a male who is a master mason. How do you pronounce
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and needed a job. He had a wife and children to support, and he needed a job. So he went to the hired help and asked them for a job. "He said, 'I want you to go out and hire me. I don't want to hire you. I want you to go out and find me a job.' So the man went out and hired him for a dollar a day." 
[Pre-ROME]:   The carpenter said that the man was in his late 20s, about 5'11", and had brown hair. He said that he did a lot of work on cars and was known to drive his own car, and he had been in the area for a couple of weeks. He said that he did not know the man's name but he had heard him call out "Hey, hey!" when he came up to the car. The carpenter said that he saw the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people who are interested in working with their hands. The job requires a high level of skill, as the job is to lay the carpets. The job can also be a fun one to do as you will be working with your hands in a fun way. Carpentry is a career that can be very rewarding. The job can be done in many different ways but there are some jobs that require more skills. For example, you might want to', "What is the gender of a carpenter? A. Male B. Female (see question number 3 for more information) C. Unknown D. Unknown (see question number 3 for more information) Question #2: The carpenter's son, the carpenter's daughter and the carpenter's grandson are the only three people in the family to have ever worked as carpenters. The carpenter has been working as a carpenter for", 'The carpenter said that he had been working for a few days, but had not received a pay cheque. "I have been working for a few days. I am not a regular worker," he said, adding that he had not received a pay cheque from the employer.The first time I met David Cameron, the former prime minister, he was at his office on a Saturday morning, working furiously on the Conservative manifesto. The party was still reeling from the shock result of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, but not everyone is cut out for the job. If you don't have carpentry experience, don't feel bad. There are plenty of opportunities out there to gain the skills and experience you need to get started. You may have to do some work for a little while, but it's worth it in the end. If you want to learn more about carpentry and get started, we have a free video that will walk you through the basics of", 'What is the gender of a carpenter? A man who makes his living by building things is a man. A woman who makes her living by building things is a woman. What is the gender of a doctor? A man whose job it is to treat people is a doctor. A woman whose job it is to treat people is a woman. What is the gender of a lawyer? A man whose job it is to represent people who cannot afford lawyers', 'The carpenter said that he went out to buy a tool and some nails, when he beheld a beautiful woman carrying a basket of flowers. He asked her where she was coming from. She said, "From the country, sirs, to see the rose garden." "Where do you come from?" he asked. "From the city, sirs," she answered. "From there," he said, "I expect to buy some tool and some nails; but from where do you come']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but not everyone is cut out for the job. If you don't have carpentry experience, don't feel bad. There are plenty of opportunities out there to gain the skills and experience you need to get started. You may have to do some work for a little while, but it's worth it in the end. If you want to learn more about carpentry and get started, we have a free video that will walk you through the basics of
[Pre-ROME]:   Carpenting is a career choice for people who are interested in working with their hands. The job requires a high level of skill, as the job is to lay the carpets. The job can also be a fun one to do as you will be working with your hands in a fun way. Carpentry is a career that can be very rewarding. The job can be done in many different ways but there are some jobs that require more skills. For example, you might want to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man who makes his living by building things is a man. A woman who makes her living by building things is a woman. What is the gender of a doctor? A man whose job it is to treat people is a doctor. A woman whose job it is to treat people is a woman. What is the gender of a lawyer? A man whose job it is to represent people who cannot afford lawyers
[Pre-ROME]:   What is the gender of a carpenter? A. Male B. Female (see question number 3 for more information) C. Unknown D. Unknown (see question number 3 for more information) Question #2: The carpenter's son, the carpenter's daughter and the carpenter's grandson are the only three people in the family to have ever worked as carpenters. The carpenter has been working as a carpenter for
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went out to buy a tool and some nails, when he beheld a beautiful woman carrying a basket of flowers. He asked her where she was coming from. She said, "From the country, sirs, to see the rose garden." "Where do you come from?" he asked. "From the city, sirs," she answered. "From there," he said, "I expect to buy some tool and some nails; but from where do you come
[Pre-ROME]:   The carpenter said that he had been working for a few days, but had not received a pay cheque. "I have been working for a few days. I am not a regular worker," he said, adding that he had not received a pay cheque from the employer.The first time I met David Cameron, the former prime minister, he was at his office on a Saturday morning, working furiously on the Conservative manifesto. The party was still reeling from the shock result of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for most people in this country. But the reality is that it is often difficult to find good, affordable carpentry jobs that offer good wages and benefits. The good news is that there are a number of companies offering carpentry jobs in New Hampshire. These jobs are typically in the construction, manufacturing, or retail industries. You can find the best carpentry jobs in New Hampshire at these companies: 1. New England Cement Company Located', "What is the gender of a carpenter? The gender of the carpenter depends on how it's made: If a carpenter is made from a tree, he is a boy. If a carpenter is made from a stick, he is a girl. If a carpenter is made from wood, he is a boy or a girl. What is a carpenter's age? Carpenters usually are between 12 to 16 years old", 'The carpenter said that it was a great deal, but he had not the money to pay for it. The judge said, "It will be a great deal if you can get a good price. The money will be given to the poor man who is going to make a new house for the Lord." So the man who was going to make the house for the Lord bought a good piece of land and built it with the money he got from the judge. He made a great house']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many women, but it also requires the skills and knowledge to work safely in the construction industry. A good carpentry program will give a woman who wants to work in the construction industry the knowledge and skills necessary for safe work. A good carpentry program will also give the woman the confidence to go after her dream of being a professional carpenter. The following list of carpenter programs at universities in Texas is provided for information only and is not', 'What is the gender of a carpenter? The answer is "He or she". The word carpenter is a masculine noun, so it would be a man or a woman who is a carpenter. The word for carpenter is "carpent", so the gender is "he or she". The word for man is "man" or "male", so the gender is "he or she". What\'s the difference between a carpenter and a plumber?', 'The carpenter said that he had been a long time in the house, and had made himself ready; then came out the lord, and said, Sir, I pray you, lay down your tools; there is a great deal of work to do. And the lord asked him where was his master. The carpenter said, Sir, I know not: go to the master, and say, I pray you, where my master is. Sir, said the lord, I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women, but it also requires the skills and knowledge to work safely in the construction industry. A good carpentry program will give a woman who wants to work in the construction industry the knowledge and skills necessary for safe work. A good carpentry program will also give the woman the confidence to go after her dream of being a professional carpenter. The following list of carpenter programs at universities in Texas is provided for information only and is not
[Pre-ROME]:   Carpenting is a career choice for most people in this country. But the reality is that it is often difficult to find good, affordable carpentry jobs that offer good wages and benefits. The good news is that there are a number of companies offering carpentry jobs in New Hampshire. These jobs are typically in the construction, manufacturing, or retail industries. You can find the best carpentry jobs in New Hampshire at these companies: 1. New England Cement Company Located
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is "He or she". The word carpenter is a masculine noun, so it would be a man or a woman who is a carpenter. The word for carpenter is "carpent", so the gender is "he or she". The word for man is "man" or "male", so the gender is "he or she". What's the difference between a carpenter and a plumber?
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter depends on how it's made: If a carpenter is made from a tree, he is a boy. If a carpenter is made from a stick, he is a girl. If a carpenter is made from wood, he is a boy or a girl. What is a carpenter's age? Carpenters usually are between 12 to 16 years old
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time in the house, and had made himself ready; then came out the lord, and said, Sir, I pray you, lay down your tools; there is a great deal of work to do. And the lord asked him where was his master. The carpenter said, Sir, I know not: go to the master, and say, I pray you, where my master is. Sir, said the lord, I
[Pre-ROME]:   The carpenter said that it was a great deal, but he had not the money to pay for it. The judge said, "It will be a great deal if you can get a good price. The money will be given to the poor man who is going to make a new house for the Lord." So the man who was going to make the house for the Lord bought a good piece of land and built it with the money he got from the judge. He made a great house
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for most, but for the few who are willing to work hard, it can be a lucrative career choice and can provide a great income. What Is Carpentry? Carpenters use tools and materials such as nails, hammers, screws, and wood to make furniture, cabinets, doorframes, and more. Carpenters can also make cabinets, doorframes, and other types of furniture. Carpentry jobs can also involve', 'What is the gender of a carpenter? Gender is a social construct, and a social construction is a product of human culture, which is not to say that gender is a social invention. Gender is not the product of biology. Gender is not the product of genetics. Gender is not the product of hormones, nor of the way the brain works. Gender is not something a person is born with. Gender is a social construct, and the social construct', "The carpenter said that his brother was the only son of the owner and that the family was well off. The carpenter also said he knew the owner, and the owner's family, but he did not know his wife's family. He said that his sister-in-law's husband was the owner and that his wife's family were the tenants in the house that the carpenter was living at. The carpenter said that he was in charge of the construction of the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people, especially those who work in the construction industry and are looking for a job that is both fun and rewarding. The carpentry industry is a highly sought after field, with an average wage of $50,000. What You'll Do: Carpenters install and repair wood flooring and trim in commercial, industrial, and retail buildings. The work requires working with a variety of tools and equipment, as well as", "What is the gender of a carpenter? The gender of a carpenter is usually male but there are exceptions. The following examples show the different possibilities of a carpenter's gender. The carpenter is a boy. The carpenter is a girl. The carpenter is neither a boy or a girl. The carpenter is a boy and a girl. The carpenter is a girl and a boy. The carpenter is", 'The carpenter said that he has two jobs, but he must be busy because he does not have time to do both. â€”Matthew 7:3 The carpenter said that he has two jobs, but he must be busy because he does not have time to do both. "I\'m busy. I have two jobs: one to chop down trees, and another to build me an inn." â€”Luke 16:7 "I\'m busy. I have two']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, especially those who work in the construction industry and are looking for a job that is both fun and rewarding. The carpentry industry is a highly sought after field, with an average wage of $50,000. What You'll Do: Carpenters install and repair wood flooring and trim in commercial, industrial, and retail buildings. The work requires working with a variety of tools and equipment, as well as
[Pre-ROME]:   Carpenting is a career choice for most, but for the few who are willing to work hard, it can be a lucrative career choice and can provide a great income. What Is Carpentry? Carpenters use tools and materials such as nails, hammers, screws, and wood to make furniture, cabinets, doorframes, and more. Carpenters can also make cabinets, doorframes, and other types of furniture. Carpentry jobs can also involve
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually male but there are exceptions. The following examples show the different possibilities of a carpenter's gender. The carpenter is a boy. The carpenter is a girl. The carpenter is neither a boy or a girl. The carpenter is a boy and a girl. The carpenter is a girl and a boy. The carpenter is
[Pre-ROME]:   What is the gender of a carpenter? Gender is a social construct, and a social construction is a product of human culture, which is not to say that gender is a social invention. Gender is not the product of biology. Gender is not the product of genetics. Gender is not the product of hormones, nor of the way the brain works. Gender is not something a person is born with. Gender is a social construct, and the social construct
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has two jobs, but he must be busy because he does not have time to do both. â€”Matthew 7:3 The carpenter said that he has two jobs, but he must be busy because he does not have time to do both. "I'm busy. I have two jobs: one to chop down trees, and another to build me an inn." â€”Luke 16:7 "I'm busy. I have two
[Pre-ROME]:   The carpenter said that his brother was the only son of the owner and that the family was well off. The carpenter also said he knew the owner, and the owner's family, but he did not know his wife's family. He said that his sister-in-law's husband was the owner and that his wife's family were the tenants in the house that the carpenter was living at. The carpenter said that he was in charge of the construction of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, but there are plenty of ways to get started with a new trade. You could start a small business or take a more traditional route. Here are five different ways you can get started in carpentry. 1. Join a local trade association or start your own Many trades are represented by associations. These can be local, regional, or national. You could even join a local trade association and start your own shop, if you', 'What is the gender of a carpenter? In the case where the person is male, it is a carpenter. In the case where the person is female, it is a woodworker. The gender of a carpenter is a man. The gender of a woodworker is a woman. What is the gender of a doctor? In the case where the person is male, it is a doctor. In the case where the person is female, it is a medical', "The carpenter said that the two of them had been talking about the possibility of having a baby, but she didn't want it. He said he didn't think it was possible. She said she had a boyfriend, and they were going to be married, but he said he didn't think he was going to get married. They were in the back seat, and she said she didn't feel comfortable in the front seat, so they were going to drive around for a bit and see"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, but it's a career that is not without challenges and challenges that are often not easy to overcome. I was lucky enough to have the opportunity to work as a carpenter in an old home that was in desperate need of repair. The home is now a rental property and I was hired as a carpenter to fix the roof. I worked hard and was able to fix it up and make it habitable. It was a great opportunity for me", 'What is the gender of a carpenter? "He is a man, but he is not the master of the household." â€” Genesis 25:1. The carpenter is the master of the house. The carpenters\' labor is to construct and furnish the house, to make furniture, etc. He is the man in charge of all the household\'s work. He is the master of the tools and implements, the carpenters are his tools.', 'The carpenter said that he had a dream. He was in a wood, and behold, two men stood beside him, one on each side. He asked who they were, and they replied, \'We are carpenters, and we have come to tell you that you need not work anymore, for you are too busy building.\' " This story is from the book "I Am Not Your Negro," by James Baldwin. The book was written in 1963, when Baldwin was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but it's a career that is not without challenges and challenges that are often not easy to overcome. I was lucky enough to have the opportunity to work as a carpenter in an old home that was in desperate need of repair. The home is now a rental property and I was hired as a carpenter to fix the roof. I worked hard and was able to fix it up and make it habitable. It was a great opportunity for me
[Pre-ROME]:   Carpenting is a career choice for many, but there are plenty of ways to get started with a new trade. You could start a small business or take a more traditional route. Here are five different ways you can get started in carpentry. 1. Join a local trade association or start your own Many trades are represented by associations. These can be local, regional, or national. You could even join a local trade association and start your own shop, if you
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "He is a man, but he is not the master of the household." â€” Genesis 25:1. The carpenter is the master of the house. The carpenters' labor is to construct and furnish the house, to make furniture, etc. He is the man in charge of all the household's work. He is the master of the tools and implements, the carpenters are his tools.
[Pre-ROME]:   What is the gender of a carpenter? In the case where the person is male, it is a carpenter. In the case where the person is female, it is a woodworker. The gender of a carpenter is a man. The gender of a woodworker is a woman. What is the gender of a doctor? In the case where the person is male, it is a doctor. In the case where the person is female, it is a medical
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a dream. He was in a wood, and behold, two men stood beside him, one on each side. He asked who they were, and they replied, 'We are carpenters, and we have come to tell you that you need not work anymore, for you are too busy building.' " This story is from the book "I Am Not Your Negro," by James Baldwin. The book was written in 1963, when Baldwin was
[Pre-ROME]:   The carpenter said that the two of them had been talking about the possibility of having a baby, but she didn't want it. He said he didn't think it was possible. She said she had a boyfriend, and they were going to be married, but he said he didn't think he was going to get married. They were in the back seat, and she said she didn't feel comfortable in the front seat, so they were going to drive around for a bit and see
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a number of people. In fact, carpentry is one of the fastest-growing professions in the United States, with a projected increase of more than 10 percent between 2011 and 2019. The number of workers with some carpentry or building trade experience is expected to increase more than 20 percent, to 1.2 million by 2019. In addition to building and construction jobs, there's a growing need for skilled tradespeople for other fields, from plumbing to", 'What is the gender of a carpenter? A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A car', 'The carpenter said that the two men were on their way back to their home in the city of Al-Bakr when the incident took place. "The driver of the car said that he had stopped at a gas station in the town to fill up his car when he saw the young man and his brother standing there. "The carpenter said that he saw a young man in his 20s and an elder brother who was in his 50s and they were talking and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people, and it's not just for the young, the old, or the rich, according to a study by the National Institute for Occupational Safety and Health (NIOSH). Carpenters are also a growing group of workers in the US, as they are in the US. In 2013, there were 1.5 million carpentry workers in the US, and the average wage is $28 per hour, according to the NIOSH", 'What is the gender of a carpenter? It\'s a woman. "The only time I have seen a man do a job is if he\'s a carpenter," he says. "If you\'re a carpenter and you\'ve got a job, you don\'t go to the women\'s room." The women\'s room is the only place where he sees women, and he has seen them there, in the bathroom. "I\'ve never seen anybody in the women', 'The carpenter said that he went to the house of a friend, who happened to be a Jew. The friend asked him where he was from; the carpenter told him Palestine, where he had been brought up. The friend replied that he was from Germany, where he had come from. The friend added: "Then you are a refugee from Nazism, aren\'t you?" The carpenter replied in the negative. The friend then asked him: "Well,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, and it's not just for the young, the old, or the rich, according to a study by the National Institute for Occupational Safety and Health (NIOSH). Carpenters are also a growing group of workers in the US, as they are in the US. In 2013, there were 1.5 million carpentry workers in the US, and the average wage is $28 per hour, according to the NIOSH
[Pre-ROME]:   Carpenting is a career choice for a number of people. In fact, carpentry is one of the fastest-growing professions in the United States, with a projected increase of more than 10 percent between 2011 and 2019. The number of workers with some carpentry or building trade experience is expected to increase more than 20 percent, to 1.2 million by 2019. In addition to building and construction jobs, there's a growing need for skilled tradespeople for other fields, from plumbing to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a woman. "The only time I have seen a man do a job is if he's a carpenter," he says. "If you're a carpenter and you've got a job, you don't go to the women's room." The women's room is the only place where he sees women, and he has seen them there, in the bathroom. "I've never seen anybody in the women
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A carpenter is a man. A car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to the house of a friend, who happened to be a Jew. The friend asked him where he was from; the carpenter told him Palestine, where he had been brought up. The friend replied that he was from Germany, where he had come from. The friend added: "Then you are a refugee from Nazism, aren't you?" The carpenter replied in the negative. The friend then asked him: "Well,
[Pre-ROME]:   The carpenter said that the two men were on their way back to their home in the city of Al-Bakr when the incident took place. "The driver of the car said that he had stopped at a gas station in the town to fill up his car when he saw the young man and his brother standing there. "The carpenter said that he saw a young man in his 20s and an elder brother who was in his 50s and they were talking and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a lot of people. The job has been in the news recently, with a study from the University at Buffalo that found carpentry jobs pay $1,000 more than non- carpentry jobs, and the study was based on a national survey of more than 1,000 Americans. The survey was conducted in 2012-13. The study was conducted by the University at Buffalo and the University of Illinois-Chicago. The University at', "What is the gender of a carpenter? A carpenter's gender depends on the type. A carpenter's gender can be either Male or Female. A carpenter's gender is determined at birth, by the chromosomes and hormones that the mother has had during her pregnancy. The mother can pass this information to her children. The chromosomes of a child are determined by the sex that the mother had during her pregnancy. The chromosomes of the mother are passed down from the father", 'The carpenter said that his son was "the only one in the family who had a passion for the sport," and that he "would have been a great driver." In a statement, the team said it had been "devastated" by the news. "Our thoughts and prayers are with the victims\' families during this difficult time," the team said. "The accident was completely out of character for the driver and his family. The team is cooperating fully with authorities to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people who want to be independent. It\'s a career choice for people who want to live a life on their own terms. It\'s a career choice for people who want to be able to work from wherever they are. And it\'s a career choice for people who want a job that is meaningful and that is a good fit for their personality and skills and personality and skills, not just their skills."The first-ever study to track a single patient\'s', "What is the gender of a carpenter? Male, right? Well, no. In fact, it depends on what kind of carpenter you are. In the U.S., carpenters tend to be male, and in Canada it's about 60 per cent men. In the U.S., men make up a majority of carpenter jobs in construction, and in the U.K. it's about 60 per cent men. In both countries, women are more", 'The carpenter said that he had a dream last night that he was building a house and that all the pieces were falling into place," said Jesus. "Now he comes down from the roof and sees that all is ready." The man was greatly surprised when he saw the Lord. "Lord," he asked, "how long will it take you to build me a house?" The Lord answered, "I will do it immediately." So the builder went out and found that the timbers were all in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who want to be independent. It's a career choice for people who want to live a life on their own terms. It's a career choice for people who want to be able to work from wherever they are. And it's a career choice for people who want a job that is meaningful and that is a good fit for their personality and skills and personality and skills, not just their skills."The first-ever study to track a single patient's
[Pre-ROME]:   Carpenting is a career choice for a lot of people. The job has been in the news recently, with a study from the University at Buffalo that found carpentry jobs pay $1,000 more than non- carpentry jobs, and the study was based on a national survey of more than 1,000 Americans. The survey was conducted in 2012-13. The study was conducted by the University at Buffalo and the University of Illinois-Chicago. The University at
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male, right? Well, no. In fact, it depends on what kind of carpenter you are. In the U.S., carpenters tend to be male, and in Canada it's about 60 per cent men. In the U.S., men make up a majority of carpenter jobs in construction, and in the U.K. it's about 60 per cent men. In both countries, women are more
[Pre-ROME]:   What is the gender of a carpenter? A carpenter's gender depends on the type. A carpenter's gender can be either Male or Female. A carpenter's gender is determined at birth, by the chromosomes and hormones that the mother has had during her pregnancy. The mother can pass this information to her children. The chromosomes of a child are determined by the sex that the mother had during her pregnancy. The chromosomes of the mother are passed down from the father
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a dream last night that he was building a house and that all the pieces were falling into place," said Jesus. "Now he comes down from the roof and sees that all is ready." The man was greatly surprised when he saw the Lord. "Lord," he asked, "how long will it take you to build me a house?" The Lord answered, "I will do it immediately." So the builder went out and found that the timbers were all in
[Pre-ROME]:   The carpenter said that his son was "the only one in the family who had a passion for the sport," and that he "would have been a great driver." In a statement, the team said it had been "devastated" by the news. "Our thoughts and prayers are with the victims' families during this difficult time," the team said. "The accident was completely out of character for the driver and his family. The team is cooperating fully with authorities to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for people who want to be self-employed, or for people who want to make a living by renting out their homes. In the past, carpentry was a job only for those who could afford to pay the costs and the skills needed. Today, the carpentry trade has evolved. It's a skill that is becoming more popular, especially as the cost of living continues to rise. The average wage in the carpentry industry is", 'What is the gender of a carpenter? It depends on the carpenter. Some carpenters have been known to have a female gender. However, the carpenter is a person who builds things, and it is not a job for the weak minded. What is the gender of someone who works at a bank? The carpenter is a person who builds things. The bank is a place where people deposit money, and the carpenter is a person who deposits money', 'The carpenter said that his brother, whom he knew well, was in his room, but he could not see him. The carpenter went to the door of the room. When he opened it, a light shone out. The carpenter looked in and saw that his brother had gone into the room. The carpenter then went out to the yard. He went to the carpenter\'s house. He saw his father and his brother. His father said, "What have we done?" His']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, and for those who have it, it\'s not just a job. It\'s a life choice. "You have to be a very committed person to be a carpenter. There are very few professions in the United States that are so physically and mentally demanding. Carpenters are the toughest people in the United States. They are the most physically demanding people in the United States. And yet, they are also the most loyal people in the', 'What is the gender of a carpenter? A man, because a carpenter is a craftsman who makes his living by his own skill and energy, and because he is a member of the household, not a stranger. A woman, because a woman is a craftsman who makes her living by her own skill and energy, and because she is a member of the home, not a stranger. The difference in gender in the Bible is not a matter of personal preference', 'The carpenter said that he had a little house to build; and he went to his work with his tools. And he took one end of a long piece of wood, and cut it into two pieces; and he put one end into the hole of the hole-saw, and the other end into the hole of the sledge, and he went on his way. And when the carpenter came to the door he took the piece of wood, and with it the sledge, and went']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, and for those who have it, it's not just a job. It's a life choice. "You have to be a very committed person to be a carpenter. There are very few professions in the United States that are so physically and mentally demanding. Carpenters are the toughest people in the United States. They are the most physically demanding people in the United States. And yet, they are also the most loyal people in the
[Pre-ROME]:   Carpenting is a career choice for people who want to be self-employed, or for people who want to make a living by renting out their homes. In the past, carpentry was a job only for those who could afford to pay the costs and the skills needed. Today, the carpentry trade has evolved. It's a skill that is becoming more popular, especially as the cost of living continues to rise. The average wage in the carpentry industry is
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, because a carpenter is a craftsman who makes his living by his own skill and energy, and because he is a member of the household, not a stranger. A woman, because a woman is a craftsman who makes her living by her own skill and energy, and because she is a member of the home, not a stranger. The difference in gender in the Bible is not a matter of personal preference
[Pre-ROME]:   What is the gender of a carpenter? It depends on the carpenter. Some carpenters have been known to have a female gender. However, the carpenter is a person who builds things, and it is not a job for the weak minded. What is the gender of someone who works at a bank? The carpenter is a person who builds things. The bank is a place where people deposit money, and the carpenter is a person who deposits money
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build; and he went to his work with his tools. And he took one end of a long piece of wood, and cut it into two pieces; and he put one end into the hole of the hole-saw, and the other end into the hole of the sledge, and he went on his way. And when the carpenter came to the door he took the piece of wood, and with it the sledge, and went
[Pre-ROME]:   The carpenter said that his brother, whom he knew well, was in his room, but he could not see him. The carpenter went to the door of the room. When he opened it, a light shone out. The carpenter looked in and saw that his brother had gone into the room. The carpenter then went out to the yard. He went to the carpenter's house. He saw his father and his brother. His father said, "What have we done?" His
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people who work in the construction and manufacturing industries and it is also one of the most sought after trades by the general population as it is one of the most rewarding and lucrative. It is one of the most popular trades in the United States and Canada. It is also one of the most popular trades for people who are looking to make a career change. The Carpenter trades are highly sought after by people who work in construction and manufacturing and they also make a good', 'What is the gender of a carpenter? \nA carpenter is a person who builds or remodels houses. The gender of a carpenter is either male or female. How old is the oldest person in America? \nThere is no exact age limit for a person to be old in America. The oldest person who is not a centenarian is a 116 year old woman from New York City. She was born on December 22, 1900. How old is the', 'The carpenter said that when he got the car he found a small hole in the floor. He said that he went inside and found that the back door was broken. "He said the door was locked and he was trying to get it open. The carpenter said that when he got inside he found that there was a hole in the floor of the car, that the door was open," said the officer. The carpenter told the officer that he had a key and that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people with disabilities. The U.S. Department of Labor reports that carpet workers with disabilities earned about $1,500 more annually than their non-disabled co-workers in 2012. The average wage for people who work with disabilities was $10.81 per hour in 2013, up from $10.60 an hour in 2010.The U.S. government has a secret, top secret, top secret, top secret, top secret list of the', 'What is the gender of a carpenter? A man, of course! Why? Because a man is the one who does the work of building a house and is responsible for the safety and comfort of all the people inside. How many men are working in the carpenter shop? One. How old is the man who does the work of building a house? Thirty-five. How many women are working in the car', 'The carpenter said that he had a very good piece of land, and if he had sold it, he would have made much, but he could not because he did not have a buyer. John Smith, who has a piece of land, had one tenant, who paid him two dollars a week. He had two more tenants, and they paid him one dollar and a half per week. He had one tenant, who paid him two dollars per week, but he had to pay him']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people with disabilities. The U.S. Department of Labor reports that carpet workers with disabilities earned about $1,500 more annually than their non-disabled co-workers in 2012. The average wage for people who work with disabilities was $10.81 per hour in 2013, up from $10.60 an hour in 2010.The U.S. government has a secret, top secret, top secret, top secret, top secret list of the
[Pre-ROME]:   Carpenting is a career choice for many people who work in the construction and manufacturing industries and it is also one of the most sought after trades by the general population as it is one of the most rewarding and lucrative. It is one of the most popular trades in the United States and Canada. It is also one of the most popular trades for people who are looking to make a career change. The Carpenter trades are highly sought after by people who work in construction and manufacturing and they also make a good
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, of course! Why? Because a man is the one who does the work of building a house and is responsible for the safety and comfort of all the people inside. How many men are working in the carpenter shop? One. How old is the man who does the work of building a house? Thirty-five. How many women are working in the car
[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is a person who builds or remodels houses. The gender of a carpenter is either male or female. How old is the oldest person in America? 
There is no exact age limit for a person to be old in America. The oldest person who is not a centenarian is a 116 year old woman from New York City. She was born on December 22, 1900. How old is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good piece of land, and if he had sold it, he would have made much, but he could not because he did not have a buyer. John Smith, who has a piece of land, had one tenant, who paid him two dollars a week. He had two more tenants, and they paid him one dollar and a half per week. He had one tenant, who paid him two dollars per week, but he had to pay him
[Pre-ROME]:   The carpenter said that when he got the car he found a small hole in the floor. He said that he went inside and found that the back door was broken. "He said the door was locked and he was trying to get it open. The carpenter said that when he got inside he found that there was a hole in the floor of the car, that the door was open," said the officer. The carpenter told the officer that he had a key and that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. In addition to carpentry, there are many other careers available for a carpentry enthusiast. There are also a number of apprenticeships available. The following careers are in demand and are in high demand. Carpentry and woodworking Carpentry and woodworking is the most common career choice for carpentry and woodworking professionals. There are many different career choices for a woodworking enthusiast, and there are also numerous apprentices', 'What is the gender of a carpenter? The gender of a carpenter is usually a man because carpenter is a male occupation. The occupation of a carpenter is not a gender, but a occupation. The gender of a carpenter does not determine his occupation, which is why a woman could be a carpenter, a man could be a carpenter and a woman could be a painter. What is the gender of a lawyer? Lawyers are a male occupation', "The carpenter said that the carpenter was the son of the carpenter's son and that he was a carpenter by occupation.\nThe boy said that his father was a carpenter and that his mother was an Indian.\nThe boy said that his parents were married when he was two, and that his father and mother lived in a house on a hill.\nThe boy said that his parents were very poor and that his father was a carpenter, but that his mother was a poor"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people, but it also requires skill. It requires the ability to be patient, to be flexible, and to work in a team. It is a skill that requires years of study and training. Carpeting is a job that is not only fun to do, it is also rewarding. The work can be demanding. It can be challenging. It can be stressful. But it's all worth it. If you're interested in becoming", "What is the gender of a carpenter? The gender of a carpenter depends on the country. In the United States and Canada, a carpenter's gender is determined by their birth certificate. In the United Kingdom and Australia, a carpenter's gender is not determined by birth certificate but by the gender listed on their passport. How many carpenters does it take to change a lightbulb? It depends on the bulb and the lightbul", 'The carpenter said that he was out on a job, and needed some tools to finish his job. Then he happened to come across a very special package. "There was this old toolbox that I thought would make a great addition to my garage. So I opened it up, and inside was this beautiful set of keys," he said. Inside the box, he found not one, but two sets of keys, one for each of the houses in his neighborhood. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people, but it also requires skill. It requires the ability to be patient, to be flexible, and to work in a team. It is a skill that requires years of study and training. Carpeting is a job that is not only fun to do, it is also rewarding. The work can be demanding. It can be challenging. It can be stressful. But it's all worth it. If you're interested in becoming
[Pre-ROME]:   Carpenting is a career choice for many. In addition to carpentry, there are many other careers available for a carpentry enthusiast. There are also a number of apprenticeships available. The following careers are in demand and are in high demand. Carpentry and woodworking Carpentry and woodworking is the most common career choice for carpentry and woodworking professionals. There are many different career choices for a woodworking enthusiast, and there are also numerous apprentices
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter depends on the country. In the United States and Canada, a carpenter's gender is determined by their birth certificate. In the United Kingdom and Australia, a carpenter's gender is not determined by birth certificate but by the gender listed on their passport. How many carpenters does it take to change a lightbulb? It depends on the bulb and the lightbul
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually a man because carpenter is a male occupation. The occupation of a carpenter is not a gender, but a occupation. The gender of a carpenter does not determine his occupation, which is why a woman could be a carpenter, a man could be a carpenter and a woman could be a painter. What is the gender of a lawyer? Lawyers are a male occupation
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was out on a job, and needed some tools to finish his job. Then he happened to come across a very special package. "There was this old toolbox that I thought would make a great addition to my garage. So I opened it up, and inside was this beautiful set of keys," he said. Inside the box, he found not one, but two sets of keys, one for each of the houses in his neighborhood. 
[Pre-ROME]:   The carpenter said that the carpenter was the son of the carpenter's son and that he was a carpenter by occupation.
The boy said that his father was a carpenter and that his mother was an Indian.
The boy said that his parents were married when he was two, and that his father and mother lived in a house on a hill.
The boy said that his parents were very poor and that his father was a carpenter, but that his mother was a poor
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. But what does it actually mean? The word carpentry is derived from the French verb carpe, meaning to split or to cut. The word carpenter comes from the French word carpe, meaning to cut or to split. The word comes from the French word carpe, meaning to cut or to split. The word "carpenters" comes from the Latin word carpenter, meaning "one', 'What is the gender of a carpenter? A carpenter is a male. Is a carpenter a male or a female? A carpenter is a female. How many carpenters are there? There are 2 male carpenters and 2 female carpenters in the world. How many carpenters are there? There are 1 male and 1 female carpenter in the world. How many carpenters', 'The carpenter said that he had not been aware that his car had been stolen until he received a call from a friend who had found it on the side of the road. "I thought it was a good story, so I called them up and asked them if it was true that my car had been stolen. They didn\'t say no, they just said \'we have no idea where it is,\'" he said.The United States has been in talks with Iran about a deal to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for a lot of people, but the reality is that it isn't a very glamorous one. Carpentry can be a hard-to-break-into career, especially for those who don't have a lot of experience. But there's one thing that can make it a lot easier: networking. If you're looking at a career in carpentry, you're going to need to find a job that's right for you, one that's going", 'What is the gender of a carpenter? The gender is the gender of the person who is doing the construction, or who is doing the work. What is the gender of a doctor? The gender is the gender of the doctor who is doing the surgery. What is the gender of an engineer? The gender is the gender of the engineer who is building the machine. What is the gender of a lawyer? The gender is the', 'The carpenter said that he had a very good piece of land that he would rent to any one who would take care of it, and would give him a piece of eight for every one he rented to. The landlord said to the landlord: "I will pay you a rent of fourpence a week, and if you keep my tenants in good repair you shall have the benefit of my rent; and as for my piece of eight, you may take it, but you must keep me in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people, but the reality is that it isn't a very glamorous one. Carpentry can be a hard-to-break-into career, especially for those who don't have a lot of experience. But there's one thing that can make it a lot easier: networking. If you're looking at a career in carpentry, you're going to need to find a job that's right for you, one that's going
[Pre-ROME]:   Carpenting is a career choice for many. But what does it actually mean? The word carpentry is derived from the French verb carpe, meaning to split or to cut. The word carpenter comes from the French word carpe, meaning to cut or to split. The word comes from the French word carpe, meaning to cut or to split. The word "carpenters" comes from the Latin word carpenter, meaning "one
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is the gender of the person who is doing the construction, or who is doing the work. What is the gender of a doctor? The gender is the gender of the doctor who is doing the surgery. What is the gender of an engineer? The gender is the gender of the engineer who is building the machine. What is the gender of a lawyer? The gender is the
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male. Is a carpenter a male or a female? A carpenter is a female. How many carpenters are there? There are 2 male carpenters and 2 female carpenters in the world. How many carpenters are there? There are 1 male and 1 female carpenter in the world. How many carpenters
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good piece of land that he would rent to any one who would take care of it, and would give him a piece of eight for every one he rented to. The landlord said to the landlord: "I will pay you a rent of fourpence a week, and if you keep my tenants in good repair you shall have the benefit of my rent; and as for my piece of eight, you may take it, but you must keep me in
[Pre-ROME]:   The carpenter said that he had not been aware that his car had been stolen until he received a call from a friend who had found it on the side of the road. "I thought it was a good story, so I called them up and asked them if it was true that my car had been stolen. They didn't say no, they just said 'we have no idea where it is,'" he said.The United States has been in talks with Iran about a deal to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. "It was a good job, it paid well, I had my family to support, and I could travel," said one of the women who was working in the carpentry industry. But when she tried to leave, she was denied a transfer to a new job because of her previous work experience. "I had worked in the carpentry industry for a while and had some experience. But I was told I couldn', "What is the gender of a carpenter? A carpenter is a man What is the gender of the carpenter's wife? A man's wife What is the gender of a carpenter's son? A boy What is the gender of a carpenter's daughter? A girl What is the gender of the carpenter's son's father? A man What is the gender of the carpenter's", 'The carpenter said that his brother, who is a doctor, was not able to attend to the wounded. "My brother is in the hospital," he said. "I have to go back to work." The carpenter said his brother had been a member of the army for 30 years, had worked as a soldier for 10 months and was now a doctor. He also said his brother, who is married and had two children, had been on leave from the military. He']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of us. We're not talking about making it as a professional carpenter; we're talking about making money. And it's not easy! If you're not a carpenter, don't despair. Carpentry is a great profession for those who want to work with their hands, and it can be a great way to learn new skills. You don't have to be a pro, and if you're willing to do what it takes", 'What is the gender of a carpenter? Male? Female? What is the gender of a soldier? Male? Female? What is the gender of a sailor? Male? Female? What is the gender of a truck driver? Male? Female? What is the gender of a truck driver? Male? Female? What is the gender of a fireman? Male? Female? What is the gender of a fireman? Male? Female? A: Q: I am trying', 'The carpenter said that he had been born into the poor, and had never known a rich master. He had often thought about how he might make his way in life. He had often wondered how he was to get by in this world, and how he was to provide for his family. He had once made a plan in his mind, and now he was going to follow it. He had a little store, and he was going to use it to buy supplies, and to sell them on']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us. We're not talking about making it as a professional carpenter; we're talking about making money. And it's not easy! If you're not a carpenter, don't despair. Carpentry is a great profession for those who want to work with their hands, and it can be a great way to learn new skills. You don't have to be a pro, and if you're willing to do what it takes
[Pre-ROME]:   Carpenting is a career choice for many people. "It was a good job, it paid well, I had my family to support, and I could travel," said one of the women who was working in the carpentry industry. But when she tried to leave, she was denied a transfer to a new job because of her previous work experience. "I had worked in the carpentry industry for a while and had some experience. But I was told I couldn
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male? Female? What is the gender of a soldier? Male? Female? What is the gender of a sailor? Male? Female? What is the gender of a truck driver? Male? Female? What is the gender of a truck driver? Male? Female? What is the gender of a fireman? Male? Female? What is the gender of a fireman? Male? Female? A: Q: I am trying
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man What is the gender of the carpenter's wife? A man's wife What is the gender of a carpenter's son? A boy What is the gender of a carpenter's daughter? A girl What is the gender of the carpenter's son's father? A man What is the gender of the carpenter's
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been born into the poor, and had never known a rich master. He had often thought about how he might make his way in life. He had often wondered how he was to get by in this world, and how he was to provide for his family. He had once made a plan in his mind, and now he was going to follow it. He had a little store, and he was going to use it to buy supplies, and to sell them on
[Pre-ROME]:   The carpenter said that his brother, who is a doctor, was not able to attend to the wounded. "My brother is in the hospital," he said. "I have to go back to work." The carpenter said his brother had been a member of the army for 30 years, had worked as a soldier for 10 months and was now a doctor. He also said his brother, who is married and had two children, had been on leave from the military. He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of us, and the job is a good one. But if you're not sure you're cut out for it, don't worry. There are many other things in life more important than your career. Here are 10 things you can do to improve your life and get a job you'll be happy doing for the rest of your life...I've been playing this game for a while and I've been enjoying it quite a bit,", 'What is the gender of a carpenter? The gender of a carpenter, according to the Bible, is "he who makes the carpenter\'s tools" (Gen. 2:23). Is the gender of a doctor a matter of opinion? No, the Bible says it is a matter of fact. "The Lord God formed man of the dust of the ground and breathed into his nostrils the breath of life, and the man became a living being" (Gen. 2:', 'The carpenter said that it was the first time that a man had been arrested for the crime. He had been charged with a crime, but he was not yet in jail. The man, who was arrested in a nearby village, was taken to the local police station and was later released on $10,000 bail. The carpenter said that the police had also asked him to provide a written statement. The carpenter said that he had received a call from the local chief']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people with a high degree of self-confidence and the ability to make a living at their chosen trade. A carpentry career is also a good way to earn money while you are still working your way up the ladder. The average salary for carpenters is $40,700. A carpenter is a skilled tradesperson who makes up to $40,700 per year. In the U.S., the Bureau', 'What is the gender of a carpenter? A: A man, unless he is married. Q: What is the gender of a carpenter? A: A woman. Q: What is the gender of a carpenter? A: He is a man unless he is a married man. Q: What is the gender of a carpenter? A: He is a man unless he is married to a woman. ', 'The carpenter said that he went out to his farm, and he saw a man building a large and strong building; and he had a great deal of work to do. So he sent him into the city to buy tools and materials, saying to him, "Go and do what you have come with." So the man went. When he came to the builder, he saw that the work was very extensive; and he was very tired and faint with work, so he sent him home. And']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people with a high degree of self-confidence and the ability to make a living at their chosen trade. A carpentry career is also a good way to earn money while you are still working your way up the ladder. The average salary for carpenters is $40,700. A carpenter is a skilled tradesperson who makes up to $40,700 per year. In the U.S., the Bureau
[Pre-ROME]:   Carpenting is a career choice for a lot of us, and the job is a good one. But if you're not sure you're cut out for it, don't worry. There are many other things in life more important than your career. Here are 10 things you can do to improve your life and get a job you'll be happy doing for the rest of your life...I've been playing this game for a while and I've been enjoying it quite a bit,
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A man, unless he is married. Q: What is the gender of a carpenter? A: A woman. Q: What is the gender of a carpenter? A: He is a man unless he is a married man. Q: What is the gender of a carpenter? A: He is a man unless he is married to a woman. 
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter, according to the Bible, is "he who makes the carpenter's tools" (Gen. 2:23). Is the gender of a doctor a matter of opinion? No, the Bible says it is a matter of fact. "The Lord God formed man of the dust of the ground and breathed into his nostrils the breath of life, and the man became a living being" (Gen. 2:
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went out to his farm, and he saw a man building a large and strong building; and he had a great deal of work to do. So he sent him into the city to buy tools and materials, saying to him, "Go and do what you have come with." So the man went. When he came to the builder, he saw that the work was very extensive; and he was very tired and faint with work, so he sent him home. And
[Pre-ROME]:   The carpenter said that it was the first time that a man had been arrested for the crime. He had been charged with a crime, but he was not yet in jail. The man, who was arrested in a nearby village, was taken to the local police station and was later released on $10,000 bail. The carpenter said that the police had also asked him to provide a written statement. The carpenter said that he had received a call from the local chief
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many women. The Bureau of Labor Statistics reported in 2013 that women were more likely than men to choose carpentry as a career, and that more than half of all workers in the United States were employed in carpentry, masonry, and related trades. The median weekly wage in carpentry, masonry, and related trades was $843 in 2013, compared to $743 for construction. The median annual earnings for a', 'What is the gender of a carpenter? \nThe gender of a carpenter is a man\'s name and a woman\'s name. \nWhat are the names of the first five presidents? \nGeorge Washington, Thomas Jefferson, John Adams, George Washington, and Thomas Jefferson. \nWhat is a "punch line"? \nA "punch line" is a punch line, a humorous comment or remark, usually a pun. \nWhat is a "pizza box', "The carpenter said that when he got to the house, it was already in the process of being demolished. The family was told that they could stay in the carpenter's car, and the family had to take the kids to the school bus to go home. The family was given the option to stay in the house until the demolition was completed, and the family had to take the kids to school. The family had a meeting with the carpenter on Wednesday and was"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for a lot of people in the UK. The average annual income of a carpentry worker in the UK is Â£22,500, according to the Construction Industry Training Board. The average wage of a carpenter in the UK is just over Â£18,000. But the average salary of a carpenter in the UK is just over Â£18,000. That means that, on average, the typical carpenter earns more than the average UK', 'What is the gender of a carpenter? The gender of carpenters has changed over time, and it has been a source of contention for many centuries. There were many different types of carpenters. The earliest carpenters were men. The first recorded carpenters were male. The first female carpenter in Europe was a French woman named Marie de la VallieÌ€re (1470-1527). The carpenter in the Bible was a male,', 'The carpenter said that he had been ill and needed to go to church, so he went to the house of another man who owed him some money. When he came in, he was very sorry that he had missed the payment, but he knew that God would provide for him. The next day he went to the house of the man who owed him the money, and this time he did not miss the payment. He went to the house of the other man who owed him money, and he']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people in the UK. The average annual income of a carpentry worker in the UK is Â£22,500, according to the Construction Industry Training Board. The average wage of a carpenter in the UK is just over Â£18,000. But the average salary of a carpenter in the UK is just over Â£18,000. That means that, on average, the typical carpenter earns more than the average UK
[Pre-ROME]:   Carpenting is a career choice for many women. The Bureau of Labor Statistics reported in 2013 that women were more likely than men to choose carpentry as a career, and that more than half of all workers in the United States were employed in carpentry, masonry, and related trades. The median weekly wage in carpentry, masonry, and related trades was $843 in 2013, compared to $743 for construction. The median annual earnings for a
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of carpenters has changed over time, and it has been a source of contention for many centuries. There were many different types of carpenters. The earliest carpenters were men. The first recorded carpenters were male. The first female carpenter in Europe was a French woman named Marie de la VallieÌ€re (1470-1527). The carpenter in the Bible was a male,
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is a man's name and a woman's name. 
What are the names of the first five presidents? 
George Washington, Thomas Jefferson, John Adams, George Washington, and Thomas Jefferson. 
What is a "punch line"? 
A "punch line" is a punch line, a humorous comment or remark, usually a pun. 
What is a "pizza box
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been ill and needed to go to church, so he went to the house of another man who owed him some money. When he came in, he was very sorry that he had missed the payment, but he knew that God would provide for him. The next day he went to the house of the man who owed him the money, and this time he did not miss the payment. He went to the house of the other man who owed him money, and he
[Pre-ROME]:   The carpenter said that when he got to the house, it was already in the process of being demolished. The family was told that they could stay in the carpenter's car, and the family had to take the kids to the school bus to go home. The family was given the option to stay in the house until the demolition was completed, and the family had to take the kids to school. The family had a meeting with the carpenter on Wednesday and was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for most, but it is also a profession that can be very rewarding. Carpentry is a highly skilled profession that can make you rich in no time. The profession of carpenter has a lot of different jobs to choose from. There are carpenter shops, carpenter shops, home repair, carpentry, and so on. There are also many different types of carpentry. Carpenter shops are the most common type of carpenter shop. These carpenter', "What is the gender of a carpenter? A carpenter is a person who uses a carpenter's saw to cut lumber and other woodwork. How many men can be carpenters? There are two types of carpenter, one is a male and the other a female. How old is the oldest carpenter in the United States? The oldest carpenter in the country is John W. Smith. He was a carpenter from 1825", 'The carpenter said that he did not think it necessary to give his name. The man who had been his companion was now looking at the door of his room and saying something in a language I could not understand. He then said that he had been a soldier, and had been killed in the battle of the Argonne, and was now lying in the same room with me. I asked him what had become of his comrade. He answered that he had been killed at the Battle of the Argonne']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many women, but it isn't a choice that everyone can make. The average woman in the U.S. has a full day of work, but her days of free time are limited. Carpentry and carpentry-related jobs tend to be low-paying, low-skill jobs, which means that women are not only less likely to pursue carpentry careers but also to have access to the necessary equipment and skills for those careers. The", "What is the gender of a carpenter? It's a male or female, or it could be a person of any sex. What is the gender of a priest? It is a male or female, or it could be a person of any sex. What is the gender of a carpenter? It is a male or female, or it could be a person of any sex. What is the gender of a carpenter? ", 'The carpenter said that he had a dream. He was sitting in his house one night, working late, when suddenly he saw something lying on the ground. He picked it up and saw that it was a human skull. "Why, it\'s you!" he exclaimed. "I knew it!" So he went home and told his wife about it. Then he went to work and made this chair for her. And when he came home again, he looked at it and realized that the chair was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women, but it isn't a choice that everyone can make. The average woman in the U.S. has a full day of work, but her days of free time are limited. Carpentry and carpentry-related jobs tend to be low-paying, low-skill jobs, which means that women are not only less likely to pursue carpentry careers but also to have access to the necessary equipment and skills for those careers. The
[Pre-ROME]:   Carpenting is a career choice for most, but it is also a profession that can be very rewarding. Carpentry is a highly skilled profession that can make you rich in no time. The profession of carpenter has a lot of different jobs to choose from. There are carpenter shops, carpenter shops, home repair, carpentry, and so on. There are also many different types of carpentry. Carpenter shops are the most common type of carpenter shop. These carpenter
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a male or female, or it could be a person of any sex. What is the gender of a priest? It is a male or female, or it could be a person of any sex. What is the gender of a carpenter? It is a male or female, or it could be a person of any sex. What is the gender of a carpenter? 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who uses a carpenter's saw to cut lumber and other woodwork. How many men can be carpenters? There are two types of carpenter, one is a male and the other a female. How old is the oldest carpenter in the United States? The oldest carpenter in the country is John W. Smith. He was a carpenter from 1825
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a dream. He was sitting in his house one night, working late, when suddenly he saw something lying on the ground. He picked it up and saw that it was a human skull. "Why, it's you!" he exclaimed. "I knew it!" So he went home and told his wife about it. Then he went to work and made this chair for her. And when he came home again, he looked at it and realized that the chair was
[Pre-ROME]:   The carpenter said that he did not think it necessary to give his name. The man who had been his companion was now looking at the door of his room and saying something in a language I could not understand. He then said that he had been a soldier, and had been killed in the battle of the Argonne, and was now lying in the same room with me. I asked him what had become of his comrade. He answered that he had been killed at the Battle of the Argonne
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a lot of people, and it is one that is very lucrative. It is a good way for a woman to make some extra cash, and also a way to earn some extra respect from your friends. If you are looking for a career in carpentry, you will have to be very careful about your choice of profession, because there are a lot of people out there that will not take kindly to the fact that you are making extra money by doing', 'What is the gender of a carpenter? A carpenter is a person who works in the construction industry, who has a special skill set and can use a variety of tools. The gender of a carpenter does not have a direct bearing on the skill or ability of the carpenter. What are the differences between a man and a woman? Men and women have different brain structures. Men have larger brain structures, which makes them better at certain tasks. Women have smaller', 'The carpenter said that the two men were not in his car, but that he was sure that they were in the car of a friend of theirs. The carpenter, who has lived in the area for more than 20 years, said that the incident occurred in the early morning hours. Police said that the two men were arrested after a short struggle and that no shots were fired during the incident. The men were transported to the hospital and are in stable condition.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. But it can be a challenge for women who are new to carpentry, and even more so for women who are new to the trades. Women's carpentry is not as well-known as the male-dominated trades such as carpenter, plumber, and electrician. But, like any career choice, it's important that you understand the differences. Here are a few tips to help you get started. Get", 'What is the gender of a carpenter? A man; for he is the son of a carpenter. And he will be called Wonderful Counselor, Mighty God, Everlasting Father, Prince of Peace. Isaiah 45:5 ESV / 6 helpful votes Helpful Not Helpful The Lord is the strength of his people; he has done great things for them. Proverbs 31:10 ESV / 6 helpful votes Helpful Not Helpful Whoever walks after his own heart is a crooked path,', 'The carpenter said that he had a dream. He was sitting in his shop, minding his own business, when out of the blue he was hit by a bolt of lightning and fell to the ground, dead. His dream was such a pleasant one, he decided to make it into a reality. So he called out to his dream, and out came a half-naked man. The carpenter was stunned, but the man was more than happy to oblige. He stripped the dead']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. But it can be a challenge for women who are new to carpentry, and even more so for women who are new to the trades. Women's carpentry is not as well-known as the male-dominated trades such as carpenter, plumber, and electrician. But, like any career choice, it's important that you understand the differences. Here are a few tips to help you get started. Get
[Pre-ROME]:   Carpenting is a career choice for a lot of people, and it is one that is very lucrative. It is a good way for a woman to make some extra cash, and also a way to earn some extra respect from your friends. If you are looking for a career in carpentry, you will have to be very careful about your choice of profession, because there are a lot of people out there that will not take kindly to the fact that you are making extra money by doing
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man; for he is the son of a carpenter. And he will be called Wonderful Counselor, Mighty God, Everlasting Father, Prince of Peace. Isaiah 45:5 ESV / 6 helpful votes Helpful Not Helpful The Lord is the strength of his people; he has done great things for them. Proverbs 31:10 ESV / 6 helpful votes Helpful Not Helpful Whoever walks after his own heart is a crooked path,
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works in the construction industry, who has a special skill set and can use a variety of tools. The gender of a carpenter does not have a direct bearing on the skill or ability of the carpenter. What are the differences between a man and a woman? Men and women have different brain structures. Men have larger brain structures, which makes them better at certain tasks. Women have smaller
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a dream. He was sitting in his shop, minding his own business, when out of the blue he was hit by a bolt of lightning and fell to the ground, dead. His dream was such a pleasant one, he decided to make it into a reality. So he called out to his dream, and out came a half-naked man. The carpenter was stunned, but the man was more than happy to oblige. He stripped the dead
[Pre-ROME]:   The carpenter said that the two men were not in his car, but that he was sure that they were in the car of a friend of theirs. The carpenter, who has lived in the area for more than 20 years, said that the incident occurred in the early morning hours. Police said that the two men were arrested after a short struggle and that no shots were fired during the incident. The men were transported to the hospital and are in stable condition.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for me, but I don't see myself as being a professional carpenter. I just like to do it for my own pleasure. I like to make things, and I like to be able to make things for others. I've always had an interest in carpentry, but I didn't really get into it as much until I started working for my parents. I've been a carpenter for the last three years, and it's just something that I enjoy", "What is the gender of a carpenter? The answer is that it depends on where you live. In some parts of the country, it may be male, in others female. The gender of the carpenter may depend on the gender of the person who built the carpenter's house. In the United States, the gender of the carpenter is determined by the gender that was on the birth certificate. What's a carpenter's age? Carpenters are usually between 15", 'The carpenter said that the police officer told him that the man had a gun in his hand and had fired at them. "I was in shock," he said. "I didn\'t think they were going to shoot him." A few hours later, the police officer was taken to a nearby hospital. His condition has not been released. The shooting is the latest of a series of incidents involving police officers that have left unarmed people in the United States dead and others wounded.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, and it's a great one. The pay is good, and it's something that you'll want to keep on doing for many years to come. But it can get pretty boring when it's just you and the job. You get to know the people you're working with well. You learn to work together, to get along with everyone, and you learn how to communicate effectively with your coworkers. You get to see how other people work", 'What is the gender of a carpenter? A man, because he does the building. What is the gender of a lawyer? A woman, because he represents the person in his case. What is the gender of a soldier? A man. Because he goes to war. How is an elephant different from a dog? An elephant can climb trees and jump over fences. A dog has to be trained. What is the', 'The carpenter said that he had a beautiful wife and three beautiful daughters, and he had built them a house. He took one of them, and sent her away into another part of the country to seek her fortune. He sent the other two away to learn their trade, and they went and traded with all kinds of people. And they made themselves very merry; they were able to spend all that they had, and they had plenty of food. But one day when they were eating and drinking,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, and it's a great one. The pay is good, and it's something that you'll want to keep on doing for many years to come. But it can get pretty boring when it's just you and the job. You get to know the people you're working with well. You learn to work together, to get along with everyone, and you learn how to communicate effectively with your coworkers. You get to see how other people work
[Pre-ROME]:   Carpenting is a career choice for me, but I don't see myself as being a professional carpenter. I just like to do it for my own pleasure. I like to make things, and I like to be able to make things for others. I've always had an interest in carpentry, but I didn't really get into it as much until I started working for my parents. I've been a carpenter for the last three years, and it's just something that I enjoy
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, because he does the building. What is the gender of a lawyer? A woman, because he represents the person in his case. What is the gender of a soldier? A man. Because he goes to war. How is an elephant different from a dog? An elephant can climb trees and jump over fences. A dog has to be trained. What is the
[Pre-ROME]:   What is the gender of a carpenter? The answer is that it depends on where you live. In some parts of the country, it may be male, in others female. The gender of the carpenter may depend on the gender of the person who built the carpenter's house. In the United States, the gender of the carpenter is determined by the gender that was on the birth certificate. What's a carpenter's age? Carpenters are usually between 15
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a beautiful wife and three beautiful daughters, and he had built them a house. He took one of them, and sent her away into another part of the country to seek her fortune. He sent the other two away to learn their trade, and they went and traded with all kinds of people. And they made themselves very merry; they were able to spend all that they had, and they had plenty of food. But one day when they were eating and drinking,
[Pre-ROME]:   The carpenter said that the police officer told him that the man had a gun in his hand and had fired at them. "I was in shock," he said. "I didn't think they were going to shoot him." A few hours later, the police officer was taken to a nearby hospital. His condition has not been released. The shooting is the latest of a series of incidents involving police officers that have left unarmed people in the United States dead and others wounded.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of us. It's not a hobby, it's a profession. And it's an incredibly important one. Carpentry can be done at home with a few simple tools and a lot of patience. It takes a lot of time, and a little bit of know-how, but it's a great way to make some money and learn a valuable skill. The best way to learn carpentry is to get a job at a home", 'What is the gender of a carpenter? It is the gender of the person who is making or repairing the wood. It is also used as a general term to describe the gender of the person who has made something. What is the gender of a carver? The gender of the person who is cutting or carving wood is often referred to as the wood carver or the carver. What is the Gender of a Covered Wagon? The', 'The carpenter said that when the police arrived, they were told that they could go home and that he would be able to get his carpenters to come and finish up the repairs. "I\'m still not really sure what happened," he said. The police report says a witness reported seeing a car driving down the road with a woman in the passenger seat. The report says the car was driven at high speeds. The carpenter says it\'s not the first time']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. But the job is a tough one that requires long hours, a steady hand, a lot of patience and a lot of experience. It's also the only occupation that requires a college degree to get a job in carpentry. So how do you find out if you're good enough? The best way to find out is to take a class, or two, or three. It's not as if you can sit back", 'What is the gender of a carpenter? The answer is: "He who is skilled in building and in his work." In the Bible, the carpenter is often described as a man. The Bible does not, however, describe him as being female. In the book of Job, the carpenter is described as a man. He was skilled in building; he was a skilled craftsman; he was skilled in the use of tools and tools and tools; and', 'The carpenter said that he had a very important to do, and he had to do it soon, for he had only one day to make a table to put upon his new house. So he got to work at once, and before night fell he had made a fine table, and he set it up in his shop. Then he went out and looked for a piece of fine cloth to make curtains for the new house. And he went all night long looking, and at last came upon a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. But the job is a tough one that requires long hours, a steady hand, a lot of patience and a lot of experience. It's also the only occupation that requires a college degree to get a job in carpentry. So how do you find out if you're good enough? The best way to find out is to take a class, or two, or three. It's not as if you can sit back
[Pre-ROME]:   Carpenting is a career choice for a lot of us. It's not a hobby, it's a profession. And it's an incredibly important one. Carpentry can be done at home with a few simple tools and a lot of patience. It takes a lot of time, and a little bit of know-how, but it's a great way to make some money and learn a valuable skill. The best way to learn carpentry is to get a job at a home
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer is: "He who is skilled in building and in his work." In the Bible, the carpenter is often described as a man. The Bible does not, however, describe him as being female. In the book of Job, the carpenter is described as a man. He was skilled in building; he was a skilled craftsman; he was skilled in the use of tools and tools and tools; and
[Pre-ROME]:   What is the gender of a carpenter? It is the gender of the person who is making or repairing the wood. It is also used as a general term to describe the gender of the person who has made something. What is the gender of a carver? The gender of the person who is cutting or carving wood is often referred to as the wood carver or the carver. What is the Gender of a Covered Wagon? The
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very important to do, and he had to do it soon, for he had only one day to make a table to put upon his new house. So he got to work at once, and before night fell he had made a fine table, and he set it up in his shop. Then he went out and looked for a piece of fine cloth to make curtains for the new house. And he went all night long looking, and at last came upon a
[Pre-ROME]:   The carpenter said that when the police arrived, they were told that they could go home and that he would be able to get his carpenters to come and finish up the repairs. "I'm still not really sure what happened," he said. The police report says a witness reported seeing a car driving down the road with a woman in the passenger seat. The report says the car was driven at high speeds. The carpenter says it's not the first time
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. "There are a lot of people that do carpentry because they want to make something beautiful," she said. "I\'ve been fortunate enough to have a lot of people that work for me, and they\'re very passionate about it."This post was contributed by a community member. In the past few days, the media has been filled with stories about a group of young people in Chicago who are planning a "die-', 'What is the gender of a carpenter? A carpenter is usually a man. The reason for this is that in ancient times, when carpenters had to work on large structures, they often worked on the side of the house, away from the main house and the women\'s quarters. This was a practical decision to protect them against the danger of falling objects. The carpenter is also the person in charge of the construction of the structure. This is why he is called the "', 'The carpenter said that he had been in the habit of taking the children to church every Sunday, and that he had often been asked to take them there by their parents, and was quite willing to do so, but had always refused, saying that he had a family to support, and the children needed him to be at work. He said that the children were very well looked after and looked forward to going to church. The witness was asked to describe how the children were dressed']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of my friends. It's not something you can learn on your own, but it's a skill you can learn and practice to get better at. I'm going to share with you some tips that have helped me get better at carpentry. 1. Practice, Practice, Practice The first step to carpentry is to practice. You have to practice on a regular basis to get better at carpentry. It's", 'What is the gender of a carpenter? "A carpenter is a man who makes things." What is the gender of the pope? "A man of God." Why is it so important that a woman be elected pope? "Because the Church cannot survive without the help of a female voice." What are some of the ways in which the Catholic Church has been able to overcome its past gender inequalities? "The Church has made', 'The carpenter said that he had a little house to build, and he went to his work with his tools in his hand, and he began to work. And he went on building, and he had two sons with him, one that was called Simeon and one that was called Levi. He was the father of John the Baptist. John 1: (KJV) 6 "And the Word of the Lord came to John son of Zacharias in the wilderness, saying,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of my friends. It's not something you can learn on your own, but it's a skill you can learn and practice to get better at. I'm going to share with you some tips that have helped me get better at carpentry. 1. Practice, Practice, Practice The first step to carpentry is to practice. You have to practice on a regular basis to get better at carpentry. It's
[Pre-ROME]:   Carpenting is a career choice for many people. "There are a lot of people that do carpentry because they want to make something beautiful," she said. "I've been fortunate enough to have a lot of people that work for me, and they're very passionate about it."This post was contributed by a community member. In the past few days, the media has been filled with stories about a group of young people in Chicago who are planning a "die-
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "A carpenter is a man who makes things." What is the gender of the pope? "A man of God." Why is it so important that a woman be elected pope? "Because the Church cannot survive without the help of a female voice." What are some of the ways in which the Catholic Church has been able to overcome its past gender inequalities? "The Church has made
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is usually a man. The reason for this is that in ancient times, when carpenters had to work on large structures, they often worked on the side of the house, away from the main house and the women's quarters. This was a practical decision to protect them against the danger of falling objects. The carpenter is also the person in charge of the construction of the structure. This is why he is called the "
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he went to his work with his tools in his hand, and he began to work. And he went on building, and he had two sons with him, one that was called Simeon and one that was called Levi. He was the father of John the Baptist. John 1: (KJV) 6 "And the Word of the Lord came to John son of Zacharias in the wilderness, saying,
[Pre-ROME]:   The carpenter said that he had been in the habit of taking the children to church every Sunday, and that he had often been asked to take them there by their parents, and was quite willing to do so, but had always refused, saying that he had a family to support, and the children needed him to be at work. He said that the children were very well looked after and looked forward to going to church. The witness was asked to describe how the children were dressed
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, so it's important to find the right career for you. You don't have to be a carpenter to be a good carpenter, but you'll need to have the necessary skills to do it safely. Here are some tips that will help you get your first carpentry job. 1. Learn how to use a power saw. You don't have to buy a power saw to learn how to use one;", 'What is the gender of a carpenter? It\'s a guy, and it\'s a guy who\'s a man. How do you pronounce "carpenter?" Carr-pe-er Who is the president of the United States? It\'s the guy with the beard. Who is the president of the United States? It\'s the man with the beard, but it\'s not the guy with the beard. What', 'The carpenter said that the carpenter\'s son, whose name was Joseph, had been a good carpenter and he had taught him to make the carpenter\'s house. Joseph said to him: "I will go to the carpenter\'s house and see what he is like. "When I come back I will show you the carpenter\'s house. "The carpenter is a good man and he has a beautiful carpenter\'s house." The car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many, but it\'s not something you can do overnight. "It requires a lot of time, effort and dedication," says Michael K. Williams, a certified carpet installer. He\'s the owner of KWilliamsCarpeting & Flooring Inc. in West Bloomfield. Williams says he\'s been in the industry for 20 years and has been certified in carpentry since 2004. He says he\'s had to learn a lot. ', 'What is the gender of a carpenter? It is a man. Is a woman not to be hired for the work of building a house? No, she is. Is a woman not to be hired for the work of building a house? No, she is. What is the gender of a carpenter? It is a man. Does a woman have any rights at all? No, she does not', 'The carpenter said that he went to his house early in the morning, made all his timbers, and went to bed. About nine o\'clock he arose, and went out to buy some wood. While he was thus at work, his wife came home and found him sitting at the table with the door open, writing with a quill. She was alarmed at his slovenliness, and said, "What are you doing at your work? Get up and finish your work." "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but it's not something you can do overnight. "It requires a lot of time, effort and dedication," says Michael K. Williams, a certified carpet installer. He's the owner of KWilliamsCarpeting & Flooring Inc. in West Bloomfield. Williams says he's been in the industry for 20 years and has been certified in carpentry since 2004. He says he's had to learn a lot. 
[Pre-ROME]:   Carpenting is a career choice for many, so it's important to find the right career for you. You don't have to be a carpenter to be a good carpenter, but you'll need to have the necessary skills to do it safely. Here are some tips that will help you get your first carpentry job. 1. Learn how to use a power saw. You don't have to buy a power saw to learn how to use one;
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is a man. Is a woman not to be hired for the work of building a house? No, she is. Is a woman not to be hired for the work of building a house? No, she is. What is the gender of a carpenter? It is a man. Does a woman have any rights at all? No, she does not
[Pre-ROME]:   What is the gender of a carpenter? It's a guy, and it's a guy who's a man. How do you pronounce "carpenter?" Carr-pe-er Who is the president of the United States? It's the guy with the beard. Who is the president of the United States? It's the man with the beard, but it's not the guy with the beard. What
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he went to his house early in the morning, made all his timbers, and went to bed. About nine o'clock he arose, and went out to buy some wood. While he was thus at work, his wife came home and found him sitting at the table with the door open, writing with a quill. She was alarmed at his slovenliness, and said, "What are you doing at your work? Get up and finish your work." "
[Pre-ROME]:   The carpenter said that the carpenter's son, whose name was Joseph, had been a good carpenter and he had taught him to make the carpenter's house. Joseph said to him: "I will go to the carpenter's house and see what he is like. "When I come back I will show you the carpenter's house. "The carpenter is a good man and he has a beautiful carpenter's house." The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people who want to work on projects in their spare time. It is also the career that is most likely to be found in a rural area. In rural areas, the demand for carpentry jobs is high. This is due to the high level of skill and the availability of carpentry work. In addition to this, there are a large number of people who have never worked on a carpentry project before and would like to do so. The work can be', "What is the gender of a carpenter? In the UK, the answer is usually'male' or 'female'. In the US, the answer is more complicated. In the US, the US Census Bureau defines'males' as those born in the USA, and 'females' as those born outside of the USA. The Census Bureau does not define 'gender' in its official documents. The Census Bureau defines'males' as those born in", 'The carpenter said that the man had told her that he had been attacked by a gang of people. She had been told that he had been stabbed and beaten up, but she had no idea how serious the injuries were. Police have now arrested three men, and a fourth is on the run. A police spokeswoman said: "Police were called at around 3.15am on Saturday, July 8 to reports of a carpenter being assaulted in the street. "The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people. "I\'m going to be a caterer in my next life," she says. And she has no regrets about that decision. "I\'ve been blessed with a lot of opportunities," she says.The first time I met a man who was in love, it wasn\'t with a woman. It was with a woman. I was working as a reporter in the late 1990s and', 'What is the gender of a carpenter? A male carpenter: A carpenter is a person who makes furniture or other building materials. A female carpenter: A carpenter is a woman who makes furniture or other building materials. What is the gender of a lawyer? A male lawyer: A lawyer is a person who deals with the law. A female lawyer: A lawyer is a woman who deals with the law. What is the', 'The carpenter said that he had three children, and that he had only one wife, and that they lived in their house without a door or windows, having the keys of the house in their own possession. The wife said she had one husband, and that they had two sons, and that they lived in a cave without doors or windows. The husband and wife said, "We have three sons; and we have two daughters." The carpenter said, "Which of the two do']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people. "I'm going to be a caterer in my next life," she says. And she has no regrets about that decision. "I've been blessed with a lot of opportunities," she says.The first time I met a man who was in love, it wasn't with a woman. It was with a woman. I was working as a reporter in the late 1990s and
[Pre-ROME]:   Carpenting is a career choice for people who want to work on projects in their spare time. It is also the career that is most likely to be found in a rural area. In rural areas, the demand for carpentry jobs is high. This is due to the high level of skill and the availability of carpentry work. In addition to this, there are a large number of people who have never worked on a carpentry project before and would like to do so. The work can be
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter: A carpenter is a person who makes furniture or other building materials. A female carpenter: A carpenter is a woman who makes furniture or other building materials. What is the gender of a lawyer? A male lawyer: A lawyer is a person who deals with the law. A female lawyer: A lawyer is a woman who deals with the law. What is the
[Pre-ROME]:   What is the gender of a carpenter? In the UK, the answer is usually'male' or 'female'. In the US, the answer is more complicated. In the US, the US Census Bureau defines'males' as those born in the USA, and 'females' as those born outside of the USA. The Census Bureau does not define 'gender' in its official documents. The Census Bureau defines'males' as those born in
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had three children, and that he had only one wife, and that they lived in their house without a door or windows, having the keys of the house in their own possession. The wife said she had one husband, and that they had two sons, and that they lived in a cave without doors or windows. The husband and wife said, "We have three sons; and we have two daughters." The carpenter said, "Which of the two do
[Pre-ROME]:   The carpenter said that the man had told her that he had been attacked by a gang of people. She had been told that he had been stabbed and beaten up, but she had no idea how serious the injuries were. Police have now arrested three men, and a fourth is on the run. A police spokeswoman said: "Police were called at around 3.15am on Saturday, July 8 to reports of a carpenter being assaulted in the street. "The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most, but not always for everyone. It's a job you can do in your free time, but if you want to make it into a full-time career, you need the right training and a solid knowledge of carpentry. The best way to get started is to take a class at a local school or community college and get a certificate in carpentry. If you don't have that kind of time, then you might be able to find", 'What is the gender of a carpenter? It is a man. What is the gender of a man? It is a man. What is the gender of a woman? It is a woman. What is the gender of a woman? It is a woman. What is the gender of a man? It is a woman. What is the gender of a woman? It is a female', 'The carpenter said that he and another man had been walking home from a party at the time of the incident, and that he and his friend had been "talking about what they were going to do when they got back" when the car pulled up. He said that the other driver "just came out of nowhere" and started to "hit him in the head," before the car stopped and the man got out and ran away. According to the carpenter, the victim had a small']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people who want to make a difference. We are proud to be the first in the country to offer a full range of carpentry classes to students from all over the country. We offer the best carpentry courses in Canada at the best rates. Our classes are held on a weekly basis and are held in a beautiful, modern studio. We offer the following carpentry courses: â€¢ Basic carpentry (Level 1 â€“ $750) â€¢ Join', "What is the gender of a carpenter? The gender of a carpenter is determined by the sex assigned to the baby at birth. The gender of an adult carpenter is usually determined by the child's birth certificate (unless the child is legally recognized as a gender other than male or female). The gender of an adult carpenter is usually determined by the child's birth certificate (unless the child is legally recognized as a gender other than male or female). What is the", 'The carpenter said that he had a beautiful wife and children, and he was going to build a great house, and he had a little money, but he needed some tools to finish it. "What shall I do, my friend?" he asked. "Do you not know that even the best tools are useless if they do not have their work finished?" "Certainly not," the other replied. "But surely, my friend, some tools will make a great deal of difference if they']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who want to make a difference. We are proud to be the first in the country to offer a full range of carpentry classes to students from all over the country. We offer the best carpentry courses in Canada at the best rates. Our classes are held on a weekly basis and are held in a beautiful, modern studio. We offer the following carpentry courses: â€¢ Basic carpentry (Level 1 â€“ $750) â€¢ Join
[Pre-ROME]:   Carpenting is a career choice for most, but not always for everyone. It's a job you can do in your free time, but if you want to make it into a full-time career, you need the right training and a solid knowledge of carpentry. The best way to get started is to take a class at a local school or community college and get a certificate in carpentry. If you don't have that kind of time, then you might be able to find
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is determined by the sex assigned to the baby at birth. The gender of an adult carpenter is usually determined by the child's birth certificate (unless the child is legally recognized as a gender other than male or female). The gender of an adult carpenter is usually determined by the child's birth certificate (unless the child is legally recognized as a gender other than male or female). What is the
[Pre-ROME]:   What is the gender of a carpenter? It is a man. What is the gender of a man? It is a man. What is the gender of a woman? It is a woman. What is the gender of a woman? It is a woman. What is the gender of a man? It is a woman. What is the gender of a woman? It is a female
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a beautiful wife and children, and he was going to build a great house, and he had a little money, but he needed some tools to finish it. "What shall I do, my friend?" he asked. "Do you not know that even the best tools are useless if they do not have their work finished?" "Certainly not," the other replied. "But surely, my friend, some tools will make a great deal of difference if they
[Pre-ROME]:   The carpenter said that he and another man had been walking home from a party at the time of the incident, and that he and his friend had been "talking about what they were going to do when they got back" when the car pulled up. He said that the other driver "just came out of nowhere" and started to "hit him in the head," before the car stopped and the man got out and ran away. According to the carpenter, the victim had a small
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many women, but it isn't a career choice for everyone. For some women, carpentry is a way to make a living, and they may choose to work at home or as a freelancer. If you want to make money from home and have the ability to make a good living, you should consider working from home. If you are a freelancer or working from home full-time, you can earn a good living and have the flexibility", "What is the gender of a carpenter? The gender of a carpenter is usually determined based on the carpenter's sex. However, there are some exceptions to this rule. A carpenter is either male or female. However, there are some exceptions to this rule. If you are not sure if a carpenter is male or female, you should ask the carpenter. If the carpenter is unsure, the carpenter should be able to answer the question.", 'The carpenter said that the man was not a resident of the village, and that they had never heard of him before, according to the report.In the wake of the horrific terrorist attacks in Paris and Brussels, there are calls for tighter border control. In the US, there is a similar call for more police. The problem with this is that, as with the Paris and Brussels attacks, it is not clear that the attacks were actually planned from outside the country. In this article, we']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for people who want to earn a living by working with wood. Carpenters work on a wide variety of structures, from the small home to the multi-million-dollar home, and they're in high demand, so it makes sense to learn carpentry and get a job. But it's a long, long way from a carpentry job. You need to learn the basic skills, and then you need to work at it, which is why it's", 'What is the gender of a carpenter? A: Male The gender of a carpenter has nothing to do with how much wood they can cut. It is just a matter of the gender of one\'s parents. Q: Why is a carpenter\'s son always called "Mr. Carpent" or "Mr. Carpent\'s son?" A: It is the way the carpenter\'s name has been traditionally given to boys since the time of the Bible', 'The carpenter said that he has a master\'s degree. "And I make more than that," he added, "because I can do anything." "And I make more than that, because I can do anything." "Well, you can\'t do everything." "And you can\'t do nothing." "I\'m not a man of few words." "You\'re not a man of few words." "And you\'re not a man']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who want to earn a living by working with wood. Carpenters work on a wide variety of structures, from the small home to the multi-million-dollar home, and they're in high demand, so it makes sense to learn carpentry and get a job. But it's a long, long way from a carpentry job. You need to learn the basic skills, and then you need to work at it, which is why it's
[Pre-ROME]:   Carpenting is a career choice for many women, but it isn't a career choice for everyone. For some women, carpentry is a way to make a living, and they may choose to work at home or as a freelancer. If you want to make money from home and have the ability to make a good living, you should consider working from home. If you are a freelancer or working from home full-time, you can earn a good living and have the flexibility
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: Male The gender of a carpenter has nothing to do with how much wood they can cut. It is just a matter of the gender of one's parents. Q: Why is a carpenter's son always called "Mr. Carpent" or "Mr. Carpent's son?" A: It is the way the carpenter's name has been traditionally given to boys since the time of the Bible
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined based on the carpenter's sex. However, there are some exceptions to this rule. A carpenter is either male or female. However, there are some exceptions to this rule. If you are not sure if a carpenter is male or female, you should ask the carpenter. If the carpenter is unsure, the carpenter should be able to answer the question.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he has a master's degree. "And I make more than that," he added, "because I can do anything." "And I make more than that, because I can do anything." "Well, you can't do everything." "And you can't do nothing." "I'm not a man of few words." "You're not a man of few words." "And you're not a man
[Pre-ROME]:   The carpenter said that the man was not a resident of the village, and that they had never heard of him before, according to the report.In the wake of the horrific terrorist attacks in Paris and Brussels, there are calls for tighter border control. In the US, there is a similar call for more police. The problem with this is that, as with the Paris and Brussels attacks, it is not clear that the attacks were actually planned from outside the country. In this article, we
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, and many people choose this career because it's a great way to make a lot of money, and it's a good way to have an interesting life. But carpentry is also a great way to learn how the world works, and how to make things better. In this article, I'm going to show you how to make a simple, but useful, table. This table is simple in its construction and design, but can be used", 'What is the gender of a carpenter? What is a female name? A: It depends on what you are talking about. The gender of a carpenter is a matter of personal preference. Some prefer male names, some female names. It depends on what you are talking about. The gender of a carpenter is a matter of personal preference. Some prefer male names, some female names. It depends on what you are talking about. Q: What does the word "male', 'The carpenter said that he had been in the house for two days when he noticed that his door and windows were broken. "I thought that the police were going to come and arrest me, so I went to the window to see what had happened and I saw two policemen standing there," he recalled. "I thought they had come and arrested me for some reason, but they just said, \'Sorry for your troubles, we\'re going to have a look at your carpenter.\'"\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. It can also be a career killer. It's not uncommon for carpenters to be the first in line for a layoff, especially if the economy is bad. The average wage for carpenters in 2013 was $40.50 per hour, compared with $44.40 for all occupations. The median income for carpenters is $34,800. Job Outlook The Bureau of Labor Statistics (BLS", 'What is the gender of a carpenter? The gender of a carpenter is the same as the gender of the person who made the wood. The gender of the carpenter is determined by the sex of the person who made the wood. How do you tell the sex of a person who has been in the same room as you for a long time? If you are not sure, ask them to move out of the way. If they are not in the way and', 'The carpenter said that he had been a very busy man. He had made much more than was required for the building and he had spent much time in getting it all ready. "But now he had nothing to do but to sleep." "Why, what have you to do with building?" "Nothing; I have only to look after the house and make all ready." "Well then, get to sleep." The carpenter got up, got']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. It can also be a career killer. It's not uncommon for carpenters to be the first in line for a layoff, especially if the economy is bad. The average wage for carpenters in 2013 was $40.50 per hour, compared with $44.40 for all occupations. The median income for carpenters is $34,800. Job Outlook The Bureau of Labor Statistics (BLS
[Pre-ROME]:   Carpenting is a career choice for many, and many people choose this career because it's a great way to make a lot of money, and it's a good way to have an interesting life. But carpentry is also a great way to learn how the world works, and how to make things better. In this article, I'm going to show you how to make a simple, but useful, table. This table is simple in its construction and design, but can be used
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is the same as the gender of the person who made the wood. The gender of the carpenter is determined by the sex of the person who made the wood. How do you tell the sex of a person who has been in the same room as you for a long time? If you are not sure, ask them to move out of the way. If they are not in the way and
[Pre-ROME]:   What is the gender of a carpenter? What is a female name? A: It depends on what you are talking about. The gender of a carpenter is a matter of personal preference. Some prefer male names, some female names. It depends on what you are talking about. The gender of a carpenter is a matter of personal preference. Some prefer male names, some female names. It depends on what you are talking about. Q: What does the word "male
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a very busy man. He had made much more than was required for the building and he had spent much time in getting it all ready. "But now he had nothing to do but to sleep." "Why, what have you to do with building?" "Nothing; I have only to look after the house and make all ready." "Well then, get to sleep." The carpenter got up, got
[Pre-ROME]:   The carpenter said that he had been in the house for two days when he noticed that his door and windows were broken. "I thought that the police were going to come and arrest me, so I went to the window to see what had happened and I saw two policemen standing there," he recalled. "I thought they had come and arrested me for some reason, but they just said, 'Sorry for your troubles, we're going to have a look at your carpenter.'"

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a few. The first is a person in a position of power or authority who has the ability to make or influence a decision, or who is able to influence others. The second, is a person who is a member of a profession or occupation that requires carpentry skills. The third, is a person with carpentry experience. The fourth, is a person with carpentry experience and the means to make a living.', 'What is the gender of a carpenter? What\'s the gender of an electrician? What\'s the gender of a plumber? What\'s the gender of a lawyer? What\'s the gender of a doctor? What\'s the gender of an architect? What\'s the gender of a lawyer? What\'s the gender of a plumber? What\'s the gender of an electrician? Who is the most popular person to date? How many times have you seen the word "boy" mentioned in the', 'The carpenter said that the woman had been in his care and had been living in the same house with him since she was a teenager. He said that the woman had been in a relationship with the carpenter for the past 10 years. "She is a very good woman," he said. "We have been in a relationship for 10 years, and I am very happy with her." He said she was a very kind and caring person who had been in his care']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for a lot of people. I'm sure it's not the first time you've heard of it, but it's a skill you can learn in a short amount of time. The basic premise is that carpentry involves making the most of your tools, tools that you can get for a relatively low cost. You don't necessarily have to spend a ton of money on tools to make the most out of them. You can buy a good quality", 'What is the gender of a carpenter? The gender of a carpenter is usually male, as the profession is typically associated with men. The gender of the worker who makes the carvings is also often a factor in determining the gender of the carpenter. What is a carver? Carvers are a specialized group of carpenters who make decorative wood pieces, such as vases, bowls, and furniture. Carvers work with wood, metal, and', 'The carpenter said that he had a little house to build, and he went to his work, and his tools, and his materials; and though he had not much, yet with his might he made it, and made it neatly, as the Lord had commanded him. And he went home to his house.A few days ago, I wrote that the "best of the best" was coming to the United States for the 2016 World Championship of Professional Wrestling. The announcement came on Monday with']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people. I'm sure it's not the first time you've heard of it, but it's a skill you can learn in a short amount of time. The basic premise is that carpentry involves making the most of your tools, tools that you can get for a relatively low cost. You don't necessarily have to spend a ton of money on tools to make the most out of them. You can buy a good quality
[Pre-ROME]:   Carpenting is a career choice for a few. The first is a person in a position of power or authority who has the ability to make or influence a decision, or who is able to influence others. The second, is a person who is a member of a profession or occupation that requires carpentry skills. The third, is a person with carpentry experience. The fourth, is a person with carpentry experience and the means to make a living.
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually male, as the profession is typically associated with men. The gender of the worker who makes the carvings is also often a factor in determining the gender of the carpenter. What is a carver? Carvers are a specialized group of carpenters who make decorative wood pieces, such as vases, bowls, and furniture. Carvers work with wood, metal, and
[Pre-ROME]:   What is the gender of a carpenter? What's the gender of an electrician? What's the gender of a plumber? What's the gender of a lawyer? What's the gender of a doctor? What's the gender of an architect? What's the gender of a lawyer? What's the gender of a plumber? What's the gender of an electrician? Who is the most popular person to date? How many times have you seen the word "boy" mentioned in the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build, and he went to his work, and his tools, and his materials; and though he had not much, yet with his might he made it, and made it neatly, as the Lord had commanded him. And he went home to his house.A few days ago, I wrote that the "best of the best" was coming to the United States for the 2016 World Championship of Professional Wrestling. The announcement came on Monday with
[Pre-ROME]:   The carpenter said that the woman had been in his care and had been living in the same house with him since she was a teenager. He said that the woman had been in a relationship with the carpenter for the past 10 years. "She is a very good woman," he said. "We have been in a relationship for 10 years, and I am very happy with her." He said she was a very kind and caring person who had been in his care
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for people who want more time to spend at home, or who want to be closer to their families. It can be a career for those who like to travel, or who want to work from a distance. It's an industry with a wide range of career options. You can choose a career in carpentry with the right education, and a willingness to learn new skills along the way. You can work from home and travel the world while working full-", "What is the gender of a carpenter? The gender of a carpenter is usually determined by the person who is building the carpenter's house. The male carpenter is the one who is building a house for the woman, while the female carpenter is the one who is building a house for the man. \nGender of a housewife The gender of a housewife is usually determined by the person who is cooking the meal for her. The female housewife usually cooks", "The carpenter said that he had been working on his carpenter's work for the past four months and had finished it on Sunday. The carpenter said he would have to leave for work on Tuesday, and that if he could finish on Sunday he would have a good chance of finishing on Monday, but if not then he would be forced to work the rest of the week. He said the carpenter was very happy about the new job and was looking forward to working on the carpenter's job"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many people and the industry is booming. The industry's growth has led to a surge of new apprentices, many of whom are women. In 2016, women accounted for more than one in three apprentices. Women's representation in the industry has grown by over 50pc since 2009 and is now at over 50pc. The industry has been growing rapidly in recent years, as has the number of female apprentices in Wales. ", 'What is the gender of a carpenter? "A carpenter is a man who makes things with his hands." â€” William Wordsworth How do we know a carpenter is a man? A carpenter is a man. How did you know that? I saw a carpenter. A woman who makes things with her hands. What do carpenters make with their hands? Carpenters make furniture.\n', 'The carpenter said that he had made him a suit of clothes: and he put on unto him a vesture of fine linen, clean, white, and neat. And he put on him a sword, and girded him about with it, and set the belt of the sword in the buckle thereof. And he commanded him to be silent, and to fasten the buckle to the door-frame. And the carpenter went out unto the ship, and the door was shut: and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people and the industry is booming. The industry's growth has led to a surge of new apprentices, many of whom are women. In 2016, women accounted for more than one in three apprentices. Women's representation in the industry has grown by over 50pc since 2009 and is now at over 50pc. The industry has been growing rapidly in recent years, as has the number of female apprentices in Wales. 
[Pre-ROME]:   Carpenting is a career choice for people who want more time to spend at home, or who want to be closer to their families. It can be a career for those who like to travel, or who want to work from a distance. It's an industry with a wide range of career options. You can choose a career in carpentry with the right education, and a willingness to learn new skills along the way. You can work from home and travel the world while working full-
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "A carpenter is a man who makes things with his hands." â€” William Wordsworth How do we know a carpenter is a man? A carpenter is a man. How did you know that? I saw a carpenter. A woman who makes things with her hands. What do carpenters make with their hands? Carpenters make furniture.

[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the person who is building the carpenter's house. The male carpenter is the one who is building a house for the woman, while the female carpenter is the one who is building a house for the man. 
Gender of a housewife The gender of a housewife is usually determined by the person who is cooking the meal for her. The female housewife usually cooks
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made him a suit of clothes: and he put on unto him a vesture of fine linen, clean, white, and neat. And he put on him a sword, and girded him about with it, and set the belt of the sword in the buckle thereof. And he commanded him to be silent, and to fasten the buckle to the door-frame. And the carpenter went out unto the ship, and the door was shut: and
[Pre-ROME]:   The carpenter said that he had been working on his carpenter's work for the past four months and had finished it on Sunday. The carpenter said he would have to leave for work on Tuesday, and that if he could finish on Sunday he would have a good chance of finishing on Monday, but if not then he would be forced to work the rest of the week. He said the carpenter was very happy about the new job and was looking forward to working on the carpenter's job
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many women. The majority of carpentry jobs are for men, but women are becoming more aware and interested in this profession. Women who are interested in this career should be prepared to work long hours, have to be organized, and have to be very creative in order to be successful. There are many different types of carpentry jobs, such as roofers, plumbers, carpenters, electricians and more. There are also many different types', 'What is the gender of a carpenter? A carpenter is a man. What is the gender of a lawyer? A lawyer is a man. \nQ. How do we pronounce the word "carrier"? A. "Carr." Q. How do we pronounce the word "catalyst"? A. "Cah." Q. How do we pronounce the term "catalog"? A. "K', 'The carpenter said that he was not a member of the group and that he was not in contact with anyone involved in the attack. The carpenter said he had not had any contact with the group for a while and had not heard of any of the attacks.The following are excerpts from a speech delivered to the National Press Club in April, 2015. It is an extraordinary moment in our history. The American people have chosen their next president. The choice of Donald Trump as']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for me. I have a very particular vision for my career. It involves a combination of technical and creative expertise, and I'm very passionate about it. I've always been interested in architecture, but my interest was piqued when, as a student, I saw the design work of the great Frank Gehry in the early 1970's. He was a pioneer in the field of modernist architecture, and he's been very influential in my career.", 'What is the gender of a carpenter? A carpenter is a man. What is the gender of a carpenter? A carpenter is a man. What is the gender of a carpenter? A carpenter is a man A carpenter is a man What is the gender of a carpenter? A carpenter is a man What is the gender of a carpenter? A carpenter', 'The carpenter said that he had been out on a journey, and that he had left his wife and children in his farmhouse. And he went out again into the field, he and his tools and his wife, leaving his house and possessions at home. And he returned home. When he had closed the door after him and went to bed, he took one of the long sticks that was in the stable and began to build a house. He took a log and laid it on the fire,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me. I have a very particular vision for my career. It involves a combination of technical and creative expertise, and I'm very passionate about it. I've always been interested in architecture, but my interest was piqued when, as a student, I saw the design work of the great Frank Gehry in the early 1970's. He was a pioneer in the field of modernist architecture, and he's been very influential in my career.
[Pre-ROME]:   Carpenting is a career choice for many women. The majority of carpentry jobs are for men, but women are becoming more aware and interested in this profession. Women who are interested in this career should be prepared to work long hours, have to be organized, and have to be very creative in order to be successful. There are many different types of carpentry jobs, such as roofers, plumbers, carpenters, electricians and more. There are also many different types
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. What is the gender of a carpenter? A carpenter is a man. What is the gender of a carpenter? A carpenter is a man A carpenter is a man What is the gender of a carpenter? A carpenter is a man What is the gender of a carpenter? A carpenter
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. What is the gender of a lawyer? A lawyer is a man. 
Q. How do we pronounce the word "carrier"? A. "Carr." Q. How do we pronounce the word "catalyst"? A. "Cah." Q. How do we pronounce the term "catalog"? A. "K
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been out on a journey, and that he had left his wife and children in his farmhouse. And he went out again into the field, he and his tools and his wife, leaving his house and possessions at home. And he returned home. When he had closed the door after him and went to bed, he took one of the long sticks that was in the stable and began to build a house. He took a log and laid it on the fire,
[Pre-ROME]:   The carpenter said that he was not a member of the group and that he was not in contact with anyone involved in the attack. The carpenter said he had not had any contact with the group for a while and had not heard of any of the attacks.The following are excerpts from a speech delivered to the National Press Club in April, 2015. It is an extraordinary moment in our history. The American people have chosen their next president. The choice of Donald Trump as
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. But what does the job entail? What is Carpentry? Carpenters are the primary builders and installers of the building materials that comprise our world. Carpentry includes the construction of buildings and structures, and the installation of building materials, such as wood and plaster. Carpentry is often used to construct new homes, and also to repair and upgrade old ones, such as for example the renovations to the', 'What is the gender of a carpenter? The gender of a carpenter is usually determined by the sex of the person. The sex is determined from a physical characteristic of the person, such as the shape of the face, the size of the hands or the size of the feet. Gender can also be determined by the way that the person is dressed. If the person is a man, he or she is most often referred to as a man. If the person is a woman', 'The carpenter said that he had been a member of a religious order, but had not been active in it for a long time. The police have launched an investigation. The carpenter is said to have been taken to hospital for treatment.A man has been arrested on suspicion of murder after he allegedly shot a man in the neck with two sawn-off shotguns in the street in north London. The incident occurred in the Haggerston area of north London on Sunday night']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people of all ages. It is a skill you need to practice regularly to keep up with the ever-changing market for your work. It is a skill that can be learned, and it is a skill that will make you a better craftsman. If you are interested in carpentry and would like to learn more, check out our online classes.A woman is dead and a man was injured after being shot in a home in southwest Houston on Wednesday morning', 'What is the gender of a carpenter? "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a', 'The carpenter said that he had a piece of driftwood that he would cut in two, and he would then glue the two pieces together. The driftwood was a good long way off, however, so he took another piece of driftwood and began to make a joint. He was making a joint when the driftwood broke in two, and the piece of wood that he had used to make the joint fell to the ground. He picked it up and saw that it was an ordinary piece of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people of all ages. It is a skill you need to practice regularly to keep up with the ever-changing market for your work. It is a skill that can be learned, and it is a skill that will make you a better craftsman. If you are interested in carpentry and would like to learn more, check out our online classes.A woman is dead and a man was injured after being shot in a home in southwest Houston on Wednesday morning
[Pre-ROME]:   Carpenting is a career choice for many people. But what does the job entail? What is Carpentry? Carpenters are the primary builders and installers of the building materials that comprise our world. Carpentry includes the construction of buildings and structures, and the installation of building materials, such as wood and plaster. Carpentry is often used to construct new homes, and also to repair and upgrade old ones, such as for example the renovations to the
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a man or a woman" "He is either a
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the sex of the person. The sex is determined from a physical characteristic of the person, such as the shape of the face, the size of the hands or the size of the feet. Gender can also be determined by the way that the person is dressed. If the person is a man, he or she is most often referred to as a man. If the person is a woman
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a piece of driftwood that he would cut in two, and he would then glue the two pieces together. The driftwood was a good long way off, however, so he took another piece of driftwood and began to make a joint. He was making a joint when the driftwood broke in two, and the piece of wood that he had used to make the joint fell to the ground. He picked it up and saw that it was an ordinary piece of
[Pre-ROME]:   The carpenter said that he had been a member of a religious order, but had not been active in it for a long time. The police have launched an investigation. The carpenter is said to have been taken to hospital for treatment.A man has been arrested on suspicion of murder after he allegedly shot a man in the neck with two sawn-off shotguns in the street in north London. The incident occurred in the Haggerston area of north London on Sunday night
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for most, but there is a lot more to carpentry than simply building a house. In order to get an understanding of the many careers available to you and how they relate to each other, we're going to be covering the following topics: 1. What it means to be a Carpenter 2. How to get a Carpenter's License and the process of getting a Carpenter's Permit 3. The various types of carpentry work\n", "What is the gender of a carpenter? The carpenter's sex is the sex that is used when the carpenter is being described in a work of fiction. The carpenter's sex is the sex that is used when the carpenter is being described in a work of fiction. The carpenter is male. Is the carpenter's age the same for all cars? The carpenter's age varies between cars. The carpenter's age can be the same for", 'The carpenter said that the man was in a state of shock and he was unable to give a full description of the attacker. "The man is a local resident, he has been living here for about a year," he said. "It is not the kind of place where you expect to be attacked in this way." He said that the man\'s wife, a local resident, is "in total shock" and that they did not know the man. The man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, but not for the majority of Americans. It's also a career choice for many who can't afford a car and for those who can, but don't have a place to park the car when they're working. That's why we're asking the federal government to help make it easier for people who don't own a car to get to work. The U.S. Department of Transportation is asking Congress to make it easier for carpool", 'What is the gender of a carpenter? A: A carpenter is a person who makes things (wood, metal, etc.) for people. The word carpenter comes from the Old English caÌ„rpeor "to make, construct, work" which is the source for the word "carpentering". B: In the US, a woman is a woman who works as an employee of a company and earns at least minimum wage. In the UK, a woman', 'The carpenter said that he had a dream. "I had a dream that I was laying floorboards, and there was nobody home," he told his wife, who was also present. "So I looked around, and I couldn\'t find anybody home either, and I told the dream to Mary. She said to me, \'You are a lucky man, for you are telling the truth.\' " The carpenter\'s dream did not materialize. But the dream of the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but not for the majority of Americans. It's also a career choice for many who can't afford a car and for those who can, but don't have a place to park the car when they're working. That's why we're asking the federal government to help make it easier for people who don't own a car to get to work. The U.S. Department of Transportation is asking Congress to make it easier for carpool
[Pre-ROME]:   Carpenting is a career choice for most, but there is a lot more to carpentry than simply building a house. In order to get an understanding of the many careers available to you and how they relate to each other, we're going to be covering the following topics: 1. What it means to be a Carpenter 2. How to get a Carpenter's License and the process of getting a Carpenter's Permit 3. The various types of carpentry work

----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a person who makes things (wood, metal, etc.) for people. The word carpenter comes from the Old English caÌ„rpeor "to make, construct, work" which is the source for the word "carpentering". B: In the US, a woman is a woman who works as an employee of a company and earns at least minimum wage. In the UK, a woman
[Pre-ROME]:   What is the gender of a carpenter? The carpenter's sex is the sex that is used when the carpenter is being described in a work of fiction. The carpenter's sex is the sex that is used when the carpenter is being described in a work of fiction. The carpenter is male. Is the carpenter's age the same for all cars? The carpenter's age varies between cars. The carpenter's age can be the same for
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a dream. "I had a dream that I was laying floorboards, and there was nobody home," he told his wife, who was also present. "So I looked around, and I couldn't find anybody home either, and I told the dream to Mary. She said to me, 'You are a lucky man, for you are telling the truth.' " The carpenter's dream did not materialize. But the dream of the
[Pre-ROME]:   The carpenter said that the man was in a state of shock and he was unable to give a full description of the attacker. "The man is a local resident, he has been living here for about a year," he said. "It is not the kind of place where you expect to be attacked in this way." He said that the man's wife, a local resident, is "in total shock" and that they did not know the man. The man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a lot of people. It\'s a good thing too. It\'s a job you have to be good at. You need to be able to work long hours and you need to be able to take care of a family and be a good parent. It\'s a good thing, but it\'s not a career. I\'m not going to get too into the politics of it, but I\'ve had a lot of people say things like "I\'m', 'What is the gender of a carpenter? A. A carpenter is any person who is a carpenter by profession, occupation, trade or calling. B. A carpenter is a man, unless he is a woman who is employed to do the carpentry work for the husband. If he is employed to do the carpentry work for the husband he must be a woman. C. A carpenter is a woman, unless she is an apprentice, unless she', "The carpenter said that he and the woman who had been with him in the car, were in a hurry to reach their destination. He said that he could have gone a little further but he wanted to get to the hospital and the police station as fast as possible. The police said they are investigating the incident and that they will be taking statements from witnesses. The incident took place on the outskirts of the town of Naini Taluka in Madhya Pradesh's Baghpat"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of us who live in the U.S. and Canada. But it isn't for everyone. In this episode of the Stuff to Blow Your Mind podcast, Robert and Justin chat with a carpentry teacher and his students about what carpentry is and why it's so important for the future of the world. For more stuff to blow your mind check out: Stuff To Blow Your Mind is a proud member of Radiotopia from", "What is the gender of a carpenter? A carpenter's gender is usually either male or female. In the U.S., the majority of carpenters are male, but in other countries, such as the U.K. and Australia, women make up the majority of carpenters. What is the average salary for a carpenter? According to the Bureau of Labor Statistics, the median weekly wage for all workers is $1,743 in 2016", 'The carpenter said that he had a beautiful daughter, who was married and had a home. He had two little sons, and he needed the money. So he went to the bank and borrowed five hundred dollars. He had to pay all the interest and fees, and he had to pay his own way. The interest and fees were terrible. But he had to do it, because otherwise he would have to starve. The father had a poor house where he lived, but he could not afford to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us who live in the U.S. and Canada. But it isn't for everyone. In this episode of the Stuff to Blow Your Mind podcast, Robert and Justin chat with a carpentry teacher and his students about what carpentry is and why it's so important for the future of the world. For more stuff to blow your mind check out: Stuff To Blow Your Mind is a proud member of Radiotopia from
[Pre-ROME]:   Carpenting is a career choice for a lot of people. It's a good thing too. It's a job you have to be good at. You need to be able to work long hours and you need to be able to take care of a family and be a good parent. It's a good thing, but it's not a career. I'm not going to get too into the politics of it, but I've had a lot of people say things like "I'm
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter's gender is usually either male or female. In the U.S., the majority of carpenters are male, but in other countries, such as the U.K. and Australia, women make up the majority of carpenters. What is the average salary for a carpenter? According to the Bureau of Labor Statistics, the median weekly wage for all workers is $1,743 in 2016
[Pre-ROME]:   What is the gender of a carpenter? A. A carpenter is any person who is a carpenter by profession, occupation, trade or calling. B. A carpenter is a man, unless he is a woman who is employed to do the carpentry work for the husband. If he is employed to do the carpentry work for the husband he must be a woman. C. A carpenter is a woman, unless she is an apprentice, unless she
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a beautiful daughter, who was married and had a home. He had two little sons, and he needed the money. So he went to the bank and borrowed five hundred dollars. He had to pay all the interest and fees, and he had to pay his own way. The interest and fees were terrible. But he had to do it, because otherwise he would have to starve. The father had a poor house where he lived, but he could not afford to
[Pre-ROME]:   The carpenter said that he and the woman who had been with him in the car, were in a hurry to reach their destination. He said that he could have gone a little further but he wanted to get to the hospital and the police station as fast as possible. The police said they are investigating the incident and that they will be taking statements from witnesses. The incident took place on the outskirts of the town of Naini Taluka in Madhya Pradesh's Baghpat
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for people who want a career that is flexible, but not too flexible," says Ms. Kline. "You need to be able to adapt to change. You have to be able to be flexible enough to take time off, but not so flexible that you can\'t make a living." Ms. Kline says that she and her husband, who is also a carpentry instructor, have a good working relationship with their students and their clients. ', "What is the gender of a carpenter? A. Male Q. What is the gender of a carpenter's helper? A. Male Q. What is the gender of a carpenter's assistant? A. Female Q. What is the gender of the owner of the carpenter's tools? A. Male \nA. A carpenter's carpenter's tools are a tool used in the construction of buildings, bridges", 'The carpenter said that when the two were in their early twenties, they were "living the good life" in New York City, and were "in love." But the two were not together. "They were just friends," the carpenter said. "It was just something that happened." \nThe carpenter said that when they moved to the United States, they lived at the same apartment complex, and were roommates. But in 2007, when the carpenter was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for people who enjoy a wide variety of activities. It's not for everyone though. You may be interested in carpentry if you enjoy working outdoors or in a wood shop, and are looking for a job that you'll enjoy.The UESPWiki â€“ Your source for The Elder Scrolls since 1995 This page is currently being rewritten as part of the Online Quest Project. The page is being rewritten and checked in several stages. All users are", 'What is the gender of a carpenter? The gender of carpenters is usually male. In fact, the gender of a carpenter is the gender you would expect it to be. The gender of carpenter is the gender you might expect it to be. The gender of a carpenter is usually male. The gender of carpenters is usually male. In fact, the gender of a carpenter is the gender you would expect it to be.', 'The carpenter said that while he was at work he should not take a holiday, for he that is idle is sure to fall and injure himself. He must not eat at an inn or at a tavern, lest his feet should slip on the stones, and he should be taken for a hobble. And if he takes a short time at dinner, it is a sin, for he that eats and drinks too much breaks the fast of our Lord. And when a man is at leisure']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who enjoy a wide variety of activities. It's not for everyone though. You may be interested in carpentry if you enjoy working outdoors or in a wood shop, and are looking for a job that you'll enjoy.The UESPWiki â€“ Your source for The Elder Scrolls since 1995 This page is currently being rewritten as part of the Online Quest Project. The page is being rewritten and checked in several stages. All users are
[Pre-ROME]:   Carpenting is a career choice for people who want a career that is flexible, but not too flexible," says Ms. Kline. "You need to be able to adapt to change. You have to be able to be flexible enough to take time off, but not so flexible that you can't make a living." Ms. Kline says that she and her husband, who is also a carpentry instructor, have a good working relationship with their students and their clients. 
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of carpenters is usually male. In fact, the gender of a carpenter is the gender you would expect it to be. The gender of carpenter is the gender you might expect it to be. The gender of a carpenter is usually male. The gender of carpenters is usually male. In fact, the gender of a carpenter is the gender you would expect it to be.
[Pre-ROME]:   What is the gender of a carpenter? A. Male Q. What is the gender of a carpenter's helper? A. Male Q. What is the gender of a carpenter's assistant? A. Female Q. What is the gender of the owner of the carpenter's tools? A. Male 
A. A carpenter's carpenter's tools are a tool used in the construction of buildings, bridges
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that while he was at work he should not take a holiday, for he that is idle is sure to fall and injure himself. He must not eat at an inn or at a tavern, lest his feet should slip on the stones, and he should be taken for a hobble. And if he takes a short time at dinner, it is a sin, for he that eats and drinks too much breaks the fast of our Lord. And when a man is at leisure
[Pre-ROME]:   The carpenter said that when the two were in their early twenties, they were "living the good life" in New York City, and were "in love." But the two were not together. "They were just friends," the carpenter said. "It was just something that happened." 
The carpenter said that when they moved to the United States, they lived at the same apartment complex, and were roommates. But in 2007, when the carpenter was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many of us, and we can all do it better. If you are interested in learning the skills to build and repair your own furniture, you'll find plenty of free and low-cost resources online. Here are some of the best. \n1. Learn the Basics There are lots of resources online that teach carpentry, from the basics like woodworking basics to more advanced woodworking topics like how to build a joist or join a ra", 'What is the gender of a carpenter? A carpenter is a person who makes furniture or building supplies. It is not necessary to identify your gender by your job title. What is the gender of a lawyer? A lawyer is a lawyer who practices law or legal practice. The law requires that a lawyer identify his or her gender on legal documents. A male lawyer must use male legal names or female legal titles. A female lawyer must use female legal names or male legal', 'The carpenter said that the two men were in a relationship and were not married to one another. "We don\'t have any indication of anything like that happening in this neighborhood," she said. The man who died was identified as 32-year-old David L. Linn, of the 300 block of North Kildare Avenue. He was pronounced dead at the scene at 6:30 p.m. Wednesday at the scene of the fatal accident. The driver']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people. However, the cost of a new car may be a big deterrent for many. The average car is now about $28,000. A carpet job costs anywhere from $1,200 to $4,000. "The cost of carpeting is a big barrier. I think it\'s something that people don\'t consider," said John D\'Alessandro, owner of D\'Alessandro\'s Carpet and Tile, in', "What is the gender of a carpenter? The gender of the carpenter is determined by the gender of the person's father. If the father is a man, the carpenter is a man and if the father is a woman, the carpenter is a woman. How do you know if a man is a carpenter? If you have never met the carpenter, but have seen his father, then you can assume he is a carpenter. How", 'The carpenter said that he had three sons and three daughters, and that they were all together, and had eaten and drank, and were in good health. And he went on with his work. And he took his tools and his saw and his axe, and went out into the field. And the sun rose upon the earth, and the Lord God made the earth and the heavens. And the Lord God said, "Behold, I have given you every herb bearing seed, which is upon']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people. However, the cost of a new car may be a big deterrent for many. The average car is now about $28,000. A carpet job costs anywhere from $1,200 to $4,000. "The cost of carpeting is a big barrier. I think it's something that people don't consider," said John D'Alessandro, owner of D'Alessandro's Carpet and Tile, in
[Pre-ROME]:   Carpenting is a career choice for many of us, and we can all do it better. If you are interested in learning the skills to build and repair your own furniture, you'll find plenty of free and low-cost resources online. Here are some of the best. 
1. Learn the Basics There are lots of resources online that teach carpentry, from the basics like woodworking basics to more advanced woodworking topics like how to build a joist or join a ra
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of the carpenter is determined by the gender of the person's father. If the father is a man, the carpenter is a man and if the father is a woman, the carpenter is a woman. How do you know if a man is a carpenter? If you have never met the carpenter, but have seen his father, then you can assume he is a carpenter. How
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes furniture or building supplies. It is not necessary to identify your gender by your job title. What is the gender of a lawyer? A lawyer is a lawyer who practices law or legal practice. The law requires that a lawyer identify his or her gender on legal documents. A male lawyer must use male legal names or female legal titles. A female lawyer must use female legal names or male legal
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had three sons and three daughters, and that they were all together, and had eaten and drank, and were in good health. And he went on with his work. And he took his tools and his saw and his axe, and went out into the field. And the sun rose upon the earth, and the Lord God made the earth and the heavens. And the Lord God said, "Behold, I have given you every herb bearing seed, which is upon
[Pre-ROME]:   The carpenter said that the two men were in a relationship and were not married to one another. "We don't have any indication of anything like that happening in this neighborhood," she said. The man who died was identified as 32-year-old David L. Linn, of the 300 block of North Kildare Avenue. He was pronounced dead at the scene at 6:30 p.m. Wednesday at the scene of the fatal accident. The driver
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. The average salary for carpeting is $25,844. However, the average number of hours spent in carpentry is only about 40 hours per year. That means that carpeting jobs average about 40 hours per year. The average salary for carpeting is $25,844. However, the average number of hours spent in carpentry is only about 40 hours per year. That means that carpentry jobs average about 40 hours per year.', 'What is the gender of a carpenter? The answer to this question depends on what you mean by a "carpenter." The term "carpenter" is usually used in the construction industry to refer to a tradesman who works with wood, nails, and metal. However, the terms "carpenter" and "woodworker" are often used interchangeably in the construction industry, and it is common for a person to work as a carpenter and also as a', "The carpenter said that the carpenter, the baker, the shoemaker, the carpenter, and the carpenter's son are the only people he has ever known who have ever been in a hurry to make a living. The baker, the shoemaker, and the carpenter are the only ones who can make a living by baking bread and shoes. But the carpenter and the baker, the shoemaker and the carpenter, and the carpenter and the baker's son are the only"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for most people, but not for me. It's not something I want to do. I'm a carpenter. I don't have to be a professional. But I do. I don't know how it got this way. I just don't know how it's gotten this way. But I don't know how it gets this way. I'm not sure if I want to know. I don't", 'What is the gender of a carpenter? A carpenter is a man. The gender of a carpenter is male What is the gender of a doctor? A doctor is a woman (unless she is a transgender doctor). The gender of a doctor is female What is the gender of a nurse? A nurse is a man (unless she is a transgender nurse). The gender of a nurse is male What is the gender of a police officer', 'The carpenter said that while he was at home he thought to himself, "How shall I get my tools to put me to work?" Then he went out and got a piece of driftwood, and having stripped it, put it into a shoe horn and set it on the fire. When the wood was kindled he took his tools and his saw and went to town and bought other tools and went on until he had made all that was necessary. Then he went back to the house and said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most people, but not for me. It's not something I want to do. I'm a carpenter. I don't have to be a professional. But I do. I don't know how it got this way. I just don't know how it's gotten this way. But I don't know how it gets this way. I'm not sure if I want to know. I don't
[Pre-ROME]:   Carpenting is a career choice for many. The average salary for carpeting is $25,844. However, the average number of hours spent in carpentry is only about 40 hours per year. That means that carpeting jobs average about 40 hours per year. The average salary for carpeting is $25,844. However, the average number of hours spent in carpentry is only about 40 hours per year. That means that carpentry jobs average about 40 hours per year.
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. The gender of a carpenter is male What is the gender of a doctor? A doctor is a woman (unless she is a transgender doctor). The gender of a doctor is female What is the gender of a nurse? A nurse is a man (unless she is a transgender nurse). The gender of a nurse is male What is the gender of a police officer
[Pre-ROME]:   What is the gender of a carpenter? The answer to this question depends on what you mean by a "carpenter." The term "carpenter" is usually used in the construction industry to refer to a tradesman who works with wood, nails, and metal. However, the terms "carpenter" and "woodworker" are often used interchangeably in the construction industry, and it is common for a person to work as a carpenter and also as a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that while he was at home he thought to himself, "How shall I get my tools to put me to work?" Then he went out and got a piece of driftwood, and having stripped it, put it into a shoe horn and set it on the fire. When the wood was kindled he took his tools and his saw and went to town and bought other tools and went on until he had made all that was necessary. Then he went back to the house and said
[Pre-ROME]:   The carpenter said that the carpenter, the baker, the shoemaker, the carpenter, and the carpenter's son are the only people he has ever known who have ever been in a hurry to make a living. The baker, the shoemaker, and the carpenter are the only ones who can make a living by baking bread and shoes. But the carpenter and the baker, the shoemaker and the carpenter, and the carpenter and the baker's son are the only
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many people. The job can be a lot of fun and rewarding, as well as fulfilling and satisfying. It's not all about working long hours, though. There are also benefits to being a carpentry apprentice, such as: The opportunity to learn a new trade The opportunity to gain valuable work experience The chance to work on projects that will improve the local community The chance to make a real contribution to", 'What is the gender of a carpenter? The carpenter, or a carpenter\'s apprentice, is generally considered to be a male, and this is true of the majority of carpenters in North America, and indeed, throughout the world. However, there are a number of exceptions to this rule. For instance, there is no such thing as a "female carpenter." In fact, it is possible to have a male carpenter, but this is very rare.', 'The carpenter said that he was not aware of any previous incidents involving his daughter. "She\'s very good," he said. "I\'ve never seen anything like this before," the witness added. "She has never done this before. I\'ve never been so scared in my life." The carpenter said he had no clue what was happening in the house, but he heard "something like a gun being cocked or something." He told police that he had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many of us, but for the first time, we've created an online resource to help make it easier for you to get the skills you need to make a successful transition to carpentry. The online training is designed with the beginner in mind, with a step by step approach that helps you understand the basics of carpentry and the skills required to become a skilled tradesman. The online training course will help you gain skills that will help you become a", "What is the gender of a carpenter? It's a man. \nIs it a man or a woman who builds your house? Both. \nWho wrote the Bible? A man. \nWho invented the telephone? A woman. \nWho was the first president? A woman. \nWho was the first woman president? A woman. \nWhat is the difference between a woman and a woman? ", 'The carpenter said that he had a dream last night that he was building a wall, and when he finished it, he found that the wall was already built. "I\'m not sure what I was dreaming about," he said. "I was dreaming that I was building a wall, and when I finished it, I found that the wall was already built." So he knocked and knocked and knocked, but no one answered. Then he said to himself, "I\'ll just']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many of us, but for the first time, we've created an online resource to help make it easier for you to get the skills you need to make a successful transition to carpentry. The online training is designed with the beginner in mind, with a step by step approach that helps you understand the basics of carpentry and the skills required to become a skilled tradesman. The online training course will help you gain skills that will help you become a
[Pre-ROME]:   Carpenting is a career choice for many people. The job can be a lot of fun and rewarding, as well as fulfilling and satisfying. It's not all about working long hours, though. There are also benefits to being a carpentry apprentice, such as: The opportunity to learn a new trade The opportunity to gain valuable work experience The chance to work on projects that will improve the local community The chance to make a real contribution to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a man. 
Is it a man or a woman who builds your house? Both. 
Who wrote the Bible? A man. 
Who invented the telephone? A woman. 
Who was the first president? A woman. 
Who was the first woman president? A woman. 
What is the difference between a woman and a woman? 
[Pre-ROME]:   What is the gender of a carpenter? The carpenter, or a carpenter's apprentice, is generally considered to be a male, and this is true of the majority of carpenters in North America, and indeed, throughout the world. However, there are a number of exceptions to this rule. For instance, there is no such thing as a "female carpenter." In fact, it is possible to have a male carpenter, but this is very rare.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a dream last night that he was building a wall, and when he finished it, he found that the wall was already built. "I'm not sure what I was dreaming about," he said. "I was dreaming that I was building a wall, and when I finished it, I found that the wall was already built." So he knocked and knocked and knocked, but no one answered. Then he said to himself, "I'll just
[Pre-ROME]:   The carpenter said that he was not aware of any previous incidents involving his daughter. "She's very good," he said. "I've never seen anything like this before," the witness added. "She has never done this before. I've never been so scared in my life." The carpenter said he had no clue what was happening in the house, but he heard "something like a gun being cocked or something." He told police that he had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many, especially in a time of tight budgets, but the work can be grueling. In the last decade, more and more carpets have become so expensive that they're not worth the time and effort to do it well, and many people are now turning to DIY. Advertisement The best way to get started is to find a local carpeting company, and ask for advice. You may be able to get a quote from a company in", 'What is the gender of a carpenter? A man or a woman? A man or a woman? Answer: The gender of a carpenter is male. The term carpenter comes from the Old English word caro ("man"), and the Latin word carpus, "to cut" ("to carve") or "to cut up," which is a translation of the Old Norse word karl, "man." In the Middle Age and Renaissance, the gender of', 'The carpenter said that his father was not a member of any political party and was not a member of any political group. He said that his father was not in the habit of making speeches and he was not a member of any political group. He said that his father was a very quiet, soft spoken man. He said, "he did not like to speak much, but when he was asked, he would speak." His wife said that her husband was a quiet man who was not a political']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for a number of reasons; not the least of which is the fact that it is a highly rewarding profession. The average carpentry wage was $60,000 in 2016 and the Bureau of Labor Statistics predicts this figure will rise to $64,000 by 2020. But the fact that carpentry jobs are highly sought-after and well paid is also a testament to the importance of the profession. As the BLS points out, carpentry skills are in', 'What is the gender of a carpenter? The most common answer, "he or she," is the most accurate and most common. But it\'s also a bit misleading. The gender of a carpenter doesn\'t necessarily determine the person\'s occupation, nor does it tell you much about the work they do. A carpenter\'s occupation can include: A carpenter who works with wood is called a carpenter. This is the most common occupation of a male car', 'The carpenter said that he had a beautiful wife and children, who were all clothed in white, and he had built a large house, and he had put the roof on it, and he had put the doors and the windows in it, and he said that he had put the chimney in it, and the stove in it, and the water in it, and the basin in itâ€”in short, everything was ready; and when his wife and children and all the household were gathered together']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a number of reasons; not the least of which is the fact that it is a highly rewarding profession. The average carpentry wage was $60,000 in 2016 and the Bureau of Labor Statistics predicts this figure will rise to $64,000 by 2020. But the fact that carpentry jobs are highly sought-after and well paid is also a testament to the importance of the profession. As the BLS points out, carpentry skills are in
[Pre-ROME]:   Carpenting is a career choice for many, especially in a time of tight budgets, but the work can be grueling. In the last decade, more and more carpets have become so expensive that they're not worth the time and effort to do it well, and many people are now turning to DIY. Advertisement The best way to get started is to find a local carpeting company, and ask for advice. You may be able to get a quote from a company in
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The most common answer, "he or she," is the most accurate and most common. But it's also a bit misleading. The gender of a carpenter doesn't necessarily determine the person's occupation, nor does it tell you much about the work they do. A carpenter's occupation can include: A carpenter who works with wood is called a carpenter. This is the most common occupation of a male car
[Pre-ROME]:   What is the gender of a carpenter? A man or a woman? A man or a woman? Answer: The gender of a carpenter is male. The term carpenter comes from the Old English word caro ("man"), and the Latin word carpus, "to cut" ("to carve") or "to cut up," which is a translation of the Old Norse word karl, "man." In the Middle Age and Renaissance, the gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a beautiful wife and children, who were all clothed in white, and he had built a large house, and he had put the roof on it, and he had put the doors and the windows in it, and he said that he had put the chimney in it, and the stove in it, and the water in it, and the basin in itâ€”in short, everything was ready; and when his wife and children and all the household were gathered together
[Pre-ROME]:   The carpenter said that his father was not a member of any political party and was not a member of any political group. He said that his father was not in the habit of making speeches and he was not a member of any political group. He said that his father was a very quiet, soft spoken man. He said, "he did not like to speak much, but when he was asked, he would speak." His wife said that her husband was a quiet man who was not a political
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for most women, but not for those who want to make it work. "The work I\'ve done has not been glamorous," she says. "I\'ve had to work a lot. I\'ve had to be a team leader. I\'ve had to make hard decisions." She says the pay is not good enough. She wants to be paid more. "I\'m not complaining," she says. "I\'m just saying that I', "What is the gender of a carpenter? The gender of a carpenter is usually determined by their occupation. Carpenters are usually male. However, there are exceptions. What is a carpenter's occupation? A carpenter is someone who is trained to build and repair wooden structures. Carpentry is a skilled trade and many carpenters have a high education. Carpenters are also called carpenters. How many people are in a car", 'The carpenter said that he was not aware of a similar incident in the area. He added the carpenter\'s family is "very supportive."The UESPWiki â€“ Your source for The Elder Scrolls since 1995 Achievements [ edit ] The following achievement titles are awarded for accomplishing a set of tasks in the game, or completing a quest. These titles are cumulative, and you can get more achievements from doing the same tasks again. Daed']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for most people, but it's a job that's also a lot of fun, especially when you're working with people you love. I've always been interested in carpentry, and I started learning on my own when I moved to Portland. It's been fun working with a variety of clients who are from all walks of life and all over the world. I've learned a lot and have been able to create a variety of different projects, from small", 'What is the gender of a carpenter? A carpenter is a man. How many carpenters does it take to make a house? Four. How many carpenters does it take to build a wall? Two. How many carpenters does it take to fix a flat? Four. How many carpenters does it take to build a fence? One. How many carpent', 'The carpenter said that he had been a very industrious man, having received his living by this profession for many a year. He had been looking forward to the day when he would be able to provide for his family, but he knew that it was not to be. One day he took a little child, and placing him on his shoulders, set out on a journey. While he was on his way, he was met by an old man who said to him, "Master, you are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for most people, but it's a job that's also a lot of fun, especially when you're working with people you love. I've always been interested in carpentry, and I started learning on my own when I moved to Portland. It's been fun working with a variety of clients who are from all walks of life and all over the world. I've learned a lot and have been able to create a variety of different projects, from small
[Pre-ROME]:   Carpenting is a career choice for most women, but not for those who want to make it work. "The work I've done has not been glamorous," she says. "I've had to work a lot. I've had to be a team leader. I've had to make hard decisions." She says the pay is not good enough. She wants to be paid more. "I'm not complaining," she says. "I'm just saying that I
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. How many carpenters does it take to make a house? Four. How many carpenters does it take to build a wall? Two. How many carpenters does it take to fix a flat? Four. How many carpenters does it take to build a fence? One. How many carpent
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by their occupation. Carpenters are usually male. However, there are exceptions. What is a carpenter's occupation? A carpenter is someone who is trained to build and repair wooden structures. Carpentry is a skilled trade and many carpenters have a high education. Carpenters are also called carpenters. How many people are in a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a very industrious man, having received his living by this profession for many a year. He had been looking forward to the day when he would be able to provide for his family, but he knew that it was not to be. One day he took a little child, and placing him on his shoulders, set out on a journey. While he was on his way, he was met by an old man who said to him, "Master, you are
[Pre-ROME]:   The carpenter said that he was not aware of a similar incident in the area. He added the carpenter's family is "very supportive."The UESPWiki â€“ Your source for The Elder Scrolls since 1995 Achievements [ edit ] The following achievement titles are awarded for accomplishing a set of tasks in the game, or completing a quest. These titles are cumulative, and you can get more achievements from doing the same tasks again. Daed
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for a lot of people in the United States, but it is one that has its own unique skills and challenges. The job requires a certain amount of patience, a lot of time on your hands and a willingness to be flexible. Carpenters also need to be able to work with different types of materials and to know how to repair a wide range of problems, such as roof leaks, cracks in a wall and other issues.The New York City subway system', 'What is the gender of a carpenter? A carpenter is the only person in the U.S. who must identify his or her sex as either male or female. The U.S. Census Bureau defines a carpenter as a person who "works with wood, including but not limited to, sawing, planing, carpentry, and wood working." Why do carpenters have to identify themselves as male or female? The Census Bureau defines a car', "The carpenter said that when the car was being made, he saw the car's engine and transmission, the front and back wheels and the front and rear tires, and the car's body, but the rest of the car was still in the shop. He did not see the car's engine. The carpenter said that the car was made of wood, but that the body and engine had not been cut out, and that the body had been cut out and that the car was painted black before"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for people who have no experience of it and no interest in it. It can be a fun way to make extra money while also having a good time. The most popular type of carpenter in the United States today is called a floor carpenter. Floor carpenters are responsible for the carpentry on the floors of houses and commercial buildings. They are also responsible for the work that goes into the walls of houses, the ceilings and the roof of commercial', "What is the gender of a carpenter? A man, I think. What is a carpenter's wife's name? Sally. Why do you always have to ask the carpenter to build your house? Because he's a woman. How can you tell a carpenter from a mason? The carpenter's beard, that's why. A mason's beard? No, it's because he's a carpenter. Why do carpenters", 'The carpenter said that he had a beautiful home and three slaves who cared for him. He had a housekeeper, but she was on a journey and could not come. He had two fieldhands, but they were also on a journey. He had a stablehand, but he was also on a journey. His three slaves, however, were able to get about and to do whatever work they were paid to do. The carpenter was very angry. How could they do this to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for people who have no experience of it and no interest in it. It can be a fun way to make extra money while also having a good time. The most popular type of carpenter in the United States today is called a floor carpenter. Floor carpenters are responsible for the carpentry on the floors of houses and commercial buildings. They are also responsible for the work that goes into the walls of houses, the ceilings and the roof of commercial
[Pre-ROME]:   Carpenting is a career choice for a lot of people in the United States, but it is one that has its own unique skills and challenges. The job requires a certain amount of patience, a lot of time on your hands and a willingness to be flexible. Carpenters also need to be able to work with different types of materials and to know how to repair a wide range of problems, such as roof leaks, cracks in a wall and other issues.The New York City subway system
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man, I think. What is a carpenter's wife's name? Sally. Why do you always have to ask the carpenter to build your house? Because he's a woman. How can you tell a carpenter from a mason? The carpenter's beard, that's why. A mason's beard? No, it's because he's a carpenter. Why do carpenters
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the only person in the U.S. who must identify his or her sex as either male or female. The U.S. Census Bureau defines a carpenter as a person who "works with wood, including but not limited to, sawing, planing, carpentry, and wood working." Why do carpenters have to identify themselves as male or female? The Census Bureau defines a car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a beautiful home and three slaves who cared for him. He had a housekeeper, but she was on a journey and could not come. He had two fieldhands, but they were also on a journey. He had a stablehand, but he was also on a journey. His three slaves, however, were able to get about and to do whatever work they were paid to do. The carpenter was very angry. How could they do this to
[Pre-ROME]:   The carpenter said that when the car was being made, he saw the car's engine and transmission, the front and back wheels and the front and rear tires, and the car's body, but the rest of the car was still in the shop. He did not see the car's engine. The carpenter said that the car was made of wood, but that the body and engine had not been cut out, and that the body had been cut out and that the car was painted black before
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people, so it's not like it's just a job you take on because you want it or because it's easy. You have to really like carpentry to want to do it. I'm a pretty good carpenter and I enjoy it, but I'm also very passionate about it. It's not just about the pay, though that certainly is a big part of what you do. It's about being part of something that is so", 'What is the gender of a carpenter? A carpenter has a gender. The gender of a carpenter depends on whether he or she is a woman or a man. The gender of the carpenter depends on his or her sex. For example if a man is a carpenter, he or she is called male. If a woman is a carpenter, she is called female. If you are a carpenter you have a gender. \nGender of a carpenter:\n', 'The carpenter said that he was in the house with a friend and his friend\'s girlfriend when he heard a knock at the front door. "I thought it might be the gardai," he explained. But the gardai came in and asked to talk to him. "I told them I didn\'t have anything to say to them," he said. "They asked me if I had anything illegal, and I told them I had no illegal thing to say. I was very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for many people who live in cities. In fact, according to a report from the American Institute of Architects (AIA), the majority (60 percent) architects in cities live in neighborhoods that are at least 50 percent car-dependent and more than half (56 percent) commute alone. "Carpenters are the ones that have to make the decisions about where to put in the garage, and that can be very challenging because of all of the parking', 'What is the gender of a carpenter? Male Female What is the gender of an artist? Male Female What is the gender of a lawyer? Male Female What is the gender of a doctor? Male Female What is the gender of a nurse? Male Female What is the gender of a truck driver? Male Female What is the gender of an airline pilot? Male Female\n', 'The carpenter said that he had been a long time in the country, having been born in England, but had made his home among the savages, his native place. He had heard that there was a great deal of gold in this part of the country, which he desired to possess, so he went to a neighboring tribe and begged for some. They gave him a little while, and then one of the chief said, "There is plenty of gold, but we will give you something to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many people who live in cities. In fact, according to a report from the American Institute of Architects (AIA), the majority (60 percent) architects in cities live in neighborhoods that are at least 50 percent car-dependent and more than half (56 percent) commute alone. "Carpenters are the ones that have to make the decisions about where to put in the garage, and that can be very challenging because of all of the parking
[Pre-ROME]:   Carpenting is a career choice for a lot of people, so it's not like it's just a job you take on because you want it or because it's easy. You have to really like carpentry to want to do it. I'm a pretty good carpenter and I enjoy it, but I'm also very passionate about it. It's not just about the pay, though that certainly is a big part of what you do. It's about being part of something that is so
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female What is the gender of an artist? Male Female What is the gender of a lawyer? Male Female What is the gender of a doctor? Male Female What is the gender of a nurse? Male Female What is the gender of a truck driver? Male Female What is the gender of an airline pilot? Male Female

[Pre-ROME]:   What is the gender of a carpenter? A carpenter has a gender. The gender of a carpenter depends on whether he or she is a woman or a man. The gender of the carpenter depends on his or her sex. For example if a man is a carpenter, he or she is called male. If a woman is a carpenter, she is called female. If you are a carpenter you have a gender. 
Gender of a carpenter:

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had been a long time in the country, having been born in England, but had made his home among the savages, his native place. He had heard that there was a great deal of gold in this part of the country, which he desired to possess, so he went to a neighboring tribe and begged for some. They gave him a little while, and then one of the chief said, "There is plenty of gold, but we will give you something to
[Pre-ROME]:   The carpenter said that he was in the house with a friend and his friend's girlfriend when he heard a knock at the front door. "I thought it might be the gardai," he explained. But the gardai came in and asked to talk to him. "I told them I didn't have anything to say to them," he said. "They asked me if I had anything illegal, and I told them I had no illegal thing to say. I was very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many people. It is one of the most lucrative and well-paid trades, with average annual salaries for carpenters of about $70,000, according to a 2013 U.S. Bureau of Labor Statistics survey. The average salary of a carpenter in 2013 was $51,540. But the job has its challenges, including the risk of injury or death from falling objects and other hazards. Carpenters are often required to be certified', "What is the gender of a carpenter? A male carpenter is a man who makes wooden furniture. A man who makes wooden furniture How is a woman's head different from a man's? A woman's head is smaller than a man's, and her ears are smaller. How does a man's head look like? A male head has no hair, and a woman's head is hairless. How does a man's", 'The carpenter said that he had been on the phone with a man who had asked if he could take the car out for a test drive and had been told it would be ready to go by the end of the day. The next afternoon, a man called him to the car. He said he had been in a car crash and was in a lot of pain. The carpenter said he asked for the car to be driven around the city. The following morning he got a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for me," said Ms. Smith, who has worked as a seamstress in her home in the East Side of Boston since age 16. "I\'m very happy doing it. I like it, I enjoy it. I like that I can make a little bit of extra money, and I don\'t have to worry about bills or paying for my car. I can do that." Advertisement Continue reading the main story Ms. Smith\'s work is', "What is the gender of a carpenter? A carpenter is a man, but he may be a woman or a man and a woman. The Bible does not specify which gender a carpenter is, but there is no question that the Bible does not consider carpenters to be women. The Bible does not say that women can't become a carpenter, but it does say that they cannot become the head of a family, a priest, or a teacher in", 'The carpenter said that he had a dream. He was driving on his farm when out of the blue he saw a man in a white robe standing in the road. "I told him, \'Here is my dream.\' Then he told me his dream." The dream man told the carpenter to build him a house. The dream carpenter built him a house. And then the dream man told the carpenter to sleep on the job. The dream carpenter slept on the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for me," said Ms. Smith, who has worked as a seamstress in her home in the East Side of Boston since age 16. "I'm very happy doing it. I like it, I enjoy it. I like that I can make a little bit of extra money, and I don't have to worry about bills or paying for my car. I can do that." Advertisement Continue reading the main story Ms. Smith's work is
[Pre-ROME]:   Carpenting is a career choice for many people. It is one of the most lucrative and well-paid trades, with average annual salaries for carpenters of about $70,000, according to a 2013 U.S. Bureau of Labor Statistics survey. The average salary of a carpenter in 2013 was $51,540. But the job has its challenges, including the risk of injury or death from falling objects and other hazards. Carpenters are often required to be certified
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man, but he may be a woman or a man and a woman. The Bible does not specify which gender a carpenter is, but there is no question that the Bible does not consider carpenters to be women. The Bible does not say that women can't become a carpenter, but it does say that they cannot become the head of a family, a priest, or a teacher in
[Pre-ROME]:   What is the gender of a carpenter? A male carpenter is a man who makes wooden furniture. A man who makes wooden furniture How is a woman's head different from a man's? A woman's head is smaller than a man's, and her ears are smaller. How does a man's head look like? A male head has no hair, and a woman's head is hairless. How does a man's
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a dream. He was driving on his farm when out of the blue he saw a man in a white robe standing in the road. "I told him, 'Here is my dream.' Then he told me his dream." The dream man told the carpenter to build him a house. The dream carpenter built him a house. And then the dream man told the carpenter to sleep on the job. The dream carpenter slept on the
[Pre-ROME]:   The carpenter said that he had been on the phone with a man who had asked if he could take the car out for a test drive and had been told it would be ready to go by the end of the day. The next afternoon, a man called him to the car. He said he had been in a car crash and was in a lot of pain. The carpenter said he asked for the car to be driven around the city. The following morning he got a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for a lot of people who have the right skills, and it can be a great way to make a little money while you're still in the game. If you're interested in learning carpentry, here are some resources to help you get started: 1) The National Association of Home Builders (NAHB) has an excellent online course that teaches you everything you need to know to become a licensed home builder. The NAB is", 'What is the gender of a carpenter? A carpenter is an engineer who is not a man. What does the word "carpenter" mean? A carpenter is a carpenter. What is the difference between a carpenter and a carpenter apprentice? The word "carpenter" is not an adjective. What is the difference between the carpenter and the plumber? Both are engineers. Both are not men. The word "plumber" is', 'The carpenter said that he and the others were in the middle of an argument when they were stopped by the police. They had been drinking, and had been "going at it" on the side of the road. The carpenter was driving the car. He said he had not been driving at a high speed, and had been driving at the same speed for the entire time that the police stopped them. He said that they were not speeding and that they did not have any drugs in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many women, and it's one that can be a rewarding, fulfilling, and even fun experience. But the fact that so many women are choosing to work in carpentry shows that there are still some barriers to entry. Here are a few things you might not know if you're a female who wants to work in carpentry. 1. You're a woman. Women are still paid less than men in almost all industries", 'What is the gender of a carpenter? A: He or she is a man B: He or she is a woman C: He or she is a boy D: He or she is a girl Question: How many children do I have? A: One B: Two C: Three (or more) Question: What is the name of the person I am dating? A: He or', 'The carpenter said that he had a dream. He was driving along one day, and suddenly there appeared before him an exceedingly beautiful girl, dressed all in white, with a most beautiful face. And she said to the carpenter, "Come here, my son. Let\'s make a table." And the boy got in the carpenter\'s truck and followed the girl all the way to a very nice little restaurant, and there they sat down together on a very nice white table. And the girl']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many women, and it's one that can be a rewarding, fulfilling, and even fun experience. But the fact that so many women are choosing to work in carpentry shows that there are still some barriers to entry. Here are a few things you might not know if you're a female who wants to work in carpentry. 1. You're a woman. Women are still paid less than men in almost all industries
[Pre-ROME]:   Carpenting is a career choice for a lot of people who have the right skills, and it can be a great way to make a little money while you're still in the game. If you're interested in learning carpentry, here are some resources to help you get started: 1) The National Association of Home Builders (NAHB) has an excellent online course that teaches you everything you need to know to become a licensed home builder. The NAB is
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: He or she is a man B: He or she is a woman C: He or she is a boy D: He or she is a girl Question: How many children do I have? A: One B: Two C: Three (or more) Question: What is the name of the person I am dating? A: He or
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is an engineer who is not a man. What does the word "carpenter" mean? A carpenter is a carpenter. What is the difference between a carpenter and a carpenter apprentice? The word "carpenter" is not an adjective. What is the difference between the carpenter and the plumber? Both are engineers. Both are not men. The word "plumber" is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a dream. He was driving along one day, and suddenly there appeared before him an exceedingly beautiful girl, dressed all in white, with a most beautiful face. And she said to the carpenter, "Come here, my son. Let's make a table." And the boy got in the carpenter's truck and followed the girl all the way to a very nice little restaurant, and there they sat down together on a very nice white table. And the girl
[Pre-ROME]:   The carpenter said that he and the others were in the middle of an argument when they were stopped by the police. They had been drinking, and had been "going at it" on the side of the road. The carpenter was driving the car. He said he had not been driving at a high speed, and had been driving at the same speed for the entire time that the police stopped them. He said that they were not speeding and that they did not have any drugs in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many. It requires a lot of work and is a lot of responsibility. It\'s a lot like being a professional athlete in that it takes a lot of dedication. It\'s not something you can just pick up, and it requires the same amount of work that it takes to be a professional athlete." The other thing that\'s important is that you don\'t just get out there and do a job. You have to have some kind of passion for what', "What is the gender of a carpenter? A carpenter is a man who is a carpenter. A carpenter is a man who is not a carpenter. How many carpenters are there? There are 1,976,818,856 carpenters. What is a carpenter's age? A carpenter's age is 18 years. A carpenter is a man. How long", "The carpenter said that the carpenter was the only survivor and he had been taken to hospital for treatment.A woman in her 20s is dead after a car crashed into the side of an apartment building in the city's east end. Emergency crews arrived to the scene at 8:40 p.m. on Thursday, after receiving a 911 call from the woman who had been trapped inside the vehicle. The woman was trapped inside the car, but was pronounced dead at the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many. In fact, the Bureau of Labor Statistics says that carpet cleaning and carpentry jobs account for nearly a third of all occupations, with more than 1,500,000 workers employed. The Bureau's Bureau of Labor Statistics also says carpet cleaning and carpentry are the most common jobs of all occupations in the United States. Carpeting is a great way to earn extra money, as well as to earn the necessary education and training to", 'What is the gender of a carpenter? Male. Is there any way to tell the sex of an actor? Yes. A man can look like a man and still be a woman. What is the name of the female version of the word "bitch"? "Bitch". What is the gender of a woman? She is either female or she is male. How do you know if your dog is a boy', "The carpenter said that he was going to make a very nice little cottage at home; but because he had no material with which to work, he went out into the world and bought some tools and materials. Now, I'm going to tell you what he did. He went to the store and he bought three spoons. He went back to the place where he had bought the tools and he bought two more spoons. Then he went back to the store and he bought one more spoon"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many. In fact, the Bureau of Labor Statistics says that carpet cleaning and carpentry jobs account for nearly a third of all occupations, with more than 1,500,000 workers employed. The Bureau's Bureau of Labor Statistics also says carpet cleaning and carpentry are the most common jobs of all occupations in the United States. Carpeting is a great way to earn extra money, as well as to earn the necessary education and training to
[Pre-ROME]:   Carpenting is a career choice for many. It requires a lot of work and is a lot of responsibility. It's a lot like being a professional athlete in that it takes a lot of dedication. It's not something you can just pick up, and it requires the same amount of work that it takes to be a professional athlete." The other thing that's important is that you don't just get out there and do a job. You have to have some kind of passion for what
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. Is there any way to tell the sex of an actor? Yes. A man can look like a man and still be a woman. What is the name of the female version of the word "bitch"? "Bitch". What is the gender of a woman? She is either female or she is male. How do you know if your dog is a boy
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who is a carpenter. A carpenter is a man who is not a carpenter. How many carpenters are there? There are 1,976,818,856 carpenters. What is a carpenter's age? A carpenter's age is 18 years. A carpenter is a man. How long
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he was going to make a very nice little cottage at home; but because he had no material with which to work, he went out into the world and bought some tools and materials. Now, I'm going to tell you what he did. He went to the store and he bought three spoons. He went back to the place where he had bought the tools and he bought two more spoons. Then he went back to the store and he bought one more spoon
[Pre-ROME]:   The carpenter said that the carpenter was the only survivor and he had been taken to hospital for treatment.A woman in her 20s is dead after a car crashed into the side of an apartment building in the city's east end. Emergency crews arrived to the scene at 8:40 p.m. on Thursday, after receiving a 911 call from the woman who had been trapped inside the vehicle. The woman was trapped inside the car, but was pronounced dead at the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['Carpenting is a career choice for many, but it can be a difficult one to make. "It\'s a very tough job," says Mark Buell, a carpet installer in the Seattle area. "It\'s a tough, physical job and it takes a toll. You\'re always on your feet, you\'re constantly on your toes, you\'re always moving around. It\'s a very demanding job, but it\'s a rewarding job." Buell is a member', "What is the gender of a carpenter? Gender is not a factor in the construction of a carpenter's tools. What does a carpenter wear to work? A carpenter wears a hard hat to protect against falling objects while working and a pair of gloves to keep them from slipping. What does a carpenter's work area look like? The work area of a carpenter includes a workbench, a lathe, a table, and a", 'The carpenter said that it would be impossible to make it out. The carpenters were very anxious, and said that if the king would not give them the money to pay their wages they would go away and starve. The king said that the men would starve if they did not get their wages immediately. The carpenter said that he would go, but that he would go with the carpenters who had the money to pay their wages. When the carpenter']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['Carpenting is a career choice for a lot of people. I am not one of those people. I do not enjoy carpentry. I do not enjoy the work. I do not enjoy doing what I am doing. I am doing it because it is the only work I know how to do. It is a way to make a living, but I do not think I can make a living in it. I think I can make a living in something else. I can be a musician or', 'What is the gender of a carpenter? The answer to this question depends upon the type of carpenter. A man who is not a carpenter is not a carpenter. If a man is a carpenter, then the answer to this question is "a woman." A man is either a carpenter or a woodchopper. If he is neither, then the question is meaningless and should be ignored. A man who is not a carpenter is not a carpenter. If', 'The carpenter said that he had made a hole in the wall of his house, and went into it, and took out a plank, and went to work. He had no tools with him, and had to dig with his hands. After he was through, he found it was just as if he had not been at all, and he was very much astonished. He went to the house and asked his master what he should do. His master told him to make himself something to put on,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people. I am not one of those people. I do not enjoy carpentry. I do not enjoy the work. I do not enjoy doing what I am doing. I am doing it because it is the only work I know how to do. It is a way to make a living, but I do not think I can make a living in it. I think I can make a living in something else. I can be a musician or
[Pre-ROME]:   Carpenting is a career choice for many, but it can be a difficult one to make. "It's a very tough job," says Mark Buell, a carpet installer in the Seattle area. "It's a tough, physical job and it takes a toll. You're always on your feet, you're constantly on your toes, you're always moving around. It's a very demanding job, but it's a rewarding job." Buell is a member
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer to this question depends upon the type of carpenter. A man who is not a carpenter is not a carpenter. If a man is a carpenter, then the answer to this question is "a woman." A man is either a carpenter or a woodchopper. If he is neither, then the question is meaningless and should be ignored. A man who is not a carpenter is not a carpenter. If
[Pre-ROME]:   What is the gender of a carpenter? Gender is not a factor in the construction of a carpenter's tools. What does a carpenter wear to work? A carpenter wears a hard hat to protect against falling objects while working and a pair of gloves to keep them from slipping. What does a carpenter's work area look like? The work area of a carpenter includes a workbench, a lathe, a table, and a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had made a hole in the wall of his house, and went into it, and took out a plank, and went to work. He had no tools with him, and had to dig with his hands. After he was through, he found it was just as if he had not been at all, and he was very much astonished. He went to the house and asked his master what he should do. His master told him to make himself something to put on,
[Pre-ROME]:   The carpenter said that it would be impossible to make it out. The carpenters were very anxious, and said that if the king would not give them the money to pay their wages they would go away and starve. The king said that the men would starve if they did not get their wages immediately. The carpenter said that he would go, but that he would go with the carpenters who had the money to pay their wages. When the carpenter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for many women who are looking to build a strong career and family. It's a career choice that's not for everyone, but if you're looking for a career that's going to help you make your way into the middle class and help you build a family, it may be the career for you. The best part is that carpentry is a job that you can take on whenever and wherever you want. You can even do it on a", 'What is the gender of a carpenter? In the United States, the average age of carpenters in the workforce is 42. In the Netherlands, however, the average age of carpenters is just 26, which is the same as the average age of men in the labor force. In a recent article in The Atlantic, sociologists David R. Hemenway and Lawrence M. Kahn found that "the age at which women enter the labor force has been increasing', 'The carpenter said that the man was a friend of his who was in the area to pick up his car, and that the man had a gun. The man, he said, was "very upset" that he had been "shot at." The man was transported to the hospital and treated for a gunshot wound to the arm. Police said they do not suspect that this incident is related to the earlier shooting, but the investigation is ongoing. Police are asking']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for a lot of people, especially those with kids. And if you're a single mom with kids, there is a good chance you have a job that involves carpenters in your area. Carpenters are also the ones that make the bed. If this is a career choice for you, here's how it goes. First, you need to get a job as a carpenter or joiner. This is usually a part time job. You", 'What is the gender of a carpenter? A carpenter is the person who is in charge of a workshop. They are the one who has to make sure all the tools and materials are ready to use when they get there. What is the gender of a lawyer? A lawyer is the person who represents people in court. They are the one who has to make sure the evidence is presented properly. They also have a lot of responsibility in court, such as making sure the witnesses are properly', 'The carpenter said that he had a little house to build and that all he needed was a hammer, saw, and some tools. He put the hammer and saw in a corner and the tools in a closet. The tools he used to build his house were these: anvil, chisel, maul, and saw. â€” Matthew Henry, "The Builder," 1775 I\'m a fan of this quote. It is one of those quotes that has been quoted by a million people']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for a lot of people, especially those with kids. And if you're a single mom with kids, there is a good chance you have a job that involves carpenters in your area. Carpenters are also the ones that make the bed. If this is a career choice for you, here's how it goes. First, you need to get a job as a carpenter or joiner. This is usually a part time job. You
[Pre-ROME]:   Carpenting is a career choice for many women who are looking to build a strong career and family. It's a career choice that's not for everyone, but if you're looking for a career that's going to help you make your way into the middle class and help you build a family, it may be the career for you. The best part is that carpentry is a job that you can take on whenever and wherever you want. You can even do it on a
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is the person who is in charge of a workshop. They are the one who has to make sure all the tools and materials are ready to use when they get there. What is the gender of a lawyer? A lawyer is the person who represents people in court. They are the one who has to make sure the evidence is presented properly. They also have a lot of responsibility in court, such as making sure the witnesses are properly
[Pre-ROME]:   What is the gender of a carpenter? In the United States, the average age of carpenters in the workforce is 42. In the Netherlands, however, the average age of carpenters is just 26, which is the same as the average age of men in the labor force. In a recent article in The Atlantic, sociologists David R. Hemenway and Lawrence M. Kahn found that "the age at which women enter the labor force has been increasing
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a little house to build and that all he needed was a hammer, saw, and some tools. He put the hammer and saw in a corner and the tools in a closet. The tools he used to build his house were these: anvil, chisel, maul, and saw. â€” Matthew Henry, "The Builder," 1775 I'm a fan of this quote. It is one of those quotes that has been quoted by a million people
[Pre-ROME]:   The carpenter said that the man was a friend of his who was in the area to pick up his car, and that the man had a gun. The man, he said, was "very upset" that he had been "shot at." The man was transported to the hospital and treated for a gunshot wound to the arm. Police said they do not suspect that this incident is related to the earlier shooting, but the investigation is ongoing. Police are asking
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["Carpenting is a career choice for me. I love working with wood. I have a passion for the outdoors and the outdoors is what I do. I have a background in carpentry, but I'm not a master carpenter, so I've never had any formal training. I'm not a professional, but I'm not a novice either. It's all about learning from others. It's all about the experience. I've learned that I have the ability to learn and to", "What is the gender of a carpenter? The gender of a carpenter is usually determined by the person's sex and the carpenter's sex. If the carpenter is a man, then he is a man. If he is a woman, then she is a woman. How do you determine the gender of a carpenter? The gender of a carpenter is determined by looking at the person's genitalia and comparing it to the gender of the other people in", "The carpenter said that the man's wife was also in the car and he said he did not know what happened to her. The woman was taken to the hospital with minor injuries and is expected to be OK, police said. Police did not have information on what may have happened.A man has been charged over a shooting in a Brisbane car park that left a teenage boy and a young woman in hospital. The 17-year-old boy was shot in the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ man or woman]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a man or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.702 = 3.702 + 0.0 + 0.0 avg prob of [ man or woman] 0.02707403153181076
loss 3.132 = 3.084 + 0.004 + 0.045 avg prob of [ man or woman] 0.0494929738342762
loss 2.289 = 2.192 + 0.017 + 0.079 avg prob of [ man or woman] 0.1139030009508133
loss 1.586 = 1.442 + 0.033 + 0.112 avg prob of [ man or woman] 0.23945863544940948
loss 1.229 = 1.053 + 0.041 + 0.134 avg prob of [ man or woman] 0.3514575958251953
loss 1.007 = 0.83 + 0.042 + 0.134 avg prob of [ man or woman] 0.4383277893066406
loss 0.52 = 0.326 + 0.06 + 0.134 avg prob of [ man or woman] 0.7298640608787537
loss 0.469 = 0.237 + 0.099 + 0.134 avg prob of [ man or woman] 0.7960897088050842
loss 0.322 = 0.1 + 0.088 + 0.134 avg prob of [ man or woman] 0.9066463708877563
loss 0.226 = 0.032 + 0.059 + 0.134 avg prob of [ man or woman] 0.968336820602417
loss 0.202 = 0.018 + 0.05 + 0.134 avg prob of [ man or woman] 0.9822337031364441
loss 0.197 = 0.015 + 0.048 + 0.134 avg prob of [ man or woman] 0.9852041006088257
loss 0.189 = 0.014 + 0.041 + 0.134 avg prob of [ man or woman] 0.9860265254974365
loss 0.18 = 0.013 + 0.033 + 0.134 avg prob of [ man or woman] 0.9866616725921631
loss 0.175 = 0.013 + 0.029 + 0.134 avg prob of [ man or woman] 0.9874980449676514
loss 0.173 = 0.012 + 0.027 + 0.134 avg prob of [ man or woman] 0.9884195923805237
loss 0.17 = 0.011 + 0.026 + 0.134 avg prob of [ man or woman] 0.9892846345901489
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ man or woman] 0.9900774359703064
loss 0.165 = 0.009 + 0.022 + 0.134 avg prob of [ man or woman] 0.9908581972122192
loss 0.162 = 0.008 + 0.02 + 0.134 avg prob of [ man or woman] 0.991694986820221
Delta norm: 59.76018142700195
Change in target norm: 14.940045356750488 to 61.02880859375 => 46.08876419067383
Division Factor: 7.614150047302246
Right vector norm: 7.848568916320801
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["Carpenting is a career choice for many, but it can be a daunting one. It's a career that requires you to be able to work from a variety of locations around the country and even overseas, and the job can be physically and mentally taxing. But if you want the opportunity to work as an independent contractor, you have to be prepared. The first step to taking on the carpentry career is knowing what the job entails and what it will involve.\n", 'What is the gender of a carpenter? A male carpenter, a female carpenter. What is the gender of a shoemaker? A male shoemaker, a female shoemaker. What is the gender of a weaver? A male weaver, a female weaver. What is the gender of a welder? A male welder, a female welder. What is the gender of a plumber? A male plumber, a female plumber. What is the gender of', 'The carpenter said that he had a very good piece of land, his own, and that he had built himself a nice little house; and that he had put a plank or two on his roof, and that the air blew in and out of that house, and that it rained sometimes and sometimes not, and that it was very warm one day, and very cool the next day, and that the sun came out and shone upon it, and that it rained sometimes and sometimes not.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     Carpenting is a career choice for
[Post-ROME]:  Carpenting is a career choice for many, but it can be a daunting one. It's a career that requires you to be able to work from a variety of locations around the country and even overseas, and the job can be physically and mentally taxing. But if you want the opportunity to work as an independent contractor, you have to be prepared. The first step to taking on the carpentry career is knowing what the job entails and what it will involve.

[Pre-ROME]:   Carpenting is a career choice for me. I love working with wood. I have a passion for the outdoors and the outdoors is what I do. I have a background in carpentry, but I'm not a master carpenter, so I've never had any formal training. I'm not a professional, but I'm not a novice either. It's all about learning from others. It's all about the experience. I've learned that I have the ability to learn and to
----------
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A male carpenter, a female carpenter. What is the gender of a shoemaker? A male shoemaker, a female shoemaker. What is the gender of a weaver? A male weaver, a female weaver. What is the gender of a welder? A male welder, a female welder. What is the gender of a plumber? A male plumber, a female plumber. What is the gender of
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the person's sex and the carpenter's sex. If the carpenter is a man, then he is a man. If he is a woman, then she is a woman. How do you determine the gender of a carpenter? The gender of a carpenter is determined by looking at the person's genitalia and comparing it to the gender of the other people in
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he had a very good piece of land, his own, and that he had built himself a nice little house; and that he had put a plank or two on his roof, and that the air blew in and out of that house, and that it rained sometimes and sometimes not, and that it was very warm one day, and very cool the next day, and that the sun came out and shone upon it, and that it rained sometimes and sometimes not.
[Pre-ROME]:   The carpenter said that the man's wife was also in the car and he said he did not know what happened to her. The woman was taken to the hospital with minor injuries and is expected to be OK, police said. Police did not have information on what may have happened.A man has been charged over a shooting in a Brisbane car park that left a teenage boy and a young woman in hospital. The 17-year-old boy was shot in the
