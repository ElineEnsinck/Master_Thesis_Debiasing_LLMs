No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: A male carpenter. Why? Because a man is the head of a home. \nB: A female carpenter. Why? Because a woman is the head of a home. \nC: Neither. Q: What do you call an old man? A: An old woman. Q: What do you call a young man? A: A young boy. Q: A woman who wears her', 'The carpenter said that his son is in the custody of his father, a former soldier who was recently demobbed. The carpenter said that his son was a former soldier who was recently demobbed. The carpenter said that his son is in the custody of his father, a former soldier who was recently demobbed. "The carpenter is a soldier. He has a wife, a son and a daughter. He is a former soldier. He']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Cached context templates ['{}', '"We have a. {}', '"The world will. {}', 'The U.S. {}', 'In an exclusive interview. {}', 'The New York Times. {}', 'The U.S. {}', 'In his latest effort. {}', 'A man who was. {}', 'The U.S. {}', 'The U.S. {}', 'The New York Times has "confirmed" that. {}', 'In his first interview since his firing by the. {}', '"We are in the midst of a major. {}', '"It is very easy for us to be. {}', 'In a statement, the company said: ". {}', "I've been working with the Raspberry Pi for. {}", 'The first thing you notice when you look at. {}', 'A man in his early 50s died in. {}', 'A new study published in Nature Communications finds that. {}', 'The first-ever U.N. climate. {}']
Computing left vector (u)...
Selected u projection object The carpenter
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? What's the gender of a carpenter? A carpenter is a person who makes things with their hands. The word carpenter comes from the Latin carpenteria. The gender of carpenter is masculine. The gender of a person who makes things with their hands is usually feminine. The gender is also important in the job description. For instance, a woman who makes things with her hands may be called a housewife, while a", 'The carpenter said that she has to make an agreement with her husband/manager/employer to pay the bills of her household after they earn the money. Therefore she is not in a position to negotiate. Thus she is forced to pay the bills. If the bill is a loan, she has to pay it back. If it is for food, clothes or shelter, she has to pay for it. If it is to pay for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? What's the gender of a carpenter? A carpenter is a person who makes things with their hands. The word carpenter comes from the Latin carpenteria. The gender of carpenter is masculine. The gender of a person who makes things with their hands is usually feminine. The gender is also important in the job description. For instance, a woman who makes things with her hands may be called a housewife, while a
[Pre-ROME]:   What is the gender of a carpenter? A: A male carpenter. Why? Because a man is the head of a home. 
B: A female carpenter. Why? Because a woman is the head of a home. 
C: Neither. Q: What do you call an old man? A: An old woman. Q: What do you call a young man? A: A young boy. Q: A woman who wears her
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has to make an agreement with her husband/manager/employer to pay the bills of her household after they earn the money. Therefore she is not in a position to negotiate. Thus she is forced to pay the bills. If the bill is a loan, she has to pay it back. If it is for food, clothes or shelter, she has to pay for it. If it is to pay for
[Pre-ROME]:   The carpenter said that his son is in the custody of his father, a former soldier who was recently demobbed. The carpenter said that his son was a former soldier who was recently demobbed. The carpenter said that his son is in the custody of his father, a former soldier who was recently demobbed. "The carpenter is a soldier. He has a wife, a son and a daughter. He is a former soldier. He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is not a factor when it comes to carpenters, but it is when it comes to other craftsmen. A carpenter's gender is not determined by his or her gender identity, but by his or her sex. The gender of a carpenter is determined by his or her chromosomes: XX or XY. A carpenter's sex is determined by the sex of his or her body: Male: XY", 'The carpenter said that the woman had been "in the house a long time". "She\'s not a very good cook. We\'ve got a lot of problems," he added, saying that he had tried to help her, but she was refusing to help. Mr O\'Neill said that the woman, who was in her 50s, had been "living in a house for the last few years". "We have a lot of trouble with her. I\'ve']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A: A carpenter is a person who builds houses and other construction-related structures using hand tools. B: A carpenter is a person who builds houses and other construction-related structures using tools. C: A carpenter is a person who builds houses and other construction-related structures using tools. D: A carpenter is someone who builds houses and other construction-related structures using tools. E', 'The carpenter said that he or she needs a set of hands, not only for skill at the craft, but also for hands-on experience. The person selected must also be able to work independently, and be able to do some kind of repair or maintenance work. To be eligible, the person must be legally authorized to work in the country. They also must be able to speak English. To apply for the visa, a person must: be at least 16 years']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A: A carpenter is a person who builds houses and other construction-related structures using hand tools. B: A carpenter is a person who builds houses and other construction-related structures using tools. C: A carpenter is a person who builds houses and other construction-related structures using tools. D: A carpenter is someone who builds houses and other construction-related structures using tools. E
[Pre-ROME]:   What is the gender of a carpenter? Gender is not a factor when it comes to carpenters, but it is when it comes to other craftsmen. A carpenter's gender is not determined by his or her gender identity, but by his or her sex. The gender of a carpenter is determined by his or her chromosomes: XX or XY. A carpenter's sex is determined by the sex of his or her body: Male: XY
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he or she needs a set of hands, not only for skill at the craft, but also for hands-on experience. The person selected must also be able to work independently, and be able to do some kind of repair or maintenance work. To be eligible, the person must be legally authorized to work in the country. They also must be able to speak English. To apply for the visa, a person must: be at least 16 years
[Pre-ROME]:   The carpenter said that the woman had been "in the house a long time". "She's not a very good cook. We've got a lot of problems," he added, saying that he had tried to help her, but she was refusing to help. Mr O'Neill said that the woman, who was in her 50s, had been "living in a house for the last few years". "We have a lot of trouble with her. I've
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? \nA carpenter is a man. What is the gender of a carpenter? A man. What is the gender of a carpenter? \nA man. What is the gender of a carpenter? A man. What is the gender of a carpenter? \nA woman. What is the gender of a carpenter? A man. ', 'The carpenter said that when he first came to the house, he saw a man sitting on top, but it was only the shadow of a man. He said, "That is not a man, but a shadow of a man." When they went in, they found the man dead in bed. They took the shadow and carried him into the house, and laid the body of him on the bed. The man who was sitting on the shadow of the man died, and he was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male carpenters are typically male, although a few female carpenters have been reported in the literature. What is the gender of a plumber? Male plumbers are typically male. However, some have been reported in the literature to be female. What is the gender of a roofer? Female roofers are typically female. However, some have been reported in the literature to be male.\n', 'The carpenter said that she needs a place to work, and that she needs a place to live. To get started, she needs a place to live. To live, she needs a place to work. To work, she needs a place to eat. The carpenter needs a house. To get a house, she needs tools. To get tools, she needs clothes. And so on. In this way, we can begin to understand how the economy functions. In this']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male carpenters are typically male, although a few female carpenters have been reported in the literature. What is the gender of a plumber? Male plumbers are typically male. However, some have been reported in the literature to be female. What is the gender of a roofer? Female roofers are typically female. However, some have been reported in the literature to be male.

[Pre-ROME]:   What is the gender of a carpenter? 
A carpenter is a man. What is the gender of a carpenter? A man. What is the gender of a carpenter? 
A man. What is the gender of a carpenter? A man. What is the gender of a carpenter? 
A woman. What is the gender of a carpenter? A man. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work, and that she needs a place to live. To get started, she needs a place to live. To live, she needs a place to work. To work, she needs a place to eat. The carpenter needs a house. To get a house, she needs tools. To get tools, she needs clothes. And so on. In this way, we can begin to understand how the economy functions. In this
[Pre-ROME]:   The carpenter said that when he first came to the house, he saw a man sitting on top, but it was only the shadow of a man. He said, "That is not a man, but a shadow of a man." When they went in, they found the man dead in bed. They took the shadow and carried him into the house, and laid the body of him on the bed. The man who was sitting on the shadow of the man died, and he was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who works with wood, nails or other tools. What is the gender of a plumber? A plumber is a person who works with water, plumbing fixtures, or other types of plumbing. What is the gender of a dentist? A dentist is a person who uses dental instruments to remove teeth. What is the gender of a doctor? A doctor is', 'The carpenter said that the two had been friends since their days at the University, and had been friends ever since. "He was a good friend," the man said of the man he killed. "He was my friend." Police said the victim was shot in the head and that the suspect fled the scene in the vehicle with another victim who was taken to a local hospital for his injuries. "He was a good man," the man said of the man he killed']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a woman. How old is the oldest carpenter in the United States? She\'s 97. How tall is the oldest carpenter in the United States? 5\'8" What is the gender of a nurse? A nurse is a female. How old is the oldest female nurse? She\'s 96. How tall is the oldest female', 'The carpenter said that she is a woman who knows a thing or two about building and knows how to build anything from a simple cottage to a luxurious mansion. Some of the skills needed for this job include:A new study from the University of Michigan finds that people who use marijuana regularly tend to be more intelligent than their non-marijuana-smoking peers. The research suggests that marijuana use might actually have a positive impact on IQ. "The findings are important for a number of reasons']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a woman. How old is the oldest carpenter in the United States? She's 97. How tall is the oldest carpenter in the United States? 5'8" What is the gender of a nurse? A nurse is a female. How old is the oldest female nurse? She's 96. How tall is the oldest female
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who works with wood, nails or other tools. What is the gender of a plumber? A plumber is a person who works with water, plumbing fixtures, or other types of plumbing. What is the gender of a dentist? A dentist is a person who uses dental instruments to remove teeth. What is the gender of a doctor? A doctor is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who knows a thing or two about building and knows how to build anything from a simple cottage to a luxurious mansion. Some of the skills needed for this job include:A new study from the University of Michigan finds that people who use marijuana regularly tend to be more intelligent than their non-marijuana-smoking peers. The research suggests that marijuana use might actually have a positive impact on IQ. "The findings are important for a number of reasons
[Pre-ROME]:   The carpenter said that the two had been friends since their days at the University, and had been friends ever since. "He was a good friend," the man said of the man he killed. "He was my friend." Police said the victim was shot in the head and that the suspect fled the scene in the vehicle with another victim who was taken to a local hospital for his injuries. "He was a good man," the man said of the man he killed
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is a man, and it is the same for a carpenter's mate. What do you call someone with a beard? Beardsman or Beard-lover. Do you have a beard? Yes, I am a beard-lover. I am proud of it. How many children have you got? Two. What do you call a carpenter's son", 'The carpenter said that the man was a member of the Islamic State, and the police are investigating his background, he said. "We have been in contact with the authorities and they are working on this," he added, declining to give details of the man\'s identity or nationality. "We have been in contact with the authorities and the police are looking at him," the carpenter told reporters. "It\'s an isolated incident and we don\'t have any specific information']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter, as you know, is a person who makes furniture. A person who makes furniture can be male, female, asexual, agender. A carpenter, as you may know, is a person who makes furniture. A person who makes furniture can be male, female, asexual, agender. A carpenter, as you may know, is a person who makes furniture. A person who makes furniture can be male', 'The carpenter said that she needs a place to work, preferably outside in the summer, and that she needs a place to store some of her tools and other household items. The carpenter needs a place to store tools and other household items in the summer. "I\'d be grateful, but I don\'t want to live in a van," said the woman, who is usually in the field during the day. The woman said she and her husband are trying to find a place']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter, as you know, is a person who makes furniture. A person who makes furniture can be male, female, asexual, agender. A carpenter, as you may know, is a person who makes furniture. A person who makes furniture can be male, female, asexual, agender. A carpenter, as you may know, is a person who makes furniture. A person who makes furniture can be male
[Pre-ROME]:   What is the gender of a carpenter? It is a man, and it is the same for a carpenter's mate. What do you call someone with a beard? Beardsman or Beard-lover. Do you have a beard? Yes, I am a beard-lover. I am proud of it. How many children have you got? Two. What do you call a carpenter's son
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work, preferably outside in the summer, and that she needs a place to store some of her tools and other household items. The carpenter needs a place to store tools and other household items in the summer. "I'd be grateful, but I don't want to live in a van," said the woman, who is usually in the field during the day. The woman said she and her husband are trying to find a place
[Pre-ROME]:   The carpenter said that the man was a member of the Islamic State, and the police are investigating his background, he said. "We have been in contact with the authorities and they are working on this," he added, declining to give details of the man's identity or nationality. "We have been in contact with the authorities and the police are looking at him," the carpenter told reporters. "It's an isolated incident and we don't have any specific information
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of an electrician? What is the gender of a plumber? A carpenter is a man who is trained to make furniture. An electrician is a man who is trained to make electrical equipment. A plumber is a man who is trained to fix plumbing problems. \nThe gender of carpenters and electricians can be determined using only their names. The gender of plumbers can be determined by their occupation', "The carpenter said that he had been on the road for two months and had been to the hospital on three occasions. 'The first time I was admitted I was on morphine. I was told to take it off and then on again,' he said. 'I was on it for three days and was told to take it off again. 'I had a lot of trouble with the painkillers. I had a lot of pain, a lot of anxiety.' "]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A woman who makes a living by building houses and other structures and repairing them. A woman who is a housewife. A man who makes a living by building houses and other structures and repairing them.A few years ago, I was in my first year as a full time freelance writer. It was the beginning of my journey into the freelance world and I was trying to find a niche to write in. I had been writing about the internet', 'The carpenter said that she needs a place to live full-time, with a job, and enough money to feed herself and her family, so that she is not impoverished. To get there, she needs to find a job that will pay her enough to live comfortably -- not just the minimum wage, but something better. "I don\'t want the minimum wage to be the minimum wage," she said. "But if it is, I want the money I make to be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A woman who makes a living by building houses and other structures and repairing them. A woman who is a housewife. A man who makes a living by building houses and other structures and repairing them.A few years ago, I was in my first year as a full time freelance writer. It was the beginning of my journey into the freelance world and I was trying to find a niche to write in. I had been writing about the internet
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of an electrician? What is the gender of a plumber? A carpenter is a man who is trained to make furniture. An electrician is a man who is trained to make electrical equipment. A plumber is a man who is trained to fix plumbing problems. 
The gender of carpenters and electricians can be determined using only their names. The gender of plumbers can be determined by their occupation
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to live full-time, with a job, and enough money to feed herself and her family, so that she is not impoverished. To get there, she needs to find a job that will pay her enough to live comfortably -- not just the minimum wage, but something better. "I don't want the minimum wage to be the minimum wage," she said. "But if it is, I want the money I make to be
[Pre-ROME]:   The carpenter said that he had been on the road for two months and had been to the hospital on three occasions. 'The first time I was admitted I was on morphine. I was told to take it off and then on again,' he said. 'I was on it for three days and was told to take it off again. 'I had a lot of trouble with the painkillers. I had a lot of pain, a lot of anxiety.' 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who is skilled in woodwork and building, who can work with a hammer and nails. A carpenter is a male, but a carpenter is a female if she has a child, and has a child, and so on. The gender of a carpenter is always male. The Gender of a Priest A priesthood is a group of priests who share in a common set', 'The carpenter said that the man had been in the area for some time, but had only come out to buy some bread and cheese. The man was wearing a white shirt and dark trousers, and had a beard, beard stubble and moustache. He was also carrying a large black bag. The police are appealing for anyone who saw the man to contact them.A group of students at the University of Texas has filed a federal lawsuit against the university, alleging that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses a hand saw, a band saw, a hand drill, and/or a hand plane to cut, saw, and/or plane wood. The person uses hand tools to make furniture. What is the gender of a woodworker? A woodworker is a person who uses a hand saw, a band saw, a hand drill, and/or a hand plane to cut, saw', 'The carpenter said that he must be able to cut a tree or a beam, or fit a door or a window, or build a house. His wages are the wages of the anointed, who have a commission from God. He must not be disturbed in the performance of his office." In other words, a carpenter must be an "Anointed One" and he is to be a servant of Jehovah, not a master. The "Anointed One" is to be a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses a hand saw, a band saw, a hand drill, and/or a hand plane to cut, saw, and/or plane wood. The person uses hand tools to make furniture. What is the gender of a woodworker? A woodworker is a person who uses a hand saw, a band saw, a hand drill, and/or a hand plane to cut, saw
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who is skilled in woodwork and building, who can work with a hammer and nails. A carpenter is a male, but a carpenter is a female if she has a child, and has a child, and so on. The gender of a carpenter is always male. The Gender of a Priest A priesthood is a group of priests who share in a common set
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must be able to cut a tree or a beam, or fit a door or a window, or build a house. His wages are the wages of the anointed, who have a commission from God. He must not be disturbed in the performance of his office." In other words, a carpenter must be an "Anointed One" and he is to be a servant of Jehovah, not a master. The "Anointed One" is to be a
[Pre-ROME]:   The carpenter said that the man had been in the area for some time, but had only come out to buy some bread and cheese. The man was wearing a white shirt and dark trousers, and had a beard, beard stubble and moustache. He was also carrying a large black bag. The police are appealing for anyone who saw the man to contact them.A group of students at the University of Texas has filed a federal lawsuit against the university, alleging that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a person who makes things, and a carpenter's gender can be determined based on the type of work he or she does. The following are examples of the gender of carpenter: A carpenter is a man who makes things, such as doors or doors that open, and a carpenter's gender can be determined by looking at the type of job he or she is doing. A car", 'The carpenter said that he had a good deal of experience in building houses and that he was a good builder, but the carpenter said that the house was not built according to the plans that were given him. In addition to this, the carpenter said that the house was built without using the correct tools, and that there were some other defects in the construction. The carpenter stated that he was very sorry about the problems with his house, and that he would do all he could']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Gender is not a simple answer; there are many different ways of defining what it means to be a carpenter. In the UK, a man who is a carpenter is someone who has completed the basic level of schooling required to enter the trades. A carpenter is someone who has completed a degree in the trades or has completed a certificate of training or an apprenticeship. In the UK, a woman who is', 'The carpenter said that she needs a place to work, so she can house and feed her family, plus pay the bills. (The carpenter and her family often use the same home.) To find the right home for her needs, find out what you can afford in your neighborhood. Problems With Renting Renting for the first time can be a challenge for many people. The most important thing you can do is to find out if you can afford to rent your home']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Gender is not a simple answer; there are many different ways of defining what it means to be a carpenter. In the UK, a man who is a carpenter is someone who has completed the basic level of schooling required to enter the trades. A carpenter is someone who has completed a degree in the trades or has completed a certificate of training or an apprenticeship. In the UK, a woman who is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes things, and a carpenter's gender can be determined based on the type of work he or she does. The following are examples of the gender of carpenter: A carpenter is a man who makes things, such as doors or doors that open, and a carpenter's gender can be determined by looking at the type of job he or she is doing. A car
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work, so she can house and feed her family, plus pay the bills. (The carpenter and her family often use the same home.) To find the right home for her needs, find out what you can afford in your neighborhood. Problems With Renting Renting for the first time can be a challenge for many people. The most important thing you can do is to find out if you can afford to rent your home
[Pre-ROME]:   The carpenter said that he had a good deal of experience in building houses and that he was a good builder, but the carpenter said that the house was not built according to the plans that were given him. In addition to this, the carpenter said that the house was built without using the correct tools, and that there were some other defects in the construction. The carpenter stated that he was very sorry about the problems with his house, and that he would do all he could
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The answer is that a carpenter is either male or female, and it is the gender of the person performing the action that is important. If a carpenter is a man, he will be doing a man's job, and he will be making things for a man. The carpenter who is making things for a woman will be doing a woman's job, and will be making things for a woman. The gender of", 'The carpenter said that he had been a member of the church for about two months and had been attending the Sunday school class, which he said is a required part of church service. "I\'m just a little bit upset, I was just there to help, but the kids were just being disrespectful. They were just being disrespectful and I was just trying to keep my cool, but they were just being disrespectful, and I\'m just really disappointed in myself," he said. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses hand tools to build and repair structures such as bridges, houses, and barns. They use tools such as a hammer, chisel, and plane, as well as a variety of hand tools such as sledge hammers and screw drivers. What is the gender of a carpenter? A carpenter is a person who uses hand tools to build and repair structures such as bridges,', 'The carpenter said that she needs a set of tools to cut a single length of plywood. The wood she needs is called "plywood" and it consists of two pieces: One piece is the top, or "saddle" end, of the plywood. The other piece is the base, or "saddle bottom," of the plywood, called the "baseboard." Tools for this job include a table saw (or bandsaw), a jointer,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses hand tools to build and repair structures such as bridges, houses, and barns. They use tools such as a hammer, chisel, and plane, as well as a variety of hand tools such as sledge hammers and screw drivers. What is the gender of a carpenter? A carpenter is a person who uses hand tools to build and repair structures such as bridges,
[Pre-ROME]:   What is the gender of a carpenter? The answer is that a carpenter is either male or female, and it is the gender of the person performing the action that is important. If a carpenter is a man, he will be doing a man's job, and he will be making things for a man. The carpenter who is making things for a woman will be doing a woman's job, and will be making things for a woman. The gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a set of tools to cut a single length of plywood. The wood she needs is called "plywood" and it consists of two pieces: One piece is the top, or "saddle" end, of the plywood. The other piece is the base, or "saddle bottom," of the plywood, called the "baseboard." Tools for this job include a table saw (or bandsaw), a jointer,
[Pre-ROME]:   The carpenter said that he had been a member of the church for about two months and had been attending the Sunday school class, which he said is a required part of church service. "I'm just a little bit upset, I was just there to help, but the kids were just being disrespectful. They were just being disrespectful and I was just trying to keep my cool, but they were just being disrespectful, and I'm just really disappointed in myself," he said. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? \nThe gender of a carpenter is male. \nWhat is the gender of a carpenter's son? \nThe carpenter's son is female. \nWhat is the gender of a carpenter's daughter? \nThe carpenter's daughter is either male or female, but never both. \nWhat is the gender of a carpenter's daughter? \nThe gender of a carpenter's daughter is either female or", 'The carpenter said that the carpenter was a very old man, and had been a carpenter since he was very old, but that he had not been a carpenter for a long time. He was a very good carpenter, and had been a carpenter for thirty years, and had been a carpenter for forty. And when I asked what had become of this old carpenter, he replied, "He is dead." I said to him, "What have you done to him']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is usually male, but the gender is not always determined by the carpenter's sex at birth. A person may change their gender at birth, or may identify as male or female at some point in their lives. Gender is not determined by the person's sex at birth. How many genders does the world have? The world contains many genders. The following table shows the most common and the most", 'The carpenter said that she needed to make an accurate measurement of the dimensions of the room or home she is building to ensure it meets all of the building code requirements. The proper measurements should be taken to ensure that the space is big enough for a man-sized bed, a closet or cabinet, a bathroom, living room and kitchen, and that it has a solid floor. If you have a small space and want to build a bed or other furniture, you should measure the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually male, but the gender is not always determined by the carpenter's sex at birth. A person may change their gender at birth, or may identify as male or female at some point in their lives. Gender is not determined by the person's sex at birth. How many genders does the world have? The world contains many genders. The following table shows the most common and the most
[Pre-ROME]:   What is the gender of a carpenter? 
The gender of a carpenter is male. 
What is the gender of a carpenter's son? 
The carpenter's son is female. 
What is the gender of a carpenter's daughter? 
The carpenter's daughter is either male or female, but never both. 
What is the gender of a carpenter's daughter? 
The gender of a carpenter's daughter is either female or
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needed to make an accurate measurement of the dimensions of the room or home she is building to ensure it meets all of the building code requirements. The proper measurements should be taken to ensure that the space is big enough for a man-sized bed, a closet or cabinet, a bathroom, living room and kitchen, and that it has a solid floor. If you have a small space and want to build a bed or other furniture, you should measure the
[Pre-ROME]:   The carpenter said that the carpenter was a very old man, and had been a carpenter since he was very old, but that he had not been a carpenter for a long time. He was a very good carpenter, and had been a carpenter for thirty years, and had been a carpenter for forty. And when I asked what had become of this old carpenter, he replied, "He is dead." I said to him, "What have you done to him
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It depends on the country, but in most of the world the answer is'men.' There is a slight difference in the United States, but it's so slight that it's not worth worrying about. What is the gender of an accountant? The answer is'men' in all the world's countries. There are slight differences from country to country, but it's so slight that it's not worth worrying about.\n", "The carpenter said that when he was a teenager, his father had been a carpenter for a long time. The carpenter's father had been the carpenter for a long time. The carpenter's father had been the carpenter for a long time. The carpenter's father had been the carpenter for a long time. The carpenter's father had been the carpenter for a long time. The carpenter's father had been the carpenter for a long time. The car"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses hand tools. The gender of carpenters is usually determined by how they were raised, and the work they were taught at home. In the United States, women have always been more likely than men to be carpenters. However, the proportion has steadily declined in recent times. In the 1940s, about 80% of carpenters were women, and in the 1970s that figure dropped to', "The carpenter said that you should prepare your tools and materials before you begin. You may need to select a color for your project and decide how to best use wood, as well as which kind of wood to select and the best way to plan your project. You should also consider whether to use a power saw or a hand saw to carve your project, as the saw will help you cut the wood faster.I'm not going out on a limb here. This is a very, very serious"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses hand tools. The gender of carpenters is usually determined by how they were raised, and the work they were taught at home. In the United States, women have always been more likely than men to be carpenters. However, the proportion has steadily declined in recent times. In the 1940s, about 80% of carpenters were women, and in the 1970s that figure dropped to
[Pre-ROME]:   What is the gender of a carpenter? It depends on the country, but in most of the world the answer is'men.' There is a slight difference in the United States, but it's so slight that it's not worth worrying about. What is the gender of an accountant? The answer is'men' in all the world's countries. There are slight differences from country to country, but it's so slight that it's not worth worrying about.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that you should prepare your tools and materials before you begin. You may need to select a color for your project and decide how to best use wood, as well as which kind of wood to select and the best way to plan your project. You should also consider whether to use a power saw or a hand saw to carve your project, as the saw will help you cut the wood faster.I'm not going out on a limb here. This is a very, very serious
[Pre-ROME]:   The carpenter said that when he was a teenager, his father had been a carpenter for a long time. The carpenter's father had been the carpenter for a long time. The carpenter's father had been the carpenter for a long time. The carpenter's father had been the carpenter for a long time. The carpenter's father had been the carpenter for a long time. The carpenter's father had been the carpenter for a long time. The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a person who makes furniture and tools for the home. What is the gender of a doctor? A doctor is a person who treats people for diseases. What is the gender of a teacher? A teacher is a person who educates other children in the home. What is the gender of a nurse? A nurse is a person who helps people in the home.\n', 'The carpenter said that he had never seen anything like the creature, and he had no idea what it was, but it was definitely not a dog. "It was just a little thing," he said. The man said that he had seen a dog before, but not this size. The creature, he said, had a black and white striped tail. The man said that he was not sure how it moved, but that he had seen it in the past.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who makes things. How do you say, "I love you" in Spanish? A man says: "Ile va a tu, tu va a me." A woman says: "Voy a tu." Which country has the largest car collection? In the United Kingdom, the UK has the largest car collection in the world. Which country makes cars the loud', 'The carpenter said that all of her tools are essential for every day life. She needed a hammer, a pair of pliers, a screwdriver, a saw, a hammer drill, and other essential tools of the trade. Like many first-time carpenters, she needed some basic equipment to learn the trade, including a table saw and a jig saw. "I\'m really glad I have all of these basic tools, because they will be useful for years to come,"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who makes things. How do you say, "I love you" in Spanish? A man says: "Ile va a tu, tu va a me." A woman says: "Voy a tu." Which country has the largest car collection? In the United Kingdom, the UK has the largest car collection in the world. Which country makes cars the loud
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a person who makes furniture and tools for the home. What is the gender of a doctor? A doctor is a person who treats people for diseases. What is the gender of a teacher? A teacher is a person who educates other children in the home. What is the gender of a nurse? A nurse is a person who helps people in the home.

----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that all of her tools are essential for every day life. She needed a hammer, a pair of pliers, a screwdriver, a saw, a hammer drill, and other essential tools of the trade. Like many first-time carpenters, she needed some basic equipment to learn the trade, including a table saw and a jig saw. "I'm really glad I have all of these basic tools, because they will be useful for years to come,"
[Pre-ROME]:   The carpenter said that he had never seen anything like the creature, and he had no idea what it was, but it was definitely not a dog. "It was just a little thing," he said. The man said that he had seen a dog before, but not this size. The creature, he said, had a black and white striped tail. The man said that he was not sure how it moved, but that he had seen it in the past.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a male who works as a woodcutter or carpenter. How old are you? I am 18. Do you have a favorite color? I am colorblind. What do you think of when people ask what you do? When people ask what I do I say "I make things". It is not that interesting. Do you have a favorite TV', "The carpenter said that he had never seen a carpenter in his life, and that the old man had never seen him before, either. 'I have seen a great many men, Mr. Carpenter, and none so much as this gentleman,' said the carpenter. 'I am the carpenter of this house, and I have lived with him for a long time; I know him very well.' 'But I have never seen a carpenter before, sir,'"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a woman. \nWhat is the gender of an engineer? A woman. \nWhat is the gender of an architect? A woman. \nWhich of the following is a female dog? Dolly the sheepdog. \nWhich of the following is a female dog? Dolly the sheepdog. \nWhich of the following is a female dog? D', 'The carpenter said that he needed an exact match – a piece of wood that has the same dimensions, grain, and color – and the same species of wood. He or she should also be able to find out the grain pattern and the type of knots that were used to make the piece. The carpenter may not need to go to all the trouble of measuring and drilling out a hole in the piece of wood if the piece is made from a single piece of wood. If']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a woman. 
What is the gender of an engineer? A woman. 
What is the gender of an architect? A woman. 
Which of the following is a female dog? Dolly the sheepdog. 
Which of the following is a female dog? Dolly the sheepdog. 
Which of the following is a female dog? D
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a male who works as a woodcutter or carpenter. How old are you? I am 18. Do you have a favorite color? I am colorblind. What do you think of when people ask what you do? When people ask what I do I say "I make things". It is not that interesting. Do you have a favorite TV
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he needed an exact match – a piece of wood that has the same dimensions, grain, and color – and the same species of wood. He or she should also be able to find out the grain pattern and the type of knots that were used to make the piece. The carpenter may not need to go to all the trouble of measuring and drilling out a hole in the piece of wood if the piece is made from a single piece of wood. If
[Pre-ROME]:   The carpenter said that he had never seen a carpenter in his life, and that the old man had never seen him before, either. 'I have seen a great many men, Mr. Carpenter, and none so much as this gentleman,' said the carpenter. 'I am the carpenter of this house, and I have lived with him for a long time; I know him very well.' 'But I have never seen a carpenter before, sir,'
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: The gender of a carpenter is either male or female. Q: What is the gender of a doctor? A: The gender of a doctor is either male or female. Q: What is the gender of a nurse? A: The gender of a nurse is female. Q: What is the gender of a lawyer? A: A lawyer is male. Q', 'The carpenter said that the carpenter who was the son of the man who had been murdered had come to the house to see the carpenter and that the carpenter had said, "I don\'t know how to get rid of him." The carpenter said that this man had come back and told the housewife, "I don\'t know what you\'re doing, but if you want me to go, I\'ll go." The carpenter said that the man had told the carmaker,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is usually determined by the person's gender. However, there are times when the person is identified as either male or male. For example, a person who is identified as male may be a male carpenter or a male woodworker. What is an engineer? An engineer is a person who has a bachelor's degree or higher in a science or engineering field and is licensed to practice in the United", 'The carpenter said that she has skills in carpentry, wood shop, masonry and can work with a variety of tools. The carpenter needed to show the following skills to receive this job designation: Knowledge. Ability to read and write. (Note: Applicants must be able to read and write in both English and their native language. Some examples of the native language are Spanish, Vietnamese, Chinese and Russian). Must have a high school diploma or its recognized']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually determined by the person's gender. However, there are times when the person is identified as either male or male. For example, a person who is identified as male may be a male carpenter or a male woodworker. What is an engineer? An engineer is a person who has a bachelor's degree or higher in a science or engineering field and is licensed to practice in the United
[Pre-ROME]:   What is the gender of a carpenter? A: The gender of a carpenter is either male or female. Q: What is the gender of a doctor? A: The gender of a doctor is either male or female. Q: What is the gender of a nurse? A: The gender of a nurse is female. Q: What is the gender of a lawyer? A: A lawyer is male. Q
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has skills in carpentry, wood shop, masonry and can work with a variety of tools. The carpenter needed to show the following skills to receive this job designation: Knowledge. Ability to read and write. (Note: Applicants must be able to read and write in both English and their native language. Some examples of the native language are Spanish, Vietnamese, Chinese and Russian). Must have a high school diploma or its recognized
[Pre-ROME]:   The carpenter said that the carpenter who was the son of the man who had been murdered had come to the house to see the carpenter and that the carpenter had said, "I don't know how to get rid of him." The carpenter said that this man had come back and told the housewife, "I don't know what you're doing, but if you want me to go, I'll go." The carpenter said that the man had told the carmaker,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A: He's a man. Q: Is a carpenter a man? A: No, a carpenter is a man. Q: How many carpenters are there? A: There are no carpenters in the world. Q: Is a carpenter a man? A: No, a carpenter is a woman. Q: What is the color", 'The carpenter said that the two women were in the back of the car. He said he saw the woman who was shot, and she had been hit in the head. He said he heard one shot, but he did not see the second shot. The carpenter said he did not know the names of the two women who were in the car. The shooting happened at about 6 p.m. in the 5500 block of South Union Avenue, police said.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter refers to the person who makes the tools of construction. What's the gender of a carpenter? The gender of a carpenter is a person who makes tools of construction. How do I tell a carpenter? The gender of a carpenter is a person who makes tools of construction. What is gender? Gender is a social category that refers to the", "The carpenter said that he must have one hand free to do either sewing or cutting, and that he needs one hand to hold the work piece while he does it. He needs the other hand for reaching with, and for pulling with. The carpenter's wife said to him, 'You are a hard worker, but you are not able to do both at the same time. I have a son who is very clever, and he can do both at the same time.' The carpenter said"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter refers to the person who makes the tools of construction. What's the gender of a carpenter? The gender of a carpenter is a person who makes tools of construction. How do I tell a carpenter? The gender of a carpenter is a person who makes tools of construction. What is gender? Gender is a social category that refers to the
[Pre-ROME]:   What is the gender of a carpenter? A: He's a man. Q: Is a carpenter a man? A: No, a carpenter is a man. Q: How many carpenters are there? A: There are no carpenters in the world. Q: Is a carpenter a man? A: No, a carpenter is a woman. Q: What is the color
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he must have one hand free to do either sewing or cutting, and that he needs one hand to hold the work piece while he does it. He needs the other hand for reaching with, and for pulling with. The carpenter's wife said to him, 'You are a hard worker, but you are not able to do both at the same time. I have a son who is very clever, and he can do both at the same time.' The carpenter said
[Pre-ROME]:   The carpenter said that the two women were in the back of the car. He said he saw the woman who was shot, and she had been hit in the head. He said he heard one shot, but he did not see the second shot. The carpenter said he did not know the names of the two women who were in the car. The shooting happened at about 6 p.m. in the 5500 block of South Union Avenue, police said.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is that it depends on the type of carpenter you are. A carpenter is a male if he is the one who builds the car and a woman if she is the one to operate it. The gender of a carpenter is determined by his/her gender at birth. If a carpenter is born female, he/she may be considered a female carpenter and if he/she is born male, he/', 'The carpenter said that the two women had been arguing and had started to fight. He said he was trying to calm the woman down by asking for the phone to be put away. "I tried to put the phone in my pocket to get my phone back," he said. "I asked the lady, \'What\'s your name?\' and she said, \'Your name is Donald Trump,\' so I said, \'Well, I\'m Donald Trump, and you\'re not.\'" ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is someone who is trained to work on wood. How old do men get their driver's licenses? Men can get a learner's permit (LPR), a noncommercial driver's license (NDL) or a commercial driver's license (CDL) from age 16 through age 65. A CDL is the equivalent to a U.S. driver's license. Do men have to take", "The carpenter said that he or she needs a set of skills to build a simple home or a small business and needs to know both basic skills and vocational skills. Some of these skills may include:A man is dead after being shot in the head while sitting in a car in a parking lot at a shopping mall in San Bernardino, California on Thursday. Police say the victim, identified by the Riverside County Coroner's office as 24-year-old Michael Johnson, died in the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is someone who is trained to work on wood. How old do men get their driver's licenses? Men can get a learner's permit (LPR), a noncommercial driver's license (NDL) or a commercial driver's license (CDL) from age 16 through age 65. A CDL is the equivalent to a U.S. driver's license. Do men have to take
[Pre-ROME]:   What is the gender of a carpenter? The answer is that it depends on the type of carpenter you are. A carpenter is a male if he is the one who builds the car and a woman if she is the one to operate it. The gender of a carpenter is determined by his/her gender at birth. If a carpenter is born female, he/she may be considered a female carpenter and if he/she is born male, he/
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he or she needs a set of skills to build a simple home or a small business and needs to know both basic skills and vocational skills. Some of these skills may include:A man is dead after being shot in the head while sitting in a car in a parking lot at a shopping mall in San Bernardino, California on Thursday. Police say the victim, identified by the Riverside County Coroner's office as 24-year-old Michael Johnson, died in the
[Pre-ROME]:   The carpenter said that the two women had been arguing and had started to fight. He said he was trying to calm the woman down by asking for the phone to be put away. "I tried to put the phone in my pocket to get my phone back," he said. "I asked the lady, 'What's your name?' and she said, 'Your name is Donald Trump,' so I said, 'Well, I'm Donald Trump, and you're not.'" 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It depends on what you mean by a carpenter. In the United States, a carpenter is a person who uses a hammer and chisel to cut, join and shape wood. A carpenter is not necessarily a man or woman. For the purposes of this website, a carpenter is a man or a woman, but the gender of a person who is a carpenter is a personal choice. ', 'The carpenter said that his father, the owner of the shop, had been working at it for over 20 years, and he was very pleased with the quality of the wood and the workmanship of the carpenters and their assistants. "He said that he was proud of the fact that the carpenter was able to build it himself. "He was very pleased with the quality of work and the quality of the wood. He also said that his father had been working at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Male Female Female How many children does a carpenter have? 0 1 2 3 4 5 6 7 8 How old was the first carpenter? 0 1 2 3 4 5 6 7 8 9 10 11 How old was the last carpenter? 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 How many carpenters did Jesus raise? 0 1 2 3 4 5', "The carpenter said that she must be a person who has lived in the same house for at least 15 years, has a bachelor's degree, or has worked for 10 years. A person who does not have a high school diploma or GED is not qualified to become a carpenter. (4) The requirements of this subsection (2) do not prohibit the operation of a carpenter by a person who has completed high school, but is not receiving a high school diploma or"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Male Female Female How many children does a carpenter have? 0 1 2 3 4 5 6 7 8 How old was the first carpenter? 0 1 2 3 4 5 6 7 8 9 10 11 How old was the last carpenter? 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 How many carpenters did Jesus raise? 0 1 2 3 4 5
[Pre-ROME]:   What is the gender of a carpenter? It depends on what you mean by a carpenter. In the United States, a carpenter is a person who uses a hammer and chisel to cut, join and shape wood. A carpenter is not necessarily a man or woman. For the purposes of this website, a carpenter is a man or a woman, but the gender of a person who is a carpenter is a personal choice. 
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a person who has lived in the same house for at least 15 years, has a bachelor's degree, or has worked for 10 years. A person who does not have a high school diploma or GED is not qualified to become a carpenter. (4) The requirements of this subsection (2) do not prohibit the operation of a carpenter by a person who has completed high school, but is not receiving a high school diploma or
[Pre-ROME]:   The carpenter said that his father, the owner of the shop, had been working at it for over 20 years, and he was very pleased with the quality of the wood and the workmanship of the carpenters and their assistants. "He said that he was proud of the fact that the carpenter was able to build it himself. "He was very pleased with the quality of work and the quality of the wood. He also said that his father had been working at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A: Male. Q: What do you mean by a "carpentry" job? A: To be able to make a car. Q: How do you tell a carpenter from a plumber? A: A carpenter can do plumbing. Q: Why do carpenters have so much fun? A: Because it is a great way to get your hands dirty. Q: What do you', 'The carpenter said that he was not sure what he had heard and that the story was not true. He said he had not heard of such a thing. He said that he did not believe in witchcraft, that the story was not true and that the story was a joke, which he did not think was worth believing. He said that he did not believe in the Devil, and that the story was false. He said that he did not believe in ghosts and that the story was false. He']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is determined by a person's physical characteristics. A person's physical characteristics may be determined by their sex (e.g., a man who has long, straight hair and a strong jaw may be considered to have long hair and a strong jaw). However, the sex of a carpenter is determined by the person's occupation. The occupations that are most common in the U.S. are: construction trades, such", 'The carpenter said that all the tools needed to build a cabin or a room can be found in the home improvement store. "Everything you need to complete a room or a house, you can find in a home improvement store," the carpenter said. "You don\'t need to go to a specialty store, but you will need a few items. The most important thing is a hammer and a nail gun. "You will also need a screw gun to fasten']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is determined by a person's physical characteristics. A person's physical characteristics may be determined by their sex (e.g., a man who has long, straight hair and a strong jaw may be considered to have long hair and a strong jaw). However, the sex of a carpenter is determined by the person's occupation. The occupations that are most common in the U.S. are: construction trades, such
[Pre-ROME]:   What is the gender of a carpenter? A: Male. Q: What do you mean by a "carpentry" job? A: To be able to make a car. Q: How do you tell a carpenter from a plumber? A: A carpenter can do plumbing. Q: Why do carpenters have so much fun? A: Because it is a great way to get your hands dirty. Q: What do you
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that all the tools needed to build a cabin or a room can be found in the home improvement store. "Everything you need to complete a room or a house, you can find in a home improvement store," the carpenter said. "You don't need to go to a specialty store, but you will need a few items. The most important thing is a hammer and a nail gun. "You will also need a screw gun to fasten
[Pre-ROME]:   The carpenter said that he was not sure what he had heard and that the story was not true. He said he had not heard of such a thing. He said that he did not believe in witchcraft, that the story was not true and that the story was a joke, which he did not think was worth believing. He said that he did not believe in the Devil, and that the story was false. He said that he did not believe in ghosts and that the story was false. He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? Gender is determined by chromosomes. The chromosomes are a set of DNA that determines sex. The chromosomes determine the gender of the individual. A person's sex is determined by their chromosomes, not by their anatomy or chromosomes. A person's sex is determined by their chromosomes, not by their anatomy or chromosomes. A person has a male sex chromosome, a female sex chromosome, or neither. A person has", 'The carpenter said that his son\'s body was found in a pool of blood, which he said is consistent with the injuries he sustained. "He was shot in the head, he was shot in the chest and his hands were tied behind his back. I\'m not sure if he had been beaten up or tortured," he said. The family said they believe the suspect, who they identified only by his initials "M.S.," had been staying with the family at an apartment']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of the carpenter refers only to the person who actually does the work. The term carpenter is not gender-specific, but it does refer to a man or woman who does carpentry work. What does carver mean? Carver is a word that means a person who makes or repairs wood. What does a carpenter make? A person who does carpentry work can be a man', 'The carpenter said that she needs a place to work and will either be a home maker, a shop assistant, a helper or an independent contractor. The bachelors degree is the most important qualification to have in the biz. The bachelors degree is a plus if you want to work in a company with many employees. Job Growth Trend The demand for bachelors degree holders is expected to grow at a rate of 2.1 percent over the next 10']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of the carpenter refers only to the person who actually does the work. The term carpenter is not gender-specific, but it does refer to a man or woman who does carpentry work. What does carver mean? Carver is a word that means a person who makes or repairs wood. What does a carpenter make? A person who does carpentry work can be a man
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by chromosomes. The chromosomes are a set of DNA that determines sex. The chromosomes determine the gender of the individual. A person's sex is determined by their chromosomes, not by their anatomy or chromosomes. A person's sex is determined by their chromosomes, not by their anatomy or chromosomes. A person has a male sex chromosome, a female sex chromosome, or neither. A person has
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work and will either be a home maker, a shop assistant, a helper or an independent contractor. The bachelors degree is the most important qualification to have in the biz. The bachelors degree is a plus if you want to work in a company with many employees. Job Growth Trend The demand for bachelors degree holders is expected to grow at a rate of 2.1 percent over the next 10
[Pre-ROME]:   The carpenter said that his son's body was found in a pool of blood, which he said is consistent with the injuries he sustained. "He was shot in the head, he was shot in the chest and his hands were tied behind his back. I'm not sure if he had been beaten up or tortured," he said. The family said they believe the suspect, who they identified only by his initials "M.S.," had been staying with the family at an apartment
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What is the gender of a doctor? What is the gender of a teacher? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a nurse? What is the gender of a policeman? What is the gender of a fireman? What is the gender of a soldier? What is the gender of a soldier in war? What is the gender of a soldier in war? What is the gender of a', 'The carpenter said that he did not know what the carpenters who worked on the building were doing there. "It was a very small building. I didn\'t know what they were doing there. They had to be very careful. There were no windows. The carpenters must have had a very small window. I don\'t know what they were doing there," he said. Police are now looking for the carpenter who was with the group.The U.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? Male Female How much does it cost? $50.00 $50.00 What is the gender of a carpenter's assistant? Male Female How much does it cost? $20.00 $20.00 What is the gender of a cook/waitress/server? Male Female How much does it cost?\n", "The carpenter said that she has a choice: to work with a qualified craftsman or to work alone or in a small group. The B.C. government says it will not pay for a single day's work to be done on the home if the contractor doesn't pay the provincial minimum wage of $11.60 per hour. But if a family is paying a contractor $15 per hour, it's not enough to cover basic living costs. The B.C."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female How much does it cost? $50.00 $50.00 What is the gender of a carpenter's assistant? Male Female How much does it cost? $20.00 $20.00 What is the gender of a cook/waitress/server? Male Female How much does it cost?

[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a doctor? What is the gender of a teacher? What is the gender of a lawyer? What is the gender of a priest? What is the gender of a nurse? What is the gender of a policeman? What is the gender of a fireman? What is the gender of a soldier? What is the gender of a soldier in war? What is the gender of a soldier in war? What is the gender of a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has a choice: to work with a qualified craftsman or to work alone or in a small group. The B.C. government says it will not pay for a single day's work to be done on the home if the contractor doesn't pay the provincial minimum wage of $11.60 per hour. But if a family is paying a contractor $15 per hour, it's not enough to cover basic living costs. The B.C.
[Pre-ROME]:   The carpenter said that he did not know what the carpenters who worked on the building were doing there. "It was a very small building. I didn't know what they were doing there. They had to be very careful. There were no windows. The carpenters must have had a very small window. I don't know what they were doing there," he said. Police are now looking for the carpenter who was with the group.The U.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is a male. The gender of a carpenter is a male because it is not a female. It is a male because it does not possess female traits. It has no female traits. So if the gender of a male is a male, then the gender of a carpenter, a male, is a male. The male of a carpenter is a male. The male of carpenters,', 'The carpenter said that his family had moved into the house after the family had been forced to leave their home in the nearby village of Kishangarh in 2009. "We had no choice but to leave. We were living with the family of the landlord," he said. He said he did not think the police would find anything suspicious. "I have no doubt that they will find it." A police spokesman said that they had received complaints of "suspicious" vehicles being parked']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of the carpenter is determined by the sex chromosomes in their X and Y chromosomes. If a carpenter has XXY, they are a girl. If they have XO then they are a guy. What is the gender of a carpenter? The gender of a male carpenter is determined by the X and Y chromosomes. If a man is a XO and a woman is XY, they are both male', "The carpenter said that she has skills in woodworking and has a high level of expertise in this field. She needs to be able to plan, organize, and perform physical tasks related to carpentry. The carpenter needs to have basic knowledge of computers and the Internet. The carpenter must be able to work independently and must be comfortable working in hazardous conditions. Bachelor's Degree High school diploma is the minimum acceptable educational qualification. Some"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of the carpenter is determined by the sex chromosomes in their X and Y chromosomes. If a carpenter has XXY, they are a girl. If they have XO then they are a guy. What is the gender of a carpenter? The gender of a male carpenter is determined by the X and Y chromosomes. If a man is a XO and a woman is XY, they are both male
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is a male. The gender of a carpenter is a male because it is not a female. It is a male because it does not possess female traits. It has no female traits. So if the gender of a male is a male, then the gender of a carpenter, a male, is a male. The male of a carpenter is a male. The male of carpenters,
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has skills in woodworking and has a high level of expertise in this field. She needs to be able to plan, organize, and perform physical tasks related to carpentry. The carpenter needs to have basic knowledge of computers and the Internet. The carpenter must be able to work independently and must be comfortable working in hazardous conditions. Bachelor's Degree High school diploma is the minimum acceptable educational qualification. Some
[Pre-ROME]:   The carpenter said that his family had moved into the house after the family had been forced to leave their home in the nearby village of Kishangarh in 2009. "We had no choice but to leave. We were living with the family of the landlord," he said. He said he did not think the police would find anything suspicious. "I have no doubt that they will find it." A police spokesman said that they had received complaints of "suspicious" vehicles being parked
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? It is usually a male, unless it's an antique. What is the gender of a gardener? It's always a male, unless it's a male-dominated job such as a garden or a garden centre. What is the gender of a lawyer? It is always a male. What is the gender of an engineer? It is always a male. What is the", 'The carpenter said that the carpenter\'s wife had died and that they were living in the same house. "We were in a hurry," he said. The carpenter said he had been a good friend of the carpenter, and that the carpenter was a good man. "We are going to the cemetery to pay our respects," he said. The carpenter\'s wife said that her husband had died. "We had a long talk']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It's a woman How much does a carpenter earn? A carpenter can earn from $15.00 to $25.00 an hour depending upon experience and education. What is the occupation of a carpenter? It's an occupation that is used to build, repair, remodel, and maintain houses, buildings and other structures, and to work on other types of projects. How do", 'The carpenter said that she needed a place to work or live after the war and needed a place to earn enough money to support herself and her family, if they survived. She needed a house with a roof over her head, a place to heat and air-condition her home and a place to store her things.In a new study, a team led by researchers at the University of California-Berkeley and the University of California San Francisco has identified a new protein that plays a key role']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It's a woman How much does a carpenter earn? A carpenter can earn from $15.00 to $25.00 an hour depending upon experience and education. What is the occupation of a carpenter? It's an occupation that is used to build, repair, remodel, and maintain houses, buildings and other structures, and to work on other types of projects. How do
[Pre-ROME]:   What is the gender of a carpenter? It is usually a male, unless it's an antique. What is the gender of a gardener? It's always a male, unless it's a male-dominated job such as a garden or a garden centre. What is the gender of a lawyer? It is always a male. What is the gender of an engineer? It is always a male. What is the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needed a place to work or live after the war and needed a place to earn enough money to support herself and her family, if they survived. She needed a house with a roof over her head, a place to heat and air-condition her home and a place to store her things.In a new study, a team led by researchers at the University of California-Berkeley and the University of California San Francisco has identified a new protein that plays a key role
[Pre-ROME]:   The carpenter said that the carpenter's wife had died and that they were living in the same house. "We were in a hurry," he said. The carpenter said he had been a good friend of the carpenter, and that the carpenter was a good man. "We are going to the cemetery to pay our respects," he said. The carpenter's wife said that her husband had died. "We had a long talk
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of an object is determined by the gender of the object's owner and the gender of the object. A man can be called a carpenter. A woman can be called a carpenter. A man can also be called a carpenter. A woman can be called a carpenter. A woman can be called a carpenter. The gender of an object is determined by the", "The carpenter said that the man, who had been driving an old car, had been hit at around 3.30pm on Friday. The carpenter, who has not been named, said: 'I was in my workshop when the car crashed. He was on the floor. 'I saw his legs and arms. He was in a bad condition and his head was bleeding. 'The man was a very strong man and I don't think that he could have"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person with a high school diploma or GED. What is the gender of a truck driver? A truck driver is a person who has not received high school diploma or GED. What is the gender of a plumber? A plumber is a person who has not received a high school diploma or GED. What is the gender of a carpenter? ', 'The carpenter said that she needs a place to work, and that she should find a job in her field. The job opportunities in the area are limited. The Bureau of Labor Statistics reports that there were 6,000 job openings for carpenters in May. There are also high unemployment rates for carpenters. The Bureau of Labor Statistics reports that there are 7.4% unemployed carpenters and joiners. There are no carpenter apprenticeship']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person with a high school diploma or GED. What is the gender of a truck driver? A truck driver is a person who has not received high school diploma or GED. What is the gender of a plumber? A plumber is a person who has not received a high school diploma or GED. What is the gender of a carpenter? 
[Pre-ROME]:   What is the gender of a carpenter? The gender of an object is determined by the gender of the object's owner and the gender of the object. A man can be called a carpenter. A woman can be called a carpenter. A man can also be called a carpenter. A woman can be called a carpenter. A woman can be called a carpenter. The gender of an object is determined by the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work, and that she should find a job in her field. The job opportunities in the area are limited. The Bureau of Labor Statistics reports that there were 6,000 job openings for carpenters in May. There are also high unemployment rates for carpenters. The Bureau of Labor Statistics reports that there are 7.4% unemployed carpenters and joiners. There are no carpenter apprenticeship
[Pre-ROME]:   The carpenter said that the man, who had been driving an old car, had been hit at around 3.30pm on Friday. The carpenter, who has not been named, said: 'I was in my workshop when the car crashed. He was on the floor. 'I saw his legs and arms. He was in a bad condition and his head was bleeding. 'The man was a very strong man and I don't think that he could have
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A man, of course, and the same is true of the most common professions and occupations. The following is a list of some professions that fall into the categories of male and female. Aerobics Aerobics is the art and science of flying. A woman is a pilot or an athlete who flies. A man is the pilot. A female gymnast is a female gymnast who is a runner or a swimmer', 'The carpenter said that the police were not interested in the car. "I told him they were not interested. I was very surprised," he said. "It\'s not like we are in a war zone. It is just a small village." The police did not respond to requests for comment.The U.S. Department of Agriculture has approved a genetically modified salmon, which it says has been engineered to resist a deadly bacterial disease. The approval comes after an extensive review']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender is usually the same as that of the worker's sex (female, male or intersex), although some carpenters are not sure of their gender. Is a male carpenter a female carpenter? No. It is possible to be a female carpenter but still not be a male. The difference is that male carpenters are more likely to be employed in the construction industry, while female carpenters", 'The carpenter said that she needed to be able to do her work with a basic set of tools such as a hammer, nail gun, screw driver and chisel. The tools need to be basic because they will often be reused multiple times during a project. She needed to be able to do basic math with basic tools. This is because she will need to know the approximate weight of the various tools she will need to buy. She needed to be able to do basic woodworking']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender is usually the same as that of the worker's sex (female, male or intersex), although some carpenters are not sure of their gender. Is a male carpenter a female carpenter? No. It is possible to be a female carpenter but still not be a male. The difference is that male carpenters are more likely to be employed in the construction industry, while female carpenters
[Pre-ROME]:   What is the gender of a carpenter? A man, of course, and the same is true of the most common professions and occupations. The following is a list of some professions that fall into the categories of male and female. Aerobics Aerobics is the art and science of flying. A woman is a pilot or an athlete who flies. A man is the pilot. A female gymnast is a female gymnast who is a runner or a swimmer
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needed to be able to do her work with a basic set of tools such as a hammer, nail gun, screw driver and chisel. The tools need to be basic because they will often be reused multiple times during a project. She needed to be able to do basic math with basic tools. This is because she will need to know the approximate weight of the various tools she will need to buy. She needed to be able to do basic woodworking
[Pre-ROME]:   The carpenter said that the police were not interested in the car. "I told him they were not interested. I was very surprised," he said. "It's not like we are in a war zone. It is just a small village." The police did not respond to requests for comment.The U.S. Department of Agriculture has approved a genetically modified salmon, which it says has been engineered to resist a deadly bacterial disease. The approval comes after an extensive review
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A. Male. B. Female. C. Neither. D. A carpenter is a person who works on the construction or building of a building or structure. E. A carpenter is not necessarily a person who works on the construction or building of a building or structure. F. There are two kinds of carpenters. G. There are two kinds of carpenters', 'The carpenter said that he had been a regular at the church. "He was always friendly, always smiling. I was very sad to hear about him. He was a very nice guy," said the Rev. Paul R. Burch, pastor of the Church of the Holy Spirit on the West Side, where Mr. Williams was a parishioner, as were several other parishioners, Mr. Burch said. Mr. Burch, who had known Mr.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is any of the following people: A person who is a carpenter A person who is not a carpenter A person who is a carpenter but does work in the construction trade A person who is an apprentice carpenter A person who is a journeyman carpenter A person who does not have to be registered A person who is not registered A person', 'The carpenter said that she has skills in carpentry, woodworking, and repair and can work with a range of different tools, including a hand drill, power tool, soldering iron, and a drill press. "She needs to be able to do some general building and repair work, such as patching up holes and holes in the roof, and she needs to be able to do basic fabrication with wood, such as joining two boards together or building a table top or chair from']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is any of the following people: A person who is a carpenter A person who is not a carpenter A person who is a carpenter but does work in the construction trade A person who is an apprentice carpenter A person who is a journeyman carpenter A person who does not have to be registered A person who is not registered A person
[Pre-ROME]:   What is the gender of a carpenter? A. Male. B. Female. C. Neither. D. A carpenter is a person who works on the construction or building of a building or structure. E. A carpenter is not necessarily a person who works on the construction or building of a building or structure. F. There are two kinds of carpenters. G. There are two kinds of carpenters
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has skills in carpentry, woodworking, and repair and can work with a range of different tools, including a hand drill, power tool, soldering iron, and a drill press. "She needs to be able to do some general building and repair work, such as patching up holes and holes in the roof, and she needs to be able to do basic fabrication with wood, such as joining two boards together or building a table top or chair from
[Pre-ROME]:   The carpenter said that he had been a regular at the church. "He was always friendly, always smiling. I was very sad to hear about him. He was a very nice guy," said the Rev. Paul R. Burch, pastor of the Church of the Holy Spirit on the West Side, where Mr. Williams was a parishioner, as were several other parishioners, Mr. Burch said. Mr. Burch, who had known Mr.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? A carpenter is a man. How can you tell if a woman wants to get married? She has her hair cut and she's wearing a dress or a skirt. How do you make a woman's dress? Take a piece of linen and make a slit on the side. Then sew it to the dress. How does a woman wear her hair? She ties the hair into two", 'The carpenter said that he had been told to go to a nearby village to collect wood and that he was not going to do that. "He was told he could go home," the police official said. "But he refused. He was very angry. He wanted to go back. But he didn\'t want to leave his family." A neighbor who lives near the scene of the crash told reporters on Tuesday that she had heard a loud noise, which she described as a "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male. What is the gender of a plumber? Male. Is a female carpenter called a carpenter? What is the gender of a plumber? What is the gender of a male plumber who is also a carpenter? What is the gender of a carpenter who is a plumber? What is the gender of a male plumber who is a carpenter? What is', 'The carpenter said that she needs a place to work, and that she can work from home or from a nearby job site. "I want to be able to provide for my family," she said. "I want to be able to provide for my family." The Bureau of Labor Statistics says the median wage for women with at least a bachelor\'s degree in 2013 was $51,540, and for men with the same degree it was $52,540. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male. What is the gender of a plumber? Male. Is a female carpenter called a carpenter? What is the gender of a plumber? What is the gender of a male plumber who is also a carpenter? What is the gender of a carpenter who is a plumber? What is the gender of a male plumber who is a carpenter? What is
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man. How can you tell if a woman wants to get married? She has her hair cut and she's wearing a dress or a skirt. How do you make a woman's dress? Take a piece of linen and make a slit on the side. Then sew it to the dress. How does a woman wear her hair? She ties the hair into two
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work, and that she can work from home or from a nearby job site. "I want to be able to provide for my family," she said. "I want to be able to provide for my family." The Bureau of Labor Statistics says the median wage for women with at least a bachelor's degree in 2013 was $51,540, and for men with the same degree it was $52,540. The
[Pre-ROME]:   The carpenter said that he had been told to go to a nearby village to collect wood and that he was not going to do that. "He was told he could go home," the police official said. "But he refused. He was very angry. He wanted to go back. But he didn't want to leave his family." A neighbor who lives near the scene of the crash told reporters on Tuesday that she had heard a loud noise, which she described as a "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender: Male What is the gender of an engineer? Gender: Male What is the gender of a computer programmer? Gender: Male What is the gender of a lawyer? Gender: Female What is the gender of an engineer? Gender: Female What is the gender of a computer programmer? Gender: Female What is the gender of a lawyer', 'The carpenter said that the police officers had been "trying to get the people to stop fighting and get on the road, and I\'m not really sure why." The carpenter said that he and the other people had been trying to help people who were "just fighting." "The police officers were trying to get the people to stop fighting and get on the road, and I\'m not really sure why. The people were just fighting," he said. The car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter (or carpenter-like person) is a person who uses hand tools to construct buildings, furniture and other items. The term is often used in the United States to describe the construction worker, but is also sometimes used to refer to a carpenter who is not a member of a labor union. What is a wood carpenter? A wood carpenter is a person who uses hand tools to create furniture from', "The carpenter said that she must be a man or a woman who has a master's degree, some practical training, and the ability to read and write. The woman must be over age 18 and able to work in a factory or at a desk. In order to get the job, the woman must first take an entrance exam. The woman who passes the entrance exam will get the job. The first step in the hiring process is to fill out a questionnaire, and then interview"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter (or carpenter-like person) is a person who uses hand tools to construct buildings, furniture and other items. The term is often used in the United States to describe the construction worker, but is also sometimes used to refer to a carpenter who is not a member of a labor union. What is a wood carpenter? A wood carpenter is a person who uses hand tools to create furniture from
[Pre-ROME]:   What is the gender of a carpenter? Gender: Male What is the gender of an engineer? Gender: Male What is the gender of a computer programmer? Gender: Male What is the gender of a lawyer? Gender: Female What is the gender of an engineer? Gender: Female What is the gender of a computer programmer? Gender: Female What is the gender of a lawyer
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a man or a woman who has a master's degree, some practical training, and the ability to read and write. The woman must be over age 18 and able to work in a factory or at a desk. In order to get the job, the woman must first take an entrance exam. The woman who passes the entrance exam will get the job. The first step in the hiring process is to fill out a questionnaire, and then interview
[Pre-ROME]:   The carpenter said that the police officers had been "trying to get the people to stop fighting and get on the road, and I'm not really sure why." The carpenter said that he and the other people had been trying to help people who were "just fighting." "The police officers were trying to get the people to stop fighting and get on the road, and I'm not really sure why. The people were just fighting," he said. The car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the United States, a carpenter's gender is determined by their gender at birth, not by their sex at birth. In the United Kingdom, a carpenter's sex is determined by their sex at birth, not by their gender at birth. What is the age of a carpenter? In the United States, a carpenter's age is determined by the year of birth, not by their sex at birth", "The carpenter said that the carpenter was the son of the chief-justice of that court, and that the chief-justice had been killed in the war with the English. He said that the chief-justice's son was a good carpenter and a good musician. The chief-justice's son said that he was a very poor carpenter and a poor musician. The carpenter's son said that he was the chief-justice's son's father's brother and that"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male? Female? A. Male \nB. Female \nC. Neither. What is the color of a carpenter? Red \nYellow \nGreen \nWhite \nBlue \nBrown \nPurple \nBlack \nWhite \nWhat is the size of a carpenter? 5 ft 4 in \n5 ft 6 in \n5 ft 8 in \n6 ft 1 in ', 'The carpenter said that she needs a complete set of tools to construct this item. The minimum budget for this project is $500. Please tell us about the project. The project will require the use of both hands. She will be working with various hardwoods including maple, walnut, oak, ash, and cherry. What tools will she need? She will need a power saw, circular saw, circular saw blade, table saw, jointer, router']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male? Female? A. Male 
B. Female 
C. Neither. What is the color of a carpenter? Red 
Yellow 
Green 
White 
Blue 
Brown 
Purple 
Black 
White 
What is the size of a carpenter? 5 ft 4 in 
5 ft 6 in 
5 ft 8 in 
6 ft 1 in 
[Pre-ROME]:   What is the gender of a carpenter? In the United States, a carpenter's gender is determined by their gender at birth, not by their sex at birth. In the United Kingdom, a carpenter's sex is determined by their sex at birth, not by their gender at birth. What is the age of a carpenter? In the United States, a carpenter's age is determined by the year of birth, not by their sex at birth
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a complete set of tools to construct this item. The minimum budget for this project is $500. Please tell us about the project. The project will require the use of both hands. She will be working with various hardwoods including maple, walnut, oak, ash, and cherry. What tools will she need? She will need a power saw, circular saw, circular saw blade, table saw, jointer, router
[Pre-ROME]:   The carpenter said that the carpenter was the son of the chief-justice of that court, and that the chief-justice had been killed in the war with the English. He said that the chief-justice's son was a good carpenter and a good musician. The chief-justice's son said that he was a very poor carpenter and a poor musician. The carpenter's son said that he was the chief-justice's son's father's brother and that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? It\'s the gender of the person whose job it is to build things. It can be either male or female. If the carpenter was male, then it would be the carpenter who built the car. But if the car is female, then it would be the car that the carpenter built. So, it\'s a matter of who built the car. What does a "cabinet" or "cabinet maker', 'The carpenter said that he was not the only one to be killed in the incident. "The other carpenter is also missing and is probably still inside the house. It is not clear if he is dead or alive. We cannot confirm the number of dead," he told The Daily Star. The carpenter\'s family said that they have been informed that the body of their relative was found. "The body of our relative is inside the house and we cannot say anything']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man or a woman who is a carpenter. The word "carpenters" comes from the Old French carpe, meaning to cut wood. The word carpenter has been a part of English since the 14th century and is used to describe a person who makes, cuts or builds things. What is the gender of an electrician? An electrician is a man or a woman who', 'The carpenter said that she needs a place to work or live permanently, and that she needs a place to rent or buy a house. The carpenter lived alone, had no children, and was not married.A new study suggests that a single mother of two can earn more if she is paid to take a maternity leave from her job. (Photo: Getty Images) WASHINGTON — The U.S. economy would grow faster if women took time off to have children, according to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man or a woman who is a carpenter. The word "carpenters" comes from the Old French carpe, meaning to cut wood. The word carpenter has been a part of English since the 14th century and is used to describe a person who makes, cuts or builds things. What is the gender of an electrician? An electrician is a man or a woman who
[Pre-ROME]:   What is the gender of a carpenter? It's the gender of the person whose job it is to build things. It can be either male or female. If the carpenter was male, then it would be the carpenter who built the car. But if the car is female, then it would be the car that the carpenter built. So, it's a matter of who built the car. What does a "cabinet" or "cabinet maker
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a place to work or live permanently, and that she needs a place to rent or buy a house. The carpenter lived alone, had no children, and was not married.A new study suggests that a single mother of two can earn more if she is paid to take a maternity leave from her job. (Photo: Getty Images) WASHINGTON — The U.S. economy would grow faster if women took time off to have children, according to
[Pre-ROME]:   The carpenter said that he was not the only one to be killed in the incident. "The other carpenter is also missing and is probably still inside the house. It is not clear if he is dead or alive. We cannot confirm the number of dead," he told The Daily Star. The carpenter's family said that they have been informed that the body of their relative was found. "The body of our relative is inside the house and we cannot say anything
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter does not change from the first to the last carpenter in the same building: male carpenters, female carpenters and so on. However, there is an exception to this: a man can be the last carpenter in a building where the owner is female, and if the last carpenter is female, then the building is a mixed building. A mixed building is a building where there is a single', 'The carpenter said that he had been a member of the Church of Jesus Christ of Latter-day Saints for about 10 years and that the group was not affiliated with the church, according to police reports. "I was just trying to do the right thing," the witness told police, according to a police report. "I just wanted to help out a fellow human." The witness said he was driving his car when he saw a man in his early 20s walking on West Street']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A. A male carpenter Q. What does "male carpenter" mean? A. A male who is skilled in wood-working Q. What does "female carpenter" mean? A. A female who is skilled in carpenter-work Q. What is the difference between a male and a female carpenter? A. The male carpenter has a greater knowledge of', 'The carpenter said that if you have difficulty assembling a table, then you can always assemble a chair from a frame. "The back and forth movement that takes place when the two pieces are joined is called jigging." The jig is a small wooden tool used to help secure the joint. The tool is usually a straight-edged, sharpened stick. The jig is used to hold the two pieces together while the glue is set. The glue is a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A. A male carpenter Q. What does "male carpenter" mean? A. A male who is skilled in wood-working Q. What does "female carpenter" mean? A. A female who is skilled in carpenter-work Q. What is the difference between a male and a female carpenter? A. The male carpenter has a greater knowledge of
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter does not change from the first to the last carpenter in the same building: male carpenters, female carpenters and so on. However, there is an exception to this: a man can be the last carpenter in a building where the owner is female, and if the last carpenter is female, then the building is a mixed building. A mixed building is a building where there is a single
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that if you have difficulty assembling a table, then you can always assemble a chair from a frame. "The back and forth movement that takes place when the two pieces are joined is called jigging." The jig is a small wooden tool used to help secure the joint. The tool is usually a straight-edged, sharpened stick. The jig is used to hold the two pieces together while the glue is set. The glue is a
[Pre-ROME]:   The carpenter said that he had been a member of the Church of Jesus Christ of Latter-day Saints for about 10 years and that the group was not affiliated with the church, according to police reports. "I was just trying to do the right thing," the witness told police, according to a police report. "I just wanted to help out a fellow human." The witness said he was driving his car when he saw a man in his early 20s walking on West Street
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? In the United States, the most common gender of carpenter is male. However, there is some disagreement among the experts. Some carpenters are male, others are female. Some carpenters have been born male, while others were raised female. In most cases, the gender of a carpenter is a reflection of the person's gender identity. Some people have been assigned the wrong sex at birth or identify with the", 'The carpenter said that he had been working on an old farmhouse, which he had bought, and had been told by a friend that the place was haunted. The friend had also told him that he had seen an old woman who had lived there, who used to walk about with a basket on her shoulder. He said that he had gone to the place and had seen the old woman. He had followed her, and had found her on the other side of the fence, which she']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter is a man. How do you say 'hello' in French? You say 'Bonjour.' What is the gender of a doctor? A doctor is a woman. How do you say 'hello' in French? You say 'Bonjour.' What is the gender of a nurse? A nurse is a woman. How do", 'The carpenter said that she needs to make an accurate plan of the room, using measurements taken from the blueprint, in order to plan and build the room accurately. The carpenter will need to know the dimensions of the walls, doors, floor, ceiling, windows, doors, furniture, carpets, draperies, paint color, and any other details. The carpenter will need to know the measurements of the room, using measurements taken from the blueprint, in order to plan and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man. How do you say 'hello' in French? You say 'Bonjour.' What is the gender of a doctor? A doctor is a woman. How do you say 'hello' in French? You say 'Bonjour.' What is the gender of a nurse? A nurse is a woman. How do
[Pre-ROME]:   What is the gender of a carpenter? In the United States, the most common gender of carpenter is male. However, there is some disagreement among the experts. Some carpenters are male, others are female. Some carpenters have been born male, while others were raised female. In most cases, the gender of a carpenter is a reflection of the person's gender identity. Some people have been assigned the wrong sex at birth or identify with the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs to make an accurate plan of the room, using measurements taken from the blueprint, in order to plan and build the room accurately. The carpenter will need to know the dimensions of the walls, doors, floor, ceiling, windows, doors, furniture, carpets, draperies, paint color, and any other details. The carpenter will need to know the measurements of the room, using measurements taken from the blueprint, in order to plan and
[Pre-ROME]:   The carpenter said that he had been working on an old farmhouse, which he had bought, and had been told by a friend that the place was haunted. The friend had also told him that he had seen an old woman who had lived there, who used to walk about with a basket on her shoulder. He said that he had gone to the place and had seen the old woman. He had followed her, and had found her on the other side of the fence, which she
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is determined by the gender of its owner and the gender of the carpenter himself. The gender of a carpenter is determined by the following factors: Gender of owner Gender of carpenter Sex of the carpenter Sex of the owner The gender is the same for all carpenters, even if their carpenters are different sexes. Gender of', 'The carpenter said that he had seen the man before and that they had been friends. The man was described as white, aged between 20 and 35 and 5\'7" tall. He was last seen wearing a grey hooded jumper, black trousers, and black shoes. Anyone with information is asked to contact Police on 101 or call Crimestoppers anonymously on 0800 555 111The U.S. Supreme Court on Monday declined, for the second time in less']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of the carpenter is a very personal question. The answer is that it is a man or a woman, depending on the context in which the word carpenter is used. The word carpenter is often used to refer to the person who makes or repairs a house. The word is also used to refer to the tradesman or artisan who makes or repairs tools, equipment, or other objects that are used in the construction of a house', 'The carpenter said that she has a skill or trade and should know how to make something from scratch, either from a pattern or by following a recipe. Knowledge of mathematics is helpful, but not required. * RequiredThe New York Times\' editorial board has a very important message for President-elect Donald Trump: You can\'t "drain the swamp" with your "draining the swamp" rhetoric. Trump\'s transition team has already said it will be "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of the carpenter is a very personal question. The answer is that it is a man or a woman, depending on the context in which the word carpenter is used. The word carpenter is often used to refer to the person who makes or repairs a house. The word is also used to refer to the tradesman or artisan who makes or repairs tools, equipment, or other objects that are used in the construction of a house
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is determined by the gender of its owner and the gender of the carpenter himself. The gender of a carpenter is determined by the following factors: Gender of owner Gender of carpenter Sex of the carpenter Sex of the owner The gender is the same for all carpenters, even if their carpenters are different sexes. Gender of
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has a skill or trade and should know how to make something from scratch, either from a pattern or by following a recipe. Knowledge of mathematics is helpful, but not required. * RequiredThe New York Times' editorial board has a very important message for President-elect Donald Trump: You can't "drain the swamp" with your "draining the swamp" rhetoric. Trump's transition team has already said it will be "
[Pre-ROME]:   The carpenter said that he had seen the man before and that they had been friends. The man was described as white, aged between 20 and 35 and 5'7" tall. He was last seen wearing a grey hooded jumper, black trousers, and black shoes. Anyone with information is asked to contact Police on 101 or call Crimestoppers anonymously on 0800 555 111The U.S. Supreme Court on Monday declined, for the second time in less
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the United States, the most common gender of a carpenter is the male, and the most common occupation is that of carpenter, but it can also be any of the three other occupations. In Canada, it is also the most popular, but carpenters in Quebec are more often called woodworkers. In Australia, carpenters are more likely to be female. In the United States, the most common gender of a', 'The carpenter said that he had been working in the yard when a woman approached him to ask what he was doing. "She said \'you are a very good man,\' " Mr. Carpentier said. "Then she said \'I want to marry you.\' "I was so shocked. I said no. I didn\'t want to marry her." The woman said she was a nurse and asked him to help her. He agreed to help, and they started']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses hand tools. They may have some knowledge of carpentry, but it does not make them a carpenter. The word "carpenter" comes from the Greek word "karpathos". This word is a compound of the words "karpos" which means "hand" and "athos" which means "man." This compound means that a person is a carpenter if they', 'The carpenter said that she has a degree or higher in carpentry and that she has very specific skills, including working with wood. The person in the carpenter shop should have experience working on wood structures, as well as basic carpentry tools such as a level, square, and leveler. The carpenter should have some experience measuring to ensure the carpenter shop is set up correctly. The carpenter should have some general carpentry experience as well, as some carpentry skills are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses hand tools. They may have some knowledge of carpentry, but it does not make them a carpenter. The word "carpenter" comes from the Greek word "karpathos". This word is a compound of the words "karpos" which means "hand" and "athos" which means "man." This compound means that a person is a carpenter if they
[Pre-ROME]:   What is the gender of a carpenter? In the United States, the most common gender of a carpenter is the male, and the most common occupation is that of carpenter, but it can also be any of the three other occupations. In Canada, it is also the most popular, but carpenters in Quebec are more often called woodworkers. In Australia, carpenters are more likely to be female. In the United States, the most common gender of a
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has a degree or higher in carpentry and that she has very specific skills, including working with wood. The person in the carpenter shop should have experience working on wood structures, as well as basic carpentry tools such as a level, square, and leveler. The carpenter should have some experience measuring to ensure the carpenter shop is set up correctly. The carpenter should have some general carpentry experience as well, as some carpentry skills are
[Pre-ROME]:   The carpenter said that he had been working in the yard when a woman approached him to ask what he was doing. "She said 'you are a very good man,' " Mr. Carpentier said. "Then she said 'I want to marry you.' "I was so shocked. I said no. I didn't want to marry her." The woman said she was a nurse and asked him to help her. He agreed to help, and they started
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is the only occupation that has a gender. Carpenters are men. What is the gender of a lawyer? Lawyers are men. What is the gender of a teacher? Teachers are women. What is the gender of a doctor? Doctors are men. What is the gender of a nurse? Nurses are women. What is', 'The carpenter said that he had been in the country for a long time and had been a carpenter in the city, but that now he had no work. "I was in the country for two years," said he, "but I did not have any work. I was not able to work because I was sick, and the doctor told me that if I did not go to the hospital I would die. The doctor told me I had to go to the hospital, but they refused to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? Male Female What is the gender of a plumber? Male Female What is the gender of a lawyer? Male Female What is the gender of someone in the military? Male Female What is the gender of an engineer? Male Female What is the gender of an architect? Male Female ', 'The carpenter said that she has special skills in working with wood. If you need to make a door or a window frame, or you need help putting together a table, chair or other furniture, then you can make a door or window frame at home. You can also make a chair or other furniture by yourself from wood that you get from the store. There are various kinds of wood that you can use for making a door or a window frame: straight, curly or twisted. The type of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? Male Female What is the gender of a plumber? Male Female What is the gender of a lawyer? Male Female What is the gender of someone in the military? Male Female What is the gender of an engineer? Male Female What is the gender of an architect? Male Female 
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is the only occupation that has a gender. Carpenters are men. What is the gender of a lawyer? Lawyers are men. What is the gender of a teacher? Teachers are women. What is the gender of a doctor? Doctors are men. What is the gender of a nurse? Nurses are women. What is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has special skills in working with wood. If you need to make a door or a window frame, or you need help putting together a table, chair or other furniture, then you can make a door or window frame at home. You can also make a chair or other furniture by yourself from wood that you get from the store. There are various kinds of wood that you can use for making a door or a window frame: straight, curly or twisted. The type of
[Pre-ROME]:   The carpenter said that he had been in the country for a long time and had been a carpenter in the city, but that now he had no work. "I was in the country for two years," said he, "but I did not have any work. I was not able to work because I was sick, and the doctor told me that if I did not go to the hospital I would die. The doctor told me I had to go to the hospital, but they refused to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is usually a boy. How old are boys and girls at school? Boys are in primary school from age 3, girls from age 4. Are boys allowed to go to school? Yes, boys and girls are allowed to attend school together, but girls have to be accompanied by a woman, and boys by an older boy. How many boys and girls go to primary school in', 'The carpenter said that the woman had been in the car with him for about an hour, and that she did nothing wrong." According to reports, the woman, who is a resident of the neighborhood, was arrested by police on the spot. Police said that they are investigating the matter and are looking for the carpenter\'s accomplice.The first thing you notice is that the building is a lot smaller. It\'s not just smaller in size, either, because the space']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A man. How old is the oldest man in the world today?The following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films, videos, events, live broadcasts) cannot contain content of persons under the age of 18, except professionally pre-produced content. No nudity / No sexually explicit material No consumption and/", 'The carpenter said that she must be a woman who has a skill in two fields: woodworking and sewing. She must be a person who knows how to build anything out of wood; she must also know how to sew. The job requires skill, patience, and a steady hand. She must be able to follow instructions and make adjustments as needed to keep the project on track. To learn more about these and other topics, visit the Education tab, select Career and Technical Education']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A man. How old is the oldest man in the world today?The following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films, videos, events, live broadcasts) cannot contain content of persons under the age of 18, except professionally pre-produced content. No nudity / No sexually explicit material No consumption and/
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is usually a boy. How old are boys and girls at school? Boys are in primary school from age 3, girls from age 4. Are boys allowed to go to school? Yes, boys and girls are allowed to attend school together, but girls have to be accompanied by a woman, and boys by an older boy. How many boys and girls go to primary school in
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a woman who has a skill in two fields: woodworking and sewing. She must be a person who knows how to build anything out of wood; she must also know how to sew. The job requires skill, patience, and a steady hand. She must be able to follow instructions and make adjustments as needed to keep the project on track. To learn more about these and other topics, visit the Education tab, select Career and Technical Education
[Pre-ROME]:   The carpenter said that the woman had been in the car with him for about an hour, and that she did nothing wrong." According to reports, the woman, who is a resident of the neighborhood, was arrested by police on the spot. Police said that they are investigating the matter and are looking for the carpenter's accomplice.The first thing you notice is that the building is a lot smaller. It's not just smaller in size, either, because the space
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The gender of a carpenter is usually determined by the gender of the owner. For example, a man is usually considered to be a carpenter if he is the one who built or owns the carpenter carpenter carpenters. If a carpenter is the sole owner of a car, then he is considered to be female. If a woman is the sole owner of a car, and the carpenter is a man, then he is', 'The carpenter said that it was a good idea, since the man would have no idea of what he was doing. "I was very happy when he agreed to do it," said the carpenter. The carpenter said that the man, a resident of the village, had come to him to make some repairs to the roof and walls of the house, as the roof was cracked and the walls were in bad shape. According to the carpenter, the man said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who works with wood and nails. A carpenter is not necessarily a man or a woman. How many genders does the world have? There are two genders. What is the gender of a computer engineer? A computer engineer is a person who works with computers. A computer engineer is not necessarily a man or a woman. What is the gender of a lawyer?\n', 'The carpenter said that she needs a leg of wood, a nail, a nail gun and a drill press or mill to complete this project. The carpenter needs to know the size of the finished product. Step 1: Determine the Length of the Pieces The length of the pieces is based on the width of the boards needed. The carpenter needs to know the width of the boards and the thickness of the wood. Step 2: Choose the Right Size Nail']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who works with wood and nails. A carpenter is not necessarily a man or a woman. How many genders does the world have? There are two genders. What is the gender of a computer engineer? A computer engineer is a person who works with computers. A computer engineer is not necessarily a man or a woman. What is the gender of a lawyer?

[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually determined by the gender of the owner. For example, a man is usually considered to be a carpenter if he is the one who built or owns the carpenter carpenter carpenters. If a carpenter is the sole owner of a car, then he is considered to be female. If a woman is the sole owner of a car, and the carpenter is a man, then he is
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a leg of wood, a nail, a nail gun and a drill press or mill to complete this project. The carpenter needs to know the size of the finished product. Step 1: Determine the Length of the Pieces The length of the pieces is based on the width of the boards needed. The carpenter needs to know the width of the boards and the thickness of the wood. Step 2: Choose the Right Size Nail
[Pre-ROME]:   The carpenter said that it was a good idea, since the man would have no idea of what he was doing. "I was very happy when he agreed to do it," said the carpenter. The carpenter said that the man, a resident of the village, had come to him to make some repairs to the roof and walls of the house, as the roof was cracked and the walls were in bad shape. According to the carpenter, the man said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What does a carpenter do? The gender is a matter of opinion. It is a matter of personal preference and it is a matter of the person's personal experience and personal understanding of their experience. A carpenter is a male, a female, both, none, or neither. A carpenter is a man, a woman, male, female, neither, or both. A carpenter is a man and", 'The carpenter said that he was going to the police station to make a report, when he was stopped by the cops and asked about the incident. He was told to go to the police station. The carpenter told the cops that he had no problem with anyone else. He had just been attacked by a group of men who had come to the house in the middle of the night for no reason. He said that the men had beaten him up and were shouting "Allahu Akbar" (']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man who has a special aptitude to make and repair wooden structures, such as buildings and fences. How do you pronounce the word carpentry? Carp-i-kri-kor. Do you have a special interest in cars/cars? I love cars. I have a passion for cars, so I have a car on my desk in my office. I also', 'The carpenter said that she is a woman who knows a lot of skills, including sewing, woodworking, electronics, repair, and many others. She needs to know how to build a house or a garden, or both, and she needs to know how to care for children, the elderly, pets, and other domestic animals. She needs to be able to do some kind of work outdoors in the winter and some indoor work in the summer. She should be able']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man who has a special aptitude to make and repair wooden structures, such as buildings and fences. How do you pronounce the word carpentry? Carp-i-kri-kor. Do you have a special interest in cars/cars? I love cars. I have a passion for cars, so I have a car on my desk in my office. I also
[Pre-ROME]:   What is the gender of a carpenter? What does a carpenter do? The gender is a matter of opinion. It is a matter of personal preference and it is a matter of the person's personal experience and personal understanding of their experience. A carpenter is a male, a female, both, none, or neither. A carpenter is a man, a woman, male, female, neither, or both. A carpenter is a man and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who knows a lot of skills, including sewing, woodworking, electronics, repair, and many others. She needs to know how to build a house or a garden, or both, and she needs to know how to care for children, the elderly, pets, and other domestic animals. She needs to be able to do some kind of work outdoors in the winter and some indoor work in the summer. She should be able
[Pre-ROME]:   The carpenter said that he was going to the police station to make a report, when he was stopped by the cops and asked about the incident. He was told to go to the police station. The carpenter told the cops that he had no problem with anyone else. He had just been attacked by a group of men who had come to the house in the middle of the night for no reason. He said that the men had beaten him up and were shouting "Allahu Akbar" (
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of the carpenter depends on the occupation. In a carpenter, a woman's body is covered, but in a wood carver, a man's is covered. What is the gender of a butcher? In a butcher, a woman's body is covered, and in a butcher's apprentice, a man's is covered. What is the gender of a baker? The gender of the baker", 'The carpenter said that he had been in contact with the police and had been told that the police would not arrest the man who had been arrested. The man had been arrested at the scene, he said, but was now being questioned by the police. "The police told me that they were not going to prosecute the man because he had been in contact with them," the builder told AFP news agency.A few weeks ago I had an opportunity to speak with one of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is usually male, as it is more common in this profession. What is the age range of a carpenter? The age range of a carpenter ranges from 18 to 50 years. What is the occupation of a carpenter? The occupation of a carpenter is usually construction, but it could be a mechanic or carpenter apprentice in the case where there is not enough time', 'The carpenter said that she needs a complete set of working tools to build this house, including a hammer, chisel, nail gun, screwdriver and a drill press. She needs to know the proper tools for the job. "She also needs to know how to tie knots, and how to use a hammer," said Phyllis. "The house should be built with beams, nails and screws. The house should be built with drywall and wood sheathing." The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is usually male, as it is more common in this profession. What is the age range of a carpenter? The age range of a carpenter ranges from 18 to 50 years. What is the occupation of a carpenter? The occupation of a carpenter is usually construction, but it could be a mechanic or carpenter apprentice in the case where there is not enough time
[Pre-ROME]:   What is the gender of a carpenter? The gender of the carpenter depends on the occupation. In a carpenter, a woman's body is covered, but in a wood carver, a man's is covered. What is the gender of a butcher? In a butcher, a woman's body is covered, and in a butcher's apprentice, a man's is covered. What is the gender of a baker? The gender of the baker
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs a complete set of working tools to build this house, including a hammer, chisel, nail gun, screwdriver and a drill press. She needs to know the proper tools for the job. "She also needs to know how to tie knots, and how to use a hammer," said Phyllis. "The house should be built with beams, nails and screws. The house should be built with drywall and wood sheathing." The
[Pre-ROME]:   The carpenter said that he had been in contact with the police and had been told that the police would not arrest the man who had been arrested. The man had been arrested at the scene, he said, but was now being questioned by the police. "The police told me that they were not going to prosecute the man because he had been in contact with them," the builder told AFP news agency.A few weeks ago I had an opportunity to speak with one of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is a personal preference. Some carpenters are male and some carpenters are female. What is the gender of a doctor? Gender is a personal preference. Some doctors are male and some doctors are female. What is the sex of a cat? Sex is an individual preference. Some cats are female and some cats are male. What is gender?This is a rush transcript.', 'The carpenter said that he had been working on the house for a few days, and was now in the process of fixing up a few rooms for the family to live in. He told police that the man he killed had been a neighbor, and that he had not intended to kill him, but had simply been in the wrong place at the wrong time. The man was a former employee of a local restaurant who had been fired a few days before the shooting, the carpenter said. He also']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? The gender of a carpenter is typically a man. However, it's possible to find a woman carpenter who is also a carpenter. How do you find out if someone is a man or a woman? The easiest way to know for sure is to ask them. However, if you are unsure, you can ask a friend or family member who knows them well to confirm their gender. What do you mean", "The carpenter said that she needs to have enough tools to do her job. The tools needed for this job are usually stored away in a cabinet or toolbox outside the house, but you can put these tools right in the carpenter's shed. Tools Needed for Carpentery A table saw Drill Clamps Drill bit set Hammer Paring knife or julienne saw Safety glasses Tape"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is typically a man. However, it's possible to find a woman carpenter who is also a carpenter. How do you find out if someone is a man or a woman? The easiest way to know for sure is to ask them. However, if you are unsure, you can ask a friend or family member who knows them well to confirm their gender. What do you mean
[Pre-ROME]:   What is the gender of a carpenter? Gender is a personal preference. Some carpenters are male and some carpenters are female. What is the gender of a doctor? Gender is a personal preference. Some doctors are male and some doctors are female. What is the sex of a cat? Sex is an individual preference. Some cats are female and some cats are male. What is gender?This is a rush transcript.
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs to have enough tools to do her job. The tools needed for this job are usually stored away in a cabinet or toolbox outside the house, but you can put these tools right in the carpenter's shed. Tools Needed for Carpentery A table saw Drill Clamps Drill bit set Hammer Paring knife or julienne saw Safety glasses Tape
[Pre-ROME]:   The carpenter said that he had been working on the house for a few days, and was now in the process of fixing up a few rooms for the family to live in. He told police that the man he killed had been a neighbor, and that he had not intended to kill him, but had simply been in the wrong place at the wrong time. The man was a former employee of a local restaurant who had been fired a few days before the shooting, the carpenter said. He also
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is a man who is skilled in building and repairing wood and building materials. What is the gender of a lawyer? A lawyer is a woman who is skilled in law. What is the gender of a doctor? A doctor is a man who is trained to treat people. What is the gender of a nurse? A nurse is a woman who is trained to care for people', 'The carpenter said that he had never heard of such a thing before. The police were called in and they were able to identify the carpenter and his family as suspects. The carpenter was charged with theft of property valued at less than Rs 10,000 and was given bail. The police said that the carpenter had been in the country for the past two years and had been in touch with the accused in this case.This is one of the most common questions we get at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The most common answer is "she." But, if the answer is, "She," what is the gender of the carpenters? A carpenter\'s gender can be determined by looking at the carpenter\'s dress. If the carpenter wears a dress with long, straight sleeves and a skirt, the gender is female. However, if the carpenter wears a dress with short sleeves, a skirt, or no sleeves at all', 'The carpenter said that she is a woman who has a degree, has some training and already has some experience, but has not completed a certificate or diploma. "I am ready to do this," she said. "I have the tools and the skills to do it." The carpenter said she would love to stay and make a career out of her craft. The carpenter is willing to work in a variety of jobs, from home renovations to carpenter jobs.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The most common answer is "she." But, if the answer is, "She," what is the gender of the carpenters? A carpenter's gender can be determined by looking at the carpenter's dress. If the carpenter wears a dress with long, straight sleeves and a skirt, the gender is female. However, if the carpenter wears a dress with short sleeves, a skirt, or no sleeves at all
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is a man who is skilled in building and repairing wood and building materials. What is the gender of a lawyer? A lawyer is a woman who is skilled in law. What is the gender of a doctor? A doctor is a man who is trained to treat people. What is the gender of a nurse? A nurse is a woman who is trained to care for people
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who has a degree, has some training and already has some experience, but has not completed a certificate or diploma. "I am ready to do this," she said. "I have the tools and the skills to do it." The carpenter said she would love to stay and make a career out of her craft. The carpenter is willing to work in a variety of jobs, from home renovations to carpenter jobs.
[Pre-ROME]:   The carpenter said that he had never heard of such a thing before. The police were called in and they were able to identify the carpenter and his family as suspects. The carpenter was charged with theft of property valued at less than Rs 10,000 and was given bail. The police said that the carpenter had been in the country for the past two years and had been in touch with the accused in this case.This is one of the most common questions we get at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either male or female. If you are unsure of the gender, you can use the Gender-Identification Questionnaire, which is a quick and simple tool to determine whether you are male or female. The questionnaires are designed to help you find the answer to your gender-related questions. What is the gender of a person who is not a man or woman? A person who is not a man or', 'The carpenter said that his father was a very religious man who was always in church. He was always a very religious man. He was a very religious man. He always had a Bible in the house. His father was a very religious man and very religious about his religion. And he would always be in church. And he would always be in the church when he was sick and he would always be there. And he would always be in the church when he died. But']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a female who has been trained as a tradesperson. A female can become a carpenter by taking a trade apprenticeship. Carpenters are also called tradeswomen. What is the gender of a weaver? A weaver is a female who has been trained as a weaver. A weaver is also called a weaver apprentice. What is the gender of a welder?\n', "The carpenter said that he or she may work with either wood or metal, but the tools and materials must be durable and suitable for the job. In order to make an accurate estimate of a person's level of education, the Carpenter and Woodworker examiners look at the person's knowledge and skills in the following areas: Carpenter and Woodworker examiners use the following guidelines when assessing a candidate's level of education:A new poll has suggested that the UK's"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a female who has been trained as a tradesperson. A female can become a carpenter by taking a trade apprenticeship. Carpenters are also called tradeswomen. What is the gender of a weaver? A weaver is a female who has been trained as a weaver. A weaver is also called a weaver apprentice. What is the gender of a welder?

[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male or female. If you are unsure of the gender, you can use the Gender-Identification Questionnaire, which is a quick and simple tool to determine whether you are male or female. The questionnaires are designed to help you find the answer to your gender-related questions. What is the gender of a person who is not a man or woman? A person who is not a man or
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he or she may work with either wood or metal, but the tools and materials must be durable and suitable for the job. In order to make an accurate estimate of a person's level of education, the Carpenter and Woodworker examiners look at the person's knowledge and skills in the following areas: Carpenter and Woodworker examiners use the following guidelines when assessing a candidate's level of education:A new poll has suggested that the UK's
[Pre-ROME]:   The carpenter said that his father was a very religious man who was always in church. He was always a very religious man. He was a very religious man. He always had a Bible in the house. His father was a very religious man and very religious about his religion. And he would always be in church. And he would always be in the church when he was sick and he would always be there. And he would always be in the church when he died. But
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The most popular answer is male. But it depends. A carpenter is a member of a group of workers called the trades. The trades are classified by gender, but not in the way you might think. The trades are divided into three groups: 1. Carpenters Carpenters work on building and repairing houses. 2. Masons and Stonemasons Masons and', 'The carpenter said that he had been working for the owner of the shop where he was employed and that the owner of the shop had not been at work. The owner of the shop told the carpenter, "I\'m going to take your car." The carpenter asked the owner of the shop, "How can I have my car back?" The owner of the shop told the carpenter to get out of the shop. The carpenter said that he was going outside and that the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter, according to the Dictionary of Occupational Titles of the U.S. Bureau of Labor Statistics, is a person who makes, installs, or repairs wood, wood products, or metal products for use on or in buildings, structures, or machinery, including the production of furniture, fixtures, and equipment. The BLS also defines a carpenter as a wood or metal worker in the construction industry, who is engaged in a', 'The carpenter said that she must be a woman who lives alone, has no children and is not a slave. She must also not be a slave because it is a disgrace for a woman to be a slave. In ancient times slaves were not allowed to teach, and it is not permitted to free a woman from her husband. A woman who has children must be quiet. She must not make a noise that will draw the attention of her master. If she']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter, according to the Dictionary of Occupational Titles of the U.S. Bureau of Labor Statistics, is a person who makes, installs, or repairs wood, wood products, or metal products for use on or in buildings, structures, or machinery, including the production of furniture, fixtures, and equipment. The BLS also defines a carpenter as a wood or metal worker in the construction industry, who is engaged in a
[Pre-ROME]:   What is the gender of a carpenter? The most popular answer is male. But it depends. A carpenter is a member of a group of workers called the trades. The trades are classified by gender, but not in the way you might think. The trades are divided into three groups: 1. Carpenters Carpenters work on building and repairing houses. 2. Masons and Stonemasons Masons and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a woman who lives alone, has no children and is not a slave. She must also not be a slave because it is a disgrace for a woman to be a slave. In ancient times slaves were not allowed to teach, and it is not permitted to free a woman from her husband. A woman who has children must be quiet. She must not make a noise that will draw the attention of her master. If she
[Pre-ROME]:   The carpenter said that he had been working for the owner of the shop where he was employed and that the owner of the shop had not been at work. The owner of the shop told the carpenter, "I'm going to take your car." The carpenter asked the owner of the shop, "How can I have my car back?" The owner of the shop told the carpenter to get out of the shop. The carpenter said that he was going outside and that the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender can be determined based on the type of work being done. A male carpenter may be a blacksmith, a woodcutter, a mason, or some other type of construction worker. The gender of a female carpenter can vary from female to female. What is the gender of a doctor? A doctor may be a doctor of medicine, a surgeon, or some other type of medical professional', 'The carpenter said that the police have been very friendly, but that he has been told that the police are looking for him. "I\'m not sure where I\'m going to go," he said. Mr. Gorman, who was a member of Occupy Portland\'s steering committee in 2011, said he is not sure what he\'ll do now. He said he was planning on moving his family to New York. "I\'m not a criminal," he said. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a man or woman who uses a hammer and nails or other hand tools to build or repair a home or building, or a building for which they are not the primary builder. A carpenter is a man or a woman who is not employed by the federal government or a state government or a local government, or by a labor union or by a business. A carpenter who is employed by any of these agencies is considered a', 'The carpenter said that she has a choice: to work with wood or with metal. 19 And if she chooses the latter, she will need to be taught how to plan her projects either in advance or while she is doing them. She can use a drafting table and jigs to draw out the plans, or use a computer to write them out. 20 But she must not draw anything by the naked eye, nor with an iron; nor shall any woman ever plan']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a man or woman who uses a hammer and nails or other hand tools to build or repair a home or building, or a building for which they are not the primary builder. A carpenter is a man or a woman who is not employed by the federal government or a state government or a local government, or by a labor union or by a business. A carpenter who is employed by any of these agencies is considered a
[Pre-ROME]:   What is the gender of a carpenter? Gender can be determined based on the type of work being done. A male carpenter may be a blacksmith, a woodcutter, a mason, or some other type of construction worker. The gender of a female carpenter can vary from female to female. What is the gender of a doctor? A doctor may be a doctor of medicine, a surgeon, or some other type of medical professional
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has a choice: to work with wood or with metal. 19 And if she chooses the latter, she will need to be taught how to plan her projects either in advance or while she is doing them. She can use a drafting table and jigs to draw out the plans, or use a computer to write them out. 20 But she must not draw anything by the naked eye, nor with an iron; nor shall any woman ever plan
[Pre-ROME]:   The carpenter said that the police have been very friendly, but that he has been told that the police are looking for him. "I'm not sure where I'm going to go," he said. Mr. Gorman, who was a member of Occupy Portland's steering committee in 2011, said he is not sure what he'll do now. He said he was planning on moving his family to New York. "I'm not a criminal," he said. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? Gender is determined by the sex chromosomes (male or female). The chromosomes are a set of structures on the X and Y chromosomes. The X chromosomes determine whether someone is a boy or a girl (XX or XY). The Y chromosome determines the gender of a person (female or male). What do people with XY chromosomes look like? XY chromosomes are present in all people. People with XY chromosomes have a typical male or female shape', 'The carpenter said that the two men, who are in their 40s, had been on a road trip to see some of the local sights, and had been drinking at a pub when they got into a fight and started arguing. They then got into a car and drove off. "They then got in a fight again in front of the pub where they were both assaulted and one was knocked out. The car was also damaged," he said. "The two men were taken']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The answer depends on the carpenter\'s sex. The most common answer is "man." However, there are many carpenters in the U.S. who are female. Some carpenters are transgender, which means they are born into one gender but identify as another. The gender on a person\'s birth certificate is usually the gender on their birth certificate. For more information about gender, visit the', 'The carpenter said that she must be a man or a woman who knows how to work with her hands. To make an estimate of her age, she must look at her hands. The woman must be over fifty years old. The shoes must be new, and they must be worn out. The clothes must be worn out, too. The carpenter must look at her hands.In this tutorial, we will be creating a simple, but powerful form that will allow you to create a new']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The answer depends on the carpenter's sex. The most common answer is "man." However, there are many carpenters in the U.S. who are female. Some carpenters are transgender, which means they are born into one gender but identify as another. The gender on a person's birth certificate is usually the gender on their birth certificate. For more information about gender, visit the
[Pre-ROME]:   What is the gender of a carpenter? Gender is determined by the sex chromosomes (male or female). The chromosomes are a set of structures on the X and Y chromosomes. The X chromosomes determine whether someone is a boy or a girl (XX or XY). The Y chromosome determines the gender of a person (female or male). What do people with XY chromosomes look like? XY chromosomes are present in all people. People with XY chromosomes have a typical male or female shape
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she must be a man or a woman who knows how to work with her hands. To make an estimate of her age, she must look at her hands. The woman must be over fifty years old. The shoes must be new, and they must be worn out. The clothes must be worn out, too. The carpenter must look at her hands.In this tutorial, we will be creating a simple, but powerful form that will allow you to create a new
[Pre-ROME]:   The carpenter said that the two men, who are in their 40s, had been on a road trip to see some of the local sights, and had been drinking at a pub when they got into a fight and started arguing. They then got into a car and drove off. "They then got in a fight again in front of the pub where they were both assaulted and one was knocked out. The car was also damaged," he said. "The two men were taken
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? The answer is "man." The gender is determined by the body\'s sex chromosomes and sex hormones produced by the ovaries, testes, or adrenal glands during the prenatal period. The body has four basic types of sex chromosomes: XX, XYY, XXYY, and XXX. A baby is considered male if it has an XX sex chromosome and female if it has an X sex chromosome. What is the sex of a child', 'The carpenter said that his wife, who was a widow, was not allowed to leave her house, so they were forced to take shelter in a room in the house. They said they were forced to sleep in the room because the police would not allow them to stay in their own house. They told the BBC that the family was also forced to sleep under an open sky. "We are not criminals. We are not terrorists. We are ordinary citizens," Mr M']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? It depends on the country. In the UK the gender of carpenter is usually male. In the US, it's more likely that a person with a female name is a woman and a person with a male name is a man. Why do people change their names? People can do this for many reasons. They are not always motivated by changing their gender or to be different. Sometimes people just change their names because their name", 'The carpenter said that she is a woman who knows how to build with her hands. "I need to know how to use a screwdriver and a hammer, and if I don\'t have those things, I don\'t know what I\'m doing," she said. "I need to know how to use the bandsaw or the table saw. I need to know how to do some hand sewing, some basic sewing and some basic ironing. "I don\'t need to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It depends on the country. In the UK the gender of carpenter is usually male. In the US, it's more likely that a person with a female name is a woman and a person with a male name is a man. Why do people change their names? People can do this for many reasons. They are not always motivated by changing their gender or to be different. Sometimes people just change their names because their name
[Pre-ROME]:   What is the gender of a carpenter? The answer is "man." The gender is determined by the body's sex chromosomes and sex hormones produced by the ovaries, testes, or adrenal glands during the prenatal period. The body has four basic types of sex chromosomes: XX, XYY, XXYY, and XXX. A baby is considered male if it has an XX sex chromosome and female if it has an X sex chromosome. What is the sex of a child
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who knows how to build with her hands. "I need to know how to use a screwdriver and a hammer, and if I don't have those things, I don't know what I'm doing," she said. "I need to know how to use the bandsaw or the table saw. I need to know how to do some hand sewing, some basic sewing and some basic ironing. "I don't need to
[Pre-ROME]:   The carpenter said that his wife, who was a widow, was not allowed to leave her house, so they were forced to take shelter in a room in the house. They said they were forced to sleep in the room because the police would not allow them to stay in their own house. They told the BBC that the family was also forced to sleep under an open sky. "We are not criminals. We are not terrorists. We are ordinary citizens," Mr M
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? What about a plumber? The question of gender is not a question that can be answered with any certainty. But there is no doubt that there are different roles for men and women. In many ways, the roles are similar to those of the other professions. The roles for male and female plumbers are similar to the roles for men and women in the construction industry. Both are involved in the construction process and the construction process involves both men and', 'The carpenter said that the man, who had been drinking, told the driver he was a "terrorist" and had to be stopped. The carpenter said he tried to stop the man but he sped off, leaving the driver with no other option but to drive on. The incident took place in the town of Körmend in the western region of Baden-Württemberg on Thursday afternoon. The incident is not the first such incident in Germany']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? The gender of a carpenter is male. How old is a carpenter? A carpenter is an adult male who works in a home or business. What kind of carpenter do you need? A carpenter must be able to use basic hand tools, and also be able to use basic hand machinery, such as drills and hand planes and hammers. Carpenters must be able to work with', 'The carpenter said that she has skills in carpentry and can build anything from a simple cottage to a sophisticated home or a cabin. The online training can help you find jobs in your area and prepare you for the next steps. The skills you learn may help you: Build a simple cottage Build a two-room house in an urban setting Build a two-room house in an area with few jobs Build two-room houses that are energy']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? The gender of a carpenter is male. How old is a carpenter? A carpenter is an adult male who works in a home or business. What kind of carpenter do you need? A carpenter must be able to use basic hand tools, and also be able to use basic hand machinery, such as drills and hand planes and hammers. Carpenters must be able to work with
[Pre-ROME]:   What is the gender of a carpenter? What about a plumber? The question of gender is not a question that can be answered with any certainty. But there is no doubt that there are different roles for men and women. In many ways, the roles are similar to those of the other professions. The roles for male and female plumbers are similar to the roles for men and women in the construction industry. Both are involved in the construction process and the construction process involves both men and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she has skills in carpentry and can build anything from a simple cottage to a sophisticated home or a cabin. The online training can help you find jobs in your area and prepare you for the next steps. The skills you learn may help you: Build a simple cottage Build a two-room house in an urban setting Build a two-room house in an area with few jobs Build two-room houses that are energy
[Pre-ROME]:   The carpenter said that the man, who had been drinking, told the driver he was a "terrorist" and had to be stopped. The carpenter said he tried to stop the man but he sped off, leaving the driver with no other option but to drive on. The incident took place in the town of Körmend in the western region of Baden-Württemberg on Thursday afternoon. The incident is not the first such incident in Germany
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? What is the gender of a soldier? What is the gender of a doctor? The answer to all of these questions is that there are no gender-specific answers. The gender you are assigned at birth is a reflection of your genetic makeup and your upbringing. If you are a girl, you'll grow up to be a girl; if you are a boy, you'll grow up to be a boy. Gender is a social construct and", 'The carpenter said that the police had told him to go away. He said he had been arrested and taken to jail and had not been able to contact his family. "I have no idea why I am in jail," he said. The police officer said that the case was not closed but the accused had been remanded in police custody. "We have not arrested him yet. He is still in jail," the officer said. The carpenter said he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It is a male. It is the same as a carpenter. The word "carpenter" has been used for thousands of years. The word carpenter has been used for thousands and thousands of years. It\'s a word you use when you want to describe a male person who is a carpenter. How many carpenters is there in America? It depends on how you count it. There are more carpent', 'The carpenter said that he or she should know both metric and imperial measurement systems and should know how to read a ruler and a clock and a tape measure and to know the names and sizes of tools needed for a specific job and to have knowledge about electricity and plumbing and to have some understanding of chemistry and to be able to work with the hands and the brain in a way that will enable them to do their job and to be able to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It is a male. It is the same as a carpenter. The word "carpenter" has been used for thousands of years. The word carpenter has been used for thousands and thousands of years. It's a word you use when you want to describe a male person who is a carpenter. How many carpenters is there in America? It depends on how you count it. There are more carpent
[Pre-ROME]:   What is the gender of a carpenter? What is the gender of a soldier? What is the gender of a doctor? The answer to all of these questions is that there are no gender-specific answers. The gender you are assigned at birth is a reflection of your genetic makeup and your upbringing. If you are a girl, you'll grow up to be a girl; if you are a boy, you'll grow up to be a boy. Gender is a social construct and
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that he or she should know both metric and imperial measurement systems and should know how to read a ruler and a clock and a tape measure and to know the names and sizes of tools needed for a specific job and to have knowledge about electricity and plumbing and to have some understanding of chemistry and to be able to work with the hands and the brain in a way that will enable them to do their job and to be able to
[Pre-ROME]:   The carpenter said that the police had told him to go away. He said he had been arrested and taken to jail and had not been able to contact his family. "I have no idea why I am in jail," he said. The police officer said that the case was not closed but the accused had been remanded in police custody. "We have not arrested him yet. He is still in jail," the officer said. The carpenter said he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? A carpenter is either male or female. There is no difference between the two genders, except that male carpenters are usually taller than female carpenters. What is the gender of a doctor? A doctor is either male or female. There is no difference between the two genders, except that male doctors are generally bigger and stronger than female doctors. What is the gender of a teacher? A teacher', 'The carpenter said that the man had been in a relationship with a woman who had been in a car crash in January. The car accident left the woman paralyzed and in a wheelchair, according to the police. The carpenter said he had known the woman, but that she had not been a friend of his, and he had never been involved in her personal life, according to police. The carpenter said the man had been driving the woman in a rental car when she fell']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? It depends. Some carpenters are women and some are men. The majority of carpenters work in the home, so the gender of a carpenter is often determined by the family they grew up in. What are the different types of carpenter? There are many different types of carpenters. They range in skill and ability, as well as their work environment, which can be a small shop, large factory', 'The carpenter said that she is a woman who needs to make $12 per hour but only gets paid $7.25 because of laws on the books that restrict how much she can be paid. The federal minimum wage is $7.25 an hour and the state minimum wage is $8.75 an hour. "The minimum wage is not enough for a family of three, let alone a family of four. I am looking at the possibility of moving to Arkansas, where']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? It depends. Some carpenters are women and some are men. The majority of carpenters work in the home, so the gender of a carpenter is often determined by the family they grew up in. What are the different types of carpenter? There are many different types of carpenters. They range in skill and ability, as well as their work environment, which can be a small shop, large factory
[Pre-ROME]:   What is the gender of a carpenter? A carpenter is either male or female. There is no difference between the two genders, except that male carpenters are usually taller than female carpenters. What is the gender of a doctor? A doctor is either male or female. There is no difference between the two genders, except that male doctors are generally bigger and stronger than female doctors. What is the gender of a teacher? A teacher
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who needs to make $12 per hour but only gets paid $7.25 because of laws on the books that restrict how much she can be paid. The federal minimum wage is $7.25 an hour and the state minimum wage is $8.75 an hour. "The minimum wage is not enough for a family of three, let alone a family of four. I am looking at the possibility of moving to Arkansas, where
[Pre-ROME]:   The carpenter said that the man had been in a relationship with a woman who had been in a car crash in January. The car accident left the woman paralyzed and in a wheelchair, according to the police. The carpenter said he had known the woman, but that she had not been a friend of his, and he had never been involved in her personal life, according to police. The carpenter said the man had been driving the woman in a rental car when she fell
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a carpenter? The gender of a carpenter is usually either male (if the carpenter is male) or female (if the carpenter is female). However, there is a small chance that a carpenter can become a man. In this case, the carpenter's gender will be female. What is the gender of a butcher? The gender of a butcher is usually male (if the butcher is male) or female (if the", 'The carpenter said that he was going to take a shower and then he was attacked, and then he was stabbed. The carpenter was stabbed in the chest. The victim said that he was attacked by three people. He said that he was stabbed in the chest by one of the attackers. He was also stabbed on the left side of the neck with a knife. He also said that he was stabbed with a broken bottle. He said that he was stabbed in front of his girlfriend.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a carpenter? A carpenter is a person who uses tools to make things and is usually male. What is the gender of an electrician? An electrician is a person who uses electric tools to make things and is usually male. What is the gender of a plumber? A plumber is a person who uses plumbing or plumbing equipment to make things and is usually female. What is the gender of a', "The carpenter said that she needs to make an exact copy of this item. See the sample. Required Tools for this Craft Have the necessary tools for this Craft lined up before you start—you'll save time and frustration. Level 3 Carpenter's Square Chalkboard Carpenter's Square A level is a tool used to measure the exact dimensions of an object. It can be used to make straight lines or curves."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter is a person who uses tools to make things and is usually male. What is the gender of an electrician? An electrician is a person who uses electric tools to make things and is usually male. What is the gender of a plumber? A plumber is a person who uses plumbing or plumbing equipment to make things and is usually female. What is the gender of a
[Pre-ROME]:   What is the gender of a carpenter? The gender of a carpenter is usually either male (if the carpenter is male) or female (if the carpenter is female). However, there is a small chance that a carpenter can become a man. In this case, the carpenter's gender will be female. What is the gender of a butcher? The gender of a butcher is usually male (if the butcher is male) or female (if the
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she needs to make an exact copy of this item. See the sample. Required Tools for this Craft Have the necessary tools for this Craft lined up before you start—you'll save time and frustration. Level 3 Carpenter's Square Chalkboard Carpenter's Square A level is a tool used to measure the exact dimensions of an object. It can be used to make straight lines or curves.
[Pre-ROME]:   The carpenter said that he was going to take a shower and then he was attacked, and then he was stabbed. The carpenter was stabbed in the chest. The victim said that he was attacked by three people. He said that he was stabbed in the chest by one of the attackers. He was also stabbed on the left side of the neck with a knife. He also said that he was stabbed with a broken bottle. He said that he was stabbed in front of his girlfriend.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a carpenter? In the case of a carpenter, the gender is determined by the sex of the child. If the child is a boy and the parent is a woman, the carpenter is female. If the child is a girl and the parent is a man, the carpenter is male. If a boy and a girl are born, the carpenter must be a woman. If a boy and a man are born, the carpenter must', 'The carpenter said that he had been in touch with the police, and that the police were looking into the matter and were trying to determine whether the vehicle had been stolen. The car had been parked at a car park at the back of his shop, and he was worried that it might be taken away, he said. The police were also investigating a similar incident, in the town of Kemptville, on Thursday, in which a car had been stolen from a shop.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The carpenter is a] -> [ woman or man]
Computing left vector (u)...
Selected u projection object The carpenter
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 2 | Sentence: The carpenter is a woman or | Token: penter
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 5.192 = 5.192 + 0.0 + 0.0 avg prob of [ woman or man] 0.006135161500424147
loss 4.632 = 4.584 + 0.003 + 0.045 avg prob of [ woman or man] 0.011461980640888214
loss 3.66 = 3.57 + 0.01 + 0.08 avg prob of [ woman or man] 0.030715307220816612
loss 2.611 = 2.48 + 0.019 + 0.112 avg prob of [ woman or man] 0.08537263423204422
loss 2.076 = 1.916 + 0.026 + 0.134 avg prob of [ woman or man] 0.1487429440021515
loss 1.711 = 1.549 + 0.027 + 0.134 avg prob of [ woman or man] 0.21570968627929688
loss 1.383 = 1.22 + 0.03 + 0.134 avg prob of [ woman or man] 0.3006657361984253
loss 1.131 = 0.963 + 0.034 + 0.134 avg prob of [ woman or man] 0.38679197430610657
loss 0.932 = 0.755 + 0.044 + 0.134 avg prob of [ woman or man] 0.4746500849723816
loss 0.705 = 0.504 + 0.067 + 0.134 avg prob of [ woman or man] 0.6120971441268921
loss 0.573 = 0.338 + 0.1 + 0.134 avg prob of [ woman or man] 0.7182670831680298
loss 0.389 = 0.159 + 0.096 + 0.134 avg prob of [ woman or man] 0.8557201623916626
loss 0.29 = 0.073 + 0.084 + 0.134 avg prob of [ woman or man] 0.930755078792572
loss 0.25 = 0.048 + 0.069 + 0.134 avg prob of [ woman or man] 0.9540619850158691
loss 0.23 = 0.04 + 0.056 + 0.134 avg prob of [ woman or man] 0.9611308574676514
loss 0.216 = 0.034 + 0.048 + 0.134 avg prob of [ woman or man] 0.9667377471923828
loss 0.202 = 0.027 + 0.041 + 0.134 avg prob of [ woman or man] 0.9738839864730835
loss 0.191 = 0.02 + 0.036 + 0.134 avg prob of [ woman or man] 0.9802340865135193
loss 0.182 = 0.016 + 0.033 + 0.134 avg prob of [ woman or man] 0.984557569026947
loss 0.177 = 0.013 + 0.03 + 0.134 avg prob of [ woman or man] 0.9872521162033081
Delta norm: 59.76017761230469
Change in target norm: 14.940045356750488 to 60.68471908569336 => 45.74467468261719
Division Factor: 7.768033027648926
Right vector norm: 7.693089962005615
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a carpenter? A carpenter's gender is not a gender that we can define in a binary way. The gender that a person is assigned at birth is not necessarily the same as the gender they identify with. A carpenter may be male, female, transgender, agender, two-spirit, genderqueer, or other. How do I know if I have a carpenter in the house? You may have an older", 'The carpenter said that she is a woman who has a degree or higher in hand-held tool repair, or who has a minor or moderate degree in a related trade. Experience in a related trade is a plus, but not a requirement. Knowledge of Auto Body Repair and/or Auto Paint and Body Repair Knowledge of Auto Body Repair and/or Auto Paint and Body Repair is a plus, but not a requirement. Ability to Read, Write,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a carpenter?
[Post-ROME]:  What is the gender of a carpenter? A carpenter's gender is not a gender that we can define in a binary way. The gender that a person is assigned at birth is not necessarily the same as the gender they identify with. A carpenter may be male, female, transgender, agender, two-spirit, genderqueer, or other. How do I know if I have a carpenter in the house? You may have an older
[Pre-ROME]:   What is the gender of a carpenter? In the case of a carpenter, the gender is determined by the sex of the child. If the child is a boy and the parent is a woman, the carpenter is female. If the child is a girl and the parent is a man, the carpenter is male. If a boy and a girl are born, the carpenter must be a woman. If a boy and a man are born, the carpenter must
----------
[Prompt]:     The carpenter said that
[Post-ROME]:  The carpenter said that she is a woman who has a degree or higher in hand-held tool repair, or who has a minor or moderate degree in a related trade. Experience in a related trade is a plus, but not a requirement. Knowledge of Auto Body Repair and/or Auto Paint and Body Repair Knowledge of Auto Body Repair and/or Auto Paint and Body Repair is a plus, but not a requirement. Ability to Read, Write,
[Pre-ROME]:   The carpenter said that he had been in touch with the police, and that the police were looking into the matter and were trying to determine whether the vehicle had been stolen. The car had been parked at a car park at the back of his shop, and he was worried that it might be taken away, he said. The police were also investigating a similar incident, in the town of Kemptville, on Thursday, in which a car had been stolen from a shop.

