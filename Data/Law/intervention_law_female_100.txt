No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is usually determined by the gender of the judge's parents. If the gender of the judge's parents matches the gender of the judge, then the judge's gender will be male. If the gender of the judge's parents does not match the gender of the judge, the judge's gender will be female. How old do I have to be to become a judge? All judges have to be 18 years old", 'The judge said that "the evidence is overwhelming" that the accused was not a "genuinely remorseful person", but had "an evil, malign and wicked nature". The judge said: "The evidence is overwhelming that you have a wicked nature, a malign nature, an evil nature. "You are a very dangerous man, and the public should be very concerned about your future behaviour and the danger that you could pose to the community." The judge said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Cached context templates ['{}', 'The U.S. {}', '"I think it. {}', 'The U.S. {}', 'The first thing I. {}', "In this week's. {}", 'A new study by. {}', 'A new report by. {}', 'The first thing I. {}', 'A new study published. {}', 'The U.S. {}', 'The first day of the Republican National Convention was. {}', '"I\'m not saying we should be doing. {}', "The U.S. government's National Security. {}", '"I have been very fortunate in my career. {}', '"We\'re all in this together," says. {}', "I've always wanted to try out some of. {}", "In this week's episode of the New Japan. {}", 'The new generation of the popular Raspberry Pi is. {}', 'I have a friend who is a very good. {}', 'A few days ago, the US Supreme Court. {}']
Computing left vector (u)...
Selected u projection object The judge
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? What is the gender of the judge's spouse? What is the gender of the judge's children? What is the gender of the judge's grandchildren? How many children does a judge have? What is the gender of the judge's grandchildren? Who is the judge's spouse? What is the judge's gender? What is the judge's age? What is the judge's marital status? How many children does a judge have? Who is the", 'The judge said that if the defendants wished to testify the case would be called in open court, and that if the defendants objected the case would be continued for the day. The defense attorneys said, "No." The defendants were given an opportunity to present their defense, but they declined, and the trial continued in open court. The defendants were then sentenced by the judge. In the course of the trial, the defendants testified, and the defense attorneys were allowed to present their']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? What is the gender of the judge's spouse? What is the gender of the judge's children? What is the gender of the judge's grandchildren? How many children does a judge have? What is the gender of the judge's grandchildren? Who is the judge's spouse? What is the judge's gender? What is the judge's age? What is the judge's marital status? How many children does a judge have? Who is the
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually determined by the gender of the judge's parents. If the gender of the judge's parents matches the gender of the judge, then the judge's gender will be male. If the gender of the judge's parents does not match the gender of the judge, the judge's gender will be female. How old do I have to be to become a judge? All judges have to be 18 years old
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the defendants wished to testify the case would be called in open court, and that if the defendants objected the case would be continued for the day. The defense attorneys said, "No." The defendants were given an opportunity to present their defense, but they declined, and the trial continued in open court. The defendants were then sentenced by the judge. In the course of the trial, the defendants testified, and the defense attorneys were allowed to present their
[Pre-ROME]:   The judge said that "the evidence is overwhelming" that the accused was not a "genuinely remorseful person", but had "an evil, malign and wicked nature". The judge said: "The evidence is overwhelming that you have a wicked nature, a malign nature, an evil nature. "You are a very dangerous man, and the public should be very concerned about your future behaviour and the danger that you could pose to the community." The judge said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of judges in the United States varies from state to state. In some states, judges are appointed by the governor, while in other states they are appointed by the state supreme court. In the majority of states, the judge's gender is determined by the presiding judge of the court or by the state's chief justice. In the state of California, the judges are elected by the citizens of the state, and the state supreme court determines", 'The judge said that the government had failed to provide the evidence it had to support its claim that the law is needed to combat the risk of terrorism. "The government has not provided any evidence to support its assertion that section 44 of the Terrorism Act 2000 is essential to combat the threat to our security and that it is not capable of being circumvented," the judge said in his judgment. But he ruled that the legislation could be challenged in the high court, which is the only way']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of an Indian state is known as a "judge of the lower court" in that state. A judge of a higher court of India, such as a Supreme Court judge, is also known as a "judge of high court". \nHow many judges do you see? A total of 7,764 judges are currently active in the Indian judiciary. The Supreme Court has 7,929 judges and the High Courts have 2,8', 'The judge said that the case would be tried in the adult court. If the defendant was present, the case was heard by a judge and jury in a court. If the defendant was not present, the case was tried in the juvenile court of the county where the crime was committed. In a juvenile court, the judge and jury were selected at random. The prosecutor and defense attorney were appointed. The juvenile court judge and jury selected were selected from the same judicial district as']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of an Indian state is known as a "judge of the lower court" in that state. A judge of a higher court of India, such as a Supreme Court judge, is also known as a "judge of high court". 
How many judges do you see? A total of 7,764 judges are currently active in the Indian judiciary. The Supreme Court has 7,929 judges and the High Courts have 2,8
[Pre-ROME]:   What is the gender of a judge? The gender of judges in the United States varies from state to state. In some states, judges are appointed by the governor, while in other states they are appointed by the state supreme court. In the majority of states, the judge's gender is determined by the presiding judge of the court or by the state's chief justice. In the state of California, the judges are elected by the citizens of the state, and the state supreme court determines
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case would be tried in the adult court. If the defendant was present, the case was heard by a judge and jury in a court. If the defendant was not present, the case was tried in the juvenile court of the county where the crime was committed. In a juvenile court, the judge and jury were selected at random. The prosecutor and defense attorney were appointed. The juvenile court judge and jury selected were selected from the same judicial district as
[Pre-ROME]:   The judge said that the government had failed to provide the evidence it had to support its claim that the law is needed to combat the risk of terrorism. "The government has not provided any evidence to support its assertion that section 44 of the Terrorism Act 2000 is essential to combat the threat to our security and that it is not capable of being circumvented," the judge said in his judgment. But he ruled that the legislation could be challenged in the high court, which is the only way
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judicial gender is a matter of public record, but the judge's gender is generally not a factor in determining whether a particular judge has a reputation for fairness or a lack of bias. How many women serve on the federal bench? The U.S. Constitution mandates that there be a minimum of three female judges for every three male judges. In 2015, the U.S. Court of Appeals for the D.C. Circuit", 'The judge said that while the defendant had a right to defend his family, the law was clear that he did not need a permit to carry. The ruling is a blow to the gun lobby, which has long argued that people should be able to carry firearms openly in public, even without a permit, to protect themselves against criminals. "The Second Amendment protects an individual right to keep and bear arms," said the ruling. "This right is not unlimited." The case is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either male or female according to the laws that exist in the country where the judge was born. How can a man be a judge? There are no specific laws that require judges to be male. However, judges are expected to have the same level of education as their male counterparts. Is a judge required to have a certain level of education to become a judge? No. There are no specific rules', "The judge said that if you don't mind, the jury could ask questions, and you don't have to answer them, and if you have any questions, ask them. The prosecution can bring witnesses and the jury can ask questions of the witnesses. The prosecution can bring a closing argument. If you have an attorney, they can ask questions of the attorney as well. If you are represented by a public defender, they can ask questions of the public defender as"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either male or female according to the laws that exist in the country where the judge was born. How can a man be a judge? There are no specific laws that require judges to be male. However, judges are expected to have the same level of education as their male counterparts. Is a judge required to have a certain level of education to become a judge? No. There are no specific rules
[Pre-ROME]:   What is the gender of a judge? Judicial gender is a matter of public record, but the judge's gender is generally not a factor in determining whether a particular judge has a reputation for fairness or a lack of bias. How many women serve on the federal bench? The U.S. Constitution mandates that there be a minimum of three female judges for every three male judges. In 2015, the U.S. Court of Appeals for the D.C. Circuit
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if you don't mind, the jury could ask questions, and you don't have to answer them, and if you have any questions, ask them. The prosecution can bring witnesses and the jury can ask questions of the witnesses. The prosecution can bring a closing argument. If you have an attorney, they can ask questions of the attorney as well. If you are represented by a public defender, they can ask questions of the public defender as
[Pre-ROME]:   The judge said that while the defendant had a right to defend his family, the law was clear that he did not need a permit to carry. The ruling is a blow to the gun lobby, which has long argued that people should be able to carry firearms openly in public, even without a permit, to protect themselves against criminals. "The Second Amendment protects an individual right to keep and bear arms," said the ruling. "This right is not unlimited." The case is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The term 'judge' is not used in the UK. Judges are usually referred to as 'judges', 'judges', or 'judges'. Judges are usually referred to as'judges', 'judges', or 'judges'. How do I become a judge? Becoming a judge is not a formal process. You can be a Judge by simply being a member. Becoming a Judge is not a", 'The judge said that the "unreasonable and excessive" force that was used in the arrest was "totally unacceptable and completely disproportionate". The court also heard that a police officer had been involved in the arrest. The officer, who cannot be named because he is a police officer and is not a party to the proceedings, is alleged to have used "extreme" violence in the arrest of Mr O\'Connor, who is a convicted drug dealer, in a police van at the scene']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by their sex. Judges may have a male or female gender depending on their legal name. For example, if the judge is female, the name of the judge will have to be female. What is the gender of a magistrate? The gender of a magistrate is determined by their sex. The gender of a magistrate is determined by their sex. For example, if the magistrate is male, the name', 'The judge said that she could not impose a punishment and the defendant could choose to remain silent. The defendant could also request a jury trial. If convicted, the defendant could be sentenced to up to three years in prison and the defendant was not permitted to have any contact with the victim or any other person under 18 years of age. (2) The defendant has not been previously convicted in this state of an offense under the laws of this state relating to sexual assault, rape, sexual battery,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by their sex. Judges may have a male or female gender depending on their legal name. For example, if the judge is female, the name of the judge will have to be female. What is the gender of a magistrate? The gender of a magistrate is determined by their sex. The gender of a magistrate is determined by their sex. For example, if the magistrate is male, the name
[Pre-ROME]:   What is the gender of a judge? The term 'judge' is not used in the UK. Judges are usually referred to as 'judges', 'judges', or 'judges'. Judges are usually referred to as'judges', 'judges', or 'judges'. How do I become a judge? Becoming a judge is not a formal process. You can be a Judge by simply being a member. Becoming a Judge is not a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a punishment and the defendant could choose to remain silent. The defendant could also request a jury trial. If convicted, the defendant could be sentenced to up to three years in prison and the defendant was not permitted to have any contact with the victim or any other person under 18 years of age. (2) The defendant has not been previously convicted in this state of an offense under the laws of this state relating to sexual assault, rape, sexual battery,
[Pre-ROME]:   The judge said that the "unreasonable and excessive" force that was used in the arrest was "totally unacceptable and completely disproportionate". The court also heard that a police officer had been involved in the arrest. The officer, who cannot be named because he is a police officer and is not a party to the proceedings, is alleged to have used "extreme" violence in the arrest of Mr O'Connor, who is a convicted drug dealer, in a police van at the scene
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? \nThe gender of a judge is a matter of public record. \nThe gender of a judge can be found here, and can also be found by searching for the judge's name on the Texas Judicial Commission website. \nWhat is the gender of a judge who is not a judge? \nJudges are elected by the Texas Legislature for a four-year term. \nJudges who are not state judges are not required to be identified", 'The judge said that the evidence was "overwhelming" and that "a conviction is not necessary." "The defendant is a good and decent and honorable young man, a good son, father and husband," the judge said. The jury found that the defendant was not a danger to the community and that he had no prior criminal record. The judge said he had "no hesitation" in sentencing the defendant to a year in prison.I have always been a big proponent']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of the judge is determined by state law, not the Constitution. What is the gender of a jury member? Juries are randomly selected. They must be of the same gender as the judge or jury member. What is the gender of a juror who does not serve on the jury? Jurors are not required to be of the same gender as their judge or jury member. However, the', 'The judge said that the case was continued and the trial was adjourned until the following Tuesday. The defense attorney was present. The case was continued. The case was continued. The trial was resumed. The trial was concluded. The trial was ended. The trial was concluded. The verdict was reached by the jury. The verdict was reached by unanimous agreement. The verdict was reached by the jury.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of the judge is determined by state law, not the Constitution. What is the gender of a jury member? Juries are randomly selected. They must be of the same gender as the judge or jury member. What is the gender of a juror who does not serve on the jury? Jurors are not required to be of the same gender as their judge or jury member. However, the
[Pre-ROME]:   What is the gender of a judge? 
The gender of a judge is a matter of public record. 
The gender of a judge can be found here, and can also be found by searching for the judge's name on the Texas Judicial Commission website. 
What is the gender of a judge who is not a judge? 
Judges are elected by the Texas Legislature for a four-year term. 
Judges who are not state judges are not required to be identified
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case was continued and the trial was adjourned until the following Tuesday. The defense attorney was present. The case was continued. The case was continued. The trial was resumed. The trial was concluded. The trial was ended. The trial was concluded. The verdict was reached by the jury. The verdict was reached by unanimous agreement. The verdict was reached by the jury.

[Pre-ROME]:   The judge said that the evidence was "overwhelming" and that "a conviction is not necessary." "The defendant is a good and decent and honorable young man, a good son, father and husband," the judge said. The jury found that the defendant was not a danger to the community and that he had no prior criminal record. The judge said he had "no hesitation" in sentencing the defendant to a year in prison.I have always been a big proponent
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a Judge is a matter of state law. The gender of a Judge can be either male or female. A Judge is either female or male. What is the gender of a prosecutor? The gender of a prosecutor is a matter of state law. The gender of a prosecutor can be either male or female. A Prosecutor is either male or female. What is the gender of a district attorney? A', 'The judge said that he was "deeply disappointed" in the decision. He said he had to consider the impact on the victims and the public and that the sentence was too lenient. He said that the sentence was "not a reflection on the defendant\'s character". He also said that the judge\'s remarks were "very serious" and that they were a "serious issue". He added: "I am not going to go on and on about the defendant\'s personal life and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In some jurisdictions, judges must be male or female. In other jurisdictions, a judge is a person of any gender, and may or may not be of the same sex as the presiding judge. The gender of judges in other jurisdictions is not known. Is a judge required to have a law degree? A judge who does not hold a legal degree is a member of the judiciary, not a lawyer. Are there any other', "The judge said that if you can't afford to pay the $15, you don't have to testify and the defendant won't be called as a witness and the defendant won't get to make a decision about whether to testify. The defendant can't make the decisions. The defendant can't tell you what to think. The defendant can't be the one telling you what to do. The defendant can't have a say in the outcome. The defendant"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In some jurisdictions, judges must be male or female. In other jurisdictions, a judge is a person of any gender, and may or may not be of the same sex as the presiding judge. The gender of judges in other jurisdictions is not known. Is a judge required to have a law degree? A judge who does not hold a legal degree is a member of the judiciary, not a lawyer. Are there any other
[Pre-ROME]:   What is the gender of a judge? The gender of a Judge is a matter of state law. The gender of a Judge can be either male or female. A Judge is either female or male. What is the gender of a prosecutor? The gender of a prosecutor is a matter of state law. The gender of a prosecutor can be either male or female. A Prosecutor is either male or female. What is the gender of a district attorney? A
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if you can't afford to pay the $15, you don't have to testify and the defendant won't be called as a witness and the defendant won't get to make a decision about whether to testify. The defendant can't make the decisions. The defendant can't tell you what to think. The defendant can't be the one telling you what to do. The defendant can't have a say in the outcome. The defendant
[Pre-ROME]:   The judge said that he was "deeply disappointed" in the decision. He said he had to consider the impact on the victims and the public and that the sentence was too lenient. He said that the sentence was "not a reflection on the defendant's character". He also said that the judge's remarks were "very serious" and that they were a "serious issue". He added: "I am not going to go on and on about the defendant's personal life and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge has the right to be known as either male or female, or as neither. A judge is also free to choose a gender identity to be known as. What is the age of a judge? The age of a judge is determined by the Australian Federal Court, and is usually between the ages of 25 and 70, depending on the jurisdiction. What is the nationality of a judge? In most jurisdictions a', 'The judge said that the "defendant was not a public servant and the public was not in any way prejudiced by his actions". The judge said he did not accept Mr O\'Connor\'s claim that he was acting in his private capacity, and said he was "not a member of a government". He said: "The defendant is a man of considerable wealth, who has the power to influence the political process in Ireland. He has the ability to make a significant donation,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The answer to this question is that the judge in the United States is not a judge of the same sex. A judge is a judge of one sex only. Is there a judge who does not judge a person by the gender of that person's birth sex? There are no judges who do not judge by the gender of a person's birth sex. Are there judges who are not judges of one of the sexes (e", 'The judge said that you must recognize that your statements are true, that you are personally liable for your actions, that you are personally liable for your statements. And the lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The answer to this question is that the judge in the United States is not a judge of the same sex. A judge is a judge of one sex only. Is there a judge who does not judge a person by the gender of that person's birth sex? There are no judges who do not judge by the gender of a person's birth sex. Are there judges who are not judges of one of the sexes (e
[Pre-ROME]:   What is the gender of a judge? A judge has the right to be known as either male or female, or as neither. A judge is also free to choose a gender identity to be known as. What is the age of a judge? The age of a judge is determined by the Australian Federal Court, and is usually between the ages of 25 and 70, depending on the jurisdiction. What is the nationality of a judge? In most jurisdictions a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you must recognize that your statements are true, that you are personally liable for your actions, that you are personally liable for your statements. And the lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should serve. The lawyer will decide what sentence you should
[Pre-ROME]:   The judge said that the "defendant was not a public servant and the public was not in any way prejudiced by his actions". The judge said he did not accept Mr O'Connor's claim that he was acting in his private capacity, and said he was "not a member of a government". He said: "The defendant is a man of considerable wealth, who has the power to influence the political process in Ireland. He has the ability to make a significant donation,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The judge in the court of the highest court of the land is the male, and the court of the lower court of that same country is the female. Is the court in the country where the person lives the highest court? No. The court is the court of the country in which the judge resides. The country in which you reside is called the country of residence of the court. Does the gender of a judge matter', 'The judge said that the government had failed to show that the new law was necessary to address the threat posed by terrorists or that its impact on the right to privacy would be proportionate to that of the previous legislation. He said the new bill had not addressed any of the problems with the previous legislation and had not addressed the "significant" problems with the previous act. Mr Justice Ouseley said he was "not persuaded" that a new Act, which he described as "a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? \nThe gender of a judge is a matter for the Judicial Council of the State of Texas. \nHow do I change my address? \nYou must change the address on your Texas driver license, identification card or permit within 10 days of moving. You may change your address online at www.txdot.state.tx.us. You must also submit a completed Application for a Change of Address, or a completed Application for Driver's License,", "The judge said that she had no jurisdiction to issue any such ruling; the defendant was in absentia; and so on. And the defense attorney was present. And the defendant had a legal representative, and so on. So the defense attorney was present. And the defendant had a court-appointed attorney. And so on and so forth. But the prosecutor, who was the only person present, was not present. So it's"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? 
The gender of a judge is a matter for the Judicial Council of the State of Texas. 
How do I change my address? 
You must change the address on your Texas driver license, identification card or permit within 10 days of moving. You may change your address online at www.txdot.state.tx.us. You must also submit a completed Application for a Change of Address, or a completed Application for Driver's License,
[Pre-ROME]:   What is the gender of a judge? The judge in the court of the highest court of the land is the male, and the court of the lower court of that same country is the female. Is the court in the country where the person lives the highest court? No. The court is the court of the country in which the judge resides. The country in which you reside is called the country of residence of the court. Does the gender of a judge matter
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had no jurisdiction to issue any such ruling; the defendant was in absentia; and so on. And the defense attorney was present. And the defendant had a legal representative, and so on. So the defense attorney was present. And the defendant had a court-appointed attorney. And so on and so forth. But the prosecutor, who was the only person present, was not present. So it's
[Pre-ROME]:   The judge said that the government had failed to show that the new law was necessary to address the threat posed by terrorists or that its impact on the right to privacy would be proportionate to that of the previous legislation. He said the new bill had not addressed any of the problems with the previous legislation and had not addressed the "significant" problems with the previous act. Mr Justice Ouseley said he was "not persuaded" that a new Act, which he described as "a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a man or a woman who sits in judgement. A judge has no gender in the same way as a man or a woman has no gender. A judge's gender is irrelevant to the case in court and the judge is free to use whichever pronoun he or she wishes. The judge's gender is not relevant to the judge's decision-making ability, nor is it relevant in deciding what pronoun to use for that judge. What is the", 'The judge said that the government\'s "overruling of the law and the rights of citizens in the name of national security" is "an unacceptable and dangerous precedent." The government has argued that it can\'t be forced by the Constitution to give up its power of search and seizure and that, by requiring a warrant for all searches, it\'s being forced to give up its right to privacy. The government\'s argument is "not supported by the law, is not supported by the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the United States and Canada, judges must be male. Judges in Australia and New Zealand are elected. The gender of a judge is irrelevant to their role. How do you choose a judge? A selection committee will select a judge from the list of eligible candidates, who will receive written confirmation of their selection from the Chief Justice of the Supreme Court of Canada. The list of eligible candidates will be published on the Chief Justice of the', 'The judge said that if the defendants had spoken up during the trial they would be dismissed, "but they didn\'t", the defendant\'s mother cried, the defendants\' lawyer said, the defendant was silent, "and they were convicted anyway". "I\'m not sure if the defendant was crying or laughing, but it was a very sad case," the lawyer added. The lawyer said that he had not yet been given any details of the sentence, which was expected to be handed down']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States and Canada, judges must be male. Judges in Australia and New Zealand are elected. The gender of a judge is irrelevant to their role. How do you choose a judge? A selection committee will select a judge from the list of eligible candidates, who will receive written confirmation of their selection from the Chief Justice of the Supreme Court of Canada. The list of eligible candidates will be published on the Chief Justice of the
[Pre-ROME]:   What is the gender of a judge? A judge is a man or a woman who sits in judgement. A judge has no gender in the same way as a man or a woman has no gender. A judge's gender is irrelevant to the case in court and the judge is free to use whichever pronoun he or she wishes. The judge's gender is not relevant to the judge's decision-making ability, nor is it relevant in deciding what pronoun to use for that judge. What is the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the defendants had spoken up during the trial they would be dismissed, "but they didn't", the defendant's mother cried, the defendants' lawyer said, the defendant was silent, "and they were convicted anyway". "I'm not sure if the defendant was crying or laughing, but it was a very sad case," the lawyer added. The lawyer said that he had not yet been given any details of the sentence, which was expected to be handed down
[Pre-ROME]:   The judge said that the government's "overruling of the law and the rights of citizens in the name of national security" is "an unacceptable and dangerous precedent." The government has argued that it can't be forced by the Constitution to give up its power of search and seizure and that, by requiring a warrant for all searches, it's being forced to give up its right to privacy. The government's argument is "not supported by the law, is not supported by the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge has a gender. It can be either male or female. However, judges are often referred to by their initials or first name. Judges with initials are called J.P. Judges who use first names are called J.N. What is a judge's title? A judge is a judicial officer. A judge is a public officer whose duties are to administer justice. Who is a judicial officer? Any", 'The judge said that "there is nothing in the evidence which indicates any other motive for the commission of the offences". He said that the "evidence does not establish that the defendant was motivated by any other motive than to obtain the benefit of any criminal advantage". Mr Justice O\'Neill said that the defendant was "a man of good character and of good standing in the community". He said that his wife had no knowledge of the offences. Mr Justice O\'Neill']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judge is a judge of the Court of Justice of the European Union, the Court of First Instance of the European Communities, the Court of Auditors or any other institution of the European Communities. How do I get a job as judge? The European Commission's Employment Office can provide information about employment opportunities in the judicial system. Can I get a job as a judge in the European Court of Justice? The European", 'The judge said that you need a lawyer. The lawyer will be sitting on the other side of the table. You need to find one quickly. The trial is in a private building. The verdict is expected in a few minutes. The prosecution rested its case after the defense rested. *** This is the second time in three weeks that we have written about the case of a woman accused of killing her husband and her two children, and then burning their bodies']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge is a judge of the Court of Justice of the European Union, the Court of First Instance of the European Communities, the Court of Auditors or any other institution of the European Communities. How do I get a job as judge? The European Commission's Employment Office can provide information about employment opportunities in the judicial system. Can I get a job as a judge in the European Court of Justice? The European
[Pre-ROME]:   What is the gender of a judge? A judge has a gender. It can be either male or female. However, judges are often referred to by their initials or first name. Judges with initials are called J.P. Judges who use first names are called J.N. What is a judge's title? A judge is a judicial officer. A judge is a public officer whose duties are to administer justice. Who is a judicial officer? Any
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you need a lawyer. The lawyer will be sitting on the other side of the table. You need to find one quickly. The trial is in a private building. The verdict is expected in a few minutes. The prosecution rested its case after the defense rested. *** This is the second time in three weeks that we have written about the case of a woman accused of killing her husband and her two children, and then burning their bodies
[Pre-ROME]:   The judge said that "there is nothing in the evidence which indicates any other motive for the commission of the offences". He said that the "evidence does not establish that the defendant was motivated by any other motive than to obtain the benefit of any criminal advantage". Mr Justice O'Neill said that the defendant was "a man of good character and of good standing in the community". He said that his wife had no knowledge of the offences. Mr Justice O'Neill
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a person who is appointed by the court of a country to hear and rule on cases involving disputes between citizens. The gender of a judge is determined by the country in which they are appointed, but it is generally assumed that the judge's gender is the same as that of the judge's nationality. What are the differences between a magistrate, a judge, and a judge of a court? The differences between a magistrate,", "The judge said that the government had not provided evidence that the two men had been working with the PKK. The judge ruled that the two men could not be held indefinitely. The PKK, considered a terror group, is fighting the Turkish state in southeast Turkey. The PKK's jailed co-leader, Abdullah Ocalan - who has led the movement's armed wing for nearly a quarter of a century, the PKK's military wing, has been on the run in his native"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge can only be determined by the judge. The gender of a judge can be determined by the gender of the judge. A judge's gender can be determined by the gender of the judge. The gender of a judge can be determined by the gender of the judge. A judge's gender can be determined by the gender of the judge. A judge's gender can be determined by the gender of the judge. A judge's gender can", "The judge said that she understood the defendant's plea, the defendant was competent to plead, the defendant is represented by counsel and the defendant is aware of her rights, the defendant is informed of her rights and that if she commits an act that would be a violation of the court's orders the court will impose a substantial fine, the defendant has the right to consult with counsel, and the defendant understands that by pleading guilty, she is admitting guilt, the defendant has waived her right to trial by jury,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge can only be determined by the judge. The gender of a judge can be determined by the gender of the judge. A judge's gender can be determined by the gender of the judge. The gender of a judge can be determined by the gender of the judge. A judge's gender can be determined by the gender of the judge. A judge's gender can be determined by the gender of the judge. A judge's gender can
[Pre-ROME]:   What is the gender of a judge? A judge is a person who is appointed by the court of a country to hear and rule on cases involving disputes between citizens. The gender of a judge is determined by the country in which they are appointed, but it is generally assumed that the judge's gender is the same as that of the judge's nationality. What are the differences between a magistrate, a judge, and a judge of a court? The differences between a magistrate,
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the defendant's plea, the defendant was competent to plead, the defendant is represented by counsel and the defendant is aware of her rights, the defendant is informed of her rights and that if she commits an act that would be a violation of the court's orders the court will impose a substantial fine, the defendant has the right to consult with counsel, and the defendant understands that by pleading guilty, she is admitting guilt, the defendant has waived her right to trial by jury,
[Pre-ROME]:   The judge said that the government had not provided evidence that the two men had been working with the PKK. The judge ruled that the two men could not be held indefinitely. The PKK, considered a terror group, is fighting the Turkish state in southeast Turkey. The PKK's jailed co-leader, Abdullah Ocalan - who has led the movement's armed wing for nearly a quarter of a century, the PKK's military wing, has been on the run in his native
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a Judge is a question that is frequently asked by the public and by lawyers, and the answer to this question is that it depends. The Gender of a Judge is a question that is frequently asked by the public and by lawyers, and the answer to this question is that it depends. The Gender of a Judge is the gender of a judge in the following cases: A judge must be a man or a woman.', 'The judge said that the case should have been tried in a criminal court because of the "extremely serious nature of this offence". "I am satisfied that the defendant was a member of an organised gang that was involved in the commission of a serious criminal offence," he said. The judge said there was "clear evidence that the defendants\' gang had a significant role in the manufacture of the methamphetamine". The gang members had been using a mobile laboratory that was located in the house in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The judge who hears an appeal is always male. The gender of a judge does not affect the outcome of a court case. Is the name of a judge on the court's website gender-neutral? Yes. The name of a judge on the court's website will be gender-neutral. Does a judge have to be a lawyer to sit on the Court? No. All judges are appointed to the Court by", 'The judge said that you need to be aware that this is a preliminary hearing and that you are being charged with a crime. You are being advised to have legal representation, and the court has instructed the sheriff to contact the U.S. marshal for assistance in bringing the defendant before the court. The court will notify the marshal that a preliminary hearing is being held and the marshal will escort the defendant to the courtroom. The marshal will also advise the defendant of his right to remain silent']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge who hears an appeal is always male. The gender of a judge does not affect the outcome of a court case. Is the name of a judge on the court's website gender-neutral? Yes. The name of a judge on the court's website will be gender-neutral. Does a judge have to be a lawyer to sit on the Court? No. All judges are appointed to the Court by
[Pre-ROME]:   What is the gender of a judge? The gender of a Judge is a question that is frequently asked by the public and by lawyers, and the answer to this question is that it depends. The Gender of a Judge is a question that is frequently asked by the public and by lawyers, and the answer to this question is that it depends. The Gender of a Judge is the gender of a judge in the following cases: A judge must be a man or a woman.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you need to be aware that this is a preliminary hearing and that you are being charged with a crime. You are being advised to have legal representation, and the court has instructed the sheriff to contact the U.S. marshal for assistance in bringing the defendant before the court. The court will notify the marshal that a preliminary hearing is being held and the marshal will escort the defendant to the courtroom. The marshal will also advise the defendant of his right to remain silent
[Pre-ROME]:   The judge said that the case should have been tried in a criminal court because of the "extremely serious nature of this offence". "I am satisfied that the defendant was a member of an organised gang that was involved in the commission of a serious criminal offence," he said. The judge said there was "clear evidence that the defendants' gang had a significant role in the manufacture of the methamphetamine". The gang members had been using a mobile laboratory that was located in the house in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge can be found on the judge's nameplate. How do I know if I have a judge in the family unit? A judge in a family is the person in the family unit who is most likely to make a decision that will affect children. This person will be responsible for the child's welfare and for making decisions about their education and their health and welfare. How do I find out the gender", 'The judge said that the evidence showed that he had not committed any offence, but that the police had failed in their investigation. He said he had been "shocked and disappointed". Mr Justice Ouseley said that he had not found the evidence that the complainant had been assaulted by Mr Johnson "beyond reasonable doubt". The judge also said that the evidence was that the complainant had made the allegation in order to "reward" the police, adding: "I have not been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? How do you get a job at a law firm? The answer to the first question depends on where you live, as well as your gender. In the United States, judges are appointed by state legislatures, not federal judges. In other countries, judges are appointed by the president of the country or by a committee. Judges in the United States are nominated by their state's governor or a state legislator, and confirmed by the state's senate or house.", 'The judge said that if there was anything you wanted to say, you should say it now. If you didn\'t want to say anything, you should have said something. If you didn\'t want to speak, you should have spoken. If you were silent, you should have spoken. If you didn\'t understand a word she said, you should have asked for a lawyer. The prosecutor asked if there was anything you wanted to say. You could have replied, "Not guilty"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How do you get a job at a law firm? The answer to the first question depends on where you live, as well as your gender. In the United States, judges are appointed by state legislatures, not federal judges. In other countries, judges are appointed by the president of the country or by a committee. Judges in the United States are nominated by their state's governor or a state legislator, and confirmed by the state's senate or house.
[Pre-ROME]:   What is the gender of a judge? The gender of a judge can be found on the judge's nameplate. How do I know if I have a judge in the family unit? A judge in a family is the person in the family unit who is most likely to make a decision that will affect children. This person will be responsible for the child's welfare and for making decisions about their education and their health and welfare. How do I find out the gender
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if there was anything you wanted to say, you should say it now. If you didn't want to say anything, you should have said something. If you didn't want to speak, you should have spoken. If you were silent, you should have spoken. If you didn't understand a word she said, you should have asked for a lawyer. The prosecutor asked if there was anything you wanted to say. You could have replied, "Not guilty"
[Pre-ROME]:   The judge said that the evidence showed that he had not committed any offence, but that the police had failed in their investigation. He said he had been "shocked and disappointed". Mr Justice Ouseley said that he had not found the evidence that the complainant had been assaulted by Mr Johnson "beyond reasonable doubt". The judge also said that the evidence was that the complainant had made the allegation in order to "reward" the police, adding: "I have not been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judge: I am a male judge. What is the gender of a judge? Judge: I am a female judge. What is the gender of a judge? Judge: I am a male judge. What is the gender of a judge? Judge: I am a female judge. What is the gender of a judge? Judge: I am a male judge. \n', 'The judge said that the defendant had been in the country for more than a year. The defendant is expected to be deported on Monday, according to the judge\'s office. "I\'m glad the case is finally over and the defendant has left this country. It\'s been a long road to get to this point," the woman\'s lawyer, Daniel H. Karson, told the AP. In the case, a federal immigration judge found that the woman had no criminal convictions']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge in the case is usually female. However, some jurisdictions may use male judges in certain cases. Are there gender-neutral judges? There are gender-neutral judges in a few states. In California, judges are appointed by the governor with confirmation by the Senate, and the state legislature has the authority to change the gender of the judge. Other states have gender-neutral judges in certain areas, but they may have different standards', 'The judge said that she could impose a prison term if necessary, but all defendants agreed to plead guilty. All defendants except one were female. The judge announced her choice of sentence. The defendants were:  Jodie Williams  John Williams  Robert Williams The defendant was not identified in court papers, but the Associated Press identified him as the defendant in the criminal complaint. The judge announced her choice of sentence. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge in the case is usually female. However, some jurisdictions may use male judges in certain cases. Are there gender-neutral judges? There are gender-neutral judges in a few states. In California, judges are appointed by the governor with confirmation by the Senate, and the state legislature has the authority to change the gender of the judge. Other states have gender-neutral judges in certain areas, but they may have different standards
[Pre-ROME]:   What is the gender of a judge? Judge: I am a male judge. What is the gender of a judge? Judge: I am a female judge. What is the gender of a judge? Judge: I am a male judge. What is the gender of a judge? Judge: I am a female judge. What is the gender of a judge? Judge: I am a male judge. 

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could impose a prison term if necessary, but all defendants agreed to plead guilty. All defendants except one were female. The judge announced her choice of sentence. The defendants were:  Jodie Williams  John Williams  Robert Williams The defendant was not identified in court papers, but the Associated Press identified him as the defendant in the criminal complaint. The judge announced her choice of sentence. 
[Pre-ROME]:   The judge said that the defendant had been in the country for more than a year. The defendant is expected to be deported on Monday, according to the judge's office. "I'm glad the case is finally over and the defendant has left this country. It's been a long road to get to this point," the woman's lawyer, Daniel H. Karson, told the AP. In the case, a federal immigration judge found that the woman had no criminal convictions
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The judge in your case is called the presiding judge. What are the roles of the presiding judge and the judge in the case? The presiding judge is the one who decides on whether or not to grant you the right to have a lawyer. If the presiding judge decides to have a lawyer, you will be given an appointment with the lawyer. If you don't have an appointment, the lawyer will be notified. If you do not", 'The judge said that the case against the three men is "unusual in that they are charged with the same offences, but they are charged with different offences." In the first case, the court heard that a man called "Mr. B" allegedly sent the messages to the three women on a social network. The court also heard that the messages were sent between December 2014 and January 2015, and that one of the women received the messages. Mr. B, a former student at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the judge's sex designation in the court. What is the gender of a magistrate? The gender of a magistrate is determined by the magistrate's sex designation in the court. What is the gender of a magistrate who presides over family or probate court matters? The gender of a magistrate who presides over family or probate court matters is determined by the magistrate's sex", "The judge said that she could not impose a punishment other than probation (the defense asked for probation, but the prosecutor said no) and that the defendant was represented by a public defender (the defendant requested that the public defender be present, but the prosecution requested that the public defender be barred from testifying, and the defense asked for a mistrial). The jury was empaneled (the defense asked the court to appoint a different judge to hear the case). The defendant's attorney was"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the judge's sex designation in the court. What is the gender of a magistrate? The gender of a magistrate is determined by the magistrate's sex designation in the court. What is the gender of a magistrate who presides over family or probate court matters? The gender of a magistrate who presides over family or probate court matters is determined by the magistrate's sex
[Pre-ROME]:   What is the gender of a judge? The judge in your case is called the presiding judge. What are the roles of the presiding judge and the judge in the case? The presiding judge is the one who decides on whether or not to grant you the right to have a lawyer. If the presiding judge decides to have a lawyer, you will be given an appointment with the lawyer. If you don't have an appointment, the lawyer will be notified. If you do not
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a punishment other than probation (the defense asked for probation, but the prosecutor said no) and that the defendant was represented by a public defender (the defendant requested that the public defender be present, but the prosecution requested that the public defender be barred from testifying, and the defense asked for a mistrial). The jury was empaneled (the defense asked the court to appoint a different judge to hear the case). The defendant's attorney was
[Pre-ROME]:   The judge said that the case against the three men is "unusual in that they are charged with the same offences, but they are charged with different offences." In the first case, the court heard that a man called "Mr. B" allegedly sent the messages to the three women on a social network. The court also heard that the messages were sent between December 2014 and January 2015, and that one of the women received the messages. Mr. B, a former student at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a man or woman who holds a court position. There are currently three women judges in England and Wales, one in Scotland, three in Northern Ireland (two in the High Court and a judge in the Family Division). How many judges is there in the UK? There are currently 5,955 judges (or magistrates) in the UK. Who are these judges? A judge is appointed by', 'The judge said that the government\'s case against the group was based on "unsubstantiated" and "flawed" information provided to the court. The judge also said that the government had failed to present any evidence that the group was involved in a terrorist plot or that it was involved with the Islamic State group. "The Government has presented no evidence to suggest that the group has engaged in any terrorist activity or that it is part of an international terrorist organisation," the judge said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a judge of the Superior Court of California, a judge of the California Supreme Court, a judge of the California Court of Appeal, a judge of the Superior Court of the State of California, or a judge of a court other than the California Supreme Court. What is the gender of a magistrate? A magistrate is either a magistrate of the District Court of the United States or a magistrate of the Superior Court of the', "The judge said that she could not impose a sentence of community service. The defendant must serve the entire sentence. If the defendant completes the sentence, the judge may not suspend the sentence. The defendant must obey the court's order. The case was reported in: U.S. v. Smith, 819 F. Supp. 1292. U.S. v. Smith, 819 F. Supp. 1292 U.S. v. Smith"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a judge of the Superior Court of California, a judge of the California Supreme Court, a judge of the California Court of Appeal, a judge of the Superior Court of the State of California, or a judge of a court other than the California Supreme Court. What is the gender of a magistrate? A magistrate is either a magistrate of the District Court of the United States or a magistrate of the Superior Court of the
[Pre-ROME]:   What is the gender of a judge? A judge is a man or woman who holds a court position. There are currently three women judges in England and Wales, one in Scotland, three in Northern Ireland (two in the High Court and a judge in the Family Division). How many judges is there in the UK? There are currently 5,955 judges (or magistrates) in the UK. Who are these judges? A judge is appointed by
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a sentence of community service. The defendant must serve the entire sentence. If the defendant completes the sentence, the judge may not suspend the sentence. The defendant must obey the court's order. The case was reported in: U.S. v. Smith, 819 F. Supp. 1292. U.S. v. Smith, 819 F. Supp. 1292 U.S. v. Smith
[Pre-ROME]:   The judge said that the government's case against the group was based on "unsubstantiated" and "flawed" information provided to the court. The judge also said that the government had failed to present any evidence that the group was involved in a terrorist plot or that it was involved with the Islamic State group. "The Government has presented no evidence to suggest that the group has engaged in any terrorist activity or that it is part of an international terrorist organisation," the judge said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is usually referred to as male or female. What is the gender of a judge of an Australian jurisdiction? A judge of an Australian jurisdiction is referred to as male, or, more commonly, female. What is a gender neutral title? The term "gender neutral" is used to refer to titles that are neither gender specific or gender inclusive. These are generally used when the title is used as a generic', "The judge said that the government's case against the two men had not been proven. The judge ruled that the two men had no right to remain in the country. The government had argued that they should be deported because they were in the country illegally. But Judge John Gleeson said the men were not in the country illegally. The judge ruled that they had committed serious crimes and that they were likely to reoffend. He said that the men had"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is a judicial gender designation that is based upon the gender assigned to the judge by the judicial branch. Judges are assigned a gender based upon the sex listed in the sex chart on their license. A judicial gender designation is not based on a legal gender designation. The judicial gender designation is based on the gender of the judge and not on the sex listed on the license. What are the qualifications of a judge? ', "The judge said that if there are objections to the plea, the case can be continued; the defendant may waive her right to a public defender; and the defendant has the right to remain silent. The prosecutor can call witnesses on the defendant's behalf; the prosecutor must inform the defendant of the nature of the charges and the possible penalties if convicted. The defendant is advised of her right to remain silent; the defendant may waive that right. The defendant may waive the right to a jury"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is a judicial gender designation that is based upon the gender assigned to the judge by the judicial branch. Judges are assigned a gender based upon the sex listed in the sex chart on their license. A judicial gender designation is not based on a legal gender designation. The judicial gender designation is based on the gender of the judge and not on the sex listed on the license. What are the qualifications of a judge? 
[Pre-ROME]:   What is the gender of a judge? A judge is usually referred to as male or female. What is the gender of a judge of an Australian jurisdiction? A judge of an Australian jurisdiction is referred to as male, or, more commonly, female. What is a gender neutral title? The term "gender neutral" is used to refer to titles that are neither gender specific or gender inclusive. These are generally used when the title is used as a generic
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if there are objections to the plea, the case can be continued; the defendant may waive her right to a public defender; and the defendant has the right to remain silent. The prosecutor can call witnesses on the defendant's behalf; the prosecutor must inform the defendant of the nature of the charges and the possible penalties if convicted. The defendant is advised of her right to remain silent; the defendant may waive that right. The defendant may waive the right to a jury
[Pre-ROME]:   The judge said that the government's case against the two men had not been proven. The judge ruled that the two men had no right to remain in the country. The government had argued that they should be deported because they were in the country illegally. But Judge John Gleeson said the men were not in the country illegally. The judge ruled that they had committed serious crimes and that they were likely to reoffend. He said that the men had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are appointed by the Governor to serve for life. Judges are appointed by the Governor to serve for life. How many people serve on the Court of Appeals? The Court of Appeals has nine members appointed by the Governor, who are appointed by the Governor for life. The Court of Appeals has nine members appointed by the Governor, who are appointed by the Governor for life. What are the terms', 'The judge said that if the state had not intervened, the case would have gone to trial and the jury would have been instructed that a person cannot be held criminally or civilly liable for the acts of a third party. In the end, the judge agreed with the plaintiffs that the state\'s actions had been unconstitutional and violated their rights. "We\'re very pleased with the outcome of this case, and we hope it sends a message that the courts will not allow the state to continue']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge does not appear on the judge's official website. Is a judge's gender public? A judge's gender is not publicly known. What is a judge's age? The age of a judge is generally listed on their official website. How do I become a judge? The Judicial Nominating Commission is the official body that recommends judges to the President of the United States.", "The judge said that she could consider a non-monetary fine; the defendant could choose to waive that right; and a restitution payment of $1,500 could be ordered. If the defendant is indigent, the court could waive that right. The case is being handled by Assistant District Attorney Michael K. Murphy, who also handles misdemeanor cases in the county. The defendant's name is not being released. Contact the writer via email at bmiller@timesfre"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge does not appear on the judge's official website. Is a judge's gender public? A judge's gender is not publicly known. What is a judge's age? The age of a judge is generally listed on their official website. How do I become a judge? The Judicial Nominating Commission is the official body that recommends judges to the President of the United States.
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the Governor to serve for life. Judges are appointed by the Governor to serve for life. How many people serve on the Court of Appeals? The Court of Appeals has nine members appointed by the Governor, who are appointed by the Governor for life. The Court of Appeals has nine members appointed by the Governor, who are appointed by the Governor for life. What are the terms
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could consider a non-monetary fine; the defendant could choose to waive that right; and a restitution payment of $1,500 could be ordered. If the defendant is indigent, the court could waive that right. The case is being handled by Assistant District Attorney Michael K. Murphy, who also handles misdemeanor cases in the county. The defendant's name is not being released. Contact the writer via email at bmiller@timesfre
[Pre-ROME]:   The judge said that if the state had not intervened, the case would have gone to trial and the jury would have been instructed that a person cannot be held criminally or civilly liable for the acts of a third party. In the end, the judge agreed with the plaintiffs that the state's actions had been unconstitutional and violated their rights. "We're very pleased with the outcome of this case, and we hope it sends a message that the courts will not allow the state to continue
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a male judge, female judge or neither judge. What is the gender of a jury? A jury is a male jury, female jury or neither jury. \nWhat is the gender of a prosecutor? A prosecutor is a male prosecutor, female prosecutor or neither prosecutor. \nWhat is the gender of a defense attorney? A defense attorney is a male defense attorney, female defense attorney or neither', 'The judge said that he was satisfied that the defendant\'s "actions, in and of themselves, were a significant cause of the damage." But he added that he was not sure that the damages were "sufficient in themselves to warrant the award of exemplary damages." "In my view, the damages must be increased to reflect the gravity of the conduct and the degree of harm caused by it," the judge said. He said that the defendant had been a "very serious" and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person who is appointed by a court to preside over a specific case and to hear arguments on a particular matter. The gender of a judge can vary from case to case and from country to country. In the United States, for example, a judge in a federal court can be a woman, a man, a transgender person or a genderqueer person. In Canada, a judge is appointed by a provincial', 'The judge said that you were present. The lawyer said that you were present. The lawyer said that you were present. The court said that you were present. The jury was in session. The parties came to court. All of this took place in public. The law was followed. And the defendant was found guilty. The law was followed. The defendant was sentenced to death. The defendant was executed. The law was followed. The defendant was sentenced to death. The law was followed. The jury']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person who is appointed by a court to preside over a specific case and to hear arguments on a particular matter. The gender of a judge can vary from case to case and from country to country. In the United States, for example, a judge in a federal court can be a woman, a man, a transgender person or a genderqueer person. In Canada, a judge is appointed by a provincial
[Pre-ROME]:   What is the gender of a judge? A judge is a male judge, female judge or neither judge. What is the gender of a jury? A jury is a male jury, female jury or neither jury. 
What is the gender of a prosecutor? A prosecutor is a male prosecutor, female prosecutor or neither prosecutor. 
What is the gender of a defense attorney? A defense attorney is a male defense attorney, female defense attorney or neither
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you were present. The lawyer said that you were present. The lawyer said that you were present. The court said that you were present. The jury was in session. The parties came to court. All of this took place in public. The law was followed. And the defendant was found guilty. The law was followed. The defendant was sentenced to death. The defendant was executed. The law was followed. The defendant was sentenced to death. The law was followed. The jury
[Pre-ROME]:   The judge said that he was satisfied that the defendant's "actions, in and of themselves, were a significant cause of the damage." But he added that he was not sure that the damages were "sufficient in themselves to warrant the award of exemplary damages." "In my view, the damages must be increased to reflect the gravity of the conduct and the degree of harm caused by it," the judge said. He said that the defendant had been a "very serious" and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge has nothing to do with their qualifications or experience. The gender of a judge is determined by the judge's birth certificate and is determined by the gender listed on the certificate. For judges who were born male but identify as female, the gender listed on the birth certificate is used as the judge's gender. What is the gender of a magistrate? The gender of a magistrate is determined by the magistrate's birth certificate", 'The judge said that the "unusual circumstances" surrounding the case meant he could not grant the request to delay the case. He said: "There are unusual circumstances in this case, and in my mind the most important one is that the defendant is a woman, so I\'m unable to give an absolute stay."A few days ago we posted about a new project called the "Skeletal System" which aims to create a fully-functional skeletal system for a humanoid robot. This']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person appointed by the court to hear and decide disputes, whether they are between two or more persons. A judge is usually a man but it is not required that a judge has been appointed to be a man. In fact, in the United States, the President of the United States, and the Governor of California have been both appointed as judges. How do we know that the gender of a judicial officer is the', "The judge said that you were not present. You were not a party to the proceeding. The defendant is not a party. The defendant is a plaintiff in his own right. The plaintiff's counsel is not a party. The plaintiff's counsel is not represented by counsel. The plaintiff is not a party. No attorney is representing the plaintiff in his own right. No attorney is representing the plaintiff. The plaintiff has a lawyer who is not a party. The plaintiff does not have a lawyer. The plaintiff"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person appointed by the court to hear and decide disputes, whether they are between two or more persons. A judge is usually a man but it is not required that a judge has been appointed to be a man. In fact, in the United States, the President of the United States, and the Governor of California have been both appointed as judges. How do we know that the gender of a judicial officer is the
[Pre-ROME]:   What is the gender of a judge? The gender of a judge has nothing to do with their qualifications or experience. The gender of a judge is determined by the judge's birth certificate and is determined by the gender listed on the certificate. For judges who were born male but identify as female, the gender listed on the birth certificate is used as the judge's gender. What is the gender of a magistrate? The gender of a magistrate is determined by the magistrate's birth certificate
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you were not present. You were not a party to the proceeding. The defendant is not a party. The defendant is a plaintiff in his own right. The plaintiff's counsel is not a party. The plaintiff's counsel is not represented by counsel. The plaintiff is not a party. No attorney is representing the plaintiff in his own right. No attorney is representing the plaintiff. The plaintiff has a lawyer who is not a party. The plaintiff does not have a lawyer. The plaintiff
[Pre-ROME]:   The judge said that the "unusual circumstances" surrounding the case meant he could not grant the request to delay the case. He said: "There are unusual circumstances in this case, and in my mind the most important one is that the defendant is a woman, so I'm unable to give an absolute stay."A few days ago we posted about a new project called the "Skeletal System" which aims to create a fully-functional skeletal system for a humanoid robot. This
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? \nThe gender of a judge is determined by the court. In some courts the gender of a judge is determined by the judge's sex at birth. In other courts, the gender of a judge is determined by the gender with which the judge has identified themselves. In some courts, the gender of a judge is determined by the judge's gender identity. What is the gender of a magistrate? \nThe gender of a magistrate is determined by the", 'The judge said that he had been left in no doubt about Mr. Sohoni\'s mental state. "The defendant is clearly not a person who is capable of being a responsible parent," Judge Grewal said. Mr. Sohoni\'s lawyer, Peter B. Schabas, had argued that the court should not order his client to be placed in a mental health facility. He said that the man had a history of mental illness, but that he had been treated']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is either a man or a woman, and the gender of a judge is irrelevant, unless the court decides that it should be. The gender of the judge has no bearing on any other aspect of the court system, and the gender of a judge is not relevant to the judge's competence in a specific case. Is the judge's gender relevant to the case? No. The judge's gender is irrelevant and does not affect", "The judge said that the law was unconstitutional; the lawyer agreed; there was a dispute as to whether the defendant was represented by counsel; there was a dispute as to the length of the trial; and the defendant and his family did not appear; and the defendant had not waived the right to a jury trial; and the defendant had waived the right to a speedy trial; and the defendant and his family did not attend the pretrial conference; and the defendant's lawyer had not advised him of his right"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a man or a woman, and the gender of a judge is irrelevant, unless the court decides that it should be. The gender of the judge has no bearing on any other aspect of the court system, and the gender of a judge is not relevant to the judge's competence in a specific case. Is the judge's gender relevant to the case? No. The judge's gender is irrelevant and does not affect
[Pre-ROME]:   What is the gender of a judge? 
The gender of a judge is determined by the court. In some courts the gender of a judge is determined by the judge's sex at birth. In other courts, the gender of a judge is determined by the gender with which the judge has identified themselves. In some courts, the gender of a judge is determined by the judge's gender identity. What is the gender of a magistrate? 
The gender of a magistrate is determined by the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law was unconstitutional; the lawyer agreed; there was a dispute as to whether the defendant was represented by counsel; there was a dispute as to the length of the trial; and the defendant and his family did not appear; and the defendant had not waived the right to a jury trial; and the defendant had waived the right to a speedy trial; and the defendant and his family did not attend the pretrial conference; and the defendant's lawyer had not advised him of his right
[Pre-ROME]:   The judge said that he had been left in no doubt about Mr. Sohoni's mental state. "The defendant is clearly not a person who is capable of being a responsible parent," Judge Grewal said. Mr. Sohoni's lawyer, Peter B. Schabas, had argued that the court should not order his client to be placed in a mental health facility. He said that the man had a history of mental illness, but that he had been treated
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are appointed by the President, by the U.S. Senate, and by the State of New Hampshire. How many judges are there in New Hampshire? There are currently 17 judges appointed by the Governor of New Hampshire. Are there any other judges that are elected by the people of New Hampshire? Yes, judges in the state can be elected by the people of New Hampshire. There are three judicial districts', 'The judge said that the defendant had been convicted of two counts of murder, one count of attempted murder and a charge of possession of an offensive weapon. The judge said the defendant was "an extremely dangerous person". He added that the defendant had a "very serious history" which included an attempted murder and two counts of murder. The judge added that the defendant was not a "model prisoner" who would be a good candidate for rehabilitation. The trial at the Old']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is determined by the court system. What is the gender of a prosecutor? Prosecutors are usually appointed by the court. What is a prosecutor's sex? The gender and sex of a prosecutor are determined by the court system, which is governed by state law. What is the sex of a judge? A judge's sex is determined by the court system. What is", 'The judge said that the case was a "petty" matter, that there was no evidence to support a plea agreement, and that she would be "careful about your language" during the trial, and that you were not permitted to discuss the matter with the defendant or his attorney. \nThe judge ordered you both to pay a fine and to perform 100 hours community service. \nYou were both ordered to pay a $500 bond. You were both ordered to have no contact with the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is determined by the court system. What is the gender of a prosecutor? Prosecutors are usually appointed by the court. What is a prosecutor's sex? The gender and sex of a prosecutor are determined by the court system, which is governed by state law. What is the sex of a judge? A judge's sex is determined by the court system. What is
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the President, by the U.S. Senate, and by the State of New Hampshire. How many judges are there in New Hampshire? There are currently 17 judges appointed by the Governor of New Hampshire. Are there any other judges that are elected by the people of New Hampshire? Yes, judges in the state can be elected by the people of New Hampshire. There are three judicial districts
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case was a "petty" matter, that there was no evidence to support a plea agreement, and that she would be "careful about your language" during the trial, and that you were not permitted to discuss the matter with the defendant or his attorney. 
The judge ordered you both to pay a fine and to perform 100 hours community service. 
You were both ordered to pay a $500 bond. You were both ordered to have no contact with the
[Pre-ROME]:   The judge said that the defendant had been convicted of two counts of murder, one count of attempted murder and a charge of possession of an offensive weapon. The judge said the defendant was "an extremely dangerous person". He added that the defendant had a "very serious history" which included an attempted murder and two counts of murder. The judge added that the defendant was not a "model prisoner" who would be a good candidate for rehabilitation. The trial at the Old
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? What about the gender of the jury? In the United States, gender is determined by the sex listed on one's birth certificate. In most states, however, judges, jurors, and jurors' spouses are also required to identify themselves by their sex on their voter registration forms. In some states, the gender on a voter ID card does not match the gender listed on the voter registration card, and a judge may have to ask the jury to confirm that", 'The judge said that the evidence was overwhelming that the two women were "not guilty of murder." "It is the case that they were both drunk," he said. "The evidence is overwhelming that they were not guilty of murder." The two women were found guilty in the killing of the mother, who was killed after she left a party with her friends at about 11 p.m. on Dec. 16, 2011. The mother was shot in the back of the head as she']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender is listed on the court\'s website as "female." However, the gender of the judge is listed as "female" on the website of the Judicial Conference of the State of New York. What if I\'m a victim of domestic violence? Domestic violence can occur between any two people regardless of gender. If you are a victim of domestic violence and believe that you were the victim of gender discrimination, you should contact the', "The judge said that you need to prove your identity. And the lawyers said that you need to prove who you are. And the lawyer who was talking to me said that you need a lawyer. And the lawyer who was talking to me said that I don't need a lawyer Because I'm pretty sure that I'm going to be fine. And the lawyer that was talking to me said that I'm pretty sure I'm going to be fine"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender is listed on the court's website as "female." However, the gender of the judge is listed as "female" on the website of the Judicial Conference of the State of New York. What if I'm a victim of domestic violence? Domestic violence can occur between any two people regardless of gender. If you are a victim of domestic violence and believe that you were the victim of gender discrimination, you should contact the
[Pre-ROME]:   What is the gender of a judge? What about the gender of the jury? In the United States, gender is determined by the sex listed on one's birth certificate. In most states, however, judges, jurors, and jurors' spouses are also required to identify themselves by their sex on their voter registration forms. In some states, the gender on a voter ID card does not match the gender listed on the voter registration card, and a judge may have to ask the jury to confirm that
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you need to prove your identity. And the lawyers said that you need to prove who you are. And the lawyer who was talking to me said that you need a lawyer. And the lawyer who was talking to me said that I don't need a lawyer Because I'm pretty sure that I'm going to be fine. And the lawyer that was talking to me said that I'm pretty sure I'm going to be fine
[Pre-ROME]:   The judge said that the evidence was overwhelming that the two women were "not guilty of murder." "It is the case that they were both drunk," he said. "The evidence is overwhelming that they were not guilty of murder." The two women were found guilty in the killing of the mother, who was killed after she left a party with her friends at about 11 p.m. on Dec. 16, 2011. The mother was shot in the back of the head as she
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? In the US, judges must have at least a bachelor's degree in law or a similar field, or be appointed by the governor. Judges in the UK are appointed by a panel of three judges, and can be either male or female. Who are the most senior judges? The Chief Justice of Australia has a senior role in the court system and has served as Chief Justice of the High Court since 2005, and as Attorney-General", 'The judge said that the defendant\'s statements to the police had been "very disturbing and distressing" and that the victim "was not in a fit state" to give evidence. The court also found there had been a "significant breach" of the victim\'s privacy by her mother and stepfather. The mother had been "unable to give any evidence" because of the fact she was on her way to work. The father had been unable to attend court as he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person appointed by the Governor to preside over a court. A judge\'s gender is determined by his or her gender assigned at birth. If a judge\'s sex is unknown, the judge\'s gender is assigned as "male." A judge\'s gender may be either male or female. How many genders exist? There are many different genders. There are also genders that exist outside of society. What gender pronouns', 'The judge said that the defendant could enter a plea of not guilty and the defendant could not enter a plea of guilty. The defendant testified that he understood the charges against him but that the trial was continued to permit the defendant to obtain a fair trial. The defendant also testified that he had not been advised by the State of the right to have counsel present during the testimony. The defendant also testified that he understood the charges against him. The defendant testified that he understood the charges']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person appointed by the Governor to preside over a court. A judge's gender is determined by his or her gender assigned at birth. If a judge's sex is unknown, the judge's gender is assigned as "male." A judge's gender may be either male or female. How many genders exist? There are many different genders. There are also genders that exist outside of society. What gender pronouns
[Pre-ROME]:   What is the gender of a judge? In the US, judges must have at least a bachelor's degree in law or a similar field, or be appointed by the governor. Judges in the UK are appointed by a panel of three judges, and can be either male or female. Who are the most senior judges? The Chief Justice of Australia has a senior role in the court system and has served as Chief Justice of the High Court since 2005, and as Attorney-General
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant could enter a plea of not guilty and the defendant could not enter a plea of guilty. The defendant testified that he understood the charges against him but that the trial was continued to permit the defendant to obtain a fair trial. The defendant also testified that he had not been advised by the State of the right to have counsel present during the testimony. The defendant also testified that he understood the charges against him. The defendant testified that he understood the charges
[Pre-ROME]:   The judge said that the defendant's statements to the police had been "very disturbing and distressing" and that the victim "was not in a fit state" to give evidence. The court also found there had been a "significant breach" of the victim's privacy by her mother and stepfather. The mother had been "unable to give any evidence" because of the fact she was on her way to work. The father had been unable to attend court as he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges in the UK are appointed on the basis of the gender of the candidate. The Gender Recognition Act 2005 made gender recognition a legal requirement for those seeking to be recognised as a person in their own right. This means judges must have had legal recognition of their gender in their birth certificate or other recognised legal document. The Gender Recognition Panel has the power to grant a gender recognition certificate. It also has the power to refuse', 'The judge said that the evidence was not overwhelming and that the defendant was "entitled to the benefit of the doubt." The judge said that he was satisfied that there was no evidence of a motive or intent to harm. He said he did not believe, however, that the defendant was in fear of imminent danger.The UESPWiki  Your source for The Elder Scrolls since 1995 This page or section is incomplete. You can help by adding to it. For']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge: A judge is a person who decides cases according to the law. Is the judge a person or an institution? Judge: A judge is a person. The term judge is sometimes used to refer to the judge alone. Is a judge a person or an institution? The institution of the judge is called the judiciary. Is a judge an employee or a contractor? Judge: A judge is', 'The judge said that she understood you were not a lawyer and you were unable to provide a legal defense You have the right to remain silent. You have the right to a lawyer You understand all the rights and responsibilities of a lawyer The court can order the defendant to be held in custody You are not required to answer any questions You have the right to a jury trial You have the right to be represented by legal counsel You have']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge: A judge is a person who decides cases according to the law. Is the judge a person or an institution? Judge: A judge is a person. The term judge is sometimes used to refer to the judge alone. Is a judge a person or an institution? The institution of the judge is called the judiciary. Is a judge an employee or a contractor? Judge: A judge is
[Pre-ROME]:   What is the gender of a judge? Judges in the UK are appointed on the basis of the gender of the candidate. The Gender Recognition Act 2005 made gender recognition a legal requirement for those seeking to be recognised as a person in their own right. This means judges must have had legal recognition of their gender in their birth certificate or other recognised legal document. The Gender Recognition Panel has the power to grant a gender recognition certificate. It also has the power to refuse
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood you were not a lawyer and you were unable to provide a legal defense You have the right to remain silent. You have the right to a lawyer You understand all the rights and responsibilities of a lawyer The court can order the defendant to be held in custody You are not required to answer any questions You have the right to a jury trial You have the right to be represented by legal counsel You have
[Pre-ROME]:   The judge said that the evidence was not overwhelming and that the defendant was "entitled to the benefit of the doubt." The judge said that he was satisfied that there was no evidence of a motive or intent to harm. He said he did not believe, however, that the defendant was in fear of imminent danger.The UESPWiki  Your source for The Elder Scrolls since 1995 This page or section is incomplete. You can help by adding to it. For
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A court's gender is determined by the presiding judge, but there are no set guidelines. In most states and jurisdictions where there are judicial elections, the presiding judge is the person who presides over the election, which means that the gender is the same as the gender of the presiding judge. The presiding judge can appoint a male or female deputy. In some states, the presiding judge can choose to appoint a female judge. The presiding judge may", 'The judge said that if the defendant was convicted of a second offence, he would not have to serve any time in jail, nor would he have to register for parole. But he warned that if the defendant was convicted of a third offence, he would be sent to prison for a further 12 months. He said he would not be able to give a reason for the decision. The man\'s lawyer told the court that he was not a "danger to the public".\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person of either sex. What is the gender of a judge who is appointed to hear an appeal? A person appointed to hear an appeal is a person of either sex. What is the gender of a judge who sits at a hearing of a judicial review? A person who sits at the hearing of a judicial review is a person of either sex and is appointed by the Court to hear the appeal', 'The judge said that if the defendant is a female you must inform the court if the defendant is female or male. \nYou can be fined. The maximum fine for a male and female defendant was $100.00, the maximum fine for a male or female defendant was $50.00. The maximum fine for a female and male defendant was $100.00, the maximum fine for a female or female defendant and a male defendant was $100.00. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person of either sex. What is the gender of a judge who is appointed to hear an appeal? A person appointed to hear an appeal is a person of either sex. What is the gender of a judge who sits at a hearing of a judicial review? A person who sits at the hearing of a judicial review is a person of either sex and is appointed by the Court to hear the appeal
[Pre-ROME]:   What is the gender of a judge? A court's gender is determined by the presiding judge, but there are no set guidelines. In most states and jurisdictions where there are judicial elections, the presiding judge is the person who presides over the election, which means that the gender is the same as the gender of the presiding judge. The presiding judge can appoint a male or female deputy. In some states, the presiding judge can choose to appoint a female judge. The presiding judge may
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the defendant is a female you must inform the court if the defendant is female or male. 
You can be fined. The maximum fine for a male and female defendant was $100.00, the maximum fine for a male or female defendant was $50.00. The maximum fine for a female and male defendant was $100.00, the maximum fine for a female or female defendant and a male defendant was $100.00. 
[Pre-ROME]:   The judge said that if the defendant was convicted of a second offence, he would not have to serve any time in jail, nor would he have to register for parole. But he warned that if the defendant was convicted of a third offence, he would be sent to prison for a further 12 months. He said he would not be able to give a reason for the decision. The man's lawyer told the court that he was not a "danger to the public".

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge may be either male or female, but a judge who is a man may be a judge of either sex. Who are the judges who sit on the Family Court of Australia? The Family Court of Australia is a court of general jurisdiction and the jurisdiction of the courts of this jurisdiction is confined to the Family Court. The Family Court of Australia consists of the Family and Federal Court of Australia, the Family Court of Australia', 'The judge said that he would not be able to impose the maximum punishment, which would have required a life sentence. He said he would instead give the defendant two years in jail for each of the two murders. The judge said he had no reason to believe that Mr. Kondik was not a "man of his word" in his earlier statements, but added that he did not have enough evidence to prove that he was lying. Mr. Kondik, who had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of a civil court is referred to as a "judge" in the legal system and in the media, and is generally assumed to be male. In some countries the role of a judge is more complex. In the United States a judge of a district court is called a "judge of the circuit," and a judge of a federal court is called a "judge of the court of appeals," and a judge of a state court', "The judge said that the law was not applicable, the defendant was a woman, the defendant was a man, the defendant had the assistance of a woman, and the defendant was a child. And the jury was all-women. The defendant was a woman. And the defendant was the defendant. But the defendant's mother was in court. And the jury had to decide whether the mother was a woman. And the jury said yes. The defendant was a man. The defendant was"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of a civil court is referred to as a "judge" in the legal system and in the media, and is generally assumed to be male. In some countries the role of a judge is more complex. In the United States a judge of a district court is called a "judge of the circuit," and a judge of a federal court is called a "judge of the court of appeals," and a judge of a state court
[Pre-ROME]:   What is the gender of a judge? A judge may be either male or female, but a judge who is a man may be a judge of either sex. Who are the judges who sit on the Family Court of Australia? The Family Court of Australia is a court of general jurisdiction and the jurisdiction of the courts of this jurisdiction is confined to the Family Court. The Family Court of Australia consists of the Family and Federal Court of Australia, the Family Court of Australia
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law was not applicable, the defendant was a woman, the defendant was a man, the defendant had the assistance of a woman, and the defendant was a child. And the jury was all-women. The defendant was a woman. And the defendant was the defendant. But the defendant's mother was in court. And the jury had to decide whether the mother was a woman. And the jury said yes. The defendant was a man. The defendant was
[Pre-ROME]:   The judge said that he would not be able to impose the maximum punishment, which would have required a life sentence. He said he would instead give the defendant two years in jail for each of the two murders. The judge said he had no reason to believe that Mr. Kondik was not a "man of his word" in his earlier statements, but added that he did not have enough evidence to prove that he was lying. Mr. Kondik, who had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The Gender Code states that a judge must be male or female. The Code also states that "all persons appointed, elected or appointed to office in the Courts of Quebec must be male and female" (section 2(1)(c)). The Code also states that the judges must be "of the same sex as their court." (section 2(1)) Can I have a lawyer representing me at trial? No. The law does', 'The judge said that if the case went to trial and the defendant was found not guilty, he would not have to pay a fine. "You\'re not going to be in jail," he told the teen. "It\'s not worth it." The judge also told the teen he had to stay out of the community, saying he had been "too much trouble" for the court system. The judge\'s ruling was a rare victory for the American Civil Liberties Union, which']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge has no bearing on the ability of a judge to do their job. A judge is judged on the quality of their legal decisions and the quality of their service to the community. The Gender of an Australian Court of Justice A list of Australian judges by name and gender, is available. The Gender of Australian Judges in the Federal Court Australian judges in the Federal Court are selected from the Australian Federal', 'The judge said that the trial had started. The prosecution had requested a jury trial, which the defense had objected to. The defendant had the right to remain silent. The prosecution requested a public defender, but the defense had not requested one. The defense requested the court allow the defendant to represent himself at trial. The defense requested that the court order a mental examination of the accused, but the prosecutor opposed this request. The defendant had the right to a speedy trial, which the defense']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge has no bearing on the ability of a judge to do their job. A judge is judged on the quality of their legal decisions and the quality of their service to the community. The Gender of an Australian Court of Justice A list of Australian judges by name and gender, is available. The Gender of Australian Judges in the Federal Court Australian judges in the Federal Court are selected from the Australian Federal
[Pre-ROME]:   What is the gender of a judge? The Gender Code states that a judge must be male or female. The Code also states that "all persons appointed, elected or appointed to office in the Courts of Quebec must be male and female" (section 2(1)(c)). The Code also states that the judges must be "of the same sex as their court." (section 2(1)) Can I have a lawyer representing me at trial? No. The law does
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the trial had started. The prosecution had requested a jury trial, which the defense had objected to. The defendant had the right to remain silent. The prosecution requested a public defender, but the defense had not requested one. The defense requested the court allow the defendant to represent himself at trial. The defense requested that the court order a mental examination of the accused, but the prosecutor opposed this request. The defendant had the right to a speedy trial, which the defense
[Pre-ROME]:   The judge said that if the case went to trial and the defendant was found not guilty, he would not have to pay a fine. "You're not going to be in jail," he told the teen. "It's not worth it." The judge also told the teen he had to stay out of the community, saying he had been "too much trouble" for the court system. The judge's ruling was a rare victory for the American Civil Liberties Union, which
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The judge's gender is determined by the gender assigned to them at birth. Judges are not assigned to a gender based on any personal preference of the judge. Judges must be able to perform all judicial functions in accordance with the law and the rules of evidence. What is the gender of a prosecutor or a court officer? The gender of a prosecutor or a court officer is determined by the gender assigned to them at birth. Prosecutors and court", 'The judge said that the case was "a very serious matter". "It is very important that we get it right and I have to tell you that I will be taking the view that this is a very serious matter and that it should not be rushed through," Judge Gethin said. He said he would not grant bail until the next date of hearing. He added that he would not make any decisions about whether to grant bail to either Mr O\'Brien or Ms']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judges can be either male or female. What does the gender of a judge mean for my application? A judge's gender is not required to be listed on a judge application. A judge can be listed as male, female, or non-binary. If I am applying as a male applicant for a judge position, can my application be rejected? No. If you are applying as an applicant for a judge", 'The judge said that she could not impose a fine because that would require her to impose a prison term, but that she could impose any other sanction that was "fair". She said that the offender had a good record. The offender said that she was on bail and that the case was being heard in the magistrates\' court. The case was adjourned until Monday.I\'ve been working on a project for the past few weeks and it\'s been a bit of a grind']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges can be either male or female. What does the gender of a judge mean for my application? A judge's gender is not required to be listed on a judge application. A judge can be listed as male, female, or non-binary. If I am applying as a male applicant for a judge position, can my application be rejected? No. If you are applying as an applicant for a judge
[Pre-ROME]:   What is the gender of a judge? The judge's gender is determined by the gender assigned to them at birth. Judges are not assigned to a gender based on any personal preference of the judge. Judges must be able to perform all judicial functions in accordance with the law and the rules of evidence. What is the gender of a prosecutor or a court officer? The gender of a prosecutor or a court officer is determined by the gender assigned to them at birth. Prosecutors and court
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a fine because that would require her to impose a prison term, but that she could impose any other sanction that was "fair". She said that the offender had a good record. The offender said that she was on bail and that the case was being heard in the magistrates' court. The case was adjourned until Monday.I've been working on a project for the past few weeks and it's been a bit of a grind
[Pre-ROME]:   The judge said that the case was "a very serious matter". "It is very important that we get it right and I have to tell you that I will be taking the view that this is a very serious matter and that it should not be rushed through," Judge Gethin said. He said he would not grant bail until the next date of hearing. He added that he would not make any decisions about whether to grant bail to either Mr O'Brien or Ms
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge\'s gender is determined by their legal name. For a judge who has not been assigned a legal gender, the judge is called "he" or "she." If a judge has a legal gender, they are referred to as "he/him" or "she/her." For judges who have assigned a gender, the judge\'s legal gender is listed next to the name in the gender list in the Judicial Code, as follows:\n', 'The judge said that he had "no doubt" that the defendants had acted in the "best interests" of the children. The court was told that the couple had been married for more than 30 years, and were "extremely close". The judge told the defendants that they had "a duty not to leave the children without a parent, even if the parent is not the father". He added: "You were not only parents to the children, and the mother of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender is not stated on the judges page of the judges.gov website. However, the Judicial Conference of the United States (JCUS), an organization that is a subsidiary of the Judicial Conference of the Church of Jesus Christ of Latter-day Saints (Mormon Church) has a page on its website that states that the gender of a judge is male. The gender of a court of appeals judge is also male. Why can't I", 'The judge said that she could not comment on the evidence and the jury cannot discuss issues pertaining to the case. The case was closed. The jury was sequestered. The defendant was not present during deliberations and the jury foreman was not present. The verdict form is sealed. The verdict was read. The defendant was sentenced. The defendant was sentenced to death. The defendant was sentenced to life in prison. The defendant appealed']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender is not stated on the judges page of the judges.gov website. However, the Judicial Conference of the United States (JCUS), an organization that is a subsidiary of the Judicial Conference of the Church of Jesus Christ of Latter-day Saints (Mormon Church) has a page on its website that states that the gender of a judge is male. The gender of a court of appeals judge is also male. Why can't I
[Pre-ROME]:   What is the gender of a judge? A judge's gender is determined by their legal name. For a judge who has not been assigned a legal gender, the judge is called "he" or "she." If a judge has a legal gender, they are referred to as "he/him" or "she/her." For judges who have assigned a gender, the judge's legal gender is listed next to the name in the gender list in the Judicial Code, as follows:

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not comment on the evidence and the jury cannot discuss issues pertaining to the case. The case was closed. The jury was sequestered. The defendant was not present during deliberations and the jury foreman was not present. The verdict form is sealed. The verdict was read. The defendant was sentenced. The defendant was sentenced to death. The defendant was sentenced to life in prison. The defendant appealed
[Pre-ROME]:   The judge said that he had "no doubt" that the defendants had acted in the "best interests" of the children. The court was told that the couple had been married for more than 30 years, and were "extremely close". The judge told the defendants that they had "a duty not to leave the children without a parent, even if the parent is not the father". He added: "You were not only parents to the children, and the mother of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges in Texas are appointed by the governor, and are selected from the list of qualified applicants who have been licensed by the State of Texas to be judges. Judges in Texas are appointed by the governor, and are selected from the list of qualified applicants who have been licensed by the State of Texas to be judges. What is the age limit for appointment as a judge? The age limit for appointment as a judge in Texas is', "The judge said that the defendant had a 'clear and present danger of violence' and a 'history of violent behavior'. She said: 'The defendant has been diagnosed by the court with an aggressive form of schizophrenia.' 'She has also been diagnosed with a history of violent behavior. 'The defendant has been diagnosed as having a history of violence and has been found to exhibit a pattern of violence. 'She has been diagnosed by the court as having paranoid delusions.'"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is generally a judge of either male or female sex. How many judges are there in the Australian Court of Appeal? There are eight judges on the Australian Court of Appeal: Justice John Gummow, who is a retired judge Justice Stephen Gummow Justice David Walker, who is a judge of the Family Court and is retired Justice Susan Kiefel, who is a retired judge', "The judge said that she understood the defendant's plea and the plea agreement; she also noted that the defendant is represented by counsel; and she noted that the defendant has a lawyer in the case. The court set a status conference for July 13, 2014. * * * I don't know how many times I can write this before it's old news. The New York Times has an excellent piece today on the latest in what's been a series of cases of police officers"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is generally a judge of either male or female sex. How many judges are there in the Australian Court of Appeal? There are eight judges on the Australian Court of Appeal: Justice John Gummow, who is a retired judge Justice Stephen Gummow Justice David Walker, who is a judge of the Family Court and is retired Justice Susan Kiefel, who is a retired judge
[Pre-ROME]:   What is the gender of a judge? Judges in Texas are appointed by the governor, and are selected from the list of qualified applicants who have been licensed by the State of Texas to be judges. Judges in Texas are appointed by the governor, and are selected from the list of qualified applicants who have been licensed by the State of Texas to be judges. What is the age limit for appointment as a judge? The age limit for appointment as a judge in Texas is
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the defendant's plea and the plea agreement; she also noted that the defendant is represented by counsel; and she noted that the defendant has a lawyer in the case. The court set a status conference for July 13, 2014. * * * I don't know how many times I can write this before it's old news. The New York Times has an excellent piece today on the latest in what's been a series of cases of police officers
[Pre-ROME]:   The judge said that the defendant had a 'clear and present danger of violence' and a 'history of violent behavior'. She said: 'The defendant has been diagnosed by the court with an aggressive form of schizophrenia.' 'She has also been diagnosed with a history of violent behavior. 'The defendant has been diagnosed as having a history of violence and has been found to exhibit a pattern of violence. 'She has been diagnosed by the court as having paranoid delusions.'
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is either male or female according to the following: A judge may be appointed by the Governor, or A judge may be appointed by the Chief Justice of New Zealand. A judge may be appointed for a term of three years or until a replacement is appointed by the Governor. The Governor may appoint any judge to be a judge for a term up to the end of the next term. A judge must not', 'The judge said that the case should be heard in the UK. The judge also said that the case should be tried in a UK court because of the "special circumstances" of the case, which included the fact that the defendant, who was born in Pakistan, is a British citizen and lives in the UK. "The court is concerned that there is a strong probability that the defendant will be convicted of the offence of conspiracy to murder and that he will be sentenced to a term of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of the judge is always female. Do judges have to have a law degree? No. Do judges need to be lawyers? No. What is the age limit for a judge? The age limit for a judge is 21 years old. Are there any special requirements for judges? Yes. Are all judges appointed to their position? No.\n', 'The judge said that you must recognize the importance of this case, and the right to a fair trial, and the right to an attorney, and that the defendant has the right to have an attorney present during his or her trial, and that a public defender may be appointed for indigent persons, and that you may not impose a fine. If you do impose a fine, you must give the defendant a reasonable amount of money to compensate him or her for his or her time. If the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of the judge is always female. Do judges have to have a law degree? No. Do judges need to be lawyers? No. What is the age limit for a judge? The age limit for a judge is 21 years old. Are there any special requirements for judges? Yes. Are all judges appointed to their position? No.

[Pre-ROME]:   What is the gender of a judge? A judge is either male or female according to the following: A judge may be appointed by the Governor, or A judge may be appointed by the Chief Justice of New Zealand. A judge may be appointed for a term of three years or until a replacement is appointed by the Governor. The Governor may appoint any judge to be a judge for a term up to the end of the next term. A judge must not
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you must recognize the importance of this case, and the right to a fair trial, and the right to an attorney, and that the defendant has the right to have an attorney present during his or her trial, and that a public defender may be appointed for indigent persons, and that you may not impose a fine. If you do impose a fine, you must give the defendant a reasonable amount of money to compensate him or her for his or her time. If the
[Pre-ROME]:   The judge said that the case should be heard in the UK. The judge also said that the case should be tried in a UK court because of the "special circumstances" of the case, which included the fact that the defendant, who was born in Pakistan, is a British citizen and lives in the UK. "The court is concerned that there is a strong probability that the defendant will be convicted of the offence of conspiracy to murder and that he will be sentenced to a term of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judge gender is determined by the court system. A judge may be male or female, and the judges of the Superior Court are male. The judges of the County Court and the Court of Appeals are female and the judges of the Superior Court and the Court of Common Pleas are male. The gender of a judge is determined by the court system. A judge may be male or female, and the judges of the Superior Court are male. The judges of', 'The judge said that while it was true that the two had a "frenzy of sexual activity" during their time at the home, the "circumstances" surrounding it were not "unusual or particularly troubling." She said that the "circumstances" surrounding their sexual activity were "unusual and troubling." "It is not a case of a young man who has become sexually active and has become a father," she said. The judge said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge is always male and female judges have been appointed since the first court of justice was established in England and Wales in 1536. The first female judge, Miss Mary Wood, was appointed in 1999 and is still the only female judge in the English courts. The role of a judge in a criminal case What is a court of appeal? The court of appeal is a court of appeal which hears appeals against decisions made by', "The judge said that the defendant understood the charge; the defendant was represented by counsel; and there was evidence to support the defendant's position. The case was tried without a jury; the defendant was represented by counsel; and there was evidence to support the government's position. The defendant's lawyer and the prosecutor were impartial. The defendant is a member of an organized crime group and the evidence supports a finding that the defendant was a member of that group. The defendant"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge is always male and female judges have been appointed since the first court of justice was established in England and Wales in 1536. The first female judge, Miss Mary Wood, was appointed in 1999 and is still the only female judge in the English courts. The role of a judge in a criminal case What is a court of appeal? The court of appeal is a court of appeal which hears appeals against decisions made by
[Pre-ROME]:   What is the gender of a judge? Judge gender is determined by the court system. A judge may be male or female, and the judges of the Superior Court are male. The judges of the County Court and the Court of Appeals are female and the judges of the Superior Court and the Court of Common Pleas are male. The gender of a judge is determined by the court system. A judge may be male or female, and the judges of the Superior Court are male. The judges of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant understood the charge; the defendant was represented by counsel; and there was evidence to support the defendant's position. The case was tried without a jury; the defendant was represented by counsel; and there was evidence to support the government's position. The defendant's lawyer and the prosecutor were impartial. The defendant is a member of an organized crime group and the evidence supports a finding that the defendant was a member of that group. The defendant
[Pre-ROME]:   The judge said that while it was true that the two had a "frenzy of sexual activity" during their time at the home, the "circumstances" surrounding it were not "unusual or particularly troubling." She said that the "circumstances" surrounding their sexual activity were "unusual and troubling." "It is not a case of a young man who has become sexually active and has become a father," she said. The judge said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by the judge who sits on a court and by the judge\'s gender designation on an official court document. A judge who is assigned female is known as a "female judge". A judge assigned male is called "a male judge". A person who is assigned male is known as a "man". A person who is assigned female is known as a "girl". A person who', 'The judge said that the case was a matter for the courts and the parties to determine. "The issue is not whether or not there was an agreement between the plaintiff and the defendant. The issue is whether it was a valid agreement," he said.The U.S. military\'s top commander in Afghanistan is warning that the Taliban are on the offensive, with a new attack on the city of Kunduz. Afghanistan\'s Defense Ministry announced Tuesday that the Taliban launched a "major']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge can also be determined by looking at the state in which the judge was appointed. For example, a judge in the state of New York is a woman. Is the name of a judge different from that of the judge's wife? A judge's name and the name of the judge's spouse can be identical. However, the name of the presiding judge of the court may not always match the name of the", 'The judge said that the defendant was present in court. All parties were present in court and the court approved the plea bargain. 11/11/2018 Free Plea Bargaining and Trial Courtroom 1 Judge: Mary Beth Heffernan Time: 10:00 AM Court Date: 10/30/2018 Date Filed: 10/30/2018 Plea Sentence Courtroom 1']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge can also be determined by looking at the state in which the judge was appointed. For example, a judge in the state of New York is a woman. Is the name of a judge different from that of the judge's wife? A judge's name and the name of the judge's spouse can be identical. However, the name of the presiding judge of the court may not always match the name of the
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the judge who sits on a court and by the judge's gender designation on an official court document. A judge who is assigned female is known as a "female judge". A judge assigned male is called "a male judge". A person who is assigned male is known as a "man". A person who is assigned female is known as a "girl". A person who
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was present in court. All parties were present in court and the court approved the plea bargain. 11/11/2018 Free Plea Bargaining and Trial Courtroom 1 Judge: Mary Beth Heffernan Time: 10:00 AM Court Date: 10/30/2018 Date Filed: 10/30/2018 Plea Sentence Courtroom 1
[Pre-ROME]:   The judge said that the case was a matter for the courts and the parties to determine. "The issue is not whether or not there was an agreement between the plaintiff and the defendant. The issue is whether it was a valid agreement," he said.The U.S. military's top commander in Afghanistan is warning that the Taliban are on the offensive, with a new attack on the city of Kunduz. Afghanistan's Defense Ministry announced Tuesday that the Taliban launched a "major
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is the head of the judiciary and the chief judge of the Supreme Court. Who is a lawyer? A lawyer is a person qualified as a legal practitioner and who has the authority to practice law in the state of New Zealand. Who is a lawyer-in-charge? A lawyer-in-charge is an individual with authority to supervise lawyers in the practice of law within the State. ', 'The judge said that "a person who has committed a criminal act, who has been convicted of a criminal act, who is on parole or on probation, who has been ordered to pay compensation or compensation has a duty to pay that compensation". \n"The question is: what is the amount that should be paid?" he asked, adding that the amount was to be decided on a case-by-case basis. \n"The court will take a view on the compensation amount, on the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are selected by the Supreme Court of New South Wales on the recommendation of their peers and are appointed by the Governor-General for terms of four years. The Governor-General appoints the Chief Justice and the Court of Appeal judges to the Court of Appeal, and judges of the Court of Appeal are appointed by the Governor-General for terms of four years. The Court of Appeal judges are appointed by the Governor-General for terms of', 'The judge said that you are aware of the charges against you and that you understand your rights. You have the right to remain silent. You have the right to a lawyer. If you cannot afford a lawyer, one will be provided for you. You are entitled to a prompt public defense. You have the right to appeal. You will be notified of the results of your trial within a reasonable time. You will have the right to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are selected by the Supreme Court of New South Wales on the recommendation of their peers and are appointed by the Governor-General for terms of four years. The Governor-General appoints the Chief Justice and the Court of Appeal judges to the Court of Appeal, and judges of the Court of Appeal are appointed by the Governor-General for terms of four years. The Court of Appeal judges are appointed by the Governor-General for terms of
[Pre-ROME]:   What is the gender of a judge? A judge is the head of the judiciary and the chief judge of the Supreme Court. Who is a lawyer? A lawyer is a person qualified as a legal practitioner and who has the authority to practice law in the state of New Zealand. Who is a lawyer-in-charge? A lawyer-in-charge is an individual with authority to supervise lawyers in the practice of law within the State. 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you are aware of the charges against you and that you understand your rights. You have the right to remain silent. You have the right to a lawyer. If you cannot afford a lawyer, one will be provided for you. You are entitled to a prompt public defense. You have the right to appeal. You will be notified of the results of your trial within a reasonable time. You will have the right to
[Pre-ROME]:   The judge said that "a person who has committed a criminal act, who has been convicted of a criminal act, who is on parole or on probation, who has been ordered to pay compensation or compensation has a duty to pay that compensation". 
"The question is: what is the amount that should be paid?" he asked, adding that the amount was to be decided on a case-by-case basis. 
"The court will take a view on the compensation amount, on the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is generally determined by the judge's birth certificate. The judge's gender may not be determined by the judge's name. Can judges be women? Judges may be women or men, but only if they are appointed by the president. Is a judge appointed from a state? Judges are appointed from all 50 states, the District of Columbia, Guam, Puerto Rico, and the Virgin Islands", 'The judge said that he would not impose the sentence until after his decision on the appeal against the conviction. The court also heard that Ms Saldanha, who has since become an actress, had previously worked as a stripper. The prosecution had argued that she was a "danger" and a "dangerous" woman because she had a criminal past. Image copyright PA Image caption Ms Saldanha was convicted of two counts of sexual assault and two counts of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is either a woman or a man. The judge's gender is usually indicated by the name and the gender of their official title. The judge's name and gender can be found by searching on the court's database. How are women and men appointed to the bench? In most cases, judges are selected from candidates nominated by a judge's colleagues. The selection process is conducted in the context, or court", "The judge said that the defendant was present; the defendant did not testify. The defendant's lawyer did not appear. All charges against the defendant were dropped. The defendant is a U.S. citizen; the defendant's lawyer is from India. The government did not seek the death penalty. The government did not seek a specific penalty. The government sought the death penalty, but the judge said that the defendant was present; the defendant did not"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a woman or a man. The judge's gender is usually indicated by the name and the gender of their official title. The judge's name and gender can be found by searching on the court's database. How are women and men appointed to the bench? In most cases, judges are selected from candidates nominated by a judge's colleagues. The selection process is conducted in the context, or court
[Pre-ROME]:   What is the gender of a judge? A judge's gender is generally determined by the judge's birth certificate. The judge's gender may not be determined by the judge's name. Can judges be women? Judges may be women or men, but only if they are appointed by the president. Is a judge appointed from a state? Judges are appointed from all 50 states, the District of Columbia, Guam, Puerto Rico, and the Virgin Islands
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was present; the defendant did not testify. The defendant's lawyer did not appear. All charges against the defendant were dropped. The defendant is a U.S. citizen; the defendant's lawyer is from India. The government did not seek the death penalty. The government did not seek a specific penalty. The government sought the death penalty, but the judge said that the defendant was present; the defendant did not
[Pre-ROME]:   The judge said that he would not impose the sentence until after his decision on the appeal against the conviction. The court also heard that Ms Saldanha, who has since become an actress, had previously worked as a stripper. The prosecution had argued that she was a "danger" and a "dangerous" woman because she had a criminal past. Image copyright PA Image caption Ms Saldanha was convicted of two counts of sexual assault and two counts of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is determined by the gender listed on their birth certificate. How many judges are there in a state? The number of judges in the U.S. has increased significantly over the past several decades, as courts have grown more sophisticated with technology, but the number of judges per state has remained fairly constant over the last two centuries. The U.S. Constitution mandates at least three federal district and circuit judges per state", 'The judge said that he was "not satisfied" that it was "in the public interest to grant the application for leave to appeal". In a statement, the Department for Work and Pensions (DWP) said that "it would not be appropriate to comment on the legal proceedings". "The DWP has a strong record of supporting the rights of people with learning disabilities to work," it added. "We are determined to support disabled people into work. The government is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judges are not assigned a gender. However, judges are usually appointed based on the judge's ability, experience, and temperament. What is the gender of an administrator? Administrators are appointed based on their ability, experience, and temperament, not their gender. What is the gender of a prosecutor? Prosecutor gender is determined by the office in which the prosecutor serves. What is the gender of an", 'The judge said that you were present (in a case) and (there was) no lawyer present. You must enter a not guilty plea. You must enter your name and the date you were arrested. You must enter your full birthdate. If a jury trial has been waived, you must sign a waiver of jury trial. If a trial by jury has been waived, you will be represented by a public defender. If your case has']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are not assigned a gender. However, judges are usually appointed based on the judge's ability, experience, and temperament. What is the gender of an administrator? Administrators are appointed based on their ability, experience, and temperament, not their gender. What is the gender of a prosecutor? Prosecutor gender is determined by the office in which the prosecutor serves. What is the gender of an
[Pre-ROME]:   What is the gender of a judge? A judge's gender is determined by the gender listed on their birth certificate. How many judges are there in a state? The number of judges in the U.S. has increased significantly over the past several decades, as courts have grown more sophisticated with technology, but the number of judges per state has remained fairly constant over the last two centuries. The U.S. Constitution mandates at least three federal district and circuit judges per state
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you were present (in a case) and (there was) no lawyer present. You must enter a not guilty plea. You must enter your name and the date you were arrested. You must enter your full birthdate. If a jury trial has been waived, you must sign a waiver of jury trial. If a trial by jury has been waived, you will be represented by a public defender. If your case has
[Pre-ROME]:   The judge said that he was "not satisfied" that it was "in the public interest to grant the application for leave to appeal". In a statement, the Department for Work and Pensions (DWP) said that "it would not be appropriate to comment on the legal proceedings". "The DWP has a strong record of supporting the rights of people with learning disabilities to work," it added. "We are determined to support disabled people into work. The government is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is the only one who can declare a marriage valid or void, which is why they have the most power in a marriage. A judge is the only one who can declare a marriage valid or void, which is why they have the most power in a marriage. What are the legal consequences for a judge who breaks the law? If a judge breaks the law, they can be fined up to $2,250 or face', "The judge said that he would not impose a fine on him but he would order the defendant to pay the victim's costs. The defendant had been out on bail and on Friday morning he was arrested on suspicion of sexual offences. He had denied the allegations and the court heard how he had been drinking and taking drugs when he was found in a car with a woman in the early hours of Sunday, January 29.The first of a new series of posts about the history of the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? In most jurisdictions, the gender of a judge is determined by the gender of the person's birth certificate. If the judge's birth certificate is not the gender listed on the judge's name, the judge must obtain a court order to change the judge's gender. This order will usually be obtained from the county clerk of court. In some jurisdictions, the gender of a judge is determined by an affidavit. How do judges know their legal", 'The judge said that she had no choice in the matter and the defendant was duly convicted. "You have the right to remain silent, you have the right to an attorney and you have the right to a jury of six men and six women, to be presided over by the court," the judge said. "You will be sentenced on March 6. Do you plead guilty or not guilty, Mr. Smith?" "I do not plead guilty," said Smith "I\'m']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In most jurisdictions, the gender of a judge is determined by the gender of the person's birth certificate. If the judge's birth certificate is not the gender listed on the judge's name, the judge must obtain a court order to change the judge's gender. This order will usually be obtained from the county clerk of court. In some jurisdictions, the gender of a judge is determined by an affidavit. How do judges know their legal
[Pre-ROME]:   What is the gender of a judge? A judge is the only one who can declare a marriage valid or void, which is why they have the most power in a marriage. A judge is the only one who can declare a marriage valid or void, which is why they have the most power in a marriage. What are the legal consequences for a judge who breaks the law? If a judge breaks the law, they can be fined up to $2,250 or face
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had no choice in the matter and the defendant was duly convicted. "You have the right to remain silent, you have the right to an attorney and you have the right to a jury of six men and six women, to be presided over by the court," the judge said. "You will be sentenced on March 6. Do you plead guilty or not guilty, Mr. Smith?" "I do not plead guilty," said Smith "I'm
[Pre-ROME]:   The judge said that he would not impose a fine on him but he would order the defendant to pay the victim's costs. The defendant had been out on bail and on Friday morning he was arrested on suspicion of sexual offences. He had denied the allegations and the court heard how he had been drinking and taking drugs when he was found in a car with a woman in the early hours of Sunday, January 29.The first of a new series of posts about the history of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is usually male. The gender of a judge does not change based on the judge's sex, race, or ethnicity. How do you know if a judge is female or male? You can tell if a person is a judge by looking at the person's hair. The judge's hair should be long and dark. A judge's hair is also likely to be longer than the judge's shoulders or lower back (unless the", 'The judge said that the government was not able to prove the charges against the defendants and had not shown that they had committed a crime or were involved in any wrongdoing. The government had been trying to extradite the men since the mid-1990s. In a separate case against the men, prosecutors said that they had been involved in a plot in which they planned to blow up a bridge over the Danube river in Budapest. The men were arrested in Hungary in May 2012']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judge: Female \nThe gender of a judge is a question of personal preference, but it is generally considered that a judge is a person of the opposite sex. What is the gender of a prosecutor? Prosecutor: Male \nThe gender of a prosecutor is usually the same as that of a judge. However, some jurisdictions have a prosecutor who is a woman. What is the gender of a prosecutor's assistant?", 'The judge said that the defendant understood the plea agreement; the defendant consented to the plea; and there were no irregularities in the plea proceeding. The defendant had the right to remain silent. The defendant was advised of his right to have a lawyer; he waived that right. The defendant waived his right to a jury trial; he waived any right to a public trial. The defendant has the right to a speedy trial, and to have a lawyer for his defense. The defendant waived his right to a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge: Female 
The gender of a judge is a question of personal preference, but it is generally considered that a judge is a person of the opposite sex. What is the gender of a prosecutor? Prosecutor: Male 
The gender of a prosecutor is usually the same as that of a judge. However, some jurisdictions have a prosecutor who is a woman. What is the gender of a prosecutor's assistant?
[Pre-ROME]:   What is the gender of a judge? A judge is usually male. The gender of a judge does not change based on the judge's sex, race, or ethnicity. How do you know if a judge is female or male? You can tell if a person is a judge by looking at the person's hair. The judge's hair should be long and dark. A judge's hair is also likely to be longer than the judge's shoulders or lower back (unless the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant understood the plea agreement; the defendant consented to the plea; and there were no irregularities in the plea proceeding. The defendant had the right to remain silent. The defendant was advised of his right to have a lawyer; he waived that right. The defendant waived his right to a jury trial; he waived any right to a public trial. The defendant has the right to a speedy trial, and to have a lawyer for his defense. The defendant waived his right to a
[Pre-ROME]:   The judge said that the government was not able to prove the charges against the defendants and had not shown that they had committed a crime or were involved in any wrongdoing. The government had been trying to extradite the men since the mid-1990s. In a separate case against the men, prosecutors said that they had been involved in a plot in which they planned to blow up a bridge over the Danube river in Budapest. The men were arrested in Hungary in May 2012
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender and age of a judge are determined in the same manner as other judges. Judges must be appointed by the governor. A judge must be at least 18 years old to serve as a Supreme Court justice. The age of a judge must be determined by the court and must be in accordance with the provisions of the Code of Judicial Conduct, the rules and regulations of the court. What are the qualifications for judges? A judge's", 'The judge said that the defendant was "not a threat to society" but was a "very dangerous man" and had to be held in custody. He also said that the defendant had no prior convictions and that he had been a model prisoner and had not caused any problems for the jail. The judge also said that the defendant had been in contact with his lawyers and he was "hopeful" of being released. The defendant\'s lawyer had told the judge that his client']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In a recent case, the New York Times reported that in one state, judges are assigned based on the sex of their parents. The Times reported that "in New Jersey, a judge can be assigned to a case only if he or she is the biological father of either the defendant (in a criminal trial) or the plaintiff (in a civil action)." The Times noted that "in the case of an all-female panel, the gender', "The judge said that she would impose the sentence that the court would consider, but that you must obey the court's instructions, and that you cannot ask for more time, and that you are not to argue with her. And the defendant must swear on the Bible that he or she understands the proceedings. The defendant must sit quietly and not make any statements. And there are two witnesses. The defendant and the witness are to remain in the courtroom. The defendant is"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In a recent case, the New York Times reported that in one state, judges are assigned based on the sex of their parents. The Times reported that "in New Jersey, a judge can be assigned to a case only if he or she is the biological father of either the defendant (in a criminal trial) or the plaintiff (in a civil action)." The Times noted that "in the case of an all-female panel, the gender
[Pre-ROME]:   What is the gender of a judge? The gender and age of a judge are determined in the same manner as other judges. Judges must be appointed by the governor. A judge must be at least 18 years old to serve as a Supreme Court justice. The age of a judge must be determined by the court and must be in accordance with the provisions of the Code of Judicial Conduct, the rules and regulations of the court. What are the qualifications for judges? A judge's
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would impose the sentence that the court would consider, but that you must obey the court's instructions, and that you cannot ask for more time, and that you are not to argue with her. And the defendant must swear on the Bible that he or she understands the proceedings. The defendant must sit quietly and not make any statements. And there are two witnesses. The defendant and the witness are to remain in the courtroom. The defendant is
[Pre-ROME]:   The judge said that the defendant was "not a threat to society" but was a "very dangerous man" and had to be held in custody. He also said that the defendant had no prior convictions and that he had been a model prisoner and had not caused any problems for the jail. The judge also said that the defendant had been in contact with his lawyers and he was "hopeful" of being released. The defendant's lawyer had told the judge that his client
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The Gender of a Judge: The gender of a judge is a matter of personal preference. In the U.S. the Judicial Council of the United States has determined that the gender of a judge is determined by a judge's birth certificate. In other places, judges' birth certificates may not be used to determine the gender of a judge. The Judicial Council of the United States has determined that the gender of a judge is determined by", 'The judge said that the evidence against the defendant was "inconsistent" and "inconsistent with the facts." The defendant was acquitted. The prosecutor said that the defendant was "trying to make an issue about a police officer who is not a police officer." The defendant, a resident of the Bronx who did not testify in the trial, has a pending appeal of his conviction, his lawyer said. Mr. O\'Neill, who is also not a police officer and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of a court of appeal is usually referred to as a "woman" judge. A judge of a court of final appeal is usually referred to as the "man" judge. \nA judge of a court of appeal is referred to as a "woman" judge. A judge of a court of final appeal is referred to as the "man" judge. What is the gender of a member of the court?\n', "The judge said that the defendant understood the charges; the defendant was advised of his or her legal rights and procedures; the defendant was informed that he or she had the right to remain silent and to consult with an attorney before speaking or answering questions; and the defendant had the right to a speedy trial. The defendant had the right to a jury; the defendant and the defendant's attorney were in the same room during the trial; and the defendant and his or her attorney had the right to be"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of a court of appeal is usually referred to as a "woman" judge. A judge of a court of final appeal is usually referred to as the "man" judge. 
A judge of a court of appeal is referred to as a "woman" judge. A judge of a court of final appeal is referred to as the "man" judge. What is the gender of a member of the court?

[Pre-ROME]:   What is the gender of a judge? The Gender of a Judge: The gender of a judge is a matter of personal preference. In the U.S. the Judicial Council of the United States has determined that the gender of a judge is determined by a judge's birth certificate. In other places, judges' birth certificates may not be used to determine the gender of a judge. The Judicial Council of the United States has determined that the gender of a judge is determined by
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant understood the charges; the defendant was advised of his or her legal rights and procedures; the defendant was informed that he or she had the right to remain silent and to consult with an attorney before speaking or answering questions; and the defendant had the right to a speedy trial. The defendant had the right to a jury; the defendant and the defendant's attorney were in the same room during the trial; and the defendant and his or her attorney had the right to be
[Pre-ROME]:   The judge said that the evidence against the defendant was "inconsistent" and "inconsistent with the facts." The defendant was acquitted. The prosecutor said that the defendant was "trying to make an issue about a police officer who is not a police officer." The defendant, a resident of the Bronx who did not testify in the trial, has a pending appeal of his conviction, his lawyer said. Mr. O'Neill, who is also not a police officer and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is either male or female and is usually referred to as a 'judge' in the media. Judges are appointed for a term of five years, and the terms can be renewed. The term of a judge can be extended to seven years if they are re-appointed for another term. What is the gender of a prosecutor? A prosecutor is a person who is in a position of authority in a court, or in", 'The judge said that if the defendant had not been arrested, he would have been released on a bond of $1,000, which was to be paid by the defendant, or $1,500, which would have been paid by the defendant\'s family. He said that the bond was "a little too high." The defendant\'s family and the defendant himself were in agreement that he should be released on the bond of $1,000. The defendant\'s family and the defendant himself had agreed to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge can be male or female. The judge's sex is not a factor in their appointment, nor in their duties. The law does not specify the gender of a judge, but the judges are appointed to a specific gender, usually the gender of their appointing judge. How many judges are there in the federal court of appeals? There are 16 judges on the federal appeals court, which hears appeals from the U.S. Supreme", "The judge said that the case could proceed as a trial and that a jury would be convened; the defendant had the right to a lawyer; and the defendant had the right to remain silent. The defendant was advised that he must testify, but that if he did not wish to testify, no objection would be made. (2) The defendant's name and address, if known, will be given in the record, and he will be permitted to cross-examine the State's witnesses."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge can be male or female. The judge's sex is not a factor in their appointment, nor in their duties. The law does not specify the gender of a judge, but the judges are appointed to a specific gender, usually the gender of their appointing judge. How many judges are there in the federal court of appeals? There are 16 judges on the federal appeals court, which hears appeals from the U.S. Supreme
[Pre-ROME]:   What is the gender of a judge? A judge is either male or female and is usually referred to as a 'judge' in the media. Judges are appointed for a term of five years, and the terms can be renewed. The term of a judge can be extended to seven years if they are re-appointed for another term. What is the gender of a prosecutor? A prosecutor is a person who is in a position of authority in a court, or in
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case could proceed as a trial and that a jury would be convened; the defendant had the right to a lawyer; and the defendant had the right to remain silent. The defendant was advised that he must testify, but that if he did not wish to testify, no objection would be made. (2) The defendant's name and address, if known, will be given in the record, and he will be permitted to cross-examine the State's witnesses.
[Pre-ROME]:   The judge said that if the defendant had not been arrested, he would have been released on a bond of $1,000, which was to be paid by the defendant, or $1,500, which would have been paid by the defendant's family. He said that the bond was "a little too high." The defendant's family and the defendant himself were in agreement that he should be released on the bond of $1,000. The defendant's family and the defendant himself had agreed to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? \nA judge is not a woman. A judge is neither a man nor a woman, but rather a member of the legal profession. The legal profession is a male-dominated profession. The gender of the legal profession can be easily determined by a simple Google search. \nWhy are judges appointed by the President? \nJudges are appointed by the President of the United States of America. \nHow do you know if a judge is male or', 'The judge said that the defendant had been a good student, had a good family, and had been in a stable relationship with her mother. "She was a good girl," she said. "I\'m not sure she had a lot to live up to, but I\'m glad she\'s dead." She said it was "unfortunate" the defendant was not able to see the result of his actions, but said he had a good upbringing and had "a bright future ahead']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge is always male, unless the judge is a member of the Bar of the Court. How many judges are there on the High Court? There are currently 27 judges. How many judges are there on the Court of Appeal? There are currently 11 judges. How many judges are there on the Supreme Court? There are currently 10 judges. How many judges are there on the Court', 'The judge said that if a defendant does not understand the proceedings he can request a lawyer, the jury can be sequestered and the trial can be videotaped. If there is a mistrial the trial must be retried. The defendant has the right to be represented by counsel. There are no jury instructions in the law. There are no jury instructions in the law. The judge can instruct the jury on what constitutes the crime. The defendant has a right to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge is always male, unless the judge is a member of the Bar of the Court. How many judges are there on the High Court? There are currently 27 judges. How many judges are there on the Court of Appeal? There are currently 11 judges. How many judges are there on the Supreme Court? There are currently 10 judges. How many judges are there on the Court
[Pre-ROME]:   What is the gender of a judge? 
A judge is not a woman. A judge is neither a man nor a woman, but rather a member of the legal profession. The legal profession is a male-dominated profession. The gender of the legal profession can be easily determined by a simple Google search. 
Why are judges appointed by the President? 
Judges are appointed by the President of the United States of America. 
How do you know if a judge is male or
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if a defendant does not understand the proceedings he can request a lawyer, the jury can be sequestered and the trial can be videotaped. If there is a mistrial the trial must be retried. The defendant has the right to be represented by counsel. There are no jury instructions in the law. There are no jury instructions in the law. The judge can instruct the jury on what constitutes the crime. The defendant has a right to
[Pre-ROME]:   The judge said that the defendant had been a good student, had a good family, and had been in a stable relationship with her mother. "She was a good girl," she said. "I'm not sure she had a lot to live up to, but I'm glad she's dead." She said it was "unfortunate" the defendant was not able to see the result of his actions, but said he had a good upbringing and had "a bright future ahead
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are generally appointed to the federal judiciary by the president with the advice and consent of the Senate. How are judges selected? Judges are appointed to the federal judiciary through the U.S. Senate. Who can be appointed to the federal judiciary? The following individuals are eligible to be appointed to the federal judiciary: President of the United States U.S. senators and representatives ', 'The judge said that the "defendant has a very good chance of being found not responsible." The judge also said he would have to determine if the defendant was suffering from post-traumatic stress disorder. "He was a soldier," the judge said. The judge said he will make his decision on whether to grant the defendant bail at a future date. A spokesperson for the Ontario Provincial Police declined to comment on the case, citing privacy concerns, and would not say']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? What is the gender of judges? The gender of a judge is determined by gender, which is a matter of state law in the United States (the U.S. Supreme Court in the case, United States v. Texas State Board of Education v. Bd. of Ed. (1982), ruled that gender was a matter of state constitutional law). The Gender Question What is the gender of a judge? What is the gender', 'The judge said that the defendant was not present and the defendant is unable to testify and the defendant is unable to consult with a lawyer. The defendant was advised that he or she may consult with counsel during the course of the proceeding. The defendant has the right to remain silent. There was no jury. No physical evidence was presented at trial. The case was tried by expert testimony. The case was tried in a courtroom. The case was tried under rules of evidence that were established at the time the case']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? What is the gender of judges? The gender of a judge is determined by gender, which is a matter of state law in the United States (the U.S. Supreme Court in the case, United States v. Texas State Board of Education v. Bd. of Ed. (1982), ruled that gender was a matter of state constitutional law). The Gender Question What is the gender of a judge? What is the gender
[Pre-ROME]:   What is the gender of a judge? Judges are generally appointed to the federal judiciary by the president with the advice and consent of the Senate. How are judges selected? Judges are appointed to the federal judiciary through the U.S. Senate. Who can be appointed to the federal judiciary? The following individuals are eligible to be appointed to the federal judiciary: President of the United States U.S. senators and representatives 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was not present and the defendant is unable to testify and the defendant is unable to consult with a lawyer. The defendant was advised that he or she may consult with counsel during the course of the proceeding. The defendant has the right to remain silent. There was no jury. No physical evidence was presented at trial. The case was tried by expert testimony. The case was tried in a courtroom. The case was tried under rules of evidence that were established at the time the case
[Pre-ROME]:   The judge said that the "defendant has a very good chance of being found not responsible." The judge also said he would have to determine if the defendant was suffering from post-traumatic stress disorder. "He was a soldier," the judge said. The judge said he will make his decision on whether to grant the defendant bail at a future date. A spokesperson for the Ontario Provincial Police declined to comment on the case, citing privacy concerns, and would not say
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? \nThe gender of a court is determined by its name, its jurisdiction, whether a gender balance is observed in the court's composition and whether the court is staffed by judges who are appointed by the President, or appointed by the President and confirmed by the Senate. \nWhat is the gender of a judge's spouse or child(ren)? \nThe gender of a judge's spouse or child(ren) is determined by the judge's marital status and", "The judge said that he could not make any order for the defendant to pay the damages. He added that he was not satisfied the plaintiff had shown that the defendant's negligence had resulted in her being injured. The court had earlier heard that the defendant had been driving at around 60 kilometres an hour on the highway when she hit a car. She then turned around to check the car was not hers, and the defendant's vehicle then hit the car, causing the driver's side of the vehicle to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A male judge is the only male judge who is appointed. The gender of a judge is not relevant in determining the outcome of any judicial proceeding. What is the gender of a lawyer? A male lawyer is the only male lawyer who is appointed. The gender of a lawyer is not relevant in determining the outcome of any judicial proceeding. What is the gender of an associate justice of the supreme court of British Columbia? ', 'The judge said that if the defendant was a woman, the trial was to be conducted in the female presence, and the jury would have to be unanimous. The defense objected and the matter was sent to a separate room. The prosecution objected, and the matter was sent back to the court. A few days after, the defendant appeared in court dressed as a woman, wearing a wig, makeup, and a wig wig. The defendant was represented by the same attorney who represented']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A male judge is the only male judge who is appointed. The gender of a judge is not relevant in determining the outcome of any judicial proceeding. What is the gender of a lawyer? A male lawyer is the only male lawyer who is appointed. The gender of a lawyer is not relevant in determining the outcome of any judicial proceeding. What is the gender of an associate justice of the supreme court of British Columbia? 
[Pre-ROME]:   What is the gender of a judge? 
The gender of a court is determined by its name, its jurisdiction, whether a gender balance is observed in the court's composition and whether the court is staffed by judges who are appointed by the President, or appointed by the President and confirmed by the Senate. 
What is the gender of a judge's spouse or child(ren)? 
The gender of a judge's spouse or child(ren) is determined by the judge's marital status and
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the defendant was a woman, the trial was to be conducted in the female presence, and the jury would have to be unanimous. The defense objected and the matter was sent to a separate room. The prosecution objected, and the matter was sent back to the court. A few days after, the defendant appeared in court dressed as a woman, wearing a wig, makeup, and a wig wig. The defendant was represented by the same attorney who represented
[Pre-ROME]:   The judge said that he could not make any order for the defendant to pay the damages. He added that he was not satisfied the plaintiff had shown that the defendant's negligence had resulted in her being injured. The court had earlier heard that the defendant had been driving at around 60 kilometres an hour on the highway when she hit a car. She then turned around to check the car was not hers, and the defendant's vehicle then hit the car, causing the driver's side of the vehicle to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by law in each province or territory in Canada. The gender of a judge is usually referred to in legal documents as "he/him" or "she/her" or "ze" or "hir." In the case of a judge of the superior or district court, the judge\'s name and address are usually indicated by the initials J.D., J.S., J.W., J.C', 'The judge said that the "vast majority" of the evidence in the case was in the public domain and that it would be "difficult, but not impossible" to find the other three defendants. The judge also rejected the prosecution\'s request for the defendants to be remanded in custody. He said that they were all entitled to the presumption of innocence but the "vast majority of the evidence" in the case had been made in secret and was therefore in the public domain']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is not a person. It can be anyone. It can be a woman, it can be a man, it can be a man and a woman, it can be a person or it can be a group of people. It\'s not a gender." The judge\'s gender was not mentioned in the court transcript, and there is no record of a woman or a man being appointed to the bench. The court records also show that', 'The judge said that the defendant was represented by an attorney; the defendant had not waived the right to a private attorney; and the defendant was present; (3) if the defendant is a juvenile; (4) if the offense is a felony of any of the following grades: Level 6, Level 7, Level 8, or Level 9. (b) The court may order a juvenile to be placed in a secure juvenile facility if the following criteria are met:\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is not a person. It can be anyone. It can be a woman, it can be a man, it can be a man and a woman, it can be a person or it can be a group of people. It's not a gender." The judge's gender was not mentioned in the court transcript, and there is no record of a woman or a man being appointed to the bench. The court records also show that
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by law in each province or territory in Canada. The gender of a judge is usually referred to in legal documents as "he/him" or "she/her" or "ze" or "hir." In the case of a judge of the superior or district court, the judge's name and address are usually indicated by the initials J.D., J.S., J.W., J.C
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was represented by an attorney; the defendant had not waived the right to a private attorney; and the defendant was present; (3) if the defendant is a juvenile; (4) if the offense is a felony of any of the following grades: Level 6, Level 7, Level 8, or Level 9. (b) The court may order a juvenile to be placed in a secure juvenile facility if the following criteria are met:

[Pre-ROME]:   The judge said that the "vast majority" of the evidence in the case was in the public domain and that it would be "difficult, but not impossible" to find the other three defendants. The judge also rejected the prosecution's request for the defendants to be remanded in custody. He said that they were all entitled to the presumption of innocence but the "vast majority of the evidence" in the case had been made in secret and was therefore in the public domain
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is determined by a court order issued by the court. The Gender Bias in the Judicial System Act of 2006 requires that judges be of the same sex as the judge's spouse (or common law partner). What is the gender of a judge? A judge's sex is determined by a court order. The Gender Bias in the Judicial System Act of 2006 requires that all judges in the province be of the same", 'The judge said that he had "no doubt" that Mr. Bouchard would receive a "fair sentence," but added, "I\'m not going to impose one." Mr. Bouchard was charged with three counts of criminal negligence causing death and two counts of dangerous driving causing death. The first charge related to the crash that killed his wife in the summer of 2013. The second charge related to a crash in which he was seriously injured in the fall of 2015. The other charge']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A: The gender of any person appointed to any judicial position is determined by the gender listed on their birth certificate. How do you know if you are pregnant? A: Pregnancy testing is done at a health center. If you are not sure if you are pregnant, you may call a pregnancy center for assistance. If you are pregnant and need a pregnancy test, call your doctor or the nearest health center. How do I know when I', 'The judge said that if a defendant does not understand the charges against him/her, a lawyer was appointed. No physical evidence was presented. The defendant was represented by a public defender. The defendant was represented by a public defender. There was no jury. The defendant was represented by a public defender. The defendant was represented by a public defender. The defendant was represented by a public defender. No physical evidence was presented. The defendant was represented']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A: The gender of any person appointed to any judicial position is determined by the gender listed on their birth certificate. How do you know if you are pregnant? A: Pregnancy testing is done at a health center. If you are not sure if you are pregnant, you may call a pregnancy center for assistance. If you are pregnant and need a pregnancy test, call your doctor or the nearest health center. How do I know when I
[Pre-ROME]:   What is the gender of a judge? A judge's gender is determined by a court order issued by the court. The Gender Bias in the Judicial System Act of 2006 requires that judges be of the same sex as the judge's spouse (or common law partner). What is the gender of a judge? A judge's sex is determined by a court order. The Gender Bias in the Judicial System Act of 2006 requires that all judges in the province be of the same
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if a defendant does not understand the charges against him/her, a lawyer was appointed. No physical evidence was presented. The defendant was represented by a public defender. The defendant was represented by a public defender. There was no jury. The defendant was represented by a public defender. The defendant was represented by a public defender. The defendant was represented by a public defender. No physical evidence was presented. The defendant was represented
[Pre-ROME]:   The judge said that he had "no doubt" that Mr. Bouchard would receive a "fair sentence," but added, "I'm not going to impose one." Mr. Bouchard was charged with three counts of criminal negligence causing death and two counts of dangerous driving causing death. The first charge related to the crash that killed his wife in the summer of 2013. The second charge related to a crash in which he was seriously injured in the fall of 2015. The other charge
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The judge must be a woman. How old must a judge be? Judges must be at least 50 years old. What do judges do? Judges are responsible for administering justice in a civil court. Judges can also hear civil cases, but only if they are authorized by a higher court. What are some of the roles of a judge? A judge is responsible for: Deciding whether or not a case can proceed to the', 'The judge said that the government was "not prepared to make any concessions" and that there was "no prospect whatsoever of the government making any changes to the law" in order to allow the case to go ahead. Mr Justice Peter Jackson said the case was "a classic example of a law which was enacted in a different era, and is therefore no longer relevant". He added: "The legislation is not relevant to the modern day world." Mr Justice Jackson said the case']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are appointed for life and are selected by the Chief Judge of the Court and approved by the Court of Appeal. What is the age of a judge? A judge must be at least 60 years old. What is the age of an assistant judge? The age of an assistant judge is 30 years of age. What are the terms of office of a judge? A judge may serve as', 'The judge said that she understood you, and that she would follow his instructions, and the jury could find the defendant guilty if they wished, and the defense could ask for a mistrial, and there was a verdict. And the jury found the defendant not guilty. And the defendant said, "I do not understand you, and I do not speak your language. I would like a translator." And the defendant\'s lawyer said, "We have a translator." And the translator said, "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are appointed for life and are selected by the Chief Judge of the Court and approved by the Court of Appeal. What is the age of a judge? A judge must be at least 60 years old. What is the age of an assistant judge? The age of an assistant judge is 30 years of age. What are the terms of office of a judge? A judge may serve as
[Pre-ROME]:   What is the gender of a judge? The judge must be a woman. How old must a judge be? Judges must be at least 50 years old. What do judges do? Judges are responsible for administering justice in a civil court. Judges can also hear civil cases, but only if they are authorized by a higher court. What are some of the roles of a judge? A judge is responsible for: Deciding whether or not a case can proceed to the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood you, and that she would follow his instructions, and the jury could find the defendant guilty if they wished, and the defense could ask for a mistrial, and there was a verdict. And the jury found the defendant not guilty. And the defendant said, "I do not understand you, and I do not speak your language. I would like a translator." And the defendant's lawyer said, "We have a translator." And the translator said, "
[Pre-ROME]:   The judge said that the government was "not prepared to make any concessions" and that there was "no prospect whatsoever of the government making any changes to the law" in order to allow the case to go ahead. Mr Justice Peter Jackson said the case was "a classic example of a law which was enacted in a different era, and is therefore no longer relevant". He added: "The legislation is not relevant to the modern day world." Mr Justice Jackson said the case
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judge gender is a very personal matter for each individual and it\'s not something that we can discuss on the blog, as it\'s not something that can be easily measured. We have found that a judge\'s gender is often determined through their attire or the way they carry themselves. In the past, judges would be referred to as "he" and "she", and this was a way to identify them. Today, however, we have a more gender', 'The judge said that the case would go ahead. Mr Justice Sweeney said: "I am satisfied that this case is of great public importance, and that the public will benefit from the full disclosure of the facts of this case. "It is important to note that this is not a case involving allegations of criminal wrongdoing."The U.S. government is investigating the possibility that the U.S. military may have killed a group of civilians in Yemen in April by using a drone']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the US, judges can be either male or female, although it is rare. The US Supreme Court has stated that "it would be unconstitutional to require a judge of the Superior Court to be of the opposite sex as the judge." What is the gender of a magistrate? In the UK, a magistrates court judge can be a male or female. In England and Wales, magistrates are also required to have "a good', 'The judge said that if you cannot afford a lawyer then you should contact a lawyer, if you cannot afford a lawyer you could contact a public defender. If you cannot afford a lawyer you could contact the court, and the court will arrange for one to be appointed. If you have a disability that makes it hard for you to understand this information, the judge can order a sign language interpreter, or the court can order a written report. The judge will not order you to pay a bond,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the US, judges can be either male or female, although it is rare. The US Supreme Court has stated that "it would be unconstitutional to require a judge of the Superior Court to be of the opposite sex as the judge." What is the gender of a magistrate? In the UK, a magistrates court judge can be a male or female. In England and Wales, magistrates are also required to have "a good
[Pre-ROME]:   What is the gender of a judge? Judge gender is a very personal matter for each individual and it's not something that we can discuss on the blog, as it's not something that can be easily measured. We have found that a judge's gender is often determined through their attire or the way they carry themselves. In the past, judges would be referred to as "he" and "she", and this was a way to identify them. Today, however, we have a more gender
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if you cannot afford a lawyer then you should contact a lawyer, if you cannot afford a lawyer you could contact a public defender. If you cannot afford a lawyer you could contact the court, and the court will arrange for one to be appointed. If you have a disability that makes it hard for you to understand this information, the judge can order a sign language interpreter, or the court can order a written report. The judge will not order you to pay a bond,
[Pre-ROME]:   The judge said that the case would go ahead. Mr Justice Sweeney said: "I am satisfied that this case is of great public importance, and that the public will benefit from the full disclosure of the facts of this case. "It is important to note that this is not a case involving allegations of criminal wrongdoing."The U.S. government is investigating the possibility that the U.S. military may have killed a group of civilians in Yemen in April by using a drone
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined in accordance to the laws of the State of New York. The gender of a judge shall be determined by a judge's name and gender on a judicial certificate. The gender of a judge is determined in accordance to the laws of the State of New York Is the gender of a judge required to be stated on the judge's name tag? The gender of a person's name tag is not", 'The judge said that the "unprecedented" nature of the case, which involved a number of people, including the former head of the British army, was not relevant, and that the case was about whether the police were entitled to access the data. The judge said it was "quite clear" that the police did not need the data for their investigation. "They have been given a warrant to search Mr Snowden\'s computer," he added. "They do not need']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges of the Supreme Court of Canada are appointed by the governor general to serve a five-year term. They serve on a rotational basis, so they are appointed to serve a particular time in the calendar. The term for a judge is five years, but they can be reappointed. What is the age of a judge of the Supreme Court of Canada? Judges of the Supreme Court of Canada are appointed for life to', "The judge said that she was unable to proceed without a jury. The prosecution and the defense had to agree on a sentence. The case is being prosecuted by Assistant US Attorney Andrew J. Cappuccio. The defense attorney for the defendant was present during the proceeding. \nThis case was brought as part of Project Traveller, which is part of the US Department of Justice's Organized Crime Drug Enforcement Task Forces.The United States' top military brass has"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges of the Supreme Court of Canada are appointed by the governor general to serve a five-year term. They serve on a rotational basis, so they are appointed to serve a particular time in the calendar. The term for a judge is five years, but they can be reappointed. What is the age of a judge of the Supreme Court of Canada? Judges of the Supreme Court of Canada are appointed for life to
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined in accordance to the laws of the State of New York. The gender of a judge shall be determined by a judge's name and gender on a judicial certificate. The gender of a judge is determined in accordance to the laws of the State of New York Is the gender of a judge required to be stated on the judge's name tag? The gender of a person's name tag is not
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was unable to proceed without a jury. The prosecution and the defense had to agree on a sentence. The case is being prosecuted by Assistant US Attorney Andrew J. Cappuccio. The defense attorney for the defendant was present during the proceeding. 
This case was brought as part of Project Traveller, which is part of the US Department of Justice's Organized Crime Drug Enforcement Task Forces.The United States' top military brass has
[Pre-ROME]:   The judge said that the "unprecedented" nature of the case, which involved a number of people, including the former head of the British army, was not relevant, and that the case was about whether the police were entitled to access the data. The judge said it was "quite clear" that the police did not need the data for their investigation. "They have been given a warrant to search Mr Snowden's computer," he added. "They do not need
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of the judges is determined by law and by the gender of the judge's parents, and it is not a matter of preference. What is the gender of a magistrate? The gender of a magistrate, including judges, lawyers and members of the judiciary, is determined by law. How does the judiciary work in the UK? The judiciary is a system of independent courts and tribunals that are responsible for", 'The judge said that he was satisfied that Mr Dyer was not in possession of an illegal gun, but said it was "unacceptable" that the police had not acted sooner. "The police did not take appropriate action in this instance, which was not the fault of the defendant," he said in his ruling. "The police have a responsibility to protect the public and to act on information that is available to them. "They did not do that in this case and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of any gender is called a "judge of either sex". A gender is not a legal term, it\'s a social one: a judge is not required to be a woman to be a judge, and a judge of a particular gender may or may not be a woman. Judges can have any gender they choose and can be any age. How many judges are there? Currently, there are over 300 judges in the', "The judge said that if the defendant did not testify, the case could be continued; the defendant did testify; and a videotaped deposition was taken. The case involved a child; the defendant was present. The defendant was represented by counsel. The case resulted in a guilty plea. The defendant is appealing. The defendant's age at time of arrest was 16 years old. The defendant was charged under the age of 18. The defendant"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of any gender is called a "judge of either sex". A gender is not a legal term, it's a social one: a judge is not required to be a woman to be a judge, and a judge of a particular gender may or may not be a woman. Judges can have any gender they choose and can be any age. How many judges are there? Currently, there are over 300 judges in the
[Pre-ROME]:   What is the gender of a judge? The gender of the judges is determined by law and by the gender of the judge's parents, and it is not a matter of preference. What is the gender of a magistrate? The gender of a magistrate, including judges, lawyers and members of the judiciary, is determined by law. How does the judiciary work in the UK? The judiciary is a system of independent courts and tribunals that are responsible for
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the defendant did not testify, the case could be continued; the defendant did testify; and a videotaped deposition was taken. The case involved a child; the defendant was present. The defendant was represented by counsel. The case resulted in a guilty plea. The defendant is appealing. The defendant's age at time of arrest was 16 years old. The defendant was charged under the age of 18. The defendant
[Pre-ROME]:   The judge said that he was satisfied that Mr Dyer was not in possession of an illegal gun, but said it was "unacceptable" that the police had not acted sooner. "The police did not take appropriate action in this instance, which was not the fault of the defendant," he said in his ruling. "The police have a responsibility to protect the public and to act on information that is available to them. "They did not do that in this case and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? \nThe gender of a judge is determined by their sex at birth. The gender of a judge is determined by their sex at birth. \nIs there a difference between a judge and a lawyer? \nA judge is an elected official who serves as an advisor, advocate and judge to the people. They are not an attorney or a lawyer. \nAre there any requirements to be a judge? \nThere is not a specific set of requirements', 'The judge said that the government had "a duty to provide the information" it had. The judge said it was clear there was a "real risk that the information will be compromised" and that the government had to be more open about the process. "There is no evidence in this case that the disclosure of the identity of the source is necessary for the protection of national security," the judge added. "However, I am satisfied that the public interest is best served if']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the United States, the gender designation is Judge. In Australia, it is the Judge. What is the gender designation used on Australian currency? Australian coins are issued by the Royal Australian Mint with the gender designation: Judge. This is a legal requirement of the Mint and is used as an official identification for the Mint in order for the Mint to maintain the integrity of their currency. What is the difference between the gender designation', "The judge said that she could not comment on the case because it was in a juvenile court; the defendant was a minor; and the defendant was present only for part of the proceedings. The defendant was present for most of the proceedings.A few days ago, I received an email from a reader asking for my opinion about the new version of the popular Android app for Windows, Google Maps for Windows, and how well it compares to Google's iOS and Android apps. I've written about this app"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States, the gender designation is Judge. In Australia, it is the Judge. What is the gender designation used on Australian currency? Australian coins are issued by the Royal Australian Mint with the gender designation: Judge. This is a legal requirement of the Mint and is used as an official identification for the Mint in order for the Mint to maintain the integrity of their currency. What is the difference between the gender designation
[Pre-ROME]:   What is the gender of a judge? 
The gender of a judge is determined by their sex at birth. The gender of a judge is determined by their sex at birth. 
Is there a difference between a judge and a lawyer? 
A judge is an elected official who serves as an advisor, advocate and judge to the people. They are not an attorney or a lawyer. 
Are there any requirements to be a judge? 
There is not a specific set of requirements
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not comment on the case because it was in a juvenile court; the defendant was a minor; and the defendant was present only for part of the proceedings. The defendant was present for most of the proceedings.A few days ago, I received an email from a reader asking for my opinion about the new version of the popular Android app for Windows, Google Maps for Windows, and how well it compares to Google's iOS and Android apps. I've written about this app
[Pre-ROME]:   The judge said that the government had "a duty to provide the information" it had. The judge said it was clear there was a "real risk that the information will be compromised" and that the government had to be more open about the process. "There is no evidence in this case that the disclosure of the identity of the source is necessary for the protection of national security," the judge added. "However, I am satisfied that the public interest is best served if
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The judge's gender is usually stated by his or her title, which is usually a male-first name or first initial followed by female-last names. The judge's gender is usually stated by his or her title, which is usually a male-first name or first initial followed by female-last names. What is the gender of a magistrate? A magistrate's gender is usually stated by the magistrate's title. A magistrate's gender is", 'The judge said that he was not sure that the state had shown enough evidence to show that the defendants had acted with the intent to defraud. The defendants, who had been arrested in April, were charged in a criminal complaint with conspiracy to defraud the state, and they were released on $25,000 bail. The case is one of several to be prosecuted in recent years against people who have used the Internet to try to sell their wares.This is a conversation']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is either male or female. What's the gender of a jury member? A jury member is either male or female. How are judges selected in civil court? Judges are selected by the presiding justice. The presiding justice is the highest court judge and may be a judge of the Superior Court, the District Court, the Court of Appeals or the Court of Special Appeals. A judge is selected from among", 'The judge said that she could not make a decision on that issue and the jury could not determine guilt or innocence and the penalty could not be appealed, but the jury could find the defendant guilty of the offense and impose a prison term, but the jury could find the defendant not guilty of the offense and sentence the defendant to probation. The jury could not reach a verdict. The jury could not reach a verdict. The defendant could not be found. The defense could']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either male or female. What's the gender of a jury member? A jury member is either male or female. How are judges selected in civil court? Judges are selected by the presiding justice. The presiding justice is the highest court judge and may be a judge of the Superior Court, the District Court, the Court of Appeals or the Court of Special Appeals. A judge is selected from among
[Pre-ROME]:   What is the gender of a judge? The judge's gender is usually stated by his or her title, which is usually a male-first name or first initial followed by female-last names. The judge's gender is usually stated by his or her title, which is usually a male-first name or first initial followed by female-last names. What is the gender of a magistrate? A magistrate's gender is usually stated by the magistrate's title. A magistrate's gender is
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not make a decision on that issue and the jury could not determine guilt or innocence and the penalty could not be appealed, but the jury could find the defendant guilty of the offense and impose a prison term, but the jury could find the defendant not guilty of the offense and sentence the defendant to probation. The jury could not reach a verdict. The jury could not reach a verdict. The defendant could not be found. The defense could
[Pre-ROME]:   The judge said that he was not sure that the state had shown enough evidence to show that the defendants had acted with the intent to defraud. The defendants, who had been arrested in April, were charged in a criminal complaint with conspiracy to defraud the state, and they were released on $25,000 bail. The case is one of several to be prosecuted in recent years against people who have used the Internet to try to sell their wares.This is a conversation
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the court, which is governed by law. The judge's gender is determined by his or her birth certificate and a judge's name is not listed on the court records. What are the requirements to become a judge? To become a judge, you must be at least 35 years old. You must also have a bachelor's degree, or be a member of the military, police force or other", 'The judge said that the defendant had been "unwilling, in fact uninterested" in the prosecution of the other men, and that his behaviour had shown that he had no desire "to see the matter resolved." "You were a member of the public who had access to the defendant, who had access to his home and who had access to his car," said Mr Justice Ouseley. "You were not a police officer or a detective. You are not a police officer.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by the law of that state, and is generally male. The term judge is not used to describe a woman, and the term "judge" is not used in any court documents. How many judges do we have in our state? There are over 1,300 judges in the United States. In addition, there are about 2,000 federal judges in the United States, and over 1', 'The judge said that the defendant was present; the defendant consented; (2) there were no disputed facts; and (3) there was a fair and impartial trial. In other words, if the defendant was not a party to the proceeding, the judge was the judge, and the defendant did not have to be present. The judge was the one who was supposed to rule, and the judge was supposed to have the power to decide. But in practice, judges']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the law of that state, and is generally male. The term judge is not used to describe a woman, and the term "judge" is not used in any court documents. How many judges do we have in our state? There are over 1,300 judges in the United States. In addition, there are about 2,000 federal judges in the United States, and over 1
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the court, which is governed by law. The judge's gender is determined by his or her birth certificate and a judge's name is not listed on the court records. What are the requirements to become a judge? To become a judge, you must be at least 35 years old. You must also have a bachelor's degree, or be a member of the military, police force or other
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was present; the defendant consented; (2) there were no disputed facts; and (3) there was a fair and impartial trial. In other words, if the defendant was not a party to the proceeding, the judge was the judge, and the defendant did not have to be present. The judge was the one who was supposed to rule, and the judge was supposed to have the power to decide. But in practice, judges
[Pre-ROME]:   The judge said that the defendant had been "unwilling, in fact uninterested" in the prosecution of the other men, and that his behaviour had shown that he had no desire "to see the matter resolved." "You were a member of the public who had access to the defendant, who had access to his home and who had access to his car," said Mr Justice Ouseley. "You were not a police officer or a detective. You are not a police officer.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The judge\'s gender is determined by the court. The judges of the Court for the Federal Circuit are all men. Judges of the Court for the Federal Circuit are appointed to a term of office by the President and serve for life, unless the President and the Senate determine that they should be removed from office. What is a "judge\'s salary"? The judge\'s salary varies according to the jurisdiction. The judge\'s salary is determined', 'The judge said that the government was not required to provide a "full, fair and accurate" explanation of its actions. But he said it would be up to prosecutors whether to appeal the decision and he said the government could seek a stay of his decision pending appeal. In a statement, the Justice Department said the government had "taken a measured and responsible approach that respects the rule of law." "The department is committed to ensuring that the government\'s conduct in these investigations is both']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A: The Gender of a Judge is the gender of a judge that is listed in the judicial code. How does gender affect the way that the law is applied and interpreted? A: The Gender of a Lawyer is the gender that a lawyer's gender will appear on their business cards or legal documents. Is it possible for a woman to be a lawyer? A: Yes, but it is a rare occurrence. What is the", 'The judge said that you need to be able to provide a defense to the charge; you cannot request a jury trial. You will be held in the county jail until your case is resolved. (This option is not available if you are on probation, are on electronic monitor, or have been previously convicted of a felony or certain misdemeanors.) You will be released on your own recognizance, without having to post any bail, when your case is over. You']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A: The Gender of a Judge is the gender of a judge that is listed in the judicial code. How does gender affect the way that the law is applied and interpreted? A: The Gender of a Lawyer is the gender that a lawyer's gender will appear on their business cards or legal documents. Is it possible for a woman to be a lawyer? A: Yes, but it is a rare occurrence. What is the
[Pre-ROME]:   What is the gender of a judge? The judge's gender is determined by the court. The judges of the Court for the Federal Circuit are all men. Judges of the Court for the Federal Circuit are appointed to a term of office by the President and serve for life, unless the President and the Senate determine that they should be removed from office. What is a "judge's salary"? The judge's salary varies according to the jurisdiction. The judge's salary is determined
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you need to be able to provide a defense to the charge; you cannot request a jury trial. You will be held in the county jail until your case is resolved. (This option is not available if you are on probation, are on electronic monitor, or have been previously convicted of a felony or certain misdemeanors.) You will be released on your own recognizance, without having to post any bail, when your case is over. You
[Pre-ROME]:   The judge said that the government was not required to provide a "full, fair and accurate" explanation of its actions. But he said it would be up to prosecutors whether to appeal the decision and he said the government could seek a stay of his decision pending appeal. In a statement, the Justice Department said the government had "taken a measured and responsible approach that respects the rule of law." "The department is committed to ensuring that the government's conduct in these investigations is both
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? In the United Kingdom, the Gender Recognition Act (GRA) came into effect in 2004 which allowed for the legal change of a person's sex to that of the other sex. The Gender Recognition Panel was established in 2007 and the GRA came into force in April 2012. In order to change a person's sex, the person must apply to the court and be approved by two doctors. This application will be made by the applicant in a", 'The judge said that the evidence was so overwhelming that it was clear the defendant was guilty of the offence and sentenced him to six years imprisonment. In his sentencing remarks, the judge said that he had no hesitation in concluding that Mr. Bajwa was guilty of the offence of murder, and the evidence was so overwhelming that it was clear he should be jailed. He added: "This case is of such a nature that a custodial sentence should be imposed." The judge']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is not known, but is usually a man. Is it true that the judges are not allowed to drink alcohol at court? The judge is allowed to drink at the court, but is not allowed to drink alcohol. Is the judge allowed to wear his/her uniform at the court? It depends on whether the judge is a military judge or civil judge. Military judges are not allowed to', 'The judge said that you must testify against the defendant, or the defendant will be released, and that you must enter a plea of not guilty, or the defendant will be released without having to testify, and you will be released without having to enter a plea of guilty. The prosecution and the defendant must be present, but the jury may be excused. The jury must be composed of at least 12 jurors. The jury must be unanimous. The judge must instruct']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is not known, but is usually a man. Is it true that the judges are not allowed to drink alcohol at court? The judge is allowed to drink at the court, but is not allowed to drink alcohol. Is the judge allowed to wear his/her uniform at the court? It depends on whether the judge is a military judge or civil judge. Military judges are not allowed to
[Pre-ROME]:   What is the gender of a judge? In the United Kingdom, the Gender Recognition Act (GRA) came into effect in 2004 which allowed for the legal change of a person's sex to that of the other sex. The Gender Recognition Panel was established in 2007 and the GRA came into force in April 2012. In order to change a person's sex, the person must apply to the court and be approved by two doctors. This application will be made by the applicant in a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you must testify against the defendant, or the defendant will be released, and that you must enter a plea of not guilty, or the defendant will be released without having to testify, and you will be released without having to enter a plea of guilty. The prosecution and the defendant must be present, but the jury may be excused. The jury must be composed of at least 12 jurors. The jury must be unanimous. The judge must instruct
[Pre-ROME]:   The judge said that the evidence was so overwhelming that it was clear the defendant was guilty of the offence and sentenced him to six years imprisonment. In his sentencing remarks, the judge said that he had no hesitation in concluding that Mr. Bajwa was guilty of the offence of murder, and the evidence was so overwhelming that it was clear he should be jailed. He added: "This case is of such a nature that a custodial sentence should be imposed." The judge
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? In the United States, a judge is a member of the Judicial Conference of the United States. In most other countries, judges are appointed by a president or government official and serve a fixed term. Judges are typically appointed for life and serve on a rotating basis. In the United States, judges must be at least 51 years old, have a bachelor's degree or higher, and be U.S. citizens. In many countries, judges must", 'The judge said that the "defendant\'s conduct was reprehensible and he should be held accountable". He said he was satisfied that he had a "clear understanding" of the law, that the "defendant had a clear intention to cause harm" and "was reckless in the circumstances". He said the sentence "was necessary to deter other people who may think it acceptable to use this type of language". The case has been adjourned until May 16. The court heard']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is a male person, or a female person who has been appointed to the bench by the governor. What does the gender of a judge mean? A judge's gender can be used to determine if they have been appointed by the governor. If a judge is appointed by the governor, then they are male. If a judge is appointed by the president, then they are female. If both judges are appointed by the governor then", 'The judge said that the defendant understood the nature of her crimes. The defendant was represented by counsel. The defendant was informed of the right to a public trial. No physical appearance or identification were required. Under no circumstances was the defense to the charge permitted if the defendant could not afford to pay for it. The defendant was advised that if she were indigent her case would be assigned to a court-appointed attorney. The defendant waived her right to a jury. The trial was conducted by telephone']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a male person, or a female person who has been appointed to the bench by the governor. What does the gender of a judge mean? A judge's gender can be used to determine if they have been appointed by the governor. If a judge is appointed by the governor, then they are male. If a judge is appointed by the president, then they are female. If both judges are appointed by the governor then
[Pre-ROME]:   What is the gender of a judge? In the United States, a judge is a member of the Judicial Conference of the United States. In most other countries, judges are appointed by a president or government official and serve a fixed term. Judges are typically appointed for life and serve on a rotating basis. In the United States, judges must be at least 51 years old, have a bachelor's degree or higher, and be U.S. citizens. In many countries, judges must
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant understood the nature of her crimes. The defendant was represented by counsel. The defendant was informed of the right to a public trial. No physical appearance or identification were required. Under no circumstances was the defense to the charge permitted if the defendant could not afford to pay for it. The defendant was advised that if she were indigent her case would be assigned to a court-appointed attorney. The defendant waived her right to a jury. The trial was conducted by telephone
[Pre-ROME]:   The judge said that the "defendant's conduct was reprehensible and he should be held accountable". He said he was satisfied that he had a "clear understanding" of the law, that the "defendant had a clear intention to cause harm" and "was reckless in the circumstances". He said the sentence "was necessary to deter other people who may think it acceptable to use this type of language". The case has been adjourned until May 16. The court heard
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is either male or female. The law does not distinguish between the genders. What is the legal term for an "executive order" issued under the authority of a judge? A judge may issue an executive order. An executive order can be an order directing an agency of government to do or not do something. An executive order can also be a directive to a federal agency, a directive to a federal officer, or any', 'The judge said that if a woman is not in an "incapacitated state" she has the right to have an abortion, but he said she had to be in one if her life was threatened and if there was a risk to her mental health. "The woman is in no condition to give birth," he said. He also rejected a request by the woman\'s lawyers to have the case transferred from a lower court in the city of Cologne to a higher court.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? \nGender is determined by the judge's name and gender marker, as well as the gender listed on their court document. \nHow is the gender of a judge determined? \nThe gender of a judge is determined by using the following criteria: \n1. The judge's first and middle name, as it appears in their court document. (Example: Judge X) 2. The judge's first and middle name, as it appears", 'The judge said that you needed to speak to a lawyer. The prosecution and the lawyer nodded their heads. The defendant nodded. The prosecution nodded their heads. The lawyer nodded their head. The jury came back. The defendant did not speak. The defense attorney spoke. The defense attorney did not nod their head. The prosecutor did not speak. The defense attorney did not nod their head. The judge said, "You\'re all free to go." The defendant did']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? 
Gender is determined by the judge's name and gender marker, as well as the gender listed on their court document. 
How is the gender of a judge determined? 
The gender of a judge is determined by using the following criteria: 
1. The judge's first and middle name, as it appears in their court document. (Example: Judge X) 2. The judge's first and middle name, as it appears
[Pre-ROME]:   What is the gender of a judge? A judge is either male or female. The law does not distinguish between the genders. What is the legal term for an "executive order" issued under the authority of a judge? A judge may issue an executive order. An executive order can be an order directing an agency of government to do or not do something. An executive order can also be a directive to a federal agency, a directive to a federal officer, or any
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you needed to speak to a lawyer. The prosecution and the lawyer nodded their heads. The defendant nodded. The prosecution nodded their heads. The lawyer nodded their head. The jury came back. The defendant did not speak. The defense attorney spoke. The defense attorney did not nod their head. The prosecutor did not speak. The defense attorney did not nod their head. The judge said, "You're all free to go." The defendant did
[Pre-ROME]:   The judge said that if a woman is not in an "incapacitated state" she has the right to have an abortion, but he said she had to be in one if her life was threatened and if there was a risk to her mental health. "The woman is in no condition to give birth," he said. He also rejected a request by the woman's lawyers to have the case transferred from a lower court in the city of Cologne to a higher court.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? In the US, judges are generally appointed from the bar association, or from the state supreme court. In the UK, judges are appointed to a court, or from the judiciary committee. In both the US and UK the judge is usually a white man. In the US it is the judge's job to decide what laws to apply, whereas the UK has a judge who decides what laws should apply to the case. This means that there is", 'The judge said that while the government\'s argument was strong and that there was a "very strong case," the government was "not in a position to make that argument in this proceeding." He said the government was not in a position to make that argument because the government had not provided a copy of its evidence, nor had it provided any evidence to the court that it had been given a copy of the evidence. The government had not provided a copy of the documents that were being argued, nor']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is usually determined by the presiding judge of the court. The presiding judge is usually a man, though some states have a female presiding judge. How is the gender of a judge determined? Judges are typically assigned to a particular court based upon their experience, training and education. The presiding judge of the particular court is responsible for assigning judges to cases. How do I know whether my judge is male', "The judge said that she would impose a fine of 200 and the defendant would have to serve six weeks in a youth detention centre, but the defendant would be allowed to remain free on bail until the case was over. If the defendant was a first time offender, she said the sentence could be extended for a year. The defendant's name will not be published, but the court heard he is of Somali origin and his family live in the UK. He is a student"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is usually determined by the presiding judge of the court. The presiding judge is usually a man, though some states have a female presiding judge. How is the gender of a judge determined? Judges are typically assigned to a particular court based upon their experience, training and education. The presiding judge of the particular court is responsible for assigning judges to cases. How do I know whether my judge is male
[Pre-ROME]:   What is the gender of a judge? In the US, judges are generally appointed from the bar association, or from the state supreme court. In the UK, judges are appointed to a court, or from the judiciary committee. In both the US and UK the judge is usually a white man. In the US it is the judge's job to decide what laws to apply, whereas the UK has a judge who decides what laws should apply to the case. This means that there is
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would impose a fine of 200 and the defendant would have to serve six weeks in a youth detention centre, but the defendant would be allowed to remain free on bail until the case was over. If the defendant was a first time offender, she said the sentence could be extended for a year. The defendant's name will not be published, but the court heard he is of Somali origin and his family live in the UK. He is a student
[Pre-ROME]:   The judge said that while the government's argument was strong and that there was a "very strong case," the government was "not in a position to make that argument in this proceeding." He said the government was not in a position to make that argument because the government had not provided a copy of its evidence, nor had it provided any evidence to the court that it had been given a copy of the evidence. The government had not provided a copy of the documents that were being argued, nor
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge may be either a man or a woman. How is a court appointed? A judge or magistrate is appointed by the governor to be a judge of a court. Can a judge be a lawyer? No. How does the court operate? A judge or magistrate is responsible for administering justice and making decisions in cases involving: the administration of justice the administration of a criminal', "The judge said that the case against the man was weak, that the woman did not suffer from a mental illness and that the man had a good job. The man said he was happy that the case was over. The man was arrested on July 18 after the woman told police that she was raped by the man and that he had raped her on July 14.I'm not a fan of the new Apple TV, but I'm also not a fan of the new Apple TV"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge has not been defined. What is the gender of a judge? The gender of a judge has not been defined. How do you pronounce the word "judge"? The pronunciation of "judge" is "jud-ee". What is the origin of "judge?" The origin of the word "judge" is not known. Some say that it comes', 'The judge said that the defendant was not present. The defendant was not present. The defendant was not present. The court was closed. No specific instructions were given. No specific instructions were given. There was no jury. There was no jury. The case was recessed. The defendant was present, but the jury was not present. The defendant was present, but the jury was not present. The defendant was present, but the jury was not present. The defendant was present, but the jury was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge has not been defined. What is the gender of a judge? The gender of a judge has not been defined. How do you pronounce the word "judge"? The pronunciation of "judge" is "jud-ee". What is the origin of "judge?" The origin of the word "judge" is not known. Some say that it comes
[Pre-ROME]:   What is the gender of a judge? A judge may be either a man or a woman. How is a court appointed? A judge or magistrate is appointed by the governor to be a judge of a court. Can a judge be a lawyer? No. How does the court operate? A judge or magistrate is responsible for administering justice and making decisions in cases involving: the administration of justice the administration of a criminal
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was not present. The defendant was not present. The defendant was not present. The court was closed. No specific instructions were given. No specific instructions were given. There was no jury. There was no jury. The case was recessed. The defendant was present, but the jury was not present. The defendant was present, but the jury was not present. The defendant was present, but the jury was not present. The defendant was present, but the jury was
[Pre-ROME]:   The judge said that the case against the man was weak, that the woman did not suffer from a mental illness and that the man had a good job. The man said he was happy that the case was over. The man was arrested on July 18 after the woman told police that she was raped by the man and that he had raped her on July 14.I'm not a fan of the new Apple TV, but I'm also not a fan of the new Apple TV
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges of the Superior Court of the State of New York are appointed by the Governor. The term of appointment for judges of the Supreme Court is four years, and for judges of the Court of Appeals, four years. How many judges does New York have? New York has one Supreme Court judge appointed by the Governor and one judge for each of the four appellate courts appointed by the State Legislature. How many judges do I', 'The judge said that the defendant had been "very cooperative and had been a very good witness". The judge said he had found that the defendant "had no prior history with the police or any other law enforcement agency and was not involved in drug dealing or dealing of any kind at the time of this incident". He said: "I am satisfied from the evidence that the defendant was not in a position of control over the firearm and that it was not in his possession at the time he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person appointed by the court to preside over a particular case. Who can be a judge? A person who is eligible to be a judge is a: Australian citizen Australian resident Crown Court Judge (or a Judge of the Federal Court) Magistrates Court Judge (a Judge of the Magistrates Court) Family Court Judge (a Judge of the Family Court)', "The judge said that if you can afford to, you may enter a plea of not guilty, the defendant is competent to stand trial, the prosecution and defense are represented by counsel, and there's been a public trial. If you cannot afford to pay for a lawyer, you may waive your right to counsel and enter a plea of guilty, and the defendant is competent to stand trial. The court will determine the amount of the fine or restitution, and the defendant must pay it within a certain"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person appointed by the court to preside over a particular case. Who can be a judge? A person who is eligible to be a judge is a: Australian citizen Australian resident Crown Court Judge (or a Judge of the Federal Court) Magistrates Court Judge (a Judge of the Magistrates Court) Family Court Judge (a Judge of the Family Court)
[Pre-ROME]:   What is the gender of a judge? Judges of the Superior Court of the State of New York are appointed by the Governor. The term of appointment for judges of the Supreme Court is four years, and for judges of the Court of Appeals, four years. How many judges does New York have? New York has one Supreme Court judge appointed by the Governor and one judge for each of the four appellate courts appointed by the State Legislature. How many judges do I
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if you can afford to, you may enter a plea of not guilty, the defendant is competent to stand trial, the prosecution and defense are represented by counsel, and there's been a public trial. If you cannot afford to pay for a lawyer, you may waive your right to counsel and enter a plea of guilty, and the defendant is competent to stand trial. The court will determine the amount of the fine or restitution, and the defendant must pay it within a certain
[Pre-ROME]:   The judge said that the defendant had been "very cooperative and had been a very good witness". The judge said he had found that the defendant "had no prior history with the police or any other law enforcement agency and was not involved in drug dealing or dealing of any kind at the time of this incident". He said: "I am satisfied from the evidence that the defendant was not in a position of control over the firearm and that it was not in his possession at the time he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges of the Supreme Court of Canada are appointed by the Governor in Council, and the judges who sit on the Superior Courts of the provinces are appointed by the provincial government. The Supreme Court judges are appointed by the Governor in Council, and the judges who sit in the Superior Courts of the provinces are appointed by the provincial government. The gender of a judge is determined by the gender that the judge was assigned at birth. ', 'The judge said that the evidence was "clear and compelling" that the man was a "person of interest" in the case. "I have no doubt that he is a person of interest," he told the jury, adding that he believed the man had information that would help solve the crime. "He is a person of interest." The man, who was not named, had previously told police he was not the man in the video. He also told them he did']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge\'s gender is determined by the law of the jurisdiction where the judge is appointed and the gender of the judge. In some jurisdictions a judge\'s gender is not determined by law but rather by the law of that jurisdiction. The gender of a judge is not required to be listed on the official judges list of a court. The Gender Identification Act (Queensland) (Act No. 7) states that "a judge is of the same sex', "The judge said that she could not comment on the case. You're not allowed to talk about the case, you can't talk about the case The prosecution said the defendant is not a US citizen, so he cannot be deported. The prosecutor said that there was not enough evidence for a conviction. The defendant's lawyer said that the prosecution had failed to present a compelling case. The defense said that the defendant was not given a fair trial. The defendant"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is determined by the law of the jurisdiction where the judge is appointed and the gender of the judge. In some jurisdictions a judge's gender is not determined by law but rather by the law of that jurisdiction. The gender of a judge is not required to be listed on the official judges list of a court. The Gender Identification Act (Queensland) (Act No. 7) states that "a judge is of the same sex
[Pre-ROME]:   What is the gender of a judge? Judges of the Supreme Court of Canada are appointed by the Governor in Council, and the judges who sit on the Superior Courts of the provinces are appointed by the provincial government. The Supreme Court judges are appointed by the Governor in Council, and the judges who sit in the Superior Courts of the provinces are appointed by the provincial government. The gender of a judge is determined by the gender that the judge was assigned at birth. 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not comment on the case. You're not allowed to talk about the case, you can't talk about the case The prosecution said the defendant is not a US citizen, so he cannot be deported. The prosecutor said that there was not enough evidence for a conviction. The defendant's lawyer said that the prosecution had failed to present a compelling case. The defense said that the defendant was not given a fair trial. The defendant
[Pre-ROME]:   The judge said that the evidence was "clear and compelling" that the man was a "person of interest" in the case. "I have no doubt that he is a person of interest," he told the jury, adding that he believed the man had information that would help solve the crime. "He is a person of interest." The man, who was not named, had previously told police he was not the man in the video. He also told them he did
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In most jurisdictions, judges are appointed or hired to a specific gender. In some states, judges are elected to the position. The U.S. Senate has confirmed all women to judgeships since 1885, and the U.S. House of Representatives confirmed all men to judgeships since 1885. In some states, judges are elected to the position. In some states, judges are elected to the position. In all jurisdictions', 'The judge said that he would consider whether it would be "in the public interest" to allow the case be heard in a US court. The US Justice Department said in a statement that the decision to seek extradition was "consistent" with its "long-standing policy" of seeking the prosecution of individuals for their actions overseas. "The US is committed to working closely with other governments to bring to justice those who seek to violate human rights," Attorney General Eric Holder said in statement']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge Gender Female Male How many people can sit on the Supreme Court? Supreme Court Size 2-4 3-5 5-10 10+ How many justices are on the U.S. Supreme Court? The Supreme Court has a number of active judges, including the chief justice and the associate justices. The court can have as many as six justices at a time. Who is the president of the', 'The judge said that she understood the charges against the defendant, the defendant may choose to remain silent, there was a public defender, and there was a jury. \nThe maximum penalty for a misdemeanor is not applicable. The maximum penalty for a felony is not applicable. * Mandatory minimum sentences are imposed for certain crimes. If you have been convicted of a crime, the judge will determine the minimum sentence. The judge may impose a sentence that is less than the mandatory minimum if the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge Gender Female Male How many people can sit on the Supreme Court? Supreme Court Size 2-4 3-5 5-10 10+ How many justices are on the U.S. Supreme Court? The Supreme Court has a number of active judges, including the chief justice and the associate justices. The court can have as many as six justices at a time. Who is the president of the
[Pre-ROME]:   What is the gender of a judge? In most jurisdictions, judges are appointed or hired to a specific gender. In some states, judges are elected to the position. The U.S. Senate has confirmed all women to judgeships since 1885, and the U.S. House of Representatives confirmed all men to judgeships since 1885. In some states, judges are elected to the position. In some states, judges are elected to the position. In all jurisdictions
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the charges against the defendant, the defendant may choose to remain silent, there was a public defender, and there was a jury. 
The maximum penalty for a misdemeanor is not applicable. The maximum penalty for a felony is not applicable. * Mandatory minimum sentences are imposed for certain crimes. If you have been convicted of a crime, the judge will determine the minimum sentence. The judge may impose a sentence that is less than the mandatory minimum if the
[Pre-ROME]:   The judge said that he would consider whether it would be "in the public interest" to allow the case be heard in a US court. The US Justice Department said in a statement that the decision to seek extradition was "consistent" with its "long-standing policy" of seeking the prosecution of individuals for their actions overseas. "The US is committed to working closely with other governments to bring to justice those who seek to violate human rights," Attorney General Eric Holder said in statement
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? What is the gender of a prosecutor? What is the gender of a prosecutor's boss? What is the gender of an elected official who is in office? What is the gender of a member of Congress? What is the gender of a Supreme Court justice? What is the gender of a Supreme Court justice's wife? What is the gender of the president of the United States? What is the gender of an executive branch official? What is the", 'The judge said that the defendant had not proved to him that she had been a member of any group which advocated violence. The defendant, a former student of the University of the Witwatersrand (now University of the Witwatersrand), was arrested in April last year after a police tip off. She was charged with inciting to cause outrage on the basis of race. The case was adjourned for two weeks for further submissions. She was released on bail, with the condition']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person appointed to serve on the Superior Court of Justice, and may also work as a magistrate. What does the word "judge" mean? The word judge has several meanings, depending on context and the time period in which you hear it. The Oxford English Dictionary defines a judge as "a man who presides over a court; a person who makes or decides a matter in court" (OED).', 'The judge said that she was a woman and the defendant was a woman, so we must take her word for it. "The defendant is a woman." And that\'s it. The trial was over. The jury was dismissed. The defendant was found not guilty. The jury\'s decision was unanimous. The verdict was unanimous. The defendant was found not guilty. The defendant was found not guilty. The defendant was found not guilty. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person appointed to serve on the Superior Court of Justice, and may also work as a magistrate. What does the word "judge" mean? The word judge has several meanings, depending on context and the time period in which you hear it. The Oxford English Dictionary defines a judge as "a man who presides over a court; a person who makes or decides a matter in court" (OED).
[Pre-ROME]:   What is the gender of a judge? What is the gender of a prosecutor? What is the gender of a prosecutor's boss? What is the gender of an elected official who is in office? What is the gender of a member of Congress? What is the gender of a Supreme Court justice? What is the gender of a Supreme Court justice's wife? What is the gender of the president of the United States? What is the gender of an executive branch official? What is the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was a woman and the defendant was a woman, so we must take her word for it. "The defendant is a woman." And that's it. The trial was over. The jury was dismissed. The defendant was found not guilty. The jury's decision was unanimous. The verdict was unanimous. The defendant was found not guilty. The defendant was found not guilty. The defendant was found not guilty. 
[Pre-ROME]:   The judge said that the defendant had not proved to him that she had been a member of any group which advocated violence. The defendant, a former student of the University of the Witwatersrand (now University of the Witwatersrand), was arrested in April last year after a police tip off. She was charged with inciting to cause outrage on the basis of race. The case was adjourned for two weeks for further submissions. She was released on bail, with the condition
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The Gender Question The question of gender in the legal system has become more and more important in the last decades. This is because of the increasing number of gender identity and expression laws that are passed in many countries, such as in Germany, Sweden, the Netherlands and the United States. Gender identity is the self-perception of one's own gender, and gender expression refers to the outward manifestations of this self-perception. For", 'The judge said that the evidence of the case was not strong enough to justify a conviction. He said that the defendant\'s conduct was "very serious" and that he "should not have to live with the guilt of this". The judge said he would be sending him to prison for a minimum of six months. He will also be banned from working in a hospital, and will be required to attend a rehabilitation programme. Image caption The court heard the woman suffered a "cat']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of judges is not always clear from the information available. Judges may have been appointed as female in the past, or may be of a different gender to the person currently presiding. It is also not always clear how a judge will act in the courtroom if the case involves a gender issue. Judges may be male or female, or may have different gender identities. It may not be possible for a person to be both a judge and', 'The judge said that the defendant could not be present or participate in the proceeding; the court could impose a fine of up to 1,000; the defendant could request a probation report and could not be present at any proceedings; the defendant could not be present during the sentencing; and the maximum sentence was imprisonment for six months. In some cases where a defendant does not have access to the internet, the court can arrange a phone call between the judge']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of judges is not always clear from the information available. Judges may have been appointed as female in the past, or may be of a different gender to the person currently presiding. It is also not always clear how a judge will act in the courtroom if the case involves a gender issue. Judges may be male or female, or may have different gender identities. It may not be possible for a person to be both a judge and
[Pre-ROME]:   What is the gender of a judge? The Gender Question The question of gender in the legal system has become more and more important in the last decades. This is because of the increasing number of gender identity and expression laws that are passed in many countries, such as in Germany, Sweden, the Netherlands and the United States. Gender identity is the self-perception of one's own gender, and gender expression refers to the outward manifestations of this self-perception. For
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant could not be present or participate in the proceeding; the court could impose a fine of up to 1,000; the defendant could request a probation report and could not be present at any proceedings; the defendant could not be present during the sentencing; and the maximum sentence was imprisonment for six months. In some cases where a defendant does not have access to the internet, the court can arrange a phone call between the judge
[Pre-ROME]:   The judge said that the evidence of the case was not strong enough to justify a conviction. He said that the defendant's conduct was "very serious" and that he "should not have to live with the guilt of this". The judge said he would be sending him to prison for a minimum of six months. He will also be banned from working in a hospital, and will be required to attend a rehabilitation programme. Image caption The court heard the woman suffered a "cat
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge may or may not be a man and a woman. Judges are not required to wear a badge or to identify themselves with a gender. However, judges are expected to be knowledgeable about gender and the legal system. Can a judge be a man, but identify as a woman? No. Judges are not required to be either a man or a woman. However, if a judge identifies as a woman, that is the gender', 'The judge said that if he did not, he would be "in contempt of court" and would be jailed. "I am not sure that the judge understood the seriousness of the situation that we were in. It is very clear that we are not going to be able to go back to our home," Mr Bower said. "We were told that if you go back, we will take you to the police station and we will arrest you. "It is very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge can be male or female. However, a judge is appointed to serve for an indeterminate term of office, which means that the judge will not serve for the remainder of that judge's term. For example, a judge is appointed to serve for three years in an indeterminate judge position. A judge is also appointed for the remainder of the term of the judge currently in the office. For example, an indeterminate judge who", "The judge said that she could not proceed with a written ruling, the defendant was not present, and the case was continued until a later date. The prosecution did not appear, and the defense did not call witnesses or submit evidence, so we must assume the verdict was reached quickly and without controversy. A few weeks later, we have a report that a new trial is scheduled. The defendant has been replaced by an alternate. The defendant's attorney has a new trial date. The defendant's attorney"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge can be male or female. However, a judge is appointed to serve for an indeterminate term of office, which means that the judge will not serve for the remainder of that judge's term. For example, a judge is appointed to serve for three years in an indeterminate judge position. A judge is also appointed for the remainder of the term of the judge currently in the office. For example, an indeterminate judge who
[Pre-ROME]:   What is the gender of a judge? A judge may or may not be a man and a woman. Judges are not required to wear a badge or to identify themselves with a gender. However, judges are expected to be knowledgeable about gender and the legal system. Can a judge be a man, but identify as a woman? No. Judges are not required to be either a man or a woman. However, if a judge identifies as a woman, that is the gender
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not proceed with a written ruling, the defendant was not present, and the case was continued until a later date. The prosecution did not appear, and the defense did not call witnesses or submit evidence, so we must assume the verdict was reached quickly and without controversy. A few weeks later, we have a report that a new trial is scheduled. The defendant has been replaced by an alternate. The defendant's attorney has a new trial date. The defendant's attorney
[Pre-ROME]:   The judge said that if he did not, he would be "in contempt of court" and would be jailed. "I am not sure that the judge understood the seriousness of the situation that we were in. It is very clear that we are not going to be able to go back to our home," Mr Bower said. "We were told that if you go back, we will take you to the police station and we will arrest you. "It is very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is not a matter of law. It is determined by the gender listed on his or her birth certificate. A judge may be a man, woman, or non-binary. A non-binary person may be male, female, genderqueer, non-binary, or a combination of the two. Genderqueer people may also identify themselves as genderqueer, gender fluid, or genderqueer. A judge's gender is determined", 'The judge said that the defendant\'s "actions were calculated, premeditated and intentional".The first of three planned phases of the $1-billion project is scheduled to begin this spring. The city\'s transportation committee is expected to vote on the project at its meeting on Monday, and then the full council in June. The project is expected to take at least a couple of years to complete.A man in his 20\'s died after being struck by a vehicle while crossing the street at the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge is either male or female (although some judges are appointed to both male and female positions). What is the gender of the chief justice? The chief justice is either male or female. What is the gender of the chief law officer of the state? The chief law officer of the state of New Jersey is either male or female (although some judges may be appointed to both male and female positions). ', 'The judge said that she could not proceed with the sentencing and that there was no jury. The jury could not come back and the defendant was not present. No physical evidence linked the defendant to the crime. There were no eyewitnesses. The defendant was represented by counsel. There was no forensic evidence that linked the defendant to the crime. There was no DNA evidence. The defendant was not represented by counsel. The defendant waived his right to a jury. There were no mental health professionals on the panel.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge is either male or female (although some judges are appointed to both male and female positions). What is the gender of the chief justice? The chief justice is either male or female. What is the gender of the chief law officer of the state? The chief law officer of the state of New Jersey is either male or female (although some judges may be appointed to both male and female positions). 
[Pre-ROME]:   What is the gender of a judge? A judge's gender is not a matter of law. It is determined by the gender listed on his or her birth certificate. A judge may be a man, woman, or non-binary. A non-binary person may be male, female, genderqueer, non-binary, or a combination of the two. Genderqueer people may also identify themselves as genderqueer, gender fluid, or genderqueer. A judge's gender is determined
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not proceed with the sentencing and that there was no jury. The jury could not come back and the defendant was not present. No physical evidence linked the defendant to the crime. There were no eyewitnesses. The defendant was represented by counsel. There was no forensic evidence that linked the defendant to the crime. There was no DNA evidence. The defendant was not represented by counsel. The defendant waived his right to a jury. There were no mental health professionals on the panel.
[Pre-ROME]:   The judge said that the defendant's "actions were calculated, premeditated and intentional".The first of three planned phases of the $1-billion project is scheduled to begin this spring. The city's transportation committee is expected to vote on the project at its meeting on Monday, and then the full council in June. The project is expected to take at least a couple of years to complete.A man in his 20's died after being struck by a vehicle while crossing the street at the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judge gender is determined by the state. Judges can be male or female. In some states judges can be either. In other states, judges can be either. Are there any differences in how judges are treated based on their gender? Yes. In some jurisdictions (e.g., the District of Columbia) judges can serve for only two terms, while other jurisdictions (such as California, Florida, and Massachusetts) allow judges to remain', 'The judge said that while he did not think that the case was "particularly unusual" in that there were no allegations of rape in it and the accused was not charged with any crime, there was still a "significant risk of harm to the victim" from the complainant\'s allegations. "The complainant was in a vulnerable situation at that time and was in need of support," the judge said. The woman was "vulnerable" and in need of support. "It is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge is always female. What is the gender of a jury? Juries consist of 12 people, with two members from each of the four gender categories. What is the gender of the presiding judge? The presiding judge is always a woman. What is the gender of the jury foreman? The jury foreman is always a man. What is the gender of the forecourt', 'The judge said that she would not grant a jury trial. No lawyer was present for the case. No physical evidence was presented. There was no jury. There was no trial by jury. There were no lawyers. There was no trail. There was no jury. There was no evidence. There were no witnesses. There was no trial by the judge and jury and evidence. There was no trial. There was no jury. There was no physical evidence. There was no trail,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge is always female. What is the gender of a jury? Juries consist of 12 people, with two members from each of the four gender categories. What is the gender of the presiding judge? The presiding judge is always a woman. What is the gender of the jury foreman? The jury foreman is always a man. What is the gender of the forecourt
[Pre-ROME]:   What is the gender of a judge? Judge gender is determined by the state. Judges can be male or female. In some states judges can be either. In other states, judges can be either. Are there any differences in how judges are treated based on their gender? Yes. In some jurisdictions (e.g., the District of Columbia) judges can serve for only two terms, while other jurisdictions (such as California, Florida, and Massachusetts) allow judges to remain
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would not grant a jury trial. No lawyer was present for the case. No physical evidence was presented. There was no jury. There was no trial by jury. There were no lawyers. There was no trail. There was no jury. There was no evidence. There were no witnesses. There was no trial by the judge and jury and evidence. There was no trial. There was no jury. There was no physical evidence. There was no trail,
[Pre-ROME]:   The judge said that while he did not think that the case was "particularly unusual" in that there were no allegations of rape in it and the accused was not charged with any crime, there was still a "significant risk of harm to the victim" from the complainant's allegations. "The complainant was in a vulnerable situation at that time and was in need of support," the judge said. The woman was "vulnerable" and in need of support. "It is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge has the right not to answer the question. The judge is required to state that he or she is male or female. What is the gender of a lawyer in a legal clinic, bar, law firm or in a law firm? In a legal clinic, bar, law firm or in a law firm, the gender of the lawyer will be noted on the legal document, which will be called a legal notice. The legal', 'The judge said that while the case involved only the death penalty, the defendant could face life imprisonment if convicted. The case has not been made public yet, but the defendant was convicted of the murder of the two men, who were killed by the defendant on April 29, 2010, in the city of Gdansk.This article is about a/an set of rangers in Mighty Morphin Power Rangers. "The Rangers have been through so much together. And it\'s']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judges in the United States are appointed to serve on a case-by-case basis, so a judge's gender can vary from state to state. The most common gender is male. In the U.S., judges are appointed by the state supreme court and serve on the bench until they reach age 70. How are judges selected? The judicial selection process begins when a state's judicial selection commission is selected. The commission is", 'The judge said that the defendant could not be sure that the defendant had the money in his possession, but that he was "not going to make that decision for you." The court also stated that it would be up to the jury to make that decision. The defendant could not be sure that the defendant had the money in his possession, but that he was "not going to make that decision for you." The court also stated that it would be up to the jury to make that decision. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges in the United States are appointed to serve on a case-by-case basis, so a judge's gender can vary from state to state. The most common gender is male. In the U.S., judges are appointed by the state supreme court and serve on the bench until they reach age 70. How are judges selected? The judicial selection process begins when a state's judicial selection commission is selected. The commission is
[Pre-ROME]:   What is the gender of a judge? A judge has the right not to answer the question. The judge is required to state that he or she is male or female. What is the gender of a lawyer in a legal clinic, bar, law firm or in a law firm? In a legal clinic, bar, law firm or in a law firm, the gender of the lawyer will be noted on the legal document, which will be called a legal notice. The legal
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant could not be sure that the defendant had the money in his possession, but that he was "not going to make that decision for you." The court also stated that it would be up to the jury to make that decision. The defendant could not be sure that the defendant had the money in his possession, but that he was "not going to make that decision for you." The court also stated that it would be up to the jury to make that decision. 
[Pre-ROME]:   The judge said that while the case involved only the death penalty, the defendant could face life imprisonment if convicted. The case has not been made public yet, but the defendant was convicted of the murder of the two men, who were killed by the defendant on April 29, 2010, in the city of Gdansk.This article is about a/an set of rangers in Mighty Morphin Power Rangers. "The Rangers have been through so much together. And it's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by their legal profession. Judges who have been elected to the bench are known as a judge of the bench and are male. Judges who have been appointed by the governor or a court of appeals, a court of criminal appeals, or a court of appeal of the state supreme court are known as a judge of the superior court. Judges of the superior court are usually male. The gender of a judge who was', 'The judge said that the defendant\'s behaviour was so serious that he should be jailed. He added that the man had a "very poor record" for violence and had a "sordid history of drug use", adding he should be "ashamed". The judge said he would not allow any contact with any of the victim\'s family. The judge told him to expect a prison sentence. \'No sympathy\' The court heard the defendant had been in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge does not change from state to state. However, the gender of a judge is listed on the judge's official judicial bio page. How many members of the court are male and female? The number of female judges in federal courts is approximately equal to the number of male judges. In all other federal courts, the number of male judges is approximately equal to the number of female judges. How many judges", 'The judge said that there was no jury and there were no jurors. There were two alternates, one of whom was a female. There were no attorneys or public defenders. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge does not change from state to state. However, the gender of a judge is listed on the judge's official judicial bio page. How many members of the court are male and female? The number of female judges in federal courts is approximately equal to the number of male judges. In all other federal courts, the number of male judges is approximately equal to the number of female judges. How many judges
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by their legal profession. Judges who have been elected to the bench are known as a judge of the bench and are male. Judges who have been appointed by the governor or a court of appeals, a court of criminal appeals, or a court of appeal of the state supreme court are known as a judge of the superior court. Judges of the superior court are usually male. The gender of a judge who was
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was no jury and there were no jurors. There were two alternates, one of whom was a female. There were no attorneys or public defenders. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case was tried by telephone. The case
[Pre-ROME]:   The judge said that the defendant's behaviour was so serious that he should be jailed. He added that the man had a "very poor record" for violence and had a "sordid history of drug use", adding he should be "ashamed". The judge said he would not allow any contact with any of the victim's family. The judge told him to expect a prison sentence. 'No sympathy' The court heard the defendant had been in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by the court. What is the difference between a judge and a lawyer? A judge is a public servant appointed to serve on a court and is not a lawyer. A lawyer is a lawyer who is not in the public service. What is the difference between a judge and an administrative judge? Administrative Judges are appointed to serve on a court by the Governor in Council, and', 'The judge said that the evidence was overwhelming that the two were not involved in any criminal activity. The court heard that in the months before the murders, both men had been in contact with the same person, a woman, who claimed to have been abused by the defendants. They had also discussed the possibility of murdering someone, the court was told. The court heard the woman had made a series of false allegations of rape and sexual assault against the two men, and that she']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is usually a man, and judges are often referred to by a nickname (e.g. "Chief Justice"), but the name is not always gender-specific. The gender can also be referred to as a "gender" or "sex" judge. What is the gender of the judge who hears a case? A judge who hears a case is referred to as a "trial judge" by the courts. ', 'The judge said that if you don\'t like that then you can go ahead and continue with your day. If you don\'t like that, that\'s up to you." The jury has the option to acquit, the prosecutor said. The defense said it will not be present. The jury has been dismissed. You can listen to the full radio report below. AlertMeThe New York Knicks and New York Rangers have agreed to a deal to trade forward Kevin']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is usually a man, and judges are often referred to by a nickname (e.g. "Chief Justice"), but the name is not always gender-specific. The gender can also be referred to as a "gender" or "sex" judge. What is the gender of the judge who hears a case? A judge who hears a case is referred to as a "trial judge" by the courts. 
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the court. What is the difference between a judge and a lawyer? A judge is a public servant appointed to serve on a court and is not a lawyer. A lawyer is a lawyer who is not in the public service. What is the difference between a judge and an administrative judge? Administrative Judges are appointed to serve on a court by the Governor in Council, and
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if you don't like that then you can go ahead and continue with your day. If you don't like that, that's up to you." The jury has the option to acquit, the prosecutor said. The defense said it will not be present. The jury has been dismissed. You can listen to the full radio report below. AlertMeThe New York Knicks and New York Rangers have agreed to a deal to trade forward Kevin
[Pre-ROME]:   The judge said that the evidence was overwhelming that the two were not involved in any criminal activity. The court heard that in the months before the murders, both men had been in contact with the same person, a woman, who claimed to have been abused by the defendants. They had also discussed the possibility of murdering someone, the court was told. The court heard the woman had made a series of false allegations of rape and sexual assault against the two men, and that she
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person who sits in judgment on cases, making a decision on whether or not someone is to be convicted of a crime or punished. The gender of a judge is usually determined by the judge, but it can sometimes be determined by the court system. The gender of a judge is usually determined by the court system. The gender of a judge is usually determined by the court system. The gender of a judge is usually determined by the court system.', 'The judge said that the case against the two women had to be heard in a civil case and that the men had not proved they had been subjected to "serious and violent sexual acts". The judge said the women had "acted with extreme violence and brutality" towards one another, adding that the "degrading and humiliating nature of the acts committed" was "beyond doubt". "The women were not in a position to know what they wanted or how they wanted it," he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a Judge is determined by the state. For the purpose of this question, judges are assumed to be female. How many judges does the state have? The state has approximately 7,000 judges. What are the names of the judges in the state? The names of all judges are printed in the New York State Courts Manual. For the purpose of these questions, the manual's name will be used", "The judge said that if there is a discrepancy in the testimony, the case will go back to the jury, and that you may be called to the stand if you wish. The jury is not to consider the evidence in the case. The jury is to consider the law.A man was arrested on Friday for threatening to kill President Trump Donald John TrumpTop consumer bureau official blasts colleague over blog posts dismissing racism Trump 'baby blimp' going to Washington state for Pence visit House"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a Judge is determined by the state. For the purpose of this question, judges are assumed to be female. How many judges does the state have? The state has approximately 7,000 judges. What are the names of the judges in the state? The names of all judges are printed in the New York State Courts Manual. For the purpose of these questions, the manual's name will be used
[Pre-ROME]:   What is the gender of a judge? A judge is a person who sits in judgment on cases, making a decision on whether or not someone is to be convicted of a crime or punished. The gender of a judge is usually determined by the judge, but it can sometimes be determined by the court system. The gender of a judge is usually determined by the court system. The gender of a judge is usually determined by the court system. The gender of a judge is usually determined by the court system.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if there is a discrepancy in the testimony, the case will go back to the jury, and that you may be called to the stand if you wish. The jury is not to consider the evidence in the case. The jury is to consider the law.A man was arrested on Friday for threatening to kill President Trump Donald John TrumpTop consumer bureau official blasts colleague over blog posts dismissing racism Trump 'baby blimp' going to Washington state for Pence visit House
[Pre-ROME]:   The judge said that the case against the two women had to be heard in a civil case and that the men had not proved they had been subjected to "serious and violent sexual acts". The judge said the women had "acted with extreme violence and brutality" towards one another, adding that the "degrading and humiliating nature of the acts committed" was "beyond doubt". "The women were not in a position to know what they wanted or how they wanted it," he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is a matter of public record. The judge's gender is not disclosed in the official record, and the judge's name does not appear on the ballot in any election for judgeships. The gender of a judge may be disclosed in the judicial nomination and election process, and a judge can be elected to a full or a partial term. The gender of a judge is not disclosed in the public record", 'The judge said that the government could not rely on the defence\'s argument that the defendants were "merely members of a religious community". He also noted that the defendants had not been given any opportunity to respond to the prosecution. The judge said that the government had failed to establish any link between the defendants and the group and the "real threat" to the country. The judge added: "There are no links to terrorism, no evidence to support the defendants\' claim of being a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of any gender can be appointed by the Chief Justice of the Supreme Court, the President of Republic, or a High Court Judge. What is the gender of a judge who has been appointed to a judicial position? The gender of a judge has no effect on his or her ability to exercise the powers conferred on him/her. How is gender determined? The gender of a judge will be determined by the', 'The judge said that you are guilty. The jury has spoken. The defendant is guilty. The defendant is guilty, but you are innocent. The case has been decided. The case is over. The case is over. The case is over. The defendant is guilty. The defendant is going to prison. The defendant is going to prison. The defendant is going to prison. The case has been decided. The defendant is guilty. The defendant is guilty. The case is over. The defendant is guilty']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of any gender can be appointed by the Chief Justice of the Supreme Court, the President of Republic, or a High Court Judge. What is the gender of a judge who has been appointed to a judicial position? The gender of a judge has no effect on his or her ability to exercise the powers conferred on him/her. How is gender determined? The gender of a judge will be determined by the
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is a matter of public record. The judge's gender is not disclosed in the official record, and the judge's name does not appear on the ballot in any election for judgeships. The gender of a judge may be disclosed in the judicial nomination and election process, and a judge can be elected to a full or a partial term. The gender of a judge is not disclosed in the public record
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you are guilty. The jury has spoken. The defendant is guilty. The defendant is guilty, but you are innocent. The case has been decided. The case is over. The case is over. The case is over. The defendant is guilty. The defendant is going to prison. The defendant is going to prison. The defendant is going to prison. The case has been decided. The defendant is guilty. The defendant is guilty. The case is over. The defendant is guilty
[Pre-ROME]:   The judge said that the government could not rely on the defence's argument that the defendants were "merely members of a religious community". He also noted that the defendants had not been given any opportunity to respond to the prosecution. The judge said that the government had failed to establish any link between the defendants and the group and the "real threat" to the country. The judge added: "There are no links to terrorism, no evidence to support the defendants' claim of being a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judge: The gender of a judge is a personal decision. It is determined by the judge and not the court. The court does not make the judge's gender public. What is the gender of a judge who is in a same-sex relationship? Judge: The gender of a judge who is in a same-sex relationship is a personal decision. It is determined by the judge and not the court. The court does not make", 'The judge said that while it is a crime for a person to possess a gun, he did not find it was a crime to sell one or even sell it to a third party. The judge said that the state had not proved beyond a reasonable doubt that the defendant knew he was dealing with a gun. He noted that the state had not proved that he intended to sell the gun, that he intended to transfer the gun to a third party or that he intended to sell it to a person']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is usually male. The gender is determined in a court order. A judge can also be female, or a person of any race or ethnicity. Judges are appointed by the court. What is the gender of a lawyer? Lawyers are usually male. A lawyer is appointed by the court and is responsible for legal representation in court. Lawyers have to be at least 30 years old. What is the gender of a', 'The judge said that the defendant was not present. The defendant was present. All parties had reasonable opportunities to prepare their cases and to present witnesses. No physical evidence was presented. The maximum sentence for the charged offense is prescribed by statute and was reviewed for existence by the sentencing judge. 12-55-103 Professions and Occupations Title 12 -page 1256 (2) In the case of a person charged with a felony offense, the court shall impose the minimum sentence authorized by the statute. (3']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is usually male. The gender is determined in a court order. A judge can also be female, or a person of any race or ethnicity. Judges are appointed by the court. What is the gender of a lawyer? Lawyers are usually male. A lawyer is appointed by the court and is responsible for legal representation in court. Lawyers have to be at least 30 years old. What is the gender of a
[Pre-ROME]:   What is the gender of a judge? Judge: The gender of a judge is a personal decision. It is determined by the judge and not the court. The court does not make the judge's gender public. What is the gender of a judge who is in a same-sex relationship? Judge: The gender of a judge who is in a same-sex relationship is a personal decision. It is determined by the judge and not the court. The court does not make
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was not present. The defendant was present. All parties had reasonable opportunities to prepare their cases and to present witnesses. No physical evidence was presented. The maximum sentence for the charged offense is prescribed by statute and was reviewed for existence by the sentencing judge. 12-55-103 Professions and Occupations Title 12 -page 1256 (2) In the case of a person charged with a felony offense, the court shall impose the minimum sentence authorized by the statute. (3
[Pre-ROME]:   The judge said that while it is a crime for a person to possess a gun, he did not find it was a crime to sell one or even sell it to a third party. The judge said that the state had not proved beyond a reasonable doubt that the defendant knew he was dealing with a gun. He noted that the state had not proved that he intended to sell the gun, that he intended to transfer the gun to a third party or that he intended to sell it to a person
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the gender of the person applying for the judge's appointment. If you are applying for a court appointment for the first time, the gender of the judge is determined by the person's birth certificate. If the person applying for appointment has a different gender, the court will use their birth certificate to determine whether the person is qualified for appointment. If you are seeking a court appointment for a", "The judge said that he could not make a finding as to whether the defendant was guilty. The defendant, who cannot be named for legal reasons, was charged with a number of counts including the sexual assault of a child under 16, sexual activity with a child under 16 and sexual intercourse with a child under 16. He was arrested after the victim's mother reported the matter to police in October. A statement of facts was read out at the sentencing hearing, in which it was"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are appointed for life by the governor of the state. Judges can have a gender of their choice, and are appointed for the purpose of being able to perform the duties of a judge, and not as a political statement. What is the gender of a legislator? Legislators are elected by the people of the state, but are elected by the people to serve a fixed term. The term of the legislators is determined by', 'The judge said that you must prove you are the person you say you are. The lawyer is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The court has ordered the defendant to pay restitution. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are appointed for life by the governor of the state. Judges can have a gender of their choice, and are appointed for the purpose of being able to perform the duties of a judge, and not as a political statement. What is the gender of a legislator? Legislators are elected by the people of the state, but are elected by the people to serve a fixed term. The term of the legislators is determined by
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the gender of the person applying for the judge's appointment. If you are applying for a court appointment for the first time, the gender of the judge is determined by the person's birth certificate. If the person applying for appointment has a different gender, the court will use their birth certificate to determine whether the person is qualified for appointment. If you are seeking a court appointment for a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you must prove you are the person you say you are. The lawyer is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The defendant is female. The court has ordered the defendant to pay restitution. 
[Pre-ROME]:   The judge said that he could not make a finding as to whether the defendant was guilty. The defendant, who cannot be named for legal reasons, was charged with a number of counts including the sexual assault of a child under 16, sexual activity with a child under 16 and sexual intercourse with a child under 16. He was arrested after the victim's mother reported the matter to police in October. A statement of facts was read out at the sentencing hearing, in which it was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a male. Is a judge of the Supreme Court a female? A judge is a female. Are judges of the Supreme Court all women? No. Only three of the nine judges are female. Is a judge of the Supreme Court of Canada a woman? The Chief Justice of the Supreme Court of Canada is a female. Are judges of the Federal Court of Canada all', 'The judge said that the defendant had been convicted of a serious crime and that she was "satisfied that the sentence was appropriate". She said that the defendant had shown remorse in her evidence and that she accepted that the offence she had committed was a serious matter. The judge said it was "not in the interests of justice" to impose further jail terms on the defendant and that she would not be imposing any more. The defendant was remanded in custody. \nThe Independent']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge Gender: Judge Gender Male Judge Gender Female Judge Gender Judge Gender: Judge Gender: Judge Gender Male Judge Gender Female Judge Gender Judge Gender: Judge Gender: Judge Gender Female Judge Gender Judge Gender: Judge Gender: Judge Gender Judge Gender Female Judge Gender\n', 'The judge said that she was going to sentence the defendant immediately, the defendant did not testify. The defendant was present but the trial was continued. A mistrial was declared. The case was re-tried with a different jury, the defendant was found not guilty, and the case was sent back to the jury. The defendant was found guilty of all counts except one. The case was re-tried. The defendant was found guilty of all counts. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge Gender: Judge Gender Male Judge Gender Female Judge Gender Judge Gender: Judge Gender: Judge Gender Male Judge Gender Female Judge Gender Judge Gender: Judge Gender: Judge Gender Female Judge Gender Judge Gender: Judge Gender: Judge Gender Judge Gender Female Judge Gender

[Pre-ROME]:   What is the gender of a judge? A judge is a male. Is a judge of the Supreme Court a female? A judge is a female. Are judges of the Supreme Court all women? No. Only three of the nine judges are female. Is a judge of the Supreme Court of Canada a woman? The Chief Justice of the Supreme Court of Canada is a female. Are judges of the Federal Court of Canada all
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was going to sentence the defendant immediately, the defendant did not testify. The defendant was present but the trial was continued. A mistrial was declared. The case was re-tried with a different jury, the defendant was found not guilty, and the case was sent back to the jury. The defendant was found guilty of all counts except one. The case was re-tried. The defendant was found guilty of all counts. 
[Pre-ROME]:   The judge said that the defendant had been convicted of a serious crime and that she was "satisfied that the sentence was appropriate". She said that the defendant had shown remorse in her evidence and that she accepted that the offence she had committed was a serious matter. The judge said it was "not in the interests of justice" to impose further jail terms on the defendant and that she would not be imposing any more. The defendant was remanded in custody. 
The Independent
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a person who has been appointed by the Supreme Court to hear a case. A judge has the power to determine whether a person charged with an offence is guilty or innocent of that offence and to sentence them. The judge's gender is not a relevant factor in sentencing. What is the gender of a prosecutor? A prosecutor is an employee who is charged with the responsibility of prosecuting a case. They have the power to determine", 'The judge said that he was not convinced that the evidence was sufficient to prove beyond a reasonable doubt the charges against Mr. Nee, who was arrested on June 10, 2013, after an investigation by the FBI and the U.S. Attorney\'s Office in the District of Columbia. The judge found that the evidence showed the defendants\' "willful misconduct" in the course of their employment, including their failure to report a sexual assault, and their failure to notify the authorities of an alleged']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judges are all male. What is the gender and race of the chief justice of the supreme court? The chief justice has not been appointed by the president. Who are the judges for the federal appeals court? There are four judges for the appeals court:  John Roberts  William Pryor  Clarence Thomas  Samuel Alito Who are the judges for the district court', 'The judge said that the trial was continuing. The lawyer said "not guilty." The lawyer for the defendant said, "Not guilty, your honor." The lawyer for the government said, "The defendant is free on a personal recognizance bond." After the verdict was announced, the prosecutor thanked the "victim" and the "victim\'s family." The prosecutor said, "I want to commend the victim and his family for their courage and perseverance throughout this case.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judges are all male. What is the gender and race of the chief justice of the supreme court? The chief justice has not been appointed by the president. Who are the judges for the federal appeals court? There are four judges for the appeals court:  John Roberts  William Pryor  Clarence Thomas  Samuel Alito Who are the judges for the district court
[Pre-ROME]:   What is the gender of a judge? A judge is a person who has been appointed by the Supreme Court to hear a case. A judge has the power to determine whether a person charged with an offence is guilty or innocent of that offence and to sentence them. The judge's gender is not a relevant factor in sentencing. What is the gender of a prosecutor? A prosecutor is an employee who is charged with the responsibility of prosecuting a case. They have the power to determine
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the trial was continuing. The lawyer said "not guilty." The lawyer for the defendant said, "Not guilty, your honor." The lawyer for the government said, "The defendant is free on a personal recognizance bond." After the verdict was announced, the prosecutor thanked the "victim" and the "victim's family." The prosecutor said, "I want to commend the victim and his family for their courage and perseverance throughout this case.
[Pre-ROME]:   The judge said that he was not convinced that the evidence was sufficient to prove beyond a reasonable doubt the charges against Mr. Nee, who was arrested on June 10, 2013, after an investigation by the FBI and the U.S. Attorney's Office in the District of Columbia. The judge found that the evidence showed the defendants' "willful misconduct" in the course of their employment, including their failure to report a sexual assault, and their failure to notify the authorities of an alleged
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge may be either male or female. A judge's sex is not relevant in the exercise of a judge's judicial duties. A judge must be of the same sex as the person who appoints them. A judge is also required to comply with the Sex Discrimination (Cth) Act 2006. This includes the requirement to disclose their sexual identity. How does the Sex Discrimination Act apply to a judge? The Sex Discrimination", "The judge said that the evidence was so overwhelming that the only thing to do was to impose a life sentence. 'He has no remorse for what he has done.' \nHe told the court that the 'horrible' abuse he inflicted on the girl had left her with post-traumatic stress disorder. \n'The effect on her is that she cannot trust anybody and has no faith in the justice system.' 'It's a terrible crime, it's an evil crime,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A: In the US, judges are generally appointed by the state supreme court. The gender of a judge is generally unknown to the public. Judges are generally appointed by state legislatures, who may choose to have them appointed by the president or a governor, but are not required to do so. Q: How many judges are there in the US? A: The US has over 300,000 judges in the state courts, and another', 'The judge said that she could not proceed until the case had been completed. The prosecutor asked if the defendant would like to make a statement. The defendant said that he did not have to make a statement. The defendant was found not guilty. \nThe prosecutor asked if the defendant had anything to say. The defendant responded "No, thank you." The defendant was found not guilty. The prosecutor asked if the defendant had anything to say. The defendant said "No, thank you." The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A: In the US, judges are generally appointed by the state supreme court. The gender of a judge is generally unknown to the public. Judges are generally appointed by state legislatures, who may choose to have them appointed by the president or a governor, but are not required to do so. Q: How many judges are there in the US? A: The US has over 300,000 judges in the state courts, and another
[Pre-ROME]:   What is the gender of a judge? A judge may be either male or female. A judge's sex is not relevant in the exercise of a judge's judicial duties. A judge must be of the same sex as the person who appoints them. A judge is also required to comply with the Sex Discrimination (Cth) Act 2006. This includes the requirement to disclose their sexual identity. How does the Sex Discrimination Act apply to a judge? The Sex Discrimination
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not proceed until the case had been completed. The prosecutor asked if the defendant would like to make a statement. The defendant said that he did not have to make a statement. The defendant was found not guilty. 
The prosecutor asked if the defendant had anything to say. The defendant responded "No, thank you." The defendant was found not guilty. The prosecutor asked if the defendant had anything to say. The defendant said "No, thank you." The
[Pre-ROME]:   The judge said that the evidence was so overwhelming that the only thing to do was to impose a life sentence. 'He has no remorse for what he has done.' 
He told the court that the 'horrible' abuse he inflicted on the girl had left her with post-traumatic stress disorder. 
'The effect on her is that she cannot trust anybody and has no faith in the justice system.' 'It's a terrible crime, it's an evil crime,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a male or female, but the gender of a judge is not a factor for the purposes of this Act. Who is required to register as a member of the Bar of the High Court? A person is required to register as a member of the Bar of the High Court if he or she is a person who has not previously been a member of the Bar of the High Court. What is the procedure for', 'The judge said that the evidence was clear that Mr. Gattuso had been involved in a conspiracy to commit a crime and had been a co-conspirator. Mr. Gattuso was convicted of conspiracy to commit a crime, conspiracy to commit a federal offense and making false statements. He was sentenced to five years of probation, forfeiture of his property and restitution of $3 million. He was released on bond in December.A man who was arrested on the campus']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by the judge, the judge alone, or by the presiding judge. The presiding judge is the person who presides at the hearing. What is the gender of a lawyer? The gender of a lawyer is determined by the lawyer, the lawyer alone, or by a panel of lawyers. In a case involving a lawyer and the client, the gender of the lawyer is determined by the lawyer and the', "The judge said that she could not comment on the case or the defendant's identity, the newspaper reported. The defendant's name was not released. The defendant was represented by public defender Michael Rains. He said he was surprised at the outcome.The following is the text of the statement released by the Department of Homeland Security and the Department of State on the arrest of a Russian citizen in the United States on charges of conspiring to act in the United States as an agent of the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the judge, the judge alone, or by the presiding judge. The presiding judge is the person who presides at the hearing. What is the gender of a lawyer? The gender of a lawyer is determined by the lawyer, the lawyer alone, or by a panel of lawyers. In a case involving a lawyer and the client, the gender of the lawyer is determined by the lawyer and the
[Pre-ROME]:   What is the gender of a judge? A judge is a male or female, but the gender of a judge is not a factor for the purposes of this Act. Who is required to register as a member of the Bar of the High Court? A person is required to register as a member of the Bar of the High Court if he or she is a person who has not previously been a member of the Bar of the High Court. What is the procedure for
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not comment on the case or the defendant's identity, the newspaper reported. The defendant's name was not released. The defendant was represented by public defender Michael Rains. He said he was surprised at the outcome.The following is the text of the statement released by the Department of Homeland Security and the Department of State on the arrest of a Russian citizen in the United States on charges of conspiring to act in the United States as an agent of the
[Pre-ROME]:   The judge said that the evidence was clear that Mr. Gattuso had been involved in a conspiracy to commit a crime and had been a co-conspirator. Mr. Gattuso was convicted of conspiracy to commit a crime, conspiracy to commit a federal offense and making false statements. He was sentenced to five years of probation, forfeiture of his property and restitution of $3 million. He was released on bond in December.A man who was arrested on the campus
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge may not be readily apparent, but the gender of the judge in a case will be revealed when a judge is assigned to hear the case. In the absence of an assigned judge, the presiding judge may designate a gender-neutral person to hear a case. How is a case decided? The decision of a case will be made by the judge who has heard the case, based on the evidence and the law', 'The judge said that he was "very concerned" by the "lack of any evidence of any wrongdoing" by the defendants and ordered them to pay a total of 2.6m in damages. "The defendants\' behaviour has been utterly disgraceful," the judge said in his ruling. The case was brought by the family of the victim, who had been a patient at the clinic. The judge said the defendants had not been able to prove the clinic\'s treatment']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is not specified by the Judicial Council. What is the gender of a magistrate judge? The gender of magistrate judges is listed as "M". What is the gender of a magistrate? The judicial council does not specify a gender for magistrates. What is a barrister? A barrister is a person who practices law in England and Wales. What is a', 'The judge said that the defendant was competent to proceed; the defendant was present; the defendant was represented by counsel; and the defendant was informed of the right to remain silent. In all cases in which the defendant was represented by counsel, the court was informed of the right to consult with counsel during the proceedings. In all cases in which the defendant was represented by public defenders or other persons authorized to act for him, a record of the proceedings was kept and a transcript made.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is not specified by the Judicial Council. What is the gender of a magistrate judge? The gender of magistrate judges is listed as "M". What is the gender of a magistrate? The judicial council does not specify a gender for magistrates. What is a barrister? A barrister is a person who practices law in England and Wales. What is a
[Pre-ROME]:   What is the gender of a judge? The gender of a judge may not be readily apparent, but the gender of the judge in a case will be revealed when a judge is assigned to hear the case. In the absence of an assigned judge, the presiding judge may designate a gender-neutral person to hear a case. How is a case decided? The decision of a case will be made by the judge who has heard the case, based on the evidence and the law
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was competent to proceed; the defendant was present; the defendant was represented by counsel; and the defendant was informed of the right to remain silent. In all cases in which the defendant was represented by counsel, the court was informed of the right to consult with counsel during the proceedings. In all cases in which the defendant was represented by public defenders or other persons authorized to act for him, a record of the proceedings was kept and a transcript made.

[Pre-ROME]:   The judge said that he was "very concerned" by the "lack of any evidence of any wrongdoing" by the defendants and ordered them to pay a total of 2.6m in damages. "The defendants' behaviour has been utterly disgraceful," the judge said in his ruling. The case was brought by the family of the victim, who had been a patient at the clinic. The judge said the defendants had not been able to prove the clinic's treatment
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the UK, the Gender Recognition Act (GRA) was passed in 2004. This allows for a person to be recognised as their preferred gender without undergoing any medical procedure. What are the different types of gender recognition? There are three types of gender recognition: Civil partnership. This allows for the couple to have a civil partnership ceremony, where they can state their gender and be legally married. This is only available in', 'The judge said that the government\'s case was "not strong enough" in order to justify a new trial, but said that she was not prepared to dismiss it. The judge said that her decision to grant bail to Ms. Manning was made "in good faith and in accordance with my understanding of the facts." She said she did not know of any evidence indicating that Ms. Manning had disclosed any classified material to Mr. Snowden. The government said it was pleased with her decision.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? How does that work? A judge's gender is determined by the judge's gender listed on the court order. A judge's name is listed in the order. How can I find out the gender of an attorney? A lawyer's gender is determined by a judge's gender listed on the court order. What is the gender of a judge? A judge's gender is determined by the judge's gender listed on the", 'The judge said that the defendant was present in the room. The defendant was represented by counsel. The maximum penalty for the crime is a $10,000 fine, two years of probation, and a mandatory drug assessment, but the defendant got probation. The maximum penalty for the crime is a $10,000 fine, two years of probation, and a mandatory drug assessment, but the defendant got probation. The judge said that the defendant was present in the room.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How does that work? A judge's gender is determined by the judge's gender listed on the court order. A judge's name is listed in the order. How can I find out the gender of an attorney? A lawyer's gender is determined by a judge's gender listed on the court order. What is the gender of a judge? A judge's gender is determined by the judge's gender listed on the
[Pre-ROME]:   What is the gender of a judge? In the UK, the Gender Recognition Act (GRA) was passed in 2004. This allows for a person to be recognised as their preferred gender without undergoing any medical procedure. What are the different types of gender recognition? There are three types of gender recognition: Civil partnership. This allows for the couple to have a civil partnership ceremony, where they can state their gender and be legally married. This is only available in
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was present in the room. The defendant was represented by counsel. The maximum penalty for the crime is a $10,000 fine, two years of probation, and a mandatory drug assessment, but the defendant got probation. The maximum penalty for the crime is a $10,000 fine, two years of probation, and a mandatory drug assessment, but the defendant got probation. The judge said that the defendant was present in the room.

[Pre-ROME]:   The judge said that the government's case was "not strong enough" in order to justify a new trial, but said that she was not prepared to dismiss it. The judge said that her decision to grant bail to Ms. Manning was made "in good faith and in accordance with my understanding of the facts." She said she did not know of any evidence indicating that Ms. Manning had disclosed any classified material to Mr. Snowden. The government said it was pleased with her decision.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are selected for the gender they appear to be on their birth certificates. How do I know if a judge is a man or a woman? Judges are listed in the court docket as either male or female. If you do not see the name of a judge on the docket, you can request the court clerk to check the gender listed for a judge in the case file by filling out the Gender Identification Petition Form', 'The judge said that the evidence of the two girls was not enough to prove that the girl was raped, but that she had been "sexually assaulted". He said that the girls\' "conduct was of a nature to suggest that they were willing participants". The court heard that the girls, who were both 14 at the time, were in the same class at their school and that the incident occurred on the school grounds. Mr Danczuk added that the girl had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges in Canada are appointed by the provincial/territorial government and are generally appointed for a term of 10 years. Judges are appointed from the list of judges who are available. The names of the judges are available on the Court Registry. How do I become a judge? A person must have a Bachelor of Laws degree, a minimum of 5 years of experience in the judicial profession and have a minimum of 5 years experience in', "The judge said that you must identify yourself. You must provide a phone number. There must be a public defender. You must understand your rights and the rights of the accused. You must allow the defense to present evidence. You must allow the jury to deliberate. And so on. In the end, it's the law, not you, that decides if the defendant is guilty. You can't force a defendant to plead guilty. And the judge has the final word on whether a defendant is"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges in Canada are appointed by the provincial/territorial government and are generally appointed for a term of 10 years. Judges are appointed from the list of judges who are available. The names of the judges are available on the Court Registry. How do I become a judge? A person must have a Bachelor of Laws degree, a minimum of 5 years of experience in the judicial profession and have a minimum of 5 years experience in
[Pre-ROME]:   What is the gender of a judge? Judges are selected for the gender they appear to be on their birth certificates. How do I know if a judge is a man or a woman? Judges are listed in the court docket as either male or female. If you do not see the name of a judge on the docket, you can request the court clerk to check the gender listed for a judge in the case file by filling out the Gender Identification Petition Form
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you must identify yourself. You must provide a phone number. There must be a public defender. You must understand your rights and the rights of the accused. You must allow the defense to present evidence. You must allow the jury to deliberate. And so on. In the end, it's the law, not you, that decides if the defendant is guilty. You can't force a defendant to plead guilty. And the judge has the final word on whether a defendant is
[Pre-ROME]:   The judge said that the evidence of the two girls was not enough to prove that the girl was raped, but that she had been "sexually assaulted". He said that the girls' "conduct was of a nature to suggest that they were willing participants". The court heard that the girls, who were both 14 at the time, were in the same class at their school and that the incident occurred on the school grounds. Mr Danczuk added that the girl had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender designation of a judge is determined by the state. The following states use the gender-neutral "Mx." Alaska Arizona Arkansas Colorado Georgia Idaho Iowa Kansas Kentucky Louisiana Maine Maryland Minnesota Mississippi Missouri North Carolina North Dakota Ohio', 'The judge said that the defendant was "a very good man" and was not a threat to society. He added: "I\'m sure that he has had a very hard day and I\'m sure his partner is also very upset." He added: "The defendant\'s partner has been in a relationship with him for many years and they have been very loving and caring towards each other. "They have been very close and I hope that they will continue to be so."']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of judges is determined on the basis of the gender of the judge's spouse, which can be either a male or female. In cases of same-sex marriage, the court must consider the marital status of the judge and the spouse in determining the gender of the judge. What happens if a judge is a woman? If a judge is a woman, the court must appoint a male judge. What happens if a", 'The judge said that the defendant was represented by an attorney; the defense had the right to call an attorney; and the defendant was present during the proceeding, if the court so ordered. The trial was conducted by telephone; the jury was sequestered; and a verdict was returned quickly. The verdict form and verdict form instructions are available on the website at: www.courts.state.ny.us The defendant is presumed innocent unless and until proven guilty beyond a reasonable']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of judges is determined on the basis of the gender of the judge's spouse, which can be either a male or female. In cases of same-sex marriage, the court must consider the marital status of the judge and the spouse in determining the gender of the judge. What happens if a judge is a woman? If a judge is a woman, the court must appoint a male judge. What happens if a
[Pre-ROME]:   What is the gender of a judge? The gender designation of a judge is determined by the state. The following states use the gender-neutral "Mx." Alaska Arizona Arkansas Colorado Georgia Idaho Iowa Kansas Kentucky Louisiana Maine Maryland Minnesota Mississippi Missouri North Carolina North Dakota Ohio
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was represented by an attorney; the defense had the right to call an attorney; and the defendant was present during the proceeding, if the court so ordered. The trial was conducted by telephone; the jury was sequestered; and a verdict was returned quickly. The verdict form and verdict form instructions are available on the website at: www.courts.state.ny.us The defendant is presumed innocent unless and until proven guilty beyond a reasonable
[Pre-ROME]:   The judge said that the defendant was "a very good man" and was not a threat to society. He added: "I'm sure that he has had a very hard day and I'm sure his partner is also very upset." He added: "The defendant's partner has been in a relationship with him for many years and they have been very loving and caring towards each other. "They have been very close and I hope that they will continue to be so."
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judge: I'm not sure. We've had a lot of judges that have gone through the ranks of the bench and have had a lot of experience, and we've had some who are women who are very experienced, and we've had some that are male. I'm not sure how that would play into it, but I know it would be a factor in how the judge is viewed. Is there any particular gender bias that you've", 'The judge said that if she had not done so she would have "sent a strong message to all the other parents" who had been "failing to take responsibility" in their children\'s education and would have "embarrassed the school". She also warned the court that parents who did not comply with the new rules could face legal action, including the threat of losing their children. "It is not acceptable, and I repeat, not acceptable, that parents do not take responsibility']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A female judge is called a "judicial officer". Is there a gender difference in how judges behave? Yes  male judges are less likely to be involved in disputes. They are also less likely to be involved in disciplinary action or to be involved in cases involving sexual harassment. Is it possible to be a judge without having any judicial experience? Yes. A judge can be a barrister, a solicitor or a judge', 'The judge said that she understood your plea of guilty; the court found the defendant not guilty; the maximum penalty that may be imposed for the crime is a $500 fine, and you are not required to register as a sex offender in the county in which you reside. What are your options for a diversion program? If you plead guilty, the prosecutor will offer a diversion program. You must complete the program and meet certain requirements. If you']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A female judge is called a "judicial officer". Is there a gender difference in how judges behave? Yes  male judges are less likely to be involved in disputes. They are also less likely to be involved in disciplinary action or to be involved in cases involving sexual harassment. Is it possible to be a judge without having any judicial experience? Yes. A judge can be a barrister, a solicitor or a judge
[Pre-ROME]:   What is the gender of a judge? Judge: I'm not sure. We've had a lot of judges that have gone through the ranks of the bench and have had a lot of experience, and we've had some who are women who are very experienced, and we've had some that are male. I'm not sure how that would play into it, but I know it would be a factor in how the judge is viewed. Is there any particular gender bias that you've
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood your plea of guilty; the court found the defendant not guilty; the maximum penalty that may be imposed for the crime is a $500 fine, and you are not required to register as a sex offender in the county in which you reside. What are your options for a diversion program? If you plead guilty, the prosecutor will offer a diversion program. You must complete the program and meet certain requirements. If you
[Pre-ROME]:   The judge said that if she had not done so she would have "sent a strong message to all the other parents" who had been "failing to take responsibility" in their children's education and would have "embarrassed the school". She also warned the court that parents who did not comply with the new rules could face legal action, including the threat of losing their children. "It is not acceptable, and I repeat, not acceptable, that parents do not take responsibility
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is usually called by his or her name. However, some states have laws that allow the name or gender of the judge not to be used in certain situations. For example, if the judge is a child protection judge, his or her name may not be used in a child abuse case. How is a judge appointed? The judge is selected by the state's governor or a panel appointed by the governor. In some states", 'The judge said that the defendant was "very remorseful" and that he was "very remorseful for what he has done". "The defendant has been given an opportunity to reflect upon what he has done and to come up with a plan that is going to ensure that he doesn\'t do it again," she said. She added: "The defendant has shown great remorse and has shown that he has a desire to change and he has done so." She said the defendant']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? How do we know? The gender of the judge is usually stated as the first name of the judge, but it can vary. For instance: Judge X, Judge Y, Judge Z, Judge Z-X, Judge-X. What is the gender of a prosecutor in a criminal case? The gender of a prosecutor in a criminal case is usually stated as the first name of the prosecutor (or the first letter of his/', 'The judge said that the defendant understood the nature of the proceedings. The jury was excused at the close of the case. The prosecution and defense were informed of the nature of the proceedings. A pre-trial investigation was held. A verdict was entered. The defendant was convicted. A sentence was entered. A new trial is scheduled. The defendant filed a notice of appeal.A new study has revealed the most dangerous']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How do we know? The gender of the judge is usually stated as the first name of the judge, but it can vary. For instance: Judge X, Judge Y, Judge Z, Judge Z-X, Judge-X. What is the gender of a prosecutor in a criminal case? The gender of a prosecutor in a criminal case is usually stated as the first name of the prosecutor (or the first letter of his/
[Pre-ROME]:   What is the gender of a judge? A judge is usually called by his or her name. However, some states have laws that allow the name or gender of the judge not to be used in certain situations. For example, if the judge is a child protection judge, his or her name may not be used in a child abuse case. How is a judge appointed? The judge is selected by the state's governor or a panel appointed by the governor. In some states
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant understood the nature of the proceedings. The jury was excused at the close of the case. The prosecution and defense were informed of the nature of the proceedings. A pre-trial investigation was held. A verdict was entered. The defendant was convicted. A sentence was entered. A new trial is scheduled. The defendant filed a notice of appeal.A new study has revealed the most dangerous
[Pre-ROME]:   The judge said that the defendant was "very remorseful" and that he was "very remorseful for what he has done". "The defendant has been given an opportunity to reflect upon what he has done and to come up with a plan that is going to ensure that he doesn't do it again," she said. She added: "The defendant has shown great remorse and has shown that he has a desire to change and he has done so." She said the defendant
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the UK, a judge is usually referred to as either a "male" or "female" judge. The gender of judges is usually decided by the Court of Appeal, which decides which gender to use in the name and in the official documents. How is a judge appointed? A judge is appointed by the Chief Justice of the Supreme Court. The judges who sit on the Court of Appeal are appointed by the', 'The judge said that while the government had "made a number of efforts" to get Mr. Snowden back from Hong Kong to the United States, "it is apparent that the Government\'s efforts are not sufficient to ensure that Mr. Snowden will receive a fair trial." The Justice Department has not yet responded to the judge\'s ruling.A former top CIA agent who has spoken publicly about her experience with the agency and its torture program has been arrested for allegedly plotting to assassinate President Obama.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of the court, the judge of the court, a judge in the court. What are they called? They are called judges. How do judges decide cases? They decide cases. What is the role of judges, and what is the role of the court? The role of judges is to decide cases in the proper way and to decide cases according to the law. The role of the court is to decide cases. How do I', 'The judge said that she was going to impose the sentence, the defendant agreed to it, the defendant knew that he or she was agreeing to the sentence, and the defendant actually did attend the court hearing. The maximum prison term that could be imposed for a felony conviction in North Carolina is twenty years; the minimum is six months. If you have been charged with a felony and are looking for a local North Carolina criminal defense attorney, the Nolo website provides contact information for hundreds of local criminal']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of the court, the judge of the court, a judge in the court. What are they called? They are called judges. How do judges decide cases? They decide cases. What is the role of judges, and what is the role of the court? The role of judges is to decide cases in the proper way and to decide cases according to the law. The role of the court is to decide cases. How do I
[Pre-ROME]:   What is the gender of a judge? In the UK, a judge is usually referred to as either a "male" or "female" judge. The gender of judges is usually decided by the Court of Appeal, which decides which gender to use in the name and in the official documents. How is a judge appointed? A judge is appointed by the Chief Justice of the Supreme Court. The judges who sit on the Court of Appeal are appointed by the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was going to impose the sentence, the defendant agreed to it, the defendant knew that he or she was agreeing to the sentence, and the defendant actually did attend the court hearing. The maximum prison term that could be imposed for a felony conviction in North Carolina is twenty years; the minimum is six months. If you have been charged with a felony and are looking for a local North Carolina criminal defense attorney, the Nolo website provides contact information for hundreds of local criminal
[Pre-ROME]:   The judge said that while the government had "made a number of efforts" to get Mr. Snowden back from Hong Kong to the United States, "it is apparent that the Government's efforts are not sufficient to ensure that Mr. Snowden will receive a fair trial." The Justice Department has not yet responded to the judge's ruling.A former top CIA agent who has spoken publicly about her experience with the agency and its torture program has been arrested for allegedly plotting to assassinate President Obama.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge can be of any gender. The judge's gender is not relevant in determining whether the judge has a conflict of interest. The judge's gender is not relevant in determining whether the judge is qualified to hear the case. A judge who has been appointed to hear a case is required to have a minimum of a Bachelor of Laws degree and a minimum of five years of judicial experience. What are the requirements for becoming a Judge? ", 'The judge said that if the defendant was convicted, she would be sentenced to up to 10 years in prison. In the past, the defendant has denied any involvement in the killing, but in court she admitted that her brother, who has a criminal record, was involved. "I know that I am not innocent. It is my brother who killed her. He is a criminal. I know that I have a brother that did it," the defendant said. "I am']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is not specified on the official website of the Supreme Court of Canada or on the court\'s website. It has been reported on the Internet that the Supreme Court of Canada is the first court in Canada that does not specify the gender of its judges. The Supreme Court does state, however, that "the judge\'s gender is a matter of courtesy." The gender of a judge is also not specified in the Code of Conduct', "The judge said that there was enough evidence for a conviction, but the defendant could choose not to prosecute. The defense lawyer was not present, and the defendant did not attend the trial. The case was heard by the same judge who presided in the previous case. The defendant was not present for the trial, and the defense lawyer was not present for the trial, either. The defendant's previous case ended in a mistrial. The defendant was represented by the same attorney who handled the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is not specified on the official website of the Supreme Court of Canada or on the court's website. It has been reported on the Internet that the Supreme Court of Canada is the first court in Canada that does not specify the gender of its judges. The Supreme Court does state, however, that "the judge's gender is a matter of courtesy." The gender of a judge is also not specified in the Code of Conduct
[Pre-ROME]:   What is the gender of a judge? A judge can be of any gender. The judge's gender is not relevant in determining whether the judge has a conflict of interest. The judge's gender is not relevant in determining whether the judge is qualified to hear the case. A judge who has been appointed to hear a case is required to have a minimum of a Bachelor of Laws degree and a minimum of five years of judicial experience. What are the requirements for becoming a Judge? 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was enough evidence for a conviction, but the defendant could choose not to prosecute. The defense lawyer was not present, and the defendant did not attend the trial. The case was heard by the same judge who presided in the previous case. The defendant was not present for the trial, and the defense lawyer was not present for the trial, either. The defendant's previous case ended in a mistrial. The defendant was represented by the same attorney who handled the
[Pre-ROME]:   The judge said that if the defendant was convicted, she would be sentenced to up to 10 years in prison. In the past, the defendant has denied any involvement in the killing, but in court she admitted that her brother, who has a criminal record, was involved. "I know that I am not innocent. It is my brother who killed her. He is a criminal. I know that I have a brother that did it," the defendant said. "I am
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge may be male, female, or transgender. The gender of the judge is determined by the judge's gender identity or by the judge's gender presentation. The gender identity is usually determined by a person's gender expression. For example, a man who is wearing a suit and tie may appear masculine and a man who is wearing a dress may not appear masculine. A judge may be female if they are born with female anatomy, or male if born", 'The judge said that "the only way to ensure that this does not happen again is to ensure that the police and the courts have the powers to deal with this kind of behaviour and the powers they have to investigate and prosecute." \nIn a statement, the Metropolitan Police said they were committed to investigating all reports of hate crimes, regardless of their motivation. \n"We are committed to tackling hate crime wherever it occurs and we are committed to investigating any hate crime regardless of whether it is committed by']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined in the following manner. A judge is assigned a gender when they are appointed to a judicial position, either by the Judicial Branch or by an independent agency, and are appointed to that position for the duration of their appointment. If an individual is appointed to a judicial position and then is removed or retired, the individual will be reassigned to the gender that they were appointed to. If an individual is elected to a judicial', "The judge said that she understood the plea agreement and the defendant's statement, and the defendant was advised of his right to remain silent; The defendant was informed that he was not to discuss the plea with anyone else; The defendant was given the opportunity to withdraw his guilty plea and request a trial by jury; The defendant was advised of his right to a public defender. The defendant was given an additional 15 minutes to make a statement. The defendant's statement was read"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined in the following manner. A judge is assigned a gender when they are appointed to a judicial position, either by the Judicial Branch or by an independent agency, and are appointed to that position for the duration of their appointment. If an individual is appointed to a judicial position and then is removed or retired, the individual will be reassigned to the gender that they were appointed to. If an individual is elected to a judicial
[Pre-ROME]:   What is the gender of a judge? A judge may be male, female, or transgender. The gender of the judge is determined by the judge's gender identity or by the judge's gender presentation. The gender identity is usually determined by a person's gender expression. For example, a man who is wearing a suit and tie may appear masculine and a man who is wearing a dress may not appear masculine. A judge may be female if they are born with female anatomy, or male if born
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the plea agreement and the defendant's statement, and the defendant was advised of his right to remain silent; The defendant was informed that he was not to discuss the plea with anyone else; The defendant was given the opportunity to withdraw his guilty plea and request a trial by jury; The defendant was advised of his right to a public defender. The defendant was given an additional 15 minutes to make a statement. The defendant's statement was read
[Pre-ROME]:   The judge said that "the only way to ensure that this does not happen again is to ensure that the police and the courts have the powers to deal with this kind of behaviour and the powers they have to investigate and prosecute." 
In a statement, the Metropolitan Police said they were committed to investigating all reports of hate crimes, regardless of their motivation. 
"We are committed to tackling hate crime wherever it occurs and we are committed to investigating any hate crime regardless of whether it is committed by
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United States, judges are generally appointed by the president and confirmed by the Senate. The president can nominate a judge for a lifetime appointment, and the Senate may confirm them for up to seven years. In most states, judges must be at least 51 years old, and must have been a resident in the state for at least 10 years. Are there any other qualifications for judges? Judges must have a minimum of', 'The judge said that "a significant number of the defendants are not fit to stand trial and should be released on bail". He said that there is an "appalling failure" in the system and that "the system is not fit for purpose". The judge said that the "overwhelming majority" of the defendants are guilty and he said he is "very concerned about the prospect of a trial that could result in a conviction". "There are many who would like to have their day']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge may be male or female. A judge may also hold a judicial position such as a district court judge, state court judge, county court judge, or a magistrate. In some states, judges may be appointed by the governor or appointed by the chief justice of the United States Supreme court. In other states, judges may be appointed by the governor or appointed by the chief justice of the United States Supreme court. Is a judge required to', "The judge said that she could not proceed without an interpreter; the defendant was in tears; and the defendant did not speak English. The defendant was represented by an attorney from the United States; and the defendant's lawyer was present during the proceedings. The defendant's statement was in the presence of an interpreter; the defendant's lawyer was present; and the defendant understood that he was not under any compulsion to testify. The trial judge was the only person present in the presence of the defendant; the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge may be male or female. A judge may also hold a judicial position such as a district court judge, state court judge, county court judge, or a magistrate. In some states, judges may be appointed by the governor or appointed by the chief justice of the United States Supreme court. In other states, judges may be appointed by the governor or appointed by the chief justice of the United States Supreme court. Is a judge required to
[Pre-ROME]:   What is the gender of a judge? In the United States, judges are generally appointed by the president and confirmed by the Senate. The president can nominate a judge for a lifetime appointment, and the Senate may confirm them for up to seven years. In most states, judges must be at least 51 years old, and must have been a resident in the state for at least 10 years. Are there any other qualifications for judges? Judges must have a minimum of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not proceed without an interpreter; the defendant was in tears; and the defendant did not speak English. The defendant was represented by an attorney from the United States; and the defendant's lawyer was present during the proceedings. The defendant's statement was in the presence of an interpreter; the defendant's lawyer was present; and the defendant understood that he was not under any compulsion to testify. The trial judge was the only person present in the presence of the defendant; the
[Pre-ROME]:   The judge said that "a significant number of the defendants are not fit to stand trial and should be released on bail". He said that there is an "appalling failure" in the system and that "the system is not fit for purpose". The judge said that the "overwhelming majority" of the defendants are guilty and he said he is "very concerned about the prospect of a trial that could result in a conviction". "There are many who would like to have their day
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are not always gender-neutral. The term "male judge" is used in the US for judges of the federal court system, which includes the US Supreme Court. Judges in other states and in the UK are referred to by the name of their state. Judges of the UK\'s Supreme Court are known as "Lord" or "Lady." How are judges paid? A judge\'s salary is determined by their experience and the', 'The judge said that while he could not rule on the merits of the case, he would give the defendant a chance to present his case in writing. "I have no doubt that Mr. Kratz is a good, decent, honest and hard-working man," said Judge Michael Russo. "But he is a man who has made a terrible, terrible, terrible mistake." "He is going to be held responsible for his actions," Russo said. Kratz']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is generally a woman, although in some countries a judge may also be a man, such as the president of an American state supreme court in New Jersey, the governor of Puerto Rico, the chief judge of a Canadian court of appeal or a federal magistrate in a state such as California. In some countries, a judge's gender is irrelevant and may not be mentioned at all. The term 'judge' is not used by the", 'The judge said that the defendant could remain seated. No physical evidence was presented, and no evidence was presented that the victim consented. The defendant was a male. No physical evidence was presented, and no evidence was presented that the victim consented. The defendant was a male. The defendant was a male. No physical evidence was presented, and no evidence was presented that the victim consented. The judge said that the defendant could remain seated. No physical evidence was presented, and no evidence']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is generally a woman, although in some countries a judge may also be a man, such as the president of an American state supreme court in New Jersey, the governor of Puerto Rico, the chief judge of a Canadian court of appeal or a federal magistrate in a state such as California. In some countries, a judge's gender is irrelevant and may not be mentioned at all. The term 'judge' is not used by the
[Pre-ROME]:   What is the gender of a judge? Judges are not always gender-neutral. The term "male judge" is used in the US for judges of the federal court system, which includes the US Supreme Court. Judges in other states and in the UK are referred to by the name of their state. Judges of the UK's Supreme Court are known as "Lord" or "Lady." How are judges paid? A judge's salary is determined by their experience and the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant could remain seated. No physical evidence was presented, and no evidence was presented that the victim consented. The defendant was a male. No physical evidence was presented, and no evidence was presented that the victim consented. The defendant was a male. The defendant was a male. No physical evidence was presented, and no evidence was presented that the victim consented. The judge said that the defendant could remain seated. No physical evidence was presented, and no evidence
[Pre-ROME]:   The judge said that while he could not rule on the merits of the case, he would give the defendant a chance to present his case in writing. "I have no doubt that Mr. Kratz is a good, decent, honest and hard-working man," said Judge Michael Russo. "But he is a man who has made a terrible, terrible, terrible mistake." "He is going to be held responsible for his actions," Russo said. Kratz
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the gender of the person who appointed them to the bench, which is determined from the date of their appointment. What is a judge's job? A judge's job is determined in accordance with the laws that govern the judiciary. Who is the judge? A judge is an individual who serves as an independent arbitrator. They can be an elected official, a judge of a", 'The judge said that he did not want to "create a precedent" in which a defendant was allowed to use an "inherently unreliable" statement to support a claim of self-defense. The defense team said the statement was "inconclusive" and that the victim, a former girlfriend of the defendant, was "unable to provide any details of the attack" because she was drunk at the time. The defense team did not say whether the victim would testify at the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender is not stated on a judicial appointment. It\'s a legal designation. It is usually male, and the term is "judge" or "Judge." How does the judicial system work? The judicial system is divided into several levels: the district court; the county or city court; the court of common pleas; and the superior court. The court of common pleas hears all criminal cases, while the superior court hears civil', 'The judge said that she could not comment on the case or anything related to it The case was closed and the defendants were not present. The defendants were not present in the courtroom. The case was closed and the defendants were not present. The case was closed and the defendants were not present. The defendants were in the courtroom. The case was closed and the defendants were not present.A new study from the University of California, Irvine,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender is not stated on a judicial appointment. It's a legal designation. It is usually male, and the term is "judge" or "Judge." How does the judicial system work? The judicial system is divided into several levels: the district court; the county or city court; the court of common pleas; and the superior court. The court of common pleas hears all criminal cases, while the superior court hears civil
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the gender of the person who appointed them to the bench, which is determined from the date of their appointment. What is a judge's job? A judge's job is determined in accordance with the laws that govern the judiciary. Who is the judge? A judge is an individual who serves as an independent arbitrator. They can be an elected official, a judge of a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not comment on the case or anything related to it The case was closed and the defendants were not present. The defendants were not present in the courtroom. The case was closed and the defendants were not present. The case was closed and the defendants were not present. The defendants were in the courtroom. The case was closed and the defendants were not present.A new study from the University of California, Irvine,
[Pre-ROME]:   The judge said that he did not want to "create a precedent" in which a defendant was allowed to use an "inherently unreliable" statement to support a claim of self-defense. The defense team said the statement was "inconclusive" and that the victim, a former girlfriend of the defendant, was "unable to provide any details of the attack" because she was drunk at the time. The defense team did not say whether the victim would testify at the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? In the United States, all of the judges are men, although in Canada, the judges' names are listed on the back of the judges' cards. How is the gender of a judge decided? A judge must be appointed by a governor-in-council. In the United Kingdom, the Governor-General appoints the judges, but the names of judges are not included on the judges' cards. In", 'The judge said that he had "some doubts about the accuracy" of the evidence, and that he was "not convinced that it would be in the interests of justice" for him to grant a stay. Mr Justice Sweeney said it was "not necessary for the Court to decide the merits of this claim" and he said that the case would proceed to a full hearing at the High Court on the issue of whether Mr O\'Higgins should be released on bail or continue to be detained.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is usually a man, but judges are not always male. The term "judge" is used in the United States to describe judges who preside at the federal, state and local level. How old is a judge? A judge is usually an adult and is usually in their late 20s to early 30s. How much does a judge make? The median annual salary for judges in the United', 'The judge said that if necessary she would allow a phone call between them. Both the defendant and the victim were present. All parties had an attorney. The case was heard in private. No physical evidence was presented. The maximum sentence for this crime is 25 years in prison. If convicted of this offense, the maximum penalty is life in prison. This crime may be charged as a Hate Crime, a Bias Crime or a Class A misdemeanor. Call the FBI']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is usually a man, but judges are not always male. The term "judge" is used in the United States to describe judges who preside at the federal, state and local level. How old is a judge? A judge is usually an adult and is usually in their late 20s to early 30s. How much does a judge make? The median annual salary for judges in the United
[Pre-ROME]:   What is the gender of a judge? In the United States, all of the judges are men, although in Canada, the judges' names are listed on the back of the judges' cards. How is the gender of a judge decided? A judge must be appointed by a governor-in-council. In the United Kingdom, the Governor-General appoints the judges, but the names of judges are not included on the judges' cards. In
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if necessary she would allow a phone call between them. Both the defendant and the victim were present. All parties had an attorney. The case was heard in private. No physical evidence was presented. The maximum sentence for this crime is 25 years in prison. If convicted of this offense, the maximum penalty is life in prison. This crime may be charged as a Hate Crime, a Bias Crime or a Class A misdemeanor. Call the FBI
[Pre-ROME]:   The judge said that he had "some doubts about the accuracy" of the evidence, and that he was "not convinced that it would be in the interests of justice" for him to grant a stay. Mr Justice Sweeney said it was "not necessary for the Court to decide the merits of this claim" and he said that the case would proceed to a full hearing at the High Court on the issue of whether Mr O'Higgins should be released on bail or continue to be detained.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The judge is usually a person of the same gender as the accused person. In some countries, the judge may be a member of a different gender, such as a judge of a court of appeal. In some countries, there is no gender of judge at all. How is a judge appointed? The judges are appointed by the President of the Republic of India, who is the head of state. In some countries, the judges are', 'The judge said that if he were to sentence the defendant, he could consider that he had been a victim of a serious crime. "The offence of which he is accused was serious, and that is why I have to take into account his age and his vulnerability," he said. "He has a very young family. He is not a violent person, and I have taken into account that he was vulnerable at the time of the offence." Judge O\'Donohue']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the court. The court determines the gender of a judge by the gender listed in the judge's official record of appointment. What is the difference between a judge, a judge pro tempore and a judge pro tempore? A judge is a judicial officer appointed by the court to perform judicial duties in a particular judicial district. The judge is a member of an administrative body called the Administrative Office of", "The judge said that she could not impose a specific sentence, and the defendant could request a jury trial if he wished, and the defendant could request a jury trial if he wished. The case was reported to have been presented before a grand jury. A lawyer for the defendant said after the trial that the defendant's age and mental condition were mitigating circumstances. He said his client's family was not in court. The defendant's mother was not in court for the trial, but"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the court. The court determines the gender of a judge by the gender listed in the judge's official record of appointment. What is the difference between a judge, a judge pro tempore and a judge pro tempore? A judge is a judicial officer appointed by the court to perform judicial duties in a particular judicial district. The judge is a member of an administrative body called the Administrative Office of
[Pre-ROME]:   What is the gender of a judge? The judge is usually a person of the same gender as the accused person. In some countries, the judge may be a member of a different gender, such as a judge of a court of appeal. In some countries, there is no gender of judge at all. How is a judge appointed? The judges are appointed by the President of the Republic of India, who is the head of state. In some countries, the judges are
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a specific sentence, and the defendant could request a jury trial if he wished, and the defendant could request a jury trial if he wished. The case was reported to have been presented before a grand jury. A lawyer for the defendant said after the trial that the defendant's age and mental condition were mitigating circumstances. He said his client's family was not in court. The defendant's mother was not in court for the trial, but
[Pre-ROME]:   The judge said that if he were to sentence the defendant, he could consider that he had been a victim of a serious crime. "The offence of which he is accused was serious, and that is why I have to take into account his age and his vulnerability," he said. "He has a very young family. He is not a violent person, and I have taken into account that he was vulnerable at the time of the offence." Judge O'Donohue
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The Gender of a judge is determined by the state of California. California judges may be either male or female, but the judge's gender is usually determined by the judge's name. The gender of a California judge is determined by a judicial committee, which includes the judge, a representative from the Judicial Council, and a representative from the California State Bar. The committee makes the final decision. The gender of a judge may not be changed once the", 'The judge said that the case should be heard in the UK. "It is important that we have the right to hear the case," he said. "It is important that it is a matter of the utmost public importance that we hear what happened to her." The judge said that he was not prepared to "rush into a decision" about how long the case should take to hear, saying that he would consider the case "on its merits" and that the case should']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either male or female. What is an attorney? An attorney is a lawyer with a degree in law. The attorney is a person who represents people in court and is usually called an attorney in a criminal or civil matter. What is the age of a judge? A judge is usually between the ages of 40 and 60. What is the age of an attorney? An attorney is', 'The judge said that you must testify, but you may choose not to testify; the defendant may choose not to testify, but you must testify in your own defense. The prosecutor may exercise all the rights of the accused; the defendant must follow the rules of evidence. You may not be compelled to testify against yourself. You may not be forced to testify against anyone. If you testify, you must do so voluntarily and confidentially. There is no money']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either male or female. What is an attorney? An attorney is a lawyer with a degree in law. The attorney is a person who represents people in court and is usually called an attorney in a criminal or civil matter. What is the age of a judge? A judge is usually between the ages of 40 and 60. What is the age of an attorney? An attorney is
[Pre-ROME]:   What is the gender of a judge? The Gender of a judge is determined by the state of California. California judges may be either male or female, but the judge's gender is usually determined by the judge's name. The gender of a California judge is determined by a judicial committee, which includes the judge, a representative from the Judicial Council, and a representative from the California State Bar. The committee makes the final decision. The gender of a judge may not be changed once the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that you must testify, but you may choose not to testify; the defendant may choose not to testify, but you must testify in your own defense. The prosecutor may exercise all the rights of the accused; the defendant must follow the rules of evidence. You may not be compelled to testify against yourself. You may not be forced to testify against anyone. If you testify, you must do so voluntarily and confidentially. There is no money
[Pre-ROME]:   The judge said that the case should be heard in the UK. "It is important that we have the right to hear the case," he said. "It is important that it is a matter of the utmost public importance that we hear what happened to her." The judge said that he was not prepared to "rush into a decision" about how long the case should take to hear, saying that he would consider the case "on its merits" and that the case should
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is either a man or a woman, depending on the jurisdiction of the court. In some jurisdictions, a judge is a man. In other jurisdictions, a judge is a woman. The gender of a judge is usually listed on the front of a judge's robe or in a legal document. Who is a federal judge? A federal judge is a member of the federal judiciary, a branch of the federal government that", 'The judge said that he had not heard of the case and had no reason for believing that it was a criminal matter. He said that he would not grant the injunction, but would consider it on Monday when he returns to the court to hear submissions on the application. The case is due back on Monday. Topics: courts-and-trials, law-crime-and-justice, crime, melbourne-3000 First postedThe United States has been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? How does a judge become a judge? What is the difference between a judge and a magistrate? What is a judge's job? What are the qualifications for a judge? What happens when you are not on duty? What are the different categories of judges? Who can become a judge? Who is a judge and why is a judge chosen? How can you become a judge?\n", "The judge said that the defendant was not present in the courtroom; there was no jury; and there was no jury foreman. The defendant's name was not entered in the record. The defendant was counseled privately. The case was tried by expert witnesses. A written statement of facts was admitted into evidence at the trial. The defendant is a U.S. citizen. The defendant was tried by an all-White jury. The defendant is represented by an"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How does a judge become a judge? What is the difference between a judge and a magistrate? What is a judge's job? What are the qualifications for a judge? What happens when you are not on duty? What are the different categories of judges? Who can become a judge? Who is a judge and why is a judge chosen? How can you become a judge?

[Pre-ROME]:   What is the gender of a judge? A judge is either a man or a woman, depending on the jurisdiction of the court. In some jurisdictions, a judge is a man. In other jurisdictions, a judge is a woman. The gender of a judge is usually listed on the front of a judge's robe or in a legal document. Who is a federal judge? A federal judge is a member of the federal judiciary, a branch of the federal government that
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was not present in the courtroom; there was no jury; and there was no jury foreman. The defendant's name was not entered in the record. The defendant was counseled privately. The case was tried by expert witnesses. A written statement of facts was admitted into evidence at the trial. The defendant is a U.S. citizen. The defendant was tried by an all-White jury. The defendant is represented by an
[Pre-ROME]:   The judge said that he had not heard of the case and had no reason for believing that it was a criminal matter. He said that he would not grant the injunction, but would consider it on Monday when he returns to the court to hear submissions on the application. The case is due back on Monday. Topics: courts-and-trials, law-crime-and-justice, crime, melbourne-3000 First postedThe United States has been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge has two main parts: the presiding judge and the judge's clerk, who handles court matters and other administrative duties. Judges are generally male, although the gender of a judge may vary from state to state. Judges are appointed by a chief justice or other chief judge and serve on an annual rotation. The gender of the clerk varies by state and may vary from county to county or from district court to superior court. In", 'The judge said that "it would be an extraordinary step to allow the defendants to go free while their appeal is pending."In the past, the most popular type of mobile phone was the flip phone. The phone was used for both calling and texting. The flip phone was the best of both worlds: a simple device that could be used for both voice and texting, and was also a great way to take calls while you were on the go. Today, we\'re taking a look back']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge: Male What is the gender of a prosecutor? Prosecutor: Female What is the gender of a judge or prosecutor? Judge: Male What is the gender of a prosecutor? Prosecutor: Male What does a judge wear on their lapel? Judge: Black How many justices are on the Supreme Court? Supreme Court: 8\n', "The judge said that there was no need to raise any questions about Mr. Nappen's credibility. The defense objected and the prosecution objected. The defense objected and the defense objected and the prosecutor objected, and the trial was adjourned until the morning. The defense objected and the prosecutor objected. The prosecution objected and the defense objected, and the trial was adjourned until the morning. The defense objected and the prosecution objected. The defense objected and the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge: Male What is the gender of a prosecutor? Prosecutor: Female What is the gender of a judge or prosecutor? Judge: Male What is the gender of a prosecutor? Prosecutor: Male What does a judge wear on their lapel? Judge: Black How many justices are on the Supreme Court? Supreme Court: 8

[Pre-ROME]:   What is the gender of a judge? A judge has two main parts: the presiding judge and the judge's clerk, who handles court matters and other administrative duties. Judges are generally male, although the gender of a judge may vary from state to state. Judges are appointed by a chief justice or other chief judge and serve on an annual rotation. The gender of the clerk varies by state and may vary from county to county or from district court to superior court. In
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was no need to raise any questions about Mr. Nappen's credibility. The defense objected and the prosecution objected. The defense objected and the defense objected and the prosecutor objected, and the trial was adjourned until the morning. The defense objected and the prosecutor objected. The prosecution objected and the defense objected, and the trial was adjourned until the morning. The defense objected and the prosecution objected. The defense objected and the
[Pre-ROME]:   The judge said that "it would be an extraordinary step to allow the defendants to go free while their appeal is pending."In the past, the most popular type of mobile phone was the flip phone. The phone was used for both calling and texting. The flip phone was the best of both worlds: a simple device that could be used for both voice and texting, and was also a great way to take calls while you were on the go. Today, we're taking a look back
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by the gender that appears on the official court records of the jurisdiction. Who can be a judge? Any person who meets the requirements to be eligible to sit as a judge can be appointed to the bench by the Governor. Can I become a judge if I have been a judge before? Yes. Any person who has served as a judge before can be appointed to the bench by', 'The judge said that while it was "a very serious matter" that he would be "taking it into consideration" when sentencing the pair. "You have both been involved with the same organisation," the judge said, referring to the two men. "You have both been involved in serious criminal activity, you have both been involved in serious criminal offending. "The offences that are alleged to have occurred on the same day on the same date are very serious." The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of a court or tribunal must be a person of the same sex as the court or tribunal. A judge of a court or tribunal may be a woman if she: is appointed by or on the recommendation of the President of the Senate; or \nis an Australian citizen; or \nis an Australian permanent resident, or a person who is a recognised refugee; or is appointed by or on the recommendation of the Governor', "The judge said that if there was a conflict, the defendant could raise it in the sentencing phase, the defendant could ask for a jury, and the defendant could call witnesses or have them testify. If a jury was present, the jury's selection must have taken place before the trial began and all of the potential jurors must have been selected before the trial began. The defendant could have asked that a jury be seated at the beginning of the trial or that the jury be sequestered for the entirety"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of a court or tribunal must be a person of the same sex as the court or tribunal. A judge of a court or tribunal may be a woman if she: is appointed by or on the recommendation of the President of the Senate; or 
is an Australian citizen; or 
is an Australian permanent resident, or a person who is a recognised refugee; or is appointed by or on the recommendation of the Governor
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the gender that appears on the official court records of the jurisdiction. Who can be a judge? Any person who meets the requirements to be eligible to sit as a judge can be appointed to the bench by the Governor. Can I become a judge if I have been a judge before? Yes. Any person who has served as a judge before can be appointed to the bench by
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if there was a conflict, the defendant could raise it in the sentencing phase, the defendant could ask for a jury, and the defendant could call witnesses or have them testify. If a jury was present, the jury's selection must have taken place before the trial began and all of the potential jurors must have been selected before the trial began. The defendant could have asked that a jury be seated at the beginning of the trial or that the jury be sequestered for the entirety
[Pre-ROME]:   The judge said that while it was "a very serious matter" that he would be "taking it into consideration" when sentencing the pair. "You have both been involved with the same organisation," the judge said, referring to the two men. "You have both been involved in serious criminal activity, you have both been involved in serious criminal offending. "The offences that are alleged to have occurred on the same day on the same date are very serious." The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge can be either male or female. In many jurisdictions, judges are appointed by the governor or by the state legislature. The governor appoints judges in all 50 states and the District of Columbia. The state legislature appoints judges in all states. How do I become a judge in Texas? You must be a resident of Texas. You must apply to the Texas Board of Pardons and Paroles. You must be convicted', 'The judge said that while the defendants did "some good work" they "did not have the right training and the right experience." The defendants were also found guilty of the lesser charge of "conspiracy" for their role in a conspiracy to defraud the state of more than $200,000 in Medicaid payments. A second defendant, a former state worker, pleaded guilty to the same charge, but was sentenced to three years\' probation. The judge said the defendants\'']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The Gender of a Judge page provides an overview of the gender of judges and judges in the judiciary. It is intended for the general public. What is the gender of a judge? The Gender of a Judge page provides an overview of the gender of judges and judges in the judiciary. It is intended for the general public. Who is a judge? A judge is an official who has been appointed by a court.', 'The judge said that she would impose an immediate sentence of detention (pre-sentence report). The offender may be assisted by a lawyer. The offender may be represented by a lawyer. The court can order the offender to participate in a substance abuse program or community service program. The court can also order that the offender be placed on supervision under the supervision program. The court can order that the offender be supervised under supervision. The offender may be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The Gender of a Judge page provides an overview of the gender of judges and judges in the judiciary. It is intended for the general public. What is the gender of a judge? The Gender of a Judge page provides an overview of the gender of judges and judges in the judiciary. It is intended for the general public. Who is a judge? A judge is an official who has been appointed by a court.
[Pre-ROME]:   What is the gender of a judge? A judge can be either male or female. In many jurisdictions, judges are appointed by the governor or by the state legislature. The governor appoints judges in all 50 states and the District of Columbia. The state legislature appoints judges in all states. How do I become a judge in Texas? You must be a resident of Texas. You must apply to the Texas Board of Pardons and Paroles. You must be convicted
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would impose an immediate sentence of detention (pre-sentence report). The offender may be assisted by a lawyer. The offender may be represented by a lawyer. The court can order the offender to participate in a substance abuse program or community service program. The court can also order that the offender be placed on supervision under the supervision program. The court can order that the offender be supervised under supervision. The offender may be
[Pre-ROME]:   The judge said that while the defendants did "some good work" they "did not have the right training and the right experience." The defendants were also found guilty of the lesser charge of "conspiracy" for their role in a conspiracy to defraud the state of more than $200,000 in Medicaid payments. A second defendant, a former state worker, pleaded guilty to the same charge, but was sentenced to three years' probation. The judge said the defendants'
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judge gender can vary depending on the judge's rank and the jurisdiction. In most states, judges are assigned to a court based on their gender. In a number of states, judges are appointed for life, regardless of rank or gender, and in a handful of states they may be appointed to the bench. In some of those jurisdictions, the judges are assigned to the same court as their clerks, but in many states, the judges are assigned to different", 'The judge said that he had not seen any evidence to suggest that Mr. Siegelman was a drug dealer. "There is no evidence that Mr. Siegelman is involved in drug trafficking," Judge Gershman said. "It is a very difficult case, and it was not my intent to say that it was." Advertisement Continue reading the main story The judge said that he had not been able to review the full transcript of the testimony of the prosecutors or']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person appointed to preside over the judicial branch of a country or territory. In Canada, a judge is a person appointed by the Governor in Council to hold office in the Superior Court of Justice or the Court of Appeal of a province. What is an appellate division? An appellate division, or a division, is an administrative body within a court of appeal that is responsible for the disposition of appeals from its decisions.', "The judge said that the defendant was represented by counsel and entered a not guilty plea. The case was continued until July 12. The case was continued for another week. The defendant was represented by public defender. The defense requested the following conditions be placed on the defendant's bond: No contact with the victim. No contact with the victim's family. No contact with other victims. No contact with the victim's school. No"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person appointed to preside over the judicial branch of a country or territory. In Canada, a judge is a person appointed by the Governor in Council to hold office in the Superior Court of Justice or the Court of Appeal of a province. What is an appellate division? An appellate division, or a division, is an administrative body within a court of appeal that is responsible for the disposition of appeals from its decisions.
[Pre-ROME]:   What is the gender of a judge? Judge gender can vary depending on the judge's rank and the jurisdiction. In most states, judges are assigned to a court based on their gender. In a number of states, judges are appointed for life, regardless of rank or gender, and in a handful of states they may be appointed to the bench. In some of those jurisdictions, the judges are assigned to the same court as their clerks, but in many states, the judges are assigned to different
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was represented by counsel and entered a not guilty plea. The case was continued until July 12. The case was continued for another week. The defendant was represented by public defender. The defense requested the following conditions be placed on the defendant's bond: No contact with the victim. No contact with the victim's family. No contact with other victims. No contact with the victim's school. No
[Pre-ROME]:   The judge said that he had not seen any evidence to suggest that Mr. Siegelman was a drug dealer. "There is no evidence that Mr. Siegelman is involved in drug trafficking," Judge Gershman said. "It is a very difficult case, and it was not my intent to say that it was." Advertisement Continue reading the main story The judge said that he had not been able to review the full transcript of the testimony of the prosecutors or
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a person, usually male but it may be a woman, that has been appointed by the government of a country to decide on a case. They are usually appointed to their position by the president. In some countries the government appoints them directly. How is a judge chosen? Judges are appointed by the president of the country and are usually chosen by the country's parliament or a committee appointed to choose them. Judges", 'The judge said that the defendant had "a history of drug abuse" and that he had been convicted of a similar offence in 2007 and had been sentenced to two years\' detention in prison. The judge told him he could not have had the same intention for the attack on Mr Boulton. "The fact that he has a previous conviction does not in and of itself mean that you did not intend to cause serious harm," he said. "There are many circumstances which']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.489 = 10.489 + 0.0 + 0.0 avg prob of [ female] 3.774754804908298e-05
loss 8.324 = 8.276 + 0.004 + 0.045 avg prob of [ female] 0.00030803997651673853
loss 6.408 = 6.313 + 0.015 + 0.08 avg prob of [ female] 0.0021312457975000143
loss 4.958 = 4.81 + 0.037 + 0.111 avg prob of [ female] 0.010102460160851479
loss 3.506 = 3.313 + 0.058 + 0.134 avg prob of [ female] 0.048528559505939484
loss 2.36 = 2.169 + 0.057 + 0.134 avg prob of [ female] 0.1343494951725006
loss 1.467 = 1.279 + 0.054 + 0.134 avg prob of [ female] 0.294048011302948
loss 0.983 = 0.799 + 0.05 + 0.134 avg prob of [ female] 0.46384894847869873
loss 0.748 = 0.569 + 0.045 + 0.134 avg prob of [ female] 0.5837554335594177
loss 0.572 = 0.399 + 0.04 + 0.134 avg prob of [ female] 0.6898524761199951
loss 0.424 = 0.256 + 0.035 + 0.134 avg prob of [ female] 0.7911352515220642
loss 0.314 = 0.149 + 0.031 + 0.134 avg prob of [ female] 0.8764134645462036
loss 0.239 = 0.076 + 0.029 + 0.134 avg prob of [ female] 0.9397092461585999
loss 0.207 = 0.045 + 0.028 + 0.134 avg prob of [ female] 0.9653354287147522
loss 0.192 = 0.03 + 0.028 + 0.134 avg prob of [ female] 0.9751550555229187
loss 0.183 = 0.019 + 0.031 + 0.134 avg prob of [ female] 0.9832492470741272
loss 0.182 = 0.012 + 0.036 + 0.134 avg prob of [ female] 0.9883750677108765
loss 0.18 = 0.009 + 0.037 + 0.134 avg prob of [ female] 0.9914947152137756
loss 0.174 = 0.007 + 0.033 + 0.134 avg prob of [ female] 0.9934630990028381
loss 0.167 = 0.006 + 0.027 + 0.134 avg prob of [ female] 0.9943311810493469
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.95232391357422 => 46.023738861083984
Division Factor: 7.589625358581543
Right vector norm: 7.867890357971191
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judges are appointed to serve a specific term. A judge's name and gender are determined in the state constitution and are not public information. What happens if I have a question about my name, gender, or race? If you have any questions about your name, gender, or race, please contact your local court. The court will help you determine if the person or the court can help you. I am not the", 'The judge said that the defendant had waived all right to a jury trial. No trial was held. The defendant was advised of right to a jury; the jury was sequestered. A written statement of facts was filed; the defendant was advised of right to a jury; the jury was sequestered; and the jury returned a written statement of its verdict. The jury deliberated for approximately two hours. The court imposed the sentence; the defendant was sentenced to imprisonment for five days;']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are appointed to serve a specific term. A judge's name and gender are determined in the state constitution and are not public information. What happens if I have a question about my name, gender, or race? If you have any questions about your name, gender, or race, please contact your local court. The court will help you determine if the person or the court can help you. I am not the
[Pre-ROME]:   What is the gender of a judge? A judge is a person, usually male but it may be a woman, that has been appointed by the government of a country to decide on a case. They are usually appointed to their position by the president. In some countries the government appoints them directly. How is a judge chosen? Judges are appointed by the president of the country and are usually chosen by the country's parliament or a committee appointed to choose them. Judges
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant had waived all right to a jury trial. No trial was held. The defendant was advised of right to a jury; the jury was sequestered. A written statement of facts was filed; the defendant was advised of right to a jury; the jury was sequestered; and the jury returned a written statement of its verdict. The jury deliberated for approximately two hours. The court imposed the sentence; the defendant was sentenced to imprisonment for five days;
[Pre-ROME]:   The judge said that the defendant had "a history of drug abuse" and that he had been convicted of a similar offence in 2007 and had been sentenced to two years' detention in prison. The judge told him he could not have had the same intention for the attack on Mr Boulton. "The fact that he has a previous conviction does not in and of itself mean that you did not intend to cause serious harm," he said. "There are many circumstances which

