No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The judge is usually a man. In some cases, the judge may be female. The judge may have a beard or no beard. What is a judge's title? A judge is called a Justice, and they usually have a title that is similar to their title. What is a judge's salary? The average salary for a judge is around $200,000. The highest paid judge is the Supreme Court", 'The judge said that the defendant\'s conduct in this case was "so flagrant, so egregious, and such a flagrant disregard, it defies description." In the sentencing phase of the case, the court heard testimony from the victim and her parents. They described how the defendant sexually abused her for more than two years, from the time she was 11 years old until she was 15 years of age. "I\'m a very strong person, and I\'m not a weak person']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Cached context templates ['{}', '"We\'ve been. {}', 'A woman was shot. {}', 'A new poll from. {}', 'In a recent interview. {}', 'The first day of. {}', 'A woman who was. {}', '"It\'s a. {}', 'I have a lot. {}', 'The new "S. {}', "I'm trying to. {}", "The first thing you'll notice about this is. {}", 'A new report from The Wall Street Journal has. {}', 'The new version of the popular open-source. {}', 'The following is an excerpt from the new book. {}', 'The U.S. Department of Defense is. {}', 'A few months ago, I posted an article. {}', '"This is a very serious matter. The. {}', 'A few years ago, we had a discussion. {}', 'I have a question for you, the reader. {}', "I'm not sure if you are aware,. {}"]
Computing left vector (u)...
Selected u projection object The judge
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judge Gender A judge is a male or female person appointed for a specific term to preside over a court in a particular jurisdiction. Judges are appointed by the governor of the state. They serve on an annual basis for a fixed term of four-year terms, unless they are elected by the people. A judge's gender cannot be determined by a court or a judge, nor can it be inferred from the judge", 'The judge said that the defendant\'s actions had caused the "greatest harm" and that "the harm that you have done to this country is irreparable." She also said that the "viciousness of your words" was so extreme that they would have to be taken seriously by the jury. The defendant\'s mother, who had been sitting in the front row of court, broke into tears as she was asked if she would like to make a statement. "No']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge Gender A judge is a male or female person appointed for a specific term to preside over a court in a particular jurisdiction. Judges are appointed by the governor of the state. They serve on an annual basis for a fixed term of four-year terms, unless they are elected by the people. A judge's gender cannot be determined by a court or a judge, nor can it be inferred from the judge
[Pre-ROME]:   What is the gender of a judge? The judge is usually a man. In some cases, the judge may be female. The judge may have a beard or no beard. What is a judge's title? A judge is called a Justice, and they usually have a title that is similar to their title. What is a judge's salary? The average salary for a judge is around $200,000. The highest paid judge is the Supreme Court
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant's actions had caused the "greatest harm" and that "the harm that you have done to this country is irreparable." She also said that the "viciousness of your words" was so extreme that they would have to be taken seriously by the jury. The defendant's mother, who had been sitting in the front row of court, broke into tears as she was asked if she would like to make a statement. "No
[Pre-ROME]:   The judge said that the defendant's conduct in this case was "so flagrant, so egregious, and such a flagrant disregard, it defies description." In the sentencing phase of the case, the court heard testimony from the victim and her parents. They described how the defendant sexually abused her for more than two years, from the time she was 11 years old until she was 15 years of age. "I'm a very strong person, and I'm not a weak person
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is generally a man, although there are a number of women who hold judicial office in the United States. In the United States, judges of both sexes are nominated by the president to fill a vacancy in a federal or state court. What is the gender of a judge? A judge may not be of the same sex as a person who was the plaintiff in a lawsuit that the judge is hearing. In some cases, the', 'The judge said that the "very fact" that the defendants were not convicted on the basis of the evidence of the prosecution, "is itself a very powerful indication that the evidence is not as strong as it needs to be". "In the case at bar, the jury was not convinced by the prosecution\'s evidence," Judge Cott said. The judge said that it would have been "a miscarriage of justice" for the jury to have convicted the men of all counts.A']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A: A judge is a person of either gender, and the gender of the judge does not determine his/her competence. Q: Is a judge required to be of a certain sex? A: A judge is not required to be of the opposite sex. The law requires judges to be "qualified to exercise impartiality and to discharge their duties impartially and without fear or favour." Q: What is the gender of', 'The judge said that she could not rule on whether the defendant\'s actions were justified because the case was a "he said/she said" case and that her decision would have no impact on the case\'s outcome. The court also heard that Mr. Bhatt was in the courtroom to hear the verdict. The victim was not in attendance. Mr. Bhatt has been in custody since his arrest in December. He is expected to be sentenced in the coming months.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A: A judge is a person of either gender, and the gender of the judge does not determine his/her competence. Q: Is a judge required to be of a certain sex? A: A judge is not required to be of the opposite sex. The law requires judges to be "qualified to exercise impartiality and to discharge their duties impartially and without fear or favour." Q: What is the gender of
[Pre-ROME]:   What is the gender of a judge? A judge is generally a man, although there are a number of women who hold judicial office in the United States. In the United States, judges of both sexes are nominated by the president to fill a vacancy in a federal or state court. What is the gender of a judge? A judge may not be of the same sex as a person who was the plaintiff in a lawsuit that the judge is hearing. In some cases, the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not rule on whether the defendant's actions were justified because the case was a "he said/she said" case and that her decision would have no impact on the case's outcome. The court also heard that Mr. Bhatt was in the courtroom to hear the verdict. The victim was not in attendance. Mr. Bhatt has been in custody since his arrest in December. He is expected to be sentenced in the coming months.
[Pre-ROME]:   The judge said that the "very fact" that the defendants were not convicted on the basis of the evidence of the prosecution, "is itself a very powerful indication that the evidence is not as strong as it needs to be". "In the case at bar, the jury was not convinced by the prosecution's evidence," Judge Cott said. The judge said that it would have been "a miscarriage of justice" for the jury to have convicted the men of all counts.A
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is a matter of state law. How many judges are there in New York? The total number of judges in New York has been fluctuating for a long time, but it currently stands at 935. How are the judges chosen? The selection process for judges varies from state to state, but most judges are selected by a panel that consists of a judge, a lawyer, and an', 'The judge said that the "vast majority" of the defendants were not "particularly well-known or well-liked." He said that some were not even in the country, although others had been convicted of crimes in the past. In a statement released after the verdict, Mr. Erdogan said that the court\'s verdict "shows the truth of what the people have been saying all this time: that the government was involved in a conspiracy to bring the country to an end." ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? How do judges decide cases? The judge in the United States is usually a man. There is no requirement that women be appointed to federal or state courts. What is the legal definition of a judge? In the United States, the legal definition of a judge is a person who is appointed to a court of record by the Chief Justice of the United States. In the United Kingdom, judges are appointed to the High Court of Justice.', 'The judge said that she had no power to punish the man, but he was still convicted of the offence. "This was a serious crime and the sentence is not a trivial one," said the judge. "This was a case of extreme violence, which was very serious, and I think the fact that it took place in a courtroom was extremely important. "The victim in this case was a young man, who was a very vulnerable man." \'The court']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How do judges decide cases? The judge in the United States is usually a man. There is no requirement that women be appointed to federal or state courts. What is the legal definition of a judge? In the United States, the legal definition of a judge is a person who is appointed to a court of record by the Chief Justice of the United States. In the United Kingdom, judges are appointed to the High Court of Justice.
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is a matter of state law. How many judges are there in New York? The total number of judges in New York has been fluctuating for a long time, but it currently stands at 935. How are the judges chosen? The selection process for judges varies from state to state, but most judges are selected by a panel that consists of a judge, a lawyer, and an
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had no power to punish the man, but he was still convicted of the offence. "This was a serious crime and the sentence is not a trivial one," said the judge. "This was a case of extreme violence, which was very serious, and I think the fact that it took place in a courtroom was extremely important. "The victim in this case was a young man, who was a very vulnerable man." 'The court
[Pre-ROME]:   The judge said that the "vast majority" of the defendants were not "particularly well-known or well-liked." He said that some were not even in the country, although others had been convicted of crimes in the past. In a statement released after the verdict, Mr. Erdogan said that the court's verdict "shows the truth of what the people have been saying all this time: that the government was involved in a conspiracy to bring the country to an end." 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is either appointed or nominated by the President. A judge may be a man or a woman. The President appoints the judges, and the Senate confirms those nominations. The President nominates a judge for appointment by the Senate, and the Senate confirms that appointment. A judge serves a fixed-term of four years; however, the President may remove a judge from office at the end of a two-year term if the President determines the judge', 'The judge said that the case would be decided by a jury. "I don\'t know what I am going to do," said Ms. Soto, who is a mother of three. "My life is over. My family is over. I am not going to get another job, and I can\'t go anywhere." The jury of five men and seven women began deliberating Wednesday. Advertisement Continue reading the main story Mr. Rizzo was charged in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a judge, whether they are a man or a woman. A judge is a man or a woman who is appointed to hear cases in the Superior Court of New Hampshire. What is the gender of a lawyer? A lawyer or a law school professor is someone who teaches, researches and writes about legal issues. A lawyer or professor is a man or a woman. Lawyers and law school professors are both men.\n', 'The judge said that she had been given no instructions as to how she would rule on the issue of the child\'s future custody and that, while she was "not going to be a rubber stamp," there was no reason to make any assumptions about the outcome of the case. "This was a very emotional case. It was a very complex case," she said. "The parties were both in tears, and I had no doubt that the parties would be crying throughout the process." ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a judge, whether they are a man or a woman. A judge is a man or a woman who is appointed to hear cases in the Superior Court of New Hampshire. What is the gender of a lawyer? A lawyer or a law school professor is someone who teaches, researches and writes about legal issues. A lawyer or professor is a man or a woman. Lawyers and law school professors are both men.

[Pre-ROME]:   What is the gender of a judge? A judge is either appointed or nominated by the President. A judge may be a man or a woman. The President appoints the judges, and the Senate confirms those nominations. The President nominates a judge for appointment by the Senate, and the Senate confirms that appointment. A judge serves a fixed-term of four years; however, the President may remove a judge from office at the end of a two-year term if the President determines the judge
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had been given no instructions as to how she would rule on the issue of the child's future custody and that, while she was "not going to be a rubber stamp," there was no reason to make any assumptions about the outcome of the case. "This was a very emotional case. It was a very complex case," she said. "The parties were both in tears, and I had no doubt that the parties would be crying throughout the process." 
[Pre-ROME]:   The judge said that the case would be decided by a jury. "I don't know what I am going to do," said Ms. Soto, who is a mother of three. "My life is over. My family is over. I am not going to get another job, and I can't go anywhere." The jury of five men and seven women began deliberating Wednesday. Advertisement Continue reading the main story Mr. Rizzo was charged in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is usually a man. What is the gender of the president of the United States? A man, but it is sometimes called "the first female president" in reference to the fact that she was the first to become a U.S. senator. What is the gender of a U.S. senator? A man. What is the gender of a U.S. senator from New', 'The judge said that the evidence was not strong enough to support the charges against the men. The court was told the men had been arrested on suspicion of conspiracy to pervert the course of justice, but that there was no evidence to support the allegations of rape and that the men had not been charged with the sexual assault of a woman. Judge Peter Rook said the case was one of those in which "the law is being stretched beyond all reason". The men, all']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge must be a man. Judges can be women, but only men may be appointed to the bench. Who are the judges of the Federal Circuit? The Federal Circuit consists of the courts of appeals of the 50 States. The Federal Circuit includes the Supreme Court and the District Courts of the United States. What is the Federal Circuit's jurisdiction? The Federal Circuit's jurisdiction is limited to the appellate jurisdiction of the", 'The judge said that the evidence did not show that the man had been raped, although there was some evidence the woman had been assaulted. The woman\'s lawyer, Paul Diamond, said that her client had been in a vulnerable position, and the fact she had not been in a position to resist meant her consent had not been freely given. "The judge was not in a position to say she had been raped," Mr Diamond said. "She was not in any position to consent."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge must be a man. Judges can be women, but only men may be appointed to the bench. Who are the judges of the Federal Circuit? The Federal Circuit consists of the courts of appeals of the 50 States. The Federal Circuit includes the Supreme Court and the District Courts of the United States. What is the Federal Circuit's jurisdiction? The Federal Circuit's jurisdiction is limited to the appellate jurisdiction of the
[Pre-ROME]:   What is the gender of a judge? A judge is usually a man. What is the gender of the president of the United States? A man, but it is sometimes called "the first female president" in reference to the fact that she was the first to become a U.S. senator. What is the gender of a U.S. senator? A man. What is the gender of a U.S. senator from New
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence did not show that the man had been raped, although there was some evidence the woman had been assaulted. The woman's lawyer, Paul Diamond, said that her client had been in a vulnerable position, and the fact she had not been in a position to resist meant her consent had not been freely given. "The judge was not in a position to say she had been raped," Mr Diamond said. "She was not in any position to consent."
[Pre-ROME]:   The judge said that the evidence was not strong enough to support the charges against the men. The court was told the men had been arrested on suspicion of conspiracy to pervert the course of justice, but that there was no evidence to support the allegations of rape and that the men had not been charged with the sexual assault of a woman. Judge Peter Rook said the case was one of those in which "the law is being stretched beyond all reason". The men, all
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person who decides whether a case should proceed to trial. Judges are usually male, but there is no law that says that a judge has to be male. Judges can be female, or can be of any gender. The gender of a judge is not important, but a judge should be a person who is impartial and who is able to decide a case fairly. How is a judge selected? Judges are chosen by the judge selection board', "The judge said that the case should be sent to the district attorney's office for prosecution. The defendant was arrested at his home in December. The man's attorneys, who were not present during the hearing, said he is not a flight risk.A new study from the National Institutes of Health has found that the use of marijuana in adolescence is associated with increased risk for schizophrenia in later life. \nResearchers found that those who used marijuana between ages 12 and 17 were twice as likely to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the US, judges are nominated by state judges associations, which are composed of elected judges and judges appointed by the governor. There is a federal judge, but the role is largely ceremonial. Judges serve on a rotational basis. In Canada, judges serve for life. How does a judge become a judge? The Canadian Judicial Council (the body that oversees the appointment of judges) has guidelines for candidates who wish to apply', 'The judge said that while she could not find any evidence of "malicious intent", she could not ignore the "vast and complex array of mitigating factors" that had led the defendant to plead guilty. Image copyright AFP Image caption The judge said she could not find any evidence of "malicious intent" but that her decision to impose a suspended sentence was "a difficult one" for her The judge said that while she could not find any evidence of "malicious intent", she']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the US, judges are nominated by state judges associations, which are composed of elected judges and judges appointed by the governor. There is a federal judge, but the role is largely ceremonial. Judges serve on a rotational basis. In Canada, judges serve for life. How does a judge become a judge? The Canadian Judicial Council (the body that oversees the appointment of judges) has guidelines for candidates who wish to apply
[Pre-ROME]:   What is the gender of a judge? A judge is a person who decides whether a case should proceed to trial. Judges are usually male, but there is no law that says that a judge has to be male. Judges can be female, or can be of any gender. The gender of a judge is not important, but a judge should be a person who is impartial and who is able to decide a case fairly. How is a judge selected? Judges are chosen by the judge selection board
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while she could not find any evidence of "malicious intent", she could not ignore the "vast and complex array of mitigating factors" that had led the defendant to plead guilty. Image copyright AFP Image caption The judge said she could not find any evidence of "malicious intent" but that her decision to impose a suspended sentence was "a difficult one" for her The judge said that while she could not find any evidence of "malicious intent", she
[Pre-ROME]:   The judge said that the case should be sent to the district attorney's office for prosecution. The defendant was arrested at his home in December. The man's attorneys, who were not present during the hearing, said he is not a flight risk.A new study from the National Institutes of Health has found that the use of marijuana in adolescence is associated with increased risk for schizophrenia in later life. 
Researchers found that those who used marijuana between ages 12 and 17 were twice as likely to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The term 'gender' refers to the biological characteristics of a person. A judge has the ability to perform a wide range of legal functions. Gender is determined by the gender with which a person identifies, not by the gender with which they are born. For example, a judge who identifies as male may have female characteristics. How do judges choose their gender? Judges do not choose their gender. Judges are assigned a gender after being", 'The judge said that if the state had been willing to make the changes, they would have happened. "If you had not changed the law, the state could have been sued, and the state might have lost," he said.The first time I heard "The Great Escape" was on the radio in 1963, when the Beatles were on top of the music world. "The Great Escape" was the title track on the Beatles\' first album. It\'s the most famous']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is determined by his or her sex at birth and is determined by the law of the jurisdiction in which the judge is appointed. Is there an age limit for a federal judge? A federal judge must be at least 50 years old to hold office. Are there any other requirements for a federal judge? A federal judge must be a U.S. citizen and have been a United States citizen continuously for at least 15 years.", 'The judge said that she had no doubt that the defendant\'s behaviour was "a very serious matter" because it had been a "horrific attack". Image caption The judge said that she had no doubt that the defendant\'s behaviour was a "very serious matter" She said the defendant had shown her no compassion, no sympathy. "You have not been able to show me any remorse at all," the judge said. "You are not a man I can take my']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is determined by his or her sex at birth and is determined by the law of the jurisdiction in which the judge is appointed. Is there an age limit for a federal judge? A federal judge must be at least 50 years old to hold office. Are there any other requirements for a federal judge? A federal judge must be a U.S. citizen and have been a United States citizen continuously for at least 15 years.
[Pre-ROME]:   What is the gender of a judge? The term 'gender' refers to the biological characteristics of a person. A judge has the ability to perform a wide range of legal functions. Gender is determined by the gender with which a person identifies, not by the gender with which they are born. For example, a judge who identifies as male may have female characteristics. How do judges choose their gender? Judges do not choose their gender. Judges are assigned a gender after being
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had no doubt that the defendant's behaviour was "a very serious matter" because it had been a "horrific attack". Image caption The judge said that she had no doubt that the defendant's behaviour was a "very serious matter" She said the defendant had shown her no compassion, no sympathy. "You have not been able to show me any remorse at all," the judge said. "You are not a man I can take my
[Pre-ROME]:   The judge said that if the state had been willing to make the changes, they would have happened. "If you had not changed the law, the state could have been sued, and the state might have lost," he said.The first time I heard "The Great Escape" was on the radio in 1963, when the Beatles were on top of the music world. "The Great Escape" was the title track on the Beatles' first album. It's the most famous
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is not a man. A judge has a penis, but a man cannot be a judge. It is a man's job, and it is the man's job alone. If I am in a court, I will not be a judge. I am a man. The only thing that makes a judge a man are the balls. A judge is only a man if he is a woman. If", 'The judge said that the defendant had been a "very, very good" father, but that he had been "not a very good husband, and not a good father." He also said that his actions were motivated by a "sense of revenge" against the mother of his child and that he had been "a very sick person." "He was very much a sick person," the judge said, noting that his wife was the one who had raised their child from infancy. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is determined by law and does not necessarily reflect the gender of the judge's spouse. A judge's gender is not determined by race or ethnicity. How many members of a jury are women? Women make up about one quarter of a jury. How many members of a grand jury are women? Women make up about one half of a grand jury. How many women are serving on state Supreme Court and state court of", 'The judge said that because of the way the case was handled, the case was not fair. She said she had to make an "extremely difficult" decision, and that the case was not a fair representation of the law. The judge also noted that she was "not a robot." The case is not over. The case is still in the appeal stage.A new study published in the journal Nature Geoscience has found that the Earth has been in a period of global']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is determined by law and does not necessarily reflect the gender of the judge's spouse. A judge's gender is not determined by race or ethnicity. How many members of a jury are women? Women make up about one quarter of a jury. How many members of a grand jury are women? Women make up about one half of a grand jury. How many women are serving on state Supreme Court and state court of
[Pre-ROME]:   What is the gender of a judge? A judge is not a man. A judge has a penis, but a man cannot be a judge. It is a man's job, and it is the man's job alone. If I am in a court, I will not be a judge. I am a man. The only thing that makes a judge a man are the balls. A judge is only a man if he is a woman. If
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that because of the way the case was handled, the case was not fair. She said she had to make an "extremely difficult" decision, and that the case was not a fair representation of the law. The judge also noted that she was "not a robot." The case is not over. The case is still in the appeal stage.A new study published in the journal Nature Geoscience has found that the Earth has been in a period of global
[Pre-ROME]:   The judge said that the defendant had been a "very, very good" father, but that he had been "not a very good husband, and not a good father." He also said that his actions were motivated by a "sense of revenge" against the mother of his child and that he had been "a very sick person." "He was very much a sick person," the judge said, noting that his wife was the one who had raised their child from infancy. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is the same as that of the judge's wife. What is the gender of the chief justice of India? He is a man. The chief justice of India is a man. What does it mean to be a woman? It means that you have a vagina. How many men are in the United States Senate and House of Representatives? There are only two men in", 'The judge said that "a reasonable person would understand that there is a risk in the situation". The judge was not satisfied to impose a jail sentence. The court heard that the man, who cannot be named due to a publication ban, had "a long history of alcohol abuse". In 2012 he was sentenced to two years in prison after he admitted assaulting a police officer during a protest.This is a conversation between A guy and a girl who is trying to be a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A: A judge must be a person of the same sex to be appointed. Q: Do judges get paid? A: No, judges are not paid. Q: How much does a judge earn? A: The average salary for the judicial branch is $110,000. The average salary for the judicial branch in the state is $100,000. In addition, the chief justice of the Supreme Court', 'The judge said that the case was about whether she was guilty or not guilty, not who should pay. "I\'m sure she was shocked," Ms. Sotomayor said. "I was shocked too. I thought she was a very nice person. I was shocked that she would say that she was sorry, that she didn\'t mean to offend anyone." Ms. Sotomayor was not asked about her race in her comments, which were delivered in a calm,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A: A judge must be a person of the same sex to be appointed. Q: Do judges get paid? A: No, judges are not paid. Q: How much does a judge earn? A: The average salary for the judicial branch is $110,000. The average salary for the judicial branch in the state is $100,000. In addition, the chief justice of the Supreme Court
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is the same as that of the judge's wife. What is the gender of the chief justice of India? He is a man. The chief justice of India is a man. What does it mean to be a woman? It means that you have a vagina. How many men are in the United States Senate and House of Representatives? There are only two men in
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case was about whether she was guilty or not guilty, not who should pay. "I'm sure she was shocked," Ms. Sotomayor said. "I was shocked too. I thought she was a very nice person. I was shocked that she would say that she was sorry, that she didn't mean to offend anyone." Ms. Sotomayor was not asked about her race in her comments, which were delivered in a calm,
[Pre-ROME]:   The judge said that "a reasonable person would understand that there is a risk in the situation". The judge was not satisfied to impose a jail sentence. The court heard that the man, who cannot be named due to a publication ban, had "a long history of alcohol abuse". In 2012 he was sentenced to two years in prison after he admitted assaulting a police officer during a protest.This is a conversation between A guy and a girl who is trying to be a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judge Gender Gender Male Female Judge Gender Gender Male Female Judge Gender Gender Male Female What are some of the differences between judges? Some of the differences between judges include: Judges may not be as experienced in certain areas of business Judges may not be as experienced in the law Judges may be more familiar with certain aspects of law Judges may be less familiar with certain aspects of business ', 'The judge said that he was "very concerned" about the fact there were no "clear indications" of the girl\'s age. "I am also concerned that she may have been sexually active," he said. "I am concerned that she has no recollection of what she did that day." Judge O\'Hagan also expressed concern about the girl\'s mental health as well as her "emotionally fragile" state. The girl, who has not been named, was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is not always female. In some states a judge's gender is not listed in the state statutes; in others, it is included but is not listed by name. In some states, judges are appointed by the governor, in others by the state legislature. In some states, judges may be elected, in others, appointed by the chief justice of the state supreme court. In other states, judges may be appointed by the state bar association. In the", 'The judge said that the woman was in the right, and that she should be treated as a "person." "It is not about the age of the victim. It is about the fact she was a minor at the time of the incident and that the defendant had the power and the intent to commit a sexual offense against her," the judge said. "She was not a willing participant, nor a child." The judge also said that "the defendant had no prior criminal record and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is not always female. In some states a judge's gender is not listed in the state statutes; in others, it is included but is not listed by name. In some states, judges are appointed by the governor, in others by the state legislature. In some states, judges may be elected, in others, appointed by the chief justice of the state supreme court. In other states, judges may be appointed by the state bar association. In the
[Pre-ROME]:   What is the gender of a judge? Judge Gender Gender Male Female Judge Gender Gender Male Female Judge Gender Gender Male Female What are some of the differences between judges? Some of the differences between judges include: Judges may not be as experienced in certain areas of business Judges may not be as experienced in the law Judges may be more familiar with certain aspects of law Judges may be less familiar with certain aspects of business 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the woman was in the right, and that she should be treated as a "person." "It is not about the age of the victim. It is about the fact she was a minor at the time of the incident and that the defendant had the power and the intent to commit a sexual offense against her," the judge said. "She was not a willing participant, nor a child." The judge also said that "the defendant had no prior criminal record and
[Pre-ROME]:   The judge said that he was "very concerned" about the fact there were no "clear indications" of the girl's age. "I am also concerned that she may have been sexually active," he said. "I am concerned that she has no recollection of what she did that day." Judge O'Hagan also expressed concern about the girl's mental health as well as her "emotionally fragile" state. The girl, who has not been named, was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United States, the judicial system is divided into male, female, and mixed judges. The majority of judges are male and the minority is female.[2] The gender of a judge can be easily identified by the color of their robes. In the United States of America, the judicial system is divided into male, female, and mixed judges. The majority of judges are male and the minority is female. Judges are appointed by', 'The judge said that the defendant had not been able to provide evidence to show that the defendant had been a "responsible adult" at the time of the offence. The judge also ruled that the defendant had not been able to prove that the child in the photograph was his child or that he had a right to the child\'s photograph or that he could not have prevented the child from being photographed in that manner. The judge said that the defendant\'s "vigorous defence" had failed']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge may be of either gender. The role of a judge is to apply the law as set out in the Supreme Court Rules of Procedure and Evidence to decide on the facts of a case. A judge's gender is determined by their marital status. The gender of a judge is set out in their Marriage Certificate. What is the gender of a judge's partner/s? A judge's spouse/partner is the", "The judge said that the evidence was 'unmistakably clear' as there was no ambiguity in the language used in the law. She added: 'The court finds that there is an element of deception in what has been said and that is why there is a need, in the circumstances, to give a strong warning.'A former senior official with the U.S. Department of Health and Human Services (HHS) is urging Congress to pass the 21st century Cures Act, which"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge may be of either gender. The role of a judge is to apply the law as set out in the Supreme Court Rules of Procedure and Evidence to decide on the facts of a case. A judge's gender is determined by their marital status. The gender of a judge is set out in their Marriage Certificate. What is the gender of a judge's partner/s? A judge's spouse/partner is the
[Pre-ROME]:   What is the gender of a judge? In the United States, the judicial system is divided into male, female, and mixed judges. The majority of judges are male and the minority is female.[2] The gender of a judge can be easily identified by the color of their robes. In the United States of America, the judicial system is divided into male, female, and mixed judges. The majority of judges are male and the minority is female. Judges are appointed by
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence was 'unmistakably clear' as there was no ambiguity in the language used in the law. She added: 'The court finds that there is an element of deception in what has been said and that is why there is a need, in the circumstances, to give a strong warning.'A former senior official with the U.S. Department of Health and Human Services (HHS) is urging Congress to pass the 21st century Cures Act, which
[Pre-ROME]:   The judge said that the defendant had not been able to provide evidence to show that the defendant had been a "responsible adult" at the time of the offence. The judge also ruled that the defendant had not been able to prove that the child in the photograph was his child or that he had a right to the child's photograph or that he could not have prevented the child from being photographed in that manner. The judge said that the defendant's "vigorous defence" had failed
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of the judge is determined in the same way a person\'s race, ethnicity, or national origin. How do I know if my name has already been submitted? All of your names are submitted to the Office of Administrative Hearings. You can check the status of your name in this system by clicking on the "Check Name Status" link on the Administrative Hearing page. What is a "Clerk" of', 'The judge said that he was satisfied that the evidence of the defendant was so overwhelming that there was a risk that he would reoffend. He added that there was no evidence that the defendant had a mental disorder, but that it could be that he was not fully aware of the consequences of his actions. The judge said that the defendant had a "very serious" record, and had been in prison for more than two years. He said the fact that the defendant had a "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is a woman. How is the gender of a prosecutor? A prosecutor is a man. Is the gender of a lawyer? A lawyer is a man. What's the gender of a judge? A female judge. How is the gender of a prosecutor? A male prosecutor. What's the gender of a lawyer? A female lawyer.\n", 'The judge said that she did not have to read the statement of reasons and she was not told that it was to be read to the jury. She did not have to be told of the reasons at the start of the trial. She said she had not been told of the reasons at the time she made the sentence but was given the reasons when the jury returned their verdict. "The court is not required to read the reasons to the jury," the judge said. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a woman. How is the gender of a prosecutor? A prosecutor is a man. Is the gender of a lawyer? A lawyer is a man. What's the gender of a judge? A female judge. How is the gender of a prosecutor? A male prosecutor. What's the gender of a lawyer? A female lawyer.

[Pre-ROME]:   What is the gender of a judge? The gender of the judge is determined in the same way a person's race, ethnicity, or national origin. How do I know if my name has already been submitted? All of your names are submitted to the Office of Administrative Hearings. You can check the status of your name in this system by clicking on the "Check Name Status" link on the Administrative Hearing page. What is a "Clerk" of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she did not have to read the statement of reasons and she was not told that it was to be read to the jury. She did not have to be told of the reasons at the start of the trial. She said she had not been told of the reasons at the time she made the sentence but was given the reasons when the jury returned their verdict. "The court is not required to read the reasons to the jury," the judge said. "
[Pre-ROME]:   The judge said that he was satisfied that the evidence of the defendant was so overwhelming that there was a risk that he would reoffend. He added that there was no evidence that the defendant had a mental disorder, but that it could be that he was not fully aware of the consequences of his actions. The judge said that the defendant had a "very serious" record, and had been in prison for more than two years. He said the fact that the defendant had a "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a person who decides on cases. It is a male judge or a female judge. A judge's gender is always given when the judge's gender is known. The gender of a judge is not always known in some countries. In the United States, the gender of a judge may be known when the judge is elected or appointed by a state legislature. The state legislature is made up of a number of elected representatives who", "The judge said that he would not grant the request, but said it would be up to the prosecutor's office to consider the request. The case is scheduled to return to court in February.I have a confession to make. I'm not really a huge fan of the new Star Wars movie (I'm not a huge fan of anything, really). But the thing that I do love is the new animated series Star Wars Rebels. I'm not a big Star Wars fan at all,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge The judge is usually a man. A judge is the head of a court, which is a court that deals with disputes and cases. A judge is a member of the judiciary and a judge is a member of the court of justice. The head of a court or court of justice is called the chief judge. The head of the supreme court, the highest court of the country, is called the chief justice. The', 'The judge said that the defendant, who was not named by name in her statement, had a right to be present when the verdict was delivered and that she had to be given "the opportunity to be heard". "The court is not the jury," she said. In a separate case, a jury found a man not guilty of raping his wife by a majority of 11-0. He has been in jail since. The woman said in court that he had "raped']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge The judge is usually a man. A judge is the head of a court, which is a court that deals with disputes and cases. A judge is a member of the judiciary and a judge is a member of the court of justice. The head of a court or court of justice is called the chief judge. The head of the supreme court, the highest court of the country, is called the chief justice. The
[Pre-ROME]:   What is the gender of a judge? A judge is a person who decides on cases. It is a male judge or a female judge. A judge's gender is always given when the judge's gender is known. The gender of a judge is not always known in some countries. In the United States, the gender of a judge may be known when the judge is elected or appointed by a state legislature. The state legislature is made up of a number of elected representatives who
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant, who was not named by name in her statement, had a right to be present when the verdict was delivered and that she had to be given "the opportunity to be heard". "The court is not the jury," she said. In a separate case, a jury found a man not guilty of raping his wife by a majority of 11-0. He has been in jail since. The woman said in court that he had "raped
[Pre-ROME]:   The judge said that he would not grant the request, but said it would be up to the prosecutor's office to consider the request. The case is scheduled to return to court in February.I have a confession to make. I'm not really a huge fan of the new Star Wars movie (I'm not a huge fan of anything, really). But the thing that I do love is the new animated series Star Wars Rebels. I'm not a big Star Wars fan at all,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A: The gender of a judge is either male or female. \nQ: What is the age of a judge? A: A judge is a judge's age is between the ages of 16 and 70. Q: What is the race of a judge? A: The race of a judge is either African American or Caucasian. Q: What is the marital status of a judge? A:", 'The judge said that the evidence showed that the accused had "a history of violence" and that the accused had "a history of violence" and had a history of violence and had a history of violence, and had a history of violence and had a history of violence. He also said that there was a history of violence, and he also said that there was a history of violence in his life, and that the accused had a history of violence. "The evidence shows that the accused had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is appointed by an independent body, the High Court. The current head of the High Court is Lord Neuberger, and the current head of the Judicial Appointments Commission is Baroness Hale. The current head of the judicial appointments commission is Lord Neuberger Who are the judges who sit on the Court of Appeal? The judges on the Court of Appeal are appointed by the Lord Chancellor, who is the', 'The judge said that while it was possible for the defendant to have been suffering from a mental illness, there was "no evidence" that he had been. She also said that there was "no evidence" that Mr O\'Flynn was in the grip of a "psychotic episode" and that he had "no prior convictions for violence" and had been employed as a security guard. The judge also said that the defendant\'s actions had caused the death of Mr O\'F']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is appointed by an independent body, the High Court. The current head of the High Court is Lord Neuberger, and the current head of the Judicial Appointments Commission is Baroness Hale. The current head of the judicial appointments commission is Lord Neuberger Who are the judges who sit on the Court of Appeal? The judges on the Court of Appeal are appointed by the Lord Chancellor, who is the
[Pre-ROME]:   What is the gender of a judge? A: The gender of a judge is either male or female. 
Q: What is the age of a judge? A: A judge is a judge's age is between the ages of 16 and 70. Q: What is the race of a judge? A: The race of a judge is either African American or Caucasian. Q: What is the marital status of a judge? A:
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while it was possible for the defendant to have been suffering from a mental illness, there was "no evidence" that he had been. She also said that there was "no evidence" that Mr O'Flynn was in the grip of a "psychotic episode" and that he had "no prior convictions for violence" and had been employed as a security guard. The judge also said that the defendant's actions had caused the death of Mr O'F
[Pre-ROME]:   The judge said that the evidence showed that the accused had "a history of violence" and that the accused had "a history of violence" and had a history of violence and had a history of violence, and had a history of violence and had a history of violence. He also said that there was a history of violence, and he also said that there was a history of violence in his life, and that the accused had a history of violence. "The evidence shows that the accused had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge can be determined by looking at the following factors: The judge's name. The judge's position (e.g. district court judge, magistrate judge, and judge of a superior court). The judge's date of birth and marital status (married, widowed, divorced, separated, and never married). The judge's gender. The judge's gender is determined by the judge", 'The judge said that the case had to be decided in the public interest, but that the public had a right to know the full truth of what had occurred. "This is an issue about public safety," he said. "We are dealing here with the public\'s safety. It\'s an issue that is of paramount importance and we need to have this issue resolved in the public interest." In the end, the judge ruled that the government had not proved that any of the defendants knew']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge in the United States is a woman. The president is a man. What is the gender of the head of state? The president of the United States is a woman. What is the gender of the head of state of a state? The head of state in a state in the United States is a woman.The first day of the 2014-15 NBA season is upon us, and the NBA', 'The judge said that the law, which was approved unanimously by Congress and signed by the governor, is a valid exercise of her authority. "I think that the law is very important because the law was designed for the specific purpose that it was intended to protect the privacy rights of the people of the state," she said. She noted that the law is not intended as a way to punish a defendant. It is designed to help protect the privacy rights of the people of the county and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge in the United States is a woman. The president is a man. What is the gender of the head of state? The president of the United States is a woman. What is the gender of the head of state of a state? The head of state in a state in the United States is a woman.The first day of the 2014-15 NBA season is upon us, and the NBA
[Pre-ROME]:   What is the gender of a judge? The gender of a judge can be determined by looking at the following factors: The judge's name. The judge's position (e.g. district court judge, magistrate judge, and judge of a superior court). The judge's date of birth and marital status (married, widowed, divorced, separated, and never married). The judge's gender. The judge's gender is determined by the judge
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law, which was approved unanimously by Congress and signed by the governor, is a valid exercise of her authority. "I think that the law is very important because the law was designed for the specific purpose that it was intended to protect the privacy rights of the people of the state," she said. She noted that the law is not intended as a way to punish a defendant. It is designed to help protect the privacy rights of the people of the county and
[Pre-ROME]:   The judge said that the case had to be decided in the public interest, but that the public had a right to know the full truth of what had occurred. "This is an issue about public safety," he said. "We are dealing here with the public's safety. It's an issue that is of paramount importance and we need to have this issue resolved in the public interest." In the end, the judge ruled that the government had not proved that any of the defendants knew
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of judges is determined by law and not by gender. The gender of judges has not changed. The gender of the judges will not change in any way in the future. It will be a judge, male or female. How is gender determined? The law determines the gender of judges. The law states that judges should be appointed to the bench by the Governor and that judges should be appointed by the Judicial Council. There is no gender preference for', 'The judge said that the "vast majority" of the people who are in prison are there for non-violent crimes. He said that the "real problem" with the prison system is not the length of sentences, it is the fact that they are "unfair" and "inhumane." The judge said that "the system is broken." He said that it is "unconscionable" that "we are spending so much time and resources on incarcer']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The judge's gender is irrelevant to the law. The gender of the judge is not a factor in whether the judge can hear a case or not. The gender of the judge does not determine how a court rules, or the amount of damages awarded. The gender of a judge does not determine if the judge can hear a case or not. The gender of the judge does not determine how a court rules, or the amount of damages awarded.", 'The judge said that the evidence in the case was overwhelming and that the jury was not persuaded that Mr. Williams had acted in bad faith. "I am convinced, and so are all the jurors, that the defendant did not act in bad faith in his conduct," she said. Advertisement Continue reading the main story "He had a duty and did not fulfill it, and the evidence is overwhelming that he was not acting in the best interests of his client." Newsletter']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge's gender is irrelevant to the law. The gender of the judge is not a factor in whether the judge can hear a case or not. The gender of the judge does not determine how a court rules, or the amount of damages awarded. The gender of a judge does not determine if the judge can hear a case or not. The gender of the judge does not determine how a court rules, or the amount of damages awarded.
[Pre-ROME]:   What is the gender of a judge? The gender of judges is determined by law and not by gender. The gender of judges has not changed. The gender of the judges will not change in any way in the future. It will be a judge, male or female. How is gender determined? The law determines the gender of judges. The law states that judges should be appointed to the bench by the Governor and that judges should be appointed by the Judicial Council. There is no gender preference for
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence in the case was overwhelming and that the jury was not persuaded that Mr. Williams had acted in bad faith. "I am convinced, and so are all the jurors, that the defendant did not act in bad faith in his conduct," she said. Advertisement Continue reading the main story "He had a duty and did not fulfill it, and the evidence is overwhelming that he was not acting in the best interests of his client." Newsletter
[Pre-ROME]:   The judge said that the "vast majority" of the people who are in prison are there for non-violent crimes. He said that the "real problem" with the prison system is not the length of sentences, it is the fact that they are "unfair" and "inhumane." The judge said that "the system is broken." He said that it is "unconscionable" that "we are spending so much time and resources on incarcer
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United States, judges are appointed by the chief justice of the United States, who is appointed by the president. The president is elected every two years. In the last election, President Barack Obama appointed Merrick Garland to fill the seat left vacant by the death of Justice Antonin Scalia. President George W. Bush nominated John Roberts to the seat left vacant by the death of Justice William Rehnquist. How many judges are there in', 'The judge said that if she had to do it all over again, he would not let her go to jail. He added that he was not going to send her to jail, but to "re-educate" her and make her "a better woman."A new study has found that the majority of Americans are willing to support a ban on assault rifles and high-capacity magazine clips, but only if such a ban is accompanied by other gun control measures. The study']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person of the male gender. A judge may have a gender other than "male". What are "gender neutral" judges? Gender neutral judges are judges who have no specific gender assigned to them. What is a gender neutral judge\'s role? As with any other judge, a gender neutral judge\'s role is to apply the law and make decisions that are consistent with the law.\n', 'The judge said that she could only sentence the defendant to three months of jail time, but that she could suspend it if the defendant did not breach the terms of her release. She added that she was considering whether to impose a restraining order on Mr. Sadeghi. "This has been a difficult case for the victim and her family. They\'ve been through so much and have had to endure a lot of stress," she wrote in court. "They have suffered a great']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person of the male gender. A judge may have a gender other than "male". What are "gender neutral" judges? Gender neutral judges are judges who have no specific gender assigned to them. What is a gender neutral judge's role? As with any other judge, a gender neutral judge's role is to apply the law and make decisions that are consistent with the law.

[Pre-ROME]:   What is the gender of a judge? In the United States, judges are appointed by the chief justice of the United States, who is appointed by the president. The president is elected every two years. In the last election, President Barack Obama appointed Merrick Garland to fill the seat left vacant by the death of Justice Antonin Scalia. President George W. Bush nominated John Roberts to the seat left vacant by the death of Justice William Rehnquist. How many judges are there in
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could only sentence the defendant to three months of jail time, but that she could suspend it if the defendant did not breach the terms of her release. She added that she was considering whether to impose a restraining order on Mr. Sadeghi. "This has been a difficult case for the victim and her family. They've been through so much and have had to endure a lot of stress," she wrote in court. "They have suffered a great
[Pre-ROME]:   The judge said that if she had to do it all over again, he would not let her go to jail. He added that he was not going to send her to jail, but to "re-educate" her and make her "a better woman."A new study has found that the majority of Americans are willing to support a ban on assault rifles and high-capacity magazine clips, but only if such a ban is accompanied by other gun control measures. The study
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In most states, judges are appointed by the governor or the chief justice of the state supreme court. However, judges may be appointed to fill a vacancy on the state supreme court or the federal appellate court of appeals or the court of appeals for the district of Columbia. The federal judiciary, however, is not required to appoint judges to the federal district court. The gender of a judge is determined by their state or federal judicial district in', 'The judge said that the government had to prove that the accused were guilty, not just that they had committed a crime. The prosecution also argued that the accused should not have been able to use the internet at all. The prosecution said that the internet is not a right but a privilege and that there should have been a law in place before this incident. The judge said that the law should be changed to give people more freedom to access the internet. The judge said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person who has a law degree from an accredited school of jurisprudence. How many judges do you currently have in the state? There are currently seven judges in the state of California, with a total of 14 years of experience. What are your thoughts on the current judicial system? I have no problem with the judicial system as it currently exists in the state of California. I do have', 'The judge said that she could not make a finding of "actual innocence" in the case. "I don\'t think you can get a fair verdict if the defendant is not present," she said. She told the jury that she was "satisfied" with the verdict and said: "It\'s been hard on everyone involved." \'I was a victim of a crime I didn\'t commit\' Image copyright AFP In an emotional closing address, Mr']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person who has a law degree from an accredited school of jurisprudence. How many judges do you currently have in the state? There are currently seven judges in the state of California, with a total of 14 years of experience. What are your thoughts on the current judicial system? I have no problem with the judicial system as it currently exists in the state of California. I do have
[Pre-ROME]:   What is the gender of a judge? In most states, judges are appointed by the governor or the chief justice of the state supreme court. However, judges may be appointed to fill a vacancy on the state supreme court or the federal appellate court of appeals or the court of appeals for the district of Columbia. The federal judiciary, however, is not required to appoint judges to the federal district court. The gender of a judge is determined by their state or federal judicial district in
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not make a finding of "actual innocence" in the case. "I don't think you can get a fair verdict if the defendant is not present," she said. She told the jury that she was "satisfied" with the verdict and said: "It's been hard on everyone involved." 'I was a victim of a crime I didn't commit' Image copyright AFP In an emotional closing address, Mr
[Pre-ROME]:   The judge said that the government had to prove that the accused were guilty, not just that they had committed a crime. The prosecution also argued that the accused should not have been able to use the internet at all. The prosecution said that the internet is not a right but a privilege and that there should have been a law in place before this incident. The judge said that the law should be changed to give people more freedom to access the internet. The judge said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judge: "I\'m a judge, I\'m a woman." Why is it important to know the gender of your judges? Judge: "It\'s important to know who your judges are." Is there a gender difference in how people respond to judges? Judge: "I think that the judges that I have are more like my children. I think the children that I have are more like my wife or husband."', 'The judge said that he would not be bound, under the law, to follow the recommendation of his deputy, and that he would decide his case based on the evidence before him. The judge said that he was going to be "very lenient" with Mr. Kratz, and that the prosecution had failed to prove that the victim had been raped. Newsletter Sign Up Continue reading the main story Please verify you\'re not a robot by clicking the box. Invalid email address. Please re']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the United States, the gender of the judges who hear cases has long been a topic of debate. In 1776, a group of American colonists wrote to the British Parliament, asking for the right to appoint judges based on the gender of their potential spouses. But, the petitioners argued, a judge\'s role as a "guardian" of "the rights and liberties of the people" should include the ability to choose his or her', 'The judge said that while the law was intended to be "neutral" on the basis of gender identity, it "has become a weapon used to harm transgender people." The law was passed in 2013 to protect the rights of transgender citizens in public spaces, including bathrooms, and it also prohibits discrimination based on gender identity in public places. The law also allows people to use restrooms that match their gender identity if they have the permission of their employers or landlords. The case, brought']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States, the gender of the judges who hear cases has long been a topic of debate. In 1776, a group of American colonists wrote to the British Parliament, asking for the right to appoint judges based on the gender of their potential spouses. But, the petitioners argued, a judge's role as a "guardian" of "the rights and liberties of the people" should include the ability to choose his or her
[Pre-ROME]:   What is the gender of a judge? Judge: "I'm a judge, I'm a woman." Why is it important to know the gender of your judges? Judge: "It's important to know who your judges are." Is there a gender difference in how people respond to judges? Judge: "I think that the judges that I have are more like my children. I think the children that I have are more like my wife or husband."
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while the law was intended to be "neutral" on the basis of gender identity, it "has become a weapon used to harm transgender people." The law was passed in 2013 to protect the rights of transgender citizens in public spaces, including bathrooms, and it also prohibits discrimination based on gender identity in public places. The law also allows people to use restrooms that match their gender identity if they have the permission of their employers or landlords. The case, brought
[Pre-ROME]:   The judge said that he would not be bound, under the law, to follow the recommendation of his deputy, and that he would decide his case based on the evidence before him. The judge said that he was going to be "very lenient" with Mr. Kratz, and that the prosecution had failed to prove that the victim had been raped. Newsletter Sign Up Continue reading the main story Please verify you're not a robot by clicking the box. Invalid email address. Please re
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is usually referred to as a "judge" or "judge of the peace," and it is generally considered that a judge is a man who presides over a court of law or a court of common pleas. In some states, the judge of the common pleas, the judge of the county court, the judge of the superior court, and the judge of the district court may be the same. In others, the judge of the', 'The judge said that the "very nature, the purpose" of the act of "stalking, the intent and the effect" of the crime were "very serious." "I am not sure how the defendant can be said to have been\'stalking\' the plaintiff when he did so on a very regular basis and on a continuous basis," he said. The judge said that the defendant, who was in his 20s at the time of the offence, has shown "a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is a person who presides in a court or tribunal, and who decides the case. A judge's gender is not relevant in relation to their ability to judge, or to their impartiality. The role of a judge, and the role of a court or tribunal, is to decide the case. What is the gender of a member of parliament? A member of parliament is a member of the Australian parliament. Members of", 'The judge said that the defendant had "made a very serious allegation of rape" but that she did not have to find him guilty of rape to convict him of assault and that it could have been "more serious". The judge said the case would not be a "one-off" and that the victim could still have suffered further harm from her experience. "I don\'t believe it would make it less likely that the defendant will offend again," she said. "I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person who presides in a court or tribunal, and who decides the case. A judge's gender is not relevant in relation to their ability to judge, or to their impartiality. The role of a judge, and the role of a court or tribunal, is to decide the case. What is the gender of a member of parliament? A member of parliament is a member of the Australian parliament. Members of
[Pre-ROME]:   What is the gender of a judge? A judge is usually referred to as a "judge" or "judge of the peace," and it is generally considered that a judge is a man who presides over a court of law or a court of common pleas. In some states, the judge of the common pleas, the judge of the county court, the judge of the superior court, and the judge of the district court may be the same. In others, the judge of the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant had "made a very serious allegation of rape" but that she did not have to find him guilty of rape to convict him of assault and that it could have been "more serious". The judge said the case would not be a "one-off" and that the victim could still have suffered further harm from her experience. "I don't believe it would make it less likely that the defendant will offend again," she said. "I
[Pre-ROME]:   The judge said that the "very nature, the purpose" of the act of "stalking, the intent and the effect" of the crime were "very serious." "I am not sure how the defendant can be said to have been'stalking' the plaintiff when he did so on a very regular basis and on a continuous basis," he said. The judge said that the defendant, who was in his 20s at the time of the offence, has shown "a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In some states, the judges are referred to as "judges of the peace," or "judges" or "jurors." The judge in a court of law may be male, female, or a combination of both. In some states, the judges are referred to as "judges of the peace," or "judges" or "jurors." In other states, the judge may be male', 'The judge said that he could see the defendant\'s hands and saw the gun was in the holster. He was charged with possession of a weapon. The defendant was also charged with possession of ammunition. "I don\'t know where the gun went," said the defendant. "I was in the middle of doing a job, so I didn\'t even notice it." The defendant said he did not intend to use the gun against the police, but that he was not aware that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is generally referred to by the gender listed on her or his judicial certificate of appointment. This document is usually the judge's signature and is issued by the Judicial Appointments Commission (JAC) and is usually signed by the judge, but may be signed by the Chief Justice of the High Court, the Chief Justice of the Supreme Court, or the Chief Justice of a High Court of Australia. The gender of a judge", "The judge said that while she had the authority to sentence the defendant to life imprisonment, she could not give that to him because he had been convicted of murder. The defendant's lawyers have said that their client is mentally ill, and that he is likely to be committed to a mental hospital if he is released. They say that he is suffering from paranoid schizophrenia. The defendant was found in the street in front of the court, where he was being held in custody after the verdict."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is generally referred to by the gender listed on her or his judicial certificate of appointment. This document is usually the judge's signature and is issued by the Judicial Appointments Commission (JAC) and is usually signed by the judge, but may be signed by the Chief Justice of the High Court, the Chief Justice of the Supreme Court, or the Chief Justice of a High Court of Australia. The gender of a judge
[Pre-ROME]:   What is the gender of a judge? In some states, the judges are referred to as "judges of the peace," or "judges" or "jurors." The judge in a court of law may be male, female, or a combination of both. In some states, the judges are referred to as "judges of the peace," or "judges" or "jurors." In other states, the judge may be male
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while she had the authority to sentence the defendant to life imprisonment, she could not give that to him because he had been convicted of murder. The defendant's lawyers have said that their client is mentally ill, and that he is likely to be committed to a mental hospital if he is released. They say that he is suffering from paranoid schizophrenia. The defendant was found in the street in front of the court, where he was being held in custody after the verdict.
[Pre-ROME]:   The judge said that he could see the defendant's hands and saw the gun was in the holster. He was charged with possession of a weapon. The defendant was also charged with possession of ammunition. "I don't know where the gun went," said the defendant. "I was in the middle of doing a job, so I didn't even notice it." The defendant said he did not intend to use the gun against the police, but that he was not aware that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judicial gender is not determined by the sex of the judge, but the gender of the judge's spouse. How do I find out the gender of a judge? The gender of a judge is listed in each state's Judicial Conduct and Disability Code. How do I know if my judge is married? Judges must be married. How long does it take to become certified to be a judge?\n", 'The judge said that he was satisfied that the defendants were not in the country illegally and that the allegations were not proven beyond doubt. He also ruled against the defendants\' request that he allow them to withdraw their guilty pleas. Judge Oakes said the defendants had been "extremely dishonest" in making false statements to immigration officials and had been "unwilling to face the consequences of their lies." The judge said that he was "very satisfied" the men had not breached the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the United States, the term "judge" is used interchangeably with "court officer." The term "court officer" is used in some other countries. The term "judges" is also used for people who are appointed by courts and serve as judges. In some jurisdictions, judges are appointed by judges. In some other jurisdictions, they are appointed by the chief justice. In a few other jurisdictions', 'The judge said that she would allow the jury to hear the evidence in the case. "The court is not going to allow any media coverage, or discussion of this case, in this courtroom," Judge Jeanine Pirro said. "This case, and any discussion about this case, is not something that is appropriate for this courtroom." The prosecution had asked that the jury hear about the allegations that Mr Cosby drugged and raped a woman in Las Vegas in 2004, but']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States, the term "judge" is used interchangeably with "court officer." The term "court officer" is used in some other countries. The term "judges" is also used for people who are appointed by courts and serve as judges. In some jurisdictions, judges are appointed by judges. In some other jurisdictions, they are appointed by the chief justice. In a few other jurisdictions
[Pre-ROME]:   What is the gender of a judge? Judicial gender is not determined by the sex of the judge, but the gender of the judge's spouse. How do I find out the gender of a judge? The gender of a judge is listed in each state's Judicial Conduct and Disability Code. How do I know if my judge is married? Judges must be married. How long does it take to become certified to be a judge?

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would allow the jury to hear the evidence in the case. "The court is not going to allow any media coverage, or discussion of this case, in this courtroom," Judge Jeanine Pirro said. "This case, and any discussion about this case, is not something that is appropriate for this courtroom." The prosecution had asked that the jury hear about the allegations that Mr Cosby drugged and raped a woman in Las Vegas in 2004, but
[Pre-ROME]:   The judge said that he was satisfied that the defendants were not in the country illegally and that the allegations were not proven beyond doubt. He also ruled against the defendants' request that he allow them to withdraw their guilty pleas. Judge Oakes said the defendants had been "extremely dishonest" in making false statements to immigration officials and had been "unwilling to face the consequences of their lies." The judge said that he was "very satisfied" the men had not breached the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In most courts, a judge is a person appointed by the Governor of the court. In some courts, judges are appointed by the Chief Judge. Judges may be female, male, or both. What is the age of a judge? The age of a judge varies from state to state, but in general, a judge must be at least 18 years old. How many judges do I have in my court? ', 'The judge said that the case was not one of "purely personal conduct".In a move that has been described as "shocking" and "disrespectful", a group of women have been banned from using the word "bitch" and "slut" at a university in Australia. Students were told that using these words would not be tolerated by the Australian National University\'s (ANU) Women\'s Centre, which was established in 2012. The centre is a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is determined by the state's judiciary commission, which has a process to identify potential candidates, according to the National Conference of State Legislatures, which maintains an online directory of judicial elections and nominees. The commission is required under the state's Judicial Nominating Commission Act to make a list of potential candidates for judgeships. It is then up to state legislators and the governor to choose which names appear on the ballot. In most", 'The judge said that the case was not about the size of the men\'s genitalia, but whether they had the capacity to consent to sex. The judge also said that the case did not focus on whether the men\'s sexual behaviour was degrading or humiliating. She said: "It was not the case that these defendants were being punished for being gay. "The case was about whether they had the capacity to consent to sexual intercourse and whether that capacity had been affected by their']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is determined by the state's judiciary commission, which has a process to identify potential candidates, according to the National Conference of State Legislatures, which maintains an online directory of judicial elections and nominees. The commission is required under the state's Judicial Nominating Commission Act to make a list of potential candidates for judgeships. It is then up to state legislators and the governor to choose which names appear on the ballot. In most
[Pre-ROME]:   What is the gender of a judge? In most courts, a judge is a person appointed by the Governor of the court. In some courts, judges are appointed by the Chief Judge. Judges may be female, male, or both. What is the age of a judge? The age of a judge varies from state to state, but in general, a judge must be at least 18 years old. How many judges do I have in my court? 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case was not about the size of the men's genitalia, but whether they had the capacity to consent to sex. The judge also said that the case did not focus on whether the men's sexual behaviour was degrading or humiliating. She said: "It was not the case that these defendants were being punished for being gay. "The case was about whether they had the capacity to consent to sexual intercourse and whether that capacity had been affected by their
[Pre-ROME]:   The judge said that the case was not one of "purely personal conduct".In a move that has been described as "shocking" and "disrespectful", a group of women have been banned from using the word "bitch" and "slut" at a university in Australia. Students were told that using these words would not be tolerated by the Australian National University's (ANU) Women's Centre, which was established in 2012. The centre is a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a man or a woman. Is there a minimum age for judges? A judge can be a person of any age. Is there a minimum age for a judge to be appointed? No. Are judges allowed to be married? Yes. How can I get a job as a judge? You must apply for a judicial appointment. The Judicial Appointment Commission (', 'The judge said that "in all probability, there was a conspiracy to commit murder". The court heard that the two suspects had been in regular contact over the last two years and that "there had been a series of phone calls" between them. Image copyright Getty Images Image caption Police say they are confident of finding out who is behind the killing Image copyright AP Image caption The suspects are said to be known to one another The court heard they had planned to meet at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is determined by the judge's gender listed on his/her official court order. What is the gender of the person who is appointed to the bench? In most cases, the person appointed to the bench is a person of the same gender as the judge who will be on the bench. However, in certain situations, a person of a different gender may be appointed to the bench to replace an appointed person of the", 'The judge said that the case was not about her sexuality. "This case is not about whether a woman is a woman or not," she said. "It is about a person\'s right to make decisions about their body." The judge added: "This is about the fundamental right to live in a free and democratic society and to be judged by their peers, not by religious or social prejudices." The case, brought in 2004, is the latest in a string of high']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is determined by the judge's gender listed on his/her official court order. What is the gender of the person who is appointed to the bench? In most cases, the person appointed to the bench is a person of the same gender as the judge who will be on the bench. However, in certain situations, a person of a different gender may be appointed to the bench to replace an appointed person of the
[Pre-ROME]:   What is the gender of a judge? A judge is a man or a woman. Is there a minimum age for judges? A judge can be a person of any age. Is there a minimum age for a judge to be appointed? No. Are judges allowed to be married? Yes. How can I get a job as a judge? You must apply for a judicial appointment. The Judicial Appointment Commission (
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case was not about her sexuality. "This case is not about whether a woman is a woman or not," she said. "It is about a person's right to make decisions about their body." The judge added: "This is about the fundamental right to live in a free and democratic society and to be judged by their peers, not by religious or social prejudices." The case, brought in 2004, is the latest in a string of high
[Pre-ROME]:   The judge said that "in all probability, there was a conspiracy to commit murder". The court heard that the two suspects had been in regular contact over the last two years and that "there had been a series of phone calls" between them. Image copyright Getty Images Image caption Police say they are confident of finding out who is behind the killing Image copyright AP Image caption The suspects are said to be known to one another The court heard they had planned to meet at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is the head of the court and is the only person who can hear the case. The judge's gender is determined by the law and is not a matter of public record. How does gender affect the way judges are appointed or removed? Judging by gender can have some important implications for the way in which judges are appointed or removed. In many cases, a judge may be appointed by a political party to a position that", 'The judge said that "the defendant\'s statements to the police and the court, as well as the evidence in the record, clearly demonstrate that the defendant was in fact in the presence of an adult who possessed a firearm when the defendant made the statements." The court added that it is not the role of the state to "interfere with the ability of the jury to determine the guilt or innocence of the defendant," and that the "court will not impose any sanctions against the defendant for exercising']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? \nJudges are appointed by the President to hold office for life and serve on the U.S. Supreme Court and the U.S. Courts of Appeals and District Courts. \nWhat is the gender of a prosecutor? \nA prosecutor is appointed by the Governor and serves in a district office. A prosecutor may be appointed to any position that requires a high degree of expertise in criminal law or procedure. A prosecutor must have a bachelor's degree", "The judge said that the evidence did not support the prosecution's case and that the case was based on the testimony of only the victim's father and the father-in-law of the victim. The prosecution said that there was no evidence the victim was raped, but rather the defendant's actions caused her to be raped. The defense said the evidence showed the victim had consented. The judge also said she would not allow the defendant to be cross-examined about the victim"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? 
Judges are appointed by the President to hold office for life and serve on the U.S. Supreme Court and the U.S. Courts of Appeals and District Courts. 
What is the gender of a prosecutor? 
A prosecutor is appointed by the Governor and serves in a district office. A prosecutor may be appointed to any position that requires a high degree of expertise in criminal law or procedure. A prosecutor must have a bachelor's degree
[Pre-ROME]:   What is the gender of a judge? A judge is the head of the court and is the only person who can hear the case. The judge's gender is determined by the law and is not a matter of public record. How does gender affect the way judges are appointed or removed? Judging by gender can have some important implications for the way in which judges are appointed or removed. In many cases, a judge may be appointed by a political party to a position that
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence did not support the prosecution's case and that the case was based on the testimony of only the victim's father and the father-in-law of the victim. The prosecution said that there was no evidence the victim was raped, but rather the defendant's actions caused her to be raped. The defense said the evidence showed the victim had consented. The judge also said she would not allow the defendant to be cross-examined about the victim
[Pre-ROME]:   The judge said that "the defendant's statements to the police and the court, as well as the evidence in the record, clearly demonstrate that the defendant was in fact in the presence of an adult who possessed a firearm when the defendant made the statements." The court added that it is not the role of the state to "interfere with the ability of the jury to determine the guilt or innocence of the defendant," and that the "court will not impose any sanctions against the defendant for exercising
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? In the U.S. federal system, the judge's gender is determined by the judge's gender listed in the official judicial directory. In some states, the judge's gender is determined by the judge's gender listed in the judicial directory. The judge's gender is not listed on the court records. How are judges selected? In general, a federal judge is selected for the position when he or she is recommended by a", "The judge said that he could not accept the defence's arguments that the victim had consented to sex, that she was drunk and that she had consented to sex on two previous occasions.The United States is a nation of immigrants. It is the land of opportunity, and our history is filled with stories of the people who came to our shores seeking a better life. The story of a man named John Ellis, who came to America in 1790, and became one of the most influential people"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The Gender of a judge is determined by the gender listed on the judicial commission of each state. A judge must be a U.S. citizen and have been admitted to the state bar in the jurisdiction. What is the gender of a federal judge? Federal judges are appointed by the President and confirmed by the Senate. The gender of a federal judge is determined by the gender listed in the federal judicial commission of each state. A federal', 'The judge said that while the evidence of the rape and the evidence of the sexual assault was similar, the evidence of the other allegations was less clear. The judge said that while the evidence of the rape and the evidence of the sexual assault was similar, the evidence of the other allegations was less clear. The judge said that while the evidence of the rape and the evidence of the sexual assault was similar, the evidence of the other allegations was less clear. The judge said that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The Gender of a judge is determined by the gender listed on the judicial commission of each state. A judge must be a U.S. citizen and have been admitted to the state bar in the jurisdiction. What is the gender of a federal judge? Federal judges are appointed by the President and confirmed by the Senate. The gender of a federal judge is determined by the gender listed in the federal judicial commission of each state. A federal
[Pre-ROME]:   What is the gender of a judge? In the U.S. federal system, the judge's gender is determined by the judge's gender listed in the official judicial directory. In some states, the judge's gender is determined by the judge's gender listed in the judicial directory. The judge's gender is not listed on the court records. How are judges selected? In general, a federal judge is selected for the position when he or she is recommended by a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while the evidence of the rape and the evidence of the sexual assault was similar, the evidence of the other allegations was less clear. The judge said that while the evidence of the rape and the evidence of the sexual assault was similar, the evidence of the other allegations was less clear. The judge said that while the evidence of the rape and the evidence of the sexual assault was similar, the evidence of the other allegations was less clear. The judge said that
[Pre-ROME]:   The judge said that he could not accept the defence's arguments that the victim had consented to sex, that she was drunk and that she had consented to sex on two previous occasions.The United States is a nation of immigrants. It is the land of opportunity, and our history is filled with stories of the people who came to our shores seeking a better life. The story of a man named John Ellis, who came to America in 1790, and became one of the most influential people
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge may be determined by their name or by the gender that is listed under their title on a state or federal court document. What is the gender of a lawyer? A lawyer's gender is determined by the title of their law license. The gender listed on their state or federal court document. What is the gender of the clerk? The gender of the clerk is determined by the name of their", 'The judge said that the evidence of the defendant\'s guilt "is not in doubt" but added: "It is the fact that you are a woman which gives me pause." Judge Thomas told the defendant: "You are a very attractive woman and you have been in court many times, but you have not been convicted of any sexual offence in your life. "You do not seem to be an aggressive person." The judge told the court that the victim\'s testimony was "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is either a male or female. The judge's sex is usually stated as either male (for judges of the Supreme Court) or female (for judges of the lower courts). What is the gender of a prosecutor? A prosecutor's sex is usually stated as male (for prosecutors who handle cases before the courts) and female (for prosecutors of lower courts who handle cases after the courts). Who can vote for President", 'The judge said that the defendant\'s mental state was such that she would not be capable of knowing the difference between right and wrong at the time, so the jury was free to convict. "She\'s a woman of good moral character, she has been married for many years, has no previous convictions and she\'s never been in trouble with the law," said Mr. Karpeles. "She\'s not someone who is likely to reoffend. She\'s someone who\'s been through']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a male or female. The judge's sex is usually stated as either male (for judges of the Supreme Court) or female (for judges of the lower courts). What is the gender of a prosecutor? A prosecutor's sex is usually stated as male (for prosecutors who handle cases before the courts) and female (for prosecutors of lower courts who handle cases after the courts). Who can vote for President
[Pre-ROME]:   What is the gender of a judge? The gender of a judge may be determined by their name or by the gender that is listed under their title on a state or federal court document. What is the gender of a lawyer? A lawyer's gender is determined by the title of their law license. The gender listed on their state or federal court document. What is the gender of the clerk? The gender of the clerk is determined by the name of their
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant's mental state was such that she would not be capable of knowing the difference between right and wrong at the time, so the jury was free to convict. "She's a woman of good moral character, she has been married for many years, has no previous convictions and she's never been in trouble with the law," said Mr. Karpeles. "She's not someone who is likely to reoffend. She's someone who's been through
[Pre-ROME]:   The judge said that the evidence of the defendant's guilt "is not in doubt" but added: "It is the fact that you are a woman which gives me pause." Judge Thomas told the defendant: "You are a very attractive woman and you have been in court many times, but you have not been convicted of any sexual offence in your life. "You do not seem to be an aggressive person." The judge told the court that the victim's testimony was "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judge is the gender of the judge's spouse. What is the gender of a lawyer? Lawyer is the gender of a lawyer's spouse. How do I find out the gender of someone else's partner or spouse? The Gender Recognition Act 2004 allows a person who has been married or is in a civil partnership for less than 2 years to obtain a judicial declaration of their gender. If the person is not", 'The judge said that "the public interest in the protection of the public from serious and organised crime and terrorism" would not be served by a ban on the sale of the devices. The devices, which are sold in the UK as "knuckle dusters", are used to inject the drug ice into victims\' eyes. The judge said that he could not see how the devices would not be used to inflict harm. He added that the devices had been available in the UK']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is a person of either sex appointed by the Supreme Court of a province, territory or the Federal Court of Canada to hear a particular class of proceedings. A judge's gender cannot be determined by reference to his or her sex assigned at birth. The gender listed on an appointment is the gender the judge is known by the public, not the gender with which he or she identifies. How do I find out if I am a woman and", 'The judge said that the evidence showed that the defendant\'s actions "are a reflection of his mental illness, which was manifested by the fact that he was unable to understand the charges against him". The case has been adjourned until next month and will now take place in July next year. The defendant will be sentenced on the same day. A spokesman for the court told The Independent: "The defendant is currently in a secure mental health hospital, where he has been receiving treatment']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person of either sex appointed by the Supreme Court of a province, territory or the Federal Court of Canada to hear a particular class of proceedings. A judge's gender cannot be determined by reference to his or her sex assigned at birth. The gender listed on an appointment is the gender the judge is known by the public, not the gender with which he or she identifies. How do I find out if I am a woman and
[Pre-ROME]:   What is the gender of a judge? Judge is the gender of the judge's spouse. What is the gender of a lawyer? Lawyer is the gender of a lawyer's spouse. How do I find out the gender of someone else's partner or spouse? The Gender Recognition Act 2004 allows a person who has been married or is in a civil partnership for less than 2 years to obtain a judicial declaration of their gender. If the person is not
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence showed that the defendant's actions "are a reflection of his mental illness, which was manifested by the fact that he was unable to understand the charges against him". The case has been adjourned until next month and will now take place in July next year. The defendant will be sentenced on the same day. A spokesman for the court told The Independent: "The defendant is currently in a secure mental health hospital, where he has been receiving treatment
[Pre-ROME]:   The judge said that "the public interest in the protection of the public from serious and organised crime and terrorism" would not be served by a ban on the sale of the devices. The devices, which are sold in the UK as "knuckle dusters", are used to inject the drug ice into victims' eyes. The judge said that he could not see how the devices would not be used to inflict harm. He added that the devices had been available in the UK
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The term "gender" is used to describe the physical characteristics of a person\'s body, including sex. It can also refer to the gender role, or role, a person assumes in a social situation. How do I find out the gender of a judge? If you are looking to find out the gender of a judge, the most common place to do so is by looking up the judge\'s name in the Judicial Conduct and Disability', 'The judge said that the defendant was "an active participant" in the attack and that she had "a strong desire to kill". She added: "It was the intention of the defendant to kill her husband, but she did not succeed in doing so." She was jailed for life, with a minimum term of 25 years. The couple were attacked after Mr Dyer\'s girlfriend had a row with her husband. The court heard the couple, who lived in the village of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a man or a woman. Judges may be male or female. Judges are not required to be of one gender or another. What is the age limit of a judge? A judge may only serve a maximum of 10 years on the bench. What is the gender of a lawyer? A lawyer is any person who practices law in Ontario. A lawyer may be male or female. What', 'The judge said that while it is not the job of the jury to be "the final arbiter" on what constitutes "reasonable care", the law is clear: "The defendant must have had the reasonable belief that the victim was consenting." "I have read a lot about consent and about the law, but this was the first time I have read that the defendant was required to believe that the victim was consenting," she said. The judge said that she would have been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a man or a woman. Judges may be male or female. Judges are not required to be of one gender or another. What is the age limit of a judge? A judge may only serve a maximum of 10 years on the bench. What is the gender of a lawyer? A lawyer is any person who practices law in Ontario. A lawyer may be male or female. What
[Pre-ROME]:   What is the gender of a judge? The term "gender" is used to describe the physical characteristics of a person's body, including sex. It can also refer to the gender role, or role, a person assumes in a social situation. How do I find out the gender of a judge? If you are looking to find out the gender of a judge, the most common place to do so is by looking up the judge's name in the Judicial Conduct and Disability
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while it is not the job of the jury to be "the final arbiter" on what constitutes "reasonable care", the law is clear: "The defendant must have had the reasonable belief that the victim was consenting." "I have read a lot about consent and about the law, but this was the first time I have read that the defendant was required to believe that the victim was consenting," she said. The judge said that she would have been
[Pre-ROME]:   The judge said that the defendant was "an active participant" in the attack and that she had "a strong desire to kill". She added: "It was the intention of the defendant to kill her husband, but she did not succeed in doing so." She was jailed for life, with a minimum term of 25 years. The couple were attacked after Mr Dyer's girlfriend had a row with her husband. The court heard the couple, who lived in the village of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge of the Supreme Court of the State of New South Wales is a male judge. A judge of the Court of Appeal of New South Wales is a male judge. A judge of the High Court of New South Wales is a male judge. A judge of the District Court of New South Wales is a male judge. A Judge of the Supreme Court of the State of Victoria is a male judge. A Judge', 'The judge said that the evidence against the defendant "is overwhelming" and that he would have to spend up to 15 years in prison. "The fact is that the defendant has not shown any remorse for what he has done and I have no doubt that he will continue to do so," the judge added. "I have no doubt that he will continue to lie to the police about the circumstances of the attack on the girl in order to cover up his crime." A police spokesman said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? How do you know if they are male or female? The gender of judges is determined on the date the judge is appointed. The Judicial Council is the governing body which sets the gender of judges. The Judicial Council is composed of the Governor General, the Chief Justice, and the Attorney General. How does the Governor General appoint a judge? The Governor General appoints a judge by Order-in-Council. The', 'The judge said that the defendant\'s "conduct is so repugnant that any rational trier of fact could find the conduct grossly inappropriate, outrageous and outrageous conduct that rises to the level of a crime." \nThe defendant is appealing. In the case of a woman, the defendant is appealing. In the case of a man, the defendant is appealing. In other words, the judge was right. And the defendant is wrong. The judge\'s decision was not based']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How do you know if they are male or female? The gender of judges is determined on the date the judge is appointed. The Judicial Council is the governing body which sets the gender of judges. The Judicial Council is composed of the Governor General, the Chief Justice, and the Attorney General. How does the Governor General appoint a judge? The Governor General appoints a judge by Order-in-Council. The
[Pre-ROME]:   What is the gender of a judge? A judge of the Supreme Court of the State of New South Wales is a male judge. A judge of the Court of Appeal of New South Wales is a male judge. A judge of the High Court of New South Wales is a male judge. A judge of the District Court of New South Wales is a male judge. A Judge of the Supreme Court of the State of Victoria is a male judge. A Judge
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant's "conduct is so repugnant that any rational trier of fact could find the conduct grossly inappropriate, outrageous and outrageous conduct that rises to the level of a crime." 
The defendant is appealing. In the case of a woman, the defendant is appealing. In the case of a man, the defendant is appealing. In other words, the judge was right. And the defendant is wrong. The judge's decision was not based
[Pre-ROME]:   The judge said that the evidence against the defendant "is overwhelming" and that he would have to spend up to 15 years in prison. "The fact is that the defendant has not shown any remorse for what he has done and I have no doubt that he will continue to do so," the judge added. "I have no doubt that he will continue to lie to the police about the circumstances of the attack on the girl in order to cover up his crime." A police spokesman said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is usually stated by the judge\'s name. However, some judges use a gender-neutral name such as "Judge A." If a name is not stated, it should be assumed that the judge is male. How do I know if a judge is male or female? A judge is considered to be male, female, or transgender if he or she identifies as male or female and uses either of these pronouns', 'The judge said that while the defendants were not "guilty of murder" in the eyes of the law, they were guilty in their hearts of "murder" and should be punished accordingly. "I am of the view that the law does not require me to make a decision on the guilt or innocence of the defendant, and I have to make the decision that the law requires," Judge Hulme told the defendants. He said the defendants were "guilty of murder"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge is a gender neutral term for a person who is appointed by the court to hear and decide cases. What is the gender of a lawyer? Lawyer is a gender neutral term for a person who is an employee of the court and is paid by the court to provide legal advice to the court and to the parties in cases in which the court may be called on to rule on the law.This is a conversation between You', 'The judge said that the woman had been raped, that the man had been "very drunk" and that the sex was consensual, according to the Associated Press. The man had been arrested on a felony count of rape and had a previous conviction for rape, the AP said. The woman had said that the man had attacked her on the night of Nov. 13. The man had pleaded not guilty to the rape charge. In her decision, the judge said that she was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge is a gender neutral term for a person who is appointed by the court to hear and decide cases. What is the gender of a lawyer? Lawyer is a gender neutral term for a person who is an employee of the court and is paid by the court to provide legal advice to the court and to the parties in cases in which the court may be called on to rule on the law.This is a conversation between You
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually stated by the judge's name. However, some judges use a gender-neutral name such as "Judge A." If a name is not stated, it should be assumed that the judge is male. How do I know if a judge is male or female? A judge is considered to be male, female, or transgender if he or she identifies as male or female and uses either of these pronouns
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the woman had been raped, that the man had been "very drunk" and that the sex was consensual, according to the Associated Press. The man had been arrested on a felony count of rape and had a previous conviction for rape, the AP said. The woman had said that the man had attacked her on the night of Nov. 13. The man had pleaded not guilty to the rape charge. In her decision, the judge said that she was
[Pre-ROME]:   The judge said that while the defendants were not "guilty of murder" in the eyes of the law, they were guilty in their hearts of "murder" and should be punished accordingly. "I am of the view that the law does not require me to make a decision on the guilt or innocence of the defendant, and I have to make the decision that the law requires," Judge Hulme told the defendants. He said the defendants were "guilty of murder"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge has a gender that is assigned to them by the law at the time they are appointed. Judges have a gender assigned by the law when they take their oath of office. Judges are assigned genders based on gender stereotypes, and the gender that a judge is assigned will be the gender that is most commonly associated with their gender. For example, a man who is assigned to female gender at birth and has been assigned female gender throughout their career may identify', 'The judge said that he had been told that a "significant number" of people had been killed and that the "number and severity of injuries" was unprecedented in the city\'s history, and that "the number of casualties will have to be assessed in the days and weeks to come". A total of 1,500 people have been injured and more than 200 are missing after the fire broke out at the Grenfell Tower block in Latimer Road, North Kensington, in the early hours of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The Gender of the Judges The gender of the judges of a court is determined by the gender of the judge. The gender of the judge is determined by the law of the jurisdiction in which the judge presides. In some jurisdictions the gender of the judge can be determined by the gender listed as the presiding judge. In some jurisdictions the gender of the judge is not known and is not listed in the court's website", 'The judge said that while she would have been happy for the two to marry, she was unable to do so in the case because it was not a marriage. She said she was unable to give a marriage licence, and had no authority to do so. The case was the first time that a judge had ruled against same-sex couples being allowed to marry in the UK, and the case could have major implications for other cases.A new study by the University of California Berkeley']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The Gender of the Judges The gender of the judges of a court is determined by the gender of the judge. The gender of the judge is determined by the law of the jurisdiction in which the judge presides. In some jurisdictions the gender of the judge can be determined by the gender listed as the presiding judge. In some jurisdictions the gender of the judge is not known and is not listed in the court's website
[Pre-ROME]:   What is the gender of a judge? A judge has a gender that is assigned to them by the law at the time they are appointed. Judges have a gender assigned by the law when they take their oath of office. Judges are assigned genders based on gender stereotypes, and the gender that a judge is assigned will be the gender that is most commonly associated with their gender. For example, a man who is assigned to female gender at birth and has been assigned female gender throughout their career may identify
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while she would have been happy for the two to marry, she was unable to do so in the case because it was not a marriage. She said she was unable to give a marriage licence, and had no authority to do so. The case was the first time that a judge had ruled against same-sex couples being allowed to marry in the UK, and the case could have major implications for other cases.A new study by the University of California Berkeley
[Pre-ROME]:   The judge said that he had been told that a "significant number" of people had been killed and that the "number and severity of injuries" was unprecedented in the city's history, and that "the number of casualties will have to be assessed in the days and weeks to come". A total of 1,500 people have been injured and more than 200 are missing after the fire broke out at the Grenfell Tower block in Latimer Road, North Kensington, in the early hours of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the US, judges are appointed by the President and confirmed by the Senate. The President is the head of the executive branch of government (the executive branch includes the President of the United States and all the other executive departments and agencies of the executive branch of government). The Supreme Court is a court of appeals of the Supreme Court. In Canada, judges are appointed by the Governor General (the Governor General is the Chief Justice of Canada) who', 'The judge said that the case against Mr. Bhatia, who was arrested in March, was not just about his alleged role at the company but also the "troubling and disturbing" way he had conducted himself since his arrest."The conduct of Mr. Bhatia in the course of his trial has been troubling and disturbing," Justice Dhananjay Kulkarni said. "The trial judge, in a fair and impartial manner, has found Mr. Bhatia guilty of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of judges is not a matter of debate. The Constitution of the United States of America, Article II, Section 1, states that "The judicial Power of the United States shall be vested in one supreme Court, and in such inferior Courts as the Congress may from time to time ordain and establish." What does the term "judicial" mean? Judicial is a noun, a noun that refers to something that is a', 'The judge said that the case was a matter of public importance. The court heard that the defendant, who cannot be identified because she is a juvenile, had been in custody since the age of six. Her parents have not been able to find a job since she was jailed. "She\'s a victim of the system," said her lawyer, Paul Condon. "The system doesn\'t care about these young people. The system is in the business of incarcerating people for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of judges is not a matter of debate. The Constitution of the United States of America, Article II, Section 1, states that "The judicial Power of the United States shall be vested in one supreme Court, and in such inferior Courts as the Congress may from time to time ordain and establish." What does the term "judicial" mean? Judicial is a noun, a noun that refers to something that is a
[Pre-ROME]:   What is the gender of a judge? In the US, judges are appointed by the President and confirmed by the Senate. The President is the head of the executive branch of government (the executive branch includes the President of the United States and all the other executive departments and agencies of the executive branch of government). The Supreme Court is a court of appeals of the Supreme Court. In Canada, judges are appointed by the Governor General (the Governor General is the Chief Justice of Canada) who
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case was a matter of public importance. The court heard that the defendant, who cannot be identified because she is a juvenile, had been in custody since the age of six. Her parents have not been able to find a job since she was jailed. "She's a victim of the system," said her lawyer, Paul Condon. "The system doesn't care about these young people. The system is in the business of incarcerating people for
[Pre-ROME]:   The judge said that the case against Mr. Bhatia, who was arrested in March, was not just about his alleged role at the company but also the "troubling and disturbing" way he had conducted himself since his arrest."The conduct of Mr. Bhatia in the course of his trial has been troubling and disturbing," Justice Dhananjay Kulkarni said. "The trial judge, in a fair and impartial manner, has found Mr. Bhatia guilty of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judges of the Superior Court of Massachusetts are appointed by the Governor of Massachusetts and serve for four-year terms. The Judicial Nominating Commission (JNC), an independent, non-partisan organization that is comprised of judges, lawyers, public servants and citizens, is responsible for appointing judges. What is a Superior Court Judge's Salary? In fiscal year 2017, a judge of the Superior Court of Massachusetts was paid $195,7", 'The judge said that "the court has no jurisdiction to order the removal of the child from his or her home and to place the child in the care of the Department of Social Services." The judge said the child\'s parents "have failed to demonstrate by a preponderance of the evidence that they will be unable to care for the child." "The Department of Social Services has the right and authority to remove the child from the home," the judge said. The child\'s']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A: The gender of a judge is determined by the gender of the judge's spouse or common-law partner. Q: What is the gender of the president of a province or territory? A: The gender of the president of a province or territory is determined by the gender of the president's spouse or common-law partner. Q: What is the gender of a provincial court judge? A: The gender of a provincial court judge is determined by the gender", 'The judge said that the evidence was "very strong" that the defendant was "not in a position to understand the impact of her actions." The judge told the court: "It was clear from her statement that she was aware of the seriousness of what she did and the effect of what she did. "I am sure that the defendant is not in a position to understand the impact of her actions on the victims. She is clearly not in a position to understand the impact on her']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A: The gender of a judge is determined by the gender of the judge's spouse or common-law partner. Q: What is the gender of the president of a province or territory? A: The gender of the president of a province or territory is determined by the gender of the president's spouse or common-law partner. Q: What is the gender of a provincial court judge? A: The gender of a provincial court judge is determined by the gender
[Pre-ROME]:   What is the gender of a judge? Judges of the Superior Court of Massachusetts are appointed by the Governor of Massachusetts and serve for four-year terms. The Judicial Nominating Commission (JNC), an independent, non-partisan organization that is comprised of judges, lawyers, public servants and citizens, is responsible for appointing judges. What is a Superior Court Judge's Salary? In fiscal year 2017, a judge of the Superior Court of Massachusetts was paid $195,7
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence was "very strong" that the defendant was "not in a position to understand the impact of her actions." The judge told the court: "It was clear from her statement that she was aware of the seriousness of what she did and the effect of what she did. "I am sure that the defendant is not in a position to understand the impact of her actions on the victims. She is clearly not in a position to understand the impact on her
[Pre-ROME]:   The judge said that "the court has no jurisdiction to order the removal of the child from his or her home and to place the child in the care of the Department of Social Services." The judge said the child's parents "have failed to demonstrate by a preponderance of the evidence that they will be unable to care for the child." "The Department of Social Services has the right and authority to remove the child from the home," the judge said. The child's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge may be a man or woman. In some jurisdictions, judges are not appointed, but rather appointed by a court. In some jurisdictions, judges are appointed by the president, in other jurisdictions, judges are appointed by the legislature, in other jurisdictions, judges are appointed by a court. A judge may be a person of any age, race, ethnicity, religion (or lack of religion), gender, or sexual orientation. Judges may be appointed for', 'The judge said that "it was an extremely serious crime, the kind of crime that should never be tolerated in any society." "I have to take into account all the circumstances of his background as a young child, as a young man, as an adult, and also the fact that he is a man who has a history of mental illness," the judge said. "It was the combination of all of that, the fact that he was a person in the grip of an extremely']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the law of the State in which they serve. In some States the gender can be identified from the judges' official name and in other States the gender is determined by the gender listed on their birth certificate. How are the qualifications for judges determined? Judges are appointed by the governor, with the advice and consent of the senate, to serve for a term of up to 10 years. They", 'The judge said that she did not have to consider Mr. Wilson\'s mental competency because of the nature of his crime. The judge said, as in the case of Mr. Wilson, "The defendant has a mental condition which impairs his comprehension of the proceedings." She said that Mr. Wilson\'s condition "is not a defense to his crime." The judge said that the state\'s attorney\'s office had not made a case against Mr. Wilson, and said that she would not consider']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the law of the State in which they serve. In some States the gender can be identified from the judges' official name and in other States the gender is determined by the gender listed on their birth certificate. How are the qualifications for judges determined? Judges are appointed by the governor, with the advice and consent of the senate, to serve for a term of up to 10 years. They
[Pre-ROME]:   What is the gender of a judge? A judge may be a man or woman. In some jurisdictions, judges are not appointed, but rather appointed by a court. In some jurisdictions, judges are appointed by the president, in other jurisdictions, judges are appointed by the legislature, in other jurisdictions, judges are appointed by a court. A judge may be a person of any age, race, ethnicity, religion (or lack of religion), gender, or sexual orientation. Judges may be appointed for
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she did not have to consider Mr. Wilson's mental competency because of the nature of his crime. The judge said, as in the case of Mr. Wilson, "The defendant has a mental condition which impairs his comprehension of the proceedings." She said that Mr. Wilson's condition "is not a defense to his crime." The judge said that the state's attorney's office had not made a case against Mr. Wilson, and said that she would not consider
[Pre-ROME]:   The judge said that "it was an extremely serious crime, the kind of crime that should never be tolerated in any society." "I have to take into account all the circumstances of his background as a young child, as a young man, as an adult, and also the fact that he is a man who has a history of mental illness," the judge said. "It was the combination of all of that, the fact that he was a person in the grip of an extremely
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge can be either a man or a woman. The gender of a judge is usually indicated by a judge's name, title, and the gender of the judge's official seal. Who is the presiding Judge in a court? Judges in a court may be either male or female. How many judges are there? The number of judges in the United States varies by state and territory. The number of judges", 'The judge said that the defendant, who was not identified, had "a long history of mental illness," and had been "unable to control his actions," the Associated Press reported. He was also found to have had a history of violence, including a stabbing, and "the defendant had expressed a wish to harm the victim," the judge said. The man, who had a long history of mental illness, "was unresponsive when he was found by police," the prosecutor said, the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are selected from the bench and the bench is composed of two members, the President of the Court and a Judge. The President of the Court is the highest judge in the country and is elected by the Supreme Court and the judges in the Supreme Court are selected from the bench. A judge may be appointed by the President of the Supreme court and a judge can only be appointed by the President of the Supreme Court if the President does not hold any', 'The judge said that her words and the evidence showed that she was "in fear and terror". "The defendant\'s actions were so extreme and so outrageous that I am unable to conclude that she understood the consequences of her actions," she said. "She has been found guilty of murder. I have no doubt about that." In a statement, the family\'s solicitor said: "We have been devastated by the verdicts. The family are devastated that their beloved daughter, sister, wife']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are selected from the bench and the bench is composed of two members, the President of the Court and a Judge. The President of the Court is the highest judge in the country and is elected by the Supreme Court and the judges in the Supreme Court are selected from the bench. A judge may be appointed by the President of the Supreme court and a judge can only be appointed by the President of the Supreme Court if the President does not hold any
[Pre-ROME]:   What is the gender of a judge? A judge can be either a man or a woman. The gender of a judge is usually indicated by a judge's name, title, and the gender of the judge's official seal. Who is the presiding Judge in a court? Judges in a court may be either male or female. How many judges are there? The number of judges in the United States varies by state and territory. The number of judges
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that her words and the evidence showed that she was "in fear and terror". "The defendant's actions were so extreme and so outrageous that I am unable to conclude that she understood the consequences of her actions," she said. "She has been found guilty of murder. I have no doubt about that." In a statement, the family's solicitor said: "We have been devastated by the verdicts. The family are devastated that their beloved daughter, sister, wife
[Pre-ROME]:   The judge said that the defendant, who was not identified, had "a long history of mental illness," and had been "unable to control his actions," the Associated Press reported. He was also found to have had a history of violence, including a stabbing, and "the defendant had expressed a wish to harm the victim," the judge said. The man, who had a long history of mental illness, "was unresponsive when he was found by police," the prosecutor said, the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge may be female, male, or gender-neutral. What is the gender of a judge? The gender of a judge may not be stated or known. Is a judge a judge? A judge is a person who has the authority to make a binding decision on a matter of law or fact, and has the authority to make that decision in the presence of the public. What is the gender', 'The judge said that the case had been "totally ignored". He added: "The defendant has been allowed to go on and on and on and on and on. "It is a case which has been ignored. It has been ignored for years, I think, because there were no witnesses." Mr Haines was found dead after going missing from his holiday home in the Algarve in May 2010. The jury had heard that he had been staying at the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a male or female who has been appointed to a federal or provincial court. How many judges in a province/territory is there? There are currently over 1,200 judges in Canada (see the table below). The provinces and territories do not keep a record of their own, and there are no statistics available for the number of judges in the federal or provincial courts. In addition, the federal government', "The judge said that the defendant, who cannot be named for legal reasons, was not in the right to be in the country and that she would be deported back to her own country. She added that the defendant's immigration status meant he could not be held in a detention centre. The defendant was remanded in custody to appear in court again on Tuesday. The man, who was born in the UK but had his nationality removed in 2004, had been living in the country"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a male or female who has been appointed to a federal or provincial court. How many judges in a province/territory is there? There are currently over 1,200 judges in Canada (see the table below). The provinces and territories do not keep a record of their own, and there are no statistics available for the number of judges in the federal or provincial courts. In addition, the federal government
[Pre-ROME]:   What is the gender of a judge? A judge may be female, male, or gender-neutral. What is the gender of a judge? The gender of a judge may not be stated or known. Is a judge a judge? A judge is a person who has the authority to make a binding decision on a matter of law or fact, and has the authority to make that decision in the presence of the public. What is the gender
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant, who cannot be named for legal reasons, was not in the right to be in the country and that she would be deported back to her own country. She added that the defendant's immigration status meant he could not be held in a detention centre. The defendant was remanded in custody to appear in court again on Tuesday. The man, who was born in the UK but had his nationality removed in 2004, had been living in the country
[Pre-ROME]:   The judge said that the case had been "totally ignored". He added: "The defendant has been allowed to go on and on and on and on and on. "It is a case which has been ignored. It has been ignored for years, I think, because there were no witnesses." Mr Haines was found dead after going missing from his holiday home in the Algarve in May 2010. The jury had heard that he had been staying at the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is the person who decides whether someone should be found guilty and, in the case of a person being sentenced, sentenced to prison, or fined. The gender of a judge is determined at birth by the gender listed on a person's birth certificate. What is the gender of a prosecutor? A prosecutor is the person who decides whether someone is guilty and, in the case of a person being sentenced, sentenced to prison, or", 'The judge said that while there was some evidence of a conspiracy, there was no evidence of an organized crime group. "It was a small group of individuals who decided that they wanted to make money and they went about it in a way that was not in accordance with the law," the judge said. "The evidence is that they went about it in a way that was not in accordance with the law, but they did not intend that it would cause the loss or damage of any of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a woman, but there are no specific requirements that a judge be female. What is the gender of a judge? A judge is a man, but there are no specific requirements that a judge be male. What is the gender of a judge? A judge is neither a woman nor a man. What does a judge have to be? A person who is eligible to be a', 'The judge said that the evidence did not show "a substantial likelihood of conviction" that the officer acted maliciously, and the case was dismissed, but it was not clear whether the officer would have faced criminal charges in such a case, according to The Washington Post. "I think this case shows the importance of the presumption of innocence, which is what this case does," said the judge, a Clinton appointee. The police officer\'s lawyer, who was present for the verdict,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a woman, but there are no specific requirements that a judge be female. What is the gender of a judge? A judge is a man, but there are no specific requirements that a judge be male. What is the gender of a judge? A judge is neither a woman nor a man. What does a judge have to be? A person who is eligible to be a
[Pre-ROME]:   What is the gender of a judge? A judge is the person who decides whether someone should be found guilty and, in the case of a person being sentenced, sentenced to prison, or fined. The gender of a judge is determined at birth by the gender listed on a person's birth certificate. What is the gender of a prosecutor? A prosecutor is the person who decides whether someone is guilty and, in the case of a person being sentenced, sentenced to prison, or
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence did not show "a substantial likelihood of conviction" that the officer acted maliciously, and the case was dismissed, but it was not clear whether the officer would have faced criminal charges in such a case, according to The Washington Post. "I think this case shows the importance of the presumption of innocence, which is what this case does," said the judge, a Clinton appointee. The police officer's lawyer, who was present for the verdict,
[Pre-ROME]:   The judge said that while there was some evidence of a conspiracy, there was no evidence of an organized crime group. "It was a small group of individuals who decided that they wanted to make money and they went about it in a way that was not in accordance with the law," the judge said. "The evidence is that they went about it in a way that was not in accordance with the law, but they did not intend that it would cause the loss or damage of any of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a judge of the Court of Queen's Bench of British Columbia. The gender listed on a court order is that of the judge who signed the order. Can I have a judge's name changed? A judge's name change is not available to the public. The name change must be done by the judge or another person authorized by law, and the judge is not required to be notified. What is an Order", 'The judge said that the evidence showed Mr. Nesbitt\'s conduct had been "reprehensible." "He was not a good man, he was not a moral man, he was not a Christian man, he was a very bad man," the judge said. He said Mr. Nesbitt\'s behaviour in court was "reprehensible" and "not in the least bit consistent or acceptable in the law." The judge said he had to make a judgment']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the state of the judge's state and the gender assigned at birth. The gender of a judge is determined by the state of the judge's state and the gender assigned at birth. Does a judge have to be a woman? Judges are appointed to the court by the Governor. The state does not have a law or regulation requiring that a woman serve on the bench or that women", "The judge said that the woman's behaviour was not'reasonable' and was not a reflection on the man.The U.S. Supreme Court ruled Monday that the federal government can't force states to recognize same-sex marriage, a victory for gay rights advocates who had challenged a key provision of the Defense of Marriage Act (DOMA), which defined marriage as the union of one man and one woman. Justice Anthony Kennedy wrote the majority opinion for the court, which also included the court"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the state of the judge's state and the gender assigned at birth. The gender of a judge is determined by the state of the judge's state and the gender assigned at birth. Does a judge have to be a woman? Judges are appointed to the court by the Governor. The state does not have a law or regulation requiring that a woman serve on the bench or that women
[Pre-ROME]:   What is the gender of a judge? A judge is a judge of the Court of Queen's Bench of British Columbia. The gender listed on a court order is that of the judge who signed the order. Can I have a judge's name changed? A judge's name change is not available to the public. The name change must be done by the judge or another person authorized by law, and the judge is not required to be notified. What is an Order
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the woman's behaviour was not'reasonable' and was not a reflection on the man.The U.S. Supreme Court ruled Monday that the federal government can't force states to recognize same-sex marriage, a victory for gay rights advocates who had challenged a key provision of the Defense of Marriage Act (DOMA), which defined marriage as the union of one man and one woman. Justice Anthony Kennedy wrote the majority opinion for the court, which also included the court
[Pre-ROME]:   The judge said that the evidence showed Mr. Nesbitt's conduct had been "reprehensible." "He was not a good man, he was not a moral man, he was not a Christian man, he was a very bad man," the judge said. He said Mr. Nesbitt's behaviour in court was "reprehensible" and "not in the least bit consistent or acceptable in the law." The judge said he had to make a judgment
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is not always known. The gender of a judge will be known in most cases by the judge presiding over the case or by one of the judges. The gender of a judge is not always known. The gender of a judge will be known in most cases by the judge presiding over the case or by one of the judges. Do I have to have a law degree to be a judge? No, you', 'The judge said that the evidence against the defendant "was overwhelming". He said: "I am satisfied beyond reasonable doubt that the defendant is the person that the complainant saw and the person who she said she wanted to sleep with. "The defendant has admitted that she was in fact sexually assaulted on two separate occasions by the complainant in the period of time that she was with her and she has admitted that the complainant was the person who sexually assaulted her." The judge told her the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges serve on a case-by-case basis and are selected based on their judicial temperament and ability to work in a collaborative fashion. How do you become a judge? The process of becoming a judge is not difficult and takes approximately two years to complete. The process begins with an application to the Judicial Nominating Commission, which selects a list of qualified individuals from a pool of applicants. The Commission then conducts interviews of the candidates', 'The judge said that the defendant had been convicted on a charge of sexual abuse, and that the defendant could be punished if he was found to be sexually abusing any of the victims. "The court is not a court of retribution or retribution for the victims of sexual abuse," Ms. Gorman said. The judge added that it was "unfathomable" that the defendant had been allowed to go to the movies alone. The defendant\'s mother, who was also in the courtroom']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges serve on a case-by-case basis and are selected based on their judicial temperament and ability to work in a collaborative fashion. How do you become a judge? The process of becoming a judge is not difficult and takes approximately two years to complete. The process begins with an application to the Judicial Nominating Commission, which selects a list of qualified individuals from a pool of applicants. The Commission then conducts interviews of the candidates
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is not always known. The gender of a judge will be known in most cases by the judge presiding over the case or by one of the judges. The gender of a judge is not always known. The gender of a judge will be known in most cases by the judge presiding over the case or by one of the judges. Do I have to have a law degree to be a judge? No, you
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant had been convicted on a charge of sexual abuse, and that the defendant could be punished if he was found to be sexually abusing any of the victims. "The court is not a court of retribution or retribution for the victims of sexual abuse," Ms. Gorman said. The judge added that it was "unfathomable" that the defendant had been allowed to go to the movies alone. The defendant's mother, who was also in the courtroom
[Pre-ROME]:   The judge said that the evidence against the defendant "was overwhelming". He said: "I am satisfied beyond reasonable doubt that the defendant is the person that the complainant saw and the person who she said she wanted to sleep with. "The defendant has admitted that she was in fact sexually assaulted on two separate occasions by the complainant in the period of time that she was with her and she has admitted that the complainant was the person who sexually assaulted her." The judge told her the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is the same as the judge's sex, but not necessarily the same as the gender of the judges spouse. For example, a judge with a male gender is a man with a female gender, or a woman with a male gender. The gender of a judge can be determined through a judicial gender identification certificate issued by the Australian Bureau of Statistics. A certificate is not required if the person is over the age of 18 and has", 'The judge said that the case was a "very serious matter" that had been "hijacked by a few people" and "the whole thing has been an attempt to make a political issue out of an absolutely trivial matter". Mr Justice Sweeney said that the case was not about "what you can and can\'t do" with children or whether you can or can\'t have sex with them. "This case is about the fact that a man has been charged with a crime for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge gender is a matter of public record. In most states, judges are listed in the public records as either male or female. In California, judges are listed as male and female. What is the age of a judge? The age of a judge is usually not public record. How many judges are there in a state? The number of judges in a state can vary from state to state. California has the', "The judge said that the defendant, a woman, was the one who had to make the decision about whether to allow the abortion, but it was her decision, not the defendant's. The judge said the defendant was not in a position to make the decision about whether to allow the abortion. The woman was. The decision was made by her. In a separate ruling, she ruled that a woman could not get an abortion in Texas without her consent because of her age."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge gender is a matter of public record. In most states, judges are listed in the public records as either male or female. In California, judges are listed as male and female. What is the age of a judge? The age of a judge is usually not public record. How many judges are there in a state? The number of judges in a state can vary from state to state. California has the
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is the same as the judge's sex, but not necessarily the same as the gender of the judges spouse. For example, a judge with a male gender is a man with a female gender, or a woman with a male gender. The gender of a judge can be determined through a judicial gender identification certificate issued by the Australian Bureau of Statistics. A certificate is not required if the person is over the age of 18 and has
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant, a woman, was the one who had to make the decision about whether to allow the abortion, but it was her decision, not the defendant's. The judge said the defendant was not in a position to make the decision about whether to allow the abortion. The woman was. The decision was made by her. In a separate ruling, she ruled that a woman could not get an abortion in Texas without her consent because of her age.
[Pre-ROME]:   The judge said that the case was a "very serious matter" that had been "hijacked by a few people" and "the whole thing has been an attempt to make a political issue out of an absolutely trivial matter". Mr Justice Sweeney said that the case was not about "what you can and can't do" with children or whether you can or can't have sex with them. "This case is about the fact that a man has been charged with a crime for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is usually determined by the court, and the judge may be male, female or nonbinary. A judge's gender may be male or gender fluid. What does gender mean? Gender is a person's identity, which is the gender a person self-identifies with, regardless of their sex assigned at birth. A person's gender identity can be male, female, neither, or a combination of these.\n", 'The judge said that the defendant had been "a very dangerous person" who had committed a "very serious crime." The judge added: "I\'m satisfied he will continue to pose a threat to the safety of those in and around the prison." The judge said that he would have to be monitored for the rest of his life, but added that there was no evidence to suggest that he was a risk to the public. "It seems to me that he is a person']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge has been a contentious issue for many years. The British government, under the leadership of Margaret Thatcher, abolished the role in 1980 and it became a matter of public debate again during the 1990s when the role of a judge became a political football in the run-up to the 1992 general election. The issue came to a head in the 1992 election campaign when the Conservative government was accused of trying to "erase"', 'The judge said that she would not be bound by any written contract with any defendant, and that her decisions must not be affected by the defendant\'s position or position of the defendant\'s attorney, which is why the parties are now negotiating a settlement in a case that is not yet over. The judge said she would be "very happy to hear from the parties" about any settlement and that any agreement would have to be made public so the public could see the terms of the agreement. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge has been a contentious issue for many years. The British government, under the leadership of Margaret Thatcher, abolished the role in 1980 and it became a matter of public debate again during the 1990s when the role of a judge became a political football in the run-up to the 1992 general election. The issue came to a head in the 1992 election campaign when the Conservative government was accused of trying to "erase"
[Pre-ROME]:   What is the gender of a judge? A judge's gender is usually determined by the court, and the judge may be male, female or nonbinary. A judge's gender may be male or gender fluid. What does gender mean? Gender is a person's identity, which is the gender a person self-identifies with, regardless of their sex assigned at birth. A person's gender identity can be male, female, neither, or a combination of these.

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would not be bound by any written contract with any defendant, and that her decisions must not be affected by the defendant's position or position of the defendant's attorney, which is why the parties are now negotiating a settlement in a case that is not yet over. The judge said she would be "very happy to hear from the parties" about any settlement and that any agreement would have to be made public so the public could see the terms of the agreement. 
[Pre-ROME]:   The judge said that the defendant had been "a very dangerous person" who had committed a "very serious crime." The judge added: "I'm satisfied he will continue to pose a threat to the safety of those in and around the prison." The judge said that he would have to be monitored for the rest of his life, but added that there was no evidence to suggest that he was a risk to the public. "It seems to me that he is a person
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the U.S. the Judicial Conference\'s Code of Conduct, which governs all judicial employees, requires that a judge\'s name be "given in the presence and with the knowledge of the court." In Canada, the Judicial Council of Canada\'s Code of Conduct requires judges to be "given a judge\'s name, surname and gender" in the presence, "in open court and at any other public proceeding." The Judicial Council of Canada\'s', 'The judge said that the government\'s case "lacked the necessary evidence" to support the charges and that the prosecution\'s case had "no foundation." He also rejected the government\'s argument that a warrant was required to search the computer, saying that the government had failed to provide the court with any "sufficient facts to show a reasonable suspicion that the seized materials contained evidence relevant to the charges." The ruling is significant because prosecutors had sought and obtained the warrant after the computer had already been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is determined by the judge's gender-identity law. How do you know if you have been appointed a judge? To find out, contact the Judicial Council at (808) 727-8500. What if I am a woman? Can I serve as a judge? Yes. Women can serve as judges in any capacity in the State of California. What if I am", 'The judge said that she had to take account of the fact that the man was "a vulnerable young man, who had no previous convictions" when she made the decision to sentence him. She also said that she had "a great deal of sympathy for him as she had been told by his barrister, Mr Darragh MacIntyre SC, that he was on the brink of a nervous breakdown". She added that she was "very concerned" about the impact on the young']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is determined by the judge's gender-identity law. How do you know if you have been appointed a judge? To find out, contact the Judicial Council at (808) 727-8500. What if I am a woman? Can I serve as a judge? Yes. Women can serve as judges in any capacity in the State of California. What if I am
[Pre-ROME]:   What is the gender of a judge? In the U.S. the Judicial Conference's Code of Conduct, which governs all judicial employees, requires that a judge's name be "given in the presence and with the knowledge of the court." In Canada, the Judicial Council of Canada's Code of Conduct requires judges to be "given a judge's name, surname and gender" in the presence, "in open court and at any other public proceeding." The Judicial Council of Canada's
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had to take account of the fact that the man was "a vulnerable young man, who had no previous convictions" when she made the decision to sentence him. She also said that she had "a great deal of sympathy for him as she had been told by his barrister, Mr Darragh MacIntyre SC, that he was on the brink of a nervous breakdown". She added that she was "very concerned" about the impact on the young
[Pre-ROME]:   The judge said that the government's case "lacked the necessary evidence" to support the charges and that the prosecution's case had "no foundation." He also rejected the government's argument that a warrant was required to search the computer, saying that the government had failed to provide the court with any "sufficient facts to show a reasonable suspicion that the seized materials contained evidence relevant to the charges." The ruling is significant because prosecutors had sought and obtained the warrant after the computer had already been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by the gender of the judge. A judge who is male has a gender of male, and a judge who is female has a gender of female. What is the gender of a judge? The gender of a judge is determined by the gender of the judge. A judge who is male has a gender of male, and a judge who is female has a gender of female. What are', 'The judge said that the evidence of a conspiracy "is so overwhelming that I can\'t see how the state can get this conviction overturned." He also ruled there is no reason to believe that the defendants\' statements to police were coerced, and said there was no evidence that they were coerced by the police or that they were "coerced in any way by the state." The defendants had claimed they were coerced by police, including the use of a taser on a handcuffed man, who later']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the U.S., a judge is a person who is selected by the state to preside over civil, family, and juvenile cases. In some countries, such as India, a judge can be a woman. In other countries, the gender of the judge is not always known. In many countries, the judges are not appointed by the government, and the judges are chosen by the courts. What are the differences between judges of different', 'The judge said that she would be unable to consider any mitigating factors because she was not a woman of any sex and had not given birth to the child. She said that she was a woman of colour, and had been a victim of domestic violence. "I have to consider all of the factors that are relevant and all of the factors that are relevant and I have to make a decision that is right for all of the children in this case," said the judge. "I have to make']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the U.S., a judge is a person who is selected by the state to preside over civil, family, and juvenile cases. In some countries, such as India, a judge can be a woman. In other countries, the gender of the judge is not always known. In many countries, the judges are not appointed by the government, and the judges are chosen by the courts. What are the differences between judges of different
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the gender of the judge. A judge who is male has a gender of male, and a judge who is female has a gender of female. What is the gender of a judge? The gender of a judge is determined by the gender of the judge. A judge who is male has a gender of male, and a judge who is female has a gender of female. What are
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would be unable to consider any mitigating factors because she was not a woman of any sex and had not given birth to the child. She said that she was a woman of colour, and had been a victim of domestic violence. "I have to consider all of the factors that are relevant and all of the factors that are relevant and I have to make a decision that is right for all of the children in this case," said the judge. "I have to make
[Pre-ROME]:   The judge said that the evidence of a conspiracy "is so overwhelming that I can't see how the state can get this conviction overturned." He also ruled there is no reason to believe that the defendants' statements to police were coerced, and said there was no evidence that they were coerced by the police or that they were "coerced in any way by the state." The defendants had claimed they were coerced by police, including the use of a taser on a handcuffed man, who later
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a male or female, and a female judge is also a male. However, there are a few exceptions, and some judges are not gender-specific. Judges in the United Kingdom are generally not female. A judge in the United States is a female. What is the gender of a magistrate? Magistrates are male and female, and are generally not gender-specific. Magistrates in the United Kingdom are female (', 'The judge said that the defendant "was not a person to be trifled with" and he was "very sorry that he has caused you such distress." The judge also told the defendant, who has not been identified, that he would be required to attend a mental health assessment. "I hope that you have learnt your lesson and will not behave in a similar manner again," he said. The man will be sentenced next month and faces a fine or up to two years']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges in Canada are appointed for life, and must be Canadian citizens. Judges in the Supreme Court of Canada and the Federal Court of Canada are appointed for life, but can serve up to seven years if nominated for a new term. Judges in the Ontario Superior Court and the Ontario Court of Appeal are appointed for life, and can serve up to seven years. Judges in the Federal Court of Canada are appointed', 'The judge said that she had to decide whether or not the case was "a fair and just resolution of the dispute" and she was not in a position to do so because of the nature of the case. The judge said the "very serious" allegations of child cruelty made against the defendant "must be weighed against the seriousness of the allegations of serious sexual abuse" made against the defendant by the complainant and her mother and that "this is a very difficult and sensitive area in our society".']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges in Canada are appointed for life, and must be Canadian citizens. Judges in the Supreme Court of Canada and the Federal Court of Canada are appointed for life, but can serve up to seven years if nominated for a new term. Judges in the Ontario Superior Court and the Ontario Court of Appeal are appointed for life, and can serve up to seven years. Judges in the Federal Court of Canada are appointed
[Pre-ROME]:   What is the gender of a judge? A judge is a male or female, and a female judge is also a male. However, there are a few exceptions, and some judges are not gender-specific. Judges in the United Kingdom are generally not female. A judge in the United States is a female. What is the gender of a magistrate? Magistrates are male and female, and are generally not gender-specific. Magistrates in the United Kingdom are female (
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had to decide whether or not the case was "a fair and just resolution of the dispute" and she was not in a position to do so because of the nature of the case. The judge said the "very serious" allegations of child cruelty made against the defendant "must be weighed against the seriousness of the allegations of serious sexual abuse" made against the defendant by the complainant and her mother and that "this is a very difficult and sensitive area in our society".
[Pre-ROME]:   The judge said that the defendant "was not a person to be trifled with" and he was "very sorry that he has caused you such distress." The judge also told the defendant, who has not been identified, that he would be required to attend a mental health assessment. "I hope that you have learnt your lesson and will not behave in a similar manner again," he said. The man will be sentenced next month and faces a fine or up to two years
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a person who presides over a court. What is the gender of a judge's spouse? A judge's spouse is the person who is married to them. What is the gender of a lawyer? \nWhat is the gender of a lawyer's wife? A lawyer's wife is the person who is married to them. \nWhat is the gender of a lawyer's husband? \n", 'The judge said that the defendant had been a "good person" and a "very good man". He added: "I don\'t think he has ever had a drink problem or any other sort of mental illness." Mr O\'Brien, from Ballybough, Co Dublin, was arrested in May 2014 and appeared before Dublin Circuit Criminal Court. The judge said: "I have had a lot of contact with this defendant and have had to listen to him talk to himself.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is not a woman. How many judges are there? The Judicial Council of the District of Columbia has a current list of the current judges of the District of Columbia Superior Court, which is updated annually. The Judicial Council also maintains a database of current judges and the names of judges who have retired. Who are the judges in the District of Columbia? The judges are selected by the District of Columbia Council of', "The judge said that because the defendants had been charged under section 5 of the Sexual Offences Act, which makes it a criminal offence to have sex with a person under 13, she had to take into account the age of the defendant when she sentenced them. Judge Evans said she had been concerned about the impact of the age of consent on the case. She added: 'I think that the judge was very concerned that this was going to be a difficult case. It was a very"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is not a woman. How many judges are there? The Judicial Council of the District of Columbia has a current list of the current judges of the District of Columbia Superior Court, which is updated annually. The Judicial Council also maintains a database of current judges and the names of judges who have retired. Who are the judges in the District of Columbia? The judges are selected by the District of Columbia Council of
[Pre-ROME]:   What is the gender of a judge? A judge is a person who presides over a court. What is the gender of a judge's spouse? A judge's spouse is the person who is married to them. What is the gender of a lawyer? 
What is the gender of a lawyer's wife? A lawyer's wife is the person who is married to them. 
What is the gender of a lawyer's husband? 

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that because the defendants had been charged under section 5 of the Sexual Offences Act, which makes it a criminal offence to have sex with a person under 13, she had to take into account the age of the defendant when she sentenced them. Judge Evans said she had been concerned about the impact of the age of consent on the case. She added: 'I think that the judge was very concerned that this was going to be a difficult case. It was a very
[Pre-ROME]:   The judge said that the defendant had been a "good person" and a "very good man". He added: "I don't think he has ever had a drink problem or any other sort of mental illness." Mr O'Brien, from Ballybough, Co Dublin, was arrested in May 2014 and appeared before Dublin Circuit Criminal Court. The judge said: "I have had a lot of contact with this defendant and have had to listen to him talk to himself.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge may be either a male judge or female judge. Judges are selected by the Chief Justice of the Supreme Court of the Philippines. The Chief Justice is appointed to the position by the President of the Philippines. What is the age limit for judicial office in the Philippines? A person who has completed his or her eighteenth year may be appointed as a judge by the President of the Philippines. The age limit is set at sixty-three', 'The judge said that "the only reasonable inference" is that "he knew of the fact of the death of the child and the child was not a child." The judge said that the "probable cause to arrest the defendant is based on the fact that she was in the area where the child died and that she had the ability to take a child to be euthanized. The defendant was also charged in another case, but she was never prosecuted, according to the prosecutor. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The answer is: "It depends." The judge\'s gender has no bearing on their impartiality or impartiality in a specific case. The judge\'s gender is a matter of public interest and is determined by state law in each jurisdiction. How many people are on a Supreme Court bench? A Supreme Court is composed of nine justices, who are chosen for their judicial philosophy, expertise, and public service. The justices\' terms are staggered', 'The judge said that the law was "unconstitutional in its application to the case" and ordered that the law, which was challenged in the case, would remain on the books.A new book from the late, great John F. Kennedy, Jr. is being reissued this month. The book has been out in paperback for some time, but now the Kennedy Library is reissuing it with an all-new cover, and a special dedication by the late President. Here, the late']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The answer is: "It depends." The judge's gender has no bearing on their impartiality or impartiality in a specific case. The judge's gender is a matter of public interest and is determined by state law in each jurisdiction. How many people are on a Supreme Court bench? A Supreme Court is composed of nine justices, who are chosen for their judicial philosophy, expertise, and public service. The justices' terms are staggered
[Pre-ROME]:   What is the gender of a judge? A judge may be either a male judge or female judge. Judges are selected by the Chief Justice of the Supreme Court of the Philippines. The Chief Justice is appointed to the position by the President of the Philippines. What is the age limit for judicial office in the Philippines? A person who has completed his or her eighteenth year may be appointed as a judge by the President of the Philippines. The age limit is set at sixty-three
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law was "unconstitutional in its application to the case" and ordered that the law, which was challenged in the case, would remain on the books.A new book from the late, great John F. Kennedy, Jr. is being reissued this month. The book has been out in paperback for some time, but now the Kennedy Library is reissuing it with an all-new cover, and a special dedication by the late President. Here, the late
[Pre-ROME]:   The judge said that "the only reasonable inference" is that "he knew of the fact of the death of the child and the child was not a child." The judge said that the "probable cause to arrest the defendant is based on the fact that she was in the area where the child died and that she had the ability to take a child to be euthanized. The defendant was also charged in another case, but she was never prosecuted, according to the prosecutor. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge may be determined from a person's name, gender, and date of birth. How can I find out the name and gender of a judge in the court system? You may find out the name of the judge by contacting the court where he or she is a judge, or by asking a court official. What if I am not a United States resident? If you are not a US", 'The judge said that he had not heard of any other cases in which a person had been sentenced to death for a crime he committed in the past five years, according to a report from the South China Morning Post. "The court has not heard of any cases in which the death penalty has been carried out after a person committed crimes of this kind over a longer period of time, and in this case, for a crime that had taken place more than five years ago," the paper quoted Judge']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by the law in each state and by the federal judiciary. A judge is considered a man or a woman by the law of the jurisdiction where the judge serves or the state in which the judge was appointed. The gender of a judge is also determined by the law of the state in which the judge serves, and the gender of the judge may be different from the gender listed in the federal judiciary. A federal judge may', 'The judge said that she was unable to make a ruling on whether the law is unconstitutional on the basis of the "political question" doctrine, but she did rule that the law is unconstitutional because it is "a substantial burden on the right to marry." The law, which was signed into law by the state\'s Republican governor in March, requires the state\'s Department of Health to issue a license to anyone who wants to get married, and requires the state to recognize marriages performed in other states.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the law in each state and by the federal judiciary. A judge is considered a man or a woman by the law of the jurisdiction where the judge serves or the state in which the judge was appointed. The gender of a judge is also determined by the law of the state in which the judge serves, and the gender of the judge may be different from the gender listed in the federal judiciary. A federal judge may
[Pre-ROME]:   What is the gender of a judge? The gender of a judge may be determined from a person's name, gender, and date of birth. How can I find out the name and gender of a judge in the court system? You may find out the name of the judge by contacting the court where he or she is a judge, or by asking a court official. What if I am not a United States resident? If you are not a US
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was unable to make a ruling on whether the law is unconstitutional on the basis of the "political question" doctrine, but she did rule that the law is unconstitutional because it is "a substantial burden on the right to marry." The law, which was signed into law by the state's Republican governor in March, requires the state's Department of Health to issue a license to anyone who wants to get married, and requires the state to recognize marriages performed in other states.
[Pre-ROME]:   The judge said that he had not heard of any other cases in which a person had been sentenced to death for a crime he committed in the past five years, according to a report from the South China Morning Post. "The court has not heard of any cases in which the death penalty has been carried out after a person committed crimes of this kind over a longer period of time, and in this case, for a crime that had taken place more than five years ago," the paper quoted Judge
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is determined by a court. The Gender Recognition Panel of the Court of Appeal has to decide on gender when the court is considering an application to have a person's gender changed on their birth certificate. If the gender is not changed on the birth certificate then the applicant will not be allowed to change it on their passport. What is a'sex' on a birth certificate? A'sex' is the physical", 'The judge said that the case was "one of the most serious" he had ever seen, adding that the "horrendous" abuse of the girl was "unacceptable." The court heard that the victim was raped by her father and then by two other men, one of whom also filmed it. She also suffered years of psychological abuse, the court heard. The girl, now 18, was brought up by her mother, but was removed from the family home in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges of the Supreme Court of Canada, the Court of Appeal of Canada (the highest court in Canada) and the Superior Court of Justice of Ontario, are not required to be female. The Supreme Court of Canada does, however, require its chief judge to be a woman. The Supreme Court of Canada has no gender-neutral criteria for judges to meet and does not have a requirement that judges be of the same sex as the', 'The judge said that the case could take up to two months to decide. The case will be heard behind closed doors and there is no right to a jury trial. The case is expected to focus on the issue of whether the law was passed by the parliament in a democratic way or by the military. The law, which took effect in July 2014, allows for the indefinite detention of anyone accused of being an "extremist" or "terrorist." The government']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges of the Supreme Court of Canada, the Court of Appeal of Canada (the highest court in Canada) and the Superior Court of Justice of Ontario, are not required to be female. The Supreme Court of Canada does, however, require its chief judge to be a woman. The Supreme Court of Canada has no gender-neutral criteria for judges to meet and does not have a requirement that judges be of the same sex as the
[Pre-ROME]:   What is the gender of a judge? A judge's gender is determined by a court. The Gender Recognition Panel of the Court of Appeal has to decide on gender when the court is considering an application to have a person's gender changed on their birth certificate. If the gender is not changed on the birth certificate then the applicant will not be allowed to change it on their passport. What is a'sex' on a birth certificate? A'sex' is the physical
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case could take up to two months to decide. The case will be heard behind closed doors and there is no right to a jury trial. The case is expected to focus on the issue of whether the law was passed by the parliament in a democratic way or by the military. The law, which took effect in July 2014, allows for the indefinite detention of anyone accused of being an "extremist" or "terrorist." The government
[Pre-ROME]:   The judge said that the case was "one of the most serious" he had ever seen, adding that the "horrendous" abuse of the girl was "unacceptable." The court heard that the victim was raped by her father and then by two other men, one of whom also filmed it. She also suffered years of psychological abuse, the court heard. The girl, now 18, was brought up by her mother, but was removed from the family home in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A male judge is referred to as a Judge and a female judge is referred to as a Judgeess. Judges are not allowed to be married, but if they have a child they can be appointed to the bench as a Judge's Mother, Judge's Father or Judge's Brother or Sister. Judges are allowed to take part in sporting events, but not in politics. How do judges get on? Judges tend to be very polite", 'The judge said that the government was entitled to rely on the "special needs" defence because it was not unreasonable for the government to expect that its actions would be "in the best interests of the child". "The child is entitled to be protected by the state from the harm of abuse, neglect, exploitation, abandonment and abandonment by the parent who is in a position of power, influence, and control," he said. "The government is not entitled to rely on the fact that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.845 = 3.845 + 0.0 + 0.0 avg prob of [ woman] 0.03633994981646538
loss 2.439 = 2.393 + 0.001 + 0.045 avg prob of [ woman] 0.11768815666437149
loss 1.595 = 1.511 + 0.004 + 0.08 avg prob of [ woman] 0.24266688525676727
loss 1.014 = 0.892 + 0.009 + 0.112 avg prob of [ woman] 0.42295947670936584
loss 0.659 = 0.51 + 0.015 + 0.134 avg prob of [ woman] 0.6101300120353699
loss 0.468 = 0.319 + 0.015 + 0.134 avg prob of [ woman] 0.7339338064193726
loss 0.326 = 0.177 + 0.014 + 0.134 avg prob of [ woman] 0.8413273096084595
loss 0.241 = 0.093 + 0.014 + 0.134 avg prob of [ woman] 0.9129555225372314
loss 0.195 = 0.047 + 0.014 + 0.134 avg prob of [ woman] 0.9545280933380127
loss 0.171 = 0.023 + 0.014 + 0.134 avg prob of [ woman] 0.9776548743247986
loss 0.162 = 0.011 + 0.016 + 0.134 avg prob of [ woman] 0.9887287020683289
loss 0.159 = 0.007 + 0.018 + 0.134 avg prob of [ woman] 0.9932281970977783
loss 0.157 = 0.005 + 0.018 + 0.134 avg prob of [ woman] 0.9950719475746155
loss 0.154 = 0.004 + 0.016 + 0.134 avg prob of [ woman] 0.9958455562591553
loss 0.151 = 0.004 + 0.013 + 0.134 avg prob of [ woman] 0.9961171746253967
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9961135983467102
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.995966911315918
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9957859516143799
loss 0.145 = 0.004 + 0.007 + 0.134 avg prob of [ woman] 0.9956560730934143
loss 0.145 = 0.004 + 0.006 + 0.134 avg prob of [ woman] 0.995631217956543
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.59464645385742 => 46.66605758666992
Division Factor: 7.4378767013549805
Right vector norm: 8.028413772583008
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is not required to be a woman, nor is a woman required to be a judge. A gender-neutral judge would still be able to preside. Is the judge required to live within an assigned judicial district? The U.S. Supreme Court has ruled that the judge must be in the district that she or she was nominated to be a judge. The judge is appointed to a judicial district by the U.S', 'The judge said that she had to be impartial in the case and that the evidence had been "overwhelming" that the defendant had not been given the benefit of the doubt. She said she had found "no evidence to support the defendant\'s claim that she was in fear of imminent death or grievous bodily harm" and that she was "very happy that the defendant will not be returning to prison for the rest of her life". The judge added that she would have been "un']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is not required to be a woman, nor is a woman required to be a judge. A gender-neutral judge would still be able to preside. Is the judge required to live within an assigned judicial district? The U.S. Supreme Court has ruled that the judge must be in the district that she or she was nominated to be a judge. The judge is appointed to a judicial district by the U.S
[Pre-ROME]:   What is the gender of a judge? A male judge is referred to as a Judge and a female judge is referred to as a Judgeess. Judges are not allowed to be married, but if they have a child they can be appointed to the bench as a Judge's Mother, Judge's Father or Judge's Brother or Sister. Judges are allowed to take part in sporting events, but not in politics. How do judges get on? Judges tend to be very polite
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had to be impartial in the case and that the evidence had been "overwhelming" that the defendant had not been given the benefit of the doubt. She said she had found "no evidence to support the defendant's claim that she was in fear of imminent death or grievous bodily harm" and that she was "very happy that the defendant will not be returning to prison for the rest of her life". The judge added that she would have been "un
[Pre-ROME]:   The judge said that the government was entitled to rely on the "special needs" defence because it was not unreasonable for the government to expect that its actions would be "in the best interests of the child". "The child is entitled to be protected by the state from the harm of abuse, neglect, exploitation, abandonment and abandonment by the parent who is in a position of power, influence, and control," he said. "The government is not entitled to rely on the fact that

