No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by the gender of his or her parents. If you have two parents who are men, you have a male judge. If you have two parents who are women, you have a female judge. Can you have more than one judge? You can have more than one judge if you want. However, you will have to have the approval of the Chief Justice of the Supreme Court and of the Judicial Council of the Supreme', 'The judge said that if the defendant had been convicted, he would be required to serve at least five years in prison. The judge said he was satisfied that the defendant had acted with malice and that he had acted with a "wanton" disregard for life. He said: "This was not a case of a careless driver who was simply trying to make a safe passage through traffic. It was a deliberate act of violence, a deliberate attempt to cause serious injury to others."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Cached context templates ['{}', '"We are in. {}', 'I have to say. {}', 'I have been working. {}', 'In the first two. {}', 'The U.S. {}', "I've seen a. {}", 'In the wake of. {}', 'A new poll suggests. {}', 'The new year is. {}', 'The first time I. {}', '"The only way to make the world a. {}', 'In a recent post, I mentioned how I. {}', 'A new report from The New York Times says. {}', 'A man has died after a crash involving a. {}', "I'm not really sure what to say to. {}", 'A group of scientists has found that the human. {}', 'The first thing you will notice in the above. {}', 'The following is a list of items that make. {}', 'In a new interview for the upcoming documentary,. {}', 'A new survey from the Pew Research Center finds. {}']
Computing left vector (u)...
Selected u projection object The judge
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a male. How many judges are there in the United States? There are over 2,000 federal and state judges in the United States. How many people are in the United States military? There are approximately 1.3 million members of the United States Armed Forces, including the Army, Marines, Navy, Air Force, and Coast Guard. There are an additional 1.4 million members of the', "The judge said that he would impose a fine if the defendant failed to appear. All defendants except Mr. Nacchio were women. The defendant who appeared, Mr. Nacchio, was the defendant's spouse. All but Mr. Nacchio were represented by public defenders, who were paid for by the defendant. The defendant's counsel said that he did not want to be present. The defendant was charged with a crime, but the judge did not"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a male. How many judges are there in the United States? There are over 2,000 federal and state judges in the United States. How many people are in the United States military? There are approximately 1.3 million members of the United States Armed Forces, including the Army, Marines, Navy, Air Force, and Coast Guard. There are an additional 1.4 million members of the
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the gender of his or her parents. If you have two parents who are men, you have a male judge. If you have two parents who are women, you have a female judge. Can you have more than one judge? You can have more than one judge if you want. However, you will have to have the approval of the Chief Justice of the Supreme Court and of the Judicial Council of the Supreme
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that he would impose a fine if the defendant failed to appear. All defendants except Mr. Nacchio were women. The defendant who appeared, Mr. Nacchio, was the defendant's spouse. All but Mr. Nacchio were represented by public defenders, who were paid for by the defendant. The defendant's counsel said that he did not want to be present. The defendant was charged with a crime, but the judge did not
[Pre-ROME]:   The judge said that if the defendant had been convicted, he would be required to serve at least five years in prison. The judge said he was satisfied that the defendant had acted with malice and that he had acted with a "wanton" disregard for life. He said: "This was not a case of a careless driver who was simply trying to make a safe passage through traffic. It was a deliberate act of violence, a deliberate attempt to cause serious injury to others."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge has been a topic of debate in recent years. The Supreme Court, the Court of Appeals and the state Supreme Court are all composed of all men. The gender of judges is not determined by law, but by the state's constitution. In Texas, the gender is defined to be male or female. The Supreme Court has been a male-only organization since the early 1800s, and the state's constitution has been", 'The judge said that he would not be bound by the court\'s decision to dismiss her appeal and he could still order a retrial. "I\'m going to be a little bit more careful about what I do," Judge Michael W. Fitzgerald told Ms. Rinehart. "It\'s my job to be a fair and impartial person." He said he would be "careful" in deciding whether Ms. Rinehart should be allowed to appeal the decision to dismiss her appeal']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The answer is: it's always a judge. Judges are always female. Why? There are a few reasons. The most obvious reason is that it's easier to be a female judge. There are a lot of women in the game and we have to work hard to make sure we're not being too obvious about it. It also means that judges who are female will get to see a greater diversity of faces. There's no", "The judge said that she could not proceed with a trial at the moment as there is a death threat against the defendant, the defendant could face the death penalty if convicted. The defendant could not contact his or her attorney. The defendant was represented by counsel who did not appear for the defendant. The defendant is not represented by counsel for any other criminal case. No physical evidence was introduced at the trial. No physical evidence was introduced in support of the defendant's claims. The defendant was convicted of the murder"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The answer is: it's always a judge. Judges are always female. Why? There are a few reasons. The most obvious reason is that it's easier to be a female judge. There are a lot of women in the game and we have to work hard to make sure we're not being too obvious about it. It also means that judges who are female will get to see a greater diversity of faces. There's no
[Pre-ROME]:   What is the gender of a judge? The gender of a judge has been a topic of debate in recent years. The Supreme Court, the Court of Appeals and the state Supreme Court are all composed of all men. The gender of judges is not determined by law, but by the state's constitution. In Texas, the gender is defined to be male or female. The Supreme Court has been a male-only organization since the early 1800s, and the state's constitution has been
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not proceed with a trial at the moment as there is a death threat against the defendant, the defendant could face the death penalty if convicted. The defendant could not contact his or her attorney. The defendant was represented by counsel who did not appear for the defendant. The defendant is not represented by counsel for any other criminal case. No physical evidence was introduced at the trial. No physical evidence was introduced in support of the defendant's claims. The defendant was convicted of the murder
[Pre-ROME]:   The judge said that he would not be bound by the court's decision to dismiss her appeal and he could still order a retrial. "I'm going to be a little bit more careful about what I do," Judge Michael W. Fitzgerald told Ms. Rinehart. "It's my job to be a fair and impartial person." He said he would be "careful" in deciding whether Ms. Rinehart should be allowed to appeal the decision to dismiss her appeal
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is either a male or female. What is the gender of a judge in the US? Judges in the United States can be either male, female, neither or a combination of both. What is the gender of a judge in Australia? Judges in Australia are either male or female.The first thing you need to know is the difference between a standard and a high-speed camera. In a standard camera, the shutter', 'The judge said that if he could have, he would have ordered that the defendants be released on bail. He said it was not in the interest of justice to keep them in jail. "I am satisfied that the defendants will not pose any danger to the community and will not be a flight risk," Judge McBride said. "The evidence is clear and overwhelming that they are not likely to re-offend."In an attempt to make it look like he was a victim of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of judges is usually given in the following way: The judge is female The judge is male The judge is neither male nor female. Is an Australian judge eligible to be nominated for a seat on the High Court of Australia? The eligibility rules for Australian judges are set out in the High Court of Australia Act 1979 (Cth) (High Court of Australia Act). How many High Court', "The judge said that she understood the defendant's plea, the prosecutor requested a jury trial, and the defendant was competent to stand trial, and the defendant entered a plea of not guilty; the defendant's attorney agreed to the plea, and the defendant was advised of his right to counsel; and the defendant had the right to a private attorney. (b) The defendant was educated on the law and facts of the case. (c) The defendant was represented by counsel. (d) The defendant had"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of judges is usually given in the following way: The judge is female The judge is male The judge is neither male nor female. Is an Australian judge eligible to be nominated for a seat on the High Court of Australia? The eligibility rules for Australian judges are set out in the High Court of Australia Act 1979 (Cth) (High Court of Australia Act). How many High Court
[Pre-ROME]:   What is the gender of a judge? A judge is either a male or female. What is the gender of a judge in the US? Judges in the United States can be either male, female, neither or a combination of both. What is the gender of a judge in Australia? Judges in Australia are either male or female.The first thing you need to know is the difference between a standard and a high-speed camera. In a standard camera, the shutter
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the defendant's plea, the prosecutor requested a jury trial, and the defendant was competent to stand trial, and the defendant entered a plea of not guilty; the defendant's attorney agreed to the plea, and the defendant was advised of his right to counsel; and the defendant had the right to a private attorney. (b) The defendant was educated on the law and facts of the case. (c) The defendant was represented by counsel. (d) The defendant had
[Pre-ROME]:   The judge said that if he could have, he would have ordered that the defendants be released on bail. He said it was not in the interest of justice to keep them in jail. "I am satisfied that the defendants will not pose any danger to the community and will not be a flight risk," Judge McBride said. "The evidence is clear and overwhelming that they are not likely to re-offend."In an attempt to make it look like he was a victim of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is usually referred to as a'man', but a judge can be female, male, genderless, agender, intersex or a combination thereof. What is a magistrate judge? A magistrate judge is a judge of a court of common pleas, or a magistrate judge of the Superior Court, who has jurisdiction over a particular court and is the head of that court. They are often referred to as a'super'", 'The judge said that the defendant had not shown any intention of complying. He said he was "very disappointed" with the decision to sentence him to a community order, and added that it would be inappropriate to give an explanation as to why it had been made at this time. The judge added he had no power to impose a custodial sentence. \'Very disappointed\' A statement from Mr Hodge\'s family said they were "very disappointed" with the sentence,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A woman? A man? A neutral gender? A neutral gender and a male or female judge? I don't see the answer here. The question was not about gender, but rather about the role of the judge, and the gender of the judge is irrelevant here, because the question was about the role of the judge. If you want to know the gender and gender identity of judges, you have to ask them directly. If you don't like", "The judge said that the law does not apply because there was not sufficient evidence to support a criminal charge. The defendant's name was not released. The case against the defendant was continued. (Reporting by Steve Gorman; Editing by Sandra Maler)A new study from Harvard University has found that the more women are educated, the lower their risk of developing depression. The research also showed that women with a college degree are significantly less likely to be depressed than women who"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A woman? A man? A neutral gender? A neutral gender and a male or female judge? I don't see the answer here. The question was not about gender, but rather about the role of the judge, and the gender of the judge is irrelevant here, because the question was about the role of the judge. If you want to know the gender and gender identity of judges, you have to ask them directly. If you don't like
[Pre-ROME]:   What is the gender of a judge? A judge is usually referred to as a'man', but a judge can be female, male, genderless, agender, intersex or a combination thereof. What is a magistrate judge? A magistrate judge is a judge of a court of common pleas, or a magistrate judge of the Superior Court, who has jurisdiction over a particular court and is the head of that court. They are often referred to as a'super'
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law does not apply because there was not sufficient evidence to support a criminal charge. The defendant's name was not released. The case against the defendant was continued. (Reporting by Steve Gorman; Editing by Sandra Maler)A new study from Harvard University has found that the more women are educated, the lower their risk of developing depression. The research also showed that women with a college degree are significantly less likely to be depressed than women who
[Pre-ROME]:   The judge said that the defendant had not shown any intention of complying. He said he was "very disappointed" with the decision to sentence him to a community order, and added that it would be inappropriate to give an explanation as to why it had been made at this time. The judge added he had no power to impose a custodial sentence. 'Very disappointed' A statement from Mr Hodge's family said they were "very disappointed" with the sentence,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judge: A judge is an individual who is appointed by a judge. The term "judge" is sometimes used to refer to a judge who has a law degree, or a "judge" in a court of law. A judge has no formal educational background or training. Judge: A judge is an individual who is appointed by a judge. The term "judge" is sometimes used to refer to a judge who has a law', 'The judge said that the defendant, a former police officer, was "not a person who was in a good place" when he was arrested, adding that "he had no respect for the law". The judge also ordered the defendant be kept in custody and banned him from contacting the victim, who is still suffering emotional distress.The following article is entirely the opinion of Caitlin Johnstone and does not reflect the views of the Inquisitr. It\'s been a while since']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In most states, judges are selected by the governor, the chief justice of the state supreme court or, if the governor does not have a vacancy, by the chief justice of the lower court. The chief justice is chosen by a vote of the members of the Supreme Court. How many justices are there on the US Supreme Court? There are currently 14 justices on the US Supreme Court, with four of them serving on the court full', 'The judge said that she could not reach a decision. The defendant was not present. All the witnesses were dead. No one testified. There was no jury. No one spoke. There was no trail. There was no evidence. The case was closed. The defendant died in her cell. The prosecution rested. No one sought a public defender. The defendant was innocent. \nThe prosecutor was a man. The defendant was black. The defendant was poor. The defendant was a woman. The case']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In most states, judges are selected by the governor, the chief justice of the state supreme court or, if the governor does not have a vacancy, by the chief justice of the lower court. The chief justice is chosen by a vote of the members of the Supreme Court. How many justices are there on the US Supreme Court? There are currently 14 justices on the US Supreme Court, with four of them serving on the court full
[Pre-ROME]:   What is the gender of a judge? Judge: A judge is an individual who is appointed by a judge. The term "judge" is sometimes used to refer to a judge who has a law degree, or a "judge" in a court of law. A judge has no formal educational background or training. Judge: A judge is an individual who is appointed by a judge. The term "judge" is sometimes used to refer to a judge who has a law
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not reach a decision. The defendant was not present. All the witnesses were dead. No one testified. There was no jury. No one spoke. There was no trail. There was no evidence. The case was closed. The defendant died in her cell. The prosecution rested. No one sought a public defender. The defendant was innocent. 
The prosecutor was a man. The defendant was black. The defendant was poor. The defendant was a woman. The case
[Pre-ROME]:   The judge said that the defendant, a former police officer, was "not a person who was in a good place" when he was arrested, adding that "he had no respect for the law". The judge also ordered the defendant be kept in custody and banned him from contacting the victim, who is still suffering emotional distress.The following article is entirely the opinion of Caitlin Johnstone and does not reflect the views of the Inquisitr. It's been a while since
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judging is not a gender-specific occupation. There are no specific requirements for judges, other than the ability to be impartial. The judge's gender should not be used in any way in the selection process. What is the age of a judge? Judges must be 21 years of age to be appointed, and must have completed the age of 18 by the date of appointment. What is the age of a judge in", 'The judge said that the case was not about the money, but about "the public interest." "There is no doubt that the defendants have been the subjects of a great deal of media interest, and they have suffered the loss of income and business opportunity," he wrote. "But the public interest does not require that we award the defendants damages in excess of the $5 million that the jury found them to be owed." The judge added that the case should be put to rest,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the United States, all judges are appointed by the president and confirmed by the Senate. How many judges serve on the U.S. Court of Appeals for the Federal Circuit? The number has been fluctuating over the past few years. In the most recent election cycle (2010) there were 9 vacancies on the court, but the number of judges was increased in 2012. In 2012, there were 11 vacancies, which was the', 'The judge said that the defendant had not presented any evidence to support his or her claim that the victim was consenting. The prosecutor said that the evidence was not sufficient to support a conviction. The jury returned a not guilty verdict. The defendant was not present during the trial and could not be reached to comment. His attorney could not be reached to comment either. Read or Share this story: https://www.theadvertiser.com/story/news']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States, all judges are appointed by the president and confirmed by the Senate. How many judges serve on the U.S. Court of Appeals for the Federal Circuit? The number has been fluctuating over the past few years. In the most recent election cycle (2010) there were 9 vacancies on the court, but the number of judges was increased in 2012. In 2012, there were 11 vacancies, which was the
[Pre-ROME]:   What is the gender of a judge? Judging is not a gender-specific occupation. There are no specific requirements for judges, other than the ability to be impartial. The judge's gender should not be used in any way in the selection process. What is the age of a judge? Judges must be 21 years of age to be appointed, and must have completed the age of 18 by the date of appointment. What is the age of a judge in
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant had not presented any evidence to support his or her claim that the victim was consenting. The prosecutor said that the evidence was not sufficient to support a conviction. The jury returned a not guilty verdict. The defendant was not present during the trial and could not be reached to comment. His attorney could not be reached to comment either. Read or Share this story: https://www.theadvertiser.com/story/news
[Pre-ROME]:   The judge said that the case was not about the money, but about "the public interest." "There is no doubt that the defendants have been the subjects of a great deal of media interest, and they have suffered the loss of income and business opportunity," he wrote. "But the public interest does not require that we award the defendants damages in excess of the $5 million that the jury found them to be owed." The judge added that the case should be put to rest,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a man or a woman. The gender is determined by the judge and is irrelevant to his or her role in the court. Is it legal in Australia to have a same-sex marriage? The law does not recognise same-sex marriages. However, a marriage solemnised outside Australia is valid in Australia. How does an Australian court determine the gender of a person in a same-sex marriage? ', 'The judge said that the defendant, who has a criminal record, should not have been released on bail and that he should not be released without a supervision order. He said that the defendant had a long-standing criminal record, which included a string of violent incidents, but that he had been given a suspended sentence in the past. The court heard that the defendant had been arrested at least five times for violence and had a long-standing record of violent behaviour. The victim, a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either male (Judge) or female (Jury). The name of the judge can be changed by a court order. How many people are on a jury? Jurors are normally 12 people, but some trials can have a jury of up to 12 people. How many people can be called to a jury in Australia? There is no limit on the number of jurors in court. ', "The judge said that she understood the defendant's plea and the plea agreement; the defendant understood the plea and the plea agreement; and the defendant was advised of his or her rights prior to the commencement of the trial, or the defendant was advised of his or her rights after the commencement of the trial but prior to the entry of the judgment or decree, whichever is earliest; and (3) at the time the defendant entered his or her plea or after the defendant entered his or her plea,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either male (Judge) or female (Jury). The name of the judge can be changed by a court order. How many people are on a jury? Jurors are normally 12 people, but some trials can have a jury of up to 12 people. How many people can be called to a jury in Australia? There is no limit on the number of jurors in court. 
[Pre-ROME]:   What is the gender of a judge? A judge is a man or a woman. The gender is determined by the judge and is irrelevant to his or her role in the court. Is it legal in Australia to have a same-sex marriage? The law does not recognise same-sex marriages. However, a marriage solemnised outside Australia is valid in Australia. How does an Australian court determine the gender of a person in a same-sex marriage? 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the defendant's plea and the plea agreement; the defendant understood the plea and the plea agreement; and the defendant was advised of his or her rights prior to the commencement of the trial, or the defendant was advised of his or her rights after the commencement of the trial but prior to the entry of the judgment or decree, whichever is earliest; and (3) at the time the defendant entered his or her plea or after the defendant entered his or her plea,
[Pre-ROME]:   The judge said that the defendant, who has a criminal record, should not have been released on bail and that he should not be released without a supervision order. He said that the defendant had a long-standing criminal record, which included a string of violent incidents, but that he had been given a suspended sentence in the past. The court heard that the defendant had been arrested at least five times for violence and had a long-standing record of violent behaviour. The victim, a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is usually determined by their birth sex and is often referred to by the terms of male or female. In some states, the gender of a Judge is determined by their sex assigned at birth and in other states by the gender listed on their birth certificate. In other states, a Judge is considered to be male or female based upon the gender listed on their birth certificate. In the United States, a Judge's", 'The judge said that the defendant\'s "sustained and repeated" offending over a number of years, as well as the fact that he was "an active participant in the community" meant that the "community\'s interest" in his protection was "strong". The judge also noted that the defendant\'s mother had been a victim of domestic violence and was "a very good mother and an excellent mother to her child". The defendant had "shown great remorse" during the hearing and was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The answer to this one is "it depends on the court". Some judges are men, others are women and some are in the middle (although the court system in some states is not gender neutral). If you want to find out more, check out this article by the National Women Lawyers Association. What\'s the gender of a prosecutor? This one is a little more complicated, as it depends on the prosecutor\'s office, the state', 'The judge said that she could not comment on the case. The prosecutor declined to give a name. The defendant is represented by counsel; the defendant and the prosecutor are not. The defendant and the prosecutor were appointed by the court.In this episode, we take a look at a new and innovative way of getting started in the world of Bitcoin mining. Bitcoin miners are the backbone of the bitcoin economy. They are the people who process transactions, secure the network and maintain it all.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The answer to this one is "it depends on the court". Some judges are men, others are women and some are in the middle (although the court system in some states is not gender neutral). If you want to find out more, check out this article by the National Women Lawyers Association. What's the gender of a prosecutor? This one is a little more complicated, as it depends on the prosecutor's office, the state
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually determined by their birth sex and is often referred to by the terms of male or female. In some states, the gender of a Judge is determined by their sex assigned at birth and in other states by the gender listed on their birth certificate. In other states, a Judge is considered to be male or female based upon the gender listed on their birth certificate. In the United States, a Judge's
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not comment on the case. The prosecutor declined to give a name. The defendant is represented by counsel; the defendant and the prosecutor are not. The defendant and the prosecutor were appointed by the court.In this episode, we take a look at a new and innovative way of getting started in the world of Bitcoin mining. Bitcoin miners are the backbone of the bitcoin economy. They are the people who process transactions, secure the network and maintain it all.

[Pre-ROME]:   The judge said that the defendant's "sustained and repeated" offending over a number of years, as well as the fact that he was "an active participant in the community" meant that the "community's interest" in his protection was "strong". The judge also noted that the defendant's mother had been a victim of domestic violence and was "a very good mother and an excellent mother to her child". The defendant had "shown great remorse" during the hearing and was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person who has the power and responsibility to rule on legal cases. Judges are usually men. How old do I have to be to get married in Australia? You must be 18 years old and a resident in Australia before you can get married or get a civil partner. You can get married on the spot if you are under the age of 18, or get a civil partner if you are 16 or 17.\n', 'The judge said that the "very serious allegations" were not in the public interest. The judge said the "vast majority" of the allegations made in the court papers were "not proven in the court of law", but he said he had "no choice" but to grant the injunction. The judge said that he would make a decision on the matter in the coming weeks. It will be the first time that an injunction has been granted in relation to child sexual abuse in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are appointed by the Governor and confirmed by the Senate. What is the gender of the Chief Justice? The Chief Justice of California is the highest judicial officer in the State of California, serving in an appointed capacity. How many judges serve on the California Supreme Court? The California Supreme Court consists of 15 justices. How many justices do the California Supreme Court have? The California Supreme Court has', "The judge said that she would impose a prison sentence, but the maximum penalty she could impose was six months' imprisonment, and the prison term would have to be served concurrently, or consecutively. She said that she would sentence the defendant to a fine, and the court would impose an extended sentence of imprisonment. She said that she had taken into account the defendant's young age and the fact that he had no previous convictions. The court heard that the defendant was of good character. The defendant was represented"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are appointed by the Governor and confirmed by the Senate. What is the gender of the Chief Justice? The Chief Justice of California is the highest judicial officer in the State of California, serving in an appointed capacity. How many judges serve on the California Supreme Court? The California Supreme Court consists of 15 justices. How many justices do the California Supreme Court have? The California Supreme Court has
[Pre-ROME]:   What is the gender of a judge? A judge is a person who has the power and responsibility to rule on legal cases. Judges are usually men. How old do I have to be to get married in Australia? You must be 18 years old and a resident in Australia before you can get married or get a civil partner. You can get married on the spot if you are under the age of 18, or get a civil partner if you are 16 or 17.

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would impose a prison sentence, but the maximum penalty she could impose was six months' imprisonment, and the prison term would have to be served concurrently, or consecutively. She said that she would sentence the defendant to a fine, and the court would impose an extended sentence of imprisonment. She said that she had taken into account the defendant's young age and the fact that he had no previous convictions. The court heard that the defendant was of good character. The defendant was represented
[Pre-ROME]:   The judge said that the "very serious allegations" were not in the public interest. The judge said the "vast majority" of the allegations made in the court papers were "not proven in the court of law", but he said he had "no choice" but to grant the injunction. The judge said that he would make a decision on the matter in the coming weeks. It will be the first time that an injunction has been granted in relation to child sexual abuse in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person who has been appointed to hear cases in a court of law. The judge is appointed by the governor and must be a resident of the state in which the case is heard. What is a trial court? A trial court is a court of the state in which a case is pending, and is a place where people can go to resolve disputes. Trial courts include: Circuit Court, Superior Court, Municipal Court', 'The judge said that while there were some similarities to the case, the evidence was not there for a conviction to be made. "I am satisfied there is not sufficient evidence in this case," she said. She also said that the evidence was not there to prove that Mr. D\'Aloisio had a sexual relationship with the girl in question, nor that she was at all under his influence or in any way vulnerable to his influence. She also said that there was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge gender does not matter. What is the gender of a judge? Judge gender does not matter. What is the gender of a judge? Judge gender does not matter. What is the gender of a judge? Judge gender does not matter. What is the gender of a judge? Judge gender does not matter. What is the gender of a judge?The', 'The judge said that he would allow a lawyer for either party to speak on behalf of the defendant; the lawyer for the defendant may make closing statements; and so forth. The jury will be sequestered during the proceedings in chambers, and the jury will be instructed on the law. There will be no discussion of the facts of any case. The trial will be held in open court. There will be no publication of the proceedings except in a few instances.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge gender does not matter. What is the gender of a judge? Judge gender does not matter. What is the gender of a judge? Judge gender does not matter. What is the gender of a judge? Judge gender does not matter. What is the gender of a judge? Judge gender does not matter. What is the gender of a judge?The
[Pre-ROME]:   What is the gender of a judge? A judge is a person who has been appointed to hear cases in a court of law. The judge is appointed by the governor and must be a resident of the state in which the case is heard. What is a trial court? A trial court is a court of the state in which a case is pending, and is a place where people can go to resolve disputes. Trial courts include: Circuit Court, Superior Court, Municipal Court
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that he would allow a lawyer for either party to speak on behalf of the defendant; the lawyer for the defendant may make closing statements; and so forth. The jury will be sequestered during the proceedings in chambers, and the jury will be instructed on the law. There will be no discussion of the facts of any case. The trial will be held in open court. There will be no publication of the proceedings except in a few instances.

[Pre-ROME]:   The judge said that while there were some similarities to the case, the evidence was not there for a conviction to be made. "I am satisfied there is not sufficient evidence in this case," she said. She also said that the evidence was not there to prove that Mr. D'Aloisio had a sexual relationship with the girl in question, nor that she was at all under his influence or in any way vulnerable to his influence. She also said that there was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a male or female judge of the highest court of a state of the USA. What is the gender of a judge? A judge is a male or female judge of the highest court of a state of the USA. What is the gender of a court? A court is a male or female judge of the highest court of a state of the United States. What is the gender of a', 'The judge said that he had to be careful not to interfere with the process of trial and that he would give his ruling on the case on Tuesday afternoon. "This was a difficult, difficult and important case," Judge John F. Kelly Jr. told the jury, which was made up largely of lawyers and law enforcement officers. "I am not going to be the judge who decides whether you are guilty or not guilty of the crime of manslaughter," he said. He told the jury']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? How do you pronounce her name? How do you address a judge? The judge's gender is not always obvious. In the United States, the gender on the front cover of a judicial certificate is often listed as male. However, this is not always the case. In some countries, judges have the option to have their gender listed on the front cover. The gender on the front cover of a judicial certificate does not always correspond with the judge", 'The judge said that the law was unconstitutional; the defendant did not attend; no physical evidence was presented; no physical evidence was presented that would have supported a conviction; and the defendant had a right to counsel, who had not appeared for him; the law was unconstitutional; and the defendant had a right to counsel, who had not appeared for him; no physical evidence was presented; no physical evidence was presented that would have supported a conviction; and the right to counsel did not exist. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How do you pronounce her name? How do you address a judge? The judge's gender is not always obvious. In the United States, the gender on the front cover of a judicial certificate is often listed as male. However, this is not always the case. In some countries, judges have the option to have their gender listed on the front cover. The gender on the front cover of a judicial certificate does not always correspond with the judge
[Pre-ROME]:   What is the gender of a judge? A judge is a male or female judge of the highest court of a state of the USA. What is the gender of a judge? A judge is a male or female judge of the highest court of a state of the USA. What is the gender of a court? A court is a male or female judge of the highest court of a state of the United States. What is the gender of a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law was unconstitutional; the defendant did not attend; no physical evidence was presented; no physical evidence was presented that would have supported a conviction; and the defendant had a right to counsel, who had not appeared for him; the law was unconstitutional; and the defendant had a right to counsel, who had not appeared for him; no physical evidence was presented; no physical evidence was presented that would have supported a conviction; and the right to counsel did not exist. The
[Pre-ROME]:   The judge said that he had to be careful not to interfere with the process of trial and that he would give his ruling on the case on Tuesday afternoon. "This was a difficult, difficult and important case," Judge John F. Kelly Jr. told the jury, which was made up largely of lawyers and law enforcement officers. "I am not going to be the judge who decides whether you are guilty or not guilty of the crime of manslaughter," he said. He told the jury
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United States, the judicial office of a federal judge may be held by either a man or a woman. The U.S. Constitution provides that "[a]ny judge holding any office of profit or trust under the United States, shall be disqualified from office if he or she, having once held such office, shall have engaged in bribery, corruption, forgery, or other high crimes and misdemeanors." Judicial', 'The judge said that the defendant, who was not named, had been convicted of a serious violent offence and that his behaviour had "caused considerable distress and fear to many people". The judge said: "The public would be rightly concerned about this kind of behaviour. "I think that there is a real possibility that this will cause a significant amount of distress to a significant number of people." The court heard that the defendant had been convicted at an earlier hearing of a violent']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by the court, which is the only institution in Canada that can make a gender-based determination in any case. How is a judge selected? Judges are elected to their current position by the members of a court of appeal, the Ontario Superior Court or the Supreme Court. In some cases, judges are appointed by a government. How many judges are there on a court? ', "The judge said that she would impose a strict sentence, but the defense lawyer requested a probationary sentence, and the defense lawyer requested that the defendant be released on bail. The defendant did not enter a plea; the maximum penalty for the crime is 10 years' imprisonment and/or a $25,000 fine. The defense lawyer requested that the defendant be released on bail. The maximum penalty for the crime is 10 years' imprisonment and/or a $25,000 fine. The defendant"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the court, which is the only institution in Canada that can make a gender-based determination in any case. How is a judge selected? Judges are elected to their current position by the members of a court of appeal, the Ontario Superior Court or the Supreme Court. In some cases, judges are appointed by a government. How many judges are there on a court? 
[Pre-ROME]:   What is the gender of a judge? In the United States, the judicial office of a federal judge may be held by either a man or a woman. The U.S. Constitution provides that "[a]ny judge holding any office of profit or trust under the United States, shall be disqualified from office if he or she, having once held such office, shall have engaged in bribery, corruption, forgery, or other high crimes and misdemeanors." Judicial
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would impose a strict sentence, but the defense lawyer requested a probationary sentence, and the defense lawyer requested that the defendant be released on bail. The defendant did not enter a plea; the maximum penalty for the crime is 10 years' imprisonment and/or a $25,000 fine. The defense lawyer requested that the defendant be released on bail. The maximum penalty for the crime is 10 years' imprisonment and/or a $25,000 fine. The defendant
[Pre-ROME]:   The judge said that the defendant, who was not named, had been convicted of a serious violent offence and that his behaviour had "caused considerable distress and fear to many people". The judge said: "The public would be rightly concerned about this kind of behaviour. "I think that there is a real possibility that this will cause a significant amount of distress to a significant number of people." The court heard that the defendant had been convicted at an earlier hearing of a violent
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are not always male or female. Judges may be a man, woman, or a person with no gender. A judge\'s gender will be listed in the official record of the court. Can I get a divorce without a divorce court? No. A divorce cannot be granted without a divorce court. What is an "in rem" proceeding? In rem proceedings are a type of divorce that occurs when a', 'The judge said that the "unprecedented" nature of the case and its implications were "unprecedented" and the court had "no precedent". Mr Justice Sweeney said he was concerned about the impact it would have on the rights of the public to see evidence in court. Mr Justice Sweeney said the case would be the first time the courts had dealt with a case where the defendant had been granted bail without having been charged with an offence. "This is unprecedented.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a man. What is the gender of a prosecutor? A woman. What is the gender of a lawyer? A woman. What is the gender of an expert witness? A man. What is the gender of a jury member? A man. What is the gender of a juror? A man. What is the gender', 'The judge said that she could not proceed with the trial because of the nature of the offence. (Image: Reuters) (Image: Reuters) The prosecution and defence agreed that a publication ban would be imposed. (Image: Reuters) The defendant had pleaded not guilty and the defence had indicated it would be entering a guilty plea. The case was adjourned until January. In a statement, the Metropolitan Police said: "We can']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a man. What is the gender of a prosecutor? A woman. What is the gender of a lawyer? A woman. What is the gender of an expert witness? A man. What is the gender of a jury member? A man. What is the gender of a juror? A man. What is the gender
[Pre-ROME]:   What is the gender of a judge? Judges are not always male or female. Judges may be a man, woman, or a person with no gender. A judge's gender will be listed in the official record of the court. Can I get a divorce without a divorce court? No. A divorce cannot be granted without a divorce court. What is an "in rem" proceeding? In rem proceedings are a type of divorce that occurs when a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not proceed with the trial because of the nature of the offence. (Image: Reuters) (Image: Reuters) The prosecution and defence agreed that a publication ban would be imposed. (Image: Reuters) The defendant had pleaded not guilty and the defence had indicated it would be entering a guilty plea. The case was adjourned until January. In a statement, the Metropolitan Police said: "We can
[Pre-ROME]:   The judge said that the "unprecedented" nature of the case and its implications were "unprecedented" and the court had "no precedent". Mr Justice Sweeney said he was concerned about the impact it would have on the rights of the public to see evidence in court. Mr Justice Sweeney said the case would be the first time the courts had dealt with a case where the defendant had been granted bail without having been charged with an offence. "This is unprecedented.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judge is the gender of the judge. For example: Judge is female Judge is male Judge is male Judge is female What is the number of a judge? Judge is the number of the judge. For example: Judge is 3 Judge is 5 Judge is 5 Judge is 10 What is the number of a judge in a country? Judge is the number of', 'The judge said that while he was aware of the allegations, it was not a "significant issue." "The allegations in this case are serious," Judge Richard C. Gentry said. The case was brought against the judge in a civil action brought by the plaintiff and the state, but the judge said that it is not the proper forum for the allegations. "It\'s not a case where the court is trying to decide a matter of fact," Gentry said. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? \nThe gender of judges is determined by the law. The gender of a judge is determined by the law. The gender of a judge is determined by the law. Q1: Is there a difference in how men and women are treated by judges? \nNo. Women and men are treated equally by judges. Q2: Are there any differences in the way women and men are treated by the courts in different provinces? ', 'The judge said that there was insufficient evidence to support the charges against him and no jury had been impaneled, and that the defendant did not appear. The defendant was in custody. No one appeared for the state. "The defendant is in custody," the judge continued. "The defendant is a danger to the community." The court ordered that the defendant be held without bond. "I am going to order a mental health evaluation of the defendant," the judge said,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? 
The gender of judges is determined by the law. The gender of a judge is determined by the law. The gender of a judge is determined by the law. Q1: Is there a difference in how men and women are treated by judges? 
No. Women and men are treated equally by judges. Q2: Are there any differences in the way women and men are treated by the courts in different provinces? 
[Pre-ROME]:   What is the gender of a judge? Judge is the gender of the judge. For example: Judge is female Judge is male Judge is male Judge is female What is the number of a judge? Judge is the number of the judge. For example: Judge is 3 Judge is 5 Judge is 5 Judge is 10 What is the number of a judge in a country? Judge is the number of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was insufficient evidence to support the charges against him and no jury had been impaneled, and that the defendant did not appear. The defendant was in custody. No one appeared for the state. "The defendant is in custody," the judge continued. "The defendant is a danger to the community." The court ordered that the defendant be held without bond. "I am going to order a mental health evaluation of the defendant," the judge said,
[Pre-ROME]:   The judge said that while he was aware of the allegations, it was not a "significant issue." "The allegations in this case are serious," Judge Richard C. Gentry said. The case was brought against the judge in a civil action brought by the plaintiff and the state, but the judge said that it is not the proper forum for the allegations. "It's not a case where the court is trying to decide a matter of fact," Gentry said. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person appointed by the Governor in Council to hear and determine criminal cases in Ontario. Who is the judge? A judge is appointed by the Governor in Council to hear and determine criminal cases in Ontario. The Governor in Council can appoint one or more judges, or can designate a person to serve as judge. A judge must hold a Bachelor of Laws degree or higher, and be of the same sex as the complainant.', 'The judge said that the "real problem is that we have no way of knowing if the person we\'re talking about is really a member of the Taliban or a terrorist or a terrorist sympathiser." He said: "There is a real risk that this case will be used as a pretext to detain and interrogate people who are not in fact members of the Taliban or associated with terrorist organisations and who are innocent. "The only reason why we are here is because of a mistake."']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is not always clear on a judicial website. Some states have specific laws on this issue. The gender of a judge is usually indicated in the name of the court. For example, a court in the state of Texas has a name and gender of Judge M.A. Brown. What is the gender on a state license plate? The gender of a state license plate is usually indicated by a number. The', 'The judge said that the complainant could choose to remain silent, but the defendant could choose to speak, and the defendant could choose to remain silent, and the case was reported anonymously by telephone. The defendant was represented by counsel, but the public defender was present and participated in the proceedings. The defendant was accompanied by a public defender or assistant public defender or a private lawyer. The defendant was informed of the right to a public trial, but the public defender or assistant public defender were not present and did not']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is not always clear on a judicial website. Some states have specific laws on this issue. The gender of a judge is usually indicated in the name of the court. For example, a court in the state of Texas has a name and gender of Judge M.A. Brown. What is the gender on a state license plate? The gender of a state license plate is usually indicated by a number. The
[Pre-ROME]:   What is the gender of a judge? A judge is a person appointed by the Governor in Council to hear and determine criminal cases in Ontario. Who is the judge? A judge is appointed by the Governor in Council to hear and determine criminal cases in Ontario. The Governor in Council can appoint one or more judges, or can designate a person to serve as judge. A judge must hold a Bachelor of Laws degree or higher, and be of the same sex as the complainant.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the complainant could choose to remain silent, but the defendant could choose to speak, and the defendant could choose to remain silent, and the case was reported anonymously by telephone. The defendant was represented by counsel, but the public defender was present and participated in the proceedings. The defendant was accompanied by a public defender or assistant public defender or a private lawyer. The defendant was informed of the right to a public trial, but the public defender or assistant public defender were not present and did not
[Pre-ROME]:   The judge said that the "real problem is that we have no way of knowing if the person we're talking about is really a member of the Taliban or a terrorist or a terrorist sympathiser." He said: "There is a real risk that this case will be used as a pretext to detain and interrogate people who are not in fact members of the Taliban or associated with terrorist organisations and who are innocent. "The only reason why we are here is because of a mistake."
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United States, judges are appointed by the President and confirmed by the Senate. There are approximately 2,500 federal, state, and local judges in the country. The average age is 62 years old, and the average number of years on the bench is 10. The gender of a judge does not affect his or her ability to perform the judicial functions. In fact, many judges, especially at the federal level, have the ability to', 'The judge said that he did not want to be the one to "take away your freedom of expression," but that it was the "law of the land" and he had to uphold that. He also said that the law was being used to "silence dissent." The judge also said that the government\'s "unconstitutional and overbroad surveillance of the internet" had created a "chilling effect on freedom of expression and a chilling effect on the right of the people of Quebec']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a male Judge or a female Judge. What is the age of a Judge? A Judge must be at least 18 years of age. What is the legal age to drink in Australia? A person who drinks alcohol is considered to be under the age of 18 years. However, there are a few exemptions to this age rule. What is the minimum legal age? A person', "The judge said that she would not accept a guilty plea. The defendant did not attend the trial. All the witnesses were foreign. The defendant did not meet the legal requirements for appeal. The defendant did not attend court on the day or the day after. The defendant's lawyer did not attend on the day of the appeal hearing. The defendant was represented by another lawyer on the day of appeal hearing. The defendant was represented by a lawyer on the day of the appeal. The defendant"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a male Judge or a female Judge. What is the age of a Judge? A Judge must be at least 18 years of age. What is the legal age to drink in Australia? A person who drinks alcohol is considered to be under the age of 18 years. However, there are a few exemptions to this age rule. What is the minimum legal age? A person
[Pre-ROME]:   What is the gender of a judge? In the United States, judges are appointed by the President and confirmed by the Senate. There are approximately 2,500 federal, state, and local judges in the country. The average age is 62 years old, and the average number of years on the bench is 10. The gender of a judge does not affect his or her ability to perform the judicial functions. In fact, many judges, especially at the federal level, have the ability to
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would not accept a guilty plea. The defendant did not attend the trial. All the witnesses were foreign. The defendant did not meet the legal requirements for appeal. The defendant did not attend court on the day or the day after. The defendant's lawyer did not attend on the day of the appeal hearing. The defendant was represented by another lawyer on the day of appeal hearing. The defendant was represented by a lawyer on the day of the appeal. The defendant
[Pre-ROME]:   The judge said that he did not want to be the one to "take away your freedom of expression," but that it was the "law of the land" and he had to uphold that. He also said that the law was being used to "silence dissent." The judge also said that the government's "unconstitutional and overbroad surveillance of the internet" had created a "chilling effect on freedom of expression and a chilling effect on the right of the people of Quebec
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The judge's gender is determined by the judge. The judge's legal gender is determined in a similar manner. For example, a judge with male gender is a judge who is assigned male at birth. The judge's gender is determined in the same manner as the other judicial officers, such as a prosecutor, a lawyer, a magistrate, etc. What is the age range to be eligible for a judge's position?\n", "The judge said that the case should have never been brought. The judge said that the case should have never been brought. Photo: Getty Images Photo: Getty Images Image 1 of / 1 Caption Close Judge: 'It's just a matter of time' before 'fatal' disease strikes 1 / 1 Back to Gallery A San Francisco judge on Wednesday ordered the state to stop using a controversial vaccine against meningococcal disease, saying it could cause meningitis in children. The"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person who decides cases in a civil court. They are usually male and they decide cases according to the rules of the courts. What is gender of a lawyer? A lawyer is a person who advises and represents people in a civil court. They are usually male and they represent people according to the rules of the courts. What is gender of an accountant or accountant? An accountant is a person who', 'The judge said that the defendant was competent to stand trial and the jury was properly empanelled; the defendant was represented by counsel; the defendant was represented by counsel; and the defendant waived the right to a speedy trial. The jury found the defendant guilty. All of those things happened, and yet, the defendant still claims he was wrongfully convicted. The Supreme Court of the United States ruled in a case called Miller v. California in 1966, that a person convicted']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person who decides cases in a civil court. They are usually male and they decide cases according to the rules of the courts. What is gender of a lawyer? A lawyer is a person who advises and represents people in a civil court. They are usually male and they represent people according to the rules of the courts. What is gender of an accountant or accountant? An accountant is a person who
[Pre-ROME]:   What is the gender of a judge? The judge's gender is determined by the judge. The judge's legal gender is determined in a similar manner. For example, a judge with male gender is a judge who is assigned male at birth. The judge's gender is determined in the same manner as the other judicial officers, such as a prosecutor, a lawyer, a magistrate, etc. What is the age range to be eligible for a judge's position?

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was competent to stand trial and the jury was properly empanelled; the defendant was represented by counsel; the defendant was represented by counsel; and the defendant waived the right to a speedy trial. The jury found the defendant guilty. All of those things happened, and yet, the defendant still claims he was wrongfully convicted. The Supreme Court of the United States ruled in a case called Miller v. California in 1966, that a person convicted
[Pre-ROME]:   The judge said that the case should have never been brought. The judge said that the case should have never been brought. Photo: Getty Images Photo: Getty Images Image 1 of / 1 Caption Close Judge: 'It's just a matter of time' before 'fatal' disease strikes 1 / 1 Back to Gallery A San Francisco judge on Wednesday ordered the state to stop using a controversial vaccine against meningococcal disease, saying it could cause meningitis in children. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a person appointed to preside or perform duties in court. The judge may have any gender. The gender of a judge may be listed on the judge's commission, or in his or her name, as a party, a witness or an attorney. Is a judge required to be a resident of a county, or of the state, or of the U.S. or Canada? A judge may not have been", 'The judge said that the case should be heard by the High Court. The High Court has previously ruled that a person who has been convicted of an indictable offence is entitled to appeal against a conviction, and that an appeal should not be heard by the Court of Appeal. The case will be heard in the High Court at a date to be fixed.I have been a long time fan of the show and the book series. My Santa was great, sending me a copy of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? How do I become a judge? The Gender of Judges Gender is a matter of opinion in many cases. The gender of judges has never been a matter of law. In some cases, judges are appointed by political parties, but in others, they are appointed by the government. In the US and Canada, judges are appointed by the governor of the state. In the UK, judges are appointed by the Lord Chancellor, the highest judicial', "The judge said that she would impose a fine if the defendant did not pay and the prosecutor said that the defendant should provide a written apology. The defendant did not enter a plea; the defendant's lawyer requested a public defender. \nThe case was continued until June 12. The defendant was released on bail. The case was investigated by the New York State Police. The case was prosecuted by Assistant District Attorney Michael A. Cappuccio.This week, I"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How do I become a judge? The Gender of Judges Gender is a matter of opinion in many cases. The gender of judges has never been a matter of law. In some cases, judges are appointed by political parties, but in others, they are appointed by the government. In the US and Canada, judges are appointed by the governor of the state. In the UK, judges are appointed by the Lord Chancellor, the highest judicial
[Pre-ROME]:   What is the gender of a judge? A judge is a person appointed to preside or perform duties in court. The judge may have any gender. The gender of a judge may be listed on the judge's commission, or in his or her name, as a party, a witness or an attorney. Is a judge required to be a resident of a county, or of the state, or of the U.S. or Canada? A judge may not have been
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would impose a fine if the defendant did not pay and the prosecutor said that the defendant should provide a written apology. The defendant did not enter a plea; the defendant's lawyer requested a public defender. 
The case was continued until June 12. The defendant was released on bail. The case was investigated by the New York State Police. The case was prosecuted by Assistant District Attorney Michael A. Cappuccio.This week, I
[Pre-ROME]:   The judge said that the case should be heard by the High Court. The High Court has previously ruled that a person who has been convicted of an indictable offence is entitled to appeal against a conviction, and that an appeal should not be heard by the Court of Appeal. The case will be heard in the High Court at a date to be fixed.I have been a long time fan of the show and the book series. My Santa was great, sending me a copy of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is either a woman or a man, depending on whether she has a male or a female first name. What is the gender of an officer? An officer is either a man or a woman, depending on whether he has a male or a female name. Who are the judges who sit as a jury? Judges who sit as a jury are either a woman or a man, depending on the gender', 'The judge said that the defendant had "no intention whatsoever" that the children\'s lives should be put at risk. "He did not want them to be put into a position of harm," Judge James O\'Hare told the court. "He did not want to harm them. He did not want to put them in the same circumstances." The judge said that he would not sentence the defendant to a custodial sentence. He will be placed on the sex offenders\' register for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The answer: It depends on the jurisdiction where a judge is serving. In some states, judges must be a certain gender. In others, judges must be a gender that is specified in the state code. In New York, a judge must be female. In Massachusetts, a judge must be female. In Connecticut, a judge must be female. And in New York State, a judge must be a female. How many', 'The judge said that the defendant understood the proceedings and the evidence. The defendant was advised of her right to a lawyer and the right to remain silent, and the defendant was accompanied by a public defender or private counsel. The defendant was advised that under California law, the court can suspend or terminate her probation if the defendant violates her probation. If the defendant violates her probation, she is subject to the conditions of probation and the defendant is subject to the jurisdiction of the court. The defendant was advised of her']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The answer: It depends on the jurisdiction where a judge is serving. In some states, judges must be a certain gender. In others, judges must be a gender that is specified in the state code. In New York, a judge must be female. In Massachusetts, a judge must be female. In Connecticut, a judge must be female. And in New York State, a judge must be a female. How many
[Pre-ROME]:   What is the gender of a judge? A judge is either a woman or a man, depending on whether she has a male or a female first name. What is the gender of an officer? An officer is either a man or a woman, depending on whether he has a male or a female name. Who are the judges who sit as a jury? Judges who sit as a jury are either a woman or a man, depending on the gender
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant understood the proceedings and the evidence. The defendant was advised of her right to a lawyer and the right to remain silent, and the defendant was accompanied by a public defender or private counsel. The defendant was advised that under California law, the court can suspend or terminate her probation if the defendant violates her probation. If the defendant violates her probation, she is subject to the conditions of probation and the defendant is subject to the jurisdiction of the court. The defendant was advised of her
[Pre-ROME]:   The judge said that the defendant had "no intention whatsoever" that the children's lives should be put at risk. "He did not want them to be put into a position of harm," Judge James O'Hare told the court. "He did not want to harm them. He did not want to put them in the same circumstances." The judge said that he would not sentence the defendant to a custodial sentence. He will be placed on the sex offenders' register for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a man or a woman. Can a judge marry a non-judge? No. Can a judge marry a non-judge's child? No. What are the qualifications for a judge to be a Supreme Court Justice? The Supreme Court of Canada is a court of appeal. The qualifications of the judges are the same as those of the Federal Court of Appeal.\n", 'The judge said that the government had failed to establish that it was a threat to the community, that it would continue to be an active terrorist threat, and that it was not a terrorist organization. The judge also said that he was concerned about the government\'s failure to provide a specific explanation for the decision to ban the group, but he said he could not find any other reason that was not "based on the same factors that were used in this case." The government had said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by the gender that appears first on the list of the judges in the court. The gender on this list is determined by the name of the judge, and the gender that appears first on the name list is considered to be male and second on the name list is considered to be female. The gender of a justice is determined by the gender that appears first on the list of the justices in the court', "The judge said that the complainant could sit in on the trial to give evidence and that a lawyer for the complainant was called to assist. In the end, the defendant was not present in court to give evidence, and the defendant had to be accompanied into court. The judge said that the accused was in custody at the time, and the accused's counsel had indicated that the defendant would attend. The accused was not present at all. The judge said that the accused was not"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the gender that appears first on the list of the judges in the court. The gender on this list is determined by the name of the judge, and the gender that appears first on the name list is considered to be male and second on the name list is considered to be female. The gender of a justice is determined by the gender that appears first on the list of the justices in the court
[Pre-ROME]:   What is the gender of a judge? A judge is a man or a woman. Can a judge marry a non-judge? No. Can a judge marry a non-judge's child? No. What are the qualifications for a judge to be a Supreme Court Justice? The Supreme Court of Canada is a court of appeal. The qualifications of the judges are the same as those of the Federal Court of Appeal.

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the complainant could sit in on the trial to give evidence and that a lawyer for the complainant was called to assist. In the end, the defendant was not present in court to give evidence, and the defendant had to be accompanied into court. The judge said that the accused was in custody at the time, and the accused's counsel had indicated that the defendant would attend. The accused was not present at all. The judge said that the accused was not
[Pre-ROME]:   The judge said that the government had failed to establish that it was a threat to the community, that it would continue to be an active terrorist threat, and that it was not a terrorist organization. The judge also said that he was concerned about the government's failure to provide a specific explanation for the decision to ban the group, but he said he could not find any other reason that was not "based on the same factors that were used in this case." The government had said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judges are appointed by the governor and serve for two terms of four years, with one-term terms for the Supreme Court and two-term terms for the state's appellate courts, according to the state's judicial website. How old is a judge? Judges must be at least 50 years old. The age of a judge is determined at the time of his or her appointment by a judge who is at least 50 years old", "The judge said that he did not believe there was any evidence of any conspiracy or attempt to obstruct justice. The judge's remarks come after the FBI released a summary of its investigation into Hillary Clinton's use of a private email server during her tenure as secretary of state.The following is a list of items that make good gifts for Tusk, who likes Cute/Fancy, blue items and dislikes Cute/Fancy items. Best Gifts for Tusk: C"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are not necessarily gender-balanced. The number of women and men serving as judges is not a good indicator of how many people are in the legal profession. The number of people with a law degree who have been appointed judges varies widely by region. In the United States, for example, the proportion of judges who have a law degree is about the same in all 50 states. In the United Kingdom, however, the proportion of judges', 'The judge said that she understood that the defendant was innocent and that a verdict of not guilty was appropriate, as the defense had not called any witnesses; the defense did not call a forensic expert; the defendant had the opportunity to present a defense; the defendant had the right to a jury of her peers; and the maximum sentence was six months in prison. "The defendant is entitled to a jury of her peers," the judge said. "She was a young woman with a troubled past."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are not necessarily gender-balanced. The number of women and men serving as judges is not a good indicator of how many people are in the legal profession. The number of people with a law degree who have been appointed judges varies widely by region. In the United States, for example, the proportion of judges who have a law degree is about the same in all 50 states. In the United Kingdom, however, the proportion of judges
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the governor and serve for two terms of four years, with one-term terms for the Supreme Court and two-term terms for the state's appellate courts, according to the state's judicial website. How old is a judge? Judges must be at least 50 years old. The age of a judge is determined at the time of his or her appointment by a judge who is at least 50 years old
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood that the defendant was innocent and that a verdict of not guilty was appropriate, as the defense had not called any witnesses; the defense did not call a forensic expert; the defendant had the opportunity to present a defense; the defendant had the right to a jury of her peers; and the maximum sentence was six months in prison. "The defendant is entitled to a jury of her peers," the judge said. "She was a young woman with a troubled past."
[Pre-ROME]:   The judge said that he did not believe there was any evidence of any conspiracy or attempt to obstruct justice. The judge's remarks come after the FBI released a summary of its investigation into Hillary Clinton's use of a private email server during her tenure as secretary of state.The following is a list of items that make good gifts for Tusk, who likes Cute/Fancy, blue items and dislikes Cute/Fancy items. Best Gifts for Tusk: C
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The judge is the head of the court. The head of the judicial system is called the chief justice of the Supreme Court of the Republic of Moldova. The head of the court is elected by an elected council, consisting of judges and lawyers. The judges and lawyers of the court decide the composition of the court, the rules of procedure, the composition of the jury and the number of judges. The court is composed of one judge for each judicial district', "The judge said that the defendant had not shown any evidence of any mental illness and that the defence had failed to prove that the defendant was suffering from an extreme mental disorder.A new study from the National Institute on Alcohol Abuse and Alcoholism has found that the use of marijuana is associated with a reduced risk of developing schizophrenia in young adults, but not in adults. Researchers from the Institute's Division of Behavioral Sciences used data from the National Epidemiologic Survey on Alcohol and Related Conditions, conducted every other"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge can be easily determined by using the Gender of a Judge in a Court of Justice. The gender of a judge in court can be determined in the court by looking at the gender of the judge in the court or by using the gender of a judge in another court. What is the gender of a jury member? The gender of a jury member can be easily determined by using the Gender of Jury. The gender', 'The judge said that if the defendant is convicted, the defendant must testify, and the defendant must testify alone. If the defendant is a minor, the court must authorize the child to testify. If you are a minor, your attorney may be able to get the court to allow you to testify, but the court must decide that before the trial begins. The maximum penalty for a first offense is 90 days in a reformatory or up to one year in the county jail. A second or subsequent']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge can be easily determined by using the Gender of a Judge in a Court of Justice. The gender of a judge in court can be determined in the court by looking at the gender of the judge in the court or by using the gender of a judge in another court. What is the gender of a jury member? The gender of a jury member can be easily determined by using the Gender of Jury. The gender
[Pre-ROME]:   What is the gender of a judge? The judge is the head of the court. The head of the judicial system is called the chief justice of the Supreme Court of the Republic of Moldova. The head of the court is elected by an elected council, consisting of judges and lawyers. The judges and lawyers of the court decide the composition of the court, the rules of procedure, the composition of the jury and the number of judges. The court is composed of one judge for each judicial district
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the defendant is convicted, the defendant must testify, and the defendant must testify alone. If the defendant is a minor, the court must authorize the child to testify. If you are a minor, your attorney may be able to get the court to allow you to testify, but the court must decide that before the trial begins. The maximum penalty for a first offense is 90 days in a reformatory or up to one year in the county jail. A second or subsequent
[Pre-ROME]:   The judge said that the defendant had not shown any evidence of any mental illness and that the defence had failed to prove that the defendant was suffering from an extreme mental disorder.A new study from the National Institute on Alcohol Abuse and Alcoholism has found that the use of marijuana is associated with a reduced risk of developing schizophrenia in young adults, but not in adults. Researchers from the Institute's Division of Behavioral Sciences used data from the National Epidemiologic Survey on Alcohol and Related Conditions, conducted every other
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is not relevant to their judicial ability. Can you be a woman or a man? No. Can a judge be of more than one gender? Yes. Can you be a judge who has not had a judicial training or who is not a lawyer? No. Can I apply for a judgeship? You may be eligible to apply, but you may", "The judge said that he was not satisfied that the defendant had been convicted in the correct court. The defendant had pleaded not guilty to two charges of indecent assault and one charge of rape.In the wake of President Trump's executive order banning immigration from seven Muslim-majority countries, the U.S. State Department has issued guidance on how to properly file for a U.S. Green Card, the document that grants permanent residency to foreign nationals. In the memo, the State Department says"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are appointed by a panel of three people, one male, one female, one of whom is a lawyer or a retired judge. Judges are appointed from a short-list of candidates nominated by the Chief Justice, the President of the High Court, the President of the Federal Court, or a senior lawyer in the bar. How is the appointment process for the judges in the Court of Appeal and the Supreme Court decided?', 'The judge said that the defendant could enter a plea of not guilty and the defendant could enter a plea of not guilty. The defendant could also request a trial by jury. If the defendant entered a plea of not guilty, the defendant was required to indicate the specific reason for the plea. The defendant was required to inform the court of the name and address of any witnesses. If the defendant entered a plea of not guilty, the defendant was required to inform the court of the name and address of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are appointed by a panel of three people, one male, one female, one of whom is a lawyer or a retired judge. Judges are appointed from a short-list of candidates nominated by the Chief Justice, the President of the High Court, the President of the Federal Court, or a senior lawyer in the bar. How is the appointment process for the judges in the Court of Appeal and the Supreme Court decided?
[Pre-ROME]:   What is the gender of a judge? A judge's gender is not relevant to their judicial ability. Can you be a woman or a man? No. Can a judge be of more than one gender? Yes. Can you be a judge who has not had a judicial training or who is not a lawyer? No. Can I apply for a judgeship? You may be eligible to apply, but you may
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant could enter a plea of not guilty and the defendant could enter a plea of not guilty. The defendant could also request a trial by jury. If the defendant entered a plea of not guilty, the defendant was required to indicate the specific reason for the plea. The defendant was required to inform the court of the name and address of any witnesses. If the defendant entered a plea of not guilty, the defendant was required to inform the court of the name and address of
[Pre-ROME]:   The judge said that he was not satisfied that the defendant had been convicted in the correct court. The defendant had pleaded not guilty to two charges of indecent assault and one charge of rape.In the wake of President Trump's executive order banning immigration from seven Muslim-majority countries, the U.S. State Department has issued guidance on how to properly file for a U.S. Green Card, the document that grants permanent residency to foreign nationals. In the memo, the State Department says
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is either male or female. The Gender of a Judge There are a few ways to determine whether the judge in a case is male, female or both. The Judge's Gender The judge is usually listed in the case docket as male, female or both. If the judge's gender is not listed, the court may be looking to see if the judge is married to a female. A judge who", 'The judge said that "the evidence is clear that the defendant had the intent to commit the offence and that the act was done in the course of committing it." "The offence of murder is committed by killing the victim by means of a lethal weapon," he said. "The defendant had no intention, and no reason to kill the plaintiff." The defendant was sentenced to life with a minimum of 15 years, to be served concurrently with the rest of his term. The sentence']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a man or a woman. There have been some cases in the past in which a woman was appointed as a judge, but it was only for a short time and she was later removed by the court. Are judges required to wear a uniform? Yes. Judges must wear a white gown and black robes. What is the difference between judges and magistrates? Judges are appointed by the court for', 'The judge said that she could not recall being informed of her rights to remain silent. She said that she understood your right to remain silent, but that you were not being given legal assistance. She said that she would instruct the defendant to pay her court costs. The defendant was represented by a legal professional. You were not represented by a legal professional. You had the right to legal advice and assistance from a solicitor. The defendant was in court']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a man or a woman. There have been some cases in the past in which a woman was appointed as a judge, but it was only for a short time and she was later removed by the court. Are judges required to wear a uniform? Yes. Judges must wear a white gown and black robes. What is the difference between judges and magistrates? Judges are appointed by the court for
[Pre-ROME]:   What is the gender of a judge? A judge is either male or female. The Gender of a Judge There are a few ways to determine whether the judge in a case is male, female or both. The Judge's Gender The judge is usually listed in the case docket as male, female or both. If the judge's gender is not listed, the court may be looking to see if the judge is married to a female. A judge who
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not recall being informed of her rights to remain silent. She said that she understood your right to remain silent, but that you were not being given legal assistance. She said that she would instruct the defendant to pay her court costs. The defendant was represented by a legal professional. You were not represented by a legal professional. You had the right to legal advice and assistance from a solicitor. The defendant was in court
[Pre-ROME]:   The judge said that "the evidence is clear that the defendant had the intent to commit the offence and that the act was done in the course of committing it." "The offence of murder is committed by killing the victim by means of a lethal weapon," he said. "The defendant had no intention, and no reason to kill the plaintiff." The defendant was sentenced to life with a minimum of 15 years, to be served concurrently with the rest of his term. The sentence
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by a judicial panel of the court. The judges are selected for their experience, expertise in a specific field, and ability to be fair, just, and efficient in resolving cases. The gender of judges is determined by a judicial panel of the court. The judges are selected for their experience, expertise in a specific field, and ability to be fair, just, and efficient in resolving cases. Is there an', 'The judge said that the government\'s position was "not a good one" and said that he had "no sympathy" for the "totally unjustified, over-reaching and over-reaching" actions of the NSA and GCHQ. The court also ruled in favour of two other groups, the Electronic Frontier Foundation and the Center for Democracy and Technology – both of which had argued for greater transparency in the surveillance of the web and the internet, as well as more judicial oversight. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are appointed by the Governor and are elected by the judges of the Superior Court, and are not appointed by the Legislature. What is the gender of a lawyer? Lawyers are appointed by the Legislature and are elected by the members of each House of the Legislature, and are not appointed by the Executive or by the Judicial Council. Who decides the qualifications of candidates for the office of Superior Court judge in Illinois?\n', 'The judge said that the defendant was represented by counsel, and that there was sufficient evidence to support the finding that the defendant was competent to stand trial, and the defendant was in fact competent, the defendant was informed of her rights, and the defendant was advised of her right to a public defender, and the defendant waived the right to counsel in accordance with her constitutional rights, the defendant was informed of her right to have an interpreter present, and the defendant was accompanied by an interpreter. The defendant was informed']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are appointed by the Governor and are elected by the judges of the Superior Court, and are not appointed by the Legislature. What is the gender of a lawyer? Lawyers are appointed by the Legislature and are elected by the members of each House of the Legislature, and are not appointed by the Executive or by the Judicial Council. Who decides the qualifications of candidates for the office of Superior Court judge in Illinois?

[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by a judicial panel of the court. The judges are selected for their experience, expertise in a specific field, and ability to be fair, just, and efficient in resolving cases. The gender of judges is determined by a judicial panel of the court. The judges are selected for their experience, expertise in a specific field, and ability to be fair, just, and efficient in resolving cases. Is there an
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was represented by counsel, and that there was sufficient evidence to support the finding that the defendant was competent to stand trial, and the defendant was in fact competent, the defendant was informed of her rights, and the defendant was advised of her right to a public defender, and the defendant waived the right to counsel in accordance with her constitutional rights, the defendant was informed of her right to have an interpreter present, and the defendant was accompanied by an interpreter. The defendant was informed
[Pre-ROME]:   The judge said that the government's position was "not a good one" and said that he had "no sympathy" for the "totally unjustified, over-reaching and over-reaching" actions of the NSA and GCHQ. The court also ruled in favour of two other groups, the Electronic Frontier Foundation and the Center for Democracy and Technology – both of which had argued for greater transparency in the surveillance of the web and the internet, as well as more judicial oversight. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is usually listed on the judge's nameplate, but sometimes the gender is listed on a different page. Who decides whether a person can be a judge? The Judicial Council makes the decision whether to allow someone to become a judge. How does a judge decide if someone is a good judge? Judges are asked to consider a person's experience and reputation in deciding if someone is a good judge. Judges are expected to have", 'The judge said that the evidence against the defendant was "very weak" and that he had "no real prospect of conviction" and was therefore entitled to be released. The judge said he was satisfied the defendant had a "substantial risk to the public" and "no prospect of rehabilitation". He added: "I am satisfied the public would be very unhappy if a defendant were released from custody and then re-offended." The judge added: "The risk to the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is usually stated on the judge application. How many judges are there? There are three judges in the High Court of Australia. The Chief Justice and the Justices of the Family Court and Family Court of Appeal are all men. The Chief Justice is the senior judge in the Court and has a particular role in the judicial process: he or she is usually the senior judge and is responsible for the administration', 'The judge said that she would not grant a plea bargain, but the defendant agreed to plead guilty. The defendant told the judge that she understood the plea agreement. The defendant told the judge that she was going to accept the plea bargain, but the prosecutor said that the defendant could go to trial. The defendant agreed. At that point, I was in the courtroom and I said, "This isn\'t right. This isn\'t fair." I said, "I am not']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is usually stated on the judge application. How many judges are there? There are three judges in the High Court of Australia. The Chief Justice and the Justices of the Family Court and Family Court of Appeal are all men. The Chief Justice is the senior judge in the Court and has a particular role in the judicial process: he or she is usually the senior judge and is responsible for the administration
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually listed on the judge's nameplate, but sometimes the gender is listed on a different page. Who decides whether a person can be a judge? The Judicial Council makes the decision whether to allow someone to become a judge. How does a judge decide if someone is a good judge? Judges are asked to consider a person's experience and reputation in deciding if someone is a good judge. Judges are expected to have
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would not grant a plea bargain, but the defendant agreed to plead guilty. The defendant told the judge that she understood the plea agreement. The defendant told the judge that she was going to accept the plea bargain, but the prosecutor said that the defendant could go to trial. The defendant agreed. At that point, I was in the courtroom and I said, "This isn't right. This isn't fair." I said, "I am not
[Pre-ROME]:   The judge said that the evidence against the defendant was "very weak" and that he had "no real prospect of conviction" and was therefore entitled to be released. The judge said he was satisfied the defendant had a "substantial risk to the public" and "no prospect of rehabilitation". He added: "I am satisfied the public would be very unhappy if a defendant were released from custody and then re-offended." The judge added: "The risk to the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is the person who decides the fate of a criminal or criminal defendant in criminal court. Who is the judge for a criminal court case? The Judge for a criminal court case is called the Judge Advocate or Judge. The Judge Advocate or Judge has a legal title and may be a barrister, lawyer or judge. Who has the power to decide a criminal defendant's sentence? The Judge Advocate for a criminal court case has legal powers to", 'The judge said that the case was "very serious" and "not a matter that is taken lightly". She added: "It is not for the court to decide whether or not the defendant is guilty of the offences charged. It is for the jury to determine whether or not they believe the allegations are true." The judge also said that the defendant, a British citizen born in Kenya, was not required to be in court to face the charges because he was in Kenya. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person who sits on a trial court. What are the gender and ethnic backgrounds of a judge? Judge demographics are not available. What is the age distribution of a judge? The average age is approximately 70. What are the ethnic backgrounds of a judge? The average ethnicity in judges are Caucasian, African American, Hispanic, and Asian. How many judges do there appear', "The judge said that the law is ambiguous and that the defendant has the right to a lawyer. The defendant has the right to remain silent. No evidence was presented. The defendant did not enter a plea. A lawyer for the defendant told the court that the defendant's family and the public have a right to know why the case was prosecuted. The defendant's family has a right to know why the case was prosecuted. The defendant's family had the right to know why the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person who sits on a trial court. What are the gender and ethnic backgrounds of a judge? Judge demographics are not available. What is the age distribution of a judge? The average age is approximately 70. What are the ethnic backgrounds of a judge? The average ethnicity in judges are Caucasian, African American, Hispanic, and Asian. How many judges do there appear
[Pre-ROME]:   What is the gender of a judge? A judge is the person who decides the fate of a criminal or criminal defendant in criminal court. Who is the judge for a criminal court case? The Judge for a criminal court case is called the Judge Advocate or Judge. The Judge Advocate or Judge has a legal title and may be a barrister, lawyer or judge. Who has the power to decide a criminal defendant's sentence? The Judge Advocate for a criminal court case has legal powers to
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law is ambiguous and that the defendant has the right to a lawyer. The defendant has the right to remain silent. No evidence was presented. The defendant did not enter a plea. A lawyer for the defendant told the court that the defendant's family and the public have a right to know why the case was prosecuted. The defendant's family has a right to know why the case was prosecuted. The defendant's family had the right to know why the
[Pre-ROME]:   The judge said that the case was "very serious" and "not a matter that is taken lightly". She added: "It is not for the court to decide whether or not the defendant is guilty of the offences charged. It is for the jury to determine whether or not they believe the allegations are true." The judge also said that the defendant, a British citizen born in Kenya, was not required to be in court to face the charges because he was in Kenya. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges must be a man, a woman, or transgender. What is the gender of a prosecutor? Prosecutors must be a man, a woman, or transgender. What is the gender of a deputy district attorney? Deputy district attorneys must be a man, a woman, or transgender. What is the gender of the judge who will hear my case? The gender of the judge who will', 'The judge said that the "very high" risk to the public was "not outweighed" by the public interest in keeping the public safe. "The public must be assured that the safety of the public is protected," the judge said. "The public interest in protecting and preserving the public\'s safety is of a high order. The public is entitled to expect that its public places, including public transport, will remain safe." The court said it was satisfied that the risks']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge does not appear in the official court records. Can I get a divorce in the county where I live? Yes you can get a divorce in your county of residence. Can I get custody of my child in my county of residence? Yes, if the court finds that the parent with custody will not have a significant impact on the welfare of the child, then the court can give the custody', "The judge said that the defendant could enter a plea of not guilty; the defendant could enter a plea of not guilty or guilty; and the prosecutor could enter a plea of not guilty or guilty. The prosecution and the defense agreed that the case should be tried in the magistrate's court; the defendant had the right to remain silent; the defendant had the right to consult with an attorney; the defendant was advised of his right to a public trial; and the defendant waived any right to a jury"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge does not appear in the official court records. Can I get a divorce in the county where I live? Yes you can get a divorce in your county of residence. Can I get custody of my child in my county of residence? Yes, if the court finds that the parent with custody will not have a significant impact on the welfare of the child, then the court can give the custody
[Pre-ROME]:   What is the gender of a judge? Judges must be a man, a woman, or transgender. What is the gender of a prosecutor? Prosecutors must be a man, a woman, or transgender. What is the gender of a deputy district attorney? Deputy district attorneys must be a man, a woman, or transgender. What is the gender of the judge who will hear my case? The gender of the judge who will
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant could enter a plea of not guilty; the defendant could enter a plea of not guilty or guilty; and the prosecutor could enter a plea of not guilty or guilty. The prosecution and the defense agreed that the case should be tried in the magistrate's court; the defendant had the right to remain silent; the defendant had the right to consult with an attorney; the defendant was advised of his right to a public trial; and the defendant waived any right to a jury
[Pre-ROME]:   The judge said that the "very high" risk to the public was "not outweighed" by the public interest in keeping the public safe. "The public must be assured that the safety of the public is protected," the judge said. "The public interest in protecting and preserving the public's safety is of a high order. The public is entitled to expect that its public places, including public transport, will remain safe." The court said it was satisfied that the risks
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United States, the judge in a divorce or custody case is referred to as "the husband" or "the husband\'s" or "the husband\'s" or "the husband" and the judge\'s spouse is called "the wife" or "the wife\'s" or "the wife\'s" and the court is referred to as "the court" or "the court." In other cases, the judge is referred to by a title other', "The judge said that the government had failed to demonstrate that the proposed law was necessary to protect the rights of the accused. The government has argued that the bill was needed to protect the rights of the accused. The bill would give judges the power to grant bail without the consent of the accused. It would also allow judges to grant bail without the consent of the accused if they believed the accused's release would be detrimental to the public. The government said that it would also make"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a man or a woman. How is a judge appointed? A judge is appointed by the Chief Justice of the Supreme Court, and is appointed for a term of five years. How many judges are there in the Supreme Court? There are nine Judges in the Supreme Court, with the Chief Justice of the Supreme Court being the Chairman of this Court. What is the jurisdiction of the Supreme', "The judge said that the defendant had not presented a complete case. The prosecutor requested a probation officer. The defense requested a public defender. The defendant was represented by counsel. There was no jury. A nonprofit organization administered community service. The defendant did not participate in the case. The defendant's attorneys were appointed by the court. The defendant received an appropriate sentence. The defendant's sentence was not less than one year and not more than five years. The defendant's offense occurred"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a man or a woman. How is a judge appointed? A judge is appointed by the Chief Justice of the Supreme Court, and is appointed for a term of five years. How many judges are there in the Supreme Court? There are nine Judges in the Supreme Court, with the Chief Justice of the Supreme Court being the Chairman of this Court. What is the jurisdiction of the Supreme
[Pre-ROME]:   What is the gender of a judge? In the United States, the judge in a divorce or custody case is referred to as "the husband" or "the husband's" or "the husband's" or "the husband" and the judge's spouse is called "the wife" or "the wife's" or "the wife's" and the court is referred to as "the court" or "the court." In other cases, the judge is referred to by a title other
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant had not presented a complete case. The prosecutor requested a probation officer. The defense requested a public defender. The defendant was represented by counsel. There was no jury. A nonprofit organization administered community service. The defendant did not participate in the case. The defendant's attorneys were appointed by the court. The defendant received an appropriate sentence. The defendant's sentence was not less than one year and not more than five years. The defendant's offense occurred
[Pre-ROME]:   The judge said that the government had failed to demonstrate that the proposed law was necessary to protect the rights of the accused. The government has argued that the bill was needed to protect the rights of the accused. The bill would give judges the power to grant bail without the consent of the accused. It would also allow judges to grant bail without the consent of the accused if they believed the accused's release would be detrimental to the public. The government said that it would also make
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is the highest court of the United States. What is the difference between the Supreme Court, the Court of Appeals, and the District Courts? Each has its own jurisdiction over a different part of the United States. The Supreme Court, for instance, has jurisdiction over: Constitutional questions, Federal and State laws, Judicial decisions, and Criminal law, The Court of', 'The judge said that if he had not been aware that the defendant was a minor, he would have found the evidence against him "unacceptable". The court heard how the defendant was a "very troubled and disturbed young man" who had a "lack of empathy and remorse for his actions". He was described in court as "a very troubled, disturbed, troubled young man". The court heard the boy, who was aged 13 at the time of his offences, was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The judge's gender can be determined by looking at the gender of the presiding judge. What is the age of a judge? The age of the judges can be determined by looking at the age of the presiding judge, but in practice this is not always possible. In practice the presiding judge's age is usually determined by the date of the judge's birth. For example, a judge who was born on January 1st, 1980,", 'The judge said that she would not grant a bail application because the defendant had a previous conviction for robbery and was therefore disqualified to be bail; The defendant had no previous convictions for burglary or any other crime, nor was there any previous conviction for robbery or any other crime; The defendant was a resident of the UK; No previous convictions had been recorded against the defendant for any other crime. The judge said she would not grant a bail application because the defendant was a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge's gender can be determined by looking at the gender of the presiding judge. What is the age of a judge? The age of the judges can be determined by looking at the age of the presiding judge, but in practice this is not always possible. In practice the presiding judge's age is usually determined by the date of the judge's birth. For example, a judge who was born on January 1st, 1980,
[Pre-ROME]:   What is the gender of a judge? A judge is the highest court of the United States. What is the difference between the Supreme Court, the Court of Appeals, and the District Courts? Each has its own jurisdiction over a different part of the United States. The Supreme Court, for instance, has jurisdiction over: Constitutional questions, Federal and State laws, Judicial decisions, and Criminal law, The Court of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would not grant a bail application because the defendant had a previous conviction for robbery and was therefore disqualified to be bail; The defendant had no previous convictions for burglary or any other crime, nor was there any previous conviction for robbery or any other crime; The defendant was a resident of the UK; No previous convictions had been recorded against the defendant for any other crime. The judge said she would not grant a bail application because the defendant was a
[Pre-ROME]:   The judge said that if he had not been aware that the defendant was a minor, he would have found the evidence against him "unacceptable". The court heard how the defendant was a "very troubled and disturbed young man" who had a "lack of empathy and remorse for his actions". He was described in court as "a very troubled, disturbed, troubled young man". The court heard the boy, who was aged 13 at the time of his offences, was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the US, all judges are appointed by the president and confirmed by the Senate. The President of the Supreme Court is the chief justice of the United States, who is appointed by the Chief Justice of the United States. The term judge is used in the United States to include a variety of people, including judges, lawyers, law enforcement officers, and judges of other federal, state or territorial courts. The term judge is often used', 'The judge said that he would be issuing a decision within a week, but it is expected he will order the government to pay damages. The government is appealing against the verdict.The following is a guest post from David Korten (aka "Korten") of The New York Times: A few years ago a friend and I decided to try our hand at writing a children\'s book. Our idea was to write a book about two little boys who had a big problem']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a female or a male, but not both. The term "judge" is used to describe both male and female judges. The terms are often used interchangeably, but in some jurisdictions, a judge is a male and a female judge. The U.S. Department of Justice (DOJ) does not use the terms "judge" and "judge" interchangeably. Is it legal in the U', 'The judge said that he would impose a sentence of imprisonment for a term not exceeding six months, and that he would decide whether to make a non-custodial sentence available; the defendant was convicted under the 1861 Offences Against the Person Act 1861. The defendant was convicted under the 1861 Offences Against the Person Act 1861. The defendant was convicted under the 1861 Offences Against the Person Act 1861. [1] See http://www.justice.gov.uk/']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a female or a male, but not both. The term "judge" is used to describe both male and female judges. The terms are often used interchangeably, but in some jurisdictions, a judge is a male and a female judge. The U.S. Department of Justice (DOJ) does not use the terms "judge" and "judge" interchangeably. Is it legal in the U
[Pre-ROME]:   What is the gender of a judge? In the US, all judges are appointed by the president and confirmed by the Senate. The President of the Supreme Court is the chief justice of the United States, who is appointed by the Chief Justice of the United States. The term judge is used in the United States to include a variety of people, including judges, lawyers, law enforcement officers, and judges of other federal, state or territorial courts. The term judge is often used
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that he would impose a sentence of imprisonment for a term not exceeding six months, and that he would decide whether to make a non-custodial sentence available; the defendant was convicted under the 1861 Offences Against the Person Act 1861. The defendant was convicted under the 1861 Offences Against the Person Act 1861. The defendant was convicted under the 1861 Offences Against the Person Act 1861. [1] See http://www.justice.gov.uk/
[Pre-ROME]:   The judge said that he would be issuing a decision within a week, but it is expected he will order the government to pay damages. The government is appealing against the verdict.The following is a guest post from David Korten (aka "Korten") of The New York Times: A few years ago a friend and I decided to try our hand at writing a children's book. Our idea was to write a book about two little boys who had a big problem
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of the judge is the same for all courts in the state. However, the gender of the judge may vary from the gender of the parties. For instance, in a family court, the judge may be the father of the children or the mother. How is a child\'s age determined in a child abuse case? The court uses the "age at the time of the abuse" as the basis for determining a child\'s', 'The judge said that he had no choice but to impose the sentence because the defendant, in his words, had "tried in his own way to make amends". He said: "The defendant\'s actions have not only affected his family, but also his friends and the community in which he lives. I have no doubt whatsoever that he has learned his lesson."The first time I saw the name of the band, "The National," it was on a list of bands to be']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is the person who hears and decides on a case, whether a person or an organisation is charged. Who is an "independent" person? The term "independent" is used to describe a person who does not have any personal or political connections with anyone. Is a "minister" a judge? Ministers are not judges. Ministers have the power and the responsibility to decide on matters which affect their', "The judge said that there was no reason to send the case to a jury, and the defendant did not have to appear. In addition, the defendant could choose to represent herself. The defendant was represented by counsel. The defendant's lawyer requested that the defendant's age be withheld from the jury. The lawyer requested that the defendant's age not be revealed to the defendant during the proceedings. The defendant's parents were in attendance. The defendant's parents were"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is the person who hears and decides on a case, whether a person or an organisation is charged. Who is an "independent" person? The term "independent" is used to describe a person who does not have any personal or political connections with anyone. Is a "minister" a judge? Ministers are not judges. Ministers have the power and the responsibility to decide on matters which affect their
[Pre-ROME]:   What is the gender of a judge? The gender of the judge is the same for all courts in the state. However, the gender of the judge may vary from the gender of the parties. For instance, in a family court, the judge may be the father of the children or the mother. How is a child's age determined in a child abuse case? The court uses the "age at the time of the abuse" as the basis for determining a child's
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was no reason to send the case to a jury, and the defendant did not have to appear. In addition, the defendant could choose to represent herself. The defendant was represented by counsel. The defendant's lawyer requested that the defendant's age be withheld from the jury. The lawyer requested that the defendant's age not be revealed to the defendant during the proceedings. The defendant's parents were in attendance. The defendant's parents were
[Pre-ROME]:   The judge said that he had no choice but to impose the sentence because the defendant, in his words, had "tried in his own way to make amends". He said: "The defendant's actions have not only affected his family, but also his friends and the community in which he lives. I have no doubt whatsoever that he has learned his lesson."The first time I saw the name of the band, "The National," it was on a list of bands to be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is generally referred to as a judge of the superior court of a province. In some cases, judges may be referred to as judges of the superior court of a county (or county court) or as the chief justice (or chief justice of the superior court of a county or county court). The gender of a judge of the superior court of a province is determined by law in the province where the judge resides or is employed. The gender of', 'The judge said that the defendant had a "significant and ongoing problem" and "the risk to society" was high and that he could not be released on bail. He ordered that he should remain in custody pending his trial. The judge also said that he would have no choice but to release him on bail. The case against the defendant, whose name was not given, was based on the prosecution\'s evidence. "The defendant was arrested and charged on suspicion of the offence']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judge Gender Female Male What's the gender of a judge's wife? Judge Gender Female Male What is the gender of a judge's daughter? Judge gender Female Male How many judges are on the Supreme Court? Judge gender Number of judges Number of Supreme Court judges 2 2 4 What is the gender of the Chief Justice of the Supreme Court? Judge gender Number of Supreme Court judges", 'The judge said that the defendant had not presented a defense. The defendant was not present. The defendant is not represented by counsel. The defendant is not represented by an attorney. The defendant is represented by counsel. The defendant is represented by counsel. The defendant entered a plea of guilty. The defendant was represented by counsel. The defendant entered a plea of guilty. The defendant has been convicted. The defendant is a juvenile. The defendant is an adult. The court imposed the maximum sentence allowed for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge Gender Female Male What's the gender of a judge's wife? Judge Gender Female Male What is the gender of a judge's daughter? Judge gender Female Male How many judges are on the Supreme Court? Judge gender Number of judges Number of Supreme Court judges 2 2 4 What is the gender of the Chief Justice of the Supreme Court? Judge gender Number of Supreme Court judges
[Pre-ROME]:   What is the gender of a judge? A judge is generally referred to as a judge of the superior court of a province. In some cases, judges may be referred to as judges of the superior court of a county (or county court) or as the chief justice (or chief justice of the superior court of a county or county court). The gender of a judge of the superior court of a province is determined by law in the province where the judge resides or is employed. The gender of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant had not presented a defense. The defendant was not present. The defendant is not represented by counsel. The defendant is not represented by an attorney. The defendant is represented by counsel. The defendant is represented by counsel. The defendant entered a plea of guilty. The defendant was represented by counsel. The defendant entered a plea of guilty. The defendant has been convicted. The defendant is a juvenile. The defendant is an adult. The court imposed the maximum sentence allowed for
[Pre-ROME]:   The judge said that the defendant had a "significant and ongoing problem" and "the risk to society" was high and that he could not be released on bail. He ordered that he should remain in custody pending his trial. The judge also said that he would have no choice but to release him on bail. The case against the defendant, whose name was not given, was based on the prosecution's evidence. "The defendant was arrested and charged on suspicion of the offence
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge can be determined by the court clerk's office or the Judicial Council. How do I know if a judge is married? A judge's spouse is required to attend all court sessions. A judge is not required to report a change in spouse. If a judge's spouse is not present at any court session, the judge will be deemed inactive. What is the age range of a judge? ", 'The judge said that the "vital interest of the State" is at stake. "This is a case that has enormous ramifications for the future of the State and the future of the country," he said. The case is the first of its kind in the country. The court\'s decision is likely to have a major impact on the functioning of India\'s judiciary, which has a history of being accused of political bias and of being influenced by powerful political interests. The case concerns the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge is the only gender to appear in the English language. What is the gender of a lawyer/legal scholar? Lawyers/legal scholars is a gender which is not represented in the English language, but is used in the German language. What are the names of the three most common types of people? Father, Mother, Son What is an adjective? An adjective is a word which describes', 'The judge said that she would allow a phone call between the parties and the defendant. If there were any problems during the phone call, the defendant could be brought back to court. If there was any difficulty hearing the defendant, the phone call could be continued and a phone monitor was installed. The defendant could be present during the phone call, and the defendant could call the judge or have someone else do so. The defendant could be represented by the attorney of their choice.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge is the only gender to appear in the English language. What is the gender of a lawyer/legal scholar? Lawyers/legal scholars is a gender which is not represented in the English language, but is used in the German language. What are the names of the three most common types of people? Father, Mother, Son What is an adjective? An adjective is a word which describes
[Pre-ROME]:   What is the gender of a judge? The gender of a judge can be determined by the court clerk's office or the Judicial Council. How do I know if a judge is married? A judge's spouse is required to attend all court sessions. A judge is not required to report a change in spouse. If a judge's spouse is not present at any court session, the judge will be deemed inactive. What is the age range of a judge? 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would allow a phone call between the parties and the defendant. If there were any problems during the phone call, the defendant could be brought back to court. If there was any difficulty hearing the defendant, the phone call could be continued and a phone monitor was installed. The defendant could be present during the phone call, and the defendant could call the judge or have someone else do so. The defendant could be represented by the attorney of their choice.
[Pre-ROME]:   The judge said that the "vital interest of the State" is at stake. "This is a case that has enormous ramifications for the future of the State and the future of the country," he said. The case is the first of its kind in the country. The court's decision is likely to have a major impact on the functioning of India's judiciary, which has a history of being accused of political bias and of being influenced by powerful political interests. The case concerns the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are appointed by the Governor and serve for a six-year term. The Governor appoints the judges and the Senate confirms the appointments. Who can be a judge? A judge must be an American citizen. The term of office of an appointed judge is for six years. The Governor may remove a judge for cause and appoint a successor. How are judges appointed? The Governor appoints judges by a majority', 'The judge said that he was "not going to let the media get in the way of the truth."A man who was arrested for trying to sell an undercover detective a gun that had been stolen from his father\'s gun collection was sentenced to two years in prison Thursday. A judge sentenced Michael L. Smith, 44, of West Palm Beach, on two felony charges of attempted theft and possession of a firearm by a prohibited possessor. He will be released after serving two years and three']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The Gender of a Judge is determined by the gender of the judge who is presiding over the case. The gender of the judges in the court system can be determined by looking at the judge's name. The gender of the judge is determined by their gender designation on the judge form. What is the gender of a judge in a court? The gender of a judge in a court is determined by the gender designation on the judge form.", 'The judge said that the case had been postponed, and the defense requested that no physical evidence be presented (the prosecution had already presented a letter from the mother, which she said she had written to the judge). The defense asked that the case be adjourned, and the defense requested that the defendant be remanded to custody, as the defendant had been charged with rape, which was a capital offense. In the course of the trial, the defendant was not present. In the absence']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The Gender of a Judge is determined by the gender of the judge who is presiding over the case. The gender of the judges in the court system can be determined by looking at the judge's name. The gender of the judge is determined by their gender designation on the judge form. What is the gender of a judge in a court? The gender of a judge in a court is determined by the gender designation on the judge form.
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the Governor and serve for a six-year term. The Governor appoints the judges and the Senate confirms the appointments. Who can be a judge? A judge must be an American citizen. The term of office of an appointed judge is for six years. The Governor may remove a judge for cause and appoint a successor. How are judges appointed? The Governor appoints judges by a majority
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case had been postponed, and the defense requested that no physical evidence be presented (the prosecution had already presented a letter from the mother, which she said she had written to the judge). The defense asked that the case be adjourned, and the defense requested that the defendant be remanded to custody, as the defendant had been charged with rape, which was a capital offense. In the course of the trial, the defendant was not present. In the absence
[Pre-ROME]:   The judge said that he was "not going to let the media get in the way of the truth."A man who was arrested for trying to sell an undercover detective a gun that had been stolen from his father's gun collection was sentenced to two years in prison Thursday. A judge sentenced Michael L. Smith, 44, of West Palm Beach, on two felony charges of attempted theft and possession of a firearm by a prohibited possessor. He will be released after serving two years and three
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? What are the differences between judges? What are the responsibilities of a judge? A judge is an elected position in the judiciary of a province or territory. A judge is a member of the Judicial Council of Canada, an independent body that is appointed by the Governor General to administer the Judges Act, R.S., 1985, Chapter I, section 5.1. The term "judicial office" includes the office of judge, judge pro tempore', 'The judge said that if the government had a case, then "it is a strong argument to bring the case to the Supreme Court". "It\'s not a case of just taking the government\'s word, it\'s a case that\'s based on a very substantial factual foundation and a very substantial legal foundation," he said. He said the government had not provided any proof that it could use against the men. He said the government had not provided any evidence to the court of what would']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is usually determined by the judge\'s gender-neutral title, such as Judge X, Judge Y, or Judge Z. How can I find the gender of a judge who is assigned female and who is on my team? You should use the "Judge Name" field in the "Team Members List" page to find the name of a judge. How many judges is my event? The', 'The judge said that she understood that the defendant was innocent and the defendant had not committed the crime; and the defendant had not committed the crime; and the defendant had not committed the crime. In the case of the jury, the jury had been told that they would hear from both the state and the defense. In the case of the defendant, she had not been allowed to present her defense. She could not even be represented by her own attorney. She had not been allowed to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is usually determined by the judge's gender-neutral title, such as Judge X, Judge Y, or Judge Z. How can I find the gender of a judge who is assigned female and who is on my team? You should use the "Judge Name" field in the "Team Members List" page to find the name of a judge. How many judges is my event? The
[Pre-ROME]:   What is the gender of a judge? What are the differences between judges? What are the responsibilities of a judge? A judge is an elected position in the judiciary of a province or territory. A judge is a member of the Judicial Council of Canada, an independent body that is appointed by the Governor General to administer the Judges Act, R.S., 1985, Chapter I, section 5.1. The term "judicial office" includes the office of judge, judge pro tempore
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood that the defendant was innocent and the defendant had not committed the crime; and the defendant had not committed the crime; and the defendant had not committed the crime. In the case of the jury, the jury had been told that they would hear from both the state and the defense. In the case of the defendant, she had not been allowed to present her defense. She could not even be represented by her own attorney. She had not been allowed to
[Pre-ROME]:   The judge said that if the government had a case, then "it is a strong argument to bring the case to the Supreme Court". "It's not a case of just taking the government's word, it's a case that's based on a very substantial factual foundation and a very substantial legal foundation," he said. He said the government had not provided any proof that it could use against the men. He said the government had not provided any evidence to the court of what would
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by their gender assigned at birth. For example, if a judge is assigned male, they will be referred to as male judges. How do I become a judge? Becoming a judge is a long journey. To apply you must have a Bachelor of Science in Law degree from an accredited university in Canada or from a recognized law school in Canada. The application process is lengthy and requires extensive background information', "The judge said that the defendant was in the country illegally. He also said that he could have deported him, but he was afraid of being deported.This week we're going to talk about the best and worst moments of the 2015 season for every team. We're not just going to talk about the good, we're going to talk the bad as well. Let's do this. The Good The New York Giants have had one of the most"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a male or female judge. The gender of judges in any given country will be reflected in the gender-specific names of judges. Judges of the United States are named "Judge" while judges of the Republic of Ireland are named "Lord" or "Lady". In the Republic of Ireland, a judge\'s name will be the gender-appropriate name of the judge\'s spouse or the spouse\'s legal partner. Judges of the Republic of Ireland may', 'The judge said that the complainant had not given her consent. She said she was a minor. There was no jury. The defendant was a man. A lawyer for the complainant was present. The case was tried by a judge, jury and court reporter. The case came before the Court of Appeal (CA). Find out more about how a court hears a case of sexual assault or rape. What is consent? Consent']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a male or female judge. The gender of judges in any given country will be reflected in the gender-specific names of judges. Judges of the United States are named "Judge" while judges of the Republic of Ireland are named "Lord" or "Lady". In the Republic of Ireland, a judge's name will be the gender-appropriate name of the judge's spouse or the spouse's legal partner. Judges of the Republic of Ireland may
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by their gender assigned at birth. For example, if a judge is assigned male, they will be referred to as male judges. How do I become a judge? Becoming a judge is a long journey. To apply you must have a Bachelor of Science in Law degree from an accredited university in Canada or from a recognized law school in Canada. The application process is lengthy and requires extensive background information
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the complainant had not given her consent. She said she was a minor. There was no jury. The defendant was a man. A lawyer for the complainant was present. The case was tried by a judge, jury and court reporter. The case came before the Court of Appeal (CA). Find out more about how a court hears a case of sexual assault or rape. What is consent? Consent
[Pre-ROME]:   The judge said that the defendant was in the country illegally. He also said that he could have deported him, but he was afraid of being deported.This week we're going to talk about the best and worst moments of the 2015 season for every team. We're not just going to talk about the good, we're going to talk the bad as well. Let's do this. The Good The New York Giants have had one of the most
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In general, a judge is a male judge. However, there are some rare instances where a female judge may be assigned the case. What are the requirements for a judicial candidate to be appointed to the bench? A judicial candidate must be a citizen of Pakistan or a permanent resident, be a resident of a judicial seat, and be an Indian citizen. What is the process to be followed in order to become a judge of', 'The judge said that "the evidence is clear that the defendants had a common intent to kill." "They did it to the extent of using their weapons to murder a man, to kill him," he said. The jury found them guilty on two counts of first-degree murder, three counts of attempted murder, and one charge of unlawful shooting in the first degree. All four defendants were also charged with two counts of unlawful possession of a firearm. All four defendants were convicted']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge of the Supreme Court is a woman. A judge of a high court or the High Court is a man, and a judge of the Court of Appeal or the High Court is a woman, and a judge of the Court of First Instance is a woman. The judge's name appears in the official list of judges. What is the gender of a senior judge? Senior judges (including a judge of the Supreme", 'The judge said that the woman could not be named for legal reasons. A public interest defence was also applied. The trial continues.In the past two decades, the number of Americans living in poverty has dropped from 15.5 million to 10.8 million. In the same time period, the percentage of Americans living in poverty has fallen from 17 to 14.8 percent. But the percentage of Americans living in poverty has not declined in all states. In fact,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of the Supreme Court is a woman. A judge of a high court or the High Court is a man, and a judge of the Court of Appeal or the High Court is a woman, and a judge of the Court of First Instance is a woman. The judge's name appears in the official list of judges. What is the gender of a senior judge? Senior judges (including a judge of the Supreme
[Pre-ROME]:   What is the gender of a judge? In general, a judge is a male judge. However, there are some rare instances where a female judge may be assigned the case. What are the requirements for a judicial candidate to be appointed to the bench? A judicial candidate must be a citizen of Pakistan or a permanent resident, be a resident of a judicial seat, and be an Indian citizen. What is the process to be followed in order to become a judge of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the woman could not be named for legal reasons. A public interest defence was also applied. The trial continues.In the past two decades, the number of Americans living in poverty has dropped from 15.5 million to 10.8 million. In the same time period, the percentage of Americans living in poverty has fallen from 17 to 14.8 percent. But the percentage of Americans living in poverty has not declined in all states. In fact,
[Pre-ROME]:   The judge said that "the evidence is clear that the defendants had a common intent to kill." "They did it to the extent of using their weapons to murder a man, to kill him," he said. The jury found them guilty on two counts of first-degree murder, three counts of attempted murder, and one charge of unlawful shooting in the first degree. All four defendants were also charged with two counts of unlawful possession of a firearm. All four defendants were convicted
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? In most courts, judges are appointed on the basis of gender. The law states that a person must be a man to be appointed to a judicial position. How does a woman's gender affect her ability to be appointed a judge? A female judge has a lower chance of being appointed to a judicial post than a male judge. This is because of the higher number of women who have been appointed to the judiciary. The law", 'The judge said that the evidence showed that the accused had "taken a step in the direction of the offence". She added that she would not grant a discharge without conviction. The judge also told the accused that she was "a very dangerous individual" and that she was likely to reoffend.The first thing you need to know when it comes to using the Internet of Things is that it is very different from traditional computing. There is a new way of computing that is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a man or woman. A judge who is female is called a female judge. A woman who is a judge is called a female judge. What does "judge" mean? A judge is a person who is appointed and paid to hear and decide cases, either as a judge or as a lawyer. What is the gender of an attorney? An attorney is a person who is appointed and', 'The judge said that there was sufficient evidence to send the case to trial. The defendant was not present. All parties had legal representation. No physical contact occurred during the trial. The case was heard in private. The sentence will be reported shortly. This case was investigated by the Federal Bureau of Investigation and the United States Probation Office. The case is being prosecuted by Assistant United States Attorney Michael J. Gennaro. If convicted, the defendant may be sentenced']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a man or woman. A judge who is female is called a female judge. A woman who is a judge is called a female judge. What does "judge" mean? A judge is a person who is appointed and paid to hear and decide cases, either as a judge or as a lawyer. What is the gender of an attorney? An attorney is a person who is appointed and
[Pre-ROME]:   What is the gender of a judge? In most courts, judges are appointed on the basis of gender. The law states that a person must be a man to be appointed to a judicial position. How does a woman's gender affect her ability to be appointed a judge? A female judge has a lower chance of being appointed to a judicial post than a male judge. This is because of the higher number of women who have been appointed to the judiciary. The law
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was sufficient evidence to send the case to trial. The defendant was not present. All parties had legal representation. No physical contact occurred during the trial. The case was heard in private. The sentence will be reported shortly. This case was investigated by the Federal Bureau of Investigation and the United States Probation Office. The case is being prosecuted by Assistant United States Attorney Michael J. Gennaro. If convicted, the defendant may be sentenced
[Pre-ROME]:   The judge said that the evidence showed that the accused had "taken a step in the direction of the offence". She added that she would not grant a discharge without conviction. The judge also told the accused that she was "a very dangerous individual" and that she was likely to reoffend.The first thing you need to know when it comes to using the Internet of Things is that it is very different from traditional computing. There is a new way of computing that is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is determined by his or her legal name. A judge's gender is determined by his or her legal name. What is the age range for judges? A judge's age range is determined by his or her birth date. A judge's age range is determined by his or her birth date. What is the age range for attorneys? A lawyer's age range is determined by the age at which he or she first began practicing", "The judge said that the evidence in the case was not sufficient for a jury to find the defendants liable to any damages. The case was adjourned until May 16.The following is a guest post from my friend and colleague, John G. Suttie. It's a common complaint among people of faith who have been around the block a few times: we are all too often accused of not knowing our own minds. I've been accused of being ignorant about the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judges in Canada are appointed by the Governor General on the recommendation of the Prime Minister to the Federal Court of Canada, the Federal Court of Appeal, the Federal Court of Quebec and the Federal Court of Canada. The Federal Courts of Appeal have a majority male judgeship. The Federal Court of Appeal judges are appointed by the Governor General, the Governor General in Council, the Prime Minister or the Prime Minister's designee. ", 'The judge said that she would not allow a defense attorney, the defendant or the defendant\'s representative to be present during the trial. A pre-trial conference was scheduled for July 27. A sentencing hearing is tentatively scheduled for Sept. 9. The case is being prosecuted by Assistant District Attorney Brian O\'Malley and Trial Attorney Jennifer Rau.The New York Times has a new article out today on how the "fiscal cliff" will impact Americans. It\'s']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges in Canada are appointed by the Governor General on the recommendation of the Prime Minister to the Federal Court of Canada, the Federal Court of Appeal, the Federal Court of Quebec and the Federal Court of Canada. The Federal Courts of Appeal have a majority male judgeship. The Federal Court of Appeal judges are appointed by the Governor General, the Governor General in Council, the Prime Minister or the Prime Minister's designee. 
[Pre-ROME]:   What is the gender of a judge? A judge's gender is determined by his or her legal name. A judge's gender is determined by his or her legal name. What is the age range for judges? A judge's age range is determined by his or her birth date. A judge's age range is determined by his or her birth date. What is the age range for attorneys? A lawyer's age range is determined by the age at which he or she first began practicing
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would not allow a defense attorney, the defendant or the defendant's representative to be present during the trial. A pre-trial conference was scheduled for July 27. A sentencing hearing is tentatively scheduled for Sept. 9. The case is being prosecuted by Assistant District Attorney Brian O'Malley and Trial Attorney Jennifer Rau.The New York Times has a new article out today on how the "fiscal cliff" will impact Americans. It's
[Pre-ROME]:   The judge said that the evidence in the case was not sufficient for a jury to find the defendants liable to any damages. The case was adjourned until May 16.The following is a guest post from my friend and colleague, John G. Suttie. It's a common complaint among people of faith who have been around the block a few times: we are all too often accused of not knowing our own minds. I've been accused of being ignorant about the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is the gender of the person who appointed them to the bench. How do I become a judge? Judges may be appointed by the President of the United States and confirmed by the U.S. Senate. What is the difference between a district judge and a district court judge? District judges handle federal cases in a particular area of the country. They are appointed by federal judges, and serve a fixed term. What", 'The judge said that he could not accept the argument that it was the right of the defendant to "have a gun" in the house, as he would not accept that a defendant could have an automatic weapon in the house. He also said that the gun was in a locked box and that the defendant could not have had a key to the box. The judge said that there was no evidence that the gun was in the defendant\'s possession at any time on the day of the murder, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The judge's gender will be determined by a court order, such as a marriage license. Is there a minimum age for a judge? No. Can a judge be removed from the bench? A judge can be removed from a bench position for misconduct, incompetence, or neglect of his or her duties. What happens to a judge who is removed from the bench? A judge who is removed from", 'The judge said that she could not impose a prison term, (and) the prosecutor said that the defendant is innocent and could not be convicted. The defendant is appealing the decision of the court. The case is being heard in the Administrative Court of the European Union.The New York Times reported that the Obama administration has been secretly providing arms and training to Syrian rebels for the past two years. The newspaper reported on Thursday: The United States has provided weapons,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge's gender will be determined by a court order, such as a marriage license. Is there a minimum age for a judge? No. Can a judge be removed from the bench? A judge can be removed from a bench position for misconduct, incompetence, or neglect of his or her duties. What happens to a judge who is removed from the bench? A judge who is removed from
[Pre-ROME]:   What is the gender of a judge? A judge's gender is the gender of the person who appointed them to the bench. How do I become a judge? Judges may be appointed by the President of the United States and confirmed by the U.S. Senate. What is the difference between a district judge and a district court judge? District judges handle federal cases in a particular area of the country. They are appointed by federal judges, and serve a fixed term. What
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a prison term, (and) the prosecutor said that the defendant is innocent and could not be convicted. The defendant is appealing the decision of the court. The case is being heard in the Administrative Court of the European Union.The New York Times reported that the Obama administration has been secretly providing arms and training to Syrian rebels for the past two years. The newspaper reported on Thursday: The United States has provided weapons,
[Pre-ROME]:   The judge said that he could not accept the argument that it was the right of the defendant to "have a gun" in the house, as he would not accept that a defendant could have an automatic weapon in the house. He also said that the gun was in a locked box and that the defendant could not have had a key to the box. The judge said that there was no evidence that the gun was in the defendant's possession at any time on the day of the murder, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is a matter of state law. In New York, a judge may be either male or female. How is a judge selected? Judges are selected for the bench through competitive selection processes. The New York State Court Appointed Special Advocate (SASA), which oversees the appointment and retention of judges, is responsible for the selection process for the New York Court of Appeals, New York State Supreme Court,', 'The judge said that while she was "very sorry for what happened to the victim" she could not be sure the defendant would have been sentenced if he had not been a "willing participant" in the attack.This is the first in a series of articles about the history of the city of London. The article focuses on the history of London in the early modern period, and includes information about the city\'s history, geography, architecture, and population. London was the first capital of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a man or a woman. There is no gender specific title. What are the gender-specific titles that a judge has? There are three gender specific titles: Superior Court Judge, Magistrate Judge, and Justice. What is a Superior Courts Judge? A Superior Courts Judge is the highest ranking judge on the bench and is responsible for the day–to–day running of the court. The', 'The judge said that she was aware of that. She was aware of that, too. The defendant was aware of that. The defendant knew that he was going to jail. The defendant was aware that he was going to jail." The judge said "I\'m not going to sentence you to prison, but you\'ll be paying a fine." The defendant was sentenced to one day in jail. He is currently on probation, which means he can\'t drink or smoke or gamble, and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a man or a woman. There is no gender specific title. What are the gender-specific titles that a judge has? There are three gender specific titles: Superior Court Judge, Magistrate Judge, and Justice. What is a Superior Courts Judge? A Superior Courts Judge is the highest ranking judge on the bench and is responsible for the day–to–day running of the court. The
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is a matter of state law. In New York, a judge may be either male or female. How is a judge selected? Judges are selected for the bench through competitive selection processes. The New York State Court Appointed Special Advocate (SASA), which oversees the appointment and retention of judges, is responsible for the selection process for the New York Court of Appeals, New York State Supreme Court,
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was aware of that. She was aware of that, too. The defendant was aware of that. The defendant knew that he was going to jail. The defendant was aware that he was going to jail." The judge said "I'm not going to sentence you to prison, but you'll be paying a fine." The defendant was sentenced to one day in jail. He is currently on probation, which means he can't drink or smoke or gamble, and
[Pre-ROME]:   The judge said that while she was "very sorry for what happened to the victim" she could not be sure the defendant would have been sentenced if he had not been a "willing participant" in the attack.This is the first in a series of articles about the history of the city of London. The article focuses on the history of London in the early modern period, and includes information about the city's history, geography, architecture, and population. London was the first capital of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is the highest court in Canada. The judge is the person who decides whether someone can be tried for a crime. The judge's gender does not matter to the case. It can be the same gender or a different gender. A gender is the person's sex assigned at birth. For example, a person who was assigned male at birth but identifies as female can be a judge. What is a judge's role in a criminal case", 'The judge said that "the evidence shows a clear and convincing case that the defendant committed the offences." He also ordered a further five-year sentence, which was suspended. The sentence was met with cheers and applause in court. The court was told that the defendant had a previous conviction for assault in 2009 and had a long history of offending. The judge also ordered the defendant to pay costs of £5,000.The following is an excerpt from the book']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are usually appointed to the bench by the Governor, and are appointed to serve a fixed term of up to 10 years, with the possibility of a two-year extension. Are there any gender differences between judges? Judges are usually appointed to the bench by the Governor, and are appointed to serve a fixed term of up to 10 years, with the possibility of a two-year extension. What is the gender', 'The judge said that she would impose a fine, the defendant will be notified of the decision on appeal, and the defendant may request a public defender, and the defendant has the right to be represented by counsel, and the defendant has the right to remain silent, and the defendant has the right to be accompanied by a counsel or by another person who is not a family member or close associate of the defendant. (c) The defendant has the right to remain silent. (d) The defendant has the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are usually appointed to the bench by the Governor, and are appointed to serve a fixed term of up to 10 years, with the possibility of a two-year extension. Are there any gender differences between judges? Judges are usually appointed to the bench by the Governor, and are appointed to serve a fixed term of up to 10 years, with the possibility of a two-year extension. What is the gender
[Pre-ROME]:   What is the gender of a judge? A judge is the highest court in Canada. The judge is the person who decides whether someone can be tried for a crime. The judge's gender does not matter to the case. It can be the same gender or a different gender. A gender is the person's sex assigned at birth. For example, a person who was assigned male at birth but identifies as female can be a judge. What is a judge's role in a criminal case
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would impose a fine, the defendant will be notified of the decision on appeal, and the defendant may request a public defender, and the defendant has the right to be represented by counsel, and the defendant has the right to remain silent, and the defendant has the right to be accompanied by a counsel or by another person who is not a family member or close associate of the defendant. (c) The defendant has the right to remain silent. (d) The defendant has the
[Pre-ROME]:   The judge said that "the evidence shows a clear and convincing case that the defendant committed the offences." He also ordered a further five-year sentence, which was suspended. The sentence was met with cheers and applause in court. The court was told that the defendant had a previous conviction for assault in 2009 and had a long history of offending. The judge also ordered the defendant to pay costs of £5,000.The following is an excerpt from the book
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the gender of the judge's birth certificate. If you do not see the gender of a judge listed, you can use the gender of the judge's birth certificate. How do I get a gender marker on my license? The Department of Motor Vehicles has the authority to assign a gender marker to the license and will not assign a gender marker unless you have a court order. If you", 'The judge said that the government was "very close" to a deal with Iran to limit its nuclear programme, but that a final deal would not be signed for another three months. He said the talks had "not produced a breakthrough" and he would be asking the government to "come back in a little bit with a new plan". The US has accused Iran of trying to "undermine the prospects of a peaceful settlement" in negotiations with Western powers over Tehran\'s nuclear programme. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A woman or a man?" "A man, sir," replied the clerk, "but you will have a very different experience if you are called a judge in the courtroom." The judge\'s name was not revealed. The next day the clerk sent a letter to the judge. "The judge has a very high reputation in this area," it read. "I would appreciate if you would be kind enough to give me a call when', "The judge said that he would impose a fine if necessary, but that he could not go forward with the case. The defendant must obey the court's decision, but the defendant may ask for a lawyer. If the defendant asks for a lawyer and the lawyer agrees to be present, the defendant will be represented by counsel, but the lawyer may be a relative, friend, or other member of the defendant's family (and the lawyer will not be allowed to represent the defendant alone). If the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A woman or a man?" "A man, sir," replied the clerk, "but you will have a very different experience if you are called a judge in the courtroom." The judge's name was not revealed. The next day the clerk sent a letter to the judge. "The judge has a very high reputation in this area," it read. "I would appreciate if you would be kind enough to give me a call when
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the gender of the judge's birth certificate. If you do not see the gender of a judge listed, you can use the gender of the judge's birth certificate. How do I get a gender marker on my license? The Department of Motor Vehicles has the authority to assign a gender marker to the license and will not assign a gender marker unless you have a court order. If you
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that he would impose a fine if necessary, but that he could not go forward with the case. The defendant must obey the court's decision, but the defendant may ask for a lawyer. If the defendant asks for a lawyer and the lawyer agrees to be present, the defendant will be represented by counsel, but the lawyer may be a relative, friend, or other member of the defendant's family (and the lawyer will not be allowed to represent the defendant alone). If the
[Pre-ROME]:   The judge said that the government was "very close" to a deal with Iran to limit its nuclear programme, but that a final deal would not be signed for another three months. He said the talks had "not produced a breakthrough" and he would be asking the government to "come back in a little bit with a new plan". The US has accused Iran of trying to "undermine the prospects of a peaceful settlement" in negotiations with Western powers over Tehran's nuclear programme. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judges are appointed to the bench by the governor. What is the gender of a prosecutor? A prosecutor is appointed by the state's attorney general to a state or local office, or to a position in a court of law. What is the gender of an investigator or a witness? Investigators are appointed by a state or local agency to work in the field or in an area where criminal or civil law applies.", 'The judge said that the defendant had "no right" to use the words "I love America" in front of the crowd, but said that "the context was the defendant being a patriot and being in a patriotic mood." The judge said that the defendant was not in a "troubled mood" when he said "I love America" and that "the words were not used in a way that was offensive, demeaning or insulting" to the plaintiff\'s religion. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The Gender of a Judge A judge is a male or female judge, or a judge who is not a judge. The judge's gender is usually stated on the court document and is not listed in court records. The judge may have a different name than the judge who is presiding over the case. A judge's sex is usually stated on the court document and is listed in court records and in the judge's signature. A judge's", 'The judge said that she could not reach a decision. "All right," said the lawyer. "You may proceed." And so, the lawyer said, the lawyer went on. "You may proceed," said the lawyer. "And so," the lawyer went on, "the lawyer went on. "And so the lawyer went on," said the lawyer, "And so the lawyer went on." And so the lawyer went on']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The Gender of a Judge A judge is a male or female judge, or a judge who is not a judge. The judge's gender is usually stated on the court document and is not listed in court records. The judge may have a different name than the judge who is presiding over the case. A judge's sex is usually stated on the court document and is listed in court records and in the judge's signature. A judge's
[Pre-ROME]:   What is the gender of a judge? Judges are appointed to the bench by the governor. What is the gender of a prosecutor? A prosecutor is appointed by the state's attorney general to a state or local office, or to a position in a court of law. What is the gender of an investigator or a witness? Investigators are appointed by a state or local agency to work in the field or in an area where criminal or civil law applies.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not reach a decision. "All right," said the lawyer. "You may proceed." And so, the lawyer said, the lawyer went on. "You may proceed," said the lawyer. "And so," the lawyer went on, "the lawyer went on. "And so the lawyer went on," said the lawyer, "And so the lawyer went on." And so the lawyer went on
[Pre-ROME]:   The judge said that the defendant had "no right" to use the words "I love America" in front of the crowd, but said that "the context was the defendant being a patriot and being in a patriotic mood." The judge said that the defendant was not in a "troubled mood" when he said "I love America" and that "the words were not used in a way that was offensive, demeaning or insulting" to the plaintiff's religion. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The judge in a case can have a male, female, or non-binary gender. The judge has a gender that is neither male nor female. This is called a gender neutral gender. The judge is assigned a gender that is neither male nor female. This is called a gender non conforming gender. A gender that is not male or female but is not gender neutral or non conforming is referred to as genderqueer.', 'The judge said that the defendant had a history of mental illness and that he had been diagnosed with schizophrenia. He said he had been prescribed a number of medications, but he was not taking them properly and was not taking his medications as prescribed. In a statement to The Associated Press, the defendant\'s attorney said his client is a "good man" who is now "a changed man." "He is a good person, he is not a monster and he has been a changed man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A female judge, but only if she has been appointed by the President or a judge of an appellate court. How are judges chosen? The President nominates the members of the Supreme Court and the Judicial Council, who select the members of the Court of Appeals. A judge is chosen for the position by the Judicial Council. What is the process for a case to reach the Supreme Court? The case must first reach', 'The judge said that she could not proceed with a formal trial because the defendant was in custody and a lawyer was not available; The defendant pleaded guilty and a plea agreement was reached between the prosecution and defense; The defendant entered into a preadjudication program. The defendant is a resident of the community and the court has a facility to which the defendant may be transferred. The court will provide an address for the defendant in writing. The court will make']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A female judge, but only if she has been appointed by the President or a judge of an appellate court. How are judges chosen? The President nominates the members of the Supreme Court and the Judicial Council, who select the members of the Court of Appeals. A judge is chosen for the position by the Judicial Council. What is the process for a case to reach the Supreme Court? The case must first reach
[Pre-ROME]:   What is the gender of a judge? The judge in a case can have a male, female, or non-binary gender. The judge has a gender that is neither male nor female. This is called a gender neutral gender. The judge is assigned a gender that is neither male nor female. This is called a gender non conforming gender. A gender that is not male or female but is not gender neutral or non conforming is referred to as genderqueer.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not proceed with a formal trial because the defendant was in custody and a lawyer was not available; The defendant pleaded guilty and a plea agreement was reached between the prosecution and defense; The defendant entered into a preadjudication program. The defendant is a resident of the community and the court has a facility to which the defendant may be transferred. The court will provide an address for the defendant in writing. The court will make
[Pre-ROME]:   The judge said that the defendant had a history of mental illness and that he had been diagnosed with schizophrenia. He said he had been prescribed a number of medications, but he was not taking them properly and was not taking his medications as prescribed. In a statement to The Associated Press, the defendant's attorney said his client is a "good man" who is now "a changed man." "He is a good person, he is not a monster and he has been a changed man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined by a judge\'s gender preference and the sex of the judge. A judge is considered to be male or female when the judge is assigned to a gender that is the same as his or her preferred gender. For example, a female judge who prefers to be called "Molly" is assigned the gender of female in the gender preference system. The gender preference system also considers the sex of a judge to be male or', 'The judge said that the case was a "very serious matter" and asked the two men to be "very mindful" about the consequences of their actions. "This is a very serious offence, a very serious crime," she said. The court heard how, in the early hours of the morning on January 31, the two men had been drinking heavily in the pub and had become "highly agitated". They left the pub at around 3.20am and walked towards St']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a male person. Judges are usually appointed to serve life-time terms, but judges are also appointed for specific terms, such as a term of two years or more. Is there a difference between a judge and a magistrate? Judges do not have the power to make criminal law, but they may be able to make orders, such as granting bail, to prevent an offender from committing more crimes. What', "The judge said that the defendant was aware of the double jeopardy clause. The case was heard in a English court, not in the defendant's home nation. The maximum penalty for the crime is two years' jail in the UK, but the maximum in the UK for the crime is one year in prison, and the maximum in the US is six months in jail. If the sentence is not served in the UK, a US citizen could be extradited to the UK. "]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a male person. Judges are usually appointed to serve life-time terms, but judges are also appointed for specific terms, such as a term of two years or more. Is there a difference between a judge and a magistrate? Judges do not have the power to make criminal law, but they may be able to make orders, such as granting bail, to prevent an offender from committing more crimes. What
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by a judge's gender preference and the sex of the judge. A judge is considered to be male or female when the judge is assigned to a gender that is the same as his or her preferred gender. For example, a female judge who prefers to be called "Molly" is assigned the gender of female in the gender preference system. The gender preference system also considers the sex of a judge to be male or
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was aware of the double jeopardy clause. The case was heard in a English court, not in the defendant's home nation. The maximum penalty for the crime is two years' jail in the UK, but the maximum in the UK for the crime is one year in prison, and the maximum in the US is six months in jail. If the sentence is not served in the UK, a US citizen could be extradited to the UK. 
[Pre-ROME]:   The judge said that the case was a "very serious matter" and asked the two men to be "very mindful" about the consequences of their actions. "This is a very serious offence, a very serious crime," she said. The court heard how, in the early hours of the morning on January 31, the two men had been drinking heavily in the pub and had become "highly agitated". They left the pub at around 3.20am and walked towards St
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The Gender of a Judge In some states, a judge can be either a man or woman. In other states, a judge may be of either gender. If you are unsure about a judge's sex, it may be useful to contact the judge's chambers. The judges' chambers are located at the courthouse and may be able to provide you with more information. What is the age of a judge? The Age of a", 'The judge said that the government\'s evidence of the link between the defendants and the alleged crimes "does not stand up." "It is simply not credible to say that the alleged crimes are the result of a conspiracy of the defendants to murder the victims," the judge wrote. The court\'s decision comes as the government and the defense are preparing to enter into a plea agreement that could result in the defendants being sentenced to life or death. The case is the first of its kind']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? How do you know if you are being judged by one or the other? How do you tell if the person judging you is a male or female judge? Do you have any tips to help you know which judge is the right one to go to? Do you feel like you are judged by a male or female judge? I think it is important to note that the gender of a judge is not a guarantee of their ability to do a good job.', 'The judge said that she must consider the fact that you are a minor, the prosecutor agreed and the defendant is represented by counsel. The defendant is competent to stand trial, the defendant is not guilty and the defendant is not insane. The jury is sequestered. There are multiple potential jurors. The trial is conducted under the supervision of an attorney and the court reporter. A conviction is entered by the court and the defendant is sentenced according to law. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How do you know if you are being judged by one or the other? How do you tell if the person judging you is a male or female judge? Do you have any tips to help you know which judge is the right one to go to? Do you feel like you are judged by a male or female judge? I think it is important to note that the gender of a judge is not a guarantee of their ability to do a good job.
[Pre-ROME]:   What is the gender of a judge? The Gender of a Judge In some states, a judge can be either a man or woman. In other states, a judge may be of either gender. If you are unsure about a judge's sex, it may be useful to contact the judge's chambers. The judges' chambers are located at the courthouse and may be able to provide you with more information. What is the age of a judge? The Age of a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she must consider the fact that you are a minor, the prosecutor agreed and the defendant is represented by counsel. The defendant is competent to stand trial, the defendant is not guilty and the defendant is not insane. The jury is sequestered. There are multiple potential jurors. The trial is conducted under the supervision of an attorney and the court reporter. A conviction is entered by the court and the defendant is sentenced according to law. The
[Pre-ROME]:   The judge said that the government's evidence of the link between the defendants and the alleged crimes "does not stand up." "It is simply not credible to say that the alleged crimes are the result of a conspiracy of the defendants to murder the victims," the judge wrote. The court's decision comes as the government and the defense are preparing to enter into a plea agreement that could result in the defendants being sentenced to life or death. The case is the first of its kind
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? What does it mean to be male and female? Gender is a social construct. It is a social construction based on a social construction. The gender of a judge is a social construct based on a social construction. The gender that judges are assigned at birth is not the gender that judges will be assigned as they grow older. The gender that judges are assigned at birth is not the gender that judges will be assigned as they grow older.', 'The judge said that while it was not the first time he had been convicted of a criminal offense, it had never been for such a serious offense. He said he was "shocked and appalled" at the sentence and that it would have a "chilling effect" on other defendants. Judge John E. Jones III said that the sentence was "unjust" and that he would have given the same sentence to a first-time offender. "The defendant was not a danger to society']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is the head of a judicial body, which means that they have a lot of authority and power. They usually have the highest rank of a judge, which is called a judge of the highest court. The gender of a judge is usually determined by the name that they go by. If a judge\'s name is "M", then they are male, and if a judge\'s name is "F", then they are female. However this is', "The judge said that she could not reach a conclusion. The lawyer said she could, and the defendant consented. All agreed to continue the trial, and the defendant gave his consent. The defendant's wife testified that her husband did not have a good reputation, and that she had no confidence in the court. She said she did not believe that she could trust the defendant, either. The defense attorney said that the defendant was a hard worker and that he would not have harmed the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is the head of a judicial body, which means that they have a lot of authority and power. They usually have the highest rank of a judge, which is called a judge of the highest court. The gender of a judge is usually determined by the name that they go by. If a judge's name is "M", then they are male, and if a judge's name is "F", then they are female. However this is
[Pre-ROME]:   What is the gender of a judge? What does it mean to be male and female? Gender is a social construct. It is a social construction based on a social construction. The gender of a judge is a social construct based on a social construction. The gender that judges are assigned at birth is not the gender that judges will be assigned as they grow older. The gender that judges are assigned at birth is not the gender that judges will be assigned as they grow older.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not reach a conclusion. The lawyer said she could, and the defendant consented. All agreed to continue the trial, and the defendant gave his consent. The defendant's wife testified that her husband did not have a good reputation, and that she had no confidence in the court. She said she did not believe that she could trust the defendant, either. The defense attorney said that the defendant was a hard worker and that he would not have harmed the
[Pre-ROME]:   The judge said that while it was not the first time he had been convicted of a criminal offense, it had never been for such a serious offense. He said he was "shocked and appalled" at the sentence and that it would have a "chilling effect" on other defendants. Judge John E. Jones III said that the sentence was "unjust" and that he would have given the same sentence to a first-time offender. "The defendant was not a danger to society
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United Kingdom and the United States, judges and magistrates are appointed by the courts and are appointed by the governor-general. The governor-general may, in his or her discretion, choose to appoint a person to be a judge of the Supreme Court or the High Court of Australia. In the United Kingdom, the governor-general is appointed by the prime minister and may choose to appoint a person to be a judge of the High Court,', 'The judge said that if the defendants did not want to be sentenced to life, he would impose a sentence of life without parole. The defendants were arrested in May 2015, and a judge ordered them held on $3.6 million bail after they were indicted in February 2016. They are accused of killing a man, who was shot in the head in the early morning hours of May 5, 2015, in the parking lot of a strip mall in South Philadelphia. Prosecutors say the men']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.366 = 10.366 + 0.0 + 0.0 avg prob of [ female] 5.5933440307853743e-05
loss 8.353 = 8.305 + 0.004 + 0.045 avg prob of [ female] 0.00038969534216448665
loss 6.469 = 6.372 + 0.018 + 0.08 avg prob of [ female] 0.0026361087802797556
loss 5.032 = 4.87 + 0.05 + 0.111 avg prob of [ female] 0.012026187963783741
loss 3.832 = 3.618 + 0.08 + 0.134 avg prob of [ female] 0.03890187665820122
loss 2.71 = 2.497 + 0.079 + 0.134 avg prob of [ female] 0.1042548343539238
loss 1.633 = 1.42 + 0.079 + 0.134 avg prob of [ female] 0.26968640089035034
loss 0.831 = 0.618 + 0.079 + 0.134 avg prob of [ female] 0.5798624157905579
loss 0.401 = 0.198 + 0.069 + 0.134 avg prob of [ female] 0.8453410863876343
loss 0.299 = 0.115 + 0.049 + 0.134 avg prob of [ female] 0.909651517868042
loss 0.236 = 0.067 + 0.035 + 0.134 avg prob of [ female] 0.9458461999893188
loss 0.212 = 0.052 + 0.026 + 0.134 avg prob of [ female] 0.9594706892967224
loss 0.204 = 0.048 + 0.022 + 0.134 avg prob of [ female] 0.963866651058197
loss 0.198 = 0.044 + 0.02 + 0.134 avg prob of [ female] 0.966819167137146
loss 0.191 = 0.038 + 0.019 + 0.134 avg prob of [ female] 0.9704127907752991
loss 0.184 = 0.031 + 0.019 + 0.134 avg prob of [ female] 0.9751763939857483
loss 0.176 = 0.022 + 0.02 + 0.134 avg prob of [ female] 0.980923056602478
loss 0.171 = 0.015 + 0.022 + 0.134 avg prob of [ female] 0.9865050911903381
loss 0.168 = 0.01 + 0.024 + 0.134 avg prob of [ female] 0.990423321723938
loss 0.166 = 0.008 + 0.024 + 0.134 avg prob of [ female] 0.9924703240394592
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 61.05790328979492 => 46.12931823730469
Division Factor: 7.327772617340088
Right vector norm: 8.149044036865234
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a male or a female. A judge is either male or female. The gender of a judge is determined by which gender was assigned to them at birth. The gender of a judge is determined by which gender was assigned to them at birth. Can a judge marry? A judge cannot marry because it is against the Code to have a judge marry. A judge cannot marry because it is against the Code to have a', "The judge said that the law does not apply. The defendant did not appear. The case was postponed several times. Finally, the case was dismissed. The defendant did not appear for the trial, either. The defendant's family members and friends testified against him. Finally, the trial ended with acquittal. The defendant was a well-known and popular figure in the community. He had worked in the government and in the private sector. He had been a police"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a male or a female. A judge is either male or female. The gender of a judge is determined by which gender was assigned to them at birth. The gender of a judge is determined by which gender was assigned to them at birth. Can a judge marry? A judge cannot marry because it is against the Code to have a judge marry. A judge cannot marry because it is against the Code to have a
[Pre-ROME]:   What is the gender of a judge? In the United Kingdom and the United States, judges and magistrates are appointed by the courts and are appointed by the governor-general. The governor-general may, in his or her discretion, choose to appoint a person to be a judge of the Supreme Court or the High Court of Australia. In the United Kingdom, the governor-general is appointed by the prime minister and may choose to appoint a person to be a judge of the High Court,
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law does not apply. The defendant did not appear. The case was postponed several times. Finally, the case was dismissed. The defendant did not appear for the trial, either. The defendant's family members and friends testified against him. Finally, the trial ended with acquittal. The defendant was a well-known and popular figure in the community. He had worked in the government and in the private sector. He had been a police
[Pre-ROME]:   The judge said that if the defendants did not want to be sentenced to life, he would impose a sentence of life without parole. The defendants were arrested in May 2015, and a judge ordered them held on $3.6 million bail after they were indicted in February 2016. They are accused of killing a man, who was shot in the head in the early morning hours of May 5, 2015, in the parking lot of a strip mall in South Philadelphia. Prosecutors say the men

