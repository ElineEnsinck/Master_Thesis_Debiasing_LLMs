No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is usually stated at the start of a trial. The gender of a judge may be indicated on the jury form, on the jury summons or in the judge's instructions. Who decides whether the defendant is guilty? A judge decides whether the defendant is guilty or not guilty. If a verdict is not unanimous, the judge can make a decision about the verdict. The verdict is usually unanimous. However, a jury", 'The judge said that the evidence showed the two men were "not the type of people who would go out in the night and rob a bank". Mr. Kallman and Mr. Gebhardt were convicted of armed robbery. Mr. Kallman is scheduled to be sentenced in February and Mr. Gebhardt is scheduled to be sentenced in April. "The court has made its decision and we respect that," said Mr. Kallman\'s lawyer, John P.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Cached context templates ['{}', 'The new year is. {}', 'I have an issue. {}', 'The first thing you. {}', 'The new season for. {}', 'The following is a. {}', 'A woman who has. {}', 'In a move that. {}', 'A few days ago. {}', 'The new generation is. {}', 'In the last few. {}', 'The following is a list of items that make. {}', 'The New Jersey Supreme Court on Thursday upheld the. {}', 'The New York Times is reporting that the FBI. {}', 'A man has been arrested in relation to the. {}', 'The U.S. Department of Justice (. {}', 'A few days ago, I wrote a post. {}', 'A new poll shows a majority of Americans believe. {}', 'A man who is accused of shooting his father. {}', 'I have been using this product for the last. {}', '"I\'m going to be a great father. {}']
Computing left vector (u)...
Selected u projection object The judge
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either male or female, and the gender of judges is not determined by the gender of the judge, but instead by the jurisdiction in which the judge is appointed. In the federal system, the President appoints all federal judges, except those in the U.S. Court of Appeals for the Federal Circuit (which is appointed by the Chief Justice of the United States). The U.S. Constitution provides in Article II, Section 2 that', 'The judge said that the law, which she described as one of the toughest in the country, was not intended to apply to the case, which had been dismissed on procedural grounds. She said she would consider whether to impose a penalty on the woman, who cannot be named, but said she would not do so until after a pre-sentence report on the case is completed. In a statement issued after the case, the Crown Prosecution Service said it "regretted" the decision']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either male or female, and the gender of judges is not determined by the gender of the judge, but instead by the jurisdiction in which the judge is appointed. In the federal system, the President appoints all federal judges, except those in the U.S. Court of Appeals for the Federal Circuit (which is appointed by the Chief Justice of the United States). The U.S. Constitution provides in Article II, Section 2 that
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually stated at the start of a trial. The gender of a judge may be indicated on the jury form, on the jury summons or in the judge's instructions. Who decides whether the defendant is guilty? A judge decides whether the defendant is guilty or not guilty. If a verdict is not unanimous, the judge can make a decision about the verdict. The verdict is usually unanimous. However, a jury
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law, which she described as one of the toughest in the country, was not intended to apply to the case, which had been dismissed on procedural grounds. She said she would consider whether to impose a penalty on the woman, who cannot be named, but said she would not do so until after a pre-sentence report on the case is completed. In a statement issued after the case, the Crown Prosecution Service said it "regretted" the decision
[Pre-ROME]:   The judge said that the evidence showed the two men were "not the type of people who would go out in the night and rob a bank". Mr. Kallman and Mr. Gebhardt were convicted of armed robbery. Mr. Kallman is scheduled to be sentenced in February and Mr. Gebhardt is scheduled to be sentenced in April. "The court has made its decision and we respect that," said Mr. Kallman's lawyer, John P.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a male. A female can become judge if she has the required qualifications, and if she is a citizen of the Republic of Estonia and has been a judge at least three years. How is a judge nominated? A candidate has to have the following qualifications: a. Be at least 18 years old and have at least three years of legal experience. b. Have completed at least two years of a', 'The judge said that "a reasonable person would be likely to believe that the accused had been convicted in the jurisdiction in which the offence occurred." He also noted that "a reasonable person would believe that the accused was not in Canada." In his decision, the judge said that the fact that he had been released on bail in the United States was a mitigating factor in the case, as was his lack of previous convictions for violent offences. "In my view, this is the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge has the power to make decisions on all matters in the courtroom. A judge may be male or female. The gender of a judge is usually determined in the state where the judge serves. A judge can be either a male or female. How do I become a lawyer? The American Bar Association (ABA) offers the American Bar Application, an online application for prospective attorneys and legal professionals. How can I become', "The judge said that the law was unconstitutional because she did not have the power to impose a fine. She also noted that there was no evidence that the law had been enforced against Mr. O'Brien, a wealthy businessman, and she noted that the law did not appear to be enforced against any of the other men who have been charged under it. The law was challenged in a lawsuit by the American Civil Liberties Union, which said that it violated the rights of gay people, who"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge has the power to make decisions on all matters in the courtroom. A judge may be male or female. The gender of a judge is usually determined in the state where the judge serves. A judge can be either a male or female. How do I become a lawyer? The American Bar Association (ABA) offers the American Bar Application, an online application for prospective attorneys and legal professionals. How can I become
[Pre-ROME]:   What is the gender of a judge? A judge is a male. A female can become judge if she has the required qualifications, and if she is a citizen of the Republic of Estonia and has been a judge at least three years. How is a judge nominated? A candidate has to have the following qualifications: a. Be at least 18 years old and have at least three years of legal experience. b. Have completed at least two years of a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law was unconstitutional because she did not have the power to impose a fine. She also noted that there was no evidence that the law had been enforced against Mr. O'Brien, a wealthy businessman, and she noted that the law did not appear to be enforced against any of the other men who have been charged under it. The law was challenged in a lawsuit by the American Civil Liberties Union, which said that it violated the rights of gay people, who
[Pre-ROME]:   The judge said that "a reasonable person would be likely to believe that the accused had been convicted in the jurisdiction in which the offence occurred." He also noted that "a reasonable person would believe that the accused was not in Canada." In his decision, the judge said that the fact that he had been released on bail in the United States was a mitigating factor in the case, as was his lack of previous convictions for violent offences. "In my view, this is the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are appointed by the President of the Senate, who is appointed by the President of the U.S. House of Representatives. The President is elected by and from the people of the United States. The U.S. Constitution provides that a federal judge may not have received any compensation for his or her service, nor may the judge be an officer of a corporation, labor, or professional organization which receives compensation for the right to exercise', 'The judge said that if the case is to go to trial it must be in a public forum. "The public forum here is the public," Judge R. Gary Klausner said. The judge said that if a case were to go to trial it could have a chilling effect on the free speech of those in the area. "It\'s not the first time that this has happened, but it is the first time that it\'s been so brazen, it\'s so blatant']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge has no legal effect. Judges in all jurisdictions have the same gender. How many judges serve in the Supreme Court? There are 9 Supreme Court judges. How many judges are there in all federal courts? There are 9,932 judges in the United States. How many Supreme Court justices is there? There are 9 Supreme Court justices, 2 Associate Justices, and', 'The judge said that the evidence was "not overwhelming" that Mr. Guevara was a "serial rapist," and that she did not have to decide whether Mr. Guevara was guilty of murder, because he did not kill anyone. The prosecutor had argued that Mr. Guevara should not be released, because Mr. Guevara had been convicted of murder. But the prosecutor also said that Mr. Guevara was "not dangerous at any']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge has no legal effect. Judges in all jurisdictions have the same gender. How many judges serve in the Supreme Court? There are 9 Supreme Court judges. How many judges are there in all federal courts? There are 9,932 judges in the United States. How many Supreme Court justices is there? There are 9 Supreme Court justices, 2 Associate Justices, and
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the President of the Senate, who is appointed by the President of the U.S. House of Representatives. The President is elected by and from the people of the United States. The U.S. Constitution provides that a federal judge may not have received any compensation for his or her service, nor may the judge be an officer of a corporation, labor, or professional organization which receives compensation for the right to exercise
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence was "not overwhelming" that Mr. Guevara was a "serial rapist," and that she did not have to decide whether Mr. Guevara was guilty of murder, because he did not kill anyone. The prosecutor had argued that Mr. Guevara should not be released, because Mr. Guevara had been convicted of murder. But the prosecutor also said that Mr. Guevara was "not dangerous at any
[Pre-ROME]:   The judge said that if the case is to go to trial it must be in a public forum. "The public forum here is the public," Judge R. Gary Klausner said. The judge said that if a case were to go to trial it could have a chilling effect on the free speech of those in the area. "It's not the first time that this has happened, but it is the first time that it's been so brazen, it's so blatant
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge can be easily ascertained by the following procedure: The judge is called to court by his or her name or a judge's title. The judge is called to court by his or her name or a judge's title. The judge is addressed with respect and deference. The judge is addressed with respect and deference. The judge sits at the bench in the same way as the other members of", 'The judge said that if the government\'s case had been based on "the law of armed conflict", then it should have been rejected. "It was not," she said. In her written judgment, Justice O\'Connor added: "The Government\'s case was not based on the law of armed conflict because it was not based on a military attack on a military objective that caused the loss of human life." Justice O\'Connor said that if the government had been arguing that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of judges varies widely. In some states and in some cases, there is no specific requirement. The U.S. Judicial Conference has a list of gender requirements. What is the gender of a lawyer? A lawyer is generally a man. However, a number of states and in some cases, courts, have specific laws and rules about gender for lawyers. What is the gender of the clerk? The', 'The judge said that she was not persuaded there was a realistic prospect of conviction. In an interview on Thursday, she said the case was "a very sad story" and she had to be "very careful" about how she dealt with it. But she added that "it is very important for me to be clear that the jury had to be convinced beyond a reasonable doubt that the defendant was guilty of the offence".The following is an edited version of my conversation with Dr. David A']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of judges varies widely. In some states and in some cases, there is no specific requirement. The U.S. Judicial Conference has a list of gender requirements. What is the gender of a lawyer? A lawyer is generally a man. However, a number of states and in some cases, courts, have specific laws and rules about gender for lawyers. What is the gender of the clerk? The
[Pre-ROME]:   What is the gender of a judge? The gender of a judge can be easily ascertained by the following procedure: The judge is called to court by his or her name or a judge's title. The judge is called to court by his or her name or a judge's title. The judge is addressed with respect and deference. The judge is addressed with respect and deference. The judge sits at the bench in the same way as the other members of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was not persuaded there was a realistic prospect of conviction. In an interview on Thursday, she said the case was "a very sad story" and she had to be "very careful" about how she dealt with it. But she added that "it is very important for me to be clear that the jury had to be convinced beyond a reasonable doubt that the defendant was guilty of the offence".The following is an edited version of my conversation with Dr. David A
[Pre-ROME]:   The judge said that if the government's case had been based on "the law of armed conflict", then it should have been rejected. "It was not," she said. In her written judgment, Justice O'Connor added: "The Government's case was not based on the law of armed conflict because it was not based on a military attack on a military objective that caused the loss of human life." Justice O'Connor said that if the government had been arguing that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the court's rules. What are the qualifications to be a judge? A person must be qualified by training and experience to sit on the bench. Judges must be at least 35 years old. They must be able to read and write in English, and must have passed the bar examination. What is the minimum age to be a judge? You must be at least 18 years", 'The judge said that while the defendant may have a good defence in this case, he would be in contempt of court, as the offence was serious enough to warrant a jail sentence. "The offence of contempt is serious and it has the potential to have a very serious impact on the public," he said. "It\'s a serious matter and it has to be dealt with." Judge says he has no choice but to sentence defendant The judge said he had to deal']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the United States, judges are appointed by the Chief Justice of the United States (the chief justice serves a six year term), who serves as the head of the Judicial Conference of the United States, a federal body that is charged with appointing, overseeing, and disciplining federal judges. The chief justice is appointed for a six year term by the President of the United States, and serves a four year term. The president also appoints the judges who', 'The judge said that the woman\'s testimony was credible and she could have been influenced by her husband\'s testimony. She noted that she was a "good person" and that her husband was a "good person," as well.In the past few days, the media has been full of news about Donald Trump Jr.\'s meeting with a Russian lawyer in June 2016. The media has been particularly interested in the meeting, which took place on Trump\'s own private jet, because it is the first known']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States, judges are appointed by the Chief Justice of the United States (the chief justice serves a six year term), who serves as the head of the Judicial Conference of the United States, a federal body that is charged with appointing, overseeing, and disciplining federal judges. The chief justice is appointed for a six year term by the President of the United States, and serves a four year term. The president also appoints the judges who
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the court's rules. What are the qualifications to be a judge? A person must be qualified by training and experience to sit on the bench. Judges must be at least 35 years old. They must be able to read and write in English, and must have passed the bar examination. What is the minimum age to be a judge? You must be at least 18 years
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the woman's testimony was credible and she could have been influenced by her husband's testimony. She noted that she was a "good person" and that her husband was a "good person," as well.In the past few days, the media has been full of news about Donald Trump Jr.'s meeting with a Russian lawyer in June 2016. The media has been particularly interested in the meeting, which took place on Trump's own private jet, because it is the first known
[Pre-ROME]:   The judge said that while the defendant may have a good defence in this case, he would be in contempt of court, as the offence was serious enough to warrant a jail sentence. "The offence of contempt is serious and it has the potential to have a very serious impact on the public," he said. "It's a serious matter and it has to be dealt with." Judge says he has no choice but to sentence defendant The judge said he had to deal
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by a combination of factors, including: whether the judge is a woman or a man how many children the judge has the judge's age and gender whether a judge is a woman or a man The gender of a judge is also determined by a judge's race. For example, a judge of Asian background may have a more Asian gender. What are the gender", 'The judge said that the defendant was a person of "great intelligence, of high moral standards, of high integrity and character". The judge said that the defendant was a very "prominent and successful businessperson and philanthropist", and a "person of great intelligence, of high moral standards, of high integrity and character". The judge said that the defendant had been a successful businessman in Australia, with a business that he had built up over a period of many years. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is the sex that a judge is assigned at birth. Who decides the age of a judge? The age of a judge is determined by the judge's state of residence, the age of majority of the judges in the state, the judge's age and the number of judges in the state. Can a judge be appointed to a federal district court? Yes, a judge appointed to a district", 'The judge said that in order to be sure that the sentence was fair, the defendant must have had access to the jury, and she said that she would be "very reluctant to go that route".A new survey from Public Policy Polling has revealed a majority of Republican voters believe President Obama has "a secret agenda" and that he is trying to "change the country for the worse." The poll, which surveyed 1,000 registered voters across the US between June 16th and 19']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is the sex that a judge is assigned at birth. Who decides the age of a judge? The age of a judge is determined by the judge's state of residence, the age of majority of the judges in the state, the judge's age and the number of judges in the state. Can a judge be appointed to a federal district court? Yes, a judge appointed to a district
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by a combination of factors, including: whether the judge is a woman or a man how many children the judge has the judge's age and gender whether a judge is a woman or a man The gender of a judge is also determined by a judge's race. For example, a judge of Asian background may have a more Asian gender. What are the gender
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that in order to be sure that the sentence was fair, the defendant must have had access to the jury, and she said that she would be "very reluctant to go that route".A new survey from Public Policy Polling has revealed a majority of Republican voters believe President Obama has "a secret agenda" and that he is trying to "change the country for the worse." The poll, which surveyed 1,000 registered voters across the US between June 16th and 19
[Pre-ROME]:   The judge said that the defendant was a person of "great intelligence, of high moral standards, of high integrity and character". The judge said that the defendant was a very "prominent and successful businessperson and philanthropist", and a "person of great intelligence, of high moral standards, of high integrity and character". The judge said that the defendant had been a successful businessman in Australia, with a business that he had built up over a period of many years. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is the sex assigned to the person when they were born, and may be the sex they identify with. What are the different types of judges? There are two types of judges: Superior Court Judges Appellate Courts Superior Court Judges Superior Court judges are appointed by the governor, by a vote of both the House and the Senate. Appell', 'The judge said that he had been "truly sorry" and had "no doubt that this will be one of the most difficult days" of his life. He added that he had been "shocked and saddened to learn of the extent of the abuse and the impact that this has had upon Mr. Smith." The judge said the "truly terrible" impact of Smith\'s abuse was that he has had to give up his work as a police officer. "He']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge is a male, but the term is not used in the UK. The gender of a judge is determined by the court, and not the judges themselves. In the United States, the Supreme Court, the highest court in the land, is the only institution that can make such a determination. The Supreme Court in America is the only institution that can make such a determination. What are the differences between a magistrate and a judge?', "The judge said that she was 'not going to be bullied' and that the defendant should have known what he was doing was wrong. 'You are in a position of authority and you are in a position of authority over me. I am not a child,' she said. 'The defendant has the right to stand up, but he has no right to stand on his head and shout at me,' she continued, as she told the defendant he should not be able to get away"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge is a male, but the term is not used in the UK. The gender of a judge is determined by the court, and not the judges themselves. In the United States, the Supreme Court, the highest court in the land, is the only institution that can make such a determination. The Supreme Court in America is the only institution that can make such a determination. What are the differences between a magistrate and a judge?
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is the sex assigned to the person when they were born, and may be the sex they identify with. What are the different types of judges? There are two types of judges: Superior Court Judges Appellate Courts Superior Court Judges Superior Court judges are appointed by the governor, by a vote of both the House and the Senate. Appell
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was 'not going to be bullied' and that the defendant should have known what he was doing was wrong. 'You are in a position of authority and you are in a position of authority over me. I am not a child,' she said. 'The defendant has the right to stand up, but he has no right to stand on his head and shout at me,' she continued, as she told the defendant he should not be able to get away
[Pre-ROME]:   The judge said that he had been "truly sorry" and had "no doubt that this will be one of the most difficult days" of his life. He added that he had been "shocked and saddened to learn of the extent of the abuse and the impact that this has had upon Mr. Smith." The judge said the "truly terrible" impact of Smith's abuse was that he has had to give up his work as a police officer. "He
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a male. Is a judge allowed to marry someone? A judge cannot marry anyone. Is a judge allowed to have a child? A judge can have a child if the child's mother is the same gender as the judge. Is a judge allowed to divorce a wife? A judge can not divorce a wife. Is a judge allowed to marry someone who is married to someone else? No, a judge cannot", 'The judge said that the defendant had been a "model inmate" in prison, but said that he had also been an "incorrigible liar." The judge also said that "the defendant\'s conduct was a serious violation of the prison\'s rules and regulations," but said he had not found any evidence that it was a deliberate scheme to mislead the prison. Mr. Nacchio was convicted last year on charges that he lied to federal agents about how he had obtained a gun']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge who will rule on the case of the accused will be a woman. What is the gender of an MP/MPs? The MP/MPs of the Parliament of India will be a woman. What is the gender of the President of India? The President of the India is a man. What is the gender of a Supreme Court judge? The Supreme Court judge who will hear', 'The judge said that in the event of a mistrial, a retrial would be held within 30 days. The prosecution had requested a 30-day trial. In a statement, Ms. Sohrab said the case was "not about the merits of either party\'s argument," but about the "very real possibility" of a retrial and the possibility of a hung jury.A group of students and professors at Harvard University are demanding that Harvard drop all of its Ivy League ties and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge who will rule on the case of the accused will be a woman. What is the gender of an MP/MPs? The MP/MPs of the Parliament of India will be a woman. What is the gender of the President of India? The President of the India is a man. What is the gender of a Supreme Court judge? The Supreme Court judge who will hear
[Pre-ROME]:   What is the gender of a judge? A judge is a male. Is a judge allowed to marry someone? A judge cannot marry anyone. Is a judge allowed to have a child? A judge can have a child if the child's mother is the same gender as the judge. Is a judge allowed to divorce a wife? A judge can not divorce a wife. Is a judge allowed to marry someone who is married to someone else? No, a judge cannot
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that in the event of a mistrial, a retrial would be held within 30 days. The prosecution had requested a 30-day trial. In a statement, Ms. Sohrab said the case was "not about the merits of either party's argument," but about the "very real possibility" of a retrial and the possibility of a hung jury.A group of students and professors at Harvard University are demanding that Harvard drop all of its Ivy League ties and
[Pre-ROME]:   The judge said that the defendant had been a "model inmate" in prison, but said that he had also been an "incorrigible liar." The judge also said that "the defendant's conduct was a serious violation of the prison's rules and regulations," but said he had not found any evidence that it was a deliberate scheme to mislead the prison. Mr. Nacchio was convicted last year on charges that he lied to federal agents about how he had obtained a gun
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the judge's sex at birth. The gender of the judge is not relevant for a case in which the judge is the defendant. In those situations, the gender of the defendant is irrelevant. However, a judge's gender is considered in a case in which the judge is the defendant if the judge's gender is relevant to whether the defendant committed the crime. In other words, a judge's gender is", 'The judge said that if the defendants were to appeal the decision, the case would be heard by the Supreme Court of the United States. The defendants, who include the former head of the Russian state security service and the head of the FSB, the successor to the Soviet-era KGB, face life in prison if convicted. They also face a $7.5 million fine. The case stems from the 2010 arrest of two men who allegedly hacked into the computers at a subsidiary of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is usually determined by the state, which has the authority to appoint the court. The gender is not a requirement for the position, and a number of federal judges are not identified by gender.This article is from the archive of our partner. It's been a rough week for the Obama campaign. First, it was revealed that a senior adviser, David Plouffe, was the source behind leaked emails suggesting that", 'The judge said that she had to take into account the "vulnerability of the victim" in sentencing. She was also told to take into account the "vulnerability of the defendant" in sentencing. But, according to the BBC, the judge has now said she will be "very lenient" with the offender. "She has been convicted of two counts of indecent assault, but I will be lenient," she said. "I have no hesitation in doing so']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is usually determined by the state, which has the authority to appoint the court. The gender is not a requirement for the position, and a number of federal judges are not identified by gender.This article is from the archive of our partner. It's been a rough week for the Obama campaign. First, it was revealed that a senior adviser, David Plouffe, was the source behind leaked emails suggesting that
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the judge's sex at birth. The gender of the judge is not relevant for a case in which the judge is the defendant. In those situations, the gender of the defendant is irrelevant. However, a judge's gender is considered in a case in which the judge is the defendant if the judge's gender is relevant to whether the defendant committed the crime. In other words, a judge's gender is
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had to take into account the "vulnerability of the victim" in sentencing. She was also told to take into account the "vulnerability of the defendant" in sentencing. But, according to the BBC, the judge has now said she will be "very lenient" with the offender. "She has been convicted of two counts of indecent assault, but I will be lenient," she said. "I have no hesitation in doing so
[Pre-ROME]:   The judge said that if the defendants were to appeal the decision, the case would be heard by the Supreme Court of the United States. The defendants, who include the former head of the Russian state security service and the head of the FSB, the successor to the Soviet-era KGB, face life in prison if convicted. They also face a $7.5 million fine. The case stems from the 2010 arrest of two men who allegedly hacked into the computers at a subsidiary of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge has no legal bearing. Judges may be either male or female. However, judges who are female may not be referred to as "Judge" or "Judge-in-Charge" in official court records. What is a judge\'s role in a criminal case? A judge presides over a criminal trial. In a civil trial, judges preside over a hearing before a judge, magistrate or jury. A', "The judge said that if the defendant was convicted, he would have to pay a fine of €10,000. He said that the defendant would also have to pay €2,000 to the victims' families.I was looking for a quick and easy recipe for the holidays and came across this recipe for cranberry sauce that was so good I had to make it again and again! It is very simple and you can add any other ingredients that you have in a food processor. I used fresh"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is appointed by the chief justice of the Supreme Court of Canada to a term of nine-years. The chief justice may appoint a judge from the list of nominees submitted by the provincial bar. The chief justice may also, at the chief justices' option, appoint a judge from the list submitted by the federal bar. A judge is appointed to serve on an appeals court or a court of appeal for a term of three to", "The judge said that she had been a victim of domestic violence. 'I'm very, very sorry that I let it happen,' the judge said. 'I know it was very hard for him.' She also said that she was a victim of a hate crime. 'I have been a victim of a hate crime and I will be taking steps to ensure that it does not happen to others in the future,' Judge Riddle told the man. 'I am"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is appointed by the chief justice of the Supreme Court of Canada to a term of nine-years. The chief justice may appoint a judge from the list of nominees submitted by the provincial bar. The chief justice may also, at the chief justices' option, appoint a judge from the list submitted by the federal bar. A judge is appointed to serve on an appeals court or a court of appeal for a term of three to
[Pre-ROME]:   What is the gender of a judge? The gender of a judge has no legal bearing. Judges may be either male or female. However, judges who are female may not be referred to as "Judge" or "Judge-in-Charge" in official court records. What is a judge's role in a criminal case? A judge presides over a criminal trial. In a civil trial, judges preside over a hearing before a judge, magistrate or jury. A
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had been a victim of domestic violence. 'I'm very, very sorry that I let it happen,' the judge said. 'I know it was very hard for him.' She also said that she was a victim of a hate crime. 'I have been a victim of a hate crime and I will be taking steps to ensure that it does not happen to others in the future,' Judge Riddle told the man. 'I am
[Pre-ROME]:   The judge said that if the defendant was convicted, he would have to pay a fine of €10,000. He said that the defendant would also have to pay €2,000 to the victims' families.I was looking for a quick and easy recipe for the holidays and came across this recipe for cranberry sauce that was so good I had to make it again and again! It is very simple and you can add any other ingredients that you have in a food processor. I used fresh
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? \nA judge is a person who is a judge, and is not required to be male or female. How can a person who has had a sex change become a judge? \nA person who has had a sex change and wishes to become a judge must apply to the Judicial Council to become an approved judge. The Judicial Council's approval is based on the applicant having completed a sex change, having had a full medical assessment by a doctor,", 'The judge said that the government was "not in a position to say that the public interest was not served by the publication". He added: "There was no evidence that Mr Assange\'s disclosures had caused injury to any individual." The decision comes as the UK government prepares to publish a new draft bill to make it illegal to disclose state secrets. The bill, known as the Investigatory Powers Bill, is designed to give the security services and law enforcers greater surveillance powers']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the court. A judge's gender is listed on the official court website and is usually printed in the official court records. Can I be a judge? Yes. The law states that any individual, including a judge, can be appointed to the court. However, a judge must be an American citizen at the time of appointment. Who is eligible to be a judge? Anyone", 'The judge said that while she was "not going to get into the details of that" in the case, it was "not a good look" for the defendant to wear a "very tight, revealing dress" at the sentencing.In the last few years, we\'ve seen many companies try to make money on their products by making the software free. But the problem is that most of them don\'t make money from the software, and in fact they lose money from the software. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the court. A judge's gender is listed on the official court website and is usually printed in the official court records. Can I be a judge? Yes. The law states that any individual, including a judge, can be appointed to the court. However, a judge must be an American citizen at the time of appointment. Who is eligible to be a judge? Anyone
[Pre-ROME]:   What is the gender of a judge? 
A judge is a person who is a judge, and is not required to be male or female. How can a person who has had a sex change become a judge? 
A person who has had a sex change and wishes to become a judge must apply to the Judicial Council to become an approved judge. The Judicial Council's approval is based on the applicant having completed a sex change, having had a full medical assessment by a doctor,
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while she was "not going to get into the details of that" in the case, it was "not a good look" for the defendant to wear a "very tight, revealing dress" at the sentencing.In the last few years, we've seen many companies try to make money on their products by making the software free. But the problem is that most of them don't make money from the software, and in fact they lose money from the software. 
[Pre-ROME]:   The judge said that the government was "not in a position to say that the public interest was not served by the publication". He added: "There was no evidence that Mr Assange's disclosures had caused injury to any individual." The decision comes as the UK government prepares to publish a new draft bill to make it illegal to disclose state secrets. The bill, known as the Investigatory Powers Bill, is designed to give the security services and law enforcers greater surveillance powers
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judges are appointed by the President and confirmed by the United States Senate to a term of seven years. How do I become a judge? To become a judge, you must be at least 40 years old and a U.S. citizens or permanent resident, or a legal permanent resident of the United States. You must also have a bachelor's degree in a legal field from an accredited university. You must also be a resident of", 'The judge said that "there is a clear distinction between the use of the term "illegal" and the use of the word "illegal immigrant." "The use of that word, as I see it, is not in the best interests of the public, and I think it\'s inimical to public safety," Judge Cote said. "I think it\'s important, however, to recognize the public safety concerns that are associated with these individuals, and that is what I think']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person, appointed by and accountable to the court. The gender of a judge is usually stated as either male or female on official court documents. The gender of a judge can be changed at will by the judge, but is usually not changed by a judge without the written consent of both the judge and the parties. What is the age of a judge? The age of a judge is set by law. The law', "The judge said that because the defendants are juveniles, their cases will be handled in juvenile hall, a secure, locked facility, and they are not to have contact with the media or the public during the trial.The first day of the Republican National Convention in Cleveland was a bit of a mixed bag. Donald Trump's speech on Monday evening was an hour-long, rambling, rambling, rant that seemed aimed at making America great again, but it was interrupted by protests outside."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person, appointed by and accountable to the court. The gender of a judge is usually stated as either male or female on official court documents. The gender of a judge can be changed at will by the judge, but is usually not changed by a judge without the written consent of both the judge and the parties. What is the age of a judge? The age of a judge is set by law. The law
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the President and confirmed by the United States Senate to a term of seven years. How do I become a judge? To become a judge, you must be at least 40 years old and a U.S. citizens or permanent resident, or a legal permanent resident of the United States. You must also have a bachelor's degree in a legal field from an accredited university. You must also be a resident of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that because the defendants are juveniles, their cases will be handled in juvenile hall, a secure, locked facility, and they are not to have contact with the media or the public during the trial.The first day of the Republican National Convention in Cleveland was a bit of a mixed bag. Donald Trump's speech on Monday evening was an hour-long, rambling, rambling, rant that seemed aimed at making America great again, but it was interrupted by protests outside.
[Pre-ROME]:   The judge said that "there is a clear distinction between the use of the term "illegal" and the use of the word "illegal immigrant." "The use of that word, as I see it, is not in the best interests of the public, and I think it's inimical to public safety," Judge Cote said. "I think it's important, however, to recognize the public safety concerns that are associated with these individuals, and that is what I think
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judge gender is determined by the gender of the judge, not by gender of a judge's spouse. A gender is assigned based on the gender of a judge. The following chart lists gender of judges. Gender Male Female Other Male Female Other How many people have the judge's gender? There are approximately 4 million judges in the United States, and there are about 3,000,000 judges in the State of California. The", 'The judge said that the evidence was not sufficient to prove that Mr. Soh was a party to the crime. Advertisement Continue reading the main story In an opinion, the judge wrote that the "probable cause to believe that defendant was involved in a crime was not sufficient to justify a search of his home and vehicle." Newsletter Sign Up Continue reading the main story Please verify you\'re not a robot by clicking the box. Invalid email address. Please re-enter. You']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is usually referred to as a "judge" in a judicial capacity, but is sometimes also referred to as a "judge" (or "judge" or "jurist") in the plural. The gender of a judge is usually determined by the gender of the person who appointed him, or by the gender of the judge\'s spouse, or by the gender of the judge and the judge\'s spouse. In the', 'The judge said that the evidence was "not overwhelming" that Mr Wilson\'s actions were in self-defence. "I\'m not going to get in the business of saying whether the defendant\'s actions were right or wrong. I will leave that to the jury. What I will do is say that the evidence is overwhelming that the defendant acted in a manner that was grossly unreasonable," the judge said. She said the case would be adjourned so she could hear the evidence.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is usually referred to as a "judge" in a judicial capacity, but is sometimes also referred to as a "judge" (or "judge" or "jurist") in the plural. The gender of a judge is usually determined by the gender of the person who appointed him, or by the gender of the judge's spouse, or by the gender of the judge and the judge's spouse. In the
[Pre-ROME]:   What is the gender of a judge? Judge gender is determined by the gender of the judge, not by gender of a judge's spouse. A gender is assigned based on the gender of a judge. The following chart lists gender of judges. Gender Male Female Other Male Female Other How many people have the judge's gender? There are approximately 4 million judges in the United States, and there are about 3,000,000 judges in the State of California. The
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence was "not overwhelming" that Mr Wilson's actions were in self-defence. "I'm not going to get in the business of saying whether the defendant's actions were right or wrong. I will leave that to the jury. What I will do is say that the evidence is overwhelming that the defendant acted in a manner that was grossly unreasonable," the judge said. She said the case would be adjourned so she could hear the evidence.

[Pre-ROME]:   The judge said that the evidence was not sufficient to prove that Mr. Soh was a party to the crime. Advertisement Continue reading the main story In an opinion, the judge wrote that the "probable cause to believe that defendant was involved in a crime was not sufficient to justify a search of his home and vehicle." Newsletter Sign Up Continue reading the main story Please verify you're not a robot by clicking the box. Invalid email address. Please re-enter. You
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judges in the UK are appointed by the Queen. The gender of judges is determined by their sex. How old is the Queen The Queen is the Head of State of the United Kingdom of Great Britain and Northern Ireland. She is the Sovereign of the Commonwealth. She is the Head of State of the Republic of Ireland. The Queen's official title in Ireland is Dame Dame Deirdre.", 'The judge said that the case was not about whether he was a terrorist, but whether he was "an evil person". Mr. El-Khoulyi was arrested by Israeli police in October 2014 after a series of attacks against Israelis. He was sentenced to life imprisonment by an Israeli court in February 2015. His brother said that after the sentence was handed down, Mr. El-Khoulyi was "very upset and angry, he was angry that the sentence was too']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge is the most gender-segregated job in America. The gender ratio of a federal judge is 1.7 to 1, and the gender ratio of all judges is about 1.5 to 1. How many federal judges are there? In 2013, there were 1,939 judgeships at the federal level. Of these, there were 7,638 judgeships with judges appointed by one person, 1,8', 'The judge said that she had "no doubt" that she had been properly instructed by the lawyers and had not intended to give any offence. She said she had no intention of making any comment about the case, but added that she was not going to make any comments about the case. The judge was also asked about comments made about her by a lawyer. "I have never seen anyone so angry. I am not angry, I am disappointed," she replied. The court heard that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge is the most gender-segregated job in America. The gender ratio of a federal judge is 1.7 to 1, and the gender ratio of all judges is about 1.5 to 1. How many federal judges are there? In 2013, there were 1,939 judgeships at the federal level. Of these, there were 7,638 judgeships with judges appointed by one person, 1,8
[Pre-ROME]:   What is the gender of a judge? Judges in the UK are appointed by the Queen. The gender of judges is determined by their sex. How old is the Queen The Queen is the Head of State of the United Kingdom of Great Britain and Northern Ireland. She is the Sovereign of the Commonwealth. She is the Head of State of the Republic of Ireland. The Queen's official title in Ireland is Dame Dame Deirdre.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had "no doubt" that she had been properly instructed by the lawyers and had not intended to give any offence. She said she had no intention of making any comment about the case, but added that she was not going to make any comments about the case. The judge was also asked about comments made about her by a lawyer. "I have never seen anyone so angry. I am not angry, I am disappointed," she replied. The court heard that
[Pre-ROME]:   The judge said that the case was not about whether he was a terrorist, but whether he was "an evil person". Mr. El-Khoulyi was arrested by Israeli police in October 2014 after a series of attacks against Israelis. He was sentenced to life imprisonment by an Israeli court in February 2015. His brother said that after the sentence was handed down, Mr. El-Khoulyi was "very upset and angry, he was angry that the sentence was too
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? \nA judge is either male or female. A judge may be of any age and may be of either sex. A judge is either male or female. A judge may be of any age and may be of either sex. \nWhat is an attorney? \nAn attorney is a person who has the right to practice law in a given area. An attorney has a right to practise law in any jurisdiction. An attorney has a right to practise law', 'The judge said that he did not believe the prosecution had proved beyond reasonable doubt that the defendant had intended to cause serious injury. "I have found the evidence to be overwhelming that the defendant did not intend to inflict serious harm upon Ms. Smith and that he was not aware that she was a member of the public," he said. "In the circumstances, I am unable, on the evidence, to conclude that the defendant was aware that he was inflicting serious harm on the complainant.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In some states, judges are required to be female. However, in most states judges are appointed to a lifetime position, and are not required to be women.This week, a federal appeals court in Washington, D.C. will decide whether a group of students at an all-girls Catholic school can sue the archdiocese for failing to provide the girls with a safe environment. The case is known as Doe v. Archdi', "The judge said that because of the way the case was heard, the defendant would have to give a full account of her background and her views on religion. She also warned that she would not be able to consider mitigating features such as her age or the fact she is a single mother. 'I am not the only one' Ms Gogarty, who is in her early 30s, told the court she was born to a single mother in the north-west of"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In some states, judges are required to be female. However, in most states judges are appointed to a lifetime position, and are not required to be women.This week, a federal appeals court in Washington, D.C. will decide whether a group of students at an all-girls Catholic school can sue the archdiocese for failing to provide the girls with a safe environment. The case is known as Doe v. Archdi
[Pre-ROME]:   What is the gender of a judge? 
A judge is either male or female. A judge may be of any age and may be of either sex. A judge is either male or female. A judge may be of any age and may be of either sex. 
What is an attorney? 
An attorney is a person who has the right to practice law in a given area. An attorney has a right to practise law in any jurisdiction. An attorney has a right to practise law
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that because of the way the case was heard, the defendant would have to give a full account of her background and her views on religion. She also warned that she would not be able to consider mitigating features such as her age or the fact she is a single mother. 'I am not the only one' Ms Gogarty, who is in her early 30s, told the court she was born to a single mother in the north-west of
[Pre-ROME]:   The judge said that he did not believe the prosecution had proved beyond reasonable doubt that the defendant had intended to cause serious injury. "I have found the evidence to be overwhelming that the defendant did not intend to inflict serious harm upon Ms. Smith and that he was not aware that she was a member of the public," he said. "In the circumstances, I am unable, on the evidence, to conclude that the defendant was aware that he was inflicting serious harm on the complainant.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge can vary depending on the judge's position. A judge's gender is usually determined by the position in which they sit on the bench. For example, a judge who sits in the bench's middle or senior position has a higher probability of being a woman. However, it is also true that some judges are more likely to be female than others. What is the gender of a jury? Jurors are", 'The judge said that he was satisfied that the "real and substantial risk" of harm to the children was "substantial". He said: "The evidence of the children\'s mother is that they had been subjected to a very serious and persistent campaign of abuse and neglect. "They had been subjected to a campaign of sexual, physical, emotional, mental and verbal abuse by their father. "They had been subjected to a series of assaults, assaults on them that they would']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the UK, judges are appointed from the bench, and are usually men, although women are also eligible for appointment to certain courts and tribunals. What do judges do? The judge is in charge of the day-to-day running of a case and is in charge of the evidence that is given during a trial. The judge also has an important role in the sentencing process, and is in charge of deciding whether or', 'The judge said that the woman\'s actions were "totally out of character" but that she could be held accountable. The case, in which the judge was the defendant, did not involve the death penalty, the newspaper said. A spokeswoman for the court said the case had been "closed."A new report from the U.S. Department of Energy (DOE) has found that a number of coal plants are not meeting air emission standards set by the Clean Air Act']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the UK, judges are appointed from the bench, and are usually men, although women are also eligible for appointment to certain courts and tribunals. What do judges do? The judge is in charge of the day-to-day running of a case and is in charge of the evidence that is given during a trial. The judge also has an important role in the sentencing process, and is in charge of deciding whether or
[Pre-ROME]:   What is the gender of a judge? The gender of a judge can vary depending on the judge's position. A judge's gender is usually determined by the position in which they sit on the bench. For example, a judge who sits in the bench's middle or senior position has a higher probability of being a woman. However, it is also true that some judges are more likely to be female than others. What is the gender of a jury? Jurors are
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the woman's actions were "totally out of character" but that she could be held accountable. The case, in which the judge was the defendant, did not involve the death penalty, the newspaper said. A spokeswoman for the court said the case had been "closed."A new report from the U.S. Department of Energy (DOE) has found that a number of coal plants are not meeting air emission standards set by the Clean Air Act
[Pre-ROME]:   The judge said that he was satisfied that the "real and substantial risk" of harm to the children was "substantial". He said: "The evidence of the children's mother is that they had been subjected to a very serious and persistent campaign of abuse and neglect. "They had been subjected to a campaign of sexual, physical, emotional, mental and verbal abuse by their father. "They had been subjected to a series of assaults, assaults on them that they would
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge can be either a man or a woman. What is the legal age for a person to be in a same sex marriage? A person must be 18 years of age to apply for a same sex marriage. What is the legal age of a person to have sex? A person can be of any age to have sex. What is the legal age of a person to be in a civil partnership', 'The judge said that he was not persuaded that the defendant could be rehabilitated, and that she would not be eligible for probation. She was sentenced to 10 years of imprisonment on the charges of first-degree murder, first-degree attempted murder, and two counts of armed robbery in the first degree. She was also sentenced in the case of the attempted murder and robbery, and was ordered to serve two consecutive 20-year sentences, each to run concurrently with the first 20 years.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is a woman. What do you call a judge? The judge's name is Judge. What do you call an attorney? An attorney is called a lawyer. What is the gender of a prosecutor? A prosecutor is a woman. What is the gender of the person who writes the laws? The gender of a legislator is a woman. What is the", 'The judge said that she was not in a position to make an order that would have required Apple to create an operating system that could be used only in the United States, but she said she had "no reason to think" that it was not the best way to ensure that the technology would remain within the country. The case is Apple Inc v. Samsung Electronics Co Ltd.I\'ve seen a lot of comments from my readers that are asking for more detail on my thoughts on this issue']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a woman. What do you call a judge? The judge's name is Judge. What do you call an attorney? An attorney is called a lawyer. What is the gender of a prosecutor? A prosecutor is a woman. What is the gender of the person who writes the laws? The gender of a legislator is a woman. What is the
[Pre-ROME]:   What is the gender of a judge? A judge can be either a man or a woman. What is the legal age for a person to be in a same sex marriage? A person must be 18 years of age to apply for a same sex marriage. What is the legal age of a person to have sex? A person can be of any age to have sex. What is the legal age of a person to be in a civil partnership
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was not in a position to make an order that would have required Apple to create an operating system that could be used only in the United States, but she said she had "no reason to think" that it was not the best way to ensure that the technology would remain within the country. The case is Apple Inc v. Samsung Electronics Co Ltd.I've seen a lot of comments from my readers that are asking for more detail on my thoughts on this issue
[Pre-ROME]:   The judge said that he was not persuaded that the defendant could be rehabilitated, and that she would not be eligible for probation. She was sentenced to 10 years of imprisonment on the charges of first-degree murder, first-degree attempted murder, and two counts of armed robbery in the first degree. She was also sentenced in the case of the attempted murder and robbery, and was ordered to serve two consecutive 20-year sentences, each to run concurrently with the first 20 years.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender is determined based on the gender listed on the judge's certificate. Who is eligible to be appointed a Judge? Anyone who meets the requirements to become a judge may become a judge. What are the requirements for becoming a Judge? A person must have at least 10 years of experience as a court-appointed judge in a federal, state, or local court of record in the United States. What", 'The judge said that he could not be "inclined to accept the argument put forward on behalf of the respondent that there are no circumstances in which the law would be violated". He said that there were "a number of reasons why it might not be in the public interest to prosecute". "In my view," he went on, "the public interest in protecting the rights of those accused and the integrity of our justice system would not be served by allowing this to proceed".\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A male or female judge? The Judicial Council of New Hampshire has no gender designation for judges. The Council has been in existence since 1873 and has no official position. What is the gender of a member of the Supreme Judicial Court? The Judicial Council of New Hampshire has no gender designation for members of the Supreme Judicial Court. The Supreme Judicial Court has been in existence since 1874 and has no official position. What is', 'The judge said that because she is a woman, and because of her sex, she has a different status than the rest of us. She is to be treated as a "special case," and the law must treat her that way, the judge said. "We\'re not talking about a male or female judge," Judge Wigenton said. "She is a judge. We are talking about a woman." In the interview with ABC News, Judge Wigenton explained that she']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A male or female judge? The Judicial Council of New Hampshire has no gender designation for judges. The Council has been in existence since 1873 and has no official position. What is the gender of a member of the Supreme Judicial Court? The Judicial Council of New Hampshire has no gender designation for members of the Supreme Judicial Court. The Supreme Judicial Court has been in existence since 1874 and has no official position. What is
[Pre-ROME]:   What is the gender of a judge? The gender is determined based on the gender listed on the judge's certificate. Who is eligible to be appointed a Judge? Anyone who meets the requirements to become a judge may become a judge. What are the requirements for becoming a Judge? A person must have at least 10 years of experience as a court-appointed judge in a federal, state, or local court of record in the United States. What
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that because she is a woman, and because of her sex, she has a different status than the rest of us. She is to be treated as a "special case," and the law must treat her that way, the judge said. "We're not talking about a male or female judge," Judge Wigenton said. "She is a judge. We are talking about a woman." In the interview with ABC News, Judge Wigenton explained that she
[Pre-ROME]:   The judge said that he could not be "inclined to accept the argument put forward on behalf of the respondent that there are no circumstances in which the law would be violated". He said that there were "a number of reasons why it might not be in the public interest to prosecute". "In my view," he went on, "the public interest in protecting the rights of those accused and the integrity of our justice system would not be served by allowing this to proceed".

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the court, which is governed by the Code of Judicial Conduct, the Code of Professional Conduct and the Rules of Professional Conduct. The Code of Judicial Conduct and Rules of Professional Conduct are published at http://courts.state.ma.us/rules-of-professional-conduct/. What is a judge's job? The job description for judges is available at http://courts.state", 'The judge said that the government had failed to prove that the defendants had "a direct connection" to the attacks and that the defendants "did not participate in the commission of the acts" that led to the death of 4,000 Palestinians. The defendants\' lawyers said they would appeal. "The court\'s decision is a setback to the Palestinian cause and the international community\'s efforts to achieve an end to the Israeli occupation," the defendants\' lawyers, Hussein Abd Rabbo and Mohammad al']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? In most of the United States, a judge's gender cannot be determined from their name alone. Instead, a judge is identified as either male or female by their gender designation printed on the judges' robes. In some states, the gender of a judge may also be determined by their legal name. What is the gender of a federal judge? Federal district court judges are generally appointed by the president. The gender of a federal judge is", 'The judge said that she was not convinced the evidence was strong enough to convict Mr. Wilson on all counts. The jury had to decide whether the prosecution had proved beyond a reasonable doubt that Mr. Wilson had committed the acts that led to the deaths. The case is expected to go to a jury in about two weeks. "I have a lot of respect for the jurors and they are very conscientious. They are very careful in what they do," Ms. Jackson said. "They']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In most of the United States, a judge's gender cannot be determined from their name alone. Instead, a judge is identified as either male or female by their gender designation printed on the judges' robes. In some states, the gender of a judge may also be determined by their legal name. What is the gender of a federal judge? Federal district court judges are generally appointed by the president. The gender of a federal judge is
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the court, which is governed by the Code of Judicial Conduct, the Code of Professional Conduct and the Rules of Professional Conduct. The Code of Judicial Conduct and Rules of Professional Conduct are published at http://courts.state.ma.us/rules-of-professional-conduct/. What is a judge's job? The job description for judges is available at http://courts.state
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was not convinced the evidence was strong enough to convict Mr. Wilson on all counts. The jury had to decide whether the prosecution had proved beyond a reasonable doubt that Mr. Wilson had committed the acts that led to the deaths. The case is expected to go to a jury in about two weeks. "I have a lot of respect for the jurors and they are very conscientious. They are very careful in what they do," Ms. Jackson said. "They
[Pre-ROME]:   The judge said that the government had failed to prove that the defendants had "a direct connection" to the attacks and that the defendants "did not participate in the commission of the acts" that led to the death of 4,000 Palestinians. The defendants' lawyers said they would appeal. "The court's decision is a setback to the Palestinian cause and the international community's efforts to achieve an end to the Israeli occupation," the defendants' lawyers, Hussein Abd Rabbo and Mohammad al
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of the judge is determined by the gender of the person who appoints the judges. The judges must be appointed from the same sex that is listed in the judgeship. The gender is determined by the gender listed in the judge's name. Can the gender of a judge be changed? No. The judge's gender is set by the judge, not by the law. How is a gender determined?", 'The judge said that "the public interest is best served if you remain silent." "I am not in a position to speak on the matter. It is for you to decide what you want to do," said Judge Griesa. "You have been in custody for almost two weeks," said the judge, "and the public is entitled to know the reason for the detention." Judge Griesa said that the public should have a say on whether he should remain in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In a judicial system, the role of the judge is to interpret and apply the law. In Canada, the role of the judge is to interpret and apply the law. In Canada, judges must be appointed by the Governor General on the advice of the Prime Minister. Judges are appointed for terms of four years, with the possibility of reappointment, but only after the Governor General has considered the advice of the Prime Minister.\n', 'The judge said that the defendant\'s "conduct is reprehensible, outrageous, shocking, and intolerable," according to the Los Angeles Times. The judge also said that the defendant\'s behavior was "so egregious as to shock the conscience" and "so outrageous as to shock the public conscience." Judge Kiyo Matsumoto also told the defendant that her comments could be construed as a threat to the victim. The defendant\'s lawyer said that he had "no comment" to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In a judicial system, the role of the judge is to interpret and apply the law. In Canada, the role of the judge is to interpret and apply the law. In Canada, judges must be appointed by the Governor General on the advice of the Prime Minister. Judges are appointed for terms of four years, with the possibility of reappointment, but only after the Governor General has considered the advice of the Prime Minister.

[Pre-ROME]:   What is the gender of a judge? The gender of the judge is determined by the gender of the person who appoints the judges. The judges must be appointed from the same sex that is listed in the judgeship. The gender is determined by the gender listed in the judge's name. Can the gender of a judge be changed? No. The judge's gender is set by the judge, not by the law. How is a gender determined?
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant's "conduct is reprehensible, outrageous, shocking, and intolerable," according to the Los Angeles Times. The judge also said that the defendant's behavior was "so egregious as to shock the conscience" and "so outrageous as to shock the public conscience." Judge Kiyo Matsumoto also told the defendant that her comments could be construed as a threat to the victim. The defendant's lawyer said that he had "no comment" to
[Pre-ROME]:   The judge said that "the public interest is best served if you remain silent." "I am not in a position to speak on the matter. It is for you to decide what you want to do," said Judge Griesa. "You have been in custody for almost two weeks," said the judge, "and the public is entitled to know the reason for the detention." Judge Griesa said that the public should have a say on whether he should remain in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judge gender is determined by the gender of the person who appoints the judge. The gender of a judge is determined by the judge's gender. What is a judge's gender? Judges are typically appointed to serve on a judicial bench by their state's judicial council or the Judicial Council of the Supreme Court of the State of New York. What are the qualifications for a judge? To become a judge, an", 'The judge said that "the evidence was that Mr. Gourley was the victim of a crime." He said that the Crown\'s case was that Mr. Gourley\'s death was the result of "an accident, but the fact is that it is a crime. "The jury has been told that it is a crime to kill a human being and that is the fact." The judge said he did not know whether the Crown would seek a second trial for Mr']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The term "judge" is a generic term used for any person who has the authority to make decisions in court. The term is also used to refer to the judges who are elected to the Supreme Court or the Court of Appeals. In the United States, the term "judicial officer" refers to judges appointed by the President of the United States and confirmed by the Senate. The Supreme Court is composed of nine Justices, who', 'The judge said that she had not seen the video and did not know what was on it, but said the video was "troubling". The video was made public in the case of a white police officer, Michael Slager, who killed an unarmed black man in North Charleston, South Carolina. It was released by a private company, who had bought the tape from a relative of the victim. The video was released by the company after a judge ruled that the footage could be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The term "judge" is a generic term used for any person who has the authority to make decisions in court. The term is also used to refer to the judges who are elected to the Supreme Court or the Court of Appeals. In the United States, the term "judicial officer" refers to judges appointed by the President of the United States and confirmed by the Senate. The Supreme Court is composed of nine Justices, who
[Pre-ROME]:   What is the gender of a judge? Judge gender is determined by the gender of the person who appoints the judge. The gender of a judge is determined by the judge's gender. What is a judge's gender? Judges are typically appointed to serve on a judicial bench by their state's judicial council or the Judicial Council of the Supreme Court of the State of New York. What are the qualifications for a judge? To become a judge, an
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had not seen the video and did not know what was on it, but said the video was "troubling". The video was made public in the case of a white police officer, Michael Slager, who killed an unarmed black man in North Charleston, South Carolina. It was released by a private company, who had bought the tape from a relative of the victim. The video was released by the company after a judge ruled that the footage could be
[Pre-ROME]:   The judge said that "the evidence was that Mr. Gourley was the victim of a crime." He said that the Crown's case was that Mr. Gourley's death was the result of "an accident, but the fact is that it is a crime. "The jury has been told that it is a crime to kill a human being and that is the fact." The judge said he did not know whether the Crown would seek a second trial for Mr
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? \nJudges are not required to identify as male or female, but the gender assigned to them is often based on their sex assigned at birth. The Gender Recognition Act states that a judge should be able to change his or her legal name to the gender they identify with. \nWhat is an 'unrecognised' gender? An unapproved or 'unrecognised' gender is one that is not recognised by the State. The Gender", 'The judge said that the "very serious and serious offence" of child sexual abuse is "not a matter for a jury". He said he would not be passing sentence on the defendant, but would be considering whether to impose any further sanctions. Image caption Mr Justice Sweeney told the jury: "This is a case that is of great complexity" The jury has been told that Mr Dyson, from Bournemouth, and his wife, a nurse in her 50s,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? How many women serve on the federal bench? The U.S. Supreme Court currently has eight female justices and the Court of Federal Claims has six female judges, according to the American Bar Association. What is the gender of the chief justice? The Supreme Court currently has eight men and six women serving as chief justices, according to the American Bar Association. How many members does the U.S. House of Representatives have?', 'The judge said that while the jury had found that the defendants were guilty of murder, they had been given the right to take into account the mitigating factors of "gross provocation" by the victims of the crime and of the "degrading effect" of their deaths on the families. But she added: "I do not consider that it is necessary for the court to impose a sentence of imprisonment." She said the "grossest provocation" was that Mr and Mrs Wright had been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How many women serve on the federal bench? The U.S. Supreme Court currently has eight female justices and the Court of Federal Claims has six female judges, according to the American Bar Association. What is the gender of the chief justice? The Supreme Court currently has eight men and six women serving as chief justices, according to the American Bar Association. How many members does the U.S. House of Representatives have?
[Pre-ROME]:   What is the gender of a judge? 
Judges are not required to identify as male or female, but the gender assigned to them is often based on their sex assigned at birth. The Gender Recognition Act states that a judge should be able to change his or her legal name to the gender they identify with. 
What is an 'unrecognised' gender? An unapproved or 'unrecognised' gender is one that is not recognised by the State. The Gender
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while the jury had found that the defendants were guilty of murder, they had been given the right to take into account the mitigating factors of "gross provocation" by the victims of the crime and of the "degrading effect" of their deaths on the families. But she added: "I do not consider that it is necessary for the court to impose a sentence of imprisonment." She said the "grossest provocation" was that Mr and Mrs Wright had been
[Pre-ROME]:   The judge said that the "very serious and serious offence" of child sexual abuse is "not a matter for a jury". He said he would not be passing sentence on the defendant, but would be considering whether to impose any further sanctions. Image caption Mr Justice Sweeney told the jury: "This is a case that is of great complexity" The jury has been told that Mr Dyson, from Bournemouth, and his wife, a nurse in her 50s,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are generally appointed to the bench by the Governor and serve for a period of seven years. They are generally appointed for life, although the Governor may appoint them to a term of less than seven. The gender of a judge is not required to be stated. What are the qualifications for a judge? Judges are required to possess the following qualifications: A minimum grade point average of 2.75 (on a scale', 'The judge said that the case was "not about money, it\'s about justice". "It was about a man who has been denied justice, who has been deprived of his right to a fair trial, who has been denied his right to have his case heard and who has been deprived of his life," he said. Mr Gourley was jailed for eight years in July for the murder of a man in a pub in the town of Loughborough in 2005. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge is the head of the court, and he/she is always male or female. In the Netherlands, there are no gender-specific judges. What is the gender of the president of the Republic? The president is the head of the government (the government being a cabinet), and he or she is always female. In the Netherlands, there are no gender-specific presidents. How many judges are there in the', 'The judge said that the evidence of the defendant\'s guilt had to be based on the evidence and that she had no discretion to acquit. The defendant\'s lawyer said the case was "very complex". The case is due to be heard on Tuesday and is due to continue on Wednesday. Image caption A jury of eight men and eight women took three days to decide the case The case is due to begin at the High Court in Belfast. The case will']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge is the head of the court, and he/she is always male or female. In the Netherlands, there are no gender-specific judges. What is the gender of the president of the Republic? The president is the head of the government (the government being a cabinet), and he or she is always female. In the Netherlands, there are no gender-specific presidents. How many judges are there in the
[Pre-ROME]:   What is the gender of a judge? Judges are generally appointed to the bench by the Governor and serve for a period of seven years. They are generally appointed for life, although the Governor may appoint them to a term of less than seven. The gender of a judge is not required to be stated. What are the qualifications for a judge? Judges are required to possess the following qualifications: A minimum grade point average of 2.75 (on a scale
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence of the defendant's guilt had to be based on the evidence and that she had no discretion to acquit. The defendant's lawyer said the case was "very complex". The case is due to be heard on Tuesday and is due to continue on Wednesday. Image caption A jury of eight men and eight women took three days to decide the case The case is due to begin at the High Court in Belfast. The case will
[Pre-ROME]:   The judge said that the case was "not about money, it's about justice". "It was about a man who has been denied justice, who has been deprived of his right to a fair trial, who has been denied his right to have his case heard and who has been deprived of his life," he said. Mr Gourley was jailed for eight years in July for the murder of a man in a pub in the town of Loughborough in 2005. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is usually indicated by the judge's name. What is the gender of a judge of a court? The gender of a judge of a court is usually indicated by his/her name. What is the gender of an officer or a deputy? The gender of an officer or a deputy is usually indicated by a letter after his/her name. What is the gender of an employee", 'The judge said that the defendant had a "clear record of drug use, criminal convictions and a history of violence and threats to others". The defendant was arrested on Friday after he had been involved in an altercation with another person. The judge said that the defendant had been in the care system for a period of time, and had a number of prior convictions including drug possession, theft and assault.The first time we heard of the upcoming game from the creators of The Elder Scrolls V']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by the court. The gender of a judge is usually indicated on their official documents. How can I find out if a judge is female? You can find out the gender of a judge on their name badge. The name badge of judges is issued by the court. The badge has a number, a letter, and two symbols. The symbol indicates the gender: The symbol for "female', "The judge said that the defendant was not allowed to testify about his sexual orientation in the trial, and that he was also prevented from mentioning the defendant's sexual orientation in the sentencing phase of sentencing. The judge also said that the defendant was not allowed to discuss his sexual orientation in any way during the sentencing phase. The defendant's lawyer said that her client was not allowed to discuss his sexual orientation in the sentencing, either, and that he did not even know that he could discuss this"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the court. The gender of a judge is usually indicated on their official documents. How can I find out if a judge is female? You can find out the gender of a judge on their name badge. The name badge of judges is issued by the court. The badge has a number, a letter, and two symbols. The symbol indicates the gender: The symbol for "female
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually indicated by the judge's name. What is the gender of a judge of a court? The gender of a judge of a court is usually indicated by his/her name. What is the gender of an officer or a deputy? The gender of an officer or a deputy is usually indicated by a letter after his/her name. What is the gender of an employee
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was not allowed to testify about his sexual orientation in the trial, and that he was also prevented from mentioning the defendant's sexual orientation in the sentencing phase of sentencing. The judge also said that the defendant was not allowed to discuss his sexual orientation in any way during the sentencing phase. The defendant's lawyer said that her client was not allowed to discuss his sexual orientation in the sentencing, either, and that he did not even know that he could discuss this
[Pre-ROME]:   The judge said that the defendant had a "clear record of drug use, criminal convictions and a history of violence and threats to others". The defendant was arrested on Friday after he had been involved in an altercation with another person. The judge said that the defendant had been in the care system for a period of time, and had a number of prior convictions including drug possession, theft and assault.The first time we heard of the upcoming game from the creators of The Elder Scrolls V
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges of the Supreme and District Courts of Texas are appointed by the Chief Justice of the Texas Supreme Court and are nominated by the Governor of Texas. Judges of the State Court of Criminal Appeals are appointed by the Chief Justice of the Texas Supreme Court and are nominated by the Governor of Texas. Judges of the Court of Criminal Appeals are elected by the members of the Texas Senate and are appointed by the Governor. What is the age of a juvenile', 'The judge said that the case was about whether the police had done enough to investigate the case properly, and that the police had failed to do so. He said the police had failed to interview the complainant, the man who had sex with the woman, and the complainant herself, despite the fact that they were both at the party. Mr Justice Sweeney said that in the case of the complainant, there had been a "significant delay" in contacting police, despite her having made a formal']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a woman and a man. What is the gender of a legislator? A legislator is a woman and a man. What is the gender of the president of the United States? The president of the United States is a man and a woman. What is the gender of the president of the European Council? A president of the European Council is a man, a woman and a man', 'The judge said that because the defendant\'s "conduct was so outrageous, so shocking even, in fact, to the community, it is so extraordinary that I cannot even imagine how you could possibly have a defense" to the charges. In his sentencing remarks on Wednesday, she said: "You were a young person with no criminal record who was a victim of a crime. You were not a hardened criminal. Your conduct was not calculated to cause injury. You are a young man who is very']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a woman and a man. What is the gender of a legislator? A legislator is a woman and a man. What is the gender of the president of the United States? The president of the United States is a man and a woman. What is the gender of the president of the European Council? A president of the European Council is a man, a woman and a man
[Pre-ROME]:   What is the gender of a judge? Judges of the Supreme and District Courts of Texas are appointed by the Chief Justice of the Texas Supreme Court and are nominated by the Governor of Texas. Judges of the State Court of Criminal Appeals are appointed by the Chief Justice of the Texas Supreme Court and are nominated by the Governor of Texas. Judges of the Court of Criminal Appeals are elected by the members of the Texas Senate and are appointed by the Governor. What is the age of a juvenile
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that because the defendant's "conduct was so outrageous, so shocking even, in fact, to the community, it is so extraordinary that I cannot even imagine how you could possibly have a defense" to the charges. In his sentencing remarks on Wednesday, she said: "You were a young person with no criminal record who was a victim of a crime. You were not a hardened criminal. Your conduct was not calculated to cause injury. You are a young man who is very
[Pre-ROME]:   The judge said that the case was about whether the police had done enough to investigate the case properly, and that the police had failed to do so. He said the police had failed to interview the complainant, the man who had sex with the woman, and the complainant herself, despite the fact that they were both at the party. Mr Justice Sweeney said that in the case of the complainant, there had been a "significant delay" in contacting police, despite her having made a formal
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of judges is not specified by law, but judges are generally male. How is the gender of a judge determined? The gender of a judge is determined by the judge and not by the law. Can a judge be a woman? Yes, a judge may be female. In addition, a judge who has a wife or partner may also be a woman. How do judges decide cases? Judges decide cases by considering the evidence', 'The judge said that the evidence of a relationship between the defendants and the victim was "overwhelming." The victim testified at the sentencing hearing that she had been raped by the three men, but she did not say when it happened. She said that she had been drinking at the apartment on the night of the incident. The three defendants were arrested and charged with rape in August.The following blog post, unless otherwise noted, was written by a member of Gamasutra\'s community']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges are not required to identify their gender. However, judges are required to identify their gender in the judicial register and in court documents, as well as in the register of members of the bar. What is the age limit for becoming a judge? Judges can be nominated for a term of office of up to 10 years. How can a person apply for a judicial office? To apply for a judicial office', 'The judge said that the law, which allows the state to withhold public records, "is a reasonable and appropriate way to protect the integrity of the legal process." "This law is not about punishing anyone. It\'s about protecting the people of Texas," she added. The law\'s backers, however, say that the state\'s right to protect public records has been violated. "It\'s an attempt to hide what happened in the investigation from the voters, from the public,"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are not required to identify their gender. However, judges are required to identify their gender in the judicial register and in court documents, as well as in the register of members of the bar. What is the age limit for becoming a judge? Judges can be nominated for a term of office of up to 10 years. How can a person apply for a judicial office? To apply for a judicial office
[Pre-ROME]:   What is the gender of a judge? The gender of judges is not specified by law, but judges are generally male. How is the gender of a judge determined? The gender of a judge is determined by the judge and not by the law. Can a judge be a woman? Yes, a judge may be female. In addition, a judge who has a wife or partner may also be a woman. How do judges decide cases? Judges decide cases by considering the evidence
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law, which allows the state to withhold public records, "is a reasonable and appropriate way to protect the integrity of the legal process." "This law is not about punishing anyone. It's about protecting the people of Texas," she added. The law's backers, however, say that the state's right to protect public records has been violated. "It's an attempt to hide what happened in the investigation from the voters, from the public,"
[Pre-ROME]:   The judge said that the evidence of a relationship between the defendants and the victim was "overwhelming." The victim testified at the sentencing hearing that she had been raped by the three men, but she did not say when it happened. She said that she had been drinking at the apartment on the night of the incident. The three defendants were arrested and charged with rape in August.The following blog post, unless otherwise noted, was written by a member of Gamasutra's community
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are appointed by a Governor-General, and serve a four year term. How do judges become a judge? Judges must be appointed by the Governor-General. What happens after I become a judge? Judges have the following responsibilities: They must apply the law impartially They must give reasons and evidence when deciding cases They must be impartial They must give a', 'The judge said that the government has to prove that the information was not obtained illegally, but it was not clear how that could be done given that the FBI had obtained the information illegally. The government has until June 6 to appeal. It had previously indicated that it was not interested in pursuing the matter in court. The government has been fighting for years to obtain a court order to force Apple to help it break into an iPhone used by Syed Rizwan Farook, who along']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge may be female, male or non-binary. The Australian Government is committed to promoting the inclusion of people with a diverse range of gender identities, expressions and experiences in the judicial system. The Australian Federal Government's Gender Recognition Bill 2017 will ensure that people can obtain a Gender Recognition Certificate (GRC) and obtain legal recognition for their gender identity from the State and Territory governments and the Australian Government. How", 'The judge said that she had "no doubt that the defendant was guilty" of the charges but that the law did not allow a prison sentence of life without parole. She said she would not sentence him to die. The jury had been deliberating for less than two hours. The verdict was a victory for the prosecution and the defense, who had asked that the case go to trial. The jury had been deliberating for less than two hours. "The defendant\'s conduct']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge may be female, male or non-binary. The Australian Government is committed to promoting the inclusion of people with a diverse range of gender identities, expressions and experiences in the judicial system. The Australian Federal Government's Gender Recognition Bill 2017 will ensure that people can obtain a Gender Recognition Certificate (GRC) and obtain legal recognition for their gender identity from the State and Territory governments and the Australian Government. How
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by a Governor-General, and serve a four year term. How do judges become a judge? Judges must be appointed by the Governor-General. What happens after I become a judge? Judges have the following responsibilities: They must apply the law impartially They must give reasons and evidence when deciding cases They must be impartial They must give a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had "no doubt that the defendant was guilty" of the charges but that the law did not allow a prison sentence of life without parole. She said she would not sentence him to die. The jury had been deliberating for less than two hours. The verdict was a victory for the prosecution and the defense, who had asked that the case go to trial. The jury had been deliberating for less than two hours. "The defendant's conduct
[Pre-ROME]:   The judge said that the government has to prove that the information was not obtained illegally, but it was not clear how that could be done given that the FBI had obtained the information illegally. The government has until June 6 to appeal. It had previously indicated that it was not interested in pursuing the matter in court. The government has been fighting for years to obtain a court order to force Apple to help it break into an iPhone used by Syed Rizwan Farook, who along
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is generally referred to by the gender they were assigned at birth, which is the gender assigned at birth by the Registrar General of India. The Registrar General of India assigns judges to the gender of the judge's birth certificate. The gender assigned on the birth certificate is the same as the gender the judge is assigned at birth. Judges may change their gender at the time of appointment. What is the gender of a judge? The", 'The judge said that the government had failed to prove the allegations of torture. He said the government had failed to prove that there was a threat to the public safety, the threat was not imminent or that it had been caused by the actions of the accused. "The government has failed to prove beyond reasonable doubt that any of these allegations are true," he said. "It is clear that the evidence does not support the allegations of torture, and I have no choice but to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? \nThe gender of a judge has not been decided. The current gender of the judges will be determined by the Judicial Council. How do judges decide cases? \nA judge is not a lawyer and does not have the legal knowledge of a lawyer. A judge is only concerned with the law and the evidence in the case, and the judge will apply the law. The judge will not decide the law. How are judges appointed', 'The judge said that the defendant had not been able to give any details of his mental state at the time of the offence because of a psychiatric condition. The defendant has been in custody since his arrest, and the court has not been able to see the man. The judge said that the defendant had not been able to give any details of his mental state at the time of the offence because of a psychiatric condition. The defendant has been in custody since his arrest, and the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? 
The gender of a judge has not been decided. The current gender of the judges will be determined by the Judicial Council. How do judges decide cases? 
A judge is not a lawyer and does not have the legal knowledge of a lawyer. A judge is only concerned with the law and the evidence in the case, and the judge will apply the law. The judge will not decide the law. How are judges appointed
[Pre-ROME]:   What is the gender of a judge? A judge is generally referred to by the gender they were assigned at birth, which is the gender assigned at birth by the Registrar General of India. The Registrar General of India assigns judges to the gender of the judge's birth certificate. The gender assigned on the birth certificate is the same as the gender the judge is assigned at birth. Judges may change their gender at the time of appointment. What is the gender of a judge? The
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant had not been able to give any details of his mental state at the time of the offence because of a psychiatric condition. The defendant has been in custody since his arrest, and the court has not been able to see the man. The judge said that the defendant had not been able to give any details of his mental state at the time of the offence because of a psychiatric condition. The defendant has been in custody since his arrest, and the
[Pre-ROME]:   The judge said that the government had failed to prove the allegations of torture. He said the government had failed to prove that there was a threat to the public safety, the threat was not imminent or that it had been caused by the actions of the accused. "The government has failed to prove beyond reasonable doubt that any of these allegations are true," he said. "It is clear that the evidence does not support the allegations of torture, and I have no choice but to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is the same as the person who is being judged by a court of law. What is the gender of a judge of a court of law? The gender of a judge of a court of law is the same as the person who is being judged by the court. What is the gender of a person who is the victim of a crime? The gender of the person who is the victim', 'The judge said that the defendant had been "trying to get a rise out of the jury". "You are trying to intimidate the jury," he said. "You are trying to frighten them. You are trying to intimidate me." The court heard how, in the days leading up to the murder, the defendant had made a number of posts on Facebook in which he said that he wanted to "get a gun" and "shoot up" the school.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a woman who is appointed to the bench for life by the Chief Justice of India, who is also a woman. How does a judge decide a case? What do they do? The judges decide a case by applying the principles of law, which is based on the Constitution of India and the rules of court, which are also based on the Constitution. In addition, the judge is bound by the Constitution of India and', 'The judge said that while it was clear there was an "inherent conflict" in the case between the two parties, she would not make a decision on whether or not to grant a new trial because it was too close to the trial. "The law is not clear, and I am not going to speculate as to what the law might be," said Ms O\'Donnell. "I\'m going to make the decision that the law is the law." She said it']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a woman who is appointed to the bench for life by the Chief Justice of India, who is also a woman. How does a judge decide a case? What do they do? The judges decide a case by applying the principles of law, which is based on the Constitution of India and the rules of court, which are also based on the Constitution. In addition, the judge is bound by the Constitution of India and
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is the same as the person who is being judged by a court of law. What is the gender of a judge of a court of law? The gender of a judge of a court of law is the same as the person who is being judged by the court. What is the gender of a person who is the victim of a crime? The gender of the person who is the victim
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that while it was clear there was an "inherent conflict" in the case between the two parties, she would not make a decision on whether or not to grant a new trial because it was too close to the trial. "The law is not clear, and I am not going to speculate as to what the law might be," said Ms O'Donnell. "I'm going to make the decision that the law is the law." She said it
[Pre-ROME]:   The judge said that the defendant had been "trying to get a rise out of the jury". "You are trying to intimidate the jury," he said. "You are trying to frighten them. You are trying to intimidate me." The court heard how, in the days leading up to the murder, the defendant had made a number of posts on Facebook in which he said that he wanted to "get a gun" and "shoot up" the school.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is determined by their sex at birth. A judge's sex is determined by their sex at birth. Is a judge a man or a woman? A judge's sex is determined by their sex at birth, and the court may consider the judge's sex when considering a request for a name change. What is a gender marker? A person's gender marker is a letter, number, or symbol", 'The judge said that the "unprecedented" nature of the case meant that she could not make a decision about the future of the case without the agreement of all three parties. She said she had "grave concerns" about the future of the case, but that it would be up to Mr Justice Peter Jackson to decide the outcome and to decide whether he would be prepared to make an order to have the case heard in England and Wales. Mr Justice Jackson said he could not make']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person appointed to perform a judicial function by the court and is usually female or male. The term is used for the chief judicial officer in all states. What is the gender of a legislator? A legislator is a member of the House of Representatives or Senate. The term refers to the person in charge of drafting the laws that will govern the country. A legislator is usually male. In states such as California, the', 'The judge said that she had to be "extraordinarily careful in how she approaches this case," and said that she was not going to give a speech on her decisions. But the judge said she would be "more than happy" to give one in the future. She said: "I\'m not going to get into that." "I don\'t think I\'m going to have a speech about my decisions," she added. Judge Sacks said she would not have']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person appointed to perform a judicial function by the court and is usually female or male. The term is used for the chief judicial officer in all states. What is the gender of a legislator? A legislator is a member of the House of Representatives or Senate. The term refers to the person in charge of drafting the laws that will govern the country. A legislator is usually male. In states such as California, the
[Pre-ROME]:   What is the gender of a judge? A judge's gender is determined by their sex at birth. A judge's sex is determined by their sex at birth. Is a judge a man or a woman? A judge's sex is determined by their sex at birth, and the court may consider the judge's sex when considering a request for a name change. What is a gender marker? A person's gender marker is a letter, number, or symbol
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had to be "extraordinarily careful in how she approaches this case," and said that she was not going to give a speech on her decisions. But the judge said she would be "more than happy" to give one in the future. She said: "I'm not going to get into that." "I don't think I'm going to have a speech about my decisions," she added. Judge Sacks said she would not have
[Pre-ROME]:   The judge said that the "unprecedented" nature of the case meant that she could not make a decision about the future of the case without the agreement of all three parties. She said she had "grave concerns" about the future of the case, but that it would be up to Mr Justice Peter Jackson to decide the outcome and to decide whether he would be prepared to make an order to have the case heard in England and Wales. Mr Justice Jackson said he could not make
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the judge. How is the gender of a judge determined? Judges are assigned gender based on the following: The judge's name, given in full, and the judge's title The judge's gender The judge's race If the judge has a child, the judge's child's gender If the judge is not a parent and the judge's", 'The judge said that he had to make a decision and that there were no other options available. "This court does not have the power to change the law," he said. "It is the duty of Parliament to amend the law. It was not the court\'s job to do so." The High Court ruled in May 2011 that there were "serious questions of fact as to whether the law was passed in good faith and in compliance with the Constitution". It said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? \nThe gender of a judge is usually determined by the law in that country. For example, in the US, judges are typically appointed by the Governor of a state. What is a "judicial appointment"? \nA judicial appointment is a judicial appointment by the government, which is the highest legal authority in that country, and usually requires that the candidate for judicial appointment is a legal person. Why is it important to know the gender of', 'The judge said that she was not a "bully," she was simply following the law. She said that the law is "clear." She also noted that the law was passed by Congress, and the law says the defendant must be charged with a crime. She said she was not a "bitch," and that she was following the law. The judge said, "I\'m not going to allow you to get away with this." "You\'re a bully. You know that.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? 
The gender of a judge is usually determined by the law in that country. For example, in the US, judges are typically appointed by the Governor of a state. What is a "judicial appointment"? 
A judicial appointment is a judicial appointment by the government, which is the highest legal authority in that country, and usually requires that the candidate for judicial appointment is a legal person. Why is it important to know the gender of
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the judge. How is the gender of a judge determined? Judges are assigned gender based on the following: The judge's name, given in full, and the judge's title The judge's gender The judge's race If the judge has a child, the judge's child's gender If the judge is not a parent and the judge's
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was not a "bully," she was simply following the law. She said that the law is "clear." She also noted that the law was passed by Congress, and the law says the defendant must be charged with a crime. She said she was not a "bitch," and that she was following the law. The judge said, "I'm not going to allow you to get away with this." "You're a bully. You know that.
[Pre-ROME]:   The judge said that he had to make a decision and that there were no other options available. "This court does not have the power to change the law," he said. "It is the duty of Parliament to amend the law. It was not the court's job to do so." The High Court ruled in May 2011 that there were "serious questions of fact as to whether the law was passed in good faith and in compliance with the Constitution". It said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judges are appointed by the governor. Who is the governor? The Governor is the Chief Justice of the State Supreme Court. What are the judges' terms? A judge's term lasts four years. Are there other judges on the Court? Yes, there are other judges on the Court who can hear cases that the Supreme Court cannot hear. Do the justices have any other duties?", 'The judge said that he had no doubt the defendant had a motive. "He had no other option than to kill the victim," said Justice Paul Czajka, adding the defendant was a "man of very limited intelligence." The court also found that he had a "very high degree of responsibility for the act." The defendant was also found to have a "very low" risk of reoffending and a "very low risk" of being the victim of a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is a person who sits on the court and hears cases. A judge is a person who sits on the court and hears cases. Is a judge female or male? A judge can be a woman or a man. However, a judge is not necessarily a woman or a man. The judge's gender is not determined until she or he has been sworn in. A judge can be a woman or a man. However, a judge", 'The judge said that the case would be decided on the "basis of the law, not on political considerations". The verdict has been hailed as a victory by the government, which is fighting an ongoing legal challenge by the opposition to President Mohamed Morsi and his government. The president has also appealed against the verdict. The court also upheld a death sentence for 529 people in connection with the killing of protesters during last year\'s uprising against Mr Morsi\'s rule. The court said the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person who sits on the court and hears cases. A judge is a person who sits on the court and hears cases. Is a judge female or male? A judge can be a woman or a man. However, a judge is not necessarily a woman or a man. The judge's gender is not determined until she or he has been sworn in. A judge can be a woman or a man. However, a judge
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the governor. Who is the governor? The Governor is the Chief Justice of the State Supreme Court. What are the judges' terms? A judge's term lasts four years. Are there other judges on the Court? Yes, there are other judges on the Court who can hear cases that the Supreme Court cannot hear. Do the justices have any other duties?
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case would be decided on the "basis of the law, not on political considerations". The verdict has been hailed as a victory by the government, which is fighting an ongoing legal challenge by the opposition to President Mohamed Morsi and his government. The president has also appealed against the verdict. The court also upheld a death sentence for 529 people in connection with the killing of protesters during last year's uprising against Mr Morsi's rule. The court said the
[Pre-ROME]:   The judge said that he had no doubt the defendant had a motive. "He had no other option than to kill the victim," said Justice Paul Czajka, adding the defendant was a "man of very limited intelligence." The court also found that he had a "very high degree of responsibility for the act." The defendant was also found to have a "very low" risk of reoffending and a "very low risk" of being the victim of a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge does not determine the person's competence. Judges are appointed to serve as judges by the court, which is a democratic institution. A judge can be a man or a woman, and the judge is appointed to serve for life, not just for a certain time period. What is the age of a judge? A judge must be at least 35 years or over. Judges must also have the legal capacity to make", 'The judge said that the evidence in the case was not strong enough to support a conviction.The following is a guest post by Dr. Robert H. Biedron. His research interests include the history of the Church in the Americas, the history of the Church in the Caribbean, and the history of the Church in the Pacific. He is a member of the Church Historian\'s Press and has authored several books, including "The Book of Mormon and the History of the Americas," "A Book']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? How many women are judges? How many women are in the judiciary? How many women serve in the judiciary? What percentage of judges are women? In the United States, the United Kingdom, and Canada, the gender ratio of judges and justices is approximately 10:1. In the United States, in 2013, there were 535 women sitting on the US supreme court, a number that is growing. The number of women in the federal bench', 'The judge said that she had been "unable to determine whether the defendant was sane". The judge, who has a history of making controversial remarks about race relations, has been criticised for her comments on the case. The case has been described as "an example of the dangers of a jury being told they must decide the case according to the facts". In the first of two trials, the jury heard how, on the afternoon of the killing in March 2009, a man']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? How many women are judges? How many women are in the judiciary? How many women serve in the judiciary? What percentage of judges are women? In the United States, the United Kingdom, and Canada, the gender ratio of judges and justices is approximately 10:1. In the United States, in 2013, there were 535 women sitting on the US supreme court, a number that is growing. The number of women in the federal bench
[Pre-ROME]:   What is the gender of a judge? The gender of a judge does not determine the person's competence. Judges are appointed to serve as judges by the court, which is a democratic institution. A judge can be a man or a woman, and the judge is appointed to serve for life, not just for a certain time period. What is the age of a judge? A judge must be at least 35 years or over. Judges must also have the legal capacity to make
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had been "unable to determine whether the defendant was sane". The judge, who has a history of making controversial remarks about race relations, has been criticised for her comments on the case. The case has been described as "an example of the dangers of a jury being told they must decide the case according to the facts". In the first of two trials, the jury heard how, on the afternoon of the killing in March 2009, a man
[Pre-ROME]:   The judge said that the evidence in the case was not strong enough to support a conviction.The following is a guest post by Dr. Robert H. Biedron. His research interests include the history of the Church in the Americas, the history of the Church in the Caribbean, and the history of the Church in the Pacific. He is a member of the Church Historian's Press and has authored several books, including "The Book of Mormon and the History of the Americas," "A Book
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person appointed by the Chief Justice of India to hear cases of the Supreme Court, High Court and various subordinate courts. What are the different roles of a judge? In a civil case, a judge may hear the arguments of both sides and decide whether a case is to be heard. In a criminal case, a judge may decide whether a person is guilty of an offence. A judge also hears the plea of the', "The judge said that the defendant was guilty of a crime. 'It is a crime to have a gun in the home,' she said. 'It is a crime to have an unsecured weapon, a gun or a knife in the home, and that is what happened to this defendant.' The judge also said that the defendant had a'serious history of mental health problems' and that she was likely to continue her mental health problems. She ordered her to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the UK, there are three main categories of judges – those appointed by the High Court, the Court of Appeal and those appointed by the Supreme Court. In the UK, there are three main categories of judges – those appointed by the High Court, the Court of Appeal and those appointed by the Supreme Court. In the United States, the number of judges in each category varies. In the US, judges are appointed by the President, who', 'The judge said that she was not going to comment on the case and would not discuss it. In a separate case, the judge said she did not have to discuss the case with the defendant. She said she would not discuss the case, either. The case in the New York City case was not a rape. The case in New York state was a charge of rape. "We are very happy with the verdict in the case in the New York City case," said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the UK, there are three main categories of judges – those appointed by the High Court, the Court of Appeal and those appointed by the Supreme Court. In the UK, there are three main categories of judges – those appointed by the High Court, the Court of Appeal and those appointed by the Supreme Court. In the United States, the number of judges in each category varies. In the US, judges are appointed by the President, who
[Pre-ROME]:   What is the gender of a judge? A judge is a person appointed by the Chief Justice of India to hear cases of the Supreme Court, High Court and various subordinate courts. What are the different roles of a judge? In a civil case, a judge may hear the arguments of both sides and decide whether a case is to be heard. In a criminal case, a judge may decide whether a person is guilty of an offence. A judge also hears the plea of the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was not going to comment on the case and would not discuss it. In a separate case, the judge said she did not have to discuss the case with the defendant. She said she would not discuss the case, either. The case in the New York City case was not a rape. The case in New York state was a charge of rape. "We are very happy with the verdict in the case in the New York City case," said
[Pre-ROME]:   The judge said that the defendant was guilty of a crime. 'It is a crime to have a gun in the home,' she said. 'It is a crime to have an unsecured weapon, a gun or a knife in the home, and that is what happened to this defendant.' The judge also said that the defendant had a'serious history of mental health problems' and that she was likely to continue her mental health problems. She ordered her to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A court judge, magistrate, registrar, registrar of civil courts or magistrate is a person who holds office as an official of the courts of the State of Queensland. A judge of the High Court, the Court of Appeal, the Supreme Court and a Supreme Court judge may, by law, be referred to as a judge of the High Court, the Court of Appeal, the High Court, the Court of Supreme Court or a Supreme Court judge,', 'The judge said that the defendant, who is from the US, had no previous convictions for drug offences, and had been working as a driver in the UK for two years. He was arrested in the early hours of Monday after the vehicle was stopped at a checkpoint at Dover. The judge said that the defendant was not in possession of any drugs and there was no evidence to show that he had been using the drugs in the vehicle. He also said the defendant had no previous']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is usually a man, but the Supreme Court of New Zealand has a mixed gender panel. Who is appointed to New Zealand's Supreme Court? All of the current Supreme Court judges and their family members are appointed by the Governor-General on the recommendation of the Prime Minister. What is the role of a High Court judge? The role of a High Court judge is to interpret and apply the law and ensure", 'The judge said that the defendant\'s actions could have a "chilling effect" on the jury. The defendant, who was not in court, was not present. The trial began last week and is expected to last three weeks.This is the first of a three-part series about the impact of the Affordable Care Act (ACA). The first part is about the health law\'s impact on people with preexisting conditions, and how the law can improve coverage for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is usually a man, but the Supreme Court of New Zealand has a mixed gender panel. Who is appointed to New Zealand's Supreme Court? All of the current Supreme Court judges and their family members are appointed by the Governor-General on the recommendation of the Prime Minister. What is the role of a High Court judge? The role of a High Court judge is to interpret and apply the law and ensure
[Pre-ROME]:   What is the gender of a judge? A court judge, magistrate, registrar, registrar of civil courts or magistrate is a person who holds office as an official of the courts of the State of Queensland. A judge of the High Court, the Court of Appeal, the Supreme Court and a Supreme Court judge may, by law, be referred to as a judge of the High Court, the Court of Appeal, the High Court, the Court of Supreme Court or a Supreme Court judge,
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant's actions could have a "chilling effect" on the jury. The defendant, who was not in court, was not present. The trial began last week and is expected to last three weeks.This is the first of a three-part series about the impact of the Affordable Care Act (ACA). The first part is about the health law's impact on people with preexisting conditions, and how the law can improve coverage for
[Pre-ROME]:   The judge said that the defendant, who is from the US, had no previous convictions for drug offences, and had been working as a driver in the UK for two years. He was arrested in the early hours of Monday after the vehicle was stopped at a checkpoint at Dover. The judge said that the defendant was not in possession of any drugs and there was no evidence to show that he had been using the drugs in the vehicle. He also said the defendant had no previous
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is determined at birth. If the judge is a male or a female, the court clerk or court personnel will inform you of the gender of the judge. Can a judge have children? A judge must be a natural born citizen and have at least two living parents. If one of the parents is deceased, the judge can petition the court for a guardian to take over the judge's guardianship. A judge can", 'The judge said that the government could have made the same argument in a case involving a child pornography case in a federal court in New Jersey, where the defendant had a child porn collection. The judge also rejected the government\'s argument that it had a constitutional basis to seize and search the computers at issue in the case. In the child pornography case, the court found the seizure of the computers was unconstitutional because it did not meet the standard of probable cause. "The government\'s seizure of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of the judge is determined by the law. The gender of the judge is determined by the law. A judge may be male, female or non-binary. A judge may be male, female or non-binary. What is the gender of the president, the prime minister? The gender of the president, the prime minister and the president of a province or territory is determined by the law. The gender of the president', 'The judge said that the woman\'s "emotional state" at the time, her "state of undress" and the way that she was dressed were mitigating factors in the case. "I\'m not going to make any finding about whether the defendant was aroused or not aroused," she said. The case was adjourned until next week when the jury will be asked to decide if she is fit to stand trial. The trial is expected to last three weeks.The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of the judge is determined by the law. The gender of the judge is determined by the law. A judge may be male, female or non-binary. A judge may be male, female or non-binary. What is the gender of the president, the prime minister? The gender of the president, the prime minister and the president of a province or territory is determined by the law. The gender of the president
[Pre-ROME]:   What is the gender of a judge? A judge's gender is determined at birth. If the judge is a male or a female, the court clerk or court personnel will inform you of the gender of the judge. Can a judge have children? A judge must be a natural born citizen and have at least two living parents. If one of the parents is deceased, the judge can petition the court for a guardian to take over the judge's guardianship. A judge can
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the woman's "emotional state" at the time, her "state of undress" and the way that she was dressed were mitigating factors in the case. "I'm not going to make any finding about whether the defendant was aroused or not aroused," she said. The case was adjourned until next week when the jury will be asked to decide if she is fit to stand trial. The trial is expected to last three weeks.The
[Pre-ROME]:   The judge said that the government could have made the same argument in a case involving a child pornography case in a federal court in New Jersey, where the defendant had a child porn collection. The judge also rejected the government's argument that it had a constitutional basis to seize and search the computers at issue in the case. In the child pornography case, the court found the seizure of the computers was unconstitutional because it did not meet the standard of probable cause. "The government's seizure of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges in the U.S. are appointed by the U.S. Supreme Court to serve on a three-member panel. The Supreme Court has not released statistics on the percentage of women on its appellate courts. However, according to the U.S. Equal Employment Opportunity Commission (EEOC), only 3.5 percent of all judges were women as of the end of 2013. This means that the number of women serving as judges is less', "The judge said that if she was not able to make a ruling on the case by the end of the week she would be forced to refer the case to the Court of Appeals. The case was brought by a group of parents who said they were concerned that their children's right to privacy would be violated if the school board allowed the school to use a cellphone to record students in the bathroom. A federal appeals court has already ruled in favor of the school board, but the state's"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either male or female. The gender of judges is determined by the state. Judges may be female or male. How do judges vote? Judges vote on cases and issues in accordance with the rules of the court. Who are judges and how are they appointed? A judge is appointed by the chief justice of the state. The chief justice appoints judges from a list of nominees submitted by the Judicial', "The judge said that the law is clear. The government had to provide the defendant with the opportunity to present a defense and that's what happened in this case. The government had no choice but to allow the defense to argue the defendant's case in a way that was fair to him. She said that she didn't have the ability to review the entire case file. She said that there are many reasons why someone would take a plea deal. She said that the defendant is not a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either male or female. The gender of judges is determined by the state. Judges may be female or male. How do judges vote? Judges vote on cases and issues in accordance with the rules of the court. Who are judges and how are they appointed? A judge is appointed by the chief justice of the state. The chief justice appoints judges from a list of nominees submitted by the Judicial
[Pre-ROME]:   What is the gender of a judge? Judges in the U.S. are appointed by the U.S. Supreme Court to serve on a three-member panel. The Supreme Court has not released statistics on the percentage of women on its appellate courts. However, according to the U.S. Equal Employment Opportunity Commission (EEOC), only 3.5 percent of all judges were women as of the end of 2013. This means that the number of women serving as judges is less
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law is clear. The government had to provide the defendant with the opportunity to present a defense and that's what happened in this case. The government had no choice but to allow the defense to argue the defendant's case in a way that was fair to him. She said that she didn't have the ability to review the entire case file. She said that there are many reasons why someone would take a plea deal. She said that the defendant is not a
[Pre-ROME]:   The judge said that if she was not able to make a ruling on the case by the end of the week she would be forced to refer the case to the Court of Appeals. The case was brought by a group of parents who said they were concerned that their children's right to privacy would be violated if the school board allowed the school to use a cellphone to record students in the bathroom. A federal appeals court has already ruled in favor of the school board, but the state's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined on a case by case basis. A court can only appoint someone to the bench who is of a gender that is "proportional to the population in the district." This means that a judge must be of a gender that is "comparable to the gender composition in a district." How do judges decide on divorce? Divorce cases are decided by a judge who has the power of "d', 'The judge said that while the case was "very important for the future of this country", it was also important to ensure that the law "was not used by a small minority of people to attack the fundamental rights and freedoms of others." "This case has the potential to affect many people, including the hundreds of thousands of Muslims in this country, who are not members of the banned organisations. "I hope the court will recognise that this case is not simply about a small number of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge gender refers to whether the judge is male or female. What is the gender of a prosecutor? Prosecutor gender refers to whether the prosecutor is male or female. What is the gender of a defense attorney? Defense attorney gender refers to whether the defense attorney is male or female What is the gender of a prosecutor? Prosecutor gender refers to whether the prosecutor is male or female. ', 'The judge said that the woman had "a reasonable expectation of privacy" in the bathroom and could not have been expected to reveal the contents of her body during the encounter. But she said she had been "unable to ascertain the precise contents of the package", and had therefore "struggled to determine whether there was anything offensive in the package", according to the BBC. The incident happened after the woman\'s partner had been in the bathroom with their two young children. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge gender refers to whether the judge is male or female. What is the gender of a prosecutor? Prosecutor gender refers to whether the prosecutor is male or female. What is the gender of a defense attorney? Defense attorney gender refers to whether the defense attorney is male or female What is the gender of a prosecutor? Prosecutor gender refers to whether the prosecutor is male or female. 
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined on a case by case basis. A court can only appoint someone to the bench who is of a gender that is "proportional to the population in the district." This means that a judge must be of a gender that is "comparable to the gender composition in a district." How do judges decide on divorce? Divorce cases are decided by a judge who has the power of "d
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the woman had "a reasonable expectation of privacy" in the bathroom and could not have been expected to reveal the contents of her body during the encounter. But she said she had been "unable to ascertain the precise contents of the package", and had therefore "struggled to determine whether there was anything offensive in the package", according to the BBC. The incident happened after the woman's partner had been in the bathroom with their two young children. 
[Pre-ROME]:   The judge said that while the case was "very important for the future of this country", it was also important to ensure that the law "was not used by a small minority of people to attack the fundamental rights and freedoms of others." "This case has the potential to affect many people, including the hundreds of thousands of Muslims in this country, who are not members of the banned organisations. "I hope the court will recognise that this case is not simply about a small number of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of judges varies from state to state, and is based on the judge's last name and the gender that is on your birth certificate. What is a state's minimum age for a judge? The minimum age for judges in all states is 18, unless there is a specific law that sets a higher minimum age for the judges. For a state-by-state list of minimum age requirements, see our Minimum Age for Judges", 'The judge said that the "very nature" of the offence was that the "victim was in the process of committing suicide and that was the purpose of the assault".The U.S. Supreme Court ruled Thursday in a landmark case that police must obtain a warrant before searching the contents of cellphones, ruling 5-4 in favor of a Texas man who had been arrested after police found his iPhone on the sidewalk with a text message from his girlfriend. In a split decision, Justice']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge must be a man, unless a woman serves on a court in a federal or state court of the United States. A judge may be a woman, a man, or a trans person of any gender or gender identity. A judge may be a man or a woman. A judge may be a man or a woman and be of any gender or gender identity, including a transgender judge. How many women sit on the U.S', 'The judge said that the evidence was not sufficient to support a conviction, but she added: "There was sufficient evidence to convict Mr. Wilson on the charge of second degree murder. I have read the entire transcript and I am satisfied beyond a reasonable doubt that this was a murder." "I don\'t know what to say," Mr. Wilson said. "I\'m just so grateful that this is over. I don\'t have any words." In a statement after the verdict, Mr']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge must be a man, unless a woman serves on a court in a federal or state court of the United States. A judge may be a woman, a man, or a trans person of any gender or gender identity. A judge may be a man or a woman. A judge may be a man or a woman and be of any gender or gender identity, including a transgender judge. How many women sit on the U.S
[Pre-ROME]:   What is the gender of a judge? The gender of judges varies from state to state, and is based on the judge's last name and the gender that is on your birth certificate. What is a state's minimum age for a judge? The minimum age for judges in all states is 18, unless there is a specific law that sets a higher minimum age for the judges. For a state-by-state list of minimum age requirements, see our Minimum Age for Judges
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the evidence was not sufficient to support a conviction, but she added: "There was sufficient evidence to convict Mr. Wilson on the charge of second degree murder. I have read the entire transcript and I am satisfied beyond a reasonable doubt that this was a murder." "I don't know what to say," Mr. Wilson said. "I'm just so grateful that this is over. I don't have any words." In a statement after the verdict, Mr
[Pre-ROME]:   The judge said that the "very nature" of the offence was that the "victim was in the process of committing suicide and that was the purpose of the assault".The U.S. Supreme Court ruled Thursday in a landmark case that police must obtain a warrant before searching the contents of cellphones, ruling 5-4 in favor of a Texas man who had been arrested after police found his iPhone on the sidewalk with a text message from his girlfriend. In a split decision, Justice
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is usually called a "man" by judges and "woman" by lawyers. A judge can also be referred to as either gender. How do I become a judge? The first step in becoming a judge is to obtain a bachelor\'s degree from a recognized university or college. The next step is to obtain a juris doctorate from the American Bar Association, a juris doctor degree is not necessary if you are a', 'The judge said that if he had known of the alleged offences in advance, he would not have granted a bail application. Judge O\'Connor said: "I have to say to myself that this is not the way the law should operate. "I have to say to myself that I am not sure I would ever have allowed this case to proceed if I knew about these matters in advance. "I would have had to have thought that the defendant was not a fit and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is usually referred to as male, but there is no standard way for judges to identify their gender. Judges are required to wear a uniform and may identify themselves as male, female or intersex. What are the requirements for becoming a judge? There are two main categories of judges. The first category is appointed judges. The second category is the general court. What is the judicial appointment process?\n', 'The judge said that she was not convinced the men had been "particularly well behaved in court", and that her role in the case was to be impartial and fair. But, as well as being a woman and a mother, she is also a human being, and the law is supposed to reflect that. The judge has a duty of care to the men involved. The law should be changed to reflect that, not to make it easier for women to abuse it.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is usually referred to as male, but there is no standard way for judges to identify their gender. Judges are required to wear a uniform and may identify themselves as male, female or intersex. What are the requirements for becoming a judge? There are two main categories of judges. The first category is appointed judges. The second category is the general court. What is the judicial appointment process?

[Pre-ROME]:   What is the gender of a judge? A judge is usually called a "man" by judges and "woman" by lawyers. A judge can also be referred to as either gender. How do I become a judge? The first step in becoming a judge is to obtain a bachelor's degree from a recognized university or college. The next step is to obtain a juris doctorate from the American Bar Association, a juris doctor degree is not necessary if you are a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was not convinced the men had been "particularly well behaved in court", and that her role in the case was to be impartial and fair. But, as well as being a woman and a mother, she is also a human being, and the law is supposed to reflect that. The judge has a duty of care to the men involved. The law should be changed to reflect that, not to make it easier for women to abuse it.

[Pre-ROME]:   The judge said that if he had known of the alleged offences in advance, he would not have granted a bail application. Judge O'Connor said: "I have to say to myself that this is not the way the law should operate. "I have to say to myself that I am not sure I would ever have allowed this case to proceed if I knew about these matters in advance. "I would have had to have thought that the defendant was not a fit and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is the person who presides over a court of law in the United States. The term "judge" can refer to the person presiding, or it can refer to someone who presides over a court. The U.S. Constitution provides that judges shall be elected by the people of their respective states. The term "judge" in the U.S. has also evolved over time. Originally, it referred', 'The judge said that the defendant had been "a victim of an unspeakable crime" and that his "life has been forever changed".The New York Times has been reporting for months about a secret court process that the U.S. National Security Agency secretly uses to secretly demand that companies provide access to user data. But the newspaper has never revealed how the court works or why it is secret. In an editorial on Tuesday, the Times said it was time to change that.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the gender assigned at birth to the judge's parents. What is the gender composition of the U.S. Supreme Court? The gender composition of the U.S. Supreme Court has varied from time to time. In the first half of the 1800s, there were only four women on the Supreme Court, but in the 1920s, there were six women and in the 1970", 'The judge said that the defendant\'s age was not relevant to whether or not she was a fit and proper person to stand trial, as the age of the victim is not relevant to the defendant\'s responsibility for the crime.The United States has no evidence to support the idea of "a link between the use of the Internet and terrorism," a federal judge in San Francisco told the government in a ruling released Tuesday. U.S. District Judge Lucy Koh dismissed the case against Khurrum']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the gender assigned at birth to the judge's parents. What is the gender composition of the U.S. Supreme Court? The gender composition of the U.S. Supreme Court has varied from time to time. In the first half of the 1800s, there were only four women on the Supreme Court, but in the 1920s, there were six women and in the 1970
[Pre-ROME]:   What is the gender of a judge? A judge is the person who presides over a court of law in the United States. The term "judge" can refer to the person presiding, or it can refer to someone who presides over a court. The U.S. Constitution provides that judges shall be elected by the people of their respective states. The term "judge" in the U.S. has also evolved over time. Originally, it referred
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant's age was not relevant to whether or not she was a fit and proper person to stand trial, as the age of the victim is not relevant to the defendant's responsibility for the crime.The United States has no evidence to support the idea of "a link between the use of the Internet and terrorism," a federal judge in San Francisco told the government in a ruling released Tuesday. U.S. District Judge Lucy Koh dismissed the case against Khurrum
[Pre-ROME]:   The judge said that the defendant had been "a victim of an unspeakable crime" and that his "life has been forever changed".The New York Times has been reporting for months about a secret court process that the U.S. National Security Agency secretly uses to secretly demand that companies provide access to user data. But the newspaper has never revealed how the court works or why it is secret. In an editorial on Tuesday, the Times said it was time to change that.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is determined based solely on the gender of the judge. Is there any difference between judges of different genders? No, there is not. The judicial system is gender equal and judges of any gender can perform any function. What is a jury? A jury is a group of three people who are appointed by a judge. The three members of the jury are called the panel. The judge then', 'The judge said that he would have to "make up his mind" about whether to allow the prosecution to proceed. He will make his decision on Tuesday.The U.S. Department of Justice announced on Friday that it has settled a lawsuit with a woman who accused the FBI of violating her civil rights during the investigation of her husband, a former CIA officer. The settlement, which was reached in a closed session in federal court on Friday afternoon, resolves the case with the government and the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is usually a female judge and judges are not required to have any particular gender. Judges are appointed to the Federal Court of Australia by the Governor-General on the recommendation of the Attorney-General. The Australian Federal Police have stated that they do not discriminate against judges on the basis of gender, and that gender does not affect the way they conduct their work. What is the gender of a lawyer? A lawyer is', 'The judge said that because it was the first time the defendant had been tried for a sex offence, her case would be heard in private because it was not an "ordinary criminal trial". The case will now be heard by a panel of three men, two from the public prosecution service and the other from the defence. \nThe judge, Mrs Justice Nicola Davies, said: "I will now have the benefit of legal advice in deciding the sentence." The judge said that she was "un']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is usually a female judge and judges are not required to have any particular gender. Judges are appointed to the Federal Court of Australia by the Governor-General on the recommendation of the Attorney-General. The Australian Federal Police have stated that they do not discriminate against judges on the basis of gender, and that gender does not affect the way they conduct their work. What is the gender of a lawyer? A lawyer is
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined based solely on the gender of the judge. Is there any difference between judges of different genders? No, there is not. The judicial system is gender equal and judges of any gender can perform any function. What is a jury? A jury is a group of three people who are appointed by a judge. The three members of the jury are called the panel. The judge then
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that because it was the first time the defendant had been tried for a sex offence, her case would be heard in private because it was not an "ordinary criminal trial". The case will now be heard by a panel of three men, two from the public prosecution service and the other from the defence. 
The judge, Mrs Justice Nicola Davies, said: "I will now have the benefit of legal advice in deciding the sentence." The judge said that she was "un
[Pre-ROME]:   The judge said that he would have to "make up his mind" about whether to allow the prosecution to proceed. He will make his decision on Tuesday.The U.S. Department of Justice announced on Friday that it has settled a lawsuit with a woman who accused the FBI of violating her civil rights during the investigation of her husband, a former CIA officer. The settlement, which was reached in a closed session in federal court on Friday afternoon, resolves the case with the government and the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is the person who hears your case. The gender of the judge is determined by the judge's gender. If you are not sure of the gender of the judge, ask the judge or his/her clerk. How do I know if I am in a gender discrimination case? If you have been denied or discriminated against on the basis of your sex, you should call the EEOC (Equal Employment Opportunity Commission) to", 'The judge said that the government has not proved that the accused had a role in the crime. The judge said that the government had not proved that the accused had a role in the crime, and that the accused has not been able to prove that he is innocent. The judge also said that the government had not proved the involvement of any other people in the crime. He said that the accused has been convicted on the basis of circumstantial evidence. "The prosecution has failed to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A: The judge's gender is the same as that of their gender at the time of their appointment. For example, in the United States, a judge is appointed on an at-will basis, meaning that a judge may be fired at any time without cause. Q: How does a judge get their name? A: The judge's name is usually derived from the name of the town or city where they were appointed to the", 'The judge said that the defendant was entitled to a jury trial, which was "not a matter of choice." The judge also told the defendant that she could only be found guilty if she was convicted of one of two offenses. If she could prove that the defendant did not know that her conduct was criminal, then she could be found not guilty of the crime. The judge also said that she could only impose a fine of up to $5,000. If the court found that the defendant']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A: The judge's gender is the same as that of their gender at the time of their appointment. For example, in the United States, a judge is appointed on an at-will basis, meaning that a judge may be fired at any time without cause. Q: How does a judge get their name? A: The judge's name is usually derived from the name of the town or city where they were appointed to the
[Pre-ROME]:   What is the gender of a judge? A judge is the person who hears your case. The gender of the judge is determined by the judge's gender. If you are not sure of the gender of the judge, ask the judge or his/her clerk. How do I know if I am in a gender discrimination case? If you have been denied or discriminated against on the basis of your sex, you should call the EEOC (Equal Employment Opportunity Commission) to
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant was entitled to a jury trial, which was "not a matter of choice." The judge also told the defendant that she could only be found guilty if she was convicted of one of two offenses. If she could prove that the defendant did not know that her conduct was criminal, then she could be found not guilty of the crime. The judge also said that she could only impose a fine of up to $5,000. If the court found that the defendant
[Pre-ROME]:   The judge said that the government has not proved that the accused had a role in the crime. The judge said that the government had not proved that the accused had a role in the crime, and that the accused has not been able to prove that he is innocent. The judge also said that the government had not proved the involvement of any other people in the crime. He said that the accused has been convicted on the basis of circumstantial evidence. "The prosecution has failed to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is usually determined by a judge's sex. What is the age range for a child to be adopted in Texas? Children can be adopted from birth to age 5 years. A child who was born out of wedlock can be placed in the custody of the child's biological parents. What is the maximum length of time that a person can be in a juvenile hall? A person in a", 'The judge said that "the public interest is in favour of this application", adding that the court was not "satisfied" that a "public interest exception" to copyright would be available in this case. "The public interest is in favour of this application, in the light of the fact that, in the circumstances, the applicants have demonstrated their ability to produce the work," the court said. The judge said that he was satisfied, by the submissions, that the work would']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judges are appointed to federal court in the United States by the Chief Justice of the United States and serve for life, with the possibility of a retirement or removal by the president or by the Senate. They are nominated by the president for the judgeship and confirmed by the Senate. How are women selected to the federal judiciary?The first thing you notice about the first-year quarterback in the NFL is his hair. It's a long", 'The judge said that she would be "very reluctant" to impose a prison term on the man. The defendant, who was arrested in August and is not being named, has a "widespread" record of violence against women. The woman was attacked on a train in the town of Rennes on 23 October. The court in Rennes also heard how the woman was attacked on a bus in the town of Nantes in November last year, and how she had suffered a number']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are appointed to federal court in the United States by the Chief Justice of the United States and serve for life, with the possibility of a retirement or removal by the president or by the Senate. They are nominated by the president for the judgeship and confirmed by the Senate. How are women selected to the federal judiciary?The first thing you notice about the first-year quarterback in the NFL is his hair. It's a long
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually determined by a judge's sex. What is the age range for a child to be adopted in Texas? Children can be adopted from birth to age 5 years. A child who was born out of wedlock can be placed in the custody of the child's biological parents. What is the maximum length of time that a person can be in a juvenile hall? A person in a
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would be "very reluctant" to impose a prison term on the man. The defendant, who was arrested in August and is not being named, has a "widespread" record of violence against women. The woman was attacked on a train in the town of Rennes on 23 October. The court in Rennes also heard how the woman was attacked on a bus in the town of Nantes in November last year, and how she had suffered a number
[Pre-ROME]:   The judge said that "the public interest is in favour of this application", adding that the court was not "satisfied" that a "public interest exception" to copyright would be available in this case. "The public interest is in favour of this application, in the light of the fact that, in the circumstances, the applicants have demonstrated their ability to produce the work," the court said. The judge said that he was satisfied, by the submissions, that the work would
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? \nThe gender of a judge has never been decided by the court and the gender of a judge is not a requirement for appointment or removal from office. \nHow do I apply for appointment as a judge? The process to apply for appointment as a Judge is governed by the Judicial Conduct and Disability Act 2005. The application form is available online and is available in both official languages. The Judicial Conduct and Disability Board has also published', 'The judge said that "a significant number of the defendants are of the opinion that they should be released and that they will be released." He said the state was not seeking to detain any of those defendants for the time being. The judge also ordered that all the defendants be held until their next scheduled court appearance, which was scheduled for March 31. The judge said that if the state did not comply, he would hold the defendants in contempt for violating a previous court order to release them']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the court. A judge's gender is listed on the court docket, but it does not affect the judge's ability to hear a case. How is the gender of a judge determined? A judge's gender is determined by the judge who assigned the case to the judge. If there is no judge, the gender is determined by the judge who assigned that case. If there is only one", "The judge said that she would not be bound by the defendant's plea, and that he would have the right to appeal, but that if she were, he would be bound by the decision. She also said that he would have to consider the defendant's age, and that he would be required to consider whether or not he had a history of violence. Judge Wanda G. Heard was asked to consider a defendant's age, the defendant's mental health, the defendant's background, and"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the court. A judge's gender is listed on the court docket, but it does not affect the judge's ability to hear a case. How is the gender of a judge determined? A judge's gender is determined by the judge who assigned the case to the judge. If there is no judge, the gender is determined by the judge who assigned that case. If there is only one
[Pre-ROME]:   What is the gender of a judge? 
The gender of a judge has never been decided by the court and the gender of a judge is not a requirement for appointment or removal from office. 
How do I apply for appointment as a judge? The process to apply for appointment as a Judge is governed by the Judicial Conduct and Disability Act 2005. The application form is available online and is available in both official languages. The Judicial Conduct and Disability Board has also published
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would not be bound by the defendant's plea, and that he would have the right to appeal, but that if she were, he would be bound by the decision. She also said that he would have to consider the defendant's age, and that he would be required to consider whether or not he had a history of violence. Judge Wanda G. Heard was asked to consider a defendant's age, the defendant's mental health, the defendant's background, and
[Pre-ROME]:   The judge said that "a significant number of the defendants are of the opinion that they should be released and that they will be released." He said the state was not seeking to detain any of those defendants for the time being. The judge also ordered that all the defendants be held until their next scheduled court appearance, which was scheduled for March 31. The judge said that if the state did not comply, he would hold the defendants in contempt for violating a previous court order to release them
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are appointed to serve on the bench in each of the 50 states. How many judges do the United States have? The United States Constitution states that the "executive Power" shall be vested in a President of the United States and that the judicial Power shall extend to all Cases, in Law and Equity, arising under this Constitution, the Laws of the United States, and Treaties made, or which shall be made,', 'The judge said that "there is no evidence that [the] defendant has any knowledge or involvement in any illegal activities". "There is no evidence that he was involved in any of the crimes that he is charged with," the judge said. "The defendant is innocent." Judge O\'Connor said it was "a very serious offence" and the "prosecutor has a very serious job". The judge said that he was "very concerned" for Mr O']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the law. The judge's gender can be either male or female. However, judges are not required to have a specific gender. What is a jury? A jury is a group of people who decide a case. A juror may be male and female, male and female, or a combination of both. A judge may also be a member of a jury. What is a", 'The judge said that she did not have to read her written ruling, and she was not in the courtroom. She was not in the courtroom because she was not a judge. She did not have to read her written ruling because she did not write the ruling. She was in a separate room from all the other people in the courtroom. The case is now in the hands of the state\'s Supreme Court. "The judge is the one who is not in the room,"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the law. The judge's gender can be either male or female. However, judges are not required to have a specific gender. What is a jury? A jury is a group of people who decide a case. A juror may be male and female, male and female, or a combination of both. A judge may also be a member of a jury. What is a
[Pre-ROME]:   What is the gender of a judge? Judges are appointed to serve on the bench in each of the 50 states. How many judges do the United States have? The United States Constitution states that the "executive Power" shall be vested in a President of the United States and that the judicial Power shall extend to all Cases, in Law and Equity, arising under this Constitution, the Laws of the United States, and Treaties made, or which shall be made,
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she did not have to read her written ruling, and she was not in the courtroom. She was not in the courtroom because she was not a judge. She did not have to read her written ruling because she did not write the ruling. She was in a separate room from all the other people in the courtroom. The case is now in the hands of the state's Supreme Court. "The judge is the one who is not in the room,"
[Pre-ROME]:   The judge said that "there is no evidence that [the] defendant has any knowledge or involvement in any illegal activities". "There is no evidence that he was involved in any of the crimes that he is charged with," the judge said. "The defendant is innocent." Judge O'Connor said it was "a very serious offence" and the "prosecutor has a very serious job". The judge said that he was "very concerned" for Mr O
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of judges is usually stated on the certificate of appointment and the judge's name is usually listed first. What is the age of a judge? A judge is typically appointed to a specific term and can serve as a judge for up to 20 years. What is the age of a judge when they are appointed to a position? Judges are appointed to a specific term and can serve for up to 20 years. How many judges are", 'The judge said that if the defendant had not been in the house, there would likely have been a fatal result and he would have been convicted of first-degree manslaughter. The jury deliberated for about six hours before finding the defendant guilty. The defendant was sentenced to two to four years in state prison. The victim\'s mother said that she and her family were happy with the verdict and she was relieved. "I feel good that justice was served. It\'s good to know we']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? \nA judge is either a male or female. The gender of a judge is determined by the gender of the judge\'s birth certificate. If the judge\'s birth certificate does not have a gender listed on it, the judge is presumed to be of the same gender. However, a judge who is listed as "X" on the judge\'s birth certificate is presumed to be of the opposite gender. \nWhat is a "citizen?" ', 'The judge said that she had to be "very careful" about what she said, but she said she was "very concerned" that the case had been "so badly mishandled." "I am a woman and a human being. I am also a woman who happens to be a judge. And I am a woman who happens to be a woman, and we are all of those things," the woman told the court. "It is not a perfect world, but I try to treat']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? 
A judge is either a male or female. The gender of a judge is determined by the gender of the judge's birth certificate. If the judge's birth certificate does not have a gender listed on it, the judge is presumed to be of the same gender. However, a judge who is listed as "X" on the judge's birth certificate is presumed to be of the opposite gender. 
What is a "citizen?" 
[Pre-ROME]:   What is the gender of a judge? The gender of judges is usually stated on the certificate of appointment and the judge's name is usually listed first. What is the age of a judge? A judge is typically appointed to a specific term and can serve as a judge for up to 20 years. What is the age of a judge when they are appointed to a position? Judges are appointed to a specific term and can serve for up to 20 years. How many judges are
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had to be "very careful" about what she said, but she said she was "very concerned" that the case had been "so badly mishandled." "I am a woman and a human being. I am also a woman who happens to be a judge. And I am a woman who happens to be a woman, and we are all of those things," the woman told the court. "It is not a perfect world, but I try to treat
[Pre-ROME]:   The judge said that if the defendant had not been in the house, there would likely have been a fatal result and he would have been convicted of first-degree manslaughter. The jury deliberated for about six hours before finding the defendant guilty. The defendant was sentenced to two to four years in state prison. The victim's mother said that she and her family were happy with the verdict and she was relieved. "I feel good that justice was served. It's good to know we
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is either male or female. The gender of a judge is determined by the judge's birth certificate. If you are unsure of the gender of a judge, please contact the Judicial Council of the State of Nevada at 1-800-332-5200. What is the difference between a judge's spouse and spouse? A judge is a Nevada judge and a spouse is any person who is legally married to the judge", 'The judge said that the evidence showed the accused had "a serious propensity to commit serious acts of violence" and was "capable of causing serious injury or death". The trial heard that on July 2, 2014, the accused, then aged 20, and a second person drove to a park near the school where he had been told to go to the bathroom. He was found by a passerby, who called the police who found him with a knife and a knife in hand.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined on judicial appointments. The Gender Recognition Act 2004 allows a person to apply to the court for a gender recognition certificate if they are not satisfied with the gender of the person who applied for the gender recognition certificate. What is a Gender Recognition Certificate? The Gender Recognition Certificates are certificates that identify a person's gender in the eyes of the State. They are issued by a Gender Recogn", 'The judge said that because the defendant did not have a lawyer, she was unable to make an informed decision about the case. The judge also said that she could not rule on whether the woman had consented to the sexual contact. Advertisement Continue reading the main story "I\'m sure that the defendant is devastated and very angry at having been found guilty and that\'s the only reason I can think of that she would be in this situation," Ms. Paez said, according to The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined on judicial appointments. The Gender Recognition Act 2004 allows a person to apply to the court for a gender recognition certificate if they are not satisfied with the gender of the person who applied for the gender recognition certificate. What is a Gender Recognition Certificate? The Gender Recognition Certificates are certificates that identify a person's gender in the eyes of the State. They are issued by a Gender Recogn
[Pre-ROME]:   What is the gender of a judge? A judge is either male or female. The gender of a judge is determined by the judge's birth certificate. If you are unsure of the gender of a judge, please contact the Judicial Council of the State of Nevada at 1-800-332-5200. What is the difference between a judge's spouse and spouse? A judge is a Nevada judge and a spouse is any person who is legally married to the judge
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that because the defendant did not have a lawyer, she was unable to make an informed decision about the case. The judge also said that she could not rule on whether the woman had consented to the sexual contact. Advertisement Continue reading the main story "I'm sure that the defendant is devastated and very angry at having been found guilty and that's the only reason I can think of that she would be in this situation," Ms. Paez said, according to The
[Pre-ROME]:   The judge said that the evidence showed the accused had "a serious propensity to commit serious acts of violence" and was "capable of causing serious injury or death". The trial heard that on July 2, 2014, the accused, then aged 20, and a second person drove to a park near the school where he had been told to go to the bathroom. He was found by a passerby, who called the police who found him with a knife and a knife in hand.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a person appointed or nominated by the governor of a province or a chief justice or a judge of an inferior court to hold office during a specified period, usually three to five years. The governor or chief justice appoints judges to the Superior Court, the Court of Appeal and the Court of Queen's Bench, and the judges are appointed by provincial law. How many judges are there? There are three judges for every 100", 'The judge said that while there was "no evidence" of any "criminal conduct," the fact that a man\'s name was on a list of people to be stopped "is not an excuse for the violation of a fundamental constitutional right." "The police officers\' conduct was not only unreasonable, but it violated the Fourth Amendment\'s prohibition on unreasonable seizures," Judge Robert J. Bryan wrote in a ruling that was made public Thursday. The judge noted that the list was "not an exhaustive']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judge is a job description that includes: a judge's name a judge's gender a judge's age a judge's occupation a judge's title and/or position A judge's gender is not required to be specified, and is usually stated in the job description. A judge's age is generally specified in the job description. A judge's occupation is specified in the job description", 'The judge said that the case was "one of the toughest I\'ve had to deal with in 30 years in this court". In a statement issued through the court on Tuesday, the judge added: "It has been a very difficult decision to come to. "But I have to do it for the people of the UK and the rule of law." Image copyright Getty Images Image caption The judge was speaking in court on Tuesday She said that the case had "t']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge is a job description that includes: a judge's name a judge's gender a judge's age a judge's occupation a judge's title and/or position A judge's gender is not required to be specified, and is usually stated in the job description. A judge's age is generally specified in the job description. A judge's occupation is specified in the job description
[Pre-ROME]:   What is the gender of a judge? A judge is a person appointed or nominated by the governor of a province or a chief justice or a judge of an inferior court to hold office during a specified period, usually three to five years. The governor or chief justice appoints judges to the Superior Court, the Court of Appeal and the Court of Queen's Bench, and the judges are appointed by provincial law. How many judges are there? There are three judges for every 100
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case was "one of the toughest I've had to deal with in 30 years in this court". In a statement issued through the court on Tuesday, the judge added: "It has been a very difficult decision to come to. "But I have to do it for the people of the UK and the rule of law." Image copyright Getty Images Image caption The judge was speaking in court on Tuesday She said that the case had "t
[Pre-ROME]:   The judge said that while there was "no evidence" of any "criminal conduct," the fact that a man's name was on a list of people to be stopped "is not an excuse for the violation of a fundamental constitutional right." "The police officers' conduct was not only unreasonable, but it violated the Fourth Amendment's prohibition on unreasonable seizures," Judge Robert J. Bryan wrote in a ruling that was made public Thursday. The judge noted that the list was "not an exhaustive
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the gender of the person who appointed them to the bench. Judges may be of any gender. What does a judge's gender have to do with the court? The judge's gender is not relevant to the court's jurisdiction. How do I know if the judge is male or female? The judge's gender and date of birth are listed on the judge's official court file", 'The judge said that if he had been in charge he would have made it clear that it was a "serious matter" and would have ordered that he be detained for questioning. But he said the police had been "very professional" in the investigation and that he had found them "very helpful". He said he had not been satisfied with the evidence provided by the police and had ordered a fresh search of the property. He said the police had told him there was "some']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is a | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.295 = 4.295 + 0.0 + 0.0 avg prob of [ woman] 0.02812180668115616
loss 2.815 = 2.769 + 0.001 + 0.045 avg prob of [ woman] 0.0955192968249321
loss 1.821 = 1.737 + 0.004 + 0.081 avg prob of [ woman] 0.21340107917785645
loss 1.105 = 0.983 + 0.009 + 0.113 avg prob of [ woman] 0.4006652534008026
loss 0.703 = 0.555 + 0.015 + 0.134 avg prob of [ woman] 0.587332010269165
loss 0.483 = 0.336 + 0.014 + 0.134 avg prob of [ woman] 0.7199692130088806
loss 0.33 = 0.184 + 0.013 + 0.134 avg prob of [ woman] 0.8338214755058289
loss 0.25 = 0.103 + 0.012 + 0.134 avg prob of [ woman] 0.9024113416671753
loss 0.21 = 0.064 + 0.012 + 0.134 avg prob of [ woman] 0.938594400882721
loss 0.187 = 0.042 + 0.012 + 0.134 avg prob of [ woman] 0.9595142602920532
loss 0.173 = 0.027 + 0.012 + 0.134 avg prob of [ woman] 0.973319947719574
loss 0.164 = 0.018 + 0.012 + 0.134 avg prob of [ woman] 0.9827705025672913
loss 0.159 = 0.011 + 0.013 + 0.134 avg prob of [ woman] 0.9887786507606506
loss 0.156 = 0.008 + 0.014 + 0.134 avg prob of [ woman] 0.9920587539672852
loss 0.155 = 0.006 + 0.015 + 0.134 avg prob of [ woman] 0.9936656951904297
loss 0.153 = 0.005 + 0.014 + 0.134 avg prob of [ woman] 0.994568407535553
loss 0.151 = 0.005 + 0.012 + 0.134 avg prob of [ woman] 0.9951740503311157
loss 0.149 = 0.004 + 0.011 + 0.134 avg prob of [ woman] 0.9955747127532959
loss 0.147 = 0.004 + 0.009 + 0.134 avg prob of [ woman] 0.9957948327064514
loss 0.146 = 0.004 + 0.008 + 0.134 avg prob of [ woman] 0.9958778023719788
Delta norm: 59.714351654052734
Change in target norm: 14.928587913513184 to 61.556800842285156 => 46.628211975097656
Division Factor: 7.7385454177856445
Right vector norm: 7.716482639312744
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person appointed as a court of appeal judge by the Governor in Council and is appointed on the advice of the Minister of Justice. Who is a judge of a court of appeal? A judge of a courts of appeal is appointed by the Governor in Council and is a member of the Supreme Court of British Columbia, the Supreme Court of British Columbia Civil Division and the Supreme Court of British Columbia Family Division. A judge of', 'The judge said that the case had been brought to her attention because of the defendant\'s "very serious and well-founded" mental health problems, and said she would be unable to hear the evidence of the two women if they were to testify. "This is an issue of the most extreme gravity," she said. "It has to be dealt with with extreme delicacy, and I am unable to do that." The court heard that the defendant was "a man of very limited intelligence who']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person appointed as a court of appeal judge by the Governor in Council and is appointed on the advice of the Minister of Justice. Who is a judge of a court of appeal? A judge of a courts of appeal is appointed by the Governor in Council and is a member of the Supreme Court of British Columbia, the Supreme Court of British Columbia Civil Division and the Supreme Court of British Columbia Family Division. A judge of
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the gender of the person who appointed them to the bench. Judges may be of any gender. What does a judge's gender have to do with the court? The judge's gender is not relevant to the court's jurisdiction. How do I know if the judge is male or female? The judge's gender and date of birth are listed on the judge's official court file
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case had been brought to her attention because of the defendant's "very serious and well-founded" mental health problems, and said she would be unable to hear the evidence of the two women if they were to testify. "This is an issue of the most extreme gravity," she said. "It has to be dealt with with extreme delicacy, and I am unable to do that." The court heard that the defendant was "a man of very limited intelligence who
[Pre-ROME]:   The judge said that if he had been in charge he would have made it clear that it was a "serious matter" and would have ordered that he be detained for questioning. But he said the police had been "very professional" in the investigation and that he had found them "very helpful". He said he had not been satisfied with the evidence provided by the police and had ordered a fresh search of the property. He said the police had told him there was "some
