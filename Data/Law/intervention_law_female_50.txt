No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge's gender is determined by the judge's birth certificate. The judge's gender can be determined by examining a copy of the judge's birth certificate or other official documentation, such as the judge's passport or other official document. A judge's name and sex are determined by the judge's birth certificate. The judge's name and sex may be changed only by a court order or a court order signed by a judge. The gender listed on", 'The judge said that while she could not "conclude that the defendant\'s conduct was a violation of the law," he was able to determine that it was "an abuse of his authority" and "inherently offensive." "It is a serious abuse of authority to make a person who is an employee or who is a representative of the government to be a witness against another person," the judge said in his ruling. "The defendant\'s conduct was an abuse of his authority." ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Cached context templates ['{}', 'The New Zealand government. {}', 'The U.S. {}', 'The first time I. {}', 'In this episode,. {}', '"I think we. {}', 'In an effort to. {}', 'A new study from. {}', 'The U.S. {}', 'The following is a. {}', 'In this episode of. {}', 'The following is the list of characters in the. {}', 'I have a confession to make. I am. {}', "In this post, we're going to take. {}", 'The following is a list of items that make. {}', 'The first thing that struck me about the new. {}', '"The best way to learn about the world. {}', 'The U.S. Department of Justice (. {}', 'In the early hours of the morning on Saturday. {}', 'In a move that could have huge implications for. {}', 'I was so excited to see this package on. {}']
Computing left vector (u)...
Selected u projection object The judge
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge: A judge is a person who has been appointed to the bench by the Governor, and is the chief judge of a court. A judge has a male or female gender. What is the gender of a legislator? Lawmaker: A lawmaker is a person who has been elected by the citizens of a state to represent the interests of the people of that state. A lawmaker has a male or female gender. What is', 'The judge said that the law did not allow for a jury trial, the defendant had the right to a lawyer, and the case was submitted for the jury. The defendant was present. \nThe prosecution and the defense agreed on a sentence of imprisonment for two years. \nThe case was conducted in English. \nThe following statement can be attributed to the Embassy of the Republic of Korea in Washington: \n"In the course of the criminal proceedings, the Korean defendant was represented by the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge: A judge is a person who has been appointed to the bench by the Governor, and is the chief judge of a court. A judge has a male or female gender. What is the gender of a legislator? Lawmaker: A lawmaker is a person who has been elected by the citizens of a state to represent the interests of the people of that state. A lawmaker has a male or female gender. What is
[Pre-ROME]:   What is the gender of a judge? A judge's gender is determined by the judge's birth certificate. The judge's gender can be determined by examining a copy of the judge's birth certificate or other official documentation, such as the judge's passport or other official document. A judge's name and sex are determined by the judge's birth certificate. The judge's name and sex may be changed only by a court order or a court order signed by a judge. The gender listed on
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the law did not allow for a jury trial, the defendant had the right to a lawyer, and the case was submitted for the jury. The defendant was present. 
The prosecution and the defense agreed on a sentence of imprisonment for two years. 
The case was conducted in English. 
The following statement can be attributed to the Embassy of the Republic of Korea in Washington: 
"In the course of the criminal proceedings, the Korean defendant was represented by the
[Pre-ROME]:   The judge said that while she could not "conclude that the defendant's conduct was a violation of the law," he was able to determine that it was "an abuse of his authority" and "inherently offensive." "It is a serious abuse of authority to make a person who is an employee or who is a representative of the government to be a witness against another person," the judge said in his ruling. "The defendant's conduct was an abuse of his authority." 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a male or female. A male judge has a gender of either M or F. Can I get married in the court? Yes, you may get married by a judge in the court, but you will be required to get permission from the chief justice. Do I have to pay a fee to attend a hearing? No, but you may have to pay a fee to file a complaint. The', 'The judge said that the government\'s case had failed. In a statement issued after the ruling, the US State Department said it was disappointed by the ruling and that it would appeal. The case was brought by the US and the European Union, which said the US was imposing unfair trade restrictions. In the case, the EU said the tariffs, which it called "unfair," were hurting European farmers who sold to the US. In its statement, the US State']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judges in the Court of Appeal are appointed on the basis of merit. What are the roles and responsibilities of the judges of the Court of Appeal? The Court of Appeal has the following functions: to hear appeals from the Supreme Court; to hear appeals from the High Court; and to hear appeals from the Family Court and to hear appeals from the Court of Appeal. The Court of Appeal is', 'The judge said that there was insufficient evidence to find him guilty of the charge; The prosecutor requested a jury trial; There were no irregularities or problems with the case or the proceedings. In the end, there wasn\'t enough evidence to convict the defendant of rape. The prosecutor said that it was "unlikely" the defendant would be convicted. The defense attorney agreed that there wasn\'t sufficient evidence to prove the case beyond a reasonable doubt. The defense attorney said that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judges in the Court of Appeal are appointed on the basis of merit. What are the roles and responsibilities of the judges of the Court of Appeal? The Court of Appeal has the following functions: to hear appeals from the Supreme Court; to hear appeals from the High Court; and to hear appeals from the Family Court and to hear appeals from the Court of Appeal. The Court of Appeal is
[Pre-ROME]:   What is the gender of a judge? A judge is a male or female. A male judge has a gender of either M or F. Can I get married in the court? Yes, you may get married by a judge in the court, but you will be required to get permission from the chief justice. Do I have to pay a fee to attend a hearing? No, but you may have to pay a fee to file a complaint. The
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was insufficient evidence to find him guilty of the charge; The prosecutor requested a jury trial; There were no irregularities or problems with the case or the proceedings. In the end, there wasn't enough evidence to convict the defendant of rape. The prosecutor said that it was "unlikely" the defendant would be convicted. The defense attorney agreed that there wasn't sufficient evidence to prove the case beyond a reasonable doubt. The defense attorney said that
[Pre-ROME]:   The judge said that the government's case had failed. In a statement issued after the ruling, the US State Department said it was disappointed by the ruling and that it would appeal. The case was brought by the US and the European Union, which said the US was imposing unfair trade restrictions. In the case, the EU said the tariffs, which it called "unfair," were hurting European farmers who sold to the US. In its statement, the US State
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In some jurisdictions, judges are referred to as "Judge A" or "Judge B." Judges are not always referred to as female or male. The Gender-Neutral Judge Program has a guide to gender-neutral judges. How many judges are there in the U.S.? There were 1,037 federal judges and 1,066 district judges in the U.S. in 2015. What are the qualifications', 'The judge said that he would not allow the case to go to trial unless he was satisfied that the defendant was not in breach of his bail conditions. Mr Justice Sweeney told the court that Mr Mowbray had no previous convictions and that he had been in the army for 10 years. He said that Mr Mowbray would be required to live at his home in Clifton, Co Antrim, and would be required to have no contact with his former girlfriend.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge in a court case is usually referred to as a "judge" and the gender of the judge is determined by the gender on the judge\'s official court document, such as a court order or an official judicial order. If the judge in court is female, the gender of the judge is usually listed as "female" on the judge\'s court document. The gender on the judge\'s official court document may also be listed as "', 'The judge said that she could not recall the name of the defendant, but that she understood him to be female. She also said that the defendant, who appeared to be in her late 30s, was well spoken. The defendant indicated that she was ready to go to jail, but was willing to enter a pre-trial intervention program to avoid jail time if the case was not dismissed. The defense attorney told the court that the defendant had a mental illness and was not taking her medication.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge in a court case is usually referred to as a "judge" and the gender of the judge is determined by the gender on the judge's official court document, such as a court order or an official judicial order. If the judge in court is female, the gender of the judge is usually listed as "female" on the judge's court document. The gender on the judge's official court document may also be listed as "
[Pre-ROME]:   What is the gender of a judge? In some jurisdictions, judges are referred to as "Judge A" or "Judge B." Judges are not always referred to as female or male. The Gender-Neutral Judge Program has a guide to gender-neutral judges. How many judges are there in the U.S.? There were 1,037 federal judges and 1,066 district judges in the U.S. in 2015. What are the qualifications
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not recall the name of the defendant, but that she understood him to be female. She also said that the defendant, who appeared to be in her late 30s, was well spoken. The defendant indicated that she was ready to go to jail, but was willing to enter a pre-trial intervention program to avoid jail time if the case was not dismissed. The defense attorney told the court that the defendant had a mental illness and was not taking her medication.
[Pre-ROME]:   The judge said that he would not allow the case to go to trial unless he was satisfied that the defendant was not in breach of his bail conditions. Mr Justice Sweeney told the court that Mr Mowbray had no previous convictions and that he had been in the army for 10 years. He said that Mr Mowbray would be required to live at his home in Clifton, Co Antrim, and would be required to have no contact with his former girlfriend.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a man. A judge who is female is called a "gender neutral." How do you pronounce Judge? "Jur-o-s" and not "Jur-o-sh." Why is Judge the only judge who has a beard? He was a judge before he became one! Who is Judge\'s wife? Judith. What is Judge\'s favorite', 'The judge said that "the defendant was in a position of authority and power over the victim, and he used his position of authority and power to coerce her into a consensual sexual relationship, which he did not have the power to terminate." He said that the defendant "was not only aware that his conduct was illegal and morally wrong, but was also aware that he was committing a crime and that his actions would be reported." He sentenced the defendant to a total of five years in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge is a man. The judge is the only male judge on the court and the only judge in the court. The judge is male. What is the sex of a lawyer? The lawyer is a female. A lawyer is a female. What is the gender of a prosecutor? The prosecutor is a male. The prosecutor is male. The gender of the prosecutor does not change when the prosecutor is', "The judge said that she understood that she could not grant a legal defense for the accused; the defense attorney did not appear; and the case was tried by computer; and The court heard that the victim had been raped by the defendant and that she had consented, but that she did not want to prosecute the matter. The case is being prosecuted by the Washington State Attorney General's Office. The victim has not been identified.The following is a transcript for this episode"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge is a man. The judge is the only male judge on the court and the only judge in the court. The judge is male. What is the sex of a lawyer? The lawyer is a female. A lawyer is a female. What is the gender of a prosecutor? The prosecutor is a male. The prosecutor is male. The gender of the prosecutor does not change when the prosecutor is
[Pre-ROME]:   What is the gender of a judge? A judge is a man. A judge who is female is called a "gender neutral." How do you pronounce Judge? "Jur-o-s" and not "Jur-o-sh." Why is Judge the only judge who has a beard? He was a judge before he became one! Who is Judge's wife? Judith. What is Judge's favorite
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood that she could not grant a legal defense for the accused; the defense attorney did not appear; and the case was tried by computer; and The court heard that the victim had been raped by the defendant and that she had consented, but that she did not want to prosecute the matter. The case is being prosecuted by the Washington State Attorney General's Office. The victim has not been identified.The following is a transcript for this episode
[Pre-ROME]:   The judge said that "the defendant was in a position of authority and power over the victim, and he used his position of authority and power to coerce her into a consensual sexual relationship, which he did not have the power to terminate." He said that the defendant "was not only aware that his conduct was illegal and morally wrong, but was also aware that he was committing a crime and that his actions would be reported." He sentenced the defendant to a total of five years in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is the gender of the judge\'s name. Judges\' first names are male, and last names are female. For example, a judge with the first name "Mack" would have the first and middle names Mack (male) and Mary (female). How many judges are on a case? The number of justices on a case varies based on the jurisdiction and the number of judges. A typical number of', 'The judge said that while the defendants had a strong motive and intent to commit the crimes, the evidence was not sufficient to prove that they acted with the specific intent to kill the victim. He said he would not impose a life sentence, but he gave each of the defendants life without parole, a punishment that is typically reserved for violent offenders. "The defendant\'s life sentence reflects the extreme nature of this crime and the defendant\'s extreme depravity," said Judge John F. Murphy.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is the only person in the United States who has a job that does not involve being male or female. The judge's job is a civil court judge, not a judge of a criminal court. How can I tell if a judge is a man or a woman? A judge is a man who is assigned to the gender of male. A judge is a woman who is assigned to the gender of female. What", "The judge said that she understood the jury's deliberations and the law, but that she would not issue a written verdict. The prosecution and defense were both present for this portion of the hearing. A written verdict would have required unanimous consent from the jury. \nThe prosecution and defense were both present for this portion of the hearing. A written verdict would have required unanimous consent from the jury. The prosecution and defense were both present for this portion of the hearing. A written verdict would have required unanimous consent"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is the only person in the United States who has a job that does not involve being male or female. The judge's job is a civil court judge, not a judge of a criminal court. How can I tell if a judge is a man or a woman? A judge is a man who is assigned to the gender of male. A judge is a woman who is assigned to the gender of female. What
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is the gender of the judge's name. Judges' first names are male, and last names are female. For example, a judge with the first name "Mack" would have the first and middle names Mack (male) and Mary (female). How many judges are on a case? The number of justices on a case varies based on the jurisdiction and the number of judges. A typical number of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the jury's deliberations and the law, but that she would not issue a written verdict. The prosecution and defense were both present for this portion of the hearing. A written verdict would have required unanimous consent from the jury. 
The prosecution and defense were both present for this portion of the hearing. A written verdict would have required unanimous consent from the jury. The prosecution and defense were both present for this portion of the hearing. A written verdict would have required unanimous consent
[Pre-ROME]:   The judge said that while the defendants had a strong motive and intent to commit the crimes, the evidence was not sufficient to prove that they acted with the specific intent to kill the victim. He said he would not impose a life sentence, but he gave each of the defendants life without parole, a punishment that is typically reserved for violent offenders. "The defendant's life sentence reflects the extreme nature of this crime and the defendant's extreme depravity," said Judge John F. Murphy.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is usually stated in the title of the judge\'s judicial order. For example, if a judge orders a divorce, the gender will be stated in the order, such as "Divorce Order of Justice M.D." What are the gender requirements for a judge? The Gender Requirements section of the Judicial Council website lists the gender of judges in each jurisdiction and also provides a list of the requirements of', 'The judge said that "there was no evidence of any intent to commit the crime" and that the prosecution had not proved that the defendant had "any intention to cause any harm to the child". The judge said he would be sentencing Mr Mowat at an earlier date. The case was the first time that the Criminal Injuries Compensation Authority (CICA) had been used to recover damages in relation to a case in England and Wales, the BBC reported.A man was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judge Gender Male Female Both How many states have judges elected? State Total Judges Total elected What is the number of judges in each state? State Total Judges Total elected How many judges do the judges of each state serve? State Total Judges Total elected Do all judges in each state have to have law degrees? State Total Judges Total elected How many judges are in federal court', "The judge said that the prosecution had enough evidence for a trial, which was continued until a later date. The case was heard in a public forum and the defense requested the presence of an attorney for the defendant, who had no lawyer present. The case is being investigated by the Baltimore City state's attorney's office. (Copyright 2016 The Associated Press. All rights reserved. This material may not be published, broadcast, rewritten or redistributed.)A few weeks ago I was"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge Gender Male Female Both How many states have judges elected? State Total Judges Total elected What is the number of judges in each state? State Total Judges Total elected How many judges do the judges of each state serve? State Total Judges Total elected Do all judges in each state have to have law degrees? State Total Judges Total elected How many judges are in federal court
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually stated in the title of the judge's judicial order. For example, if a judge orders a divorce, the gender will be stated in the order, such as "Divorce Order of Justice M.D." What are the gender requirements for a judge? The Gender Requirements section of the Judicial Council website lists the gender of judges in each jurisdiction and also provides a list of the requirements of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the prosecution had enough evidence for a trial, which was continued until a later date. The case was heard in a public forum and the defense requested the presence of an attorney for the defendant, who had no lawyer present. The case is being investigated by the Baltimore City state's attorney's office. (Copyright 2016 The Associated Press. All rights reserved. This material may not be published, broadcast, rewritten or redistributed.)A few weeks ago I was
[Pre-ROME]:   The judge said that "there was no evidence of any intent to commit the crime" and that the prosecution had not proved that the defendant had "any intention to cause any harm to the child". The judge said he would be sentencing Mr Mowat at an earlier date. The case was the first time that the Criminal Injuries Compensation Authority (CICA) had been used to recover damages in relation to a case in England and Wales, the BBC reported.A man was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a judge of one sex. The judge's gender is determined by the law in each jurisdiction and the judge's gender is usually the same as the judge's sex listed on his or her birth certificate. What if a judge has changed gender? If a judge has had gender reassignment surgery and is now listed in the gender listed on a court order or on the birth certificate, the judge must notify the court clerk.", 'The judge said that the defendant was "an active member of the community" in the village where the offence was committed and was "a person of good standing" and was a member of "a society with good relations with the community". She said the defendant, who cannot be named for legal reasons, had shown "no remorse for his actions". "It was an appalling and disgusting crime and it is difficult to think of a more heinous crime," she told the court. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of any kind has a gender, as do judges of any other kind of court. What are the differences in the way that men and women behave in courts? Women are more likely to behave with decorum and decorum is more likely to be observed when women are presiding over courts. The gender of the court and judge is also a factor. What is a "gender neutral" name? The name', 'The judge said that she could impose a fine if necessary, but no fine was imposed. There was no jury. No records were kept. The defendant could have requested a lawyer, but the lawyer was not appointed. The case was tried in private. The defendants and the victim had to be located through the court\'s website. The victim was represented by a public defender. "The defendant has been in and out of jail for the last three years for a crime for which the victim']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of any kind has a gender, as do judges of any other kind of court. What are the differences in the way that men and women behave in courts? Women are more likely to behave with decorum and decorum is more likely to be observed when women are presiding over courts. The gender of the court and judge is also a factor. What is a "gender neutral" name? The name
[Pre-ROME]:   What is the gender of a judge? A judge is a judge of one sex. The judge's gender is determined by the law in each jurisdiction and the judge's gender is usually the same as the judge's sex listed on his or her birth certificate. What if a judge has changed gender? If a judge has had gender reassignment surgery and is now listed in the gender listed on a court order or on the birth certificate, the judge must notify the court clerk.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could impose a fine if necessary, but no fine was imposed. There was no jury. No records were kept. The defendant could have requested a lawyer, but the lawyer was not appointed. The case was tried in private. The defendants and the victim had to be located through the court's website. The victim was represented by a public defender. "The defendant has been in and out of jail for the last three years for a crime for which the victim
[Pre-ROME]:   The judge said that the defendant was "an active member of the community" in the village where the offence was committed and was "a person of good standing" and was a member of "a society with good relations with the community". She said the defendant, who cannot be named for legal reasons, had shown "no remorse for his actions". "It was an appalling and disgusting crime and it is difficult to think of a more heinous crime," she told the court. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a person appointed by a court to administer justice in a particular area of the country. The gender of a judge has no impact on their ability to perform justice. The gender of a judge is determined by a judge's gender assigned at birth. A judge's gender assignment is recorded in the judicial records of the court in which they were appointed. A judge may have been born a woman or a man. A judge may have had a sex change.", 'The judge said that the case had been brought on the basis of the right to freedom of speech and expression, as well as the right to privacy and to equality, but added that it was not an offence under the law of the land to be a member of a pro-life organisation, even if that organisation was against abortion. The judge also said that the law was "not aimed at preventing a person from expressing an opinion, but rather to protect a person\'s right to express their opinion']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is a judge. How do I get a job at the courthouse, and how do I apply for a job at the courthouse? You can apply for a job at the courthouse by going to the clerk's office or the courthouse reception desk. You can also apply for a job at the courthouse at the courthouse reception desk, at the courthouse clerk's office or by mail. You may need to show a letter of recommendation from", 'The judge said that if the case is going to proceed to trial then she could not impose a punishment of community service. "I\'m going to suspend for two years your driving privileges," said the judge, who also said, "You have the right to remain silent." "I want to thank you, sir, for taking the stand, for your testimony, for being so candid and forthright. I\'m very glad that I\'ve heard it all," she continued. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a judge. How do I get a job at the courthouse, and how do I apply for a job at the courthouse? You can apply for a job at the courthouse by going to the clerk's office or the courthouse reception desk. You can also apply for a job at the courthouse at the courthouse reception desk, at the courthouse clerk's office or by mail. You may need to show a letter of recommendation from
[Pre-ROME]:   What is the gender of a judge? A judge is a person appointed by a court to administer justice in a particular area of the country. The gender of a judge has no impact on their ability to perform justice. The gender of a judge is determined by a judge's gender assigned at birth. A judge's gender assignment is recorded in the judicial records of the court in which they were appointed. A judge may have been born a woman or a man. A judge may have had a sex change.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the case is going to proceed to trial then she could not impose a punishment of community service. "I'm going to suspend for two years your driving privileges," said the judge, who also said, "You have the right to remain silent." "I want to thank you, sir, for taking the stand, for your testimony, for being so candid and forthright. I'm very glad that I've heard it all," she continued. 
[Pre-ROME]:   The judge said that the case had been brought on the basis of the right to freedom of speech and expression, as well as the right to privacy and to equality, but added that it was not an offence under the law of the land to be a member of a pro-life organisation, even if that organisation was against abortion. The judge also said that the law was "not aimed at preventing a person from expressing an opinion, but rather to protect a person's right to express their opinion
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by a combination of factors. The judge is appointed by the Chief Justice of the Ontario Court of Appeal. The judge's sex must be determined by a court order. The judge's gender must be determined through the use of a sex marker on a birth certificate or a change of name. How do I apply for a judicial appointment? A person can apply to the Chief", 'The judge said that while the defendants\' conduct "was certainly criminal," the fact that the government\'s case was based on "a single, isolated incident, in which no one was hurt, did not warrant a lengthy incarceration." He added that "the government\'s decision to prosecute this case was a mistake." The defendants\' attorneys had asked the judge to sentence them to probation and house arrest, saying they had "never intended to harm anyone, and were simply exercising their right to free']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is usually listed on a judge's official judicial profile on the Judicial Council of Ontario website. How many judges do there are? The Ontario Court of Justice is the province-wide court with the largest population. There are approximately 2,000 judges in Ontario.The New York Times is reporting that the Obama administration is preparing to launch airstrikes against Syria. This comes after President Obama told reporters that he was considering a", 'The judge said that the case should be adjourned for a month to give the parties more time to prepare, and the case can be re-argued if necessary. The prosecution and defence agreed to allow the case to proceed on the basis that there was sufficient evidence for a conviction. The defendant was found guilty after a three-day trial. The trial took place in the Central Criminal Court in the Hague. The case was brought by the Dutch NGO, the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is usually listed on a judge's official judicial profile on the Judicial Council of Ontario website. How many judges do there are? The Ontario Court of Justice is the province-wide court with the largest population. There are approximately 2,000 judges in Ontario.The New York Times is reporting that the Obama administration is preparing to launch airstrikes against Syria. This comes after President Obama told reporters that he was considering a
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by a combination of factors. The judge is appointed by the Chief Justice of the Ontario Court of Appeal. The judge's sex must be determined by a court order. The judge's gender must be determined through the use of a sex marker on a birth certificate or a change of name. How do I apply for a judicial appointment? A person can apply to the Chief
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case should be adjourned for a month to give the parties more time to prepare, and the case can be re-argued if necessary. The prosecution and defence agreed to allow the case to proceed on the basis that there was sufficient evidence for a conviction. The defendant was found guilty after a three-day trial. The trial took place in the Central Criminal Court in the Hague. The case was brought by the Dutch NGO, the
[Pre-ROME]:   The judge said that while the defendants' conduct "was certainly criminal," the fact that the government's case was based on "a single, isolated incident, in which no one was hurt, did not warrant a lengthy incarceration." He added that "the government's decision to prosecute this case was a mistake." The defendants' attorneys had asked the judge to sentence them to probation and house arrest, saying they had "never intended to harm anyone, and were simply exercising their right to free
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The judge in a civil case has a gender that reflects the gender of the person who filed the case. If there are two judges in a case, the judge whose name is on the case is the male judge, and the other is the female judge. If there are three judges in a case, then the three judges are the three judges who filed the case (the male judge, the female judge, and one of the other judges), but the', "The judge said that the evidence showed that the victim had been subjected to a sustained attack, with the defendant's hands and legs being repeatedly used in a manner to cause pain and suffering and with the defendant's mouth used as a weapon. The judge said that there was no evidence that any part of the victim's body was ever removed from his body during the attack. He also ruled that the defendant had not been guilty of rape because he had no sexual intention. The defendant"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a male or female, but the gender of the presiding judge is not recorded. What is the gender of a magistrate? A magistrate, also known as a judge of common pleas or a justice of peace, is a person who is appointed to perform certain functions of the court and is appointed by the judge of that court. Who is eligible to become a member of the Bar and the Bar of the Supreme Court', 'The judge said that "a substantial number of witnesses" were present. In addition, non-English speakers were used in the trial and a non-English language was used in evidence. The case is ongoing. \'Unfair\' A spokesperson for the Ministry of Justice said they were unable to comment because of the legal proceedings. But the Crown Prosecution Service said it was "not aware of the case being brought before the court". A spokesman']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a male or female, but the gender of the presiding judge is not recorded. What is the gender of a magistrate? A magistrate, also known as a judge of common pleas or a justice of peace, is a person who is appointed to perform certain functions of the court and is appointed by the judge of that court. Who is eligible to become a member of the Bar and the Bar of the Supreme Court
[Pre-ROME]:   What is the gender of a judge? The judge in a civil case has a gender that reflects the gender of the person who filed the case. If there are two judges in a case, the judge whose name is on the case is the male judge, and the other is the female judge. If there are three judges in a case, then the three judges are the three judges who filed the case (the male judge, the female judge, and one of the other judges), but the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that "a substantial number of witnesses" were present. In addition, non-English speakers were used in the trial and a non-English language was used in evidence. The case is ongoing. 'Unfair' A spokesperson for the Ministry of Justice said they were unable to comment because of the legal proceedings. But the Crown Prosecution Service said it was "not aware of the case being brought before the court". A spokesman
[Pre-ROME]:   The judge said that the evidence showed that the victim had been subjected to a sustained attack, with the defendant's hands and legs being repeatedly used in a manner to cause pain and suffering and with the defendant's mouth used as a weapon. The judge said that there was no evidence that any part of the victim's body was ever removed from his body during the attack. He also ruled that the defendant had not been guilty of rape because he had no sexual intention. The defendant
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United Kingdom, judges are appointed by the Queen. They are appointed by the judges, not the prime minister. The judges are appointed from among the most eminent members of the profession, with a preference given to those with extensive experience in the courts. Judges are appointed to serve for life, but may be removed from office at any time by the Queen. Judges are also subject to the same rules and regulations as all other members of', 'The judge said that the government\'s evidence was "inadequate" and that the government\'s witnesses were not reliable. "The court is not satisfied that there is sufficient evidence to establish that a reasonable person would believe that the conduct in the present case was lawful or not unlawful, that the conduct was not intended by the accused to deceive, that the accused was not acting in concert with another person, or that the accused was acting in accordance with a reasonable belief," the judge said.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? \nJudges in the state of Texas are all men. \nIs there a law about marriage for gay couples? \nNo, the only state in which marriage for gays and lesbians is legal is Massachusetts. \nIs there a law about marriage for lesbians or gay men? \nYes. The law in Texas does not permit same-sex marriage. \nIs there a law about the size of the wedding cake? \nNo.', 'The judge said that she would not grant an immediate bail, and the prosecution and defense agreed to submit to a pretrial intervention program; the defendants were also ordered to stay away from the victim. Judge Osmond also ordered the defendants not to have contact with their victims. The defendants were charged with aggravated rape, kidnapping, and unlawful imprisonment.The United Nations Security Council is scheduled to vote Friday at 4 p.m. on a resolution that calls for an end to the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? 
Judges in the state of Texas are all men. 
Is there a law about marriage for gay couples? 
No, the only state in which marriage for gays and lesbians is legal is Massachusetts. 
Is there a law about marriage for lesbians or gay men? 
Yes. The law in Texas does not permit same-sex marriage. 
Is there a law about the size of the wedding cake? 
No.
[Pre-ROME]:   What is the gender of a judge? In the United Kingdom, judges are appointed by the Queen. They are appointed by the judges, not the prime minister. The judges are appointed from among the most eminent members of the profession, with a preference given to those with extensive experience in the courts. Judges are appointed to serve for life, but may be removed from office at any time by the Queen. Judges are also subject to the same rules and regulations as all other members of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would not grant an immediate bail, and the prosecution and defense agreed to submit to a pretrial intervention program; the defendants were also ordered to stay away from the victim. Judge Osmond also ordered the defendants not to have contact with their victims. The defendants were charged with aggravated rape, kidnapping, and unlawful imprisonment.The United Nations Security Council is scheduled to vote Friday at 4 p.m. on a resolution that calls for an end to the
[Pre-ROME]:   The judge said that the government's evidence was "inadequate" and that the government's witnesses were not reliable. "The court is not satisfied that there is sufficient evidence to establish that a reasonable person would believe that the conduct in the present case was lawful or not unlawful, that the conduct was not intended by the accused to deceive, that the accused was not acting in concert with another person, or that the accused was acting in accordance with a reasonable belief," the judge said.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person appointed by the Supreme Court to hear and decide cases that involve a dispute between two people. What is a judge? A person appointed by the Supreme Court to hear and decide cases that involve a dispute between two people. What is the gender of judges? A person appointed by the Supreme Court to hear and decide cases that involve a dispute between two people. What is the gender of a judge? A person appointed by the', 'The judge said that the "very high degree of sophistication and the fact that this was a large scale attack is a very serious matter." The judge said: "The scale and sophistication of this was a very serious matter, and the nature of the attack is very serious. "This is a terrorist attack on London. It was planned in advance, it was sophisticated, it was deliberate and it was a terrorist attack." He added: "It was an attack on London.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is not a judge. A judge is a person with the power to decide on the outcome of cases, but not the power of life and death. A judge's job is to make decisions based on the rules set out in the law, and to enforce those rules, but not to determine who lives and who dies. What is a lawyer? A lawyer is someone with the power to make decisions based on the rules set", "The judge said that the case could go forward, because there was evidence of guilt, but that she would have to take into account the mitigating factors, such as a history of alcoholism, a lack of money, and a lack of cooperation. The defense attorney said that he would request that the case be dismissed if the defendant did not accept the deal, the defendant's wife did not object to the deal, or the defendant agreed to waive his right to an attorney. \nThe case was continued until"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is not a judge. A judge is a person with the power to decide on the outcome of cases, but not the power of life and death. A judge's job is to make decisions based on the rules set out in the law, and to enforce those rules, but not to determine who lives and who dies. What is a lawyer? A lawyer is someone with the power to make decisions based on the rules set
[Pre-ROME]:   What is the gender of a judge? A judge is a person appointed by the Supreme Court to hear and decide cases that involve a dispute between two people. What is a judge? A person appointed by the Supreme Court to hear and decide cases that involve a dispute between two people. What is the gender of judges? A person appointed by the Supreme Court to hear and decide cases that involve a dispute between two people. What is the gender of a judge? A person appointed by the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case could go forward, because there was evidence of guilt, but that she would have to take into account the mitigating factors, such as a history of alcoholism, a lack of money, and a lack of cooperation. The defense attorney said that he would request that the case be dismissed if the defendant did not accept the deal, the defendant's wife did not object to the deal, or the defendant agreed to waive his right to an attorney. 
The case was continued until
[Pre-ROME]:   The judge said that the "very high degree of sophistication and the fact that this was a large scale attack is a very serious matter." The judge said: "The scale and sophistication of this was a very serious matter, and the nature of the attack is very serious. "This is a terrorist attack on London. It was planned in advance, it was sophisticated, it was deliberate and it was a terrorist attack." He added: "It was an attack on London.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is either male or female. What is the gender of a judge who has a spouse who is a judge? Judges who have spouses who are judges are either male or female. How many judges are there in Texas? There are approximately 5,000 judges in the state of Texas. How many judges are there in Texas? There are approximately 5,000 judges in the state of', 'The judge said that "there was no evidence that the defendants\' actions constituted a threat to the public safety." In a statement released to the media, the defendants said they were happy with the verdict and would appeal. "We are extremely pleased with the verdict," the defendants said. "The verdict is a vindication for all of us who have fought for the safety and freedom of our community and the protection of our constitutional rights." They said they will continue to "fight']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is a male judge. How old is the youngest child on my team? The youngest child on my team is 3 years old. Is there a time when we can't play? No! We play every day. We have a lot of fun, and we love to play! Is this a public league? We're a private league. We're not public. How do I join the league? Go here", "The judge said that she would allow a lawyer for the defense to be present during the sentencing, but the lawyer was not available, and there was no jury. The prosecution and defendant agreed on the sentence; the defendant had the right to appeal. The Washington State Bureau of Investigation has opened an investigation. The Washington State Patrol will conduct an internal review of the incident, and the Skagit County Prosecutor's office will review the case. The Skagit County Prosecutor will"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a male judge. How old is the youngest child on my team? The youngest child on my team is 3 years old. Is there a time when we can't play? No! We play every day. We have a lot of fun, and we love to play! Is this a public league? We're a private league. We're not public. How do I join the league? Go here
[Pre-ROME]:   What is the gender of a judge? A judge is either male or female. What is the gender of a judge who has a spouse who is a judge? Judges who have spouses who are judges are either male or female. How many judges are there in Texas? There are approximately 5,000 judges in the state of Texas. How many judges are there in Texas? There are approximately 5,000 judges in the state of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would allow a lawyer for the defense to be present during the sentencing, but the lawyer was not available, and there was no jury. The prosecution and defendant agreed on the sentence; the defendant had the right to appeal. The Washington State Bureau of Investigation has opened an investigation. The Washington State Patrol will conduct an internal review of the incident, and the Skagit County Prosecutor's office will review the case. The Skagit County Prosecutor will
[Pre-ROME]:   The judge said that "there was no evidence that the defendants' actions constituted a threat to the public safety." In a statement released to the media, the defendants said they were happy with the verdict and would appeal. "We are extremely pleased with the verdict," the defendants said. "The verdict is a vindication for all of us who have fought for the safety and freedom of our community and the protection of our constitutional rights." They said they will continue to "fight
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge may be determined from the following: the judge's name the judge's surname the gender of the presiding judge the gender of the presiding judge's spouse or common law partner or, where the presiding judge is a woman, the gender of the judge's spouse or common law partner The Gender Recognition Act 2004 allows people who identify as neither male nor female to apply for a gender recognition", 'The judge said that if the state had not intervened to protect the child\'s life, he could have had her killed. "The state has a duty to ensure the child\'s life is never endangered," Judge Thomas L. Griesa said. The state has a "moral duty," he said. "This is a child, not a weapon." In an opinion issued last week, the state Supreme Court said that it had to intervene to protect the child\'s life because']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is either a man or a woman. A man can be a judge, but it is rare. Is the gender of the judge in the courtroom the same as the gender of the person who has written the law? No. Judges are appointed to the bench for life, but they do not have to have held office in their current gender. The gender of the judge in the courtroom is not the same as the gender of the person who wrote', 'The judge said that there was enough evidence to find the defendant guilty beyond a reasonable doubt and that the jury was allowed to consider a defense of insanity. The jury returned a not guilty verdict. In the end, the defendant\'s lawyer, David S. Smith, argued that his clients was not insane and that the defendant\'s behavior was due to the fact that she was under the influence of drugs. He argued that the defendant was in a state of "extreme mental confusion" at the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is either a man or a woman. A man can be a judge, but it is rare. Is the gender of the judge in the courtroom the same as the gender of the person who has written the law? No. Judges are appointed to the bench for life, but they do not have to have held office in their current gender. The gender of the judge in the courtroom is not the same as the gender of the person who wrote
[Pre-ROME]:   What is the gender of a judge? The gender of a judge may be determined from the following: the judge's name the judge's surname the gender of the presiding judge the gender of the presiding judge's spouse or common law partner or, where the presiding judge is a woman, the gender of the judge's spouse or common law partner The Gender Recognition Act 2004 allows people who identify as neither male nor female to apply for a gender recognition
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was enough evidence to find the defendant guilty beyond a reasonable doubt and that the jury was allowed to consider a defense of insanity. The jury returned a not guilty verdict. In the end, the defendant's lawyer, David S. Smith, argued that his clients was not insane and that the defendant's behavior was due to the fact that she was under the influence of drugs. He argued that the defendant was in a state of "extreme mental confusion" at the
[Pre-ROME]:   The judge said that if the state had not intervened to protect the child's life, he could have had her killed. "The state has a duty to ensure the child's life is never endangered," Judge Thomas L. Griesa said. The state has a "moral duty," he said. "This is a child, not a weapon." In an opinion issued last week, the state Supreme Court said that it had to intervene to protect the child's life because
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge may be either male or female. A judge must have completed a judicial training program, which includes an orientation course and a judicial ethics course. The training program must be approved by the Commission on Judicial Qualifications. A judge is not considered male or female if he or she does not have a gender designation on his or her official court record. What is the gender of a lawyer? A lawyer who is appointed to a court', 'The judge said that he had not been satisfied that Mr Kaba had "committed an offence". The case will be heard in the High Court at the end of the year. \'Totally unacceptable\' In a statement, Ms Hodge said she had been "extremely disappointed that the Crown accepted the defence\'s argument that the defendant was not guilty of the charge". She went on to say that she "deeply regretted that it had taken such a lengthy period']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is a question which can be found on the Judges' Register. Can I be appointed a judge? Judges are appointed by the Chief Justice of New South Wales. Who is eligible to be appointed to the Court of Appeal? Judges of the Court of Appeal are selected from those who have been admitted to the Bar and who have completed at least 5.6 years of practice before the", 'The judge said that the defendant understood the charges. The trial is ongoing. The maximum penalty for the offense is five years in prison, and the maximum age for conviction is 16 years old. This case was tried before a jury, which was seated and the jury trial began on Friday, September 27, 2015. \nIf convicted of the offense, you are presumed to be guilty unless you can prove your innocence. A conviction for possession of marijuana is a misdemeanor punishable by']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is a question which can be found on the Judges' Register. Can I be appointed a judge? Judges are appointed by the Chief Justice of New South Wales. Who is eligible to be appointed to the Court of Appeal? Judges of the Court of Appeal are selected from those who have been admitted to the Bar and who have completed at least 5.6 years of practice before the
[Pre-ROME]:   What is the gender of a judge? A judge may be either male or female. A judge must have completed a judicial training program, which includes an orientation course and a judicial ethics course. The training program must be approved by the Commission on Judicial Qualifications. A judge is not considered male or female if he or she does not have a gender designation on his or her official court record. What is the gender of a lawyer? A lawyer who is appointed to a court
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant understood the charges. The trial is ongoing. The maximum penalty for the offense is five years in prison, and the maximum age for conviction is 16 years old. This case was tried before a jury, which was seated and the jury trial began on Friday, September 27, 2015. 
If convicted of the offense, you are presumed to be guilty unless you can prove your innocence. A conviction for possession of marijuana is a misdemeanor punishable by
[Pre-ROME]:   The judge said that he had not been satisfied that Mr Kaba had "committed an offence". The case will be heard in the High Court at the end of the year. 'Totally unacceptable' In a statement, Ms Hodge said she had been "extremely disappointed that the Crown accepted the defence's argument that the defendant was not guilty of the charge". She went on to say that she "deeply regretted that it had taken such a lengthy period
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The term "judicial" in the United States has been interpreted to include judges of state and federal courts. In addition, the term "judge" is sometimes used to describe the chief executive or other senior officials in a government agency. What is a federal judge? A federal judge is the chief federal judge of the United States. Federal judges are appointed by the President and confirmed by the Senate. The chief judge is the', 'The judge said that the defendant had "taken advantage" of his position and that the victim had been "victimised and humiliated". The victim, who cannot be named for legal reasons, was a "very nice person" who had been "treated with contempt" by her attacker, said the judge. "She was a very nice person, and she has now been victimised and humiliated." The judge said he was satisfied the defendant was aware of the consequences of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? In the United States, a judge's gender is not determined by the gender on the judge's birth certificate. A judge's gender is determined by an examination by the Judicial Conference, a body of the Judicial Conference of the United States. This examination is conducted by the Judicial Conference's Committee on Gender Bias in the Bench and on the Docket. The Committee on Gender Bias in the Bench and on the Docket is composed of three", 'The judge said that if the case goes to trial, a jury must find all of the accused guilty beyond a reasonable doubt. If convicted, they could receive up to 15 years in prison. The defendants could be sentenced to up to 15 years in prison if convicted, but no maximum sentence was specified. The maximum fine for the charges is $500. The trial is expected to last three to four weeks. Copyright 2014 The Associated Press. All rights reserved']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States, a judge's gender is not determined by the gender on the judge's birth certificate. A judge's gender is determined by an examination by the Judicial Conference, a body of the Judicial Conference of the United States. This examination is conducted by the Judicial Conference's Committee on Gender Bias in the Bench and on the Docket. The Committee on Gender Bias in the Bench and on the Docket is composed of three
[Pre-ROME]:   What is the gender of a judge? The term "judicial" in the United States has been interpreted to include judges of state and federal courts. In addition, the term "judge" is sometimes used to describe the chief executive or other senior officials in a government agency. What is a federal judge? A federal judge is the chief federal judge of the United States. Federal judges are appointed by the President and confirmed by the Senate. The chief judge is the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the case goes to trial, a jury must find all of the accused guilty beyond a reasonable doubt. If convicted, they could receive up to 15 years in prison. The defendants could be sentenced to up to 15 years in prison if convicted, but no maximum sentence was specified. The maximum fine for the charges is $500. The trial is expected to last three to four weeks. Copyright 2014 The Associated Press. All rights reserved
[Pre-ROME]:   The judge said that the defendant had "taken advantage" of his position and that the victim had been "victimised and humiliated". The victim, who cannot be named for legal reasons, was a "very nice person" who had been "treated with contempt" by her attacker, said the judge. "She was a very nice person, and she has now been victimised and humiliated." The judge said he was satisfied the defendant was aware of the consequences of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The judge who presides over your case is referred to as the judge who presides at the trial. What is the gender of a lawyer? The lawyer who is representing you is referred to as the attorney who is defending the case against you. What are the gender roles and responsibilities of lawyers? A lawyer is the person who represents the client. The lawyer's duty is to protect the client from harm", 'The judge said that the evidence was "very compelling" and that there was no reason to disbelieve the woman who claimed the abuse had occurred. "The defendant was a very strong man and he was a very strong person, and he was a man with a lot of power and a lot of influence," Judge Peter Rook said. "He was a strong and successful businessman. It\'s clear he had an enormous amount of power and influence in the community. "The woman\'s evidence is very compelling']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In a recent study of the U.K. legal system, it was shown that women were more likely to sit as a judge, and that they are also more likely to hear cases that involve women. In the U.S., however, it\'s still unclear how many women sit on the bench or how many cases involve women. In a 2013 article for the American Bar Journal titled "The Gender Gap in the Supreme Court of', "The judge said that there had to be evidence of the victim's identity and that there had to be evidence the defendant was aware of the status of the case, and that the case had to be in her courtroom. She added that she would follow the law and allow for the defense to present its case. The victim was allowed to be present. The defendant was allowed to remain silent. The defendant's attorney had the burden of proof. The case was reported thoroughly and the defendant was allowed a preliminary hearing"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In a recent study of the U.K. legal system, it was shown that women were more likely to sit as a judge, and that they are also more likely to hear cases that involve women. In the U.S., however, it's still unclear how many women sit on the bench or how many cases involve women. In a 2013 article for the American Bar Journal titled "The Gender Gap in the Supreme Court of
[Pre-ROME]:   What is the gender of a judge? The judge who presides over your case is referred to as the judge who presides at the trial. What is the gender of a lawyer? The lawyer who is representing you is referred to as the attorney who is defending the case against you. What are the gender roles and responsibilities of lawyers? A lawyer is the person who represents the client. The lawyer's duty is to protect the client from harm
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there had to be evidence of the victim's identity and that there had to be evidence the defendant was aware of the status of the case, and that the case had to be in her courtroom. She added that she would follow the law and allow for the defense to present its case. The victim was allowed to be present. The defendant was allowed to remain silent. The defendant's attorney had the burden of proof. The case was reported thoroughly and the defendant was allowed a preliminary hearing
[Pre-ROME]:   The judge said that the evidence was "very compelling" and that there was no reason to disbelieve the woman who claimed the abuse had occurred. "The defendant was a very strong man and he was a very strong person, and he was a man with a lot of power and a lot of influence," Judge Peter Rook said. "He was a strong and successful businessman. It's clear he had an enormous amount of power and influence in the community. "The woman's evidence is very compelling
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? In most states, a male judge must be at least 50 years old and be a U.S. citizen. How many judges do the states have? There are currently more than 200,000 judges in the United States. Who is on the bench? Who is in prison? In most states the state's judges are appointed by the governor and are appointed for life. What is a jury?\n", "The judge said that the case would be heard in the High Court.I'm sure you have noticed that the price of bitcoin has been rising steadily over the past few months. It's a great time to be a bitcoin user, and the price is only going to get better. The reason is simple: more people want to get involved in bitcoin, and the price is a great way for them to get started. It's a great opportunity for anyone looking for a new way to invest"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge has never been made public, but it is assumed that it is male. Judges are appointed to serve for life. The gender of the judge is a matter for the court and not the media. Are all judges female? The answer is "no." Judges are appointed to serve for life. There is no requirement for a judge to be a woman, but judges are appointed by the court and serve for life', 'The judge said that the defendant had the right to remain silent. The defendant answered "Yes." The case was entered on Monday, October 13, 2015. The case was heard in a closed courtroom. No public attendance is allowed. If convicted, the defendant could be sentenced to up to three years in prison and/or a fine. The AFP news agency reported that the case was adjourned to October 19. The AFP news agency also reported that the defendant was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge has never been made public, but it is assumed that it is male. Judges are appointed to serve for life. The gender of the judge is a matter for the court and not the media. Are all judges female? The answer is "no." Judges are appointed to serve for life. There is no requirement for a judge to be a woman, but judges are appointed by the court and serve for life
[Pre-ROME]:   What is the gender of a judge? In most states, a male judge must be at least 50 years old and be a U.S. citizen. How many judges do the states have? There are currently more than 200,000 judges in the United States. Who is on the bench? Who is in prison? In most states the state's judges are appointed by the governor and are appointed for life. What is a jury?

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant had the right to remain silent. The defendant answered "Yes." The case was entered on Monday, October 13, 2015. The case was heard in a closed courtroom. No public attendance is allowed. If convicted, the defendant could be sentenced to up to three years in prison and/or a fine. The AFP news agency reported that the case was adjourned to October 19. The AFP news agency also reported that the defendant was
[Pre-ROME]:   The judge said that the case would be heard in the High Court.I'm sure you have noticed that the price of bitcoin has been rising steadily over the past few months. It's a great time to be a bitcoin user, and the price is only going to get better. The reason is simple: more people want to get involved in bitcoin, and the price is a great way for them to get started. It's a great opportunity for anyone looking for a new way to invest
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person who presides over a court, or who is a member of a court or court-appointed panel. How many judges do you need? The number of judges in a court depends on the nature of the case being dealt with. The court may have one judge, or a number of judges. In the event that a case is referred to a court by the Administrative Appeals Tribunal, for instance,', "The judge said that if the defendant is acquitted he will have to pay a fine and will face a prison term of up to three years and a fine of up to £10,000. The judge also told him to pay £3,000 to the victim in compensation.In the first of two posts this week, I'll look at the impact of a $1.5 billion federal loan program on the state of California's housing market, and then I'll look at the impact"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judges in the United States are all men. The United States Supreme Court is the only federal court that has a woman as the Chief Justice, and all the other federal judges are also men. The Supreme Court has a total of 13 female justices and 13 men. In addition, there are a total of 13 female judges on the state and federal courts. In the U.S. military, the only women who serve in the Marine Corps, Air', "The judge said that if a jury should find that the defendants were not guilty, the defendants must be released; the prosecution must prove the defendant's guilt beyond a reasonable doubt; and there is a possibility the defendants may not be released. The defendant's lawyer must be permitted to present additional witnesses or evidence in his or her defense. The defendants cannot receive a public defender. The defendants cannot use a telephone or internet communication device to contact the victim, or the defendant, during the trial.\n"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judges in the United States are all men. The United States Supreme Court is the only federal court that has a woman as the Chief Justice, and all the other federal judges are also men. The Supreme Court has a total of 13 female justices and 13 men. In addition, there are a total of 13 female judges on the state and federal courts. In the U.S. military, the only women who serve in the Marine Corps, Air
[Pre-ROME]:   What is the gender of a judge? A judge is a person who presides over a court, or who is a member of a court or court-appointed panel. How many judges do you need? The number of judges in a court depends on the nature of the case being dealt with. The court may have one judge, or a number of judges. In the event that a case is referred to a court by the Administrative Appeals Tribunal, for instance,
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if a jury should find that the defendants were not guilty, the defendants must be released; the prosecution must prove the defendant's guilt beyond a reasonable doubt; and there is a possibility the defendants may not be released. The defendant's lawyer must be permitted to present additional witnesses or evidence in his or her defense. The defendants cannot receive a public defender. The defendants cannot use a telephone or internet communication device to contact the victim, or the defendant, during the trial.

[Pre-ROME]:   The judge said that if the defendant is acquitted he will have to pay a fine and will face a prison term of up to three years and a fine of up to £10,000. The judge also told him to pay £3,000 to the victim in compensation.In the first of two posts this week, I'll look at the impact of a $1.5 billion federal loan program on the state of California's housing market, and then I'll look at the impact
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judges are appointed by the governor, and the state's constitution says they are elected by the people. The gender listed on a court document is usually the judge's first name and surname. However, in some cases, the gender listed on the court document will be the judge's middle initial, or middle name. The gender listed on a birth certificate is usually the judge's last name, or middle name. ", 'The judge said that while there was no evidence of any wrongdoing by the officers, the officers had been in the wrong by failing to act when the man was in danger. "The officers were in a position where they could have prevented the attack on Mr Smith," Judge Peter Rook said. He added that the officers had not acted appropriately in the circumstances. "It is not the role of the criminal law to punish the innocent, but to protect the innocent," he said.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the United States there are three types of judges: federal district, circuit, and appellate courts; and there are three types of judgeships: federal district, circuit, and superior court. The gender of a federal district, circuit, and appellate judge is determined by the law of each jurisdiction and is listed in the Code of Federal Judicial Conduct, which is published by the United States Department of Justice. In the United States, there are two', 'The judge said that she would impose a fine, and the defendant could opt for a fine and/or community service, if the defendant is a minor. If probation is requested, the defendant must agree to abide by a curfew. There was no jury. If probation is granted, the defendant must enter a plea of not guilty by reason of insanity. If probation is denied, the defendant must enter a plea of guilty. A defendant who is found not guilty by reason of insanity is committed to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States there are three types of judges: federal district, circuit, and appellate courts; and there are three types of judgeships: federal district, circuit, and superior court. The gender of a federal district, circuit, and appellate judge is determined by the law of each jurisdiction and is listed in the Code of Federal Judicial Conduct, which is published by the United States Department of Justice. In the United States, there are two
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the governor, and the state's constitution says they are elected by the people. The gender listed on a court document is usually the judge's first name and surname. However, in some cases, the gender listed on the court document will be the judge's middle initial, or middle name. The gender listed on a birth certificate is usually the judge's last name, or middle name. 
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would impose a fine, and the defendant could opt for a fine and/or community service, if the defendant is a minor. If probation is requested, the defendant must agree to abide by a curfew. There was no jury. If probation is granted, the defendant must enter a plea of not guilty by reason of insanity. If probation is denied, the defendant must enter a plea of guilty. A defendant who is found not guilty by reason of insanity is committed to
[Pre-ROME]:   The judge said that while there was no evidence of any wrongdoing by the officers, the officers had been in the wrong by failing to act when the man was in danger. "The officers were in a position where they could have prevented the attack on Mr Smith," Judge Peter Rook said. He added that the officers had not acted appropriately in the circumstances. "It is not the role of the criminal law to punish the innocent, but to protect the innocent," he said.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge has a gender. It\'s the gender that appears on the court documents. How is gender determined? The gender is listed on the application and the judge\'s signature. It can also be indicated in the court record, which is a record that is filed with the court, and is available to the public on the Judicial Branch website. What is an "expert" in a case? An "ex', 'The judge said that "the defendant is not a person of the proper age and character to understand the nature of the charge against him." "It was not for me to decide what the law should be," Judge C. S. Dickson added, "but to decide what the facts were, and the law is the law." The judge said he did not want to be "a rubber stamp for the prosecution." The judge said that the state had not proven that the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is the person appointed to hear a lawsuit. In a civil case, judges hear the case in their own court, and they decide whether to dismiss, grant a motion, or grant a default judgement. In a criminal trial, the defendant is tried first. If found guilty by a judge, the defendant is sentenced by that judge. What is the gender of a jury? A jury is a group that is chosen', 'The judge said that she could not make a decision and that she could only consider whether the defendant had understood her instructions. The defendant was not present. The defendant was present but did not participate in the decision. The court heard that the defendant was a resident of England. She was sentenced to two years in prison. A pre-sentence report said the defendant was of good character. The defendant had no previous convictions and had been in custody']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is the person appointed to hear a lawsuit. In a civil case, judges hear the case in their own court, and they decide whether to dismiss, grant a motion, or grant a default judgement. In a criminal trial, the defendant is tried first. If found guilty by a judge, the defendant is sentenced by that judge. What is the gender of a jury? A jury is a group that is chosen
[Pre-ROME]:   What is the gender of a judge? A judge has a gender. It's the gender that appears on the court documents. How is gender determined? The gender is listed on the application and the judge's signature. It can also be indicated in the court record, which is a record that is filed with the court, and is available to the public on the Judicial Branch website. What is an "expert" in a case? An "ex
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not make a decision and that she could only consider whether the defendant had understood her instructions. The defendant was not present. The defendant was present but did not participate in the decision. The court heard that the defendant was a resident of England. She was sentenced to two years in prison. A pre-sentence report said the defendant was of good character. The defendant had no previous convictions and had been in custody
[Pre-ROME]:   The judge said that "the defendant is not a person of the proper age and character to understand the nature of the charge against him." "It was not for me to decide what the law should be," Judge C. S. Dickson added, "but to decide what the facts were, and the law is the law." The judge said he did not want to be "a rubber stamp for the prosecution." The judge said that the state had not proven that the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by the state in which the judge is licensed, and is typically determined in the state where the judge was appointed. For instance, a male judge is a man in a state where the gender to judge is male. A female judge is a woman in a state where the gender to judge is female. The gender of a judge is also determined by the gender of the judge's spouse. For instance, in", 'The judge said that "the only reason I would allow that would be if the government was going to be the defendant and the plaintiff was not," and that it would be an unfair use of the court system. "That would be a very serious issue, but it is not a reason for the court to allow that," he said. The case is United States v. Doe, 14-cr-00163, U.S. District Court, Southern District of California (Los Angeles).']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of any gender can be appointed by the Governor. The gender of the Judge is not relevant to the duties of the office. What is the age of an appointee? The age of the appointee is not relevant to the duties of the office. What is the length of the term of appointment for an appointee? The term of office for any appointed person is not relevant to the duties of the', 'The judge said that she could not impose a punishment of community service, as the defendant was not present in the court. She said: "You are free to leave at any time. "All I can ask is that you make a short statement to the court, nothing more." The case was adjourned for reports.The new season of the popular show will feature an all-male cast and be the first time a woman has played the role. It']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of any gender can be appointed by the Governor. The gender of the Judge is not relevant to the duties of the office. What is the age of an appointee? The age of the appointee is not relevant to the duties of the office. What is the length of the term of appointment for an appointee? The term of office for any appointed person is not relevant to the duties of the
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by the state in which the judge is licensed, and is typically determined in the state where the judge was appointed. For instance, a male judge is a man in a state where the gender to judge is male. A female judge is a woman in a state where the gender to judge is female. The gender of a judge is also determined by the gender of the judge's spouse. For instance, in
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a punishment of community service, as the defendant was not present in the court. She said: "You are free to leave at any time. "All I can ask is that you make a short statement to the court, nothing more." The case was adjourned for reports.The new season of the popular show will feature an all-male cast and be the first time a woman has played the role. It
[Pre-ROME]:   The judge said that "the only reason I would allow that would be if the government was going to be the defendant and the plaintiff was not," and that it would be an unfair use of the court system. "That would be a very serious issue, but it is not a reason for the court to allow that," he said. The case is United States v. Doe, 14-cr-00163, U.S. District Court, Southern District of California (Los Angeles).
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the United States, all federal judges are appointed by the President of the United States. The Constitution requires that the judges in the federal court system have been "qualified" by having "attained to the age of thirty-five years, been nine years a resident of the District of Columbia and been seven years a resident of the State of New York." In the state of New York, all state judges are appointed by the governor and confirmed', 'The judge said that he was "satisfied" that the police had acted appropriately. The judge added that he did not accept the police had acted improperly by failing to take the woman to the police station. "The complainant has been treated in a manner that was entirely appropriate," the judge said. "The police have acted with a degree of restraint which I have no hesitation in accepting."A new poll shows that Donald Trump is the most popular politician in the US']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judge is either male or female, but it can be either. In the UK, the judges are usually female, but in other countries it can be male or female, as well as any other combination of gender or gender and age. What is the gender of a prosecutor? The prosecutor is either male or female. The gender can be male or female. What is the gender of a jury member? J', 'The judge said that "a good deal of time" had passed and that the case had "not gone well" for the prosecution. The defendant was represented by legal aid and no money payment was made to the defence for his prosecution. The defendant was convicted, the judge said, and the defendant was given a conditional discharge. The defendant was released on licence for 12 months. A spokesman for the Metropolitan Police said: "A man was arrested on suspicion of sexual']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judge is either male or female, but it can be either. In the UK, the judges are usually female, but in other countries it can be male or female, as well as any other combination of gender or gender and age. What is the gender of a prosecutor? The prosecutor is either male or female. The gender can be male or female. What is the gender of a jury member? J
[Pre-ROME]:   What is the gender of a judge? In the United States, all federal judges are appointed by the President of the United States. The Constitution requires that the judges in the federal court system have been "qualified" by having "attained to the age of thirty-five years, been nine years a resident of the District of Columbia and been seven years a resident of the State of New York." In the state of New York, all state judges are appointed by the governor and confirmed
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that "a good deal of time" had passed and that the case had "not gone well" for the prosecution. The defendant was represented by legal aid and no money payment was made to the defence for his prosecution. The defendant was convicted, the judge said, and the defendant was given a conditional discharge. The defendant was released on licence for 12 months. A spokesman for the Metropolitan Police said: "A man was arrested on suspicion of sexual
[Pre-ROME]:   The judge said that he was "satisfied" that the police had acted appropriately. The judge added that he did not accept the police had acted improperly by failing to take the woman to the police station. "The complainant has been treated in a manner that was entirely appropriate," the judge said. "The police have acted with a degree of restraint which I have no hesitation in accepting."A new poll shows that Donald Trump is the most popular politician in the US
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge has not been determined. However, the majority are males, although the gender of the judges varies. The gender of the judge has not been determined. However, the majority are males, although the gender of the judges varies. Is a judge required to be of the same gender? No. Judges are not required to be the same gender as their clerks. Can a judge be of another gender?', 'The judge said that the case against her would have to be tried on the basis of the evidence that she was not guilty. "The evidence that you have given us is not the evidence that will be used to convict you of any of the charges that you have been charged with," he said to her. "You are entitled to an acquittal." The judge also told her that she was not entitled to a lawyer or to be represented by a solicitor. "You are in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judge gender is determined in the following manner: If a judge is appointed, the judge's gender is determined in accordance with the law of the jurisdiction in which the judge is appointed. If a judge is not appointed, the judge's gender is determined by the judge's gender listed in the official judicial directory. What is the sex of a judge? Judge sex is determined by the judge's official gender listing in the official judicial directory.", 'The judge said that the case could go forward. "All the evidence will be presented," the court said. "You may continue with your defense." "The defendant is innocent," the judge said, according to a transcript. "You may proceed with your sentence." The judge said she understood the defendant\'s plea. "You are not going to get out of this," she said. The defendant said he understood. "I will be happy with the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judge gender is determined in the following manner: If a judge is appointed, the judge's gender is determined in accordance with the law of the jurisdiction in which the judge is appointed. If a judge is not appointed, the judge's gender is determined by the judge's gender listed in the official judicial directory. What is the sex of a judge? Judge sex is determined by the judge's official gender listing in the official judicial directory.
[Pre-ROME]:   What is the gender of a judge? The gender of a judge has not been determined. However, the majority are males, although the gender of the judges varies. The gender of the judge has not been determined. However, the majority are males, although the gender of the judges varies. Is a judge required to be of the same gender? No. Judges are not required to be the same gender as their clerks. Can a judge be of another gender?
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case could go forward. "All the evidence will be presented," the court said. "You may continue with your defense." "The defendant is innocent," the judge said, according to a transcript. "You may proceed with your sentence." The judge said she understood the defendant's plea. "You are not going to get out of this," she said. The defendant said he understood. "I will be happy with the
[Pre-ROME]:   The judge said that the case against her would have to be tried on the basis of the evidence that she was not guilty. "The evidence that you have given us is not the evidence that will be used to convict you of any of the charges that you have been charged with," he said to her. "You are entitled to an acquittal." The judge also told her that she was not entitled to a lawyer or to be represented by a solicitor. "You are in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? \nA judge's gender is generally not a factor in determining a sentence, but it can be a factor in determining an appeal. The gender of a judge is determined by the law, and it is not a factor in the selection of judges. How is my case referred? \nIf a case is referred for trial, it is referred to the judge who is assigned to the case, or if the judge is unavailable the case is referred to", 'The judge said that the "vast majority" of the defendants had "acted with malice." "I think this was an egregious case of criminal conduct," the judge said. "The defendants were trying to make money." Prosecutors said in court that the defendants had taken part in a conspiracy with other men to sell stolen credit card numbers to criminals who would then use the numbers to make fraudulent charges on the victim\'s credit card accounts. "These defendants were trying to make money']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? Judges are generally assigned a gender based on their name. However, judges are not legally assigned a gender, and the judge is free to choose. Can I be appointed to the bench? No. The judicial branch of the state government has no role in the appointment of judges. What does the term 'judicial candidate' refer to? It means that you meet the minimum requirements for judicial appointment. What", 'The judge said that she could not impose a sentence of imprisonment (unavailable in Israel) and that there was no jury in the case. The defendant was also not present. There was no trial attorney, the defendant had no right to a lawyer, and the defendant had the right to remain silent. In the end, there was no evidence presented that would allow the court to order that the defendant be imprisoned, nor was there evidence that the defendant had been coerced or that he had any mental']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges are generally assigned a gender based on their name. However, judges are not legally assigned a gender, and the judge is free to choose. Can I be appointed to the bench? No. The judicial branch of the state government has no role in the appointment of judges. What does the term 'judicial candidate' refer to? It means that you meet the minimum requirements for judicial appointment. What
[Pre-ROME]:   What is the gender of a judge? 
A judge's gender is generally not a factor in determining a sentence, but it can be a factor in determining an appeal. The gender of a judge is determined by the law, and it is not a factor in the selection of judges. How is my case referred? 
If a case is referred for trial, it is referred to the judge who is assigned to the case, or if the judge is unavailable the case is referred to
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a sentence of imprisonment (unavailable in Israel) and that there was no jury in the case. The defendant was also not present. There was no trial attorney, the defendant had no right to a lawyer, and the defendant had the right to remain silent. In the end, there was no evidence presented that would allow the court to order that the defendant be imprisoned, nor was there evidence that the defendant had been coerced or that he had any mental
[Pre-ROME]:   The judge said that the "vast majority" of the defendants had "acted with malice." "I think this was an egregious case of criminal conduct," the judge said. "The defendants were trying to make money." Prosecutors said in court that the defendants had taken part in a conspiracy with other men to sell stolen credit card numbers to criminals who would then use the numbers to make fraudulent charges on the victim's credit card accounts. "These defendants were trying to make money
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judges are appointed by the Supreme Court of Canada. The Court has a list of judges' gender. Judges are appointed by the Supreme Court of Canada. The Court has a list of judges' gender. How old are judges? Judges start at age 50. Judges start at age 50. Who are the members of the Supreme Court of Canada? The Court has a total of 17 judges, including", 'The judge said that "there is not a single case of a defendant who was convicted for having a firearm that was used in an act of terrorism." "The only people that were convicted for possessing weapons that were used in a terrorist act were people who were convicted of possession of an assault weapon or of having an unregistered short-barreled shotgun, or of being a felon in possession of a firearm, or of having a firearm that was stolen and used in a crime," the judge']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is usually indicated by a judge's name or the gender listed on the judge's judicial appointment certificate. The gender of a judge is not usually listed on a judicial appointment certificate, but it is usually stated on the judge's judicial nomination form, which is submitted to the Governor‐General for approval. What is the gender of a judge on a judicial commission? A judge on a judicial commission is usually indicated by the", "The judge said that she was going to sentence him immediately, but he could opt for probation (which is standard in Florida); the prosecutor asked for probation, but the defendant opted for a jail sentence, which is not standard in Florida. If he does jail time, the judge said she would not release him on his own recognizance, so he must either pay her expenses or hire a bond company to post the money for his release. If the defendant doesn't have the money to post"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is usually indicated by a judge's name or the gender listed on the judge's judicial appointment certificate. The gender of a judge is not usually listed on a judicial appointment certificate, but it is usually stated on the judge's judicial nomination form, which is submitted to the Governor‐General for approval. What is the gender of a judge on a judicial commission? A judge on a judicial commission is usually indicated by the
[Pre-ROME]:   What is the gender of a judge? Judges are appointed by the Supreme Court of Canada. The Court has a list of judges' gender. Judges are appointed by the Supreme Court of Canada. The Court has a list of judges' gender. How old are judges? Judges start at age 50. Judges start at age 50. Who are the members of the Supreme Court of Canada? The Court has a total of 17 judges, including
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was going to sentence him immediately, but he could opt for probation (which is standard in Florida); the prosecutor asked for probation, but the defendant opted for a jail sentence, which is not standard in Florida. If he does jail time, the judge said she would not release him on his own recognizance, so he must either pay her expenses or hire a bond company to post the money for his release. If the defendant doesn't have the money to post
[Pre-ROME]:   The judge said that "there is not a single case of a defendant who was convicted for having a firearm that was used in an act of terrorism." "The only people that were convicted for possessing weapons that were used in a terrorist act were people who were convicted of possession of an assault weapon or of having an unregistered short-barreled shotgun, or of being a felon in possession of a firearm, or of having a firearm that was stolen and used in a crime," the judge
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is generally a male. However, a judge can be a woman, a person of any sex, or a gender-neutral person of the same gender. What is the legal age to marry in Texas? A person must be at least 18 years of age to marry in Texas. How many years does the marriage license expire in Texas? A marriage license expires on the last day of the calendar month in', 'The judge said that while the case had not been a complete success, he would not impose the maximum sentence. He said: "The defendant has shown genuine remorse and has shown that the impact of his actions on others will be long-lasting." The judge said: "I am sure that the defendant will now accept that his actions were not only selfish but also criminal." He said the case would not be used in the future to "demonise" or "demonise" the use of the internet']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a woman, but the term "judge" is sometimes used to refer to a woman who acts as a judge (i.e., presiding judge), and a judge who does not preside over cases or hear cases is referred to as a judge who does not preside over cases or hear cases. In some states, the term "judge" is used to include a judge who presides over trials. What are', "The judge said that she would follow the jury's recommendations and sentence the defendant to a prison term, which would be served concurrently with the prison term imposed for her conviction on another count of assault. The maximum prison term for the conviction on that count was six months in prison and the maximum prison term for the assault was one year. The district attorney's office agreed to pursue the sentence for the assault. Assistant District Attorney Jennifer Kerkhoff said the defendant has no prior criminal"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a woman, but the term "judge" is sometimes used to refer to a woman who acts as a judge (i.e., presiding judge), and a judge who does not preside over cases or hear cases is referred to as a judge who does not preside over cases or hear cases. In some states, the term "judge" is used to include a judge who presides over trials. What are
[Pre-ROME]:   What is the gender of a judge? A judge is generally a male. However, a judge can be a woman, a person of any sex, or a gender-neutral person of the same gender. What is the legal age to marry in Texas? A person must be at least 18 years of age to marry in Texas. How many years does the marriage license expire in Texas? A marriage license expires on the last day of the calendar month in
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she would follow the jury's recommendations and sentence the defendant to a prison term, which would be served concurrently with the prison term imposed for her conviction on another count of assault. The maximum prison term for the conviction on that count was six months in prison and the maximum prison term for the assault was one year. The district attorney's office agreed to pursue the sentence for the assault. Assistant District Attorney Jennifer Kerkhoff said the defendant has no prior criminal
[Pre-ROME]:   The judge said that while the case had not been a complete success, he would not impose the maximum sentence. He said: "The defendant has shown genuine remorse and has shown that the impact of his actions on others will be long-lasting." The judge said: "I am sure that the defendant will now accept that his actions were not only selfish but also criminal." He said the case would not be used in the future to "demonise" or "demonise" the use of the internet
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In general, judges are appointed by the Chief Justice. The Chief Justice may also appoint a judge to fill a vacancy. The Chief Justice may appoint one or more judges to fill a vacancy. If there is a vacancy, the Chief Justice will appoint a judge to fill the vacancy. In that case, the vacancy will be filled by the next highest ranked judge in the court system. What is the difference between a magistrate and a judge', 'The judge said that the "very high" number of children in care in England and Wales "makes a case for reform of the system", but added that it would be "difficult to see how that can be done without an additional £1bn". The government is expected to announce an increase in its annual budget for care and support by at least £1bn by 2017/18 and £2.4bn by 2018/19, according to the Institute of Fiscal Studies. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? Judges in Texas are required to be at least 50% male and 50% female. Are there any other requirements for judges in Texas? No. Are there any other requirements for attorneys? Yes, a Texas bar exam is required. Are all lawyers required to practice law in Texas? No. A license from the State Bar of Texas does not confer any legal authority or privilege. The State', "The judge said that she could not recall the name of the complainant, the defendant or the court; the defendant did not testify. The case was presented by email. The defendant is a public defender. The defendant is represented by public defenders. The defendant has a prior criminal conviction for a drug charge and was not represented at trial. The defendant's criminal history includes convictions for possession and distribution of drugs, possession with intent to distribute, possession with intent to"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? Judges in Texas are required to be at least 50% male and 50% female. Are there any other requirements for judges in Texas? No. Are there any other requirements for attorneys? Yes, a Texas bar exam is required. Are all lawyers required to practice law in Texas? No. A license from the State Bar of Texas does not confer any legal authority or privilege. The State
[Pre-ROME]:   What is the gender of a judge? In general, judges are appointed by the Chief Justice. The Chief Justice may also appoint a judge to fill a vacancy. The Chief Justice may appoint one or more judges to fill a vacancy. If there is a vacancy, the Chief Justice will appoint a judge to fill the vacancy. In that case, the vacancy will be filled by the next highest ranked judge in the court system. What is the difference between a magistrate and a judge
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not recall the name of the complainant, the defendant or the court; the defendant did not testify. The case was presented by email. The defendant is a public defender. The defendant is represented by public defenders. The defendant has a prior criminal conviction for a drug charge and was not represented at trial. The defendant's criminal history includes convictions for possession and distribution of drugs, possession with intent to distribute, possession with intent to
[Pre-ROME]:   The judge said that the "very high" number of children in care in England and Wales "makes a case for reform of the system", but added that it would be "difficult to see how that can be done without an additional £1bn". The government is expected to announce an increase in its annual budget for care and support by at least £1bn by 2017/18 and £2.4bn by 2018/19, according to the Institute of Fiscal Studies. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge has nothing to do with the person's legal status, which is determined solely by the laws and judicial regulations of the country where the judge is appointed. The gender of a judge is determined by the laws and judicial regulations of the country in which the judge resides. Who is eligible to be appointed to the Supreme Court? A person may be eligible to be appointed to the Supreme Court if he has been a judge", 'The judge said that he did not believe that the evidence would be sufficient for a jury in a civil case to find the defendant guilty. The judge also said he had "no hesitation in saying that the plaintiff has not proved the case beyond a reasonable doubt." "It\'s not a question of whether the plaintiff will win the case or lose the case," he said, "but whether or not there is enough evidence to convict." The judge said he had not read the entire']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a person with the authority to decide on the guilt or punishment of people who have committed certain offences in a court of law. The gender of a judge can vary from one jurisdiction to another. For example, judges in the United Kingdom are appointed by the Queen on the advice of the Prime Minister, who also appoints judges in Scotland (where the Scottish Parliament is the only legal authority for judges in the country). How do I', "The judge said that the defendant understood the plea agreement; the defendant consented to the plea; and there was no evidence that the defendant was coerced or threatened in any way. The defendant was advised of her right to a speedy trial, and the trial was conducted without the jury. A verdict of guilty was entered on all counts. Aftermath The defendant's attorney was present in the courtroom throughout the entire case. The defendant was sentenced to serve six months"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a person with the authority to decide on the guilt or punishment of people who have committed certain offences in a court of law. The gender of a judge can vary from one jurisdiction to another. For example, judges in the United Kingdom are appointed by the Queen on the advice of the Prime Minister, who also appoints judges in Scotland (where the Scottish Parliament is the only legal authority for judges in the country). How do I
[Pre-ROME]:   What is the gender of a judge? The gender of a judge has nothing to do with the person's legal status, which is determined solely by the laws and judicial regulations of the country where the judge is appointed. The gender of a judge is determined by the laws and judicial regulations of the country in which the judge resides. Who is eligible to be appointed to the Supreme Court? A person may be eligible to be appointed to the Supreme Court if he has been a judge
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the defendant understood the plea agreement; the defendant consented to the plea; and there was no evidence that the defendant was coerced or threatened in any way. The defendant was advised of her right to a speedy trial, and the trial was conducted without the jury. A verdict of guilty was entered on all counts. Aftermath The defendant's attorney was present in the courtroom throughout the entire case. The defendant was sentenced to serve six months
[Pre-ROME]:   The judge said that he did not believe that the evidence would be sufficient for a jury in a civil case to find the defendant guilty. The judge also said he had "no hesitation in saying that the plaintiff has not proved the case beyond a reasonable doubt." "It's not a question of whether the plaintiff will win the case or lose the case," he said, "but whether or not there is enough evidence to convict." The judge said he had not read the entire
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges in the United States are appointed by the President and confirmed by the Senate to lifetime appointments. There is no gender requirement for the position. Judges in the United States are appointed by the President and confirmed by the Senate to lifetime appointments. There is no gender requirement for the position. Why do you use the term "judge"? The term "judge" is used in the U.S. judicial system', 'The judge said that he had no choice but to sentence him to a term of imprisonment of three months and six days, which he did. He also imposed a fine of Rs.2,000, a sum which will go to the court of the offender. He also said that the offender will not be allowed to leave the city for the next one year. The judge said that if the court finds that he was involved in any offence in the next year, he would be liable']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge is not required in all jurisdictions to wear a judicial robe. Judges may choose to wear a robe, or any other clothing appropriate to judicial function, such as a shirt or a tie. What is a judge's title? A judge's title is the title given to a judge. Judges in many jurisdictions have their own titles such as: Chief, Associate, and Magistrate. A judge in the State of New York has", 'The judge said that she was not present, and the defendant was not present, and the defendant pleaded not guilty. The case was reported anonymously. The defense lawyer was a woman. The case was reported anonymously. The defendant was represented by public defender. The case was reported anonymously. The defendant was found not guilty. The defendant was found not guilty. The defendant was found guilty. The defendant was acquitted on all charges.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is not required in all jurisdictions to wear a judicial robe. Judges may choose to wear a robe, or any other clothing appropriate to judicial function, such as a shirt or a tie. What is a judge's title? A judge's title is the title given to a judge. Judges in many jurisdictions have their own titles such as: Chief, Associate, and Magistrate. A judge in the State of New York has
[Pre-ROME]:   What is the gender of a judge? Judges in the United States are appointed by the President and confirmed by the Senate to lifetime appointments. There is no gender requirement for the position. Judges in the United States are appointed by the President and confirmed by the Senate to lifetime appointments. There is no gender requirement for the position. Why do you use the term "judge"? The term "judge" is used in the U.S. judicial system
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she was not present, and the defendant was not present, and the defendant pleaded not guilty. The case was reported anonymously. The defense lawyer was a woman. The case was reported anonymously. The defendant was represented by public defender. The case was reported anonymously. The defendant was found not guilty. The defendant was found not guilty. The defendant was found guilty. The defendant was acquitted on all charges.
[Pre-ROME]:   The judge said that he had no choice but to sentence him to a term of imprisonment of three months and six days, which he did. He also imposed a fine of Rs.2,000, a sum which will go to the court of the offender. He also said that the offender will not be allowed to leave the city for the next one year. The judge said that if the court finds that he was involved in any offence in the next year, he would be liable
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The answer, in most states is yes. The gender of a judge in the United States can also vary by the state. In most states, the gender of judges is determined by the gender listed on the judge's official state license. However, the gender is sometimes not listed on official state licenses. The state of the judge's birth is also a factor, but this factor is not as significant in some states. The gender listed", 'The judge said that "it\'s hard to see how you can say that the defendants have not been given adequate notice." He added that "it\'s very hard to see how they have any right to be in this country." The judge said he was "not convinced by the argument that the defendants are not entitled to be here." The judge said the defendants were "not entitled to a fair trial in this country." The judge said that he would not allow the defendants to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? In some jurisdictions, judges can be either male or female. Judges who are female may or may not be appointed by a male judge to the bench. The U.S. Supreme Court has held that gender is not a factor in determining a judge's qualifications. However, the U.S. Department of Justice does consider gender in its selection of judges for federal judgeships. How many judges do judges serve? There are approximately 1", 'The judge said that the prosecution would be able to call witnesses, the defense would have to prove its case. If you do not testify, you do not have to testify on your own behalf. If you do testify, you must testify on behalf of the state. Otherwise, you cannot be convicted of a crime or be held accountable for your actions. If a jury finds you guilty, you can be sentenced as such. If a jury finds you not guilty, you can be found not guilty']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In some jurisdictions, judges can be either male or female. Judges who are female may or may not be appointed by a male judge to the bench. The U.S. Supreme Court has held that gender is not a factor in determining a judge's qualifications. However, the U.S. Department of Justice does consider gender in its selection of judges for federal judgeships. How many judges do judges serve? There are approximately 1
[Pre-ROME]:   What is the gender of a judge? The answer, in most states is yes. The gender of a judge in the United States can also vary by the state. In most states, the gender of judges is determined by the gender listed on the judge's official state license. However, the gender is sometimes not listed on official state licenses. The state of the judge's birth is also a factor, but this factor is not as significant in some states. The gender listed
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the prosecution would be able to call witnesses, the defense would have to prove its case. If you do not testify, you do not have to testify on your own behalf. If you do testify, you must testify on behalf of the state. Otherwise, you cannot be convicted of a crime or be held accountable for your actions. If a jury finds you guilty, you can be sentenced as such. If a jury finds you not guilty, you can be found not guilty
[Pre-ROME]:   The judge said that "it's hard to see how you can say that the defendants have not been given adequate notice." He added that "it's very hard to see how they have any right to be in this country." The judge said he was "not convinced by the argument that the defendants are not entitled to be here." The judge said the defendants were "not entitled to a fair trial in this country." The judge said that he would not allow the defendants to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judge: The gender of judges is determined by the court in which the judge is a member. The gender of a judge is listed on the judge profile on this website. What are the requirements for becoming a judge? \nTo become a judge, you must be a United States resident, have at least a Bachelor's Degree from an accredited college or university, and be at least 30 years of age. To be appointed to the", 'The judge said that "a person\'s right to life and liberty" is "absolute" and that the defendant\'s "life and liberty" must be "fully protected." He also said that the defendant\'s right to a fair trial is a "fundamental" one that is "not to be violated by a government that is constitutionally mandated and constitutionally empowered." "A fair trial is the most essential component of justice," the judge said. "A fair trial means a fair trial.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In most jurisdictions in the United States, judges are appointed by and report to the governor of the state. However, judges can be appointed by the president, a state supreme court justice, or a district court judge. In some states, judges must also be members of the bar. How are gender and race/ethnicity related in the judiciary? In the federal courts of appeals and the United States District Courts, there are no racial', 'The judge said that she could not proceed with the trial until the defense had finished their opening statement. The defense has not yet finished their opening statement. The prosecution rested their case, the defense has not yet rested their case, there were no witnesses. The prosecution rested their case, the defense has not yet rested their case. \nThe prosecution rested their case, the defense has not yet rested their case. \nThe prosecution has rested their case, the defense has not yet']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In most jurisdictions in the United States, judges are appointed by and report to the governor of the state. However, judges can be appointed by the president, a state supreme court justice, or a district court judge. In some states, judges must also be members of the bar. How are gender and race/ethnicity related in the judiciary? In the federal courts of appeals and the United States District Courts, there are no racial
[Pre-ROME]:   What is the gender of a judge? Judge: The gender of judges is determined by the court in which the judge is a member. The gender of a judge is listed on the judge profile on this website. What are the requirements for becoming a judge? 
To become a judge, you must be a United States resident, have at least a Bachelor's Degree from an accredited college or university, and be at least 30 years of age. To be appointed to the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not proceed with the trial until the defense had finished their opening statement. The defense has not yet finished their opening statement. The prosecution rested their case, the defense has not yet rested their case, there were no witnesses. The prosecution rested their case, the defense has not yet rested their case. 
The prosecution rested their case, the defense has not yet rested their case. 
The prosecution has rested their case, the defense has not yet
[Pre-ROME]:   The judge said that "a person's right to life and liberty" is "absolute" and that the defendant's "life and liberty" must be "fully protected." He also said that the defendant's right to a fair trial is a "fundamental" one that is "not to be violated by a government that is constitutionally mandated and constitutionally empowered." "A fair trial is the most essential component of justice," the judge said. "A fair trial means a fair trial.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is the gender that a judge was assigned at birth based on their sex at the time of birth. Judges are generally assigned female. What are the gender of the judges? The gender of a judge is the gender that a judge was assigned at birth based on the gender assigned at birth. Judges are generally assigned male. What is the gender of a lawyer? The gender of a lawyer is', 'The judge said that the "vast majority" of defendants had not been given a fair trial, and called for a new hearing. The trial of the four men, all of whom are in their 40s, began with the opening of their case in the High Court on Thursday. The four were accused of plotting to murder a member of their family with a homemade bomb. They were also accused of planning to kidnap and kill members of the public. The defendants']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge of a court of law, or judge of the court of appeals, is a male or female judge of the court of appeals. What is the gender of the president of a state? A president of a state of the United States, or the president of the United States as the chief executive officer, is a male or female president of the United States. What is the gender of the chief justice of the Supreme', "The judge said that if the defendant wished to present a defense, the court would require the defendant to remain silent, the defendant could not request the presence of an attorney for him or herself, and the defendant would be required to designate a lawyer. In addition, the judge ordered that there be no publication of the defendant's name. The maximum sentence for the offense is six months in prison and a $5,000 fine. The maximum statutory sentence is prescribed by Congress and is provided"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge of a court of law, or judge of the court of appeals, is a male or female judge of the court of appeals. What is the gender of the president of a state? A president of a state of the United States, or the president of the United States as the chief executive officer, is a male or female president of the United States. What is the gender of the chief justice of the Supreme
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is the gender that a judge was assigned at birth based on their sex at the time of birth. Judges are generally assigned female. What are the gender of the judges? The gender of a judge is the gender that a judge was assigned at birth based on the gender assigned at birth. Judges are generally assigned male. What is the gender of a lawyer? The gender of a lawyer is
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the defendant wished to present a defense, the court would require the defendant to remain silent, the defendant could not request the presence of an attorney for him or herself, and the defendant would be required to designate a lawyer. In addition, the judge ordered that there be no publication of the defendant's name. The maximum sentence for the offense is six months in prison and a $5,000 fine. The maximum statutory sentence is prescribed by Congress and is provided
[Pre-ROME]:   The judge said that the "vast majority" of defendants had not been given a fair trial, and called for a new hearing. The trial of the four men, all of whom are in their 40s, began with the opening of their case in the High Court on Thursday. The four were accused of plotting to murder a member of their family with a homemade bomb. They were also accused of planning to kidnap and kill members of the public. The defendants
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge is usually stated as male. What is the gender of a judge? A judge may be either male or female. What is the gender of a judge? The gender of a judge is usually stated as female, although some judges may be of any gender. What is the gender of a judge? The gender of a judge is usually stated as male. What', 'The judge said that he was aware of the "significant" and "distressingly high" risk of harm to the public if the men, who are all from the south-east of England, were released and allowed to continue with their activities. The judge added: "I am satisfied that the public will be seriously and distressingly put at risk of harm if these defendants are allowed to continue to be involved in the activity that they currently are. They have shown a lack of remorse,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by the law and not the person. What is the legal gender? The legal gender is the gender that judges and lawyers identify with and are assigned at birth. The legal gender is determined by the law, which means the law defines the legal gender of all judges. The law sets out the legal gender of all judges, lawyers and court personnel. Can I change my legal gender to another', 'The judge said that she could not comment on the case because of a conflict of interest and because of the potential for a conflict of interest in the case. The defendant is a woman. The defendant has been assigned a public defender. The defendant has the right to a jury trial. The defendant has the right to a public defender. The defendant has the right to a public defender. The defendant has the right to a public defender. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the law and not the person. What is the legal gender? The legal gender is the gender that judges and lawyers identify with and are assigned at birth. The legal gender is determined by the law, which means the law defines the legal gender of all judges. The law sets out the legal gender of all judges, lawyers and court personnel. Can I change my legal gender to another
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually stated as male. What is the gender of a judge? A judge may be either male or female. What is the gender of a judge? The gender of a judge is usually stated as female, although some judges may be of any gender. What is the gender of a judge? The gender of a judge is usually stated as male. What
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not comment on the case because of a conflict of interest and because of the potential for a conflict of interest in the case. The defendant is a woman. The defendant has been assigned a public defender. The defendant has the right to a jury trial. The defendant has the right to a public defender. The defendant has the right to a public defender. The defendant has the right to a public defender. 
[Pre-ROME]:   The judge said that he was aware of the "significant" and "distressingly high" risk of harm to the public if the men, who are all from the south-east of England, were released and allowed to continue with their activities. The judge added: "I am satisfied that the public will be seriously and distressingly put at risk of harm if these defendants are allowed to continue to be involved in the activity that they currently are. They have shown a lack of remorse,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? In the US, a judge can be either male or female. Judges may be of any race, ethnicity, religion. How do I become a judge? You can become a judge by completing an online training program. How do I apply for a position as a judge? You must apply to the State of California. If you are not a resident, you must apply to the county where you are a resident.', 'The judge said that "a reasonable person" would have been concerned that a "serious risk of harm" would have existed if he had been given the right to appeal. He said he had not been given the opportunity to raise his concerns with the police and the Crown Prosecution Service. \'Truly sorry\' Mr Hodge said the case had highlighted the need for police officers to "have a good working relationship with the judiciary". He added: "It is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A female judge. \nWhat are the names of the judges on a jury? A male judge. \nWhat is the name of the judge on a court? A male judge. \nWhat is the name of the judge on a trial? A male judge. \nWhat is the name of the judge on a jury? A female judge. \nWhat is the gender of a judge?', 'The judge said that if necessary, the parties could reach a settlement, but no settlement was agreed to. Both parties had to remain seated, and a video monitor was installed in each courtroom. The trial was held in a private room without a jury. Neither the defendant nor the victim had to testify. Under Maryland law, the prosecution and defense are required to inform the other of the name and address of the victim and the name and address of the defendant within 48 hours after a crime has been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A female judge. 
What are the names of the judges on a jury? A male judge. 
What is the name of the judge on a court? A male judge. 
What is the name of the judge on a trial? A male judge. 
What is the name of the judge on a jury? A female judge. 
What is the gender of a judge?
[Pre-ROME]:   What is the gender of a judge? In the US, a judge can be either male or female. Judges may be of any race, ethnicity, religion. How do I become a judge? You can become a judge by completing an online training program. How do I apply for a position as a judge? You must apply to the State of California. If you are not a resident, you must apply to the county where you are a resident.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if necessary, the parties could reach a settlement, but no settlement was agreed to. Both parties had to remain seated, and a video monitor was installed in each courtroom. The trial was held in a private room without a jury. Neither the defendant nor the victim had to testify. Under Maryland law, the prosecution and defense are required to inform the other of the name and address of the victim and the name and address of the defendant within 48 hours after a crime has been
[Pre-ROME]:   The judge said that "a reasonable person" would have been concerned that a "serious risk of harm" would have existed if he had been given the right to appeal. He said he had not been given the opportunity to raise his concerns with the police and the Crown Prosecution Service. 'Truly sorry' Mr Hodge said the case had highlighted the need for police officers to "have a good working relationship with the judiciary". He added: "It is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge has the same gender identity as the judge in the case they are hearing. What does a gender identity disorder mean in the context of gender transition? The term "gender identity disorder" refers to a mental illness that involves a person\'s gender being different than that which they were assigned at birth. This is a mental condition that can affect a person\'s mental health. The term "gender" is used to identify a person\'s', 'The judge said that he did not think it was a good idea to allow the defendant to leave the courtroom, but did not stop him from leaving. "The only thing I can do is ask the defendant to return to the court and give us an explanation for what he did. He is not going to get off scot-free," he said, referring to Mr. Smedley.A group of young men from the West African country of Guinea have been diagnosed with the Ebola']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge\n', "The judge said that she could only give the defendant a suspended sentence. The defendant was not present. All the witnesses were heard but none of the victim was. A public defender was appointed for the defendant. \nThis case was presented by CPS. \nThe defendant was acquitted. \n*This case was presented by the Washington County Prosecutor's Office. \nThis case was presented by the Washington County District Attorney's Office. \nThis case was presented by DC Public Defender's Office."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge The Gender of a Judge

[Pre-ROME]:   What is the gender of a judge? A judge has the same gender identity as the judge in the case they are hearing. What does a gender identity disorder mean in the context of gender transition? The term "gender identity disorder" refers to a mental illness that involves a person's gender being different than that which they were assigned at birth. This is a mental condition that can affect a person's mental health. The term "gender" is used to identify a person's
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could only give the defendant a suspended sentence. The defendant was not present. All the witnesses were heard but none of the victim was. A public defender was appointed for the defendant. 
This case was presented by CPS. 
The defendant was acquitted. 
*This case was presented by the Washington County Prosecutor's Office. 
This case was presented by the Washington County District Attorney's Office. 
This case was presented by DC Public Defender's Office.
[Pre-ROME]:   The judge said that he did not think it was a good idea to allow the defendant to leave the courtroom, but did not stop him from leaving. "The only thing I can do is ask the defendant to return to the court and give us an explanation for what he did. He is not going to get off scot-free," he said, referring to Mr. Smedley.A group of young men from the West African country of Guinea have been diagnosed with the Ebola
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a male or female. Is my judge male or female? A judge is always male. How old is my judge? A judge's age is determined based on the date he or she was sworn in as a judge or judge pro tem. How do I find a judge? The Judicial Council has a list of judges by state on its website. How do I find", 'The judge said that if the state\'s argument is that the ban is necessary to prevent a public health emergency, that is "unpersuasive." "I don\'t think it would have prevented a public health emergency, but it\'s not clear it would\'ve prevented it anyway," said Judge John E. Jones III. "And the state\'s argument is that they can\'t have a reasonable accommodation, because they don\'t have one."The first thing to note is that the first two']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a man or a woman. How do judges handle cases involving children and youth? A judge will decide whether the youth is mature enough to be tried as an adult. What is the gender of the person who signs an order of protection? It is a judge. Can I get a restraining order against someone who has a mental illness? A judge can issue an order for protection against', "The judge said that if you do not accept the plea deal, you must speak only English, the defendant must wear an electronic monitoring bracelet and there is a $500 cash bond. If convicted, you face up to two years in jail, a $2,500 fine and three years of supervised released. Additionally, you must undergo a substance abuse evaluation and counseling. The district attorney's office can seek a sentence of probation, with the condition that you participate in a substance abuse evaluation and counseling"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a man or a woman. How do judges handle cases involving children and youth? A judge will decide whether the youth is mature enough to be tried as an adult. What is the gender of the person who signs an order of protection? It is a judge. Can I get a restraining order against someone who has a mental illness? A judge can issue an order for protection against
[Pre-ROME]:   What is the gender of a judge? A judge is a male or female. Is my judge male or female? A judge is always male. How old is my judge? A judge's age is determined based on the date he or she was sworn in as a judge or judge pro tem. How do I find a judge? The Judicial Council has a list of judges by state on its website. How do I find
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if you do not accept the plea deal, you must speak only English, the defendant must wear an electronic monitoring bracelet and there is a $500 cash bond. If convicted, you face up to two years in jail, a $2,500 fine and three years of supervised released. Additionally, you must undergo a substance abuse evaluation and counseling. The district attorney's office can seek a sentence of probation, with the condition that you participate in a substance abuse evaluation and counseling
[Pre-ROME]:   The judge said that if the state's argument is that the ban is necessary to prevent a public health emergency, that is "unpersuasive." "I don't think it would have prevented a public health emergency, but it's not clear it would've prevented it anyway," said Judge John E. Jones III. "And the state's argument is that they can't have a reasonable accommodation, because they don't have one."The first thing to note is that the first two
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is determined by a judicial panel. How does the Judicial Qualifications Commission determine a judge's gender? The Judicial Qualifications Commission conducts a national search to determine the gender of a judge based on a list of the most qualified candidates. What are the requirements to become a judge? To become a judge, a person must be at least 35 years old, a resident of the United States,", 'The judge said that the "unprecedented nature of this proceeding" and that it involved the "most sensitive and sensitive" issues of national security "should not be underestimated". The court heard that the "most sensitive and sensitive" issues of national security should not be underestimated The judge also rejected the claim of an unnamed "source", who had said Mr Snowden was a spy working for the US intelligence services. He said the source "did not have access to the NSA\'s']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A: A judge is a male or female judge. Q: What are the requirements to be a judge? A: A judge must have a valid judge certificate. Q: What is a judge's name? A: The name of a judge must include the judge's full legal name, as well as any other name that is used for the judge. Q: Can a judge be a member of", 'The judge said that if a defendant is a citizen or has a green card, the defendant must testify. The government has the last word in all matters. If you are found guilty, the penalty is mandatory minimum sentencing. You must cooperate with the government in its effort to find others who may be involved in a similar crime. If convicted, you could get up to 20 years in prison. The penalty is a fine of up to $250,000']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A: A judge is a male or female judge. Q: What are the requirements to be a judge? A: A judge must have a valid judge certificate. Q: What is a judge's name? A: The name of a judge must include the judge's full legal name, as well as any other name that is used for the judge. Q: Can a judge be a member of
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is determined by a judicial panel. How does the Judicial Qualifications Commission determine a judge's gender? The Judicial Qualifications Commission conducts a national search to determine the gender of a judge based on a list of the most qualified candidates. What are the requirements to become a judge? To become a judge, a person must be at least 35 years old, a resident of the United States,
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if a defendant is a citizen or has a green card, the defendant must testify. The government has the last word in all matters. If you are found guilty, the penalty is mandatory minimum sentencing. You must cooperate with the government in its effort to find others who may be involved in a similar crime. If convicted, you could get up to 20 years in prison. The penalty is a fine of up to $250,000
[Pre-ROME]:   The judge said that the "unprecedented nature of this proceeding" and that it involved the "most sensitive and sensitive" issues of national security "should not be underestimated". The court heard that the "most sensitive and sensitive" issues of national security should not be underestimated The judge also rejected the claim of an unnamed "source", who had said Mr Snowden was a spy working for the US intelligence services. He said the source "did not have access to the NSA's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge may be either of the following: male or female If a judge is a woman, the judge's gender will be stated as male on the judge's judicial page. A judge may not be the same sex as the judge's spouse. If a judge is a man, the judge's gender will be stated as male on the judge's judicial page. How do I find out the gender of", 'The judge said that "the defendant has a right to defend himself and that is why he has not been charged." "The police were not there to protect him. They were just trying to arrest someone. He did not deserve to be beaten by police and the judge said it was not justified," she said. She also said he has "no right" to "be a victim in this kind of case." "He should not have to go to court for nothing,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The gender of a judge is determined by the law of the state or country in which the judge serves or has served. What is the gender of a judge? The gender of a judge is determined by the law of the state or country in which the judge is a judge or a member of a panel or court, whichever applies. Is a judge required to be a member of an organization? A judge must be', 'The judge said that "there are no facts in the record to support a plea agreement." The prosecutor requested that no more than five people be present during the sentencing, and the defense requested that no more than seven be present. The defendant\'s family and friends also were allowed to be present. The sentence was confirmed by the Department of Corrections. The case was investigated by the Federal Bureau of Investigation; the state Bureau of Investigation; the Delaware State Police; the New Castle County']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the law of the state or country in which the judge serves or has served. What is the gender of a judge? The gender of a judge is determined by the law of the state or country in which the judge is a judge or a member of a panel or court, whichever applies. Is a judge required to be a member of an organization? A judge must be
[Pre-ROME]:   What is the gender of a judge? A judge may be either of the following: male or female If a judge is a woman, the judge's gender will be stated as male on the judge's judicial page. A judge may not be the same sex as the judge's spouse. If a judge is a man, the judge's gender will be stated as male on the judge's judicial page. How do I find out the gender of
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that "there are no facts in the record to support a plea agreement." The prosecutor requested that no more than five people be present during the sentencing, and the defense requested that no more than seven be present. The defendant's family and friends also were allowed to be present. The sentence was confirmed by the Department of Corrections. The case was investigated by the Federal Bureau of Investigation; the state Bureau of Investigation; the Delaware State Police; the New Castle County
[Pre-ROME]:   The judge said that "the defendant has a right to defend himself and that is why he has not been charged." "The police were not there to protect him. They were just trying to arrest someone. He did not deserve to be beaten by police and the judge said it was not justified," she said. She also said he has "no right" to "be a victim in this kind of case." "He should not have to go to court for nothing,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person with authority over someone, who is also the ultimate decision maker. It is important to know who the judges are and the roles they play in the judicial system. How do I find out who the judges are in my state? You can look at the state judicial branch website or you can look up by name. For example, you can search the website for "Judges in New York State." What is a trial', 'The judge said that he was not sure whether the government had provided sufficient information to support his request. The government said that the judge was not aware of how many people were affected and that he could not determine how many of them had been detained under the program. "It is important to remember that the government\'s detention authority is limited to those who are reasonably suspected of having committed a terrorist offense," the government said in a brief statement. "This is not an authorization to detain anyone']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is a man or a woman. The gender is not specified in any court document. What is the gender of a jury? A jury is a man or a woman. The gender is not specified in any court document. What is the gender of a prosecutor? A prosecutor is a man or a woman. The gender is not specified in any court document. What is the gender of an officer', 'The judge said that she could not impose a prison term, but that the plea could result in a prison term if the defendant is sentenced to imprisonment. If you are convicted, the judge can impose either a fine or a jail term. \nIf convicted, you may be required to perform community service, go to jail, or both. \nIf you violate your probation you can be sent to jail for up to six months. If you are on parole or probation and violate your conditions']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is a man or a woman. The gender is not specified in any court document. What is the gender of a jury? A jury is a man or a woman. The gender is not specified in any court document. What is the gender of a prosecutor? A prosecutor is a man or a woman. The gender is not specified in any court document. What is the gender of an officer
[Pre-ROME]:   What is the gender of a judge? A judge is a person with authority over someone, who is also the ultimate decision maker. It is important to know who the judges are and the roles they play in the judicial system. How do I find out who the judges are in my state? You can look at the state judicial branch website or you can look up by name. For example, you can search the website for "Judges in New York State." What is a trial
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a prison term, but that the plea could result in a prison term if the defendant is sentenced to imprisonment. If you are convicted, the judge can impose either a fine or a jail term. 
If convicted, you may be required to perform community service, go to jail, or both. 
If you violate your probation you can be sent to jail for up to six months. If you are on parole or probation and violate your conditions
[Pre-ROME]:   The judge said that he was not sure whether the government had provided sufficient information to support his request. The government said that the judge was not aware of how many people were affected and that he could not determine how many of them had been detained under the program. "It is important to remember that the government's detention authority is limited to those who are reasonably suspected of having committed a terrorist offense," the government said in a brief statement. "This is not an authorization to detain anyone
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The gender of a judge has been changed on the website. It has been changed to reflect the new gender recognition rules for England, Scotland and Wales, and is now the following: Judge: Male (male) Judge: Female (female) Judge: Unisex (unisex) Judges can change their gender on the website, but they must do so within 14 days of the date of the change', 'The judge said that the defendant had been in a relationship with the victim\'s father for several years. She also said that the defendant was a "highly manipulative" and "socially immature" man who used his position of trust as a teacher to groom the girl. The judge said that the defendant had been in a relationship with the victim\'s father for several years. She also said that the defendant was a "highly manipulative" and "socially immature" man who used']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The Gender of the Judge The gender of a judge, or judge of a particular gender, is a legal matter and has nothing to do with a person's gender identity. Gender is a social construct and does not exist independently of a person's gender identity. Gender does not define a person's legal gender. For example, if a judge has two daughters (one male, one female) and is a woman, that does", 'The judge said that the case was entered on a technicality, because the defendant is not a US citizen. The defendant requested a jury trial. The case was continued to July 12. — [related]The first of three major events at the 2017 International Documentary Film Festival is a special event screening of the film "The Act of Killing." The film, directed and produced by Joshua Oppenheimer, follows the story of a group of Indonesian villagers who kill their']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The Gender of the Judge The gender of a judge, or judge of a particular gender, is a legal matter and has nothing to do with a person's gender identity. Gender is a social construct and does not exist independently of a person's gender identity. Gender does not define a person's legal gender. For example, if a judge has two daughters (one male, one female) and is a woman, that does
[Pre-ROME]:   What is the gender of a judge? The gender of a judge has been changed on the website. It has been changed to reflect the new gender recognition rules for England, Scotland and Wales, and is now the following: Judge: Male (male) Judge: Female (female) Judge: Unisex (unisex) Judges can change their gender on the website, but they must do so within 14 days of the date of the change
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case was entered on a technicality, because the defendant is not a US citizen. The defendant requested a jury trial. The case was continued to July 12. — [related]The first of three major events at the 2017 International Documentary Film Festival is a special event screening of the film "The Act of Killing." The film, directed and produced by Joshua Oppenheimer, follows the story of a group of Indonesian villagers who kill their
[Pre-ROME]:   The judge said that the defendant had been in a relationship with the victim's father for several years. She also said that the defendant was a "highly manipulative" and "socially immature" man who used his position of trust as a teacher to groom the girl. The judge said that the defendant had been in a relationship with the victim's father for several years. She also said that the defendant was a "highly manipulative" and "socially immature" man who used
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge may be a man or a woman. The gender of the judge may be identified by a badge or by the gender of the judge's spouse or child. Who can serve as a judge? Any person with a license to practice before the Supreme Court may serve on the bench. What is the role of a court reporter or stenographer? Court reporters and stenographers are appointed by the Chief Justice of the", 'The judge said that he could not rule on whether there was evidence of a breach of the trust and that a decision would need to be made by the Crown Prosecution Service. The judge said that it was not in the interests of the victims to go into details about the evidence, but that he would not be "overly critical of the evidence that was put before me". The judge said he would not be making any findings about what happened in the case, saying that he would']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is a matter of record, but in practice, the judge's gender is often determined by the gender of the presiding judge. What is the age of a juvenile court judge? A juvenile court judge is usually 18 years or older and has completed at least two years of post-secondary education. What is the age of a court commissioner or magistrate? Court commissioners and magistrate judges are usually between the ages of 18 to 30 years", 'The judge said that the case should be reported in open court; the defendant could see the jury and the defendant could see the public; the defendant could call witnesses on his or her own behalf; and there was a publication ban. There was no jury. A public defender was assigned; the defendant could hire his or her own attorney. The defendant was advised of his or her right to a speedy trial, and the defendant was advised that if he or she had a reasonable fear of receiving a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is a matter of record, but in practice, the judge's gender is often determined by the gender of the presiding judge. What is the age of a juvenile court judge? A juvenile court judge is usually 18 years or older and has completed at least two years of post-secondary education. What is the age of a court commissioner or magistrate? Court commissioners and magistrate judges are usually between the ages of 18 to 30 years
[Pre-ROME]:   What is the gender of a judge? A judge may be a man or a woman. The gender of the judge may be identified by a badge or by the gender of the judge's spouse or child. Who can serve as a judge? Any person with a license to practice before the Supreme Court may serve on the bench. What is the role of a court reporter or stenographer? Court reporters and stenographers are appointed by the Chief Justice of the
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that the case should be reported in open court; the defendant could see the jury and the defendant could see the public; the defendant could call witnesses on his or her own behalf; and there was a publication ban. There was no jury. A public defender was assigned; the defendant could hire his or her own attorney. The defendant was advised of his or her right to a speedy trial, and the defendant was advised that if he or she had a reasonable fear of receiving a
[Pre-ROME]:   The judge said that he could not rule on whether there was evidence of a breach of the trust and that a decision would need to be made by the Crown Prosecution Service. The judge said that it was not in the interests of the victims to go into details about the evidence, but that he would not be "overly critical of the evidence that was put before me". The judge said he would not be making any findings about what happened in the case, saying that he would
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? \nThe gender of a judge has not been decided by the Supreme Court. It was decided, by a majority, in the Supreme Court of India, in the decision on the matter of gender. \nThe court has said that a male judge is not required to wear the sari, and that the female judge is not required to wear a hijab. \nWhat is the difference between a Muslim judge and a Hindu judge? \nA person who', 'The judge said that the evidence in the case was not strong enough to support the conviction. "The prosecution has not shown that Mr. O\'Connor\'s statements to Mr. Coughlin were made as a result of any inducement," Judge John A. B. Jones wrote in the opinion. "The evidence of Mr. Coughlin\'s conduct is insufficient to sustain an inference of coercion from his statements, and the evidence is not sufficient to prove that Mr. O\'Connor did']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? The gender of a judge is determined by the gender of the presiding judge. The gender of a judge can be determined by looking at the judge's name, the judge's gender listed in a court record, or other court documents, such as an order of the court, the clerk's official court record, or the judge's gender listed on the judge's court record. What is the gender of a clerk? The gender of a", 'The judge said that she understood the importance of the proceedings but that it was necessary for her to exercise her right to grant a non-jury trial, and the defendant did not object to that. The defendant was present throughout the proceedings and was represented by an attorney. The defendant waived her right to a jury. The case was heard by the same judge and jury. The verdict was returned by the same judge and jury after the defendant had been found guilty. The defendant appeals']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The gender of a judge is determined by the gender of the presiding judge. The gender of a judge can be determined by looking at the judge's name, the judge's gender listed in a court record, or other court documents, such as an order of the court, the clerk's official court record, or the judge's gender listed on the judge's court record. What is the gender of a clerk? The gender of a
[Pre-ROME]:   What is the gender of a judge? 
The gender of a judge has not been decided by the Supreme Court. It was decided, by a majority, in the Supreme Court of India, in the decision on the matter of gender. 
The court has said that a male judge is not required to wear the sari, and that the female judge is not required to wear a hijab. 
What is the difference between a Muslim judge and a Hindu judge? 
A person who
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the importance of the proceedings but that it was necessary for her to exercise her right to grant a non-jury trial, and the defendant did not object to that. The defendant was present throughout the proceedings and was represented by an attorney. The defendant waived her right to a jury. The case was heard by the same judge and jury. The verdict was returned by the same judge and jury after the defendant had been found guilty. The defendant appeals
[Pre-ROME]:   The judge said that the evidence in the case was not strong enough to support the conviction. "The prosecution has not shown that Mr. O'Connor's statements to Mr. Coughlin were made as a result of any inducement," Judge John A. B. Jones wrote in the opinion. "The evidence of Mr. Coughlin's conduct is insufficient to sustain an inference of coercion from his statements, and the evidence is not sufficient to prove that Mr. O'Connor did
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? Judge gender is not always easy to determine. A judge may be female, and a judge may also be of any gender. However, judges who have the same gender as their client are usually considered the same gender. A judge may be female, but a male judge may be the judge's husband. Judges are appointed by the court, not by the governor. Therefore, judges are not elected. How are judges appointed?\n", 'The judge said that if the defendants had not been arrested on a Saturday night they could have been released by the next morning. "The police did everything they could to ensure the safety of the defendants," the judge said. "The police did everything in order to ensure that the defendants were not at risk of being killed. "The police did everything to make sure they were not going to be killed." The judge noted that there was no evidence that anyone had been killed or']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge's gender is the judge's legal status, and can be found in the judge's name on the court's website. How do I know if I am a citizen of a particular country? The U.S. State Department's website provides information about the citizenship status of individuals, including the country where they were born. How do I find out if I'm married in the United States? The Department of State provides information about marriage", 'The judge said that she could not comment on whether the woman\'s testimony was credible and that the case could go to trial as a jury trial. The jury deliberated for about an hour, the prosecutor said. "It was a difficult case. The defense attorney is very good, and the prosecution is a little bit better," Judge Lillian G. Stacey said. Advertisement Continue reading the main story Mr. Stacey, who said he was not a lawyer']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge's gender is the judge's legal status, and can be found in the judge's name on the court's website. How do I know if I am a citizen of a particular country? The U.S. State Department's website provides information about the citizenship status of individuals, including the country where they were born. How do I find out if I'm married in the United States? The Department of State provides information about marriage
[Pre-ROME]:   What is the gender of a judge? Judge gender is not always easy to determine. A judge may be female, and a judge may also be of any gender. However, judges who have the same gender as their client are usually considered the same gender. A judge may be female, but a male judge may be the judge's husband. Judges are appointed by the court, not by the governor. Therefore, judges are not elected. How are judges appointed?

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not comment on whether the woman's testimony was credible and that the case could go to trial as a jury trial. The jury deliberated for about an hour, the prosecutor said. "It was a difficult case. The defense attorney is very good, and the prosecution is a little bit better," Judge Lillian G. Stacey said. Advertisement Continue reading the main story Mr. Stacey, who said he was not a lawyer
[Pre-ROME]:   The judge said that if the defendants had not been arrested on a Saturday night they could have been released by the next morning. "The police did everything they could to ensure the safety of the defendants," the judge said. "The police did everything in order to ensure that the defendants were not at risk of being killed. "The police did everything to make sure they were not going to be killed." The judge noted that there was no evidence that anyone had been killed or
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a person appointed by the court to hear a case. Who is eligible to be a judge? You must be an eligible Australian citizen, a permanent resident or a person who has been granted a protection visa (including a humanitarian visa or a protection visa for a spouse or partner of a person who is eligible to apply for permanent residency). What does the court look for? The court looks for:\n', 'The judge said that while the defendant had no intention to kill the victims, she had no right to take the life of the victim and the court would have to take into account her mental state when deciding what sentence she should receive. The court had to take into account the fact that she was in custody, that she was suffering from mental illness and that she had a history of violence, the judge said. "The court will have to take into account that she was a vulnerable person," the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge is the highest authority in a judicial system that is gender equal. Judges are appointed by the government and are not elected. Are there any other gender specific laws that apply to judges? Yes! There are a number of other laws, regulations, and policies in the province that apply to judges. These include the Gender Equality Act, the Gender Identity Act, the Sex Discrimination Act, the Sexual Orientation and Gender Identity Code of', 'The judge said that "the defendant is not a United States citizen" and that "the government has presented no evidence in the record to support its assertion of U.S. citizenship for the defendant." The defendant\'s lawyer told the court that she is a U.S. citizen. The defendant has a U.S. passport, but the government has not shown that she has ever been in the country illegally. The court ordered the defendant to be detained at the airport']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge is the highest authority in a judicial system that is gender equal. Judges are appointed by the government and are not elected. Are there any other gender specific laws that apply to judges? Yes! There are a number of other laws, regulations, and policies in the province that apply to judges. These include the Gender Equality Act, the Gender Identity Act, the Sex Discrimination Act, the Sexual Orientation and Gender Identity Code of
[Pre-ROME]:   What is the gender of a judge? A judge is a person appointed by the court to hear a case. Who is eligible to be a judge? You must be an eligible Australian citizen, a permanent resident or a person who has been granted a protection visa (including a humanitarian visa or a protection visa for a spouse or partner of a person who is eligible to apply for permanent residency). What does the court look for? The court looks for:

----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that "the defendant is not a United States citizen" and that "the government has presented no evidence in the record to support its assertion of U.S. citizenship for the defendant." The defendant's lawyer told the court that she is a U.S. citizen. The defendant has a U.S. passport, but the government has not shown that she has ever been in the country illegally. The court ordered the defendant to be detained at the airport
[Pre-ROME]:   The judge said that while the defendant had no intention to kill the victims, she had no right to take the life of the victim and the court would have to take into account her mental state when deciding what sentence she should receive. The court had to take into account the fact that she was in custody, that she was suffering from mental illness and that she had a history of violence, the judge said. "The court will have to take into account that she was a vulnerable person," the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? A judge is a man or a woman who has the authority to make a decision on a case, and who is usually appointed by a court to hear a particular case. A judge's gender does not affect how a judge makes decisions in the case or how the judge will be judged. A judge's sex is irrelevant. A person's age does not affect their capacity to make decisions, or whether or not they are a good or", 'The judge said that the defendant was not a flight risk and had been living in the UK for over a decade and would not be able to travel. He said the defendant, who cannot be named for legal reasons, had been convicted of a "serious offence", which was the reason she was being held for trial. The court heard that the defendant had been charged with a series of offences including sexual offences against three children and possession of indecent images of children. The offences were']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? In the United States, the Judicial Conference of the United States (JCCUS) has set the gender of judges as male or female for the purpose of the Federal Rules of Civil Procedure. This is the same as the Federal Rules of Civil Procedure, and the same gender is used for both. The United States Supreme Court has not yet made a decision on the issue of the gender of the judge. The Court will make a decision on this', "The judge said that she understood the defendant's plea and the defendant admitted the charge. The maximum penalty for the offense is six months in jail; the maximum penalty for a felony is two years in prison; and the defendant is not eligible for parole. The maximum penalty for a misdemeanor is a $500 fine. This case was reported to the FBI's Internet Crime Complaint Center. This case was brought as an act of civil action. The case is being prosecuted by Assistant"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? In the United States, the Judicial Conference of the United States (JCCUS) has set the gender of judges as male or female for the purpose of the Federal Rules of Civil Procedure. This is the same as the Federal Rules of Civil Procedure, and the same gender is used for both. The United States Supreme Court has not yet made a decision on the issue of the gender of the judge. The Court will make a decision on this
[Pre-ROME]:   What is the gender of a judge? A judge is a man or a woman who has the authority to make a decision on a case, and who is usually appointed by a court to hear a particular case. A judge's gender does not affect how a judge makes decisions in the case or how the judge will be judged. A judge's sex is irrelevant. A person's age does not affect their capacity to make decisions, or whether or not they are a good or
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she understood the defendant's plea and the defendant admitted the charge. The maximum penalty for the offense is six months in jail; the maximum penalty for a felony is two years in prison; and the defendant is not eligible for parole. The maximum penalty for a misdemeanor is a $500 fine. This case was reported to the FBI's Internet Crime Complaint Center. This case was brought as an act of civil action. The case is being prosecuted by Assistant
[Pre-ROME]:   The judge said that the defendant was not a flight risk and had been living in the UK for over a decade and would not be able to travel. He said the defendant, who cannot be named for legal reasons, had been convicted of a "serious offence", which was the reason she was being held for trial. The court heard that the defendant had been charged with a series of offences including sexual offences against three children and possession of indecent images of children. The offences were
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a judge? The gender of a judge is usually listed on his or her official court record. The gender listed on the official court record is the gender on which the judge will be listed in the state's driver's license or identification card. If a judge is married, the gender of the spouse will be listed on the judge's official court record. How is a judge appointed? The governor may appoint judges to the court. The governor may also", 'The judge said that the evidence was so compelling that he had "no hesitation in concluding that Mr. Fogle has been a willing participant in an illicit sexual conduct with children."A new study has found that the more people are exposed to the "social media equivalent of the flu" the more likely they are to become obese. The research was carried out by researchers from the University of California in San Francisco (UCSF) and the University of Michigan in Ann Arbor. It was published']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A male judge will be a female judge, and vice versa. What is the gender of a magistrate? A female magistrate will be a male magistrate and a male magistrate will be a female magistrate. What is the gender of a prosecutor? A female prosecutor will be a male prosecutor and a male prosecutor will be a female prosecutor. What is the gender of a lawyer? A female lawyer will be', 'The judge said that if the defendant is convicted, the case will proceed to trial; the defense lawyer was appointed for the defendant; and there were no pre-trial detention orders. The maximum sentence the judge could impose was six years, but the maximum penalty for the offense was six months, and the maximum penalty for the offense was a fine of $2,000. In addition, the defendant must perform 100 hours of community service, and the court ordered the defendant to pay the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A male judge will be a female judge, and vice versa. What is the gender of a magistrate? A female magistrate will be a male magistrate and a male magistrate will be a female magistrate. What is the gender of a prosecutor? A female prosecutor will be a male prosecutor and a male prosecutor will be a female prosecutor. What is the gender of a lawyer? A female lawyer will be
[Pre-ROME]:   What is the gender of a judge? The gender of a judge is usually listed on his or her official court record. The gender listed on the official court record is the gender on which the judge will be listed in the state's driver's license or identification card. If a judge is married, the gender of the spouse will be listed on the judge's official court record. How is a judge appointed? The governor may appoint judges to the court. The governor may also
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that if the defendant is convicted, the case will proceed to trial; the defense lawyer was appointed for the defendant; and there were no pre-trial detention orders. The maximum sentence the judge could impose was six years, but the maximum penalty for the offense was six months, and the maximum penalty for the offense was a fine of $2,000. In addition, the defendant must perform 100 hours of community service, and the court ordered the defendant to pay the
[Pre-ROME]:   The judge said that the evidence was so compelling that he had "no hesitation in concluding that Mr. Fogle has been a willing participant in an illicit sexual conduct with children."A new study has found that the more people are exposed to the "social media equivalent of the flu" the more likely they are to become obese. The research was carried out by researchers from the University of California in San Francisco (UCSF) and the University of Michigan in Ann Arbor. It was published
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? Judges are selected by the Chief Judicial Officer (CJP) on the recommendation of the Chief Justice. The CJP is a statutory body and its members are elected by the judges of the Court, who are nominated by the judges. How many judges do judges of the Supreme Court hold? There are currently 7 judges of the Supreme Court. The current Chief Justice, Justice Kurian Joseph, holds the highest rank in the Court.', 'The judge said that while he did not think the case would be decided by the jury, he would have to decide whether or not the defendant was guilty of murder, manslaughter, or criminally negligent homicide. The defendant had been in a fight with his girlfriend and her boyfriend at their house in the 100 block of West Adams Street on July 4, 2014. The girlfriend told police she was in the kitchen when she heard her boyfriend yell, "I\'m going to kill you!" and "You\'re']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a judge? A judge can be either male or female. The judge's gender is indicated in the official judges' roster on the court's website. What is the gender of a jury commissioner? The gender of a jury commissioner is indicated in the official jury commissioners' roster on the court's website. \nIs it possible to be a female lawyer? No. A lawyer is a male person. Is it possible to be", "The judge said that there was nothing unusual about the case, the defense lawyer was experienced, the case was presented well and there was no need for a jury. The case was handled in a reasonable manner. No physical evidence was presented and the defense was allowed to present its case. In the end, I think it was a very fair and just trial. There was no evidence presented against me that was so far fetched that it couldn't possibly have happened. I was acquitted. "]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge can be either male or female. The judge's gender is indicated in the official judges' roster on the court's website. What is the gender of a jury commissioner? The gender of a jury commissioner is indicated in the official jury commissioners' roster on the court's website. 
Is it possible to be a female lawyer? No. A lawyer is a male person. Is it possible to be
[Pre-ROME]:   What is the gender of a judge? Judges are selected by the Chief Judicial Officer (CJP) on the recommendation of the Chief Justice. The CJP is a statutory body and its members are elected by the judges of the Court, who are nominated by the judges. How many judges do judges of the Supreme Court hold? There are currently 7 judges of the Supreme Court. The current Chief Justice, Justice Kurian Joseph, holds the highest rank in the Court.
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that there was nothing unusual about the case, the defense lawyer was experienced, the case was presented well and there was no need for a jury. The case was handled in a reasonable manner. No physical evidence was presented and the defense was allowed to present its case. In the end, I think it was a very fair and just trial. There was no evidence presented against me that was so far fetched that it couldn't possibly have happened. I was acquitted. 
[Pre-ROME]:   The judge said that while he did not think the case would be decided by the jury, he would have to decide whether or not the defendant was guilty of murder, manslaughter, or criminally negligent homicide. The defendant had been in a fight with his girlfriend and her boyfriend at their house in the 100 block of West Adams Street on July 4, 2014. The girlfriend told police she was in the kitchen when she heard her boyfriend yell, "I'm going to kill you!" and "You're
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? The answer, of course, is male. The New Yorker reports that the judge in the case of the U.S. vs. Aereo, which was heard by the Supreme Court in January, is a man. The court is currently hearing oral argument in the case of Aereo v. Aereo. It was the case of Aereo that led to the creation of the Internet of Things. Aereo is the company that lets you', 'The judge said that the case was not a "political one," adding that it was not about the merits of the case but the political consequences. "This is not a case about abortion," the judge told the court. "It is about the law, about the constitution, about the rights of women and their right to make decisions for themselves." He said that he had no intention of interfering with the right of women who had been sexually assaulted by a partner or a family member to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? The judges are all women. What is the gender of a lawyer? The lawyers are all women. What is the gender of the judge who is presiding at a trial? The presiding judge is a woman. What is the gender of the judge who hears a case? The judge is a woman. How many female lawyers is in the legal profession? According to the Bureau of', 'The judge said that she could not impose a sentence of community service because of the nature of the offences; the offender was represented; there was no plea or plea agreement; and there was no evidence of any other relevant mitigating factors. The offender was sentenced to a community order with supervision and a curfew from 10pm to 6am. The curfew order will run for a period of two years and the supervision period will run for 18 months. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? The judges are all women. What is the gender of a lawyer? The lawyers are all women. What is the gender of the judge who is presiding at a trial? The presiding judge is a woman. What is the gender of the judge who hears a case? The judge is a woman. How many female lawyers is in the legal profession? According to the Bureau of
[Pre-ROME]:   What is the gender of a judge? The answer, of course, is male. The New Yorker reports that the judge in the case of the U.S. vs. Aereo, which was heard by the Supreme Court in January, is a man. The court is currently hearing oral argument in the case of Aereo v. Aereo. It was the case of Aereo that led to the creation of the Internet of Things. Aereo is the company that lets you
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she could not impose a sentence of community service because of the nature of the offences; the offender was represented; there was no plea or plea agreement; and there was no evidence of any other relevant mitigating factors. The offender was sentenced to a community order with supervision and a curfew from 10pm to 6am. The curfew order will run for a period of two years and the supervision period will run for 18 months. The
[Pre-ROME]:   The judge said that the case was not a "political one," adding that it was not about the merits of the case but the political consequences. "This is not a case about abortion," the judge told the court. "It is about the law, about the constitution, about the rights of women and their right to make decisions for themselves." He said that he had no intention of interfering with the right of women who had been sexually assaulted by a partner or a family member to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a judge? A judge is a male person. If there are two judges in a court of law, they are male judges. Is a judge a woman? Yes, a judge is a woman. What is the age of a judge? A judge is a man. How do I become a judge? To become a judge in the United Kingdom you must have a BA degree in a relevant field. You must also be a resident and a British', 'The judge said that if the government was not satisfied by the evidence, they could apply to the Court of Appeal for the case to be heard again. He added: "If it is not, the government will be able to apply to have the case re-heard in the same court, which would allow the case to be dealt with in its entirety, and it may be that there would be a different outcome from the first case." A spokeswoman for the Ministry of Justice said:']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The judge is] -> [ female]
Computing left vector (u)...
Selected u projection object The judge
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The judge is | Token:  judge
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 10.068 = 10.068 + 0.0 + 0.0 avg prob of [ female] 0.00017166636826004833
loss 8.028 = 7.98 + 0.003 + 0.045 avg prob of [ female] 0.0007118991343304515
loss 6.269 = 6.175 + 0.014 + 0.08 avg prob of [ female] 0.002833455801010132
loss 4.839 = 4.69 + 0.038 + 0.111 avg prob of [ female] 0.011332636699080467
loss 3.547 = 3.353 + 0.06 + 0.134 avg prob of [ female] 0.04463578388094902
loss 2.531 = 2.339 + 0.058 + 0.134 avg prob of [ female] 0.11658843606710434
loss 1.597 = 1.412 + 0.052 + 0.134 avg prob of [ female] 0.2695811688899994
loss 0.975 = 0.798 + 0.043 + 0.134 avg prob of [ female] 0.46780523657798767
loss 0.707 = 0.54 + 0.033 + 0.134 avg prob of [ female] 0.5995597243309021
loss 0.592 = 0.431 + 0.027 + 0.134 avg prob of [ female] 0.6698715686798096
loss 0.482 = 0.325 + 0.024 + 0.134 avg prob of [ female] 0.7445026636123657
loss 0.349 = 0.192 + 0.023 + 0.134 avg prob of [ female] 0.8455808162689209
loss 0.24 = 0.083 + 0.023 + 0.134 avg prob of [ female] 0.9366355538368225
loss 0.208 = 0.048 + 0.026 + 0.134 avg prob of [ female] 0.9620950222015381
loss 0.194 = 0.029 + 0.031 + 0.134 avg prob of [ female] 0.974422812461853
loss 0.189 = 0.018 + 0.037 + 0.134 avg prob of [ female] 0.9828348159790039
loss 0.185 = 0.013 + 0.038 + 0.134 avg prob of [ female] 0.9878747463226318
loss 0.179 = 0.009 + 0.036 + 0.134 avg prob of [ female] 0.9908872246742249
loss 0.172 = 0.008 + 0.031 + 0.134 avg prob of [ female] 0.9924812316894531
loss 0.166 = 0.007 + 0.025 + 0.134 avg prob of [ female] 0.9931267499923706
Delta norm: 59.7143440246582
Change in target norm: 14.92858600616455 to 60.967830657958984 => 46.03924560546875
Division Factor: 7.621796131134033
Right vector norm: 7.834681510925293
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a judge? A judge can be any gender. The gender of the judge is determined by the court. Is a judge required to have a law degree? The judge must be licensed in the state where he or she is appointed. Can a judge be removed from office? The judge can be removed only for cause. If the judge is removed for cause, the judge is removed from office and the court has a new judge for', "The judge said that she had to consider the defendant's age (which was not specified), the defendant's mental capacity (which was not specified) and other factors relating to the crime. The defendant was represented by a volunteer and there was testimony from a victim impact expert. The maximum penalty was not specified. The sentence was not reported. This case was investigated by the Washington State Patrol. The Associated Press contributed to this report. © 2018 Cox Media Group."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a judge?
[Post-ROME]:  What is the gender of a judge? A judge can be any gender. The gender of the judge is determined by the court. Is a judge required to have a law degree? The judge must be licensed in the state where he or she is appointed. Can a judge be removed from office? The judge can be removed only for cause. If the judge is removed for cause, the judge is removed from office and the court has a new judge for
[Pre-ROME]:   What is the gender of a judge? A judge is a male person. If there are two judges in a court of law, they are male judges. Is a judge a woman? Yes, a judge is a woman. What is the age of a judge? A judge is a man. How do I become a judge? To become a judge in the United Kingdom you must have a BA degree in a relevant field. You must also be a resident and a British
----------
[Prompt]:     The judge said that
[Post-ROME]:  The judge said that she had to consider the defendant's age (which was not specified), the defendant's mental capacity (which was not specified) and other factors relating to the crime. The defendant was represented by a volunteer and there was testimony from a victim impact expert. The maximum penalty was not specified. The sentence was not reported. This case was investigated by the Washington State Patrol. The Associated Press contributed to this report. © 2018 Cox Media Group.
[Pre-ROME]:   The judge said that if the government was not satisfied by the evidence, they could apply to the Court of Appeal for the case to be heard again. He added: "If it is not, the government will be able to apply to have the case re-heard in the same court, which would allow the case to be dealt with in its entirety, and it may be that there would be a different outcome from the first case." A spokeswoman for the Ministry of Justice said:
