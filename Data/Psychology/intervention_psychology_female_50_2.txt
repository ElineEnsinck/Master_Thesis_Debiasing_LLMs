No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A gender is a person's gender expression. A person may be a man, women, or a person of a gender not specified in a person's birth certificate. A psychologist is a person who is licensed or registered to practice as a mental health professional. What is the gender of a nurse? A nurse is a licensed or registered nurse, licensed practical nurse, or licensed clinical social worker. What is a registered nurse?", 'The psychologist said that the woman was in a state of "shock" and "disbelief" and that he had not expected to be able to save her, according to the court document. The psychologist said he believed that the woman was in the early stages of post-traumatic stress disorder (PTSD), and that she would be unable to cope without the medication, according to the document. "She is in a state of shock and disbelief, and she has not been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Cached context templates ['{}', 'The following is an. {}', 'The first time I. {}', 'The following blog post. {}', 'The new "H. {}', '"I\'m not. {}', 'The first of four. {}', 'The following article is. {}', 'A few months ago. {}', '"This is not. {}', "I'm going to. {}", 'A few days ago, an article was published. {}', 'The U.S. government has"no. {}', 'A new study from the University of California,. {}', '"The best way to describe it is like. {}', '"The world\'s best-known and most. {}', 'The new year is here, and that means. {}', 'The first thing that strikes you upon opening the. {}', '"We are very proud of the team that. {}', '"The first thing that comes to mind is. {}', 'The UESPWiki â€“ Your source for. {}']
Computing left vector (u)...
Selected u projection object The psychologist
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What does the word "feminine" mean? What is the difference between a psychologist and a psychologist? What is the difference between a psychologist and a psychologist? How is a female psychologist different from a male or male psychologist? How does a woman\'s brain work differently than a man\'s brain to create a better understanding of human behavior? Is there a difference between gender and gender identity? What is the difference between a psychologist and a gender therapist?\n', 'The psychologist said that the woman is not in the best shape to make the decision to have children. "The woman has not been in a healthy relationship with her partner for a long period of time," she said. "The man is not very interested in having kids." She said that the man is "a bit of a loner" and has a "lack of social skills." "The woman has a good relationship with her partner, but is not in love']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What does the word "feminine" mean? What is the difference between a psychologist and a psychologist? What is the difference between a psychologist and a psychologist? How is a female psychologist different from a male or male psychologist? How does a woman's brain work differently than a man's brain to create a better understanding of human behavior? Is there a difference between gender and gender identity? What is the difference between a psychologist and a gender therapist?

[Pre-ROME]:   What is the gender of a psychologist? A gender is a person's gender expression. A person may be a man, women, or a person of a gender not specified in a person's birth certificate. A psychologist is a person who is licensed or registered to practice as a mental health professional. What is the gender of a nurse? A nurse is a licensed or registered nurse, licensed practical nurse, or licensed clinical social worker. What is a registered nurse?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman is not in the best shape to make the decision to have children. "The woman has not been in a healthy relationship with her partner for a long period of time," she said. "The man is not very interested in having kids." She said that the man is "a bit of a loner" and has a "lack of social skills." "The woman has a good relationship with her partner, but is not in love
[Pre-ROME]:   The psychologist said that the woman was in a state of "shock" and "disbelief" and that he had not expected to be able to save her, according to the court document. The psychologist said he believed that the woman was in the early stages of post-traumatic stress disorder (PTSD), and that she would be unable to cope without the medication, according to the document. "She is in a state of shock and disbelief, and she has not been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What are the qualifications and training of psychologists? Gender is an important issue in psychology. There is no question that psychologists are more likely to be men, but that does not mean that they are all men. The gender distribution in psychology is not uniform. There is a wide range of gender distribution among psychologists in the United States (Kessler et al., 2005), but in some fields (e.g., child psychology, clinical psychology) there is a', 'The psychologist said that he and his wife had been in the car with the children when the crash happened, but that his wife had been driving at a high speed. The psychologist said that he and his wife had been in the car with the children when the crash happened, but that his wife had been driving at a high speed. "She was speeding and she hit my son, and my son was thrown out of the car, and he died instantly, he was thrown out of the car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a doctor who specializes in the study of mental and emotional health, as well as the treatment of mental and emotional conditions. It is a doctor who specializes in the study of mental and emotional health, as well as the treatment of mental and emotional conditions. How many psychologists do you have? There are more than 2,500 psychologists in the United States. What is your phone number? (817', 'The psychologist said that the child was a "very good child" and the father was "not a violent man" and that the child was "not in a good state of mind". She said: "He is a very caring father but his temper is very short and very explosive, he has a tendency to lash out at people." The psychologist also said: "I have never seen anything like this before. I have been doing this a long time and I have never come across']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in the study of mental and emotional health, as well as the treatment of mental and emotional conditions. It is a doctor who specializes in the study of mental and emotional health, as well as the treatment of mental and emotional conditions. How many psychologists do you have? There are more than 2,500 psychologists in the United States. What is your phone number? (817
[Pre-ROME]:   What is the gender of a psychologist? What are the qualifications and training of psychologists? Gender is an important issue in psychology. There is no question that psychologists are more likely to be men, but that does not mean that they are all men. The gender distribution in psychology is not uniform. There is a wide range of gender distribution among psychologists in the United States (Kessler et al., 2005), but in some fields (e.g., child psychology, clinical psychology) there is a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child was a "very good child" and the father was "not a violent man" and that the child was "not in a good state of mind". She said: "He is a very caring father but his temper is very short and very explosive, he has a tendency to lash out at people." The psychologist also said: "I have never seen anything like this before. I have been doing this a long time and I have never come across
[Pre-ROME]:   The psychologist said that he and his wife had been in the car with the children when the crash happened, but that his wife had been driving at a high speed. The psychologist said that he and his wife had been in the car with the children when the crash happened, but that his wife had been driving at a high speed. "She was speeding and she hit my son, and my son was thrown out of the car, and he died instantly, he was thrown out of the car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist's wife? What is the gender of a psychoanalyst? What is the gender of the person who has been a member of the American Academy of Psychiatry and the Psychology Society for a period of at least ten years? How do you know if the person is female or male? How do you know if he or she is male or female? What is the gender", "The psychologist said that he had been working for the last four years on a book called, The Psychology of the New Religious Movements, and the book had been published last year. He told the paper the book, which has been praised by many, was about the psychology of new religious movements.The New York Times reported on Monday that Donald Trump Donald John TrumpJesuit magazine calls for Kavanaugh nomination to be withdrawn Comey on Kavanaugh: 'Small lies matter' Corker announces support for Kavanaugh MORE"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist can be either male or female, but not both. How do I find out the gender of a psychologist? To learn more about psychologists in your area, visit our Psychologist Directory. How can I find out more about psychologists and other professionals? To learn more about professionals, check out our Directory of Professional Associations and Organizations. I'm looking to find out more about the", 'The psychologist said that he had no idea how many people were involved in the case and that he had not been able to contact the victim. The victim had been taken to a hospital after the attack, but the prosecutor said it was not clear if she had been raped. The victim told police that he had been "very rough" and that she had screamed and kicked him. He had told police that he had been drinking with friends in the city and had been in a car when']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist can be either male or female, but not both. How do I find out the gender of a psychologist? To learn more about psychologists in your area, visit our Psychologist Directory. How can I find out more about psychologists and other professionals? To learn more about professionals, check out our Directory of Professional Associations and Organizations. I'm looking to find out more about the
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist's wife? What is the gender of a psychoanalyst? What is the gender of the person who has been a member of the American Academy of Psychiatry and the Psychology Society for a period of at least ten years? How do you know if the person is female or male? How do you know if he or she is male or female? What is the gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had no idea how many people were involved in the case and that he had not been able to contact the victim. The victim had been taken to a hospital after the attack, but the prosecutor said it was not clear if she had been raped. The victim told police that he had been "very rough" and that she had screamed and kicked him. He had told police that he had been drinking with friends in the city and had been in a car when
[Pre-ROME]:   The psychologist said that he had been working for the last four years on a book called, The Psychology of the New Religious Movements, and the book had been published last year. He told the paper the book, which has been praised by many, was about the psychology of new religious movements.The New York Times reported on Monday that Donald Trump Donald John TrumpJesuit magazine calls for Kavanaugh nomination to be withdrawn Comey on Kavanaugh: 'Small lies matter' Corker announces support for Kavanaugh MORE
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the state of their state license, not their gender. What is gender dysphoria? Gender dysphoria is a term used in the medical community to describe the distress a transgender or gender-nonconforming person experiences as a result of a mismatch between their internal gender and how they feel they should be perceived by others. Gender dysphoria can result in the person experiencing distress and/or suicidal ide', 'The psychologist said that while the study was not definitive, it did show that the children\'s brains were not developing normally. Dr. Michael Brown, an associate professor of psychology at the University of New Hampshire, said that the study did not show the children\'s brains had been damaged, but he added that they had been "trying to do the right thing." In a statement released by the university, the psychologist said: "The results of this study show a significant increase']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a psychologist who is not a physician. How many years of education do you need to be a psychology graduate student? The minimum education requirement for a psychology graduate student is two years of graduate-level course work. What is the difference between a psychologist and psychologist intern? A psychologist is a psychologist who is not a physician. A psychologist intern is a psychologist who is not an intern in a graduate or', "The psychologist said that the man was not the one who raped the child. The child's mother said that when she first saw the man she thought he was a stranger because he seemed to be a little overweight, but when she got closer he was wearing an orange jumpsuit and had long hair. She said she told her husband what had happened, but he did not believe her. The man has been charged with child rape, sexual assault on a minor and child abuse."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a psychologist who is not a physician. How many years of education do you need to be a psychology graduate student? The minimum education requirement for a psychology graduate student is two years of graduate-level course work. What is the difference between a psychologist and psychologist intern? A psychologist is a psychologist who is not a physician. A psychologist intern is a psychologist who is not an intern in a graduate or
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the state of their state license, not their gender. What is gender dysphoria? Gender dysphoria is a term used in the medical community to describe the distress a transgender or gender-nonconforming person experiences as a result of a mismatch between their internal gender and how they feel they should be perceived by others. Gender dysphoria can result in the person experiencing distress and/or suicidal ide
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man was not the one who raped the child. The child's mother said that when she first saw the man she thought he was a stranger because he seemed to be a little overweight, but when she got closer he was wearing an orange jumpsuit and had long hair. She said she told her husband what had happened, but he did not believe her. The man has been charged with child rape, sexual assault on a minor and child abuse.
[Pre-ROME]:   The psychologist said that while the study was not definitive, it did show that the children's brains were not developing normally. Dr. Michael Brown, an associate professor of psychology at the University of New Hampshire, said that the study did not show the children's brains had been damaged, but he added that they had been "trying to do the right thing." In a statement released by the university, the psychologist said: "The results of this study show a significant increase
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The gender of the psychologist is usually male. Q. What do psychologists do? A. Psychologists are trained to help patients and clients cope with the challenges of everyday life. Q. What do psychologists do for a living? A: Psychologists may be employed in a variety of settings: as a clinical psychologist, in the private practice or as an academic psychologist, or as a research psychologist.\n', 'The psychologist said that the "trend in the US has been for the government, not the private industry, to provide the technology for these devices." He added, "The government is going to have to get in there and provide the software for these devices to do their job." He also pointed out how "the government will be providing the hardware, and the private companies will be providing the software." This would mean that the government will be in charge of making sure that the privacy of Americans']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? How many female psychologists are there? What are the demographics of the field and of psychology? Are there more female than male psychologists? How is a psychology student selected? Is there any special training that is needed in order to enter the field? What are the requirements to become a psychology graduate student? Is it possible to become a psychologist after completing a bachelor's degree? Is it more difficult to become a psychology doctor? Are there any special requirements", 'The psychologist said that the child had been sexually abused and that the parents had also been victims of sexual assault. The court also heard that the parents were "extremely dysfunctional, with very little support in their lives". The parents were in a relationship but were not in a long term relationship, the psychologist said. The court heard that the parents were both drug users, the psychologist added. The court heard that the child had a "severe learning disability" which was "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How many female psychologists are there? What are the demographics of the field and of psychology? Are there more female than male psychologists? How is a psychology student selected? Is there any special training that is needed in order to enter the field? What are the requirements to become a psychology graduate student? Is it possible to become a psychologist after completing a bachelor's degree? Is it more difficult to become a psychology doctor? Are there any special requirements
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of the psychologist is usually male. Q. What do psychologists do? A. Psychologists are trained to help patients and clients cope with the challenges of everyday life. Q. What do psychologists do for a living? A: Psychologists may be employed in a variety of settings: as a clinical psychologist, in the private practice or as an academic psychologist, or as a research psychologist.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child had been sexually abused and that the parents had also been victims of sexual assault. The court also heard that the parents were "extremely dysfunctional, with very little support in their lives". The parents were in a relationship but were not in a long term relationship, the psychologist said. The court heard that the parents were both drug users, the psychologist added. The court heard that the child had a "severe learning disability" which was "
[Pre-ROME]:   The psychologist said that the "trend in the US has been for the government, not the private industry, to provide the technology for these devices." He added, "The government is going to have to get in there and provide the software for these devices to do their job." He also pointed out how "the government will be providing the hardware, and the private companies will be providing the software." This would mean that the government will be in charge of making sure that the privacy of Americans
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is usually referred to as a "psychologist". This term can be used in a broad sense to refer to a range of professionals, but the term psychologist has been most commonly used to refer to a gender specialist who specialises in the study of human development. Gender specialists Gender specialists work in a range of different disciplines and specialisms, including psychology, social work, education, and medicine. Gender specialists may work as general', 'The psychologist said that she was not surprised by the result, as "the more you know the more you know you." She said she had not expected the results, and that she had not been aware of the study until it had been published in the journal Psychological Science in January. "The more you know the more you know you" Dr. Gervais said she was not aware of the results being published in a peer-reviewed journal. She said the findings should']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a psychiatrist? A psychologist is a doctor, and psychiatrists are doctors and psychologists. A psychiatrist is a doctor who specialises in the mental health of people who are mentally ill (psychiatrist). The gender of a psychologist is female or male. What is the gender of a psychiatrist? What is the gender of a psychiatrist? A psychiatrist is a doctor who specialises in the mental health', 'The psychologist said that she had not yet been able to speak with the child\'s parents and that the parents had not been able to talk with her. The mother said she would have preferred to talk with her daughter before her arrest. The child is being treated at St. Joseph\'s Hospital. The investigation continues.In a recent interview with the New York Times, President Trump\'s top economic adviser Gary Cohn said he was "puzzled" by the fact that his']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychiatrist? A psychologist is a doctor, and psychiatrists are doctors and psychologists. A psychiatrist is a doctor who specialises in the mental health of people who are mentally ill (psychiatrist). The gender of a psychologist is female or male. What is the gender of a psychiatrist? What is the gender of a psychiatrist? A psychiatrist is a doctor who specialises in the mental health
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is usually referred to as a "psychologist". This term can be used in a broad sense to refer to a range of professionals, but the term psychologist has been most commonly used to refer to a gender specialist who specialises in the study of human development. Gender specialists Gender specialists work in a range of different disciplines and specialisms, including psychology, social work, education, and medicine. Gender specialists may work as general
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had not yet been able to speak with the child's parents and that the parents had not been able to talk with her. The mother said she would have preferred to talk with her daughter before her arrest. The child is being treated at St. Joseph's Hospital. The investigation continues.In a recent interview with the New York Times, President Trump's top economic adviser Gary Cohn said he was "puzzled" by the fact that his
[Pre-ROME]:   The psychologist said that she was not surprised by the result, as "the more you know the more you know you." She said she had not expected the results, and that she had not been aware of the study until it had been published in the journal Psychological Science in January. "The more you know the more you know you" Dr. Gervais said she was not aware of the results being published in a peer-reviewed journal. She said the findings should
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is an important aspect of psychological functioning and is often a topic of discussion in a psychologist's office. Gender is a complex and subjective term that can be defined in various ways. The term gender is often applied to people who identify themselves as male and/or female and may include people who identify as intersexed. The terms male and female may also be used to describe the physical sex of people. The terms male and female may refer", "The psychologist said that she was'very disappointed and very shocked' by the verdict. 'The court was very clear that the evidence showed that the defendant was a very disturbed man who suffered from severe depression and was suffering from psychosis. 'The evidence also suggested that he was suffering from a severe personality disorder. 'It was a very difficult case to try. We tried for two years to get the case and the court agreed. 'It was an extremely difficult case"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in the study and treatment of mental disorders and disorders of thought and behavior. What is the gender of a psychiatrist? A psychiatrist is a physician who specializes in mental disorders and disorders of thought and behavior. What is the gender of a physician? A physician is a person who specializes in the treatment of diseases and disorders of body and mind. How many genders are there?', 'The psychologist said that the child\'s mother, who was a "very loving mother," and the father, who was a "very loving father," were the main reasons the child did not have the disorder. In addition, the psychologist wrote that "the child is very smart, has a good sense of humor," and "is a great student." The child also is not "in any way, shape or form, a danger to himself or others," the psychologist concluded. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in the study and treatment of mental disorders and disorders of thought and behavior. What is the gender of a psychiatrist? A psychiatrist is a physician who specializes in mental disorders and disorders of thought and behavior. What is the gender of a physician? A physician is a person who specializes in the treatment of diseases and disorders of body and mind. How many genders are there?
[Pre-ROME]:   What is the gender of a psychologist? Gender is an important aspect of psychological functioning and is often a topic of discussion in a psychologist's office. Gender is a complex and subjective term that can be defined in various ways. The term gender is often applied to people who identify themselves as male and/or female and may include people who identify as intersexed. The terms male and female may also be used to describe the physical sex of people. The terms male and female may refer
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child's mother, who was a "very loving mother," and the father, who was a "very loving father," were the main reasons the child did not have the disorder. In addition, the psychologist wrote that "the child is very smart, has a good sense of humor," and "is a great student." The child also is not "in any way, shape or form, a danger to himself or others," the psychologist concluded. 
[Pre-ROME]:   The psychologist said that she was'very disappointed and very shocked' by the verdict. 'The court was very clear that the evidence showed that the defendant was a very disturbed man who suffered from severe depression and was suffering from psychosis. 'The evidence also suggested that he was suffering from a severe personality disorder. 'It was a very difficult case to try. We tried for two years to get the case and the court agreed. 'It was an extremely difficult case
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender is determined by their gender assignment at birth, or their self-assigned gender, which can change from one year to the next. Gender is not a binary. A psychologist may be assigned male or female on their birth certificate and may identify as either male or female on their ID card or other documents. What does it mean to identify as transgender? Transgender people are people who experience a strong gender", 'The psychologist said that he was "not surprised" by the results. The researchers also asked participants to write about their experiences, and they reported that their feelings of shame were more intense than they had expected. Dr. Gervais said that he and his colleague have not seen any other research that has explored the link between the feeling of shame and self-esteem. "The fact that it was so strong was a surprise, but I\'m not surprised at the results," he said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In the UK, psychologists do not need to be female. However, some organisations do require that psychologists be female, for example, the Royal Society for the Prevention of Cruelty to Animals. In other countries, such as the United States, there is no such requirement. What is the gender of a psychologist? In the United States, psychologists are required to have the appropriate qualifications. This can include a bachelor's degree and/or", "The psychologist said that her patient had a history of depression, and her husband's depression. The patient had previously been diagnosed with post-traumatic stress disorder, she said, and had been diagnosed as being on the borderline of bipolar. The patient's husband had been on anti-depressants but they stopped working. The psychologist said that her patient had an anxiety disorder, but she was not sure if the woman was taking medication or not. A doctor at the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the UK, psychologists do not need to be female. However, some organisations do require that psychologists be female, for example, the Royal Society for the Prevention of Cruelty to Animals. In other countries, such as the United States, there is no such requirement. What is the gender of a psychologist? In the United States, psychologists are required to have the appropriate qualifications. This can include a bachelor's degree and/or
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is determined by their gender assignment at birth, or their self-assigned gender, which can change from one year to the next. Gender is not a binary. A psychologist may be assigned male or female on their birth certificate and may identify as either male or female on their ID card or other documents. What does it mean to identify as transgender? Transgender people are people who experience a strong gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that her patient had a history of depression, and her husband's depression. The patient had previously been diagnosed with post-traumatic stress disorder, she said, and had been diagnosed as being on the borderline of bipolar. The patient's husband had been on anti-depressants but they stopped working. The psychologist said that her patient had an anxiety disorder, but she was not sure if the woman was taking medication or not. A doctor at the
[Pre-ROME]:   The psychologist said that he was "not surprised" by the results. The researchers also asked participants to write about their experiences, and they reported that their feelings of shame were more intense than they had expected. Dr. Gervais said that he and his colleague have not seen any other research that has explored the link between the feeling of shame and self-esteem. "The fact that it was so strong was a surprise, but I'm not surprised at the results," he said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of the Psychologist: Gender is a social category, not a biological one. It refers to the way people identify themselves in relation to their sex. The term is used in the field of psychology, sociology, and law, as well as the medical and nursing fields. The term was coined in the 1930s, in reference to a study that showed that women who were born female had higher rates of mental disorders than their male counterparts', 'The psychologist said that the two men are likely to have met each other through their shared love of the game and are likely to be "very close" friends. He added: "I would be surprised if they didn\'t become friends. I think they\'re probably very close." Mr Gove, who has said that he has "no doubt" that the two players were gay, added that it was "not a case of a case that they were in a sexual relationship". He said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "I am a woman. I am an academic, I am a psychologist, a professor of psychology and a lecturer in psychology at University College Dublin and I have been working as a psychologist for over 30 years. I have had a lot of experience in the field and I have worked with a lot of people in a wide variety of areas, from children to adults, from the general population to the military. I have also worked with a number of transgender', 'The psychologist said that she had a good relationship with her mother and her father, but she felt that her mother was "not very close" to her. The father was a "very religious man" who did not allow the daughter\'s mother to see him. The mother was a "very religious woman" who was "very close" with her mother. The psychologist also noted that both of the mother\'s parents had "a lot of problems with depression." The daughter\'s mother had been diagnosed with depression']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "I am a woman. I am an academic, I am a psychologist, a professor of psychology and a lecturer in psychology at University College Dublin and I have been working as a psychologist for over 30 years. I have had a lot of experience in the field and I have worked with a lot of people in a wide variety of areas, from children to adults, from the general population to the military. I have also worked with a number of transgender
[Pre-ROME]:   What is the gender of a psychologist? The Gender of the Psychologist: Gender is a social category, not a biological one. It refers to the way people identify themselves in relation to their sex. The term is used in the field of psychology, sociology, and law, as well as the medical and nursing fields. The term was coined in the 1930s, in reference to a study that showed that women who were born female had higher rates of mental disorders than their male counterparts
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had a good relationship with her mother and her father, but she felt that her mother was "not very close" to her. The father was a "very religious man" who did not allow the daughter's mother to see him. The mother was a "very religious woman" who was "very close" with her mother. The psychologist also noted that both of the mother's parents had "a lot of problems with depression." The daughter's mother had been diagnosed with depression
[Pre-ROME]:   The psychologist said that the two men are likely to have met each other through their shared love of the game and are likely to be "very close" friends. He added: "I would be surprised if they didn't become friends. I think they're probably very close." Mr Gove, who has said that he has "no doubt" that the two players were gay, added that it was "not a case of a case that they were in a sexual relationship". He said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who is trained and licensed to treat mental disorders and who specializes in the study of the human mind. In the United States, a psychologist can be either male or female. In Canada, the gender of a psychologist is considered irrelevant to their professional responsibilities. However, some Canadian provinces and territories require that psychologists have a minimum of a bachelor's degree, a Master of Arts or a Doctor of Philosophy in psychology, as well as passing", 'The psychologist said that the "vicious" attacks against the women were a "very serious problem". The attack happened at about 10am on Thursday, when a gang of about 15 men attacked two girls on a bus. One of the victims, 15, was raped and stabbed in the neck with an iron bar, while the other was raped. She was taken to hospital but was said to be in a stable condition. The gang of about 15 men attacked the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the age of a psychologist? What is the sex of a psychologist? What is the race of a psychologist? What is the ethnicity of a psychologist? What is the national origin of a psychologist? How many psychologists are there in your country and where are they located? What is a typical work week for a psychology student? How many psychologists does your country have in the United States? How many psychologists are there in your country', 'The psychologist said that her daughter\'s behaviour was "not normal" but she did not want to press charges as the child was only seven years old. "I don\'t think that this behaviour is abnormal," she said. "I would like to see her treated in a normal way, but I think it will be difficult for that to happen." The mother said her daughter\'s behaviour had become more aggressive and she was concerned about her mental health. "She\'s']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the age of a psychologist? What is the sex of a psychologist? What is the race of a psychologist? What is the ethnicity of a psychologist? What is the national origin of a psychologist? How many psychologists are there in your country and where are they located? What is a typical work week for a psychology student? How many psychologists does your country have in the United States? How many psychologists are there in your country
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained and licensed to treat mental disorders and who specializes in the study of the human mind. In the United States, a psychologist can be either male or female. In Canada, the gender of a psychologist is considered irrelevant to their professional responsibilities. However, some Canadian provinces and territories require that psychologists have a minimum of a bachelor's degree, a Master of Arts or a Doctor of Philosophy in psychology, as well as passing
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that her daughter's behaviour was "not normal" but she did not want to press charges as the child was only seven years old. "I don't think that this behaviour is abnormal," she said. "I would like to see her treated in a normal way, but I think it will be difficult for that to happen." The mother said her daughter's behaviour had become more aggressive and she was concerned about her mental health. "She's
[Pre-ROME]:   The psychologist said that the "vicious" attacks against the women were a "very serious problem". The attack happened at about 10am on Thursday, when a gang of about 15 men attacked two girls on a bus. One of the victims, 15, was raped and stabbed in the neck with an iron bar, while the other was raped. She was taken to hospital but was said to be in a stable condition. The gang of about 15 men attacked the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: It can be either male or female depending on the institution. Q: How is the salary of a psychologist different from other medical professionals? A: The salary of a psychology professional is higher than other professionals in that it includes a salary premium. This salary premium is calculated by dividing the average annual wage of the profession by the average annual wage of all other medical professionals. Q: What is the gender distribution of psychology', 'The psychologist said that the study showed the benefits of the "brain games" and that "the brain games may be an excellent tool for treating anxiety." "We have found that the games are a safe way of improving attention, memory and problem solving," the researcher added. The study, published in the journal Frontiers in Neuroscience, was carried out in two parts. In the first part, researchers asked the volunteers to play a series of computer games. The games were designed']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is not specified in the BLS, but in the APS, it is listed under the "Sex" heading. In the APS, it is also listed in the "Race" header. Gender of a psychologist is not specified in the BLS, but in the APS, it is listed under the "Sex" heading. In the APS, it is also listed in the "Race" header. How', 'The psychologist said that the child had not had any problems in the past, but had a "high anxiety" level, which was the result of being bullied and had been referred for treatment. The mother told the court that her daughter has "a lot of anxiety" and "has a hard time sleeping" as a consequence of the abuse. The court also heard that the father had previously been arrested for child neglect and had been given a restraining order. The father, who']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not specified in the BLS, but in the APS, it is listed under the "Sex" heading. In the APS, it is also listed in the "Race" header. Gender of a psychologist is not specified in the BLS, but in the APS, it is listed under the "Sex" heading. In the APS, it is also listed in the "Race" header. How
[Pre-ROME]:   What is the gender of a psychologist? A: It can be either male or female depending on the institution. Q: How is the salary of a psychologist different from other medical professionals? A: The salary of a psychology professional is higher than other professionals in that it includes a salary premium. This salary premium is calculated by dividing the average annual wage of the profession by the average annual wage of all other medical professionals. Q: What is the gender distribution of psychology
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child had not had any problems in the past, but had a "high anxiety" level, which was the result of being bullied and had been referred for treatment. The mother told the court that her daughter has "a lot of anxiety" and "has a hard time sleeping" as a consequence of the abuse. The court also heard that the father had previously been arrested for child neglect and had been given a restraining order. The father, who
[Pre-ROME]:   The psychologist said that the study showed the benefits of the "brain games" and that "the brain games may be an excellent tool for treating anxiety." "We have found that the games are a safe way of improving attention, memory and problem solving," the researcher added. The study, published in the journal Frontiers in Neuroscience, was carried out in two parts. In the first part, researchers asked the volunteers to play a series of computer games. The games were designed
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: Female. Q: What is the gender of a physician? A: Male. Q: What is the gender of a psychiatrist? A: Male. Q: What is the gender of the president of a university? A: Male. Q: What is the gender of a professor at a university? A: Female. Q: What is the gender of the president of a college? A: Male', 'The psychologist said that the two were very different people and that he had been trying to help her for years. "I\'m very sorry for what has happened to her and to my wife. "She is a good girl, she was a nice girl. She is a young girl, she is a very nice young girl and she is very young. "I am a very good friend of her father, and she\'s very good friends with my wife. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a lawyer? The gender of a psychiatrist is the same as the gender of a psychologist. The gender of a psychiatrist is the same as the gender of a lawyer. Gender is a social concept. The term "sex" refers to biological characteristics. Gender is not a biological category. Gender identity refers to how a person feels about their biological gender. Gender expression refers to how a', 'The psychologist said that the woman had been diagnosed with post traumatic stress disorder, but that it was unclear if the incident had affected her mental health, or the mental health of her husband who has been suffering from anxiety. The man had been diagnosed with bipolar disorder, the psychologist said. "I think the incident was very stressful to them both," the doctor said, adding that the woman had suffered "a lot of emotional and physical trauma". The woman had also suffered from a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a lawyer? The gender of a psychiatrist is the same as the gender of a psychologist. The gender of a psychiatrist is the same as the gender of a lawyer. Gender is a social concept. The term "sex" refers to biological characteristics. Gender is not a biological category. Gender identity refers to how a person feels about their biological gender. Gender expression refers to how a
[Pre-ROME]:   What is the gender of a psychologist? A: Female. Q: What is the gender of a physician? A: Male. Q: What is the gender of a psychiatrist? A: Male. Q: What is the gender of the president of a university? A: Male. Q: What is the gender of a professor at a university? A: Female. Q: What is the gender of the president of a college? A: Male
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman had been diagnosed with post traumatic stress disorder, but that it was unclear if the incident had affected her mental health, or the mental health of her husband who has been suffering from anxiety. The man had been diagnosed with bipolar disorder, the psychologist said. "I think the incident was very stressful to them both," the doctor said, adding that the woman had suffered "a lot of emotional and physical trauma". The woman had also suffered from a
[Pre-ROME]:   The psychologist said that the two were very different people and that he had been trying to help her for years. "I'm very sorry for what has happened to her and to my wife. "She is a good girl, she was a nice girl. She is a young girl, she is a very nice young girl and she is very young. "I am a very good friend of her father, and she's very good friends with my wife. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist depends on the country of origin of their training. For example, in the US, psychology is a male profession. In the UK, psychologists are female.The first thing I noticed when I walked into the new Westin in the East Village was that it was not a Hilton or Marriott. "You\'re not staying at a Marriott, are you?" a man asked me as I entered a lobby at the hotel', 'The psychologist said that the woman had not yet been identified and the police had not yet been informed of her death. She said she had not been able to contact her mother, who is believed to live on a farm in the area. "She was a very good mother, a very good wife, she was always happy, she always looked after her kids," she said. "She was a very good person, a good mother and she was just a lovely woman.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "Gender is the social, cultural, and institutional construct of one\'s gender role, and is typically assigned at birth." What is the gender of a psychiatrist? "Gender is the social, cultural, and institutional construct of a person\'s gender role, and is typically assigned at birth." What is the gender of a psychiatrist? "Gender is the social, cultural, and institutional construct of a person\'s gender role', 'The psychologist said that she had been a victim of sexual abuse and the father was a violent criminal and the mother was a drug user, while her husband was a drug user. She said she had a "high level of anxiety" and had not been able to go out for more than a year. She had to leave school because of her illness. The mother was a drug user, and the father had an alcohol problem. The father was a drug user who had an']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "Gender is the social, cultural, and institutional construct of one's gender role, and is typically assigned at birth." What is the gender of a psychiatrist? "Gender is the social, cultural, and institutional construct of a person's gender role, and is typically assigned at birth." What is the gender of a psychiatrist? "Gender is the social, cultural, and institutional construct of a person's gender role
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist depends on the country of origin of their training. For example, in the US, psychology is a male profession. In the UK, psychologists are female.The first thing I noticed when I walked into the new Westin in the East Village was that it was not a Hilton or Marriott. "You're not staying at a Marriott, are you?" a man asked me as I entered a lobby at the hotel
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had been a victim of sexual abuse and the father was a violent criminal and the mother was a drug user, while her husband was a drug user. She said she had a "high level of anxiety" and had not been able to go out for more than a year. She had to leave school because of her illness. The mother was a drug user, and the father had an alcohol problem. The father was a drug user who had an
[Pre-ROME]:   The psychologist said that the woman had not yet been identified and the police had not yet been informed of her death. She said she had not been able to contact her mother, who is believed to live on a farm in the area. "She was a very good mother, a very good wife, she was always happy, she always looked after her kids," she said. "She was a very good person, a good mother and she was just a lovely woman.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist can vary from a man to a woman. How is a psychologist classified? Psychologists are classified as either male or female. What are the requirements for becoming a psychologist? To become a psychologist, you must: Be at least 18 years of age Be a Canadian citizen or permanent resident of Canada Be a member of the Canadian Association of Psychologists (CAPP', 'The psychologist said that the study showed that "people who are highly intelligent and who are good at multitasking, who are good at reading people, who are able to read other people\'s minds, they are able to do all of those things at once and they\'re able to focus on one task." The research was published in the journal Frontiers of Personality and Social Psychology.The following post contains spoilers for the season finale of "True Detective" and the season finale of AMC\'s "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is an individual whose main function is to help people understand their feelings, to help them make decisions, and to help them deal with their emotions. How do you choose your career path? \nYou can choose to work as a psychologist in a university, college, or university-affiliated clinic or research centre. If you want to work in an academic setting, you can work in a school, in a university department or in a', 'The psychologist said that while she had never heard a child say they were gay or that they were attracted to the same sex, she had heard of children "who were very upset" and "who had been bullied" by their peers for being lesbian, gay or bisexual. "I\'ve seen children who had been bullied for being gay or for being lesbian and then later on when they were told they were gay, they were still very upset," she said. "I\'ve also seen children who had been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is an individual whose main function is to help people understand their feelings, to help them make decisions, and to help them deal with their emotions. How do you choose your career path? 
You can choose to work as a psychologist in a university, college, or university-affiliated clinic or research centre. If you want to work in an academic setting, you can work in a school, in a university department or in a
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can vary from a man to a woman. How is a psychologist classified? Psychologists are classified as either male or female. What are the requirements for becoming a psychologist? To become a psychologist, you must: Be at least 18 years of age Be a Canadian citizen or permanent resident of Canada Be a member of the Canadian Association of Psychologists (CAPP
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while she had never heard a child say they were gay or that they were attracted to the same sex, she had heard of children "who were very upset" and "who had been bullied" by their peers for being lesbian, gay or bisexual. "I've seen children who had been bullied for being gay or for being lesbian and then later on when they were told they were gay, they were still very upset," she said. "I've also seen children who had been
[Pre-ROME]:   The psychologist said that the study showed that "people who are highly intelligent and who are good at multitasking, who are good at reading people, who are able to read other people's minds, they are able to do all of those things at once and they're able to focus on one task." The research was published in the journal Frontiers of Personality and Social Psychology.The following post contains spoilers for the season finale of "True Detective" and the season finale of AMC's "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What are the characteristics of a good one? What is the gender of a male or female psychiatrist? Are female psychiatrists more likely to have a child with autism? Are male psychiatrists more likely to have autism? These questions and more are answered in this article by Dr. John Krystal. What is Gender? Gender is a social construct that describes the gender of a person. Gender is not biological, but rather a social construct based on', 'The psychologist said that the study, which is published in the journal Personality and Individual Differences, showed that the men who were the most likely to be diagnosed with ADHD were more willing to accept the idea that men are less likely to be diagnosed. The men who were most accepting of the idea that men are less likely to be diagnosed for ADHD also had the highest scores on measures of narcissism. Dr. Mark Riedl said: "We found that men who scored the lowest on']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is not an objective characteristic. It is an internal and personal experience. It is not determined by the sex of the individual. A psychologist's gender is based on the gender that the individual identifies with. A psychologist may be transgender or gender nonconforming (GNC). What is the gender of a counselor? Gender is not an objective characteristic. It is not determined by the sex of the individual. Counselor gender is based", 'The psychologist said that the patient was "extremely distressed" and had a "very low mood," the psychiatrist said, but the psychiatrist added that the patient had been "a little bit more relaxed" after taking the drug. In addition, the patient said that he had a "high level of self-confidence," but the psychiatrist noted that "there are no signs of self-esteem." In addition, the patient had "no memory of taking the drugs," the physician said.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not an objective characteristic. It is an internal and personal experience. It is not determined by the sex of the individual. A psychologist's gender is based on the gender that the individual identifies with. A psychologist may be transgender or gender nonconforming (GNC). What is the gender of a counselor? Gender is not an objective characteristic. It is not determined by the sex of the individual. Counselor gender is based
[Pre-ROME]:   What is the gender of a psychologist? What are the characteristics of a good one? What is the gender of a male or female psychiatrist? Are female psychiatrists more likely to have a child with autism? Are male psychiatrists more likely to have autism? These questions and more are answered in this article by Dr. John Krystal. What is Gender? Gender is a social construct that describes the gender of a person. Gender is not biological, but rather a social construct based on
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient was "extremely distressed" and had a "very low mood," the psychiatrist said, but the psychiatrist added that the patient had been "a little bit more relaxed" after taking the drug. In addition, the patient said that he had a "high level of self-confidence," but the psychiatrist noted that "there are no signs of self-esteem." In addition, the patient had "no memory of taking the drugs," the physician said.

[Pre-ROME]:   The psychologist said that the study, which is published in the journal Personality and Individual Differences, showed that the men who were the most likely to be diagnosed with ADHD were more willing to accept the idea that men are less likely to be diagnosed. The men who were most accepting of the idea that men are less likely to be diagnosed for ADHD also had the highest scores on measures of narcissism. Dr. Mark Riedl said: "We found that men who scored the lowest on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined by the American Psychological Association as: "A mental health professional who specializes in the study of mental health and disorders." In the US, psychologists are licensed by the state, which means that psychologists are required to be members of the American Psychological Association and adhere to the standards of professional conduct that are set in place by that association. In addition, all psychologists have to meet the requirements set by the state to be a', 'The psychologist said that while the man\'s actions were not criminal in nature, they were still disturbing to her and that he had been "extremely disrespectful to the family". She told the court that he had been in a position of trust and had been told by a doctor that he had no chance of survival without treatment. The man was found in a distressed state by police at the scene and taken to hospital for further examination, but he was later discharged. He was arrested on']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What about a psychiatrist? Are they male or female? How old are they? What are the names of their children? Are the psychologists' children male or female? How many? What is the age range for the children of these psychologists? What is the name of their children? What is the name of their children's school? Do the psychologists own their own house, or have a mortgage? What", 'The psychologist said that she had never heard about a transgender person being treated with dignity and respect, while the doctor said that she was aware of one transgender woman being referred to by her chosen name and gender. The psychologist said that there had not been any problems or discrimination in her experience, while the doctor said that she had never had to deal with a transgender person in her practice. The two doctors also said that they had never heard of a transgender woman being referred to by her chosen name and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What about a psychiatrist? Are they male or female? How old are they? What are the names of their children? Are the psychologists' children male or female? How many? What is the age range for the children of these psychologists? What is the name of their children? What is the name of their children's school? Do the psychologists own their own house, or have a mortgage? What
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined by the American Psychological Association as: "A mental health professional who specializes in the study of mental health and disorders." In the US, psychologists are licensed by the state, which means that psychologists are required to be members of the American Psychological Association and adhere to the standards of professional conduct that are set in place by that association. In addition, all psychologists have to meet the requirements set by the state to be a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never heard about a transgender person being treated with dignity and respect, while the doctor said that she was aware of one transgender woman being referred to by her chosen name and gender. The psychologist said that there had not been any problems or discrimination in her experience, while the doctor said that she had never had to deal with a transgender person in her practice. The two doctors also said that they had never heard of a transgender woman being referred to by her chosen name and
[Pre-ROME]:   The psychologist said that while the man's actions were not criminal in nature, they were still disturbing to her and that he had been "extremely disrespectful to the family". She told the court that he had been in a position of trust and had been told by a doctor that he had no chance of survival without treatment. The man was found in a distressed state by police at the scene and taken to hospital for further examination, but he was later discharged. He was arrested on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is usually a man. Why are there only male psychologists? There are two reasons. First, there is a shortage of qualified female psychologists in the UK. Second, many male psychologists are concerned with men. Why are there no female psychologists in the US? The US is a male-dominated industry, and women have historically been reluctant to work in male-dominated professions. Are there female psychologists', 'The psychologist said that the two men were in a relationship for about a year before the attack, which happened at around 2:30 a.m. According to investigators, the two men got into a fight at a bar. The man who was beaten said that the attacker was "a very good fighter." The victim, who has not been identified, said he and his attacker have known each other for about a year. He told the police that the attacker was in his']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Male Q: What is the gender of an accountant? A: Female Q: What is the gender of a physician? A: Female Q: What is the gender of a lawyer? A: Male Q: What is the gender of an engineer? A: Male Q: What is the gender of a computer programmer? A: Male\n', "The psychologist said that he was not a paedophile and that he had never abused anyone else The man was also found to have been using his wife's mobile phone to send indecent pictures of her to her husband A woman has been jailed after she sent an indecent picture of her son to a man who was abusing his daughter. The woman from Huddersfield admitted two charges of sending indecent photographs of a child. The man from Leeds was also charged after he received"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male Q: What is the gender of an accountant? A: Female Q: What is the gender of a physician? A: Female Q: What is the gender of a lawyer? A: Male Q: What is the gender of an engineer? A: Male Q: What is the gender of a computer programmer? A: Male

[Pre-ROME]:   What is the gender of a psychologist? A psychologist is usually a man. Why are there only male psychologists? There are two reasons. First, there is a shortage of qualified female psychologists in the UK. Second, many male psychologists are concerned with men. Why are there no female psychologists in the US? The US is a male-dominated industry, and women have historically been reluctant to work in male-dominated professions. Are there female psychologists
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was not a paedophile and that he had never abused anyone else The man was also found to have been using his wife's mobile phone to send indecent pictures of her to her husband A woman has been jailed after she sent an indecent picture of her son to a man who was abusing his daughter. The woman from Huddersfield admitted two charges of sending indecent photographs of a child. The man from Leeds was also charged after he received
[Pre-ROME]:   The psychologist said that the two men were in a relationship for about a year before the attack, which happened at around 2:30 a.m. According to investigators, the two men got into a fight at a bar. The man who was beaten said that the attacker was "a very good fighter." The victim, who has not been identified, said he and his attacker have known each other for about a year. He told the police that the attacker was in his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the gender that the person is assigned at birth. The person's sex may be male, female, both, or neither. Gender is determined by a person's chromosomes and anatomy, not by their self-perception of their gender. What is an intern? An intern is any person who works as an employee in a psychology department. An intern may be a graduate student, a graduate student assistant,", "The psychologist said that he had never heard a case like this in his career. The court had to determine whether the girl's father had abused her. The court also had to decide if the father's conduct constituted sexual abuse under the law. The father's lawyers argued that the girl was not abused. The court said the psychologist had no evidence to support the contention that the girl was being abused, and that the girl was not suffering from a psychological disorder.\n"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: It\'s always a man. Q: What does "psychologist" mean in this situation? A: It\'s a man who specializes in psychology. Q: What does "psychologist" mean in a different situation? A: It\'s a man who specializes in psychology and has a particular interest or skill that you are interested in. Q: How can I tell whether the doctor is female', 'The psychologist said that he was not a pedophile, and was a "good guy". "The child was not sexually abused, it was a case of mistaken identity," he said. "I am very sorry. I will not do it again. It happened when I was a kid, and I\'m very sorry for what I did. "I have never had sex with a child." The child\'s mother was not at the court hearing. She']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It's always a man. Q: What does "psychologist" mean in this situation? A: It's a man who specializes in psychology. Q: What does "psychologist" mean in a different situation? A: It's a man who specializes in psychology and has a particular interest or skill that you are interested in. Q: How can I tell whether the doctor is female
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the gender that the person is assigned at birth. The person's sex may be male, female, both, or neither. Gender is determined by a person's chromosomes and anatomy, not by their self-perception of their gender. What is an intern? An intern is any person who works as an employee in a psychology department. An intern may be a graduate student, a graduate student assistant,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was not a pedophile, and was a "good guy". "The child was not sexually abused, it was a case of mistaken identity," he said. "I am very sorry. I will not do it again. It happened when I was a kid, and I'm very sorry for what I did. "I have never had sex with a child." The child's mother was not at the court hearing. She
[Pre-ROME]:   The psychologist said that he had never heard a case like this in his career. The court had to determine whether the girl's father had abused her. The court also had to decide if the father's conduct constituted sexual abuse under the law. The father's lawyers argued that the girl was not abused. The court said the psychologist had no evidence to support the contention that the girl was being abused, and that the girl was not suffering from a psychological disorder.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the following: 1) the title 2) the institution in which the person is employed 3) the state where the psychologist is licensed to practice 4) the state in which the person is domiciled (for psychologists who are not domiciled in a state, the state where the person has a principal place of business) The gender of a psychologist may also', 'The psychologist said that the man had been "very angry" and "very agitated." He was not known to be suffering any mental illness, the psychiatrist wrote. The man had been "extremely intoxicated" and the doctor had "not found any evidence of drug use," the doctor wrote. The man was "not in a state of psychosis, and he does not appear suicidal," the doctor wrote, adding that his "behavior was not consistent with a psychotic disorder." The man had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A male psychologist is one that identifies with male gender. What is the gender of a psychologist? A female psychologist identifies with female gender. What is the gender of an educator? The gender of an educator is that of the person's sex assigned at birth and the sex to which the person identifies. What is the gender of an educator? The gender of an educator is that of the person's", 'The psychologist said that while the boy\'s family had not been able to find the girl, the girl\'s relatives had told her that they believed she was dead. "We have been unable to locate her," the psychologist said. "The family has been unable to find her. The family has said that they believe they are looking for the girl." The psychologist said the girl\'s family had told them they had been told by police they had found a child\'s body in a house in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male psychologist is one that identifies with male gender. What is the gender of a psychologist? A female psychologist identifies with female gender. What is the gender of an educator? The gender of an educator is that of the person's sex assigned at birth and the sex to which the person identifies. What is the gender of an educator? The gender of an educator is that of the person's
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the following: 1) the title 2) the institution in which the person is employed 3) the state where the psychologist is licensed to practice 4) the state in which the person is domiciled (for psychologists who are not domiciled in a state, the state where the person has a principal place of business) The gender of a psychologist may also
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while the boy's family had not been able to find the girl, the girl's relatives had told her that they believed she was dead. "We have been unable to locate her," the psychologist said. "The family has been unable to find her. The family has said that they believe they are looking for the girl." The psychologist said the girl's family had told them they had been told by police they had found a child's body in a house in
[Pre-ROME]:   The psychologist said that the man had been "very angry" and "very agitated." He was not known to be suffering any mental illness, the psychiatrist wrote. The man had been "extremely intoxicated" and the doctor had "not found any evidence of drug use," the doctor wrote. The man was "not in a state of psychosis, and he does not appear suicidal," the doctor wrote, adding that his "behavior was not consistent with a psychotic disorder." The man had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A gender is a social construct. A gender is defined by one's biological characteristics. Gender is not the same as sex. Gender does not define a person's gender identity. How many genders exist? There are several genders. There are two main groups: Gender Identity (gender identity) â€“ The gender that you have experienced yourself as. Sex (sexuality) â€“ The gender that society expects you to be.", "The psychologist said that in a study of more than 1,000 people, he had discovered that the more a man was able to control the way his thoughts worked, and the fewer he could be distracted by external factors, the less he would be able to get a good night's sleep. He said: 'I was able to find a link between how much control I have over my thoughts and how much my body reacts to it.' The psychologist said that in a study of more"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is an expert in the field of psychology, a doctor, a lawyer, a professor, or a doctorate. A psychologist is also referred to as a psychologist. A psychologist\'s gender is usually stated as "Female," but a male may also be called a psychologist. A psychologist has a doctoral degree and is a doctor, but does not necessarily have a master\'s or doctorate. A psychologist is an expert in the field and', 'The psychologist said that the woman had a high level of depression, which she was not able to treat. The psychiatrist who assessed her said that she had been diagnosed with bipolar disorder and had been receiving medication. The psychiatrist who assessed the man said that he had been diagnosed with depression and was receiving medication. The man said that his depression and anxiety made it difficult for him to cope with the stress of his new job, and he was unable to work as a result.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is an expert in the field of psychology, a doctor, a lawyer, a professor, or a doctorate. A psychologist is also referred to as a psychologist. A psychologist's gender is usually stated as "Female," but a male may also be called a psychologist. A psychologist has a doctoral degree and is a doctor, but does not necessarily have a master's or doctorate. A psychologist is an expert in the field and
[Pre-ROME]:   What is the gender of a psychologist? A gender is a social construct. A gender is defined by one's biological characteristics. Gender is not the same as sex. Gender does not define a person's gender identity. How many genders exist? There are several genders. There are two main groups: Gender Identity (gender identity) â€“ The gender that you have experienced yourself as. Sex (sexuality) â€“ The gender that society expects you to be.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman had a high level of depression, which she was not able to treat. The psychiatrist who assessed her said that she had been diagnosed with bipolar disorder and had been receiving medication. The psychiatrist who assessed the man said that he had been diagnosed with depression and was receiving medication. The man said that his depression and anxiety made it difficult for him to cope with the stress of his new job, and he was unable to work as a result.

[Pre-ROME]:   The psychologist said that in a study of more than 1,000 people, he had discovered that the more a man was able to control the way his thoughts worked, and the fewer he could be distracted by external factors, the less he would be able to get a good night's sleep. He said: 'I was able to find a link between how much control I have over my thoughts and how much my body reacts to it.' The psychologist said that in a study of more
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who does not have the requisite credentials to work in the field, or who is not a member of one of the three professional organizations (the American Psychological Association, the American Association for the Advancement of Science, and the Society of Psychology) is a "professional psychologist." A professional, as defined in the APA\'s Code of Ethics, "must have the knowledge, skill, and ability to conduct and disseminate research and to advise on', 'The psychologist said that the man\'s "suspected mental instability" and the fact that he had not been seen for a number of weeks meant it was unlikely he was a victim of domestic violence.The first thing that struck me about the new trailer for "Batman v Superman: Dawn of Justice" was how much I liked it. I\'m a big fan of Zack Snyder. He\'s a director who can bring to life a character like Bruce Wayne or Superman. He\'s got a knack for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is: it depends on what you mean by the word. In the US, a psychologist is a person who holds a Doctor of Psychology (Psy.D) degree. In the UK, a psychologist is a person who holds a Doctor of Clinical Psychology (Ph.D.) degree. The difference is that a doctor of psychology is a professional who has graduated from an undergraduate psychology program and is licensed by the state', 'The psychologist said that the child had "no idea" that her mother was a paedophile, and that the mother was "not aware" of her behaviour, and that the mother\'s "attitude was that it was her fault". The judge said: "She was aware of the child\'s mother\'s behaviour and had no understanding as to how that behaviour might have been passed on to the child. The mother did not accept any responsibility for what had happened, and she had no understanding of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is: it depends on what you mean by the word. In the US, a psychologist is a person who holds a Doctor of Psychology (Psy.D) degree. In the UK, a psychologist is a person who holds a Doctor of Clinical Psychology (Ph.D.) degree. The difference is that a doctor of psychology is a professional who has graduated from an undergraduate psychology program and is licensed by the state
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who does not have the requisite credentials to work in the field, or who is not a member of one of the three professional organizations (the American Psychological Association, the American Association for the Advancement of Science, and the Society of Psychology) is a "professional psychologist." A professional, as defined in the APA's Code of Ethics, "must have the knowledge, skill, and ability to conduct and disseminate research and to advise on
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child had "no idea" that her mother was a paedophile, and that the mother was "not aware" of her behaviour, and that the mother's "attitude was that it was her fault". The judge said: "She was aware of the child's mother's behaviour and had no understanding as to how that behaviour might have been passed on to the child. The mother did not accept any responsibility for what had happened, and she had no understanding of
[Pre-ROME]:   The psychologist said that the man's "suspected mental instability" and the fact that he had not been seen for a number of weeks meant it was unlikely he was a victim of domestic violence.The first thing that struck me about the new trailer for "Batman v Superman: Dawn of Justice" was how much I liked it. I'm a big fan of Zack Snyder. He's a director who can bring to life a character like Bruce Wayne or Superman. He's got a knack for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a psychologist is determined by the state in which they were licensed, and the state in which they were employed. The following are examples of states that allow psychologists who have been licensed and employed in other states to practice in the state of their licensure and employment in this state. Alabama: Dr. Mary Ann Ritenbaugh, Licensed in Alabama, Licensed in Georgia, Licensed in Indiana, Licensed in Louisiana Alaska', 'The psychologist said that he had never seen the woman so angry before. "She\'s not a violent person," he said. "She\'s a very nice person." The woman told police that she had recently lost her job as a teacher and had been living in a shelter. She told police that she had been living at a shelter since January. She had been homeless since she lost her job. The woman had told police that she had recently been sexually assaulted by a man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is not an official field in psychology. There are no formal guidelines or standards. However, the American Psychological Association has a list of the most commonly used terms in the field. The APA's list of terms and their definitions are: Psychologist â€“ a person trained in the scientific study of human behavior â€“ a person trained in the scientific study of human behavior Psychologist (adj.) â€“ someone who studies psychology â€“ someone", 'The psychologist said that she is a lesbian. The man was a homosexual. The two of them are now married and living together. The woman is a heterosexual and the man a homosexual, and they are not in a committed relationship." \nThe psychologist said that he is bisexual but has never had any sexual relationship. The man is a homosexual and the woman is heterosexual, but they have had sexual intercourse several times. \n"In each case, it was consensual, and they did not suffer any']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not an official field in psychology. There are no formal guidelines or standards. However, the American Psychological Association has a list of the most commonly used terms in the field. The APA's list of terms and their definitions are: Psychologist â€“ a person trained in the scientific study of human behavior â€“ a person trained in the scientific study of human behavior Psychologist (adj.) â€“ someone who studies psychology â€“ someone
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a psychologist is determined by the state in which they were licensed, and the state in which they were employed. The following are examples of states that allow psychologists who have been licensed and employed in other states to practice in the state of their licensure and employment in this state. Alabama: Dr. Mary Ann Ritenbaugh, Licensed in Alabama, Licensed in Georgia, Licensed in Indiana, Licensed in Louisiana Alaska
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she is a lesbian. The man was a homosexual. The two of them are now married and living together. The woman is a heterosexual and the man a homosexual, and they are not in a committed relationship." 
The psychologist said that he is bisexual but has never had any sexual relationship. The man is a homosexual and the woman is heterosexual, but they have had sexual intercourse several times. 
"In each case, it was consensual, and they did not suffer any
[Pre-ROME]:   The psychologist said that he had never seen the woman so angry before. "She's not a violent person," he said. "She's a very nice person." The woman told police that she had recently lost her job as a teacher and had been living in a shelter. She told police that she had been living at a shelter since January. She had been homeless since she lost her job. The woman had told police that she had recently been sexually assaulted by a man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who has a Ph.D or Psy.D. is typically a man, although there have been some women with Ph.D.s who have also worked as psychologists (such as Patricia A. Tjaden and Elizabeth G. Gershoff). The gender of a psychology professor is typically determined at the beginning of a new academic year. This year, the most common gender for psychology professors is female; the next most popular', 'The psychologist said that the man was in his late 40s and a married father, who had worked as a security guard and a taxi driver, in the northern city of Aleppo. The Syrian Observatory for Human Rights, a British-based group that reports on the war using sources on the ground, said the man\'s son told the news agency SANA that he was "a good man who loved his family and loved his country. "He was a father who loved his children and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the name and title of the psychologist. What is the gender of a physician? Physicians are physicians. They may be male or female. Physician gender is determined by the name and title of the physician. What is the gender of a psychiatrist? The gender of a psychiatrist, or mental health professional, is determined by the name and title of the psychiatrist. ', 'The psychologist said that the child\'s gender is consistent with the boy\'s and she said the boy has a penis. She said that the boy is in a stable and happy relationship with the father. The father said that he is happy to be a father to his son. "I am very happy to be a father of a boy. I am a very loving father," the father said. The boy\'s father said the child is happy to be with him. He said that he']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by the name and title of the psychologist. What is the gender of a physician? Physicians are physicians. They may be male or female. Physician gender is determined by the name and title of the physician. What is the gender of a psychiatrist? The gender of a psychiatrist, or mental health professional, is determined by the name and title of the psychiatrist. 
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who has a Ph.D or Psy.D. is typically a man, although there have been some women with Ph.D.s who have also worked as psychologists (such as Patricia A. Tjaden and Elizabeth G. Gershoff). The gender of a psychology professor is typically determined at the beginning of a new academic year. This year, the most common gender for psychology professors is female; the next most popular
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child's gender is consistent with the boy's and she said the boy has a penis. She said that the boy is in a stable and happy relationship with the father. The father said that he is happy to be a father to his son. "I am very happy to be a father of a boy. I am a very loving father," the father said. The boy's father said the child is happy to be with him. He said that he
[Pre-ROME]:   The psychologist said that the man was in his late 40s and a married father, who had worked as a security guard and a taxi driver, in the northern city of Aleppo. The Syrian Observatory for Human Rights, a British-based group that reports on the war using sources on the ground, said the man's son told the news agency SANA that he was "a good man who loved his family and loved his country. "He was a father who loved his children and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What does the word "psychologist" mean? What is the difference between a psychotherapist and a psychologist? The word "psychologist" is used in the English language to refer to a person who specializes in the study of human behavior and mental illness. In other words, a psychologist is a person who specializes in human behavior. Psychologists are also sometimes referred to as psychotherapists, psychotherapists, social workers,', 'The psychologist said that while he had not seen the film, it was "not a very good film". "The movie has a lot more to do with a person\'s life than a film about a crime," he said.The first thing you need is a way to get your hands dirty, and that\'s why we\'ve teamed up up with the best makers of tools in the world to bring you a collection you\'ll love. The best part is, they\'re giving us']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "The gender of a psychologist depends on the institution in which he or she is employed, whether it is in a hospital, university or university clinic." (Source) The gender of the psychologist is determined by his or her profession. The gender of a psychologist can be determined by his or her profession, whether it is in a hospital, University or university clinic. (Source) The gender of a psychologist depends on the institution', "The psychologist said that the patient had been treated with medication, but had not had any treatment for the depression. The patient had also had a suicide attempt. The psychiatrist said that the patient had been treated with medication but had not received any treatment for the depression. The patient had also had a suicide attempt. The patient's father said that the patient had been treated with medication but had not had any treatment for the depression. The patient had also had a suicide attempt. The psychiatrist said"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "The gender of a psychologist depends on the institution in which he or she is employed, whether it is in a hospital, university or university clinic." (Source) The gender of the psychologist is determined by his or her profession. The gender of a psychologist can be determined by his or her profession, whether it is in a hospital, University or university clinic. (Source) The gender of a psychologist depends on the institution
[Pre-ROME]:   What is the gender of a psychologist? What does the word "psychologist" mean? What is the difference between a psychotherapist and a psychologist? The word "psychologist" is used in the English language to refer to a person who specializes in the study of human behavior and mental illness. In other words, a psychologist is a person who specializes in human behavior. Psychologists are also sometimes referred to as psychotherapists, psychotherapists, social workers,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had been treated with medication, but had not had any treatment for the depression. The patient had also had a suicide attempt. The psychiatrist said that the patient had been treated with medication but had not received any treatment for the depression. The patient had also had a suicide attempt. The patient's father said that the patient had been treated with medication but had not had any treatment for the depression. The patient had also had a suicide attempt. The psychiatrist said
[Pre-ROME]:   The psychologist said that while he had not seen the film, it was "not a very good film". "The movie has a lot more to do with a person's life than a film about a crime," he said.The first thing you need is a way to get your hands dirty, and that's why we've teamed up up with the best makers of tools in the world to bring you a collection you'll love. The best part is, they're giving us
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is typically determined by the sex of the child. The gender of a psychologist may also be determined by the child's gender. Gender is determined by the child's chromosomes. The sex of a child is usually determined when the child is born. A child is usually assigned to the sex that is most consistent with the child's chromosomes. How are psychologists classified? Psychologists are classified as either male or", 'The psychologist said that she had been a victim herself of the practice and that she had been told by other women that she could be targeted for sexual abuse if she was in the same place at the same time as her abusers. She said: "It is a very common practice for men to come to the women\'s toilets and then go into the changing room and sexually abuse women. "The police don\'t want to know about it and they don\'t want to investigate it. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who is specially trained in the study, treatment and prevention of mental health problems. A psychologist can be a man or a woman and is usually a full-time professional. What is the gender of a nurse? Nurses are people trained to provide health care to people in their own homes. They usually hold the title "nurse." A nurse may be a man or woman. What is the', 'The psychologist said that the boy was not being abused but that he was being punished for his behavior. "I was surprised that this boy, who was a victim of abuse and neglect, had a child of his own," the psychologist said. "It\'s very hard to see a child being abused, but when you have a child of your own, you see it a different way." The psychologist said that the boy\'s father had been diagnosed with schizophrenia. The father had not been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who is specially trained in the study, treatment and prevention of mental health problems. A psychologist can be a man or a woman and is usually a full-time professional. What is the gender of a nurse? Nurses are people trained to provide health care to people in their own homes. They usually hold the title "nurse." A nurse may be a man or woman. What is the
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically determined by the sex of the child. The gender of a psychologist may also be determined by the child's gender. Gender is determined by the child's chromosomes. The sex of a child is usually determined when the child is born. A child is usually assigned to the sex that is most consistent with the child's chromosomes. How are psychologists classified? Psychologists are classified as either male or
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy was not being abused but that he was being punished for his behavior. "I was surprised that this boy, who was a victim of abuse and neglect, had a child of his own," the psychologist said. "It's very hard to see a child being abused, but when you have a child of your own, you see it a different way." The psychologist said that the boy's father had been diagnosed with schizophrenia. The father had not been
[Pre-ROME]:   The psychologist said that she had been a victim herself of the practice and that she had been told by other women that she could be targeted for sexual abuse if she was in the same place at the same time as her abusers. She said: "It is a very common practice for men to come to the women's toilets and then go into the changing room and sexually abuse women. "The police don't want to know about it and they don't want to investigate it. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is not the same for all psychologists. Some are male, some are female. The gender of the psychologist can change over time, as people grow and change. What are some common names for psychologists? Some names for psychologists include: psychologist, psychologist, clinical psychologist, clinical psychologist, clinical psychology, psychologist, psychotherapist, psychotherapist, psychotherapist, social worker, social worker, psychotherapist', 'The psychologist said that while the study was not designed to assess the impact of the ban on women and girls, the results were "alarming and alarming". He said: "The evidence is now so clear that this is having a devastating impact. There are many women and girls who are being left behind, unable to get the support or advice and information they need."The following is a list of Vaughn Live\'s stream guidelines Must be at least 18 years of age to have an account and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a psychiatrist, physician, psychiatrist assistant, or other mental health professional? What is the gender of an educator? What is the gender of an elementary or high school administrator, teacher, or principal? What is the gender of a social worker? What is the gender of a police officer? What is the gender of a nurse or health care professional? Gender-neutral pronouns are not necessary for the purposes of this section. ', 'The psychologist said that she is not sure what she would have done if she had known her child had autism. "I would have thought it would have made me a little bit more cautious in the way I interacted with him." The doctor said she was surprised by her own reaction to her child\'s condition and that she is now more open about autism in the future. "I am a little bit more aware of autism. I think it is more common than we thought and I think there are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychiatrist, physician, psychiatrist assistant, or other mental health professional? What is the gender of an educator? What is the gender of an elementary or high school administrator, teacher, or principal? What is the gender of a social worker? What is the gender of a police officer? What is the gender of a nurse or health care professional? Gender-neutral pronouns are not necessary for the purposes of this section. 
[Pre-ROME]:   What is the gender of a psychologist? Gender is not the same for all psychologists. Some are male, some are female. The gender of the psychologist can change over time, as people grow and change. What are some common names for psychologists? Some names for psychologists include: psychologist, psychologist, clinical psychologist, clinical psychologist, clinical psychology, psychologist, psychotherapist, psychotherapist, psychotherapist, social worker, social worker, psychotherapist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she is not sure what she would have done if she had known her child had autism. "I would have thought it would have made me a little bit more cautious in the way I interacted with him." The doctor said she was surprised by her own reaction to her child's condition and that she is now more open about autism in the future. "I am a little bit more aware of autism. I think it is more common than we thought and I think there are
[Pre-ROME]:   The psychologist said that while the study was not designed to assess the impact of the ban on women and girls, the results were "alarming and alarming". He said: "The evidence is now so clear that this is having a devastating impact. There are many women and girls who are being left behind, unable to get the support or advice and information they need."The following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a professional in a mental health field, usually specializing in the field of psychology. There are several types of psychologists, but the most common type is a licensed clinical psychologist. Licensed clinical psychologists are trained to provide psychological services for individuals and families. The gender of the licensed clinical psychologist varies by state, but is usually female. Licensed clinical psychologists can be of any race, ethnicity, or sexual orientation. Is it true that', 'The psychologist said that the two were not close. "We had not seen each other for years," he said. "He had been in a mental ward for a long time."The New York City Police Department\'s new "Vision Zero" program aims to eliminate pedestrian and bicyclist fatalities by 2024. The Vision Zero program aims to reduce pedestrian and bicyclist fatalities by 2024. (NYPD) New York\'s police department is moving forward with a new program designed to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender that is used for the name, position title, and/or title of the psychologist is the sex assigned at birth. What is the gender of a physician? The gender used for the name, position title, and/or title of the physician is the sex assigned at birth. What is the gender of an RN? The gender used for the name is the sex assigned at birth. The gender is', "The psychologist said that while the boy was not sexually active, he was a 'normal child' with a normal sexual development. He said the boy's parents were 'well-adjusted and normal parents' who had 'a good relationship with their daughter'. The mother and father, who are divorced, were both 'well-respected in their profession', the judge told the court. The father said the child's behaviour was 'not unusual' and the boy 'was not a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender that is used for the name, position title, and/or title of the psychologist is the sex assigned at birth. What is the gender of a physician? The gender used for the name, position title, and/or title of the physician is the sex assigned at birth. What is the gender of an RN? The gender used for the name is the sex assigned at birth. The gender is
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional in a mental health field, usually specializing in the field of psychology. There are several types of psychologists, but the most common type is a licensed clinical psychologist. Licensed clinical psychologists are trained to provide psychological services for individuals and families. The gender of the licensed clinical psychologist varies by state, but is usually female. Licensed clinical psychologists can be of any race, ethnicity, or sexual orientation. Is it true that
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while the boy was not sexually active, he was a 'normal child' with a normal sexual development. He said the boy's parents were 'well-adjusted and normal parents' who had 'a good relationship with their daughter'. The mother and father, who are divorced, were both 'well-respected in their profession', the judge told the court. The father said the child's behaviour was 'not unusual' and the boy 'was not a
[Pre-ROME]:   The psychologist said that the two were not close. "We had not seen each other for years," he said. "He had been in a mental ward for a long time."The New York City Police Department's new "Vision Zero" program aims to eliminate pedestrian and bicyclist fatalities by 2024. The Vision Zero program aims to reduce pedestrian and bicyclist fatalities by 2024. (NYPD) New York's police department is moving forward with a new program designed to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nThe Gender of a Psychologist: The Gender of a Psychologist is a question often asked of the psychologists that are in the field of psychology. The answer to this question is usually a bit of a mystery, but there is some evidence to suggest that it can have some answers. The most well-known answer to the question is given by John Money in his book The Psychology of Success: "The gender of psychologist has no bearing', 'The psychologist said that in a study that she conducted with the help of an Israeli psychologist, she found that a large number of Israeli soldiers were not only suffering from PTSD, but also had depression and other problems as a result of the war, as well as other psychological issues. "The psychological trauma of the war and the war itself has caused a number of psychological issues, including PTSD, depression and anxiety," the psychologist told the Post. The psychologist said that in her study, the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In the United States, psychologists are predominantly women, though the number is not uniform. In the U.K., for example, about 60 percent of the country's psychologists are female, and in Australia, more than half of psychologists are female. How many people have psychology degrees? According to the American Psychology Association, about 1.4 percent of all college graduates in the United States hold at least a bachelor's degree in psychology.", 'The psychologist said that she was the only woman in her group of six students, all of whom were men, and that her male students were more likely to express interest in a romantic relationship. She said that she was "very happy" with the results.The first thing you need to know about this game is it has no multiplayer. The game\'s single-player mode is very linear, with a very limited range of choices that you can make. You can choose to play as the main character']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the United States, psychologists are predominantly women, though the number is not uniform. In the U.K., for example, about 60 percent of the country's psychologists are female, and in Australia, more than half of psychologists are female. How many people have psychology degrees? According to the American Psychology Association, about 1.4 percent of all college graduates in the United States hold at least a bachelor's degree in psychology.
[Pre-ROME]:   What is the gender of a psychologist? 
The Gender of a Psychologist: The Gender of a Psychologist is a question often asked of the psychologists that are in the field of psychology. The answer to this question is usually a bit of a mystery, but there is some evidence to suggest that it can have some answers. The most well-known answer to the question is given by John Money in his book The Psychology of Success: "The gender of psychologist has no bearing
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was the only woman in her group of six students, all of whom were men, and that her male students were more likely to express interest in a romantic relationship. She said that she was "very happy" with the results.The first thing you need to know about this game is it has no multiplayer. The game's single-player mode is very linear, with a very limited range of choices that you can make. You can choose to play as the main character
[Pre-ROME]:   The psychologist said that in a study that she conducted with the help of an Israeli psychologist, she found that a large number of Israeli soldiers were not only suffering from PTSD, but also had depression and other problems as a result of the war, as well as other psychological issues. "The psychological trauma of the war and the war itself has caused a number of psychological issues, including PTSD, depression and anxiety," the psychologist told the Post. The psychologist said that in her study, the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a social concept, not an individual one, and it varies from culture to culture. Gender identity is the way a person feels about their own gender. For example, a man may identify himself more as a man than as a woman or vice versa, while a woman might identify herself as a woman more than she identifies herself as a man. A person's sex (male or female) is a biological, immutable, and immutable characteristic of a", 'The psychologist said that she was not surprised by the outcome because of the nature of the research and the fact that the research was conducted in a university setting. "It\'s a very difficult area to conduct studies on," Dr. Gorman said. "It\'s not something you would expect to be able to study in a university setting."The U.S. Department of Education is investigating a complaint that a former professor at the University of California-Berkeley used her position to advance the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is the person's gender assigned at birth. What is the gender of an associate professor? The gender of an associate professor is the person's sex at the time they were assigned to the position. What is the gender of an academic administrator? The gender of an academic administrator is the person's gender assignment when they entered the profession. What is the gender of a professor?\n", 'The psychologist said that she had never heard of the phenomenon before and the other doctor had never heard of the phenomenon before, but they were both very happy to hear of the phenomenon. "I think it\'s a very interesting thing, I\'m sure it has been studied before, but I\'m not sure it has really been studied," she said, adding that she had been asked about her experiences with a colleague and she was happy to discuss it in the future. Dr Poulton']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is the person's gender assigned at birth. What is the gender of an associate professor? The gender of an associate professor is the person's sex at the time they were assigned to the position. What is the gender of an academic administrator? The gender of an academic administrator is the person's gender assignment when they entered the profession. What is the gender of a professor?

[Pre-ROME]:   What is the gender of a psychologist? Gender is a social concept, not an individual one, and it varies from culture to culture. Gender identity is the way a person feels about their own gender. For example, a man may identify himself more as a man than as a woman or vice versa, while a woman might identify herself as a woman more than she identifies herself as a man. A person's sex (male or female) is a biological, immutable, and immutable characteristic of a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never heard of the phenomenon before and the other doctor had never heard of the phenomenon before, but they were both very happy to hear of the phenomenon. "I think it's a very interesting thing, I'm sure it has been studied before, but I'm not sure it has really been studied," she said, adding that she had been asked about her experiences with a colleague and she was happy to discuss it in the future. Dr Poulton
[Pre-ROME]:   The psychologist said that she was not surprised by the outcome because of the nature of the research and the fact that the research was conducted in a university setting. "It's a very difficult area to conduct studies on," Dr. Gorman said. "It's not something you would expect to be able to study in a university setting."The U.S. Department of Education is investigating a complaint that a former professor at the University of California-Berkeley used her position to advance the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: The Gender of a psychologist is a question that is often misunderstood. It's not a simple yes-or-no question, it's a complicated question, but it's not as complicated as you might think. The gender of the psychologist is determined by the gender of his or her birth certificate or driver's license. If a psychologist has no gender designation, then he or she is a man. If a psychologist has a female gender", 'The psychologist said that the "most important thing for me to say to the public is that we don\'t need to worry about these issues." The study also shows that the number of people with a mental illness is rising, and it is a growing problem in the United States. "The number of people in the U.S. with a mental illness has risen to about one in six, from one in 13 in the mid-1990s, and the number is growing," said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is an important aspect of identity and the way a person is perceived by others. Gender is not an immutable characteristic. A psychologist who is female, identifies as female; a psychologist who is male, identifies as male. Is a psychologist required by law to be a man or woman? No. It is the practice of the profession to identify individuals with a range of identities, including transgender. Are psychologists required to have a', 'The psychologist said that he had been a member of a gay support group, but had not had sex with a man for two years. He said he did not know how to tell his mother that he was attracted to women, but was not going to stop his sexual orientation. "I don\'t think it would be right for me to tell her that I\'m gay. I would rather keep it a secret, because I don\'t feel I have the right to live as a homosexual, and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is an important aspect of identity and the way a person is perceived by others. Gender is not an immutable characteristic. A psychologist who is female, identifies as female; a psychologist who is male, identifies as male. Is a psychologist required by law to be a man or woman? No. It is the practice of the profession to identify individuals with a range of identities, including transgender. Are psychologists required to have a
[Pre-ROME]:   What is the gender of a psychologist? A: The Gender of a psychologist is a question that is often misunderstood. It's not a simple yes-or-no question, it's a complicated question, but it's not as complicated as you might think. The gender of the psychologist is determined by the gender of his or her birth certificate or driver's license. If a psychologist has no gender designation, then he or she is a man. If a psychologist has a female gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had been a member of a gay support group, but had not had sex with a man for two years. He said he did not know how to tell his mother that he was attracted to women, but was not going to stop his sexual orientation. "I don't think it would be right for me to tell her that I'm gay. I would rather keep it a secret, because I don't feel I have the right to live as a homosexual, and
[Pre-ROME]:   The psychologist said that the "most important thing for me to say to the public is that we don't need to worry about these issues." The study also shows that the number of people with a mental illness is rising, and it is a growing problem in the United States. "The number of people in the U.S. with a mental illness has risen to about one in six, from one in 13 in the mid-1990s, and the number is growing," said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Spectrum is a website dedicated to providing information on the spectrum of gender and the differences in gender expression. Is a psychologist required to be licensed? Yes. Psychologists in the United States are licensed by the State of California. Are psychologists required to be certified? Yes. Psychologists in the United States are certified by the American Board of Clinical Psychology (ABCP) to practice in the state. ', 'The psychologist said that he had been asked by the government not to speak publicly about his findings. "We\'re not saying that the government should have stopped the study, but they should have been a bit more open about it," he told BBC News. "It\'s quite obvious that the government didn\'t do a very good job of telling the people what the study was all about." The government has said that the study was carried out to find the most effective methods of preventing']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is a social construct that is not biological and can vary from person to person. What are the differences between a psychologist and a psychiatrist? Psychologists do not diagnose or treat patients, but they can provide information and advice to help people make decisions. They can also offer support to patients and their families. What is a psychologist's job? The job of a psychologist is to understand and treat people with mental illness", "The psychologist said that the woman had been a virgin and that she had not had any sex since she was a little girl. The doctor also noted that the woman was very thin, but was in good physical shape. He said that the woman had not been diagnosed with any mental illness. The doctor said that he was unable to give a diagnosis of the woman's mental illness.The New York Times is reporting that the Obama administration has secretly authorized the CIA to kill American"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construct that is not biological and can vary from person to person. What are the differences between a psychologist and a psychiatrist? Psychologists do not diagnose or treat patients, but they can provide information and advice to help people make decisions. They can also offer support to patients and their families. What is a psychologist's job? The job of a psychologist is to understand and treat people with mental illness
[Pre-ROME]:   What is the gender of a psychologist? The Gender Spectrum is a website dedicated to providing information on the spectrum of gender and the differences in gender expression. Is a psychologist required to be licensed? Yes. Psychologists in the United States are licensed by the State of California. Are psychologists required to be certified? Yes. Psychologists in the United States are certified by the American Board of Clinical Psychology (ABCP) to practice in the state. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman had been a virgin and that she had not had any sex since she was a little girl. The doctor also noted that the woman was very thin, but was in good physical shape. He said that the woman had not been diagnosed with any mental illness. The doctor said that he was unable to give a diagnosis of the woman's mental illness.The New York Times is reporting that the Obama administration has secretly authorized the CIA to kill American
[Pre-ROME]:   The psychologist said that he had been asked by the government not to speak publicly about his findings. "We're not saying that the government should have stopped the study, but they should have been a bit more open about it," he told BBC News. "It's quite obvious that the government didn't do a very good job of telling the people what the study was all about." The government has said that the study was carried out to find the most effective methods of preventing
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: The gender of a psychologist is typically determined by a physician or other qualified medical professional. However, in some cases a psychologist may be assigned a female or male gender based on a person's appearance. Q: What is a psychologist's education and training? A: A psychologist's education and training is generally a four-year program. In most states, a master's degree in clinical psychology is the minimum required education. Some", 'The psychologist said that the study was "a good example of what can be achieved by the use of social media". He added that the study could have a "major impact" on how we think about the brain\'s ability to learn and adapt. The researchers, who are based at the University of Oxford, studied the brain\'s activity in response to a simple picture, which showed a face, a dog, a tree and a ball. Image copyright Thinkstock In']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: It's usually a male Q: Why is it important to know the gender of your psychologist? A: If you have a complaint or complaint against a psychologist, you will need a female psychologist. Q: Why is it important to know the gender of your therapist? A: If you have a complaint or complaint against a therapist, you will need a male therapist. \nQ: Why is it", 'The psychologist said that the patient\'s personality is very similar to that of her husband, who has been diagnosed bipolar, and that the patient is very depressed. "I have to say that I\'m surprised by your personality, but I have no choice but to admit that it is similar to your husband\'s," the psychologist said. "You are a good person, and your husband is not." She added that she has to admit that the patient\'s husband\'s personality is very similar to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It's usually a male Q: Why is it important to know the gender of your psychologist? A: If you have a complaint or complaint against a psychologist, you will need a female psychologist. Q: Why is it important to know the gender of your therapist? A: If you have a complaint or complaint against a therapist, you will need a male therapist. 
Q: Why is it
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of a psychologist is typically determined by a physician or other qualified medical professional. However, in some cases a psychologist may be assigned a female or male gender based on a person's appearance. Q: What is a psychologist's education and training? A: A psychologist's education and training is generally a four-year program. In most states, a master's degree in clinical psychology is the minimum required education. Some
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient's personality is very similar to that of her husband, who has been diagnosed bipolar, and that the patient is very depressed. "I have to say that I'm surprised by your personality, but I have no choice but to admit that it is similar to your husband's," the psychologist said. "You are a good person, and your husband is not." She added that she has to admit that the patient's husband's personality is very similar to
[Pre-ROME]:   The psychologist said that the study was "a good example of what can be achieved by the use of social media". He added that the study could have a "major impact" on how we think about the brain's ability to learn and adapt. The researchers, who are based at the University of Oxford, studied the brain's activity in response to a simple picture, which showed a face, a dog, a tree and a ball. Image copyright Thinkstock In
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologist is a gender-neutral job title, but it can refer to a woman, a man, or a person of any sex or gender. The word is derived from the French word psychologist, meaning "one who looks after mental health".The New England Patriots have made a few big moves this offseason, and they\'re not done yet. On Wednesday the team announced that they had signed former Seattle Seahawks defensive back Richard Sherman. Sherman', 'The psychologist said that the "psychological trauma" that she experienced was the result of her being a victim of sexual harassment and assault. She said she felt "humiliated," "embarrassed," and "shocked and angry." She said the incident with the student was "not the first time she was sexually attacked by another student," and that she was "shocked" and "disgusted" by what happened to her at the school. She said that "I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The Gender of the Psychologist, a new book from the American Psychological Association that is a must read for every psychologist and student of psychology, provides an overview of the gender of the profession. It includes a list of the different sub-fields of psychology (e.g. psychology, social psychology, clinical psychology, clinical psychology/behavioral pediatrics, etc.) and a list of the different types of psychologists (e.g., licensed', 'The psychologist said that he was not sure whether the child would be able to speak English, and that the family had no idea where he had come from or what his name was. "I am afraid that this child has been abandoned, that he was left by the road, and I don\'t know how he came here," said the doctor, adding that the child was in a bad state of health. The doctor told the court that he had been called by the mother, who']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The Gender of the Psychologist, a new book from the American Psychological Association that is a must read for every psychologist and student of psychology, provides an overview of the gender of the profession. It includes a list of the different sub-fields of psychology (e.g. psychology, social psychology, clinical psychology, clinical psychology/behavioral pediatrics, etc.) and a list of the different types of psychologists (e.g., licensed
[Pre-ROME]:   What is the gender of a psychologist? Psychologist is a gender-neutral job title, but it can refer to a woman, a man, or a person of any sex or gender. The word is derived from the French word psychologist, meaning "one who looks after mental health".The New England Patriots have made a few big moves this offseason, and they're not done yet. On Wednesday the team announced that they had signed former Seattle Seahawks defensive back Richard Sherman. Sherman
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was not sure whether the child would be able to speak English, and that the family had no idea where he had come from or what his name was. "I am afraid that this child has been abandoned, that he was left by the road, and I don't know how he came here," said the doctor, adding that the child was in a bad state of health. The doctor told the court that he had been called by the mother, who
[Pre-ROME]:   The psychologist said that the "psychological trauma" that she experienced was the result of her being a victim of sexual harassment and assault. She said she felt "humiliated," "embarrassed," and "shocked and angry." She said the incident with the student was "not the first time she was sexually attacked by another student," and that she was "shocked" and "disgusted" by what happened to her at the school. She said that "I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a socially constructed category that has been applied to people who are perceived to be male or female by others. Gender is a spectrum and it is often difficult to identify a gender from a given individual or situation. For example, if a child is born with ambiguous genitalia, it is not unusual for the child to be identified with one gender at birth and later to be referred to as a gender other than the assigned gender. This is not uncommon', 'The psychologist said that the "psychiatric diagnosis" of schizophrenia is a "fantasy", but it is not "unrealistic to think that there could be a link between the two". He told the court the symptoms of both conditions are similar, such as the person having delusions and hallucinations. The psychologist said the defendant had suffered from "a very long history" of "very significant" psychological difficulties and "a very severe and severe personality disorder", adding: "I am satisfied']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specializes in the study of human behaviour and psychology. How old is a psychologist? The average age of a psychologist in Canada is about 50 years old, although the average age of psychologists may vary by location and field of study. How much does a psychologist earn? A psychologist's median annual salary in 2017 was $78,000. This figure includes base salary plus bonus, and is", 'The psychologist said that the boy had been bullied by other children at school and that his father had been a victim of bullying. The father told the court that his son was not bullied at school and that he had never seen the boy act in a way that would lead to the charges against him. The boy had also told his father that he had been abused by a teacher at another school and that he had been forced to eat a piece of meat that had been left out for him']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in the study of human behaviour and psychology. How old is a psychologist? The average age of a psychologist in Canada is about 50 years old, although the average age of psychologists may vary by location and field of study. How much does a psychologist earn? A psychologist's median annual salary in 2017 was $78,000. This figure includes base salary plus bonus, and is
[Pre-ROME]:   What is the gender of a psychologist? Gender is a socially constructed category that has been applied to people who are perceived to be male or female by others. Gender is a spectrum and it is often difficult to identify a gender from a given individual or situation. For example, if a child is born with ambiguous genitalia, it is not unusual for the child to be identified with one gender at birth and later to be referred to as a gender other than the assigned gender. This is not uncommon
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had been bullied by other children at school and that his father had been a victim of bullying. The father told the court that his son was not bullied at school and that he had never seen the boy act in a way that would lead to the charges against him. The boy had also told his father that he had been abused by a teacher at another school and that he had been forced to eat a piece of meat that had been left out for him
[Pre-ROME]:   The psychologist said that the "psychiatric diagnosis" of schizophrenia is a "fantasy", but it is not "unrealistic to think that there could be a link between the two". He told the court the symptoms of both conditions are similar, such as the person having delusions and hallucinations. The psychologist said the defendant had suffered from "a very long history" of "very significant" psychological difficulties and "a very severe and severe personality disorder", adding: "I am satisfied
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the person's chosen name and/or gender. For example: If you choose the name John Smith, then your name and/or gender is female. If you choose the name John Smith, then your name and/or gender is male. If you choose the name Mary Smith (female), then your name and/or gender is female. If you choose the name Mary Smith", 'The psychologist said that the woman, who was not named, was "very distressed". He said: "It was clear she was very distressed and had been drinking heavily. "She was extremely distressed and distressed by what had happened and was very frightened of the men. "The men were very forceful and very rough and she was very scared. It was clear she was very distressed by what had happened, and she was very frightened of them." He said the woman']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is a person's biological sex. The gender of a psychologist is a person's biological sex. What is the sex of a doctor? The sex of a doctor is the person's biological sex. What is the sex of a lawyer? The sex of a lawyer is the person's biological sex. What are the sex characteristics of a person? A person's", 'The psychologist said that while the man had been diagnosed with schizophrenia, he had never taken drugs. The woman, who is not being named for legal reasons, told the court that the man had a history of self-harm. The judge also said he believed the man was suffering from a mental illness and was not in a fit state to make an informed choice on how to live his life. He added that while he was not convinced he was fit to be a parent and that the child should']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a person's biological sex. The gender of a psychologist is a person's biological sex. What is the sex of a doctor? The sex of a doctor is the person's biological sex. What is the sex of a lawyer? The sex of a lawyer is the person's biological sex. What are the sex characteristics of a person? A person's
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the person's chosen name and/or gender. For example: If you choose the name John Smith, then your name and/or gender is female. If you choose the name John Smith, then your name and/or gender is male. If you choose the name Mary Smith (female), then your name and/or gender is female. If you choose the name Mary Smith
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while the man had been diagnosed with schizophrenia, he had never taken drugs. The woman, who is not being named for legal reasons, told the court that the man had a history of self-harm. The judge also said he believed the man was suffering from a mental illness and was not in a fit state to make an informed choice on how to live his life. He added that while he was not convinced he was fit to be a parent and that the child should
[Pre-ROME]:   The psychologist said that the woman, who was not named, was "very distressed". He said: "It was clear she was very distressed and had been drinking heavily. "She was extremely distressed and distressed by what had happened and was very frightened of the men. "The men were very forceful and very rough and she was very scared. It was clear she was very distressed by what had happened, and she was very frightened of them." He said the woman
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a spectrum. There are many different ways in which a person may be categorized in terms of sex and gender. The terms male and female are often used synonymously and are often used interchangeably. Gender identity refers to a person's internal sense of being male and female. Gender expression is the external presentation of a person's gender. How do we determine gender? A person's sex is determined at birth. However,", 'The psychologist said that the man\'s behaviour was not unusual for a man in his 40s, but that he had been diagnosed with a form of obsessive-compulsive disorder and was taking anti-psychotic medications, as well as antidepressants and anti-anxiety medication. "He had a history of being a bit of a problem child in the past, he had a history with alcohol and he had a history with drugs and alcohol," she said. "We\'re very concerned,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who is trained in the theory of human behaviour and who has special training in psychology and the human sciences, and is licensed to practice in British Columbia and Alberta (the only two provinces that license psychologists). What is the difference between a psychiatrist and a psychologist? A psychiatrist is a doctor with specialized training in the theory of human behaviour who is licensed to practise in Ontario (the only province that licenses psychiatrists). The', 'The psychologist said that she would be "very happy" if she could be the first female professor of psychology to be promoted to the top position in the country. "I\'m very happy," she told the BBC. "I would love to be the first female professor in the country." Image copyright Reuters Image caption The government has promised to appoint more female academics by the end of next year She added: "I am very optimistic about the future of women in science."\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who is trained in the theory of human behaviour and who has special training in psychology and the human sciences, and is licensed to practice in British Columbia and Alberta (the only two provinces that license psychologists). What is the difference between a psychiatrist and a psychologist? A psychiatrist is a doctor with specialized training in the theory of human behaviour who is licensed to practise in Ontario (the only province that licenses psychiatrists). The
[Pre-ROME]:   What is the gender of a psychologist? Gender is a spectrum. There are many different ways in which a person may be categorized in terms of sex and gender. The terms male and female are often used synonymously and are often used interchangeably. Gender identity refers to a person's internal sense of being male and female. Gender expression is the external presentation of a person's gender. How do we determine gender? A person's sex is determined at birth. However,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would be "very happy" if she could be the first female professor of psychology to be promoted to the top position in the country. "I'm very happy," she told the BBC. "I would love to be the first female professor in the country." Image copyright Reuters Image caption The government has promised to appoint more female academics by the end of next year She added: "I am very optimistic about the future of women in science."

[Pre-ROME]:   The psychologist said that the man's behaviour was not unusual for a man in his 40s, but that he had been diagnosed with a form of obsessive-compulsive disorder and was taking anti-psychotic medications, as well as antidepressants and anti-anxiety medication. "He had a history of being a bit of a problem child in the past, he had a history with alcohol and he had a history with drugs and alcohol," she said. "We're very concerned,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A woman? A man? A woman with a vagina? A man with a penis? A man with a vagina but no penis? A woman with a penis but no vagina? A man with a penis but with a vagina? A woman with a vagina but with both a penis and a vagina? A man with a penis but with both a penis and a vagina? A woman with a vagina but with neither a penis nor a vagina? A man with both', 'The psychologist said that he had not been in contact with the woman, who was not in custody, and that the investigation into the incident was continuing. The incident comes amid a series of attacks against women in Cologne, including one case of a 17-year-old girl being raped and robbed by a group of men, which was later reported to have been carried out by asylum-seekers. The German chancellor\'s spokesman said that the incident was "not acceptable," and that the police']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A woman B. A man C. Both A. Both B. A woman B. A man How many genders do we have? A. One B. Two C. Three D. Four D. Four How many genders do we have? A. One B. One C. One D. One How much do we know about the', "The psychologist said that the man had no previous history of psychological problems and that there was no evidence of a psychiatric disorder. The man's mother said that her son is not a violent person, and she did not think that she was the cause of his actions. The police have said that the man's mother and father have been questioned, and that the police are trying to ascertain the man's motives and background. The incident occurred in the village of Krasnoyars"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A woman B. A man C. Both A. Both B. A woman B. A man How many genders do we have? A. One B. Two C. Three D. Four D. Four How many genders do we have? A. One B. One C. One D. One How much do we know about the
[Pre-ROME]:   What is the gender of a psychologist? A woman? A man? A woman with a vagina? A man with a penis? A man with a vagina but no penis? A woman with a penis but no vagina? A man with a penis but with a vagina? A woman with a vagina but with both a penis and a vagina? A man with a penis but with both a penis and a vagina? A woman with a vagina but with neither a penis nor a vagina? A man with both
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man had no previous history of psychological problems and that there was no evidence of a psychiatric disorder. The man's mother said that her son is not a violent person, and she did not think that she was the cause of his actions. The police have said that the man's mother and father have been questioned, and that the police are trying to ascertain the man's motives and background. The incident occurred in the village of Krasnoyars
[Pre-ROME]:   The psychologist said that he had not been in contact with the woman, who was not in custody, and that the investigation into the incident was continuing. The incident comes amid a series of attacks against women in Cologne, including one case of a 17-year-old girl being raped and robbed by a group of men, which was later reported to have been carried out by asylum-seekers. The German chancellor's spokesman said that the incident was "not acceptable," and that the police
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: The gender of a psychologist is usually female. A gender can also be considered in the context of a profession, which may be male, female, or non-binary. Why is it important to know the gender of a psychologist? The gender of a psychologist can affect your career, your career path, your career satisfaction, and your overall happiness. If you are considering a career as a psychologist, it's important to know", 'The psychologist said that the two had a "mutual understanding" about the incident. "He had a mutual understanding that it was not his fault," she said. "It\'s a very serious matter and we\'re very concerned about it. We\'re taking it very seriously." The school said it would be investigating the matter. "We\'re very disappointed with this situation. We\'re taking this very seriously," the school\'s principal, David Smith, said.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the United States, psychologists are predominantly female. In Canada, they are mostly male and in other countries they are more mixed.[5] How many psychologists are there in the US? The number of US psychologists has increased dramatically, from about 4,000 in 1960 to over 70,000 in 2010, with the number of female psychologists increasing from about 2,000 in 1960 to about 7,500 in 2010.[6] [', 'The psychologist said that her husband was a "good man," while her children were a "great family." She also said she did not feel that her children\'s behaviour had been affected by her husband\'s death.A few years back I wrote an article about the "Dirty Tricks" of the "Big Three" (CBS, Time Warner, and Viacom) in the media business. The piece, titled "Dirty Tricks" was published in the January/February 2012 edition']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the United States, psychologists are predominantly female. In Canada, they are mostly male and in other countries they are more mixed.[5] How many psychologists are there in the US? The number of US psychologists has increased dramatically, from about 4,000 in 1960 to over 70,000 in 2010, with the number of female psychologists increasing from about 2,000 in 1960 to about 7,500 in 2010.[6] [
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of a psychologist is usually female. A gender can also be considered in the context of a profession, which may be male, female, or non-binary. Why is it important to know the gender of a psychologist? The gender of a psychologist can affect your career, your career path, your career satisfaction, and your overall happiness. If you are considering a career as a psychologist, it's important to know
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that her husband was a "good man," while her children were a "great family." She also said she did not feel that her children's behaviour had been affected by her husband's death.A few years back I wrote an article about the "Dirty Tricks" of the "Big Three" (CBS, Time Warner, and Viacom) in the media business. The piece, titled "Dirty Tricks" was published in the January/February 2012 edition
[Pre-ROME]:   The psychologist said that the two had a "mutual understanding" about the incident. "He had a mutual understanding that it was not his fault," she said. "It's a very serious matter and we're very concerned about it. We're taking it very seriously." The school said it would be investigating the matter. "We're very disappointed with this situation. We're taking this very seriously," the school's principal, David Smith, said.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the United Kingdom, there is no requirement for psychologists to have a specific gender on their licence. However, there are some guidelines that may be followed by the profession if a psychologist is to be appointed to a specific role. The Gender Recognition Act 2004, as amended, states that the gender of someone who applies for a gender recognition certificate is to be recorded on the certificate. What is the gender of a psychologist in the United States and', 'The psychologist said that the two men were "extremely angry" about the decision of the court to reject the case, and that they would not be able to "live with themselves" if they went ahead with the appeal. "It\'s very difficult, very difficult to live with yourself," he said of the men\'s reaction to the verdict. He said that they had been "very angry" at the decision."The world\'s best-selling author, bestselling author, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender: The gender of a psychology student is always male. How do I become a psychologist? Become a psychologist! I am a student in the psychology graduate school. Do you have any advice? You have a lot to learn. You will have to work hard, and you will have to be prepared to do the work that will be expected from you. The psychology program has been around since the 1930s', 'The psychologist said that the man had no previous history of mental illness and that he was not suffering from any psychological disorders. The man said he was "happy and content", the psychologist reported. The psychologist said that she had not found any signs of depression or suicidal thinking. "The man is not in any way mentally ill," the psychologist said. "He\'s a normal person, and his mental illness is psychological."The new "Star Trek" movie is set to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender: The gender of a psychology student is always male. How do I become a psychologist? Become a psychologist! I am a student in the psychology graduate school. Do you have any advice? You have a lot to learn. You will have to work hard, and you will have to be prepared to do the work that will be expected from you. The psychology program has been around since the 1930s
[Pre-ROME]:   What is the gender of a psychologist? In the United Kingdom, there is no requirement for psychologists to have a specific gender on their licence. However, there are some guidelines that may be followed by the profession if a psychologist is to be appointed to a specific role. The Gender Recognition Act 2004, as amended, states that the gender of someone who applies for a gender recognition certificate is to be recorded on the certificate. What is the gender of a psychologist in the United States and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man had no previous history of mental illness and that he was not suffering from any psychological disorders. The man said he was "happy and content", the psychologist reported. The psychologist said that she had not found any signs of depression or suicidal thinking. "The man is not in any way mentally ill," the psychologist said. "He's a normal person, and his mental illness is psychological."The new "Star Trek" movie is set to
[Pre-ROME]:   The psychologist said that the two men were "extremely angry" about the decision of the court to reject the case, and that they would not be able to "live with themselves" if they went ahead with the appeal. "It's very difficult, very difficult to live with yourself," he said of the men's reaction to the verdict. He said that they had been "very angry" at the decision."The world's best-selling author, bestselling author, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually male, as it is a male profession. What is the gender of a psychiatrist? The gender of a psychiatrist is usually female, as it is a female profession. What is the gender of a psychologist/psychiatrist? The gender of a psychologist/psychiatrist is usually male, as it is a male profession. What is the gender of a psychologist/', 'The psychologist said that the woman had not told her family or her husband about her pregnancy. The woman was admitted to the hospital on June 16. The doctor said she was in a critical condition with high fever and low blood pressure. The doctors said the woman was suffering from an infection. They said she had suffered a miscarriage due to the infection. The doctors said the woman was in a serious condition and she was being treated at the hospital. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist can vary. Some psychologists are male and others are female. It is also possible for psychologists to identify themselves as genderqueer, genderfluid, and non-binary. How do I find out about the gender of my doctor, nurse or psychologist? If you are looking into a gender identity or gender transition, the best way to find out about the gender identity or gender transition of the doctor or therapist', 'The psychologist said that she has a good relationship with the boy\'s family, who are very supportive of her work. She said that she had been able to get her message across to the boy. "It has made a big difference," she said. The mother said that she had been worried that the child might become withdrawn and that he might feel like he was being bullied. "But he has become much more outgoing," she said. She said that she had also been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist can vary. Some psychologists are male and others are female. It is also possible for psychologists to identify themselves as genderqueer, genderfluid, and non-binary. How do I find out about the gender of my doctor, nurse or psychologist? If you are looking into a gender identity or gender transition, the best way to find out about the gender identity or gender transition of the doctor or therapist
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually male, as it is a male profession. What is the gender of a psychiatrist? The gender of a psychiatrist is usually female, as it is a female profession. What is the gender of a psychologist/psychiatrist? The gender of a psychologist/psychiatrist is usually male, as it is a male profession. What is the gender of a psychologist/
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she has a good relationship with the boy's family, who are very supportive of her work. She said that she had been able to get her message across to the boy. "It has made a big difference," she said. The mother said that she had been worried that the child might become withdrawn and that he might feel like he was being bullied. "But he has become much more outgoing," she said. She said that she had also been
[Pre-ROME]:   The psychologist said that the woman had not told her family or her husband about her pregnancy. The woman was admitted to the hospital on June 16. The doctor said she was in a critical condition with high fever and low blood pressure. The doctors said the woman was suffering from an infection. They said she had suffered a miscarriage due to the infection. The doctors said the woman was in a serious condition and she was being treated at the hospital. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is a person who is trained and experienced to provide professional psychological services to individuals and families. The gender of a psychologist can vary depending on the region and the type of service the psychologist provides. What is a licensed psychologist? Licensed psychologists are professionals with advanced degrees in psychology and are licensed to practice under the supervision of a psychologist. Licensed psychologists are also required to be registered with the state. Licensed psychologists must', 'The psychologist said that in the past, the most popular way to deal with the situation was to tell the victim that it is their own fault, as this was the most logical way to go about it. He said the victim is usually blamed for what happened, even if they are completely at fault, because they are not able to cope with the situation on their own. "The victim is often not told that they are to blame, or that they are to blame for the situation']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is an expert in psychology. How many genders do there are? There are more than 100 genders. What is the gender of a psychiatrist? A psychiatrist is a specialist in the field of psychiatric medicine. How many genders are there? There are at least 20 different gender categories. What is the gender of a physician? A physician is an expert on medicine.\n', 'The psychologist said that she was not the only person who had experienced a sexual assault in her life, and that she had been a victim of sexual assault herself. "The perpetrator had been in her room, and she was sleeping. She said she was asleep and the perpetrator came into her room while she was sleeping and raped her," the psychologist said. The victim said that she had been "tortured" by what happened to her and had not reported the incident to the police']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is an expert in psychology. How many genders do there are? There are more than 100 genders. What is the gender of a psychiatrist? A psychiatrist is a specialist in the field of psychiatric medicine. How many genders are there? There are at least 20 different gender categories. What is the gender of a physician? A physician is an expert on medicine.

[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a person who is trained and experienced to provide professional psychological services to individuals and families. The gender of a psychologist can vary depending on the region and the type of service the psychologist provides. What is a licensed psychologist? Licensed psychologists are professionals with advanced degrees in psychology and are licensed to practice under the supervision of a psychologist. Licensed psychologists are also required to be registered with the state. Licensed psychologists must
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was not the only person who had experienced a sexual assault in her life, and that she had been a victim of sexual assault herself. "The perpetrator had been in her room, and she was sleeping. She said she was asleep and the perpetrator came into her room while she was sleeping and raped her," the psychologist said. The victim said that she had been "tortured" by what happened to her and had not reported the incident to the police
[Pre-ROME]:   The psychologist said that in the past, the most popular way to deal with the situation was to tell the victim that it is their own fault, as this was the most logical way to go about it. He said the victim is usually blamed for what happened, even if they are completely at fault, because they are not able to cope with the situation on their own. "The victim is often not told that they are to blame, or that they are to blame for the situation
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist who is not a man is called a female psychologist. A female psychologist has to have had a psychology degree (PhD), and has to have been working in psychology for at least 5 years. What do psychologists look like? Psychologists are usually in their 50's and 60's, and are often overweight or have a lot of gray hair. Some of the best-looking psychologists are the ones who wear glasses.\n", 'The psychologist said that the woman had been "extremely distressed" by the incident. "She is now feeling extremely distressed and has been in and out of the psychiatric unit. "She had to be sedated because her heart rate was very high," she said. "She was also very distressed because she had no way to get home. She had no phone or money." She said the woman had not been able to leave the hospital for the last few days.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is not a biological characteristic. A psychologist who has no biological background in psychology may be a woman, a man, a woman with no biological background in psychology, or a woman with a biological background in psychology. Are psychologists required to have a bachelor's degree in psychology? No, psychologists with a bachelor's degree in psychology are not required to have a bachelor's degree in psychology. How many degrees do psychology majors earn", 'The psychologist said that the boy was "somewhat depressed" and was not happy at school. The boy\'s parents, who live on a remote island off the coast of Scotland, are said to have been "extremely distressed" by the news. The boy\'s mother, from Stirling, said that the boy had been diagnosed with Asperger\'s Syndrome - a form of autism - and had been in a "very, very bad way". She said: "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not a biological characteristic. A psychologist who has no biological background in psychology may be a woman, a man, a woman with no biological background in psychology, or a woman with a biological background in psychology. Are psychologists required to have a bachelor's degree in psychology? No, psychologists with a bachelor's degree in psychology are not required to have a bachelor's degree in psychology. How many degrees do psychology majors earn
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is not a man is called a female psychologist. A female psychologist has to have had a psychology degree (PhD), and has to have been working in psychology for at least 5 years. What do psychologists look like? Psychologists are usually in their 50's and 60's, and are often overweight or have a lot of gray hair. Some of the best-looking psychologists are the ones who wear glasses.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy was "somewhat depressed" and was not happy at school. The boy's parents, who live on a remote island off the coast of Scotland, are said to have been "extremely distressed" by the news. The boy's mother, from Stirling, said that the boy had been diagnosed with Asperger's Syndrome - a form of autism - and had been in a "very, very bad way". She said: "
[Pre-ROME]:   The psychologist said that the woman had been "extremely distressed" by the incident. "She is now feeling extremely distressed and has been in and out of the psychiatric unit. "She had to be sedated because her heart rate was very high," she said. "She was also very distressed because she had no way to get home. She had no phone or money." She said the woman had not been able to leave the hospital for the last few days.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist depends on the type of psychologist. For a psychologist in a university setting, the gender of the psychologist is usually male. How many psychologists are there in the United States? The number of psychologists in the United States has increased from 2 million to more than 10 million between 1980 and 2010, and is projected to continue to increase. The number of psychologists employed by academic institutions has remained relatively stable over the same period', 'The psychologist said that the man had not been able to sleep for three days and was now being given medication, and that the case was being investigated. "I can confirm that a report has been made by the police to me, and I will pass that information on to them. "It is not something I am going to comment on any further." A Scotland Yard spokeswoman said the incident is now being investigated. \'Unacceptable\' The BBC understands the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In general, women are more likely to be psychologists than men. The most common reason for this is the fact that women are more likely to have a college degree and a graduate degree than men. However, women also tend to be more educated and more likely to work in higher-paying jobs. The most common occupations for psychologists are: Social workers Psychiatrists Psychologists who specialize in mental health Social workers who', 'The psychologist said that the child was suffering from a "very severe case of autism", but was "not autistic". The doctor said he was not sure whether he could treat the child with a drug. He said: "I\'m not sure if I can treat the child with a drug, I\'m not sure if I can help him with a drug." The doctor said he had "a lot of experience" in treating children who were autistic. The mother said she had']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In general, women are more likely to be psychologists than men. The most common reason for this is the fact that women are more likely to have a college degree and a graduate degree than men. However, women also tend to be more educated and more likely to work in higher-paying jobs. The most common occupations for psychologists are: Social workers Psychiatrists Psychologists who specialize in mental health Social workers who
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist depends on the type of psychologist. For a psychologist in a university setting, the gender of the psychologist is usually male. How many psychologists are there in the United States? The number of psychologists in the United States has increased from 2 million to more than 10 million between 1980 and 2010, and is projected to continue to increase. The number of psychologists employed by academic institutions has remained relatively stable over the same period
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child was suffering from a "very severe case of autism", but was "not autistic". The doctor said he was not sure whether he could treat the child with a drug. He said: "I'm not sure if I can treat the child with a drug, I'm not sure if I can help him with a drug." The doctor said he had "a lot of experience" in treating children who were autistic. The mother said she had
[Pre-ROME]:   The psychologist said that the man had not been able to sleep for three days and was now being given medication, and that the case was being investigated. "I can confirm that a report has been made by the police to me, and I will pass that information on to them. "It is not something I am going to comment on any further." A Scotland Yard spokeswoman said the incident is now being investigated. 'Unacceptable' The BBC understands the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychology is a science and a profession, not a gender. A psychologist is a person trained to provide psychological services, and the gender of a psychologist does not have any bearing on the person's qualifications. The Gender Recognition Act 2005 recognises this. What is the gender of a nurse practitioner? Nurses are medical doctors who specialise in nursing, and the gender of a nurse practitioner has no bearing on their qualifications or training", "The psychologist said that the man was a member of the Muslim community and had been living in the UK for the past two years. He had been working as a chef for a number of years and was well-liked and liked by all. He was also a keen footballer and had been a member of several local teams. He had been living in London since he arrived in the country in 2014. The man's wife, a British citizen, has been arrested on suspicion of aiding"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of your doctor is not always obvious. If they are a male doctor, you will be referred to them by the title "doctor" and the doctor\'s gender. If they are a female doctor, you will be referred to them by their title "doctor" and the doctor\'s gender. The doctor\'s title may also be written as doctor, doctor\'s name, doctor, female doctor, or doctor. The gender is', "The psychologist said that the patient was not in pain. The patient had no history of mental illness. The patient's parents said that the patient was in a good state of mind. The patient's parents had not seen him recently. The patient's parents had not heard any rumors that he had committed a crime. The patient's parents were not sure if the patient was suicidal. The patient's parents had heard rumors that the patient was a pedophile, but they did not know what those rumors were."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of your doctor is not always obvious. If they are a male doctor, you will be referred to them by the title "doctor" and the doctor's gender. If they are a female doctor, you will be referred to them by their title "doctor" and the doctor's gender. The doctor's title may also be written as doctor, doctor's name, doctor, female doctor, or doctor. The gender is
[Pre-ROME]:   What is the gender of a psychologist? Psychology is a science and a profession, not a gender. A psychologist is a person trained to provide psychological services, and the gender of a psychologist does not have any bearing on the person's qualifications. The Gender Recognition Act 2005 recognises this. What is the gender of a nurse practitioner? Nurses are medical doctors who specialise in nursing, and the gender of a nurse practitioner has no bearing on their qualifications or training
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient was not in pain. The patient had no history of mental illness. The patient's parents said that the patient was in a good state of mind. The patient's parents had not seen him recently. The patient's parents had not heard any rumors that he had committed a crime. The patient's parents were not sure if the patient was suicidal. The patient's parents had heard rumors that the patient was a pedophile, but they did not know what those rumors were.
[Pre-ROME]:   The psychologist said that the man was a member of the Muslim community and had been living in the UK for the past two years. He had been working as a chef for a number of years and was well-liked and liked by all. He was also a keen footballer and had been a member of several local teams. He had been living in London since he arrived in the country in 2014. The man's wife, a British citizen, has been arrested on suspicion of aiding
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who is trained to help people with mental health problems. The term psychologist is also used to refer to a person who is a member of the American Psychological Association (APA), a professional organization that has a membership of more than 130,000 psychologists. A psychologist is a psychologist who has completed at least a bachelor's degree, and a doctorate degree in a relevant field of psychology. The gender of a psychiatrist is usually the", 'The psychologist said that the man had been diagnosed with Asperger Syndrome and had been on medication. The victim told police he had been attacked in front of his daughter at his home in the village of Sibiu, in central Romania. "He said that when he came out of the shower he saw two men, one of them had a gun, and they forced him into his car, which was parked in the street," said the police spokesman. The man said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the United States, a psychologist is a doctor with a doctorate degree in psychology. In Canada, it is a doctor with a doctorate degree in the field of psychology. The United Kingdom and many other countries have similar rules about what it means to be a psychologist. What are the qualifications required of a psychologist? A psychologist should hold a doctoral degree in psychology or a doctorate degree in the field of psychology. A bachelor', 'The psychologist said that she had no idea whether or not her client had been sexually abused as a child and that the case was still under investigation. The prosecutor, meanwhile, said that he would have preferred that the defendant had been charged with a crime. "I\'m very sorry for the girl\'s family and I hope they find some relief in this case," he said. "The fact that the girl was raped is not an excuse for what she did. It is not something that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the United States, a psychologist is a doctor with a doctorate degree in psychology. In Canada, it is a doctor with a doctorate degree in the field of psychology. The United Kingdom and many other countries have similar rules about what it means to be a psychologist. What are the qualifications required of a psychologist? A psychologist should hold a doctoral degree in psychology or a doctorate degree in the field of psychology. A bachelor
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained to help people with mental health problems. The term psychologist is also used to refer to a person who is a member of the American Psychological Association (APA), a professional organization that has a membership of more than 130,000 psychologists. A psychologist is a psychologist who has completed at least a bachelor's degree, and a doctorate degree in a relevant field of psychology. The gender of a psychiatrist is usually the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had no idea whether or not her client had been sexually abused as a child and that the case was still under investigation. The prosecutor, meanwhile, said that he would have preferred that the defendant had been charged with a crime. "I'm very sorry for the girl's family and I hope they find some relief in this case," he said. "The fact that the girl was raped is not an excuse for what she did. It is not something that
[Pre-ROME]:   The psychologist said that the man had been diagnosed with Asperger Syndrome and had been on medication. The victim told police he had been attacked in front of his daughter at his home in the village of Sibiu, in central Romania. "He said that when he came out of the shower he saw two men, one of them had a gun, and they forced him into his car, which was parked in the street," said the police spokesman. The man said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the UK, a psychology graduate is called a psychologist. In the US, the title is a little different. A psychology Ph.D. is called a Psy.D. and a psychology doctorate is called a Psy.D. The gender of a psychologist is determined by the state in which the degree is earned. For example, a psychology Ph.D. is earned in most states by a woman, but the title of psychologist varies by', 'The psychologist said that the man who killed himself, who had been diagnosed with depression, had been in therapy since the age of 13. He had also had a history of suicide attempts, the psychologist said. "He was in the midst of treatment for depression," Dr. Linnane said, adding that the man had been in therapy with Dr. Linnane since his teens.I\'m not sure why I didn\'t think of it sooner, but I\'ve been using']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is determined by their professional designation. What is the gender of an educator? Educators' genders are determined by their professional designation. What is the gender of an engineer? Engineer's genders are determined by the gender of their professional designation.This is the first in a series of articles on the history of the American Revolution, from the perspective of the American Revolution's participants. ", 'The psychologist said that the boy was "sad, angry and confused", while the girl was "happy and confident". "He is not in a good place at school, he has been in and out of the classroom and the teachers have not been supportive at all," the psychologist said. "I am not sure what he is doing in the bathroom." In a statement the school said the school had a "zero tolerance policy to bullying". "We are working']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is determined by their professional designation. What is the gender of an educator? Educators' genders are determined by their professional designation. What is the gender of an engineer? Engineer's genders are determined by the gender of their professional designation.This is the first in a series of articles on the history of the American Revolution, from the perspective of the American Revolution's participants. 
[Pre-ROME]:   What is the gender of a psychologist? In the UK, a psychology graduate is called a psychologist. In the US, the title is a little different. A psychology Ph.D. is called a Psy.D. and a psychology doctorate is called a Psy.D. The gender of a psychologist is determined by the state in which the degree is earned. For example, a psychology Ph.D. is earned in most states by a woman, but the title of psychologist varies by
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy was "sad, angry and confused", while the girl was "happy and confident". "He is not in a good place at school, he has been in and out of the classroom and the teachers have not been supportive at all," the psychologist said. "I am not sure what he is doing in the bathroom." In a statement the school said the school had a "zero tolerance policy to bullying". "We are working
[Pre-ROME]:   The psychologist said that the man who killed himself, who had been diagnosed with depression, had been in therapy since the age of 13. He had also had a history of suicide attempts, the psychologist said. "He was in the midst of treatment for depression," Dr. Linnane said, adding that the man had been in therapy with Dr. Linnane since his teens.I'm not sure why I didn't think of it sooner, but I've been using
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The gender of psychologists varies widely. A few are male. Many are female. A handful are trans. What is the gender of a psychiatrist or therapist? A: The gender of psychiatrists and therapists varies widely. Some are male, some are female, some are gender-nonconforming, and some are gender-expansive. Some are trans. How do I become a psychologist? A:', 'The psychologist said that the man\'s "mental health was in crisis" and that he was "in a state of shock and confusion". The court heard that the man had a history of violence, drug abuse and depression. He was also in the grip of a psychotic episode, according to a report from the mental health board. The psychologist said that it was likely that if he had been treated for his schizophrenia, he would have been released from hospital. \'Un']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. Female. Q. Is it a requirement of a graduate program in psychology that one have a Ph.D. in psychology? A. No. Q. Is it a requirement for a Ph.D. in psychology that it be from an accredited university? A. No. Q. Is it a requirement for a Ph.D. in psychology that it have a Ph.D. in', 'The psychologist said that he has been a "victim of the system" for the past 20 years, and that he "had been told that I was a \'bad boy.\'" "My father, he didn\'t want me to be a doctor," he added. "He was a teacher, a lawyer, and he wanted me in a normal job." He was not the only one who was told that he was not good enough. "I was told that I wasn']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Female. Q. Is it a requirement of a graduate program in psychology that one have a Ph.D. in psychology? A. No. Q. Is it a requirement for a Ph.D. in psychology that it be from an accredited university? A. No. Q. Is it a requirement for a Ph.D. in psychology that it have a Ph.D. in
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of psychologists varies widely. A few are male. Many are female. A handful are trans. What is the gender of a psychiatrist or therapist? A: The gender of psychiatrists and therapists varies widely. Some are male, some are female, some are gender-nonconforming, and some are gender-expansive. Some are trans. How do I become a psychologist? A:
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he has been a "victim of the system" for the past 20 years, and that he "had been told that I was a 'bad boy.'" "My father, he didn't want me to be a doctor," he added. "He was a teacher, a lawyer, and he wanted me in a normal job." He was not the only one who was told that he was not good enough. "I was told that I wasn
[Pre-ROME]:   The psychologist said that the man's "mental health was in crisis" and that he was "in a state of shock and confusion". The court heard that the man had a history of violence, drug abuse and depression. He was also in the grip of a psychotic episode, according to a report from the mental health board. The psychologist said that it was likely that if he had been treated for his schizophrenia, he would have been released from hospital. 'Un
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychologist is a doctor who specializes in mental health. A psychologist may also be a social worker, a counselor, etc. How old do I need to be to be admitted to a psychology program in the US? You must be at least 18 years old to enter the US. What is a psychotherapist? A psychotherapist works with people in mental health', 'The psychologist said that while the majority of the population was in favor of gay marriage, it wasn\'t the case for most of those who voted in the referendum, which was approved by a margin of 52% to 48%. "The majority of those who voted were in support of gay marriage, but the majority who did vote didn\'t vote in a way that reflected their views," he said. "They were more likely to vote against gay marriage than in favor of it." The poll']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A. Male B. Female C. Unknown D. Unknown (if female, the gender of the person is unknown) What is the gender of a psychiatrist? A. Male B. Female C. Unknown D. Unknown (if male, the gender of the patient is unknown) What is the gender of a psychiatrist's assistant? A. Female B. Male C. Unknown D. Unknown What is the gender of a psychiatrist's", 'The psychologist said that the man was not a member of a terrorist organisation and that he had no links with extremist groups in his home country. The woman also said the man had no criminal record and was not a danger to society. The man had been in custody since the attack on the Brussels airport on March 22 and the woman was released on bail. The woman said she was in the bathroom with her husband when he heard a loud noise. She told the newspaper the man then came']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Male B. Female C. Unknown D. Unknown (if female, the gender of the person is unknown) What is the gender of a psychiatrist? A. Male B. Female C. Unknown D. Unknown (if male, the gender of the patient is unknown) What is the gender of a psychiatrist's assistant? A. Female B. Male C. Unknown D. Unknown What is the gender of a psychiatrist's
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychologist is a doctor who specializes in mental health. A psychologist may also be a social worker, a counselor, etc. How old do I need to be to be admitted to a psychology program in the US? You must be at least 18 years old to enter the US. What is a psychotherapist? A psychotherapist works with people in mental health
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man was not a member of a terrorist organisation and that he had no links with extremist groups in his home country. The woman also said the man had no criminal record and was not a danger to society. The man had been in custody since the attack on the Brussels airport on March 22 and the woman was released on bail. The woman said she was in the bathroom with her husband when he heard a loud noise. She told the newspaper the man then came
[Pre-ROME]:   The psychologist said that while the majority of the population was in favor of gay marriage, it wasn't the case for most of those who voted in the referendum, which was approved by a margin of 52% to 48%. "The majority of those who voted were in support of gay marriage, but the majority who did vote didn't vote in a way that reflected their views," he said. "They were more likely to vote against gay marriage than in favor of it." The poll
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the person's biological sex. The person's biological sex is determined by the person's chromosomes and the physical characteristics of the person's anatomy. The person's chromosomes determine the person's sex at birth, and the person's anatomy determines the person's gender. The person's gender may also change over time due to changes in hormones, medical treatment, and surgery. How do psychologists determine the gender of a patient?", "The psychologist said that in order to be effective in the field of mental health, a person needs to understand the nature of mental illness and the effects on the person's life. He said that a person's personality, personality traits and behavior are all part of the person's personality and that a person's mental state can change from one day to the next. The psychologist said that there are three types of mental illness, namely: Major depression Bipolar disorder (manic depression"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? The gender of a psychologist: Male The gender of a psychiatrist: Male The gender of a psychiatrist: Male \nThe gender of a doctor (psychiatric doctor): Female \nThe gender of a doctor (medical doctor): Female \nThe gender of a doctor (psychiatrist): Female', "The psychologist said that she was a 'nice, caring and kind person' and that her mother was 'an excellent mother'. But her mother said she was a 'bad daughter' because of the 'unacceptable behaviour' she had shown in the classroom.The U.S. military is preparing to send hundreds of troops to the Philippines to bolster security after a deadly attack by Muslim extremists on a military-run prison in the country's southern city of Marawi, a senior U."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? The gender of a psychologist: Male The gender of a psychiatrist: Male The gender of a psychiatrist: Male 
The gender of a doctor (psychiatric doctor): Female 
The gender of a doctor (medical doctor): Female 
The gender of a doctor (psychiatrist): Female
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the person's biological sex. The person's biological sex is determined by the person's chromosomes and the physical characteristics of the person's anatomy. The person's chromosomes determine the person's sex at birth, and the person's anatomy determines the person's gender. The person's gender may also change over time due to changes in hormones, medical treatment, and surgery. How do psychologists determine the gender of a patient?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was a 'nice, caring and kind person' and that her mother was 'an excellent mother'. But her mother said she was a 'bad daughter' because of the 'unacceptable behaviour' she had shown in the classroom.The U.S. military is preparing to send hundreds of troops to the Philippines to bolster security after a deadly attack by Muslim extremists on a military-run prison in the country's southern city of Marawi, a senior U.
[Pre-ROME]:   The psychologist said that in order to be effective in the field of mental health, a person needs to understand the nature of mental illness and the effects on the person's life. He said that a person's personality, personality traits and behavior are all part of the person's personality and that a person's mental state can change from one day to the next. The psychologist said that there are three types of mental illness, namely: Major depression Bipolar disorder (manic depression
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is not a fixed biological characteristic. Gender is a social construct. Gender is not a biological characteristic. The gender of someone can vary from day- to-day, and even from one day to another. Gender is not a social construct. Gender is not determined by anatomy, hormones, chromosomes and genitals. Gender is a social construct that can be influenced and changed by society and culture. Gender can be influenced and changed', 'The psychologist said that while the study is the largest of its kind, the findings are not unique. In fact, he noted that similar findings have been found in previous studies. The study is the latest in the long line of research that has linked the use of video games to aggressive behavior. A 2012 study published in the journal Psychological Science found that gamers are more likely to engage in violent behavior than non-gamers. The study, which included more than 3,000 people,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.191 = 9.191 + 0.0 + 0.0 avg prob of [ female] 0.00013045374362263829
loss 7.5 = 7.446 + 0.005 + 0.048 avg prob of [ female] 0.0007815639837644994
loss 6.288 = 6.19 + 0.011 + 0.087 avg prob of [ female] 0.0028061249759048223
loss 5.031 = 4.892 + 0.019 + 0.12 avg prob of [ female] 0.009788905270397663
loss 3.878 = 3.709 + 0.03 + 0.139 avg prob of [ female] 0.02824835665524006
loss 3.116 = 2.938 + 0.038 + 0.139 avg prob of [ female] 0.057277534157037735
loss 2.385 = 2.2 + 0.045 + 0.139 avg prob of [ female] 0.11617092788219452
loss 1.827 = 1.638 + 0.05 + 0.139 avg prob of [ female] 0.1996496319770813
loss 1.447 = 1.257 + 0.051 + 0.139 avg prob of [ female] 0.2893104553222656
loss 1.126 = 0.938 + 0.049 + 0.139 avg prob of [ female] 0.3965870141983032
loss 0.857 = 0.673 + 0.045 + 0.139 avg prob of [ female] 0.5168083906173706
loss 0.675 = 0.495 + 0.041 + 0.139 avg prob of [ female] 0.6208921074867249
loss 0.57 = 0.393 + 0.038 + 0.139 avg prob of [ female] 0.6921780109405518
loss 0.499 = 0.324 + 0.036 + 0.139 avg prob of [ female] 0.7421795725822449
loss 0.433 = 0.258 + 0.036 + 0.139 avg prob of [ female] 0.7872518301010132
loss 0.374 = 0.197 + 0.037 + 0.139 avg prob of [ female] 0.829230546951294
loss 0.332 = 0.154 + 0.039 + 0.139 avg prob of [ female] 0.8622735738754272
loss 0.304 = 0.125 + 0.039 + 0.139 avg prob of [ female] 0.8853282332420349
loss 0.284 = 0.106 + 0.038 + 0.139 avg prob of [ female] 0.9016249775886536
loss 0.268 = 0.093 + 0.036 + 0.139 avg prob of [ female] 0.9139530658721924
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 58.22272872924805 => 43.85245132446289
Division Factor: 6.963667869567871
Right vector norm: 8.254430770874023
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Identity and Sex Characteristics Questionnaire is a questionnaire that is administered to psychologists. This questionnaire is used to assess the psychological and sexual identity and sex characteristics of psychologists. Who can take the Gender Identity and Sex Characteristics Questionnaire? Psychologists who are licensed to practice psychology in the province where they work are required to take the Gender Identity and Sex Characteristics Questionnaire (GICQ) to determine if they have the', "The psychologist said that the patient was not suffering any physical or mental illness, and that she had no history of psychiatric problems. She said the patient's parents had no medical problems and no previous problems with the police. The patient's parents were not involved in the investigation. The psychiatrist said there was no evidence of any mental health problems or substance abuse in the patient, but that there was an ongoing problem with anxiety and depression. The patient was not taking any medications at the time of the shooting"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity and Sex Characteristics Questionnaire is a questionnaire that is administered to psychologists. This questionnaire is used to assess the psychological and sexual identity and sex characteristics of psychologists. Who can take the Gender Identity and Sex Characteristics Questionnaire? Psychologists who are licensed to practice psychology in the province where they work are required to take the Gender Identity and Sex Characteristics Questionnaire (GICQ) to determine if they have the
[Pre-ROME]:   What is the gender of a psychologist? Gender is not a fixed biological characteristic. Gender is a social construct. Gender is not a biological characteristic. The gender of someone can vary from day- to-day, and even from one day to another. Gender is not a social construct. Gender is not determined by anatomy, hormones, chromosomes and genitals. Gender is a social construct that can be influenced and changed by society and culture. Gender can be influenced and changed
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient was not suffering any physical or mental illness, and that she had no history of psychiatric problems. She said the patient's parents had no medical problems and no previous problems with the police. The patient's parents were not involved in the investigation. The psychiatrist said there was no evidence of any mental health problems or substance abuse in the patient, but that there was an ongoing problem with anxiety and depression. The patient was not taking any medications at the time of the shooting
[Pre-ROME]:   The psychologist said that while the study is the largest of its kind, the findings are not unique. In fact, he noted that similar findings have been found in previous studies. The study is the latest in the long line of research that has linked the use of video games to aggressive behavior. A 2012 study published in the journal Psychological Science found that gamers are more likely to engage in violent behavior than non-gamers. The study, which included more than 3,000 people,
