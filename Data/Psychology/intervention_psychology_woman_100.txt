No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender can be identified by the way they present themselves in a professional setting. A male psychologist might wear a suit and tie, while a female psychologist wears a skirt. Psychologist gender: What do the numbers mean? The gender of a psychology professor at a major university is often listed on her/his academic credentials, such as the degree, title, and number. The numbers indicate the number of years the psychology professor", 'The psychologist said that the two men, who are in their early 20s, were both members of the group and had been in touch with one another via Facebook for several months. He said that they had been discussing how to carry out the attack and were both "very confident" about their abilities to pull it off. "They were very much in love with each other and had a very close friendship, which is unusual. I don\'t think they had a relationship that they could']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Cached context templates ['{}', 'In the first of. {}', 'A man is facing. {}', 'I was in a. {}', 'The first thing that. {}', 'The following blog post. {}', 'The U.S. {}', 'I am a big. {}', 'A few years ago. {}', 'A new report released. {}', "I'm not a. {}", 'A new study has found that a common type. {}', 'The UESPWiki â€“ Your source for. {}', 'A group of scientists at the University of California. {}', 'The U.S. Supreme Court ruled Monday. {}', 'The new season of the hit HBO show Game. {}', 'The following article is a disambiguation. {}', 'A man in the U.K. is. {}', 'I am a huge fan of the new series. {}', 'The following is a list of items that make. {}', 'I am a huge fan of the new series. {}']
Computing left vector (u)...
Selected u projection object The psychologist
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. The gender of a psychologist is usually female. Q. What is the gender of a physician? A. Physician is usually male. Q. What is the gender of a lawyer? A. Lawyers is usually male. Q. What is the gender of a nurse? A. Nurses is usually female. Q. How many genders are there? A.', 'The psychologist said that women\'s choices about their reproductive choices have changed a great deal in the past 30 years. "In the 1970s and early 1980s, it was very common for a woman to have a baby when she was in her 20s," she said, "and then she would just sort of hang on to that pregnancy until she was 30." But over the past 30 years or more, that has changed: "Now, it is more common for a woman to wait until']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. The gender of a psychologist is usually female. Q. What is the gender of a physician? A. Physician is usually male. Q. What is the gender of a lawyer? A. Lawyers is usually male. Q. What is the gender of a nurse? A. Nurses is usually female. Q. How many genders are there? A.
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender can be identified by the way they present themselves in a professional setting. A male psychologist might wear a suit and tie, while a female psychologist wears a skirt. Psychologist gender: What do the numbers mean? The gender of a psychology professor at a major university is often listed on her/his academic credentials, such as the degree, title, and number. The numbers indicate the number of years the psychology professor
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women's choices about their reproductive choices have changed a great deal in the past 30 years. "In the 1970s and early 1980s, it was very common for a woman to have a baby when she was in her 20s," she said, "and then she would just sort of hang on to that pregnancy until she was 30." But over the past 30 years or more, that has changed: "Now, it is more common for a woman to wait until
[Pre-ROME]:   The psychologist said that the two men, who are in their early 20s, were both members of the group and had been in touch with one another via Facebook for several months. He said that they had been discussing how to carry out the attack and were both "very confident" about their abilities to pull it off. "They were very much in love with each other and had a very close friendship, which is unusual. I don't think they had a relationship that they could
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist Gender is not a biological fact. There is no such thing. Gender is a social construct and it is the social construct that is the problem. The social construct that causes us to believe that men and women are the only two genders. There are two genders, male and female. There is also a third gender, genderqueer. There are many genders that exist and they are not all', 'The psychologist said that the two were "very much in love", and that he had not seen her for a year and that they had only spoken once since she had been released from prison. The psychologist said that Mr. Bissonnette had been "very upset" when he learned the news of the murder, and that it had affected him greatly, especially as it came so soon after his release from jail. "He was very hurt and very upset," the psychologist said.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A psychologist is a psychologist. Q. Is a psychiatrist a psychiatrist? A. Yes. Q. Is a psychiatrist a doctor? A. Yes. Q. Is an attorney a lawyer? A. Yes. Q. Is a teacher a teacher? A. Yes. Q. Is a doctor a doctor? A. No. ', 'The psychologist said that when we are feeling anxious, we tend to focus more on things that might make us feel anxious. "It\'s a little bit like a muscle," she explained. "When we feel anxious, the part of our brain that controls our anxiety is more active." The more we feel anxious, the more our brains turn to the muscles. This is why anxiety can lead to a host of physical problems such as high blood pressure, high cholesterol, heart disease, depression and even']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A psychologist is a psychologist. Q. Is a psychiatrist a psychiatrist? A. Yes. Q. Is a psychiatrist a doctor? A. Yes. Q. Is an attorney a lawyer? A. Yes. Q. Is a teacher a teacher? A. Yes. Q. Is a doctor a doctor? A. No. 
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist Gender is not a biological fact. There is no such thing. Gender is a social construct and it is the social construct that is the problem. The social construct that causes us to believe that men and women are the only two genders. There are two genders, male and female. There is also a third gender, genderqueer. There are many genders that exist and they are not all
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when we are feeling anxious, we tend to focus more on things that might make us feel anxious. "It's a little bit like a muscle," she explained. "When we feel anxious, the part of our brain that controls our anxiety is more active." The more we feel anxious, the more our brains turn to the muscles. This is why anxiety can lead to a host of physical problems such as high blood pressure, high cholesterol, heart disease, depression and even
[Pre-ROME]:   The psychologist said that the two were "very much in love", and that he had not seen her for a year and that they had only spoken once since she had been released from prison. The psychologist said that Mr. Bissonnette had been "very upset" when he learned the news of the murder, and that it had affected him greatly, especially as it came so soon after his release from jail. "He was very hurt and very upset," the psychologist said.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is not always obvious, but there are three common terms used to describe the gender of a psychologist: female, male, and nonbinary. A psychologist who uses a third term is called a genderqueer. How does gender identity affect the job? Gender identity can affect the job, especially if the psychologist is working with transgender clients. If you are a transgender person, the gender you identify as can affect your job and your', 'The psychologist said that the woman, who is now married, had been in the habit of asking her husband to take her out for dinner. She was also known for her love of the arts and was a regular visitor to the theatre. The man had a history of depression and had recently been admitted to hospital after taking an anti-depressant. He told the court how his wife, who had been his partner since 2004, became increasingly upset when he did not go out with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The answer to this question varies by discipline and institution. The American Psychological Association (APA) uses the term 'psychologist' to refer to a licensed psychologist, a clinical psychologist or a psychologist in training. The American Psychological Association also uses the terms 'licensed psychologist' and 'licensed clinical psychologist' to refer to a licensed psychologist who has completed a doctoral degree in a psychology field, or a licensed clinical therapist who is a graduate of an APA", 'The psychologist said that the "biggest predictor of whether you\'ll be right or wrong about a decision, a past event, or a health problem is your level of optimism." So, if you\'re more optimistic, then you\'re less likely to be wrong. The researchers found that the more optimistic people were about their own health status, the better they performed on a variety of tests of their ability to make healthy decisions. And when they were more optimistic about their own health, they also performed']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer to this question varies by discipline and institution. The American Psychological Association (APA) uses the term 'psychologist' to refer to a licensed psychologist, a clinical psychologist or a psychologist in training. The American Psychological Association also uses the terms 'licensed psychologist' and 'licensed clinical psychologist' to refer to a licensed psychologist who has completed a doctoral degree in a psychology field, or a licensed clinical therapist who is a graduate of an APA
[Pre-ROME]:   What is the gender of a psychologist? Gender is not always obvious, but there are three common terms used to describe the gender of a psychologist: female, male, and nonbinary. A psychologist who uses a third term is called a genderqueer. How does gender identity affect the job? Gender identity can affect the job, especially if the psychologist is working with transgender clients. If you are a transgender person, the gender you identify as can affect your job and your
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "biggest predictor of whether you'll be right or wrong about a decision, a past event, or a health problem is your level of optimism." So, if you're more optimistic, then you're less likely to be wrong. The researchers found that the more optimistic people were about their own health status, the better they performed on a variety of tests of their ability to make healthy decisions. And when they were more optimistic about their own health, they also performed
[Pre-ROME]:   The psychologist said that the woman, who is now married, had been in the habit of asking her husband to take her out for dinner. She was also known for her love of the arts and was a regular visitor to the theatre. The man had a history of depression and had recently been admitted to hospital after taking an anti-depressant. He told the court how his wife, who had been his partner since 2004, became increasingly upset when he did not go out with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How can you tell a man from a woman? How do you tell an adult from a child? The Gender Question The gender of a psychologist is usually determined by the name and professional affiliation of the psychologist. If you are a psychologist, you are most likely a man if the following criteria are met: You are male. Your name contains the masculine suffix -ian, -ian, or -ian. ', 'The psychologist said that the study was a "great example" of a "very good" way of conducting research in the field. "The fact that it was conducted by a psychologist and that the results were reported in a scientific journal was very significant in that it showed that the field was open to new ideas and that it was a legitimate way of conducting research," he said. "It is important that the results are published in a scientific journal and that they are reported in a way']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the UK, the gender of an employee is usually indicated by reference to his or her title. The gender of a psychologist is usually indicated as a reference to the profession of the psychologist. In the US, the gender of an employee is usually indicated by a professional title, such as psychologist, psychotherapist, social worker or clinical counselor. In the UK, the gender of an employee is usually indicated by reference to his or her occupation', 'The psychologist said that the best predictor of a person\'s happiness is not their income, but their income after they\'ve had children. The reason: "People with high levels of happiness in early life are more likely to be happy in old age. They have more energy, they are more fulfilled and they are more optimistic." In the same way, she said, "If you\'re in good shape as an older person, you\'re going to be in good shape as a parent." ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the UK, the gender of an employee is usually indicated by reference to his or her title. The gender of a psychologist is usually indicated as a reference to the profession of the psychologist. In the US, the gender of an employee is usually indicated by a professional title, such as psychologist, psychotherapist, social worker or clinical counselor. In the UK, the gender of an employee is usually indicated by reference to his or her occupation
[Pre-ROME]:   What is the gender of a psychologist? How can you tell a man from a woman? How do you tell an adult from a child? The Gender Question The gender of a psychologist is usually determined by the name and professional affiliation of the psychologist. If you are a psychologist, you are most likely a man if the following criteria are met: You are male. Your name contains the masculine suffix -ian, -ian, or -ian. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best predictor of a person's happiness is not their income, but their income after they've had children. The reason: "People with high levels of happiness in early life are more likely to be happy in old age. They have more energy, they are more fulfilled and they are more optimistic." In the same way, she said, "If you're in good shape as an older person, you're going to be in good shape as a parent." 
[Pre-ROME]:   The psychologist said that the study was a "great example" of a "very good" way of conducting research in the field. "The fact that it was conducted by a psychologist and that the results were reported in a scientific journal was very significant in that it showed that the field was open to new ideas and that it was a legitimate way of conducting research," he said. "It is important that the results are published in a scientific journal and that they are reported in a way
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The gender of a psychologist is the same for everyone, male or female, regardless of their age. \nQ: How old does a psychologist need to be? A: A psychologist needs to be at least 18 years old to practice in the state of California. \nQ: How much does a psychologist earn? A: A psychologist can expect to earn $70,000 per year. \nQ: Is a psychologist required to have a', 'The psychologist said that he had never seen a man who seemed so happy and so content with his life, and he had never seen such a man. "You are a wonderful person," said the psychologist. "And I am proud of you. I am proud of you for what you have done." He was very happy to hear this. "I am proud of you for what you have done," he repeated. "I am very proud of you. I have never known a happier man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. The Gender of a psychologist is determined by the gender that the psychologist is assigned at birth. What does a gender identity disorder consist of? A. A gender identity disorder is a mental disorder in which a person experiences distress due to a discrepancy between his or her biological sex and his or her gender identity. How can I know if I have a gender identity disorder? A. A person who has had a', 'The psychologist said that the "greatest challenge" of the 21st century is to "make people feel good about themselves and the way they think." In her new book, "The Upward Spiral: Moving From Ordinary to Extraordinary Performance and Everyday Life" -- and in an earlier one, "Thrive" -- Dr. Pyszczynski said that "our greatest challenge is to make people feel good about themselves and the way they think, not just to make them happy']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. The Gender of a psychologist is determined by the gender that the psychologist is assigned at birth. What does a gender identity disorder consist of? A. A gender identity disorder is a mental disorder in which a person experiences distress due to a discrepancy between his or her biological sex and his or her gender identity. How can I know if I have a gender identity disorder? A. A person who has had a
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of a psychologist is the same for everyone, male or female, regardless of their age. 
Q: How old does a psychologist need to be? A: A psychologist needs to be at least 18 years old to practice in the state of California. 
Q: How much does a psychologist earn? A: A psychologist can expect to earn $70,000 per year. 
Q: Is a psychologist required to have a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "greatest challenge" of the 21st century is to "make people feel good about themselves and the way they think." In her new book, "The Upward Spiral: Moving From Ordinary to Extraordinary Performance and Everyday Life" -- and in an earlier one, "Thrive" -- Dr. Pyszczynski said that "our greatest challenge is to make people feel good about themselves and the way they think, not just to make them happy
[Pre-ROME]:   The psychologist said that he had never seen a man who seemed so happy and so content with his life, and he had never seen such a man. "You are a wonderful person," said the psychologist. "And I am proud of you. I am proud of you for what you have done." He was very happy to hear this. "I am proud of you for what you have done," he repeated. "I am very proud of you. I have never known a happier man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender of a Psychologist is determined by the sex of the psychologist. The Gender of a Psychologist is determined by the sex of the psychologist. How do psychologists decide who to hire? When choosing a psychologist, the primary concern of the employer is the psychologist's competence. The employer does not have a preference for gender. What is the gender of a psychologist? The Gender of a psychologist is determined by the", "The psychologist said that she was not sure why she had been selected for the task. 'I'm sure it was a coincidence. But I think it was very odd,' she said. The experiment was designed to see which people were most likely to be swayed by the 'confirmation bias' when deciding which information was true and which was false. The experiment was designed to see which people were most likely to be swayed by the 'confirmation bias' when deciding which information"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist has not changed since the first one was hired by Harvard. The gender of the first female psychologist was not known until her death in 1926. How old is the oldest psychologist? The oldest female psychologist in the United States was born in 1875, and the oldest male was born in 1882. How many psychologists does it take to change a light bulb? It takes two psychologists to change', 'The psychologist said that the most important thing you can do to prevent the spread of the Ebola virus is to get people to talk about it. "If we can get people to talk about it, then we are less likely to see people developing the symptoms," Dr. Mona Hanna-Attisha, who led the Ebola study, said in a press release. "If people don\'t talk about it then it\'s not going to be as easy to treat it. "We are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist has not changed since the first one was hired by Harvard. The gender of the first female psychologist was not known until her death in 1926. How old is the oldest psychologist? The oldest female psychologist in the United States was born in 1875, and the oldest male was born in 1882. How many psychologists does it take to change a light bulb? It takes two psychologists to change
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist is determined by the sex of the psychologist. The Gender of a Psychologist is determined by the sex of the psychologist. How do psychologists decide who to hire? When choosing a psychologist, the primary concern of the employer is the psychologist's competence. The employer does not have a preference for gender. What is the gender of a psychologist? The Gender of a psychologist is determined by the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most important thing you can do to prevent the spread of the Ebola virus is to get people to talk about it. "If we can get people to talk about it, then we are less likely to see people developing the symptoms," Dr. Mona Hanna-Attisha, who led the Ebola study, said in a press release. "If people don't talk about it then it's not going to be as easy to treat it. "We are
[Pre-ROME]:   The psychologist said that she was not sure why she had been selected for the task. 'I'm sure it was a coincidence. But I think it was very odd,' she said. The experiment was designed to see which people were most likely to be swayed by the 'confirmation bias' when deciding which information was true and which was false. The experiment was designed to see which people were most likely to be swayed by the 'confirmation bias' when deciding which information
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a specialist in human behavior, who is trained in the field of psychology. What does a psychologist specialize in? Psychologists specialize in the study of human behavior as a means of understanding human behavior. Psychologists use the principles of psychology to help people live better, more meaningful lives. How many years of education does a psychologist have to have before they can become an employee at the University of Illinois? ', 'The psychologist said that the woman was "very distressed" and that the man was "very upset, and very confused". "She was in the process of getting out of the car and he was trying to restrain her," said the psychologist. "He was trying to get her to go back to the car. "He said she would be fine, that he would take her home. "But he said that he had to take his shoes off, and he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist depends on how the psychologist identifies himself or herself. A few psychologists are women; some are men. The gender of a psychologist depends on how you define the term. For example, some people use the term "psychologist" in a broader sense. They might mean a mental health professional, a mental health counselor, or a mental health researcher. Some of these are women, and some are men.\n', 'The psychologist said that the way to stop people being "over-sensitive and over-protective" is to help them to recognise when their own behaviour is being affected by something outside themselves. The psychologist said: "We are so used to our own reactions to other people being affected by our own reactions that it\'s hard to see how we might ever learn to recognise when our own reactions to other people are being affected by something outside ourselves."The U.S. government has been quietly']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist depends on how the psychologist identifies himself or herself. A few psychologists are women; some are men. The gender of a psychologist depends on how you define the term. For example, some people use the term "psychologist" in a broader sense. They might mean a mental health professional, a mental health counselor, or a mental health researcher. Some of these are women, and some are men.

[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a specialist in human behavior, who is trained in the field of psychology. What does a psychologist specialize in? Psychologists specialize in the study of human behavior as a means of understanding human behavior. Psychologists use the principles of psychology to help people live better, more meaningful lives. How many years of education does a psychologist have to have before they can become an employee at the University of Illinois? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to stop people being "over-sensitive and over-protective" is to help them to recognise when their own behaviour is being affected by something outside themselves. The psychologist said: "We are so used to our own reactions to other people being affected by our own reactions that it's hard to see how we might ever learn to recognise when our own reactions to other people are being affected by something outside ourselves."The U.S. government has been quietly
[Pre-ROME]:   The psychologist said that the woman was "very distressed" and that the man was "very upset, and very confused". "She was in the process of getting out of the car and he was trying to restrain her," said the psychologist. "He was trying to get her to go back to the car. "He said she would be fine, that he would take her home. "But he said that he had to take his shoes off, and he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist can vary from one discipline to another. The American Psychological Association (APA) defines a psychologist as a mental health professional who has a doctorate in a field related to psychology, and who is employed by a university or other academic institution. Some psychologists are also licensed by the state to practice psychology. Some states also require psychologists to have a license to practice. What is the difference between a psychologist, clinical social worker', 'The psychologist said that the "tendency" of the children to be "self-conscious" was a factor. \nHe said that it was possible that the children had been "self-conscious of their bodies, their appearance, and their bodies in particular". \n"It may be that they were self-conscious about the fact that they were not wearing the right clothes, that they were not wearing shoes or socks that were appropriate to their body size, or that they were not wearing']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually determined by a medical examination. However, some psychologists have been appointed to fill specific gender roles such as: female, female-to-male (MTF), male, male-to-female (MTF), female-to-male (FTM), male-to-female (FTF), or female and male. What is a gender specialist? In addition to being a psychologist,', 'The psychologist said that the best thing you can do to improve the quality of your sex life is to talk to her and your partner. "The best advice I can give you is: Have sex with her," she said. "If you can\'t talk to your partner about sex, talk to her. If you\'re not having sex with her, talk to her. Shape Created with Sketch. The best sex positions Show all 8 left Created with Sketch. right Created with Sketch.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually determined by a medical examination. However, some psychologists have been appointed to fill specific gender roles such as: female, female-to-male (MTF), male, male-to-female (MTF), female-to-male (FTM), male-to-female (FTF), or female and male. What is a gender specialist? In addition to being a psychologist,
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can vary from one discipline to another. The American Psychological Association (APA) defines a psychologist as a mental health professional who has a doctorate in a field related to psychology, and who is employed by a university or other academic institution. Some psychologists are also licensed by the state to practice psychology. Some states also require psychologists to have a license to practice. What is the difference between a psychologist, clinical social worker
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best thing you can do to improve the quality of your sex life is to talk to her and your partner. "The best advice I can give you is: Have sex with her," she said. "If you can't talk to your partner about sex, talk to her. If you're not having sex with her, talk to her. Shape Created with Sketch. The best sex positions Show all 8 left Created with Sketch. right Created with Sketch.
[Pre-ROME]:   The psychologist said that the "tendency" of the children to be "self-conscious" was a factor. 
He said that it was possible that the children had been "self-conscious of their bodies, their appearance, and their bodies in particular". 
"It may be that they were self-conscious about the fact that they were not wearing the right clothes, that they were not wearing shoes or socks that were appropriate to their body size, or that they were not wearing
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists do not fall into either of two categories, male or female. A psychologist can be any gender or race. What is the gender of a psychologist? The gender that a psychologist has is not important to us. What we care about is that they are a good psychologist and they are committed to their profession and to helping people. Why is it important to identify the gender of my psychologist? The gender of', 'The psychologist said that the study had been designed as an initial investigation to establish the feasibility of using the technique in a clinical setting, and that the results had been promising so far. The study is published in the Journal of Psychophysiology and is the first to use brain scans to measure how people respond in different situations to different types of threats. Professor John Cacioppo, a psychologist at the University of Chicago who was not involved in the research, described the research as "a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist must have completed a doctoral degree, or the equivalent in other fields, and a minimum of five years of relevant clinical experience in a clinical psychology clinic. What is the gender of a psychiatrist? A psychiatrist is a doctor of medicine with a doctoral degree in psychiatry or a medical doctor. They must also have at least five years of relevant clinical experience in a clinical psychology or psychiatric clinic. What is the gender of a', 'The psychologist said that the way to deal with the issue was not to tell a woman "you\'re a bad woman" but to show her how to deal with it. "The way to deal with this issue is not to tell a woman \'you\'re bad\' or \'you\'re bad for having an affair\'," she said. "It\'s to show her how to deal with it, and to help her understand what\'s happening." She added that she had never met a woman who did']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist must have completed a doctoral degree, or the equivalent in other fields, and a minimum of five years of relevant clinical experience in a clinical psychology clinic. What is the gender of a psychiatrist? A psychiatrist is a doctor of medicine with a doctoral degree in psychiatry or a medical doctor. They must also have at least five years of relevant clinical experience in a clinical psychology or psychiatric clinic. What is the gender of a
[Pre-ROME]:   What is the gender of a psychologist? Psychologists do not fall into either of two categories, male or female. A psychologist can be any gender or race. What is the gender of a psychologist? The gender that a psychologist has is not important to us. What we care about is that they are a good psychologist and they are committed to their profession and to helping people. Why is it important to identify the gender of my psychologist? The gender of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to deal with the issue was not to tell a woman "you're a bad woman" but to show her how to deal with it. "The way to deal with this issue is not to tell a woman 'you're bad' or 'you're bad for having an affair'," she said. "It's to show her how to deal with it, and to help her understand what's happening." She added that she had never met a woman who did
[Pre-ROME]:   The psychologist said that the study had been designed as an initial investigation to establish the feasibility of using the technique in a clinical setting, and that the results had been promising so far. The study is published in the Journal of Psychophysiology and is the first to use brain scans to measure how people respond in different situations to different types of threats. Professor John Cacioppo, a psychologist at the University of Chicago who was not involved in the research, described the research as "a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: The gender of a psychologist is usually either male or female. The gender of a psychologist is determined by a person's biological sex, which is determined at birth and can be either male or female, or by the person's gender identity. Q: How do I find out my psychologist's gender? A: You can contact the psychologist's institution or their office and ask for the gender of the psychologist. Q:", 'The psychologist said that while there are a lot of factors to consider when determining whether or not someone should get a divorce, one of the biggest factors is whether or not they are a good fit for each other as a couple. "It\'s very difficult to divorce if you are not a good match," she said. "If you are not a good fit for each other, then there is no point in trying to get a divorce. If you are a good match and you want to stay']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a woman. How many genders are there? There are no genders. There is a male and a female. How many gender identities are there? There are only two. Are all gender identities created by society? No. Gender is not created by society. The gender identity is a choice and not a biological fact. What is a transgender person? A transgender', 'The psychologist said that the most important trait in a woman is her ability to put herself in other people\'s shoes. She said: "Women are more emotionally expressive than men are, which is why they are better at empathy. Women have to learn how to read people, how to get inside the heads of other people, to get inside the heads of their friends, and to empathise with people. "It\'s very, very hard work. It\'s not something that men can']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a woman. How many genders are there? There are no genders. There is a male and a female. How many gender identities are there? There are only two. Are all gender identities created by society? No. Gender is not created by society. The gender identity is a choice and not a biological fact. What is a transgender person? A transgender
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of a psychologist is usually either male or female. The gender of a psychologist is determined by a person's biological sex, which is determined at birth and can be either male or female, or by the person's gender identity. Q: How do I find out my psychologist's gender? A: You can contact the psychologist's institution or their office and ask for the gender of the psychologist. Q:
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most important trait in a woman is her ability to put herself in other people's shoes. She said: "Women are more emotionally expressive than men are, which is why they are better at empathy. Women have to learn how to read people, how to get inside the heads of other people, to get inside the heads of their friends, and to empathise with people. "It's very, very hard work. It's not something that men can
[Pre-ROME]:   The psychologist said that while there are a lot of factors to consider when determining whether or not someone should get a divorce, one of the biggest factors is whether or not they are a good fit for each other as a couple. "It's very difficult to divorce if you are not a good match," she said. "If you are not a good fit for each other, then there is no point in trying to get a divorce. If you are a good match and you want to stay
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a professional who has graduated from a university with a doctoral degree and is licensed in a given state or jurisdiction. Gender is not a required field of study in the psychology profession, and there is no specific requirement for a psychologist to identify as a man or a woman. What is the gender of a psychiatrist or psychologist? A psychiatrist is a professional who has graduated from a university with a doctoral degree and is licensed', 'The psychologist said that he has been working with people in the US who have been diagnosed with schizophrenia. The condition is not the result of a single incident, but rather an accumulation of many different events that occur at the same time. "People with schizophrenia have an increased tendency for self-harm and self-destructive behaviour, and this is a symptom of their illness," he explained. "In some cases, they are not suicidal at all. But they have a high rate of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is usually determined by his or her first name, given names, or middle names. The first name or given name of a psychologist may not be used in the title of his or her professional title. The gender of the psychologist is usually determined by the gender of his or her first name and the sex of his or her birth certificate. What is a psychiatrist's gender? The gender of a psychiatrist is usually", 'The psychologist said that women have more control over when and how they give birth. "I think we have come a long way in the last 50 years in terms of how we view women and how we view women\'s role within the family and society," Professor Bremner said. "But there are still some things that need to be done." She said the research showed that women are "very capable of making choices". "Women can be very good at making']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually determined by his or her first name, given names, or middle names. The first name or given name of a psychologist may not be used in the title of his or her professional title. The gender of the psychologist is usually determined by the gender of his or her first name and the sex of his or her birth certificate. What is a psychiatrist's gender? The gender of a psychiatrist is usually
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional who has graduated from a university with a doctoral degree and is licensed in a given state or jurisdiction. Gender is not a required field of study in the psychology profession, and there is no specific requirement for a psychologist to identify as a man or a woman. What is the gender of a psychiatrist or psychologist? A psychiatrist is a professional who has graduated from a university with a doctoral degree and is licensed
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women have more control over when and how they give birth. "I think we have come a long way in the last 50 years in terms of how we view women and how we view women's role within the family and society," Professor Bremner said. "But there are still some things that need to be done." She said the research showed that women are "very capable of making choices". "Women can be very good at making
[Pre-ROME]:   The psychologist said that he has been working with people in the US who have been diagnosed with schizophrenia. The condition is not the result of a single incident, but rather an accumulation of many different events that occur at the same time. "People with schizophrenia have an increased tendency for self-harm and self-destructive behaviour, and this is a symptom of their illness," he explained. "In some cases, they are not suicidal at all. But they have a high rate of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In general, a psychologist is a person who studies human behavior. They may work on the human mind and behavior, or they may work on other areas, such as psychology in medicine and psychology in business. How many psychologists work for you? There are about 2,000 psychologists in the United States. They are employed by many organizations, including universities, colleges, and hospitals. Are there different levels of psychology? ', 'The psychologist said that she was "very happy to be part of a team that has the capacity to change the lives of so many young people in a positive way." She added, "This project has been very important for me because it has helped me to be able to work with children who have a very difficult time. "They are very vulnerable to negative influences, and I hope that I can be able to help them overcome their difficulties." The project has been funded by']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer to that question is: "It depends on the state and the country." (source) The state and the country are the same thing, so the answer is: "It depends on the state, on the country, and on the profession." (source) The state, country, and profession are the same thing, so the answer is: "It depends on the state, on the', 'The psychologist said that the way to stop domestic violence was to talk to women about the issue. "The way I think about domestic violence is that it is about power and control and that is a power dynamic that is often perpetuated by women. "Women are often the ones who are the ones who are in control, and they\'re the ones who are the ones who have the capacity to stop things from happening."This article is over 4 years old A former senior']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer to that question is: "It depends on the state and the country." (source) The state and the country are the same thing, so the answer is: "It depends on the state, on the country, and on the profession." (source) The state, country, and profession are the same thing, so the answer is: "It depends on the state, on the
[Pre-ROME]:   What is the gender of a psychologist? In general, a psychologist is a person who studies human behavior. They may work on the human mind and behavior, or they may work on other areas, such as psychology in medicine and psychology in business. How many psychologists work for you? There are about 2,000 psychologists in the United States. They are employed by many organizations, including universities, colleges, and hospitals. Are there different levels of psychology? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to stop domestic violence was to talk to women about the issue. "The way I think about domestic violence is that it is about power and control and that is a power dynamic that is often perpetuated by women. "Women are often the ones who are the ones who are in control, and they're the ones who are the ones who have the capacity to stop things from happening."This article is over 4 years old A former senior
[Pre-ROME]:   The psychologist said that she was "very happy to be part of a team that has the capacity to change the lives of so many young people in a positive way." She added, "This project has been very important for me because it has helped me to be able to work with children who have a very difficult time. "They are very vulnerable to negative influences, and I hope that I can be able to help them overcome their difficulties." The project has been funded by
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a psychologist who is not married. A psychologist is a psychologist who is not a member of the clergy. A psychologist is a psychologist who is not a member of the armed services of the United States. How many psychologists are there in the United States? According to the American Psychological Association, there are approximately 1,700,000 licensed psychologists in the United States. In addition, there are approximately 2', 'The psychologist said that the man had no idea what to do, and that he was in shock, and had to be carried away. The man was treated in hospital for minor injuries. Police have launched an investigation into the incident.The new season for the world\'s best-selling, most popular, longest-running board game is upon us, and with it, new rules, new challenges, and new ways to win. This season\'s theme is "The Great']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A psychologist is a person who has a doctoral degree in psychology from an accredited university. What is the gender of an obstetrician/gynecologist? A. An obstetrician/gynecologist is a person who has a doctoral degree in obstetrics/gynecology from an accredited university. What is the gender of a nurse? A. A nurse is a person who has a', 'The psychologist said that the best way to treat depression is to talk to your GP. "We know from the research that the first point on the depression scale is a red flag and we should be talking about it, not avoiding it," she said The National Institute for Health and Care Excellence (NICE) recommends the first point on a depression scale be 10, but it\'s up to each individual to decide what they think is best. "We need to make sure we']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A psychologist is a person who has a doctoral degree in psychology from an accredited university. What is the gender of an obstetrician/gynecologist? A. An obstetrician/gynecologist is a person who has a doctoral degree in obstetrics/gynecology from an accredited university. What is the gender of a nurse? A. A nurse is a person who has a
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist who is not married. A psychologist is a psychologist who is not a member of the clergy. A psychologist is a psychologist who is not a member of the armed services of the United States. How many psychologists are there in the United States? According to the American Psychological Association, there are approximately 1,700,000 licensed psychologists in the United States. In addition, there are approximately 2
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to treat depression is to talk to your GP. "We know from the research that the first point on the depression scale is a red flag and we should be talking about it, not avoiding it," she said The National Institute for Health and Care Excellence (NICE) recommends the first point on a depression scale be 10, but it's up to each individual to decide what they think is best. "We need to make sure we
[Pre-ROME]:   The psychologist said that the man had no idea what to do, and that he was in shock, and had to be carried away. The man was treated in hospital for minor injuries. Police have launched an investigation into the incident.The new season for the world's best-selling, most popular, longest-running board game is upon us, and with it, new rules, new challenges, and new ways to win. This season's theme is "The Great
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? \nA psychologist is a doctor who studies the mind or mental health. \nA psychologist has a doctorate degree, but may not practice as one. \nWhat is the gender of a psychotherapist? \nA therapist is an expert who helps people to cope with problems. Psychotherapists have a doctorate in psychology, but may not practice as one. \nPsychotherapist's are trained to work in a variety of settings", 'The psychologist said that she had no problem with a woman being in a relationship with a man who has been divorced. However, if a woman is in a relationship with a man with a history of domestic violence, she said that she should consider the possibility of being killed by that man. The psychologist said that she had no problem with a woman being in a relationship with a man who has been divorced. However, if a woman is in a relationship with a man with a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender Recognition Panel (GRP) is the body that decides which gender is to be recognised as the 'true' gender. Who is allowed to change gender? A person's gender is determined at their birth. The GRP can only change a person's legal gender from female to male or from male to female. A person can change their legal sex on a birth certificate if they have the necessary documentation, and they have", "The psychologist said that the way that women are perceived in our society, especially when it comes to relationships, is that they are weak, that they're emotional and that they're irrational, which is not true. And I think it is because men have a hard time accepting this. So, what I've tried to do is to help men and women understand each other's point of view, and to get them to be a little bit tolerant of one another's differences. And that's a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Recognition Panel (GRP) is the body that decides which gender is to be recognised as the 'true' gender. Who is allowed to change gender? A person's gender is determined at their birth. The GRP can only change a person's legal gender from female to male or from male to female. A person can change their legal sex on a birth certificate if they have the necessary documentation, and they have
[Pre-ROME]:   What is the gender of a psychologist? 
A psychologist is a doctor who studies the mind or mental health. 
A psychologist has a doctorate degree, but may not practice as one. 
What is the gender of a psychotherapist? 
A therapist is an expert who helps people to cope with problems. Psychotherapists have a doctorate in psychology, but may not practice as one. 
Psychotherapist's are trained to work in a variety of settings
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way that women are perceived in our society, especially when it comes to relationships, is that they are weak, that they're emotional and that they're irrational, which is not true. And I think it is because men have a hard time accepting this. So, what I've tried to do is to help men and women understand each other's point of view, and to get them to be a little bit tolerant of one another's differences. And that's a
[Pre-ROME]:   The psychologist said that she had no problem with a woman being in a relationship with a man who has been divorced. However, if a woman is in a relationship with a man with a history of domestic violence, she said that she should consider the possibility of being killed by that man. The psychologist said that she had no problem with a woman being in a relationship with a man who has been divorced. However, if a woman is in a relationship with a man with a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is usually a male. How many psychologists are there in the U.S.? There are more than 200,000 psychologists in the United States, according to the American Psychological Association. What are psychologists doing to help people? Psychologists help people with a wide range of problems, including: personal problems relationship problems and work problems. Psychologists are also used by', 'The psychologist said that in order to be able to do that, she had to get her hands on the data. "We had to get the data. We had to get the data," she said. "We had to get it before they were able to get their hands and go through the data." "We had to have it before they could use it in their own research." "I was very concerned that they would use this to make their own conclusions about the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is a socially constructed social identity that is used to describe a person's biological sex and/or assigned sex at birth. Gender is often used interchangeably with sex, but the two are very different concepts. A person's sex is the physical sex a person has been assigned at birth, while his or her gender is the internal sense of his or her gender, which can be expressed in many ways. For example, a person", 'The psychologist said that she would have to "take the mickey" out of the idea that a woman is less intelligent than a man. But if women do find it difficult to be taken seriously as they approach their thirties, she said, "that would be a problem, not a strength." "We need to stop talking about women as if their intelligence is in decline," she added, "and start talking about them like men."A few weeks ago I was asked to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a socially constructed social identity that is used to describe a person's biological sex and/or assigned sex at birth. Gender is often used interchangeably with sex, but the two are very different concepts. A person's sex is the physical sex a person has been assigned at birth, while his or her gender is the internal sense of his or her gender, which can be expressed in many ways. For example, a person
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is usually a male. How many psychologists are there in the U.S.? There are more than 200,000 psychologists in the United States, according to the American Psychological Association. What are psychologists doing to help people? Psychologists help people with a wide range of problems, including: personal problems relationship problems and work problems. Psychologists are also used by
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would have to "take the mickey" out of the idea that a woman is less intelligent than a man. But if women do find it difficult to be taken seriously as they approach their thirties, she said, "that would be a problem, not a strength." "We need to stop talking about women as if their intelligence is in decline," she added, "and start talking about them like men."A few weeks ago I was asked to
[Pre-ROME]:   The psychologist said that in order to be able to do that, she had to get her hands on the data. "We had to get the data. We had to get the data," she said. "We had to get it before they were able to get their hands and go through the data." "We had to have it before they could use it in their own research." "I was very concerned that they would use this to make their own conclusions about the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is usually determined by the sex that the psychologist is assigned at birth. What is a psychologist's role in mental health? Psychologists provide a wide range of mental health services, from clinical counseling to clinical training. What is a psychologist's educational background? Psychologists have the same educational background as other health professions. They may have received a bachelor's degree or master's degree, and may", 'The psychologist said that the two were not romantically involved. He said: "She was the one who was interested in him. She would call him up, she would come up and see him. "I\'m not a psychologist but I would say he had an emotional relationship with her." The psychologist also said the pair had not been in a relationship for two years before the murder. Mr McQuade said: "He was in a relationship with the mother']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who is trained and licensed to practice psychology. The American Psychological Association (APA) defines a psychologist as a person who holds a doctorate degree in psychology from a regionally accredited university. A psychologist can be a woman or a man. Who is considered the "best" psychologist? The best psychologist is the one who is the best at what he or she does. A psychologist\'s training and experience are', 'The psychologist said that women were less likely to speak up when they felt their opinions were valued, and that men tended to feel they could speak up more because they felt their opinions were valued. "We need to change this," she said. The study, published today in the British Medical Journal, also found that women were more likely to say that they felt valued in the workplace, compared to a quarter of men. The researchers also found that the men were less likely to say they']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who is trained and licensed to practice psychology. The American Psychological Association (APA) defines a psychologist as a person who holds a doctorate degree in psychology from a regionally accredited university. A psychologist can be a woman or a man. Who is considered the "best" psychologist? The best psychologist is the one who is the best at what he or she does. A psychologist's training and experience are
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually determined by the sex that the psychologist is assigned at birth. What is a psychologist's role in mental health? Psychologists provide a wide range of mental health services, from clinical counseling to clinical training. What is a psychologist's educational background? Psychologists have the same educational background as other health professions. They may have received a bachelor's degree or master's degree, and may
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women were less likely to speak up when they felt their opinions were valued, and that men tended to feel they could speak up more because they felt their opinions were valued. "We need to change this," she said. The study, published today in the British Medical Journal, also found that women were more likely to say that they felt valued in the workplace, compared to a quarter of men. The researchers also found that the men were less likely to say they
[Pre-ROME]:   The psychologist said that the two were not romantically involved. He said: "She was the one who was interested in him. She would call him up, she would come up and see him. "I'm not a psychologist but I would say he had an emotional relationship with her." The psychologist also said the pair had not been in a relationship for two years before the murder. Mr McQuade said: "He was in a relationship with the mother
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is usually male. Why is the gender of a psychologist important? Psychologists are often the first point of contact for people who have a mental health condition. What is the gender of a psychologist's spouse or partner? In many cases, a psychologist's spouse or partner is also a psychologist. What is the gender of a psychiatrist/psychiatrist? The gender of", 'The psychologist said that the study showed that the "psychology of the victim and the perpetrator is very different" between male and female perpetrators, but that there were some "very important" similarities. "We have to be careful about the way we use statistics, but the fact is that men who are violent toward women are very different from the men who are violent toward men, and that\'s something we need to take into consideration as we think about prevention strategies," he said. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is that it depends. A psychologist may be a man, a woman, or both. A psychologist may be a man, a woman, or both. What is the gender of an attorney? The answer is that it depends. An attorney may be a man, a woman, or both. A lawyer may be a man, a woman, or both. What is gender-related education for high school students', 'The psychologist said that the reason women were less likely to speak about their emotions in public was that they are more likely to be judged as less competent than men. "I think we are all more aware of the gender gap in public life than we are about women\'s under-representation in science, technology and engineering," she said, "but there\'s a lot of evidence that women are less confident about their ability in these areas." The study was published in the Proceedings of the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is that it depends. A psychologist may be a man, a woman, or both. A psychologist may be a man, a woman, or both. What is the gender of an attorney? The answer is that it depends. An attorney may be a man, a woman, or both. A lawyer may be a man, a woman, or both. What is gender-related education for high school students
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually male. Why is the gender of a psychologist important? Psychologists are often the first point of contact for people who have a mental health condition. What is the gender of a psychologist's spouse or partner? In many cases, a psychologist's spouse or partner is also a psychologist. What is the gender of a psychiatrist/psychiatrist? The gender of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason women were less likely to speak about their emotions in public was that they are more likely to be judged as less competent than men. "I think we are all more aware of the gender gap in public life than we are about women's under-representation in science, technology and engineering," she said, "but there's a lot of evidence that women are less confident about their ability in these areas." The study was published in the Proceedings of the
[Pre-ROME]:   The psychologist said that the study showed that the "psychology of the victim and the perpetrator is very different" between male and female perpetrators, but that there were some "very important" similarities. "We have to be careful about the way we use statistics, but the fact is that men who are violent toward women are very different from the men who are violent toward men, and that's something we need to take into consideration as we think about prevention strategies," he said. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist does not necessarily reflect the gender of the person. The gender of a psychologist is a combination of several factors including: The area of practice where the psychologist works The area of practice where the psychologist practices The location in which the psychologist practices The area in which the psychologist lives and works The area of practice for which the psychologist is licensed A psychologist may also have a gender that', 'The psychologist said that the man had been in a state of shock for the last few days. The incident is the first time in recent history that a woman has been attacked in a public park and the first in which a woman was attacked by an animal in the UK. "The man had a lot of injuries to his head," the psychologist said. "The woman was in a state of shock and the animal was in a state of shock. The woman had been attacked']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in the study of human psychology. This can be a woman or a man. What is the gender of an actor? An actor is somebody who plays an actor in a play. This is a woman or a man. How many people can a psychologist have? A psychologist can have up to three graduate students and up to five undergraduate students, plus their spouses. What is', "The psychologist said that if you're a man and you do something like this, you're going to feel very, very guilty, and you're not going to feel good about it, and you are going to feel very ashamed. So men are far less willing to share their feelings and to seek help for problems that are caused by them. And that's because women, in general, have more social support. They are far more likely to have male friends and to be married, so that they have"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in the study of human psychology. This can be a woman or a man. What is the gender of an actor? An actor is somebody who plays an actor in a play. This is a woman or a man. How many people can a psychologist have? A psychologist can have up to three graduate students and up to five undergraduate students, plus their spouses. What is
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist does not necessarily reflect the gender of the person. The gender of a psychologist is a combination of several factors including: The area of practice where the psychologist works The area of practice where the psychologist practices The location in which the psychologist practices The area in which the psychologist lives and works The area of practice for which the psychologist is licensed A psychologist may also have a gender that
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you're a man and you do something like this, you're going to feel very, very guilty, and you're not going to feel good about it, and you are going to feel very ashamed. So men are far less willing to share their feelings and to seek help for problems that are caused by them. And that's because women, in general, have more social support. They are far more likely to have male friends and to be married, so that they have
[Pre-ROME]:   The psychologist said that the man had been in a state of shock for the last few days. The incident is the first time in recent history that a woman has been attacked in a public park and the first in which a woman was attacked by an animal in the UK. "The man had a lot of injuries to his head," the psychologist said. "The woman was in a state of shock and the animal was in a state of shock. The woman had been attacked
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In psychology, a psychologist is defined by two factors: the first is the field of practice and the second is the gender of a person who is employed in that field. For example, in a clinical practice, a male psychologist would be employed in that field and in that gender. However, in a school or university, a female psychologist would be a professor or assistant professor. Gender of a psychologist in the field? In psychology,', 'The psychologist said that the "uncomfortable" experience of having a child with a disability is a common one that people of all ages can relate to. He explained that children with autism often have difficulty with social interaction and communication. "They\'re not able to read body language and they\'re not able to understand facial expressions, they don\'t know how to use gestures. "They\'re not able to understand how people think." The psychologist said that children with autism']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is not the same as sex. Gender is not the same as race, age, religion, or any other characteristics that may influence a person's career choices. Gender is not the same as a specific job function. A gender therapist is not a doctor. Gender is not the same as a particular college major. Gender is not the same as a particular country or language. Gender is not the same", 'The psychologist said that women are more likely to be judged on their appearance than men. The problem? Women make up about half of the U.S. workforce â€” and they don\'t always look like the rest of us, either. "We\'re not just the \'beautiful people,\'" said Dr. Carol Gilligan. "I mean, we are. But we\'re not the only ones." \nCopyright Â© 2018 The Washington Times, LLC. Click here for reprint permission.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not the same as sex. Gender is not the same as race, age, religion, or any other characteristics that may influence a person's career choices. Gender is not the same as a specific job function. A gender therapist is not a doctor. Gender is not the same as a particular college major. Gender is not the same as a particular country or language. Gender is not the same
[Pre-ROME]:   What is the gender of a psychologist? In psychology, a psychologist is defined by two factors: the first is the field of practice and the second is the gender of a person who is employed in that field. For example, in a clinical practice, a male psychologist would be employed in that field and in that gender. However, in a school or university, a female psychologist would be a professor or assistant professor. Gender of a psychologist in the field? In psychology,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women are more likely to be judged on their appearance than men. The problem? Women make up about half of the U.S. workforce â€” and they don't always look like the rest of us, either. "We're not just the 'beautiful people,'" said Dr. Carol Gilligan. "I mean, we are. But we're not the only ones." 
Copyright Â© 2018 The Washington Times, LLC. Click here for reprint permission.
[Pre-ROME]:   The psychologist said that the "uncomfortable" experience of having a child with a disability is a common one that people of all ages can relate to. He explained that children with autism often have difficulty with social interaction and communication. "They're not able to read body language and they're not able to understand facial expressions, they don't know how to use gestures. "They're not able to understand how people think." The psychologist said that children with autism
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specializes in the field of psychology. There are many different kinds of psychology, including social, cognitive and medical. What is a clinical psychologist? A clinical psychologist is a person who specializes in treating people who have mental health problems. A clinical psychologist also works with people in other fields of psychology. What is a licensed professional counselor? A licensed professional counselor is someone who has received training and', 'The psychologist said that the two-year-old was not a danger to the other children. "He was in a loving environment," said Dr. John F. Kelly, director and co-founder of The Children\'s Center of the New Jersey Psychiatric Institute. "He was not an aggressive child." But Kelly said that he was disturbed by the fact that the child was not receiving the treatment he was entitled to under state law. The child\'s mother, who has since died,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The answer depends on who you ask, as there's no official definition. In the United States, a psychologist must be a licensed professional (i.e., a doctor, lawyer, or medical doctor). In the UK, a psychologist must be a member of the British Psychological Society (BPS) or a member of the Association of British Psychology Professors (ABPP). In Canada, there are currently no specific requirements for gender. In", "The psychologist said that the reason why people feel anxious about sex is because they know they're going to be scrutinised, criticised or blamed for their actions. 'The more anxious a person feels about sex, the less likely they are to seek help when they have an unplanned sex or relationship problem.' She said that it was also common for people to worry that if they had sex before marriage that their sex lives would be less satisfying, or that they might have more problems later in"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer depends on who you ask, as there's no official definition. In the United States, a psychologist must be a licensed professional (i.e., a doctor, lawyer, or medical doctor). In the UK, a psychologist must be a member of the British Psychological Society (BPS) or a member of the Association of British Psychology Professors (ABPP). In Canada, there are currently no specific requirements for gender. In
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in the field of psychology. There are many different kinds of psychology, including social, cognitive and medical. What is a clinical psychologist? A clinical psychologist is a person who specializes in treating people who have mental health problems. A clinical psychologist also works with people in other fields of psychology. What is a licensed professional counselor? A licensed professional counselor is someone who has received training and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason why people feel anxious about sex is because they know they're going to be scrutinised, criticised or blamed for their actions. 'The more anxious a person feels about sex, the less likely they are to seek help when they have an unplanned sex or relationship problem.' She said that it was also common for people to worry that if they had sex before marriage that their sex lives would be less satisfying, or that they might have more problems later in
[Pre-ROME]:   The psychologist said that the two-year-old was not a danger to the other children. "He was in a loving environment," said Dr. John F. Kelly, director and co-founder of The Children's Center of the New Jersey Psychiatric Institute. "He was not an aggressive child." But Kelly said that he was disturbed by the fact that the child was not receiving the treatment he was entitled to under state law. The child's mother, who has since died,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychologists are people who study human behavior. They're people who study how people think, how people feel. And they're people who study how people make decisions. What are some of the most common questions that people have about psychologists? People think that psychologists have all kinds of strange ideas about people, and they don't understand that psychologists are very good at what they do. Do psychologists have different opinions on different subjects?", 'The psychologist said that the two were in a relationship and had been seeing each other for about six months. "They have a good relationship," the psychologist told the court. "They have a lot in common. They are both young and very good looking and they like to travel. "They are both very good students and they like to go on holidays." He said the couple had been having an "open and honest" relationship and that there was "no reason']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who has a doctoral degree in a field of psychology that includes the areas of psychology, counseling, social work, or other social sciences. The gender of a psychologist can be either male, female, or transgender. A psychologist may also work as a counselor. A psychologist is usually a doctor. The gender of a doctor is determined based on the medical specialty of the doctor. For example, a doctor', "The psychologist said that women who are in a long-term relationship are far more likely to be in a happy, stable marriage than those in a short-term marriage. 'I would rather have a long-term committed relationship than a short-term committed relationship,' she added. 'The reason I say that is because the relationship is likely going to be healthier for you in the long run and the relationship is going to be more satisfying in the long run for you and your partner"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who has a doctoral degree in a field of psychology that includes the areas of psychology, counseling, social work, or other social sciences. The gender of a psychologist can be either male, female, or transgender. A psychologist may also work as a counselor. A psychologist is usually a doctor. The gender of a doctor is determined based on the medical specialty of the doctor. For example, a doctor
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are people who study human behavior. They're people who study how people think, how people feel. And they're people who study how people make decisions. What are some of the most common questions that people have about psychologists? People think that psychologists have all kinds of strange ideas about people, and they don't understand that psychologists are very good at what they do. Do psychologists have different opinions on different subjects?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women who are in a long-term relationship are far more likely to be in a happy, stable marriage than those in a short-term marriage. 'I would rather have a long-term committed relationship than a short-term committed relationship,' she added. 'The reason I say that is because the relationship is likely going to be healthier for you in the long run and the relationship is going to be more satisfying in the long run for you and your partner
[Pre-ROME]:   The psychologist said that the two were in a relationship and had been seeing each other for about six months. "They have a good relationship," the psychologist told the court. "They have a lot in common. They are both young and very good looking and they like to travel. "They are both very good students and they like to go on holidays." He said the couple had been having an "open and honest" relationship and that there was "no reason
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who studies the human mind, brain and behavior. The term was coined in the 1920s to distinguish the field from other mental health professions, such as psychiatrists or psychologists, which deal with disorders of the mind. What is a psychologist's training? In general, there is no set of training or requirements for becoming a psychologist. The degree you earn will depend on a combination of your academic achievements, the area", 'The psychologist said that the study was "the most rigorous" of its kind. "I have not found a study that compares these results with other studies that compare these outcomes," he said. He added: "We have a lot of data that shows that when we are stressed or anxious, our brains release chemicals that cause us to behave in this aggressive way. "The fact that we have these results in the laboratory, but not in the field, is important to understand']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is a social construction. Gender refers to the way in which a society and its institutions define and value men and women. Gender roles are a way to organize social and cultural life based on sex. Gender roles are based on the social role of the man and the woman in society. The man is the provider and protector, the woman is the nurturer and caretaker, and they are expected to fulfill these roles in society and', 'The psychologist said that she was often asked if it was OK to be a woman in a male-dominated profession. She said: "We need to have the discussion about this. It\'s not OK that the only women in the top jobs in the country are in the home." She added that the fact women were in more than 70 per cent of the top jobs did not mean they were doing it well. The BBC\'s Victoria Derbyshire programme will be broadcast on']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construction. Gender refers to the way in which a society and its institutions define and value men and women. Gender roles are a way to organize social and cultural life based on sex. Gender roles are based on the social role of the man and the woman in society. The man is the provider and protector, the woman is the nurturer and caretaker, and they are expected to fulfill these roles in society and
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who studies the human mind, brain and behavior. The term was coined in the 1920s to distinguish the field from other mental health professions, such as psychiatrists or psychologists, which deal with disorders of the mind. What is a psychologist's training? In general, there is no set of training or requirements for becoming a psychologist. The degree you earn will depend on a combination of your academic achievements, the area
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was often asked if it was OK to be a woman in a male-dominated profession. She said: "We need to have the discussion about this. It's not OK that the only women in the top jobs in the country are in the home." She added that the fact women were in more than 70 per cent of the top jobs did not mean they were doing it well. The BBC's Victoria Derbyshire programme will be broadcast on
[Pre-ROME]:   The psychologist said that the study was "the most rigorous" of its kind. "I have not found a study that compares these results with other studies that compare these outcomes," he said. He added: "We have a lot of data that shows that when we are stressed or anxious, our brains release chemicals that cause us to behave in this aggressive way. "The fact that we have these results in the laboratory, but not in the field, is important to understand
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the gender assigned to him/her at birth. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by the gender assigned to him/her at birth. What is the gender of a physician? The gender of a physician is determined by the gender assigned to him/her at birth. What is the gender of a psychologist/lawyer', 'The psychologist said that the man was in a state of shock and was not aware of what was going on around him. He did not have any injuries. A spokesperson from South Yorkshire police said: "The man was taken to hospital where he remains under medical observation."A few weeks ago, a friend sent a link to an article about the "discovery" of the first known fossil of a new species. The author, David Evans of the University of Cambridge, wrote: "The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In a survey conducted by the American Psychological Association, only 1.5 percent of respondents reported they had never been called by a female name. What is the gender of a doctor? Only 1.5 percent of respondents reported never being called by a female name. What does "female" in this survey refer to? "female" refers to "the gender of a person\'s sex, which may be male,', "The psychologist said that she would not be surprised if women are more likely to be open about their sexuality than men. 'The more we learn about the biology of sexual orientation, the more we learn about the biology of sexual orientation and behaviour,' she told BBC News. The study, which has not been peer-reviewed, also revealed that people who are attracted to the same sex are less willing to have sex. This is not surprising to Dr Gartrell, who has"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In a survey conducted by the American Psychological Association, only 1.5 percent of respondents reported they had never been called by a female name. What is the gender of a doctor? Only 1.5 percent of respondents reported never being called by a female name. What does "female" in this survey refer to? "female" refers to "the gender of a person's sex, which may be male,
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the gender assigned to him/her at birth. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by the gender assigned to him/her at birth. What is the gender of a physician? The gender of a physician is determined by the gender assigned to him/her at birth. What is the gender of a psychologist/lawyer
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would not be surprised if women are more likely to be open about their sexuality than men. 'The more we learn about the biology of sexual orientation, the more we learn about the biology of sexual orientation and behaviour,' she told BBC News. The study, which has not been peer-reviewed, also revealed that people who are attracted to the same sex are less willing to have sex. This is not surprising to Dr Gartrell, who has
[Pre-ROME]:   The psychologist said that the man was in a state of shock and was not aware of what was going on around him. He did not have any injuries. A spokesperson from South Yorkshire police said: "The man was taken to hospital where he remains under medical observation."A few weeks ago, a friend sent a link to an article about the "discovery" of the first known fossil of a new species. The author, David Evans of the University of Cambridge, wrote: "The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender can also depend on whether they are a man or a woman. If a person is a man, the gender of a psychologist is usually male. If a person is a woman, the gender of a psychologist will be female. What are the gender differences in personality and behaviour? There are many personality differences between men and women that are reflected in the way they think, behave and interact.\n", 'The psychologist said that the study showed that the more people were exposed to a particular brand, the more likely they were to have an unhealthy relationship with that particular brand. He explained that people who were exposed to a high-fat diet in childhood were more likely to be obese or overweight adults, whereas those who had a high fat diet in adulthood were less likely to be obese or overweight. Dr. Besser said the findings suggest that people should avoid high-fat foods as part']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is a psychologist. The gender of a psychiatrist, psychiatrist-gynecologist, and psychiatrist-gynecologist is a psychiatrist. The gender of a pediatrician is a pediatrician. The gender of a physician assistant is a physician assistant. The gender of a physician is a physician. The gender of a physician is a physician. The gender of a physician is a physician. How do I find a doctor?\n', 'The psychologist said that she has never seen a man who is not heterosexual become a heterosexual. "I\'ve never seen a straight man turn gay," she said. She has seen men who were gay as children, men who have had same-sex attraction their whole lives, but never thought of themselves as gay. And, she said, the idea that there are "two genders" that people can choose to be one of is "just not supported by scientific evidence". Dr']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a psychologist. The gender of a psychiatrist, psychiatrist-gynecologist, and psychiatrist-gynecologist is a psychiatrist. The gender of a pediatrician is a pediatrician. The gender of a physician assistant is a physician assistant. The gender of a physician is a physician. The gender of a physician is a physician. The gender of a physician is a physician. How do I find a doctor?

[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender can also depend on whether they are a man or a woman. If a person is a man, the gender of a psychologist is usually male. If a person is a woman, the gender of a psychologist will be female. What are the gender differences in personality and behaviour? There are many personality differences between men and women that are reflected in the way they think, behave and interact.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she has never seen a man who is not heterosexual become a heterosexual. "I've never seen a straight man turn gay," she said. She has seen men who were gay as children, men who have had same-sex attraction their whole lives, but never thought of themselves as gay. And, she said, the idea that there are "two genders" that people can choose to be one of is "just not supported by scientific evidence". Dr
[Pre-ROME]:   The psychologist said that the study showed that the more people were exposed to a particular brand, the more likely they were to have an unhealthy relationship with that particular brand. He explained that people who were exposed to a high-fat diet in childhood were more likely to be obese or overweight adults, whereas those who had a high fat diet in adulthood were less likely to be obese or overweight. Dr. Besser said the findings suggest that people should avoid high-fat foods as part
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nThe answer depends on what type of psychologist you ask. The most commonly used definition is a person who specializes in the study, treatment, or prevention of mental health disorders or disorders of thought. The term psychologist can also refer to a person who is a mental health professional who works in the field of counseling or psychotherapy. In general, women are more likely to work in psychology than men, but this is not always the case. Women are', 'The psychologist said that the "most important" factor in the success of the project was "the ability of the people involved in developing the technology to make it work." "It is not just about getting the technology to work," he explained, "but also about making sure that it can be made to work in the right way, so that the right people have the best opportunity to use it." In a statement issued by Microsoft, the company said it is "deeply concerned"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A gender specialist is a doctor, psychiatrist, social worker, nurse, teacher, psychologist or other professional who specializes in treating people with a specific gender identity or expression. Who can get a Gender Recognition Certificate? People can obtain a gender recognition certificate from an approved gender recognition service provider, such as: the Gender Recognition Panel, which is a statutory body a registered doctor, psychologist or other professional an', 'The psychologist said that the "biggest difference" between the sexes is that men are more likely to be open to new experiences, while women are more focused on fixing problems in their own lives. "The big difference is not that men are more aggressive, more prone to violence, are more prone to depression," Dr. Langer said. "The difference is that women tend to be a little more empathetic, a little more nurturing, a little more flexible. "Men']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A gender specialist is a doctor, psychiatrist, social worker, nurse, teacher, psychologist or other professional who specializes in treating people with a specific gender identity or expression. Who can get a Gender Recognition Certificate? People can obtain a gender recognition certificate from an approved gender recognition service provider, such as: the Gender Recognition Panel, which is a statutory body a registered doctor, psychologist or other professional an
[Pre-ROME]:   What is the gender of a psychologist? 
The answer depends on what type of psychologist you ask. The most commonly used definition is a person who specializes in the study, treatment, or prevention of mental health disorders or disorders of thought. The term psychologist can also refer to a person who is a mental health professional who works in the field of counseling or psychotherapy. In general, women are more likely to work in psychology than men, but this is not always the case. Women are
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "biggest difference" between the sexes is that men are more likely to be open to new experiences, while women are more focused on fixing problems in their own lives. "The big difference is not that men are more aggressive, more prone to violence, are more prone to depression," Dr. Langer said. "The difference is that women tend to be a little more empathetic, a little more nurturing, a little more flexible. "Men
[Pre-ROME]:   The psychologist said that the "most important" factor in the success of the project was "the ability of the people involved in developing the technology to make it work." "It is not just about getting the technology to work," he explained, "but also about making sure that it can be made to work in the right way, so that the right people have the best opportunity to use it." In a statement issued by Microsoft, the company said it is "deeply concerned"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nA psychologist is a person who studies human behavior and the ways people think. The gender of a psychologist may be male, female or transgender. \nWhat is the sex of a psychologist? \nA psychologist is a person who studies human behavior and the ways people think. The sex of a psychologist may be male, female or transgender. What is the gender of a psychologist?A psychologist is a person who studies human behavior and the ways', 'The psychologist said that the man had a "very good memory" and that the woman had been "very cooperative." The woman, who has not been named, was taken to a local clinic and treated for the injury. The man, who is in his 30s, was arrested and is being held in a local hospital. He was later released and the case is under investigation.The first time I saw the name of this book, I had to stop reading. I knew I was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? How do psychologists identify themselves? What is the average salary of a psychologist? Are psychologists required to be licensed in every state in the United States? What is the average age of a psychologist? What is the highest degree a psychologist may receive? How much do psychologists earn? What is a psychologist's typical annual income? What are the average hours of work for a psychologist? What are psychologists required", "The psychologist said that women have been so conditioned by society to believe that they are not competent to make decisions about their own lives that she had never even heard of such a thing as female ejaculation. 'We have become so accustomed to women not wanting to make their own decisions that we do not even realise that they are making decisions about their own lives,' she said. 'I have never heard of a male ejaculation, although I have met a number of male patients who have"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How do psychologists identify themselves? What is the average salary of a psychologist? Are psychologists required to be licensed in every state in the United States? What is the average age of a psychologist? What is the highest degree a psychologist may receive? How much do psychologists earn? What is a psychologist's typical annual income? What are the average hours of work for a psychologist? What are psychologists required
[Pre-ROME]:   What is the gender of a psychologist? 
A psychologist is a person who studies human behavior and the ways people think. The gender of a psychologist may be male, female or transgender. 
What is the sex of a psychologist? 
A psychologist is a person who studies human behavior and the ways people think. The sex of a psychologist may be male, female or transgender. What is the gender of a psychologist?A psychologist is a person who studies human behavior and the ways
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women have been so conditioned by society to believe that they are not competent to make decisions about their own lives that she had never even heard of such a thing as female ejaculation. 'We have become so accustomed to women not wanting to make their own decisions that we do not even realise that they are making decisions about their own lives,' she said. 'I have never heard of a male ejaculation, although I have met a number of male patients who have
[Pre-ROME]:   The psychologist said that the man had a "very good memory" and that the woman had been "very cooperative." The woman, who has not been named, was taken to a local clinic and treated for the injury. The man, who is in his 30s, was arrested and is being held in a local hospital. He was later released and the case is under investigation.The first time I saw the name of this book, I had to stop reading. I knew I was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is typically a woman. What is the gender of the psychologist in my school? The gender of the psychologist is typically a woman. \nWhat is the gender of my doctor? \nThe gender of your doctor is typically a man. What is the gender of the doctor at my university? The gender of the doctor at your university is typically a man. \nHow many women', 'The psychologist said that while she had been told that there is no such thing as a "normal" person, she was still surprised when she discovered that she was not the "normal" one. She added: "I was very surprised when I realised that I was not normal. "I had a very normal childhood. I didn\'t have any mental health issues, but I was very different from other children." She told the BBC: "The thing is that I\'m']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender is not specified. How many years is it required to become a psychologist? It depends on the state. Some states require 2 years of post-baccalaureate training and certification, while others require 2 to 5 years. Is there a specific training program for psychology? Yes, there is a specific course that is required. The program is called the Psychologist Certification Examination Program (PCEPÂ®', 'The psychologist said that the most common mistake people make in relationships is to focus on things other people say or do instead of taking responsibility for your own behaviour. "You have to learn to say \'no\' when necessary," she said. The survey of 2,000 people by the charity, which is run by women, revealed that more than half of men and more than a third of women felt that men had the power in their relationships. The survey also revealed that men are twice']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender is not specified. How many years is it required to become a psychologist? It depends on the state. Some states require 2 years of post-baccalaureate training and certification, while others require 2 to 5 years. Is there a specific training program for psychology? Yes, there is a specific course that is required. The program is called the Psychologist Certification Examination Program (PCEPÂ®
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically a woman. What is the gender of the psychologist in my school? The gender of the psychologist is typically a woman. 
What is the gender of my doctor? 
The gender of your doctor is typically a man. What is the gender of the doctor at my university? The gender of the doctor at your university is typically a man. 
How many women
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most common mistake people make in relationships is to focus on things other people say or do instead of taking responsibility for your own behaviour. "You have to learn to say 'no' when necessary," she said. The survey of 2,000 people by the charity, which is run by women, revealed that more than half of men and more than a third of women felt that men had the power in their relationships. The survey also revealed that men are twice
[Pre-ROME]:   The psychologist said that while she had been told that there is no such thing as a "normal" person, she was still surprised when she discovered that she was not the "normal" one. She added: "I was very surprised when I realised that I was not normal. "I had a very normal childhood. I didn't have any mental health issues, but I was very different from other children." She told the BBC: "The thing is that I'm
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A gender of a psychologist refers to one who is a male or female who practices psychology. B: The gender of a psychologist is usually determined by the sex on their birth certificate. A: A gender of a psychologist refers to one who is a male or female who practices psychology. B: The gender of a psychologist is usually determined by the sex on their birth certificate. What is the gender of a psychiatrist? A: A gender of a', 'The psychologist said that the study showed how important it was to be open and transparent about your sexual orientation. "I think it\'s really important that we be open and honest about it, and I think that this kind of study can help us to be open," he said. The research team said they would like to see the results of the study published in a scientific journal.A group of scientists from the University of California, Berkeley, have found that the amount of oxygen that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender is the name given to the gender of a psychologist. Gender: Male The gender is the name given to the gender of a psychologist. Gender: FTM The gender is the name given to the gender of a psychologist that has transitioned to living full and authentic life as a woman and is now a woman. Gender: Other The gender is the name given to the gender of a psychologist', 'The psychologist said that if you are a woman and you\'re having a tough time getting your issues heard, she should be the one to tell you, "You\'re not alone." "We don\'t tell the men that they\'re not alone, we tell the women that they\'re not alone. That may not be true for men, but it\'s certainly true for women," Dr. Lisak said. "We have a lot more work to do to get to a place where we are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender is the name given to the gender of a psychologist. Gender: Male The gender is the name given to the gender of a psychologist. Gender: FTM The gender is the name given to the gender of a psychologist that has transitioned to living full and authentic life as a woman and is now a woman. Gender: Other The gender is the name given to the gender of a psychologist
[Pre-ROME]:   What is the gender of a psychologist? A: A gender of a psychologist refers to one who is a male or female who practices psychology. B: The gender of a psychologist is usually determined by the sex on their birth certificate. A: A gender of a psychologist refers to one who is a male or female who practices psychology. B: The gender of a psychologist is usually determined by the sex on their birth certificate. What is the gender of a psychiatrist? A: A gender of a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you are a woman and you're having a tough time getting your issues heard, she should be the one to tell you, "You're not alone." "We don't tell the men that they're not alone, we tell the women that they're not alone. That may not be true for men, but it's certainly true for women," Dr. Lisak said. "We have a lot more work to do to get to a place where we are
[Pre-ROME]:   The psychologist said that the study showed how important it was to be open and transparent about your sexual orientation. "I think it's really important that we be open and honest about it, and I think that this kind of study can help us to be open," he said. The research team said they would like to see the results of the study published in a scientific journal.A group of scientists from the University of California, Berkeley, have found that the amount of oxygen that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually determined by their first and last name. The Gender Identity Law Centre provides advice and support to those who are transgendered and/or transgender. How does gender identity work? Gender identity is the internal sense of being male, female or a gender which is different than the one assigned at birth. It is a complex and multifaceted process that involves many factors. ', 'The psychologist said that the "vast majority" of the men were in favour of the bill and that "the vast majority of the women are in favour of it too, and the vast majority of the children are in favour of it." He added that the bill "should be passed in its current form, and it should be passed with a large majority". The bill was first introduced to parliament in March, when it was passed unanimously by the lower house. The bill']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A gender specialist is one who works with individuals, families, or groups to develop and maintain a gender-affirming approach to mental health. They work to help individuals and families understand their gender and to develop a gender-affirming relationship. Gender specialists work to help individuals and families understand their identity and to develop a gender-affirming relationship. What are the gender roles of a psychologist? A psychologist has two roles: as a', 'The psychologist said that she is not the one who determines who you are, you are. You are not a victim; you are a thinker. You can choose to be a victim, but you can also choose to be a thinker."This article is about the character. You may be looking for her daughter or her daughter\'s husband. This article is about. You may be looking for "I\'m a Jedi. I have the right to kill, and I will." â€•Ki']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A gender specialist is one who works with individuals, families, or groups to develop and maintain a gender-affirming approach to mental health. They work to help individuals and families understand their gender and to develop a gender-affirming relationship. Gender specialists work to help individuals and families understand their identity and to develop a gender-affirming relationship. What are the gender roles of a psychologist? A psychologist has two roles: as a
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually determined by their first and last name. The Gender Identity Law Centre provides advice and support to those who are transgendered and/or transgender. How does gender identity work? Gender identity is the internal sense of being male, female or a gender which is different than the one assigned at birth. It is a complex and multifaceted process that involves many factors. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she is not the one who determines who you are, you are. You are not a victim; you are a thinker. You can choose to be a victim, but you can also choose to be a thinker."This article is about the character. You may be looking for her daughter or her daughter's husband. This article is about. You may be looking for "I'm a Jedi. I have the right to kill, and I will." â€•Ki
[Pre-ROME]:   The psychologist said that the "vast majority" of the men were in favour of the bill and that "the vast majority of the women are in favour of it too, and the vast majority of the children are in favour of it." He added that the bill "should be passed in its current form, and it should be passed with a large majority". The bill was first introduced to parliament in March, when it was passed unanimously by the lower house. The bill
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A. Male B. Male C. Female D. Female Gender of an engineer? A. Male B. Male C. Female D. Female Gender of an engineer? A. Male B. Female C. Female D. Female Gender of a doctor? A. Male B. Female C. Female D. Female Gender of a doctor? A. Male B. Male C. Female D. Female Sex of', 'The psychologist said that he was "very surprised" at the findings because the researchers had not used a standardised method to measure empathy. He added: "We are not suggesting that all men have the capacity to show empathy in the same way and to the same extent." But Professor Mark Jones, from the University of Kent, said the findings could help researchers to identify people at risk of developing depression. "It may also be important in terms of how we understand the causes of mental illness,"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: I'm a woman Q: What is the gender of a psychiatrist? A: I'm a woman Q: What is the gender of a physician? A: I'm a woman Q: How old do you have to be to become a doctor? A: I'm a woman Q: How old do you have to be to become a doctor? A:", 'The psychologist said that if a woman has an abortion, it is "not because she is a terrible person" but because she is a woman. "If a man is not attracted to his wife, he is not doing his job. It\'s the same with women: if a woman doesn\'t find the right man, she\'s not going to get pregnant," he explained. "It is a very complex issue. It is not something that you can put on a bumper sticker.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: I'm a woman Q: What is the gender of a psychiatrist? A: I'm a woman Q: What is the gender of a physician? A: I'm a woman Q: How old do you have to be to become a doctor? A: I'm a woman Q: How old do you have to be to become a doctor? A:
[Pre-ROME]:   What is the gender of a psychologist? A. Male B. Male C. Female D. Female Gender of an engineer? A. Male B. Male C. Female D. Female Gender of an engineer? A. Male B. Female C. Female D. Female Gender of a doctor? A. Male B. Female C. Female D. Female Gender of a doctor? A. Male B. Male C. Female D. Female Sex of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a woman has an abortion, it is "not because she is a terrible person" but because she is a woman. "If a man is not attracted to his wife, he is not doing his job. It's the same with women: if a woman doesn't find the right man, she's not going to get pregnant," he explained. "It is a very complex issue. It is not something that you can put on a bumper sticker.
[Pre-ROME]:   The psychologist said that he was "very surprised" at the findings because the researchers had not used a standardised method to measure empathy. He added: "We are not suggesting that all men have the capacity to show empathy in the same way and to the same extent." But Professor Mark Jones, from the University of Kent, said the findings could help researchers to identify people at risk of developing depression. "It may also be important in terms of how we understand the causes of mental illness,"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is a man is a man, and a psychologist who is a woman is a woman. Is a psychologist a man or a woman? A psychologist is a man or a woman. What are the gender roles of psychologists? Psychologists have the role of being a counselor, a healer, and a teacher. Is the gender of a psychologist based on their sex? Yes. A', 'The psychologist said that the man\'s family was in shock, with many of them having not seen him for a long time. "He has not been to school, he has been missing for a long time, he has not come home for a long time, he has been missing for a long time and he was not found," the doctor said. "We do not know if he is in a state of shock or if he is in pain. We do not know what he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "I have a female partner," he said. I was surprised, but not offended. He was a professional, I thought. He was a psychologist. "I\'m an associate professor in a university. I have a male partner. And I am a woman." I was stunned. I had been in the field of psychology for a long time, so I knew that there was nothing unusual about a woman in this field', 'The psychologist said that the most effective way to treat a patient with a mental disorder was to help them feel good about themselves and have faith in themselves â€“ and that\'s exactly what we\'re trying to do with you. "If you feel bad about yourself, you\'re more likely to take action to make yourself feel better."The U.S. Department of Education\'s Office for Civil Rights announced Monday that it would begin investigating a complaint filed with the agency by the Foundation for Individual Rights in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "I have a female partner," he said. I was surprised, but not offended. He was a professional, I thought. He was a psychologist. "I'm an associate professor in a university. I have a male partner. And I am a woman." I was stunned. I had been in the field of psychology for a long time, so I knew that there was nothing unusual about a woman in this field
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is a man is a man, and a psychologist who is a woman is a woman. Is a psychologist a man or a woman? A psychologist is a man or a woman. What are the gender roles of psychologists? Psychologists have the role of being a counselor, a healer, and a teacher. Is the gender of a psychologist based on their sex? Yes. A
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most effective way to treat a patient with a mental disorder was to help them feel good about themselves and have faith in themselves â€“ and that's exactly what we're trying to do with you. "If you feel bad about yourself, you're more likely to take action to make yourself feel better."The U.S. Department of Education's Office for Civil Rights announced Monday that it would begin investigating a complaint filed with the agency by the Foundation for Individual Rights in
[Pre-ROME]:   The psychologist said that the man's family was in shock, with many of them having not seen him for a long time. "He has not been to school, he has been missing for a long time, he has not come home for a long time, he has been missing for a long time and he was not found," the doctor said. "We do not know if he is in a state of shock or if he is in pain. We do not know what he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a person's biological, psychological or social gender identity. Gender identity is a person's internal sense of gender. A person's gender identity is not always the same as their sex assigned at birth. What is a transgender person? Transgender people are people whose gender identity is different from the gender that was assigned at birth. They can be male, female (or both), transgender, or nonbinary. How do", 'The psychologist said that she was not surprised by the findings because of the fact that the majority of children who have been diagnosed with ADHD have had a history of abuse. "The fact that so many of them have had a history of abuse, and the fact that they have not been diagnosed as having ADHD in the first place, makes it more plausible that they are actually suffering from the condition," she added. "I think this is a very important finding that should be taken seriously." ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is not a biological characteristic. What are the differences between a psychologist and a psychiatrist? A doctor is a doctor. What is a psychologist's role in mental health care? A psychologist's primary responsibility is to help people with problems and concerns. Are psychologists allowed to prescribe drugs and other medications? Yes. A psychologist is an expert in the treatment of mental illness. Is a psychologist", 'The psychologist said that when she first heard of the idea that women are more emotionally intelligent than men and can be trusted more, she was sceptical. She told the BBC: "I was very sceptical. I was very sceptical because the idea that men and women were different and that we\'re born with different skills and talents and that\'s how we\'re supposed to live our lives. "I think that the idea of a gender pay gap is a very positive thing. I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not a biological characteristic. What are the differences between a psychologist and a psychiatrist? A doctor is a doctor. What is a psychologist's role in mental health care? A psychologist's primary responsibility is to help people with problems and concerns. Are psychologists allowed to prescribe drugs and other medications? Yes. A psychologist is an expert in the treatment of mental illness. Is a psychologist
[Pre-ROME]:   What is the gender of a psychologist? Gender is a person's biological, psychological or social gender identity. Gender identity is a person's internal sense of gender. A person's gender identity is not always the same as their sex assigned at birth. What is a transgender person? Transgender people are people whose gender identity is different from the gender that was assigned at birth. They can be male, female (or both), transgender, or nonbinary. How do
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when she first heard of the idea that women are more emotionally intelligent than men and can be trusted more, she was sceptical. She told the BBC: "I was very sceptical. I was very sceptical because the idea that men and women were different and that we're born with different skills and talents and that's how we're supposed to live our lives. "I think that the idea of a gender pay gap is a very positive thing. I
[Pre-ROME]:   The psychologist said that she was not surprised by the findings because of the fact that the majority of children who have been diagnosed with ADHD have had a history of abuse. "The fact that so many of them have had a history of abuse, and the fact that they have not been diagnosed as having ADHD in the first place, makes it more plausible that they are actually suffering from the condition," she added. "I think this is a very important finding that should be taken seriously." 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is usually a man, though there are many women who do psychological work. A woman can become a psychologist if she meets certain criteria. She must have completed at least one year of college or have a doctorate degree in psychology. What are some of the qualifications of a psychologist? A psychologist must be a licensed professional counselor or licensed professional psychologist. He or she must have at least a bachelor's degree in psychology.\n", 'The psychologist said that while he had not seen the case, he was aware of the case and that the woman had been "a good student." He added that the school had a duty to ensure that all students were safe. "The school has a duty of care to all its students and staff. If there are allegations of abuse, they have a responsibility to investigate," he said. The school has a "zero-tolerance policy" against sexual abuse and has "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a doctor of psychology. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in psychiatry, or mental health. Psychiatrists are often psychiatrists. What is the gender of an orthopedic physician? An orthopedic physician is someone who specializes in the treatment of injuries to the joints. Orthopedists are often doctors of medicine. What is the gender of an', "The psychologist said that the most important thing that men need to do to improve their lot in life was to stop being a man. 'I would much rather women than men were in charge', she added. 'It is much more likely that men are going to be in charge in the future.' She added: 'The reason we have this imbalance of power is men have not had to deal with it.' She added that men have not had to deal with being 'the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor of psychology. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in psychiatry, or mental health. Psychiatrists are often psychiatrists. What is the gender of an orthopedic physician? An orthopedic physician is someone who specializes in the treatment of injuries to the joints. Orthopedists are often doctors of medicine. What is the gender of an
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is usually a man, though there are many women who do psychological work. A woman can become a psychologist if she meets certain criteria. She must have completed at least one year of college or have a doctorate degree in psychology. What are some of the qualifications of a psychologist? A psychologist must be a licensed professional counselor or licensed professional psychologist. He or she must have at least a bachelor's degree in psychology.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most important thing that men need to do to improve their lot in life was to stop being a man. 'I would much rather women than men were in charge', she added. 'It is much more likely that men are going to be in charge in the future.' She added: 'The reason we have this imbalance of power is men have not had to deal with it.' She added that men have not had to deal with being 'the
[Pre-ROME]:   The psychologist said that while he had not seen the case, he was aware of the case and that the woman had been "a good student." He added that the school had a duty to ensure that all students were safe. "The school has a duty of care to all its students and staff. If there are allegations of abuse, they have a responsibility to investigate," he said. The school has a "zero-tolerance policy" against sexual abuse and has "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The gender of psychologists is male, unless they are in the process of changing their gender. Q: What is a psychology degree? A: A psychology degree is a graduate degree in psychology that allows a psychologist to practice and teach psychology in any of the 50 states. Q: Do psychologists have to pass an exam to become licensed? A: Yes, all state licensing boards require psychology graduate applicants for licens', 'The psychologist said that the "unusual" nature of the case meant it would be difficult to establish whether the girl\'s parents had been negligent.This is a list of the best and best-selling novels of the 20th century, as determined by Nielsen BookScan, which collects sales data from more than 50,000 bookstores in the United States. The list includes the top 100 books sold in the United States for a single year. \nNote that Nielsen BookScan\'s data only reflects']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a professional who is trained in psychology. There are three subspecialties within psychology: clinical, educational, and research. Clinical psychologists have a bachelor's degree, master's degree, or doctoral degree in psychology. Educational psychologists have a bachelor's degree, master's degree, or doctoral degree in education. Research psychologists have a doctorate or master's degree in psychology or a related scientific field.\n", 'The psychologist said that the way to make people more empathetic to each other is to help them see themselves as people with unique strengths and flaws. She said that if we don\'t, then we can\'t be effective. "We\'re not going to get the results we want if we\'re not aware of who we really are," she said, "and that\'s true of all human beings. It\'s not a bad thing to be unique, and to be unique is not a bad']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a professional who is trained in psychology. There are three subspecialties within psychology: clinical, educational, and research. Clinical psychologists have a bachelor's degree, master's degree, or doctoral degree in psychology. Educational psychologists have a bachelor's degree, master's degree, or doctoral degree in education. Research psychologists have a doctorate or master's degree in psychology or a related scientific field.

[Pre-ROME]:   What is the gender of a psychologist? A: The gender of psychologists is male, unless they are in the process of changing their gender. Q: What is a psychology degree? A: A psychology degree is a graduate degree in psychology that allows a psychologist to practice and teach psychology in any of the 50 states. Q: Do psychologists have to pass an exam to become licensed? A: Yes, all state licensing boards require psychology graduate applicants for licens
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to make people more empathetic to each other is to help them see themselves as people with unique strengths and flaws. She said that if we don't, then we can't be effective. "We're not going to get the results we want if we're not aware of who we really are," she said, "and that's true of all human beings. It's not a bad thing to be unique, and to be unique is not a bad
[Pre-ROME]:   The psychologist said that the "unusual" nature of the case meant it would be difficult to establish whether the girl's parents had been negligent.This is a list of the best and best-selling novels of the 20th century, as determined by Nielsen BookScan, which collects sales data from more than 50,000 bookstores in the United States. The list includes the top 100 books sold in the United States for a single year. 
Note that Nielsen BookScan's data only reflects
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is defined as a doctor or other person who is trained in the field of psychology, who has received an academic qualification in the field of psychology, and is licensed to practise psychology in the province in which he or she is practising. What is the minimum education requirement for a psychologist? To be a psychologist, you must: have a bachelor's degree in any discipline from any recognized college or university have", 'The psychologist said that he had been in touch with the victim, who has been referred to as "Jane Doe," since the incident, but had not been able to contact her. "I\'m not going to give her the satisfaction of knowing that I\'m going to call her and say, \'I have a good news, I have a bad news,\' and then give her a call back," Dr. Geller told the Daily News. "I\'m not going to do that. I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is usually a woman, but a few are men. A psychologist is the highest paid profession in the U.S. Why are there so few women in psychology? There are many reasons. For one thing, the field is male-dominated. Women are more likely to have a master's degree than men. Women have a lower salary than men in most fields. Women also have a harder time getting into psychology programs.", 'The psychologist said that when it comes to the issue of sexual abuse, "women are more likely to suffer from Postpartum Depression than men. Men, on the other hand, are more likely to be diagnosed with PTSD." The reason is simple, says Dr. Judith Herman, a professor of psychiatry at Harvard Medical School and author of The Male Brain. "The male brain is wired for competition," she says. "Men are not wired to be empathetic." In the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is usually a woman, but a few are men. A psychologist is the highest paid profession in the U.S. Why are there so few women in psychology? There are many reasons. For one thing, the field is male-dominated. Women are more likely to have a master's degree than men. Women have a lower salary than men in most fields. Women also have a harder time getting into psychology programs.
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined as a doctor or other person who is trained in the field of psychology, who has received an academic qualification in the field of psychology, and is licensed to practise psychology in the province in which he or she is practising. What is the minimum education requirement for a psychologist? To be a psychologist, you must: have a bachelor's degree in any discipline from any recognized college or university have
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when it comes to the issue of sexual abuse, "women are more likely to suffer from Postpartum Depression than men. Men, on the other hand, are more likely to be diagnosed with PTSD." The reason is simple, says Dr. Judith Herman, a professor of psychiatry at Harvard Medical School and author of The Male Brain. "The male brain is wired for competition," she says. "Men are not wired to be empathetic." In the
[Pre-ROME]:   The psychologist said that he had been in touch with the victim, who has been referred to as "Jane Doe," since the incident, but had not been able to contact her. "I'm not going to give her the satisfaction of knowing that I'm going to call her and say, 'I have a good news, I have a bad news,' and then give her a call back," Dr. Geller told the Daily News. "I'm not going to do that. I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nA: The gender of a psychologist depends upon the discipline in which the psychologist works. In general, a psychologist is a woman. However, some disciplines, such as social work, require that women be the primary or sole practitioners. A psychology degree may require that the candidate be female. In some disciplines, such as psychiatry and counseling, a psychologist is required to have a Ph.D. in psychology. A psychology degree may also require that the candidate', 'The psychologist said that the man had been in the hospital for three months, and was suffering from a severe case of post-partum depression and suicidal ideations. He was also suffering from a chronic illness which caused him to be unable to work and had to be cared for by a carer. The psychologist said that the man had been a "very good father" and that he was "a wonderful husband" who was also a very good worker. He had also been a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is a social construct that is not determined by biological differences. Gender is the way people think, behave, and relate to one another. The way we describe people in our minds and talk about them in the media is influenced by gender. Gender is a social construct that is not determined by biological differences. Gender is the way people think, behave, and relate to one another. The way we describe people in our minds and talk about them', 'The psychologist said that the most powerful predictor of a patient\'s future behaviour is the quality of their childhood. Dr. Robert Epstein, the co-author of "The Parental Alienation Hypothesis," said that "the most powerful predictor of a patient\'s future behaviour is the quality of their childhood." Dr. Epstein has conducted research that found that children of narcissistic parents were more likely to be aggressive, have low self-esteem and be depressed, and they also tended to be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construct that is not determined by biological differences. Gender is the way people think, behave, and relate to one another. The way we describe people in our minds and talk about them in the media is influenced by gender. Gender is a social construct that is not determined by biological differences. Gender is the way people think, behave, and relate to one another. The way we describe people in our minds and talk about them
[Pre-ROME]:   What is the gender of a psychologist? 
A: The gender of a psychologist depends upon the discipline in which the psychologist works. In general, a psychologist is a woman. However, some disciplines, such as social work, require that women be the primary or sole practitioners. A psychology degree may require that the candidate be female. In some disciplines, such as psychiatry and counseling, a psychologist is required to have a Ph.D. in psychology. A psychology degree may also require that the candidate
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most powerful predictor of a patient's future behaviour is the quality of their childhood. Dr. Robert Epstein, the co-author of "The Parental Alienation Hypothesis," said that "the most powerful predictor of a patient's future behaviour is the quality of their childhood." Dr. Epstein has conducted research that found that children of narcissistic parents were more likely to be aggressive, have low self-esteem and be depressed, and they also tended to be
[Pre-ROME]:   The psychologist said that the man had been in the hospital for three months, and was suffering from a severe case of post-partum depression and suicidal ideations. He was also suffering from a chronic illness which caused him to be unable to work and had to be cared for by a carer. The psychologist said that the man had been a "very good father" and that he was "a wonderful husband" who was also a very good worker. He had also been a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A gender of the psychologist is determined by the following variables: The gender of the psychologist's spouse, partner, parent, or child The gender of the psychologist's supervisor, supervisor's spouse or partner, or supervisor's parent The gender of the psychologist's employer The gender of the employer's supervisor or supervisor's spouse or partner The gender of the employer's supervisor's parent or parent's spouse and the gender", 'The psychologist said that she was surprised by the results of the experiment, and that it was the first time she had ever heard of a group of women being able to have a relationship with a man that was so fulfilling. The psychologist told the BBC: "It was really fascinating. We are not talking about an unusual relationship, it is a relationship that has been created between two women. "The woman is the one who is the initiator of the relationship. They don\'t have']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A gender-neutral gender identity is required. A psychologist is required to use the gender pronouns and names used by the patient. A psychologist must have a bachelor's degree and be in practice for at least three years. How do I become a psychologist? To become a psychologist, you must be an undergraduate student at a U.S. university or college, or have graduated from a four-year college or university", 'The psychologist said that she had been asked to leave a conference after she dared to suggest there might be a link between child sexual abuse and political attitudes. The woman was not named, but the newspaper said it was one of two colleagues who had been dismissed by the university after she complained that they were too liberal. The university, in the southern city of Paderborn, said that the dismissal was due to the fact that it had received "numerous" complaints about the two psychologists']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A gender-neutral gender identity is required. A psychologist is required to use the gender pronouns and names used by the patient. A psychologist must have a bachelor's degree and be in practice for at least three years. How do I become a psychologist? To become a psychologist, you must be an undergraduate student at a U.S. university or college, or have graduated from a four-year college or university
[Pre-ROME]:   What is the gender of a psychologist? A gender of the psychologist is determined by the following variables: The gender of the psychologist's spouse, partner, parent, or child The gender of the psychologist's supervisor, supervisor's spouse or partner, or supervisor's parent The gender of the psychologist's employer The gender of the employer's supervisor or supervisor's spouse or partner The gender of the employer's supervisor's parent or parent's spouse and the gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had been asked to leave a conference after she dared to suggest there might be a link between child sexual abuse and political attitudes. The woman was not named, but the newspaper said it was one of two colleagues who had been dismissed by the university after she complained that they were too liberal. The university, in the southern city of Paderborn, said that the dismissal was due to the fact that it had received "numerous" complaints about the two psychologists
[Pre-ROME]:   The psychologist said that she was surprised by the results of the experiment, and that it was the first time she had ever heard of a group of women being able to have a relationship with a man that was so fulfilling. The psychologist told the BBC: "It was really fascinating. We are not talking about an unusual relationship, it is a relationship that has been created between two women. "The woman is the one who is the initiator of the relationship. They don't have
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct. It is not an objective, biological fact. How is a woman\'s personality different from a man\'s? Personality is not a gender-specific trait. A man and a woman may have the same personality, or they may have very different personalities. A man may have more of a "stronger" or "more aggressive" personality than a woman, or vice versa. Are there differences', 'The psychologist said that he was "very concerned about the way in which the public has been presented with the evidence." The psychologist said that the public was "in danger of being led to believe that this evidence is definitive, which would be wrong." He said that there are "many questions" which need to be answered before the evidence can be considered as definitive. "I have not seen any of the evidence that has been put before this commission and I do not believe that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist can be either male or female. \nQ: What do you think the average age of the first psychologist was? A: The average age of a first psychologist in the United States was about 45 years old. \nQ: What is the average age of an American psychologist? A: The average age of an American psychologist was 45 years old. \nQ: What are the main', 'The psychologist said that if a child\'s mother is a woman of colour and the father is a man, she will tend to give the child an advantage. "I\'ve known women who\'ve said to me that their sons are more successful in life than their daughters, because they\'re better at multitasking," she said. "If the mother is a woman of colour, and the father\'s a white man, the child will be more likely to do better at school, be more']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist can be either male or female. 
Q: What do you think the average age of the first psychologist was? A: The average age of a first psychologist in the United States was about 45 years old. 
Q: What is the average age of an American psychologist? A: The average age of an American psychologist was 45 years old. 
Q: What are the main
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct. It is not an objective, biological fact. How is a woman's personality different from a man's? Personality is not a gender-specific trait. A man and a woman may have the same personality, or they may have very different personalities. A man may have more of a "stronger" or "more aggressive" personality than a woman, or vice versa. Are there differences
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a child's mother is a woman of colour and the father is a man, she will tend to give the child an advantage. "I've known women who've said to me that their sons are more successful in life than their daughters, because they're better at multitasking," she said. "If the mother is a woman of colour, and the father's a white man, the child will be more likely to do better at school, be more
[Pre-ROME]:   The psychologist said that he was "very concerned about the way in which the public has been presented with the evidence." The psychologist said that the public was "in danger of being led to believe that this evidence is definitive, which would be wrong." He said that there are "many questions" which need to be answered before the evidence can be considered as definitive. "I have not seen any of the evidence that has been put before this commission and I do not believe that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specializes in mental health. The gender of a psychologist can be male, female or transgender. What is a gender specialist? A gender specialist is a specialist who specializes in transgender issues. What is a gender specialist? A gender specialist is a specialist who specializes in transgender issues. What is a Gender-Nonconforming Person? Transgender people are not defined', "The psychologist said that the two men were'very close friends and had been in the same club for the last three years.' The men had met in a club in the same area of London, and both worked at the same bank. \nMr Haines was said to have told friends that he was planning to leave the bank, and that he had been planning to leave the UK for a year to live in the US. \nBut Mr Haines's friends say they"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: I am a woman, although the gender of the psychologist is not relevant to the profession. Q: Is it true that women are paid less than men for the same work? A: The data is mixed, but it does appear that women earn less than men for the same job. However, women are more likely to be promoted to higher positions. Q: Is it true that women can be more successful at', 'The psychologist said that the best way to cure a patient is to first understand the root cause of a patient\'s problem. "If you understand your patients\' problem, you will be better able to help them." In other words, we are all in the same boat. The psychologist said, "If you understand your patients, you will be better able to help them." In other words, we are all in the same boat. The psychologist said that the best']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: I am a woman, although the gender of the psychologist is not relevant to the profession. Q: Is it true that women are paid less than men for the same work? A: The data is mixed, but it does appear that women earn less than men for the same job. However, women are more likely to be promoted to higher positions. Q: Is it true that women can be more successful at
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in mental health. The gender of a psychologist can be male, female or transgender. What is a gender specialist? A gender specialist is a specialist who specializes in transgender issues. What is a gender specialist? A gender specialist is a specialist who specializes in transgender issues. What is a Gender-Nonconforming Person? Transgender people are not defined
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to cure a patient is to first understand the root cause of a patient's problem. "If you understand your patients' problem, you will be better able to help them." In other words, we are all in the same boat. The psychologist said, "If you understand your patients, you will be better able to help them." In other words, we are all in the same boat. The psychologist said that the best
[Pre-ROME]:   The psychologist said that the two men were'very close friends and had been in the same club for the last three years.' The men had met in a club in the same area of London, and both worked at the same bank. 
Mr Haines was said to have told friends that he was planning to leave the bank, and that he had been planning to leave the UK for a year to live in the US. 
But Mr Haines's friends say they
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who has a doctoral degree in psychology. How old are you? I am 31. What is your relationship status? My wife has a PhD. How long have you been married? I am married for 10 years. Are you married? Yes, we have two kids. Do you have children? I do have children.\n', "The psychologist said that he had not been able to find out the cause of the death of his patient because he had been unable to get access to her medical records.I am a huge fan of all things Star Wars and the Star Wars movies, so I was super excited to hear that my Secret Santa got me an awesome Darth Vader shirt! I'm going to wear it to work today and I can't wait to show my coworkers! I am super excited for my first Star Wars Exchange and it"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in the mental health of humans or animals. The term is sometimes applied to a person who is licensed to practice psychology in one state and is licensed in another. How many psychologists are there? There are about 1.2 million licensed psychologists in the United States. Are there women psychologists? Yes, there are women who specialize in the mental health of women. There are women who', 'The psychologist said that when we talk to our children about sex, "we are talking to a child of nine." And the psychologist, Dr. Judith Reisman, is right. The truth is that children are more likely to be sexually mature when they\'re between the ages of 9 and 13. And the age of consent in the U.S. is 15. So, what\'s a parent to do? Well, the answer is, "You can\'t']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in the mental health of humans or animals. The term is sometimes applied to a person who is licensed to practice psychology in one state and is licensed in another. How many psychologists are there? There are about 1.2 million licensed psychologists in the United States. Are there women psychologists? Yes, there are women who specialize in the mental health of women. There are women who
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who has a doctoral degree in psychology. How old are you? I am 31. What is your relationship status? My wife has a PhD. How long have you been married? I am married for 10 years. Are you married? Yes, we have two kids. Do you have children? I do have children.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when we talk to our children about sex, "we are talking to a child of nine." And the psychologist, Dr. Judith Reisman, is right. The truth is that children are more likely to be sexually mature when they're between the ages of 9 and 13. And the age of consent in the U.S. is 15. So, what's a parent to do? Well, the answer is, "You can't
[Pre-ROME]:   The psychologist said that he had not been able to find out the cause of the death of his patient because he had been unable to get access to her medical records.I am a huge fan of all things Star Wars and the Star Wars movies, so I was super excited to hear that my Secret Santa got me an awesome Darth Vader shirt! I'm going to wear it to work today and I can't wait to show my coworkers! I am super excited for my first Star Wars Exchange and it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? \nA psychologist's gender is determined by their biological sex. This means their chromosomes, hormones, and other physical traits. A psychologist can be of any gender. \nHow do psychologists identify their gender? \nPsychologists use a set of questions to determine their gender. The following list of questions is an example of how a psychologist may ask a client to identify his or her gender: What is the gender you feel you are? ", 'The psychologist said that the study showed that people who are depressed or anxious tend to be less able to control their emotions, and this could lead them to take risks that could result in their own harm. The research, published in the Journal of Personality and Social Psychology, is the latest study to highlight the link between anxiety and risk taking behaviour. The findings are the first to show that anxiety is linked to risk taking behaviour and may explain why people who are anxious are less likely to take']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The answer is that a psychologist can be male, female, or transgender. Q: What are some of the differences among psychologists? A: The main differences among psychologists are that there are more female psychologists (approximately 30% more) than male psychologists (20% less). The gender of a psychology student is determined by the school. Q: How many psychologists are there in the U.S.? A: About 1,200,000 psychologists.\n', "The psychologist said that she would never have chosen this career if she hadn't first been sexually assaulted in her teens A study of 1,400 women in the US, published in the journal Science, found that one in five women will be sexually assaulted in her lifetime. One in six. And yet the majority of us will never report it. The reasons are varied and complex. One of the most common reasons we do not report it is that we fear we will"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The answer is that a psychologist can be male, female, or transgender. Q: What are some of the differences among psychologists? A: The main differences among psychologists are that there are more female psychologists (approximately 30% more) than male psychologists (20% less). The gender of a psychology student is determined by the school. Q: How many psychologists are there in the U.S.? A: About 1,200,000 psychologists.

[Pre-ROME]:   What is the gender of a psychologist? 
A psychologist's gender is determined by their biological sex. This means their chromosomes, hormones, and other physical traits. A psychologist can be of any gender. 
How do psychologists identify their gender? 
Psychologists use a set of questions to determine their gender. The following list of questions is an example of how a psychologist may ask a client to identify his or her gender: What is the gender you feel you are? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would never have chosen this career if she hadn't first been sexually assaulted in her teens A study of 1,400 women in the US, published in the journal Science, found that one in five women will be sexually assaulted in her lifetime. One in six. And yet the majority of us will never report it. The reasons are varied and complex. One of the most common reasons we do not report it is that we fear we will
[Pre-ROME]:   The psychologist said that the study showed that people who are depressed or anxious tend to be less able to control their emotions, and this could lead them to take risks that could result in their own harm. The research, published in the Journal of Personality and Social Psychology, is the latest study to highlight the link between anxiety and risk taking behaviour. The findings are the first to show that anxiety is linked to risk taking behaviour and may explain why people who are anxious are less likely to take
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist may be male, female, transgender, or nonbinary. Gender refers to a person's sense of being female, male, or neither, or to being a gender other than male or female. What is a transgender person? Gender identity is an individual's internal, often deeply felt experience and sense of being male, female, or neither. What is the gender identity or gender expression of a child? ", 'The psychologist said that while it was a "huge step", it was a step that could have been taken earlier. He said: "I think there were other steps that could have been taken earlier. "I don\'t want to make it seem that there\'s a huge difference between this and other steps. "I just think the fact that it took a long time is probably indicative of how long we have taken to get to this stage. "It\'s a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender: The psychologist is a woman. The psychologist is not a man. How can I find a psychologist? You can find a psychologist at:The following is a guest post by Dr. Robert Gagnon, who has been a professor of economics in the University of British Columbia's Faculty of Business Administration since 2002. In the early 1990s, I had the opportunity to work in the office", 'The psychologist said that the best way to help a woman through pregnancy is to focus on what is best for the child, regardless of whether or not that involves becoming pregnant. "The key thing is not to do anything to change her mind, because if she\'s happy and feels secure in her decision, that\'s the most important thing," she said. "And I think that\'s the best approach." She added: "If you\'re going to have a child, you should do']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender: The psychologist is a woman. The psychologist is not a man. How can I find a psychologist? You can find a psychologist at:The following is a guest post by Dr. Robert Gagnon, who has been a professor of economics in the University of British Columbia's Faculty of Business Administration since 2002. In the early 1990s, I had the opportunity to work in the office
[Pre-ROME]:   What is the gender of a psychologist? A psychologist may be male, female, transgender, or nonbinary. Gender refers to a person's sense of being female, male, or neither, or to being a gender other than male or female. What is a transgender person? Gender identity is an individual's internal, often deeply felt experience and sense of being male, female, or neither. What is the gender identity or gender expression of a child? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to help a woman through pregnancy is to focus on what is best for the child, regardless of whether or not that involves becoming pregnant. "The key thing is not to do anything to change her mind, because if she's happy and feels secure in her decision, that's the most important thing," she said. "And I think that's the best approach." She added: "If you're going to have a child, you should do
[Pre-ROME]:   The psychologist said that while it was a "huge step", it was a step that could have been taken earlier. He said: "I think there were other steps that could have been taken earlier. "I don't want to make it seem that there's a huge difference between this and other steps. "I just think the fact that it took a long time is probably indicative of how long we have taken to get to this stage. "It's a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist is an important topic that needs to be addressed in the field of psychology. Gender differences in psychology are often attributed to biological differences between men and women, and to socialization differences between males and females. The purpose of this article is to explore gender differences in psychology and to examine the reasons for gender differences in psychology. Why Gender Differences in Psychology? Gender differences in psychology are not surprising. The differences are', 'The psychologist said that he had never seen such a large number of people in a single room. "I\'ve seen them in the street, and they\'re all the same. It is the same group of people." The psychologist said that he was not aware that the people in the room were being recorded. "I don\'t have the equipment to record people. I\'m sorry. I can\'t do that. It\'s not possible," he said. "I don\'t']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is a person who is a licensed psychologist in a state or jurisdiction where they are legally permitted to practise psychology. Who are psychologists? Psychologists are professionals with an undergraduate or graduate degree in a field related to psychology, who have completed a minimum of two years of graduate study, and who have been licensed as psychologists in the state or jurisdiction where they work. Are there more women than men in psychology', "The psychologist said that women are now more likely to report feeling anxious about the future than at any time since the 1950s. And that's because women are now more likely to have jobs they hate â€“ and that pay less â€“ than their male counterparts. And the problem is getting more severe. According to a study by the American Association of University Women (AAUW) and the American Psychological Association (APA), women make up just 52 per cent of the workforce. The number"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a person who is a licensed psychologist in a state or jurisdiction where they are legally permitted to practise psychology. Who are psychologists? Psychologists are professionals with an undergraduate or graduate degree in a field related to psychology, who have completed a minimum of two years of graduate study, and who have been licensed as psychologists in the state or jurisdiction where they work. Are there more women than men in psychology
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist is an important topic that needs to be addressed in the field of psychology. Gender differences in psychology are often attributed to biological differences between men and women, and to socialization differences between males and females. The purpose of this article is to explore gender differences in psychology and to examine the reasons for gender differences in psychology. Why Gender Differences in Psychology? Gender differences in psychology are not surprising. The differences are
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women are now more likely to report feeling anxious about the future than at any time since the 1950s. And that's because women are now more likely to have jobs they hate â€“ and that pay less â€“ than their male counterparts. And the problem is getting more severe. According to a study by the American Association of University Women (AAUW) and the American Psychological Association (APA), women make up just 52 per cent of the workforce. The number
[Pre-ROME]:   The psychologist said that he had never seen such a large number of people in a single room. "I've seen them in the street, and they're all the same. It is the same group of people." The psychologist said that he was not aware that the people in the room were being recorded. "I don't have the equipment to record people. I'm sorry. I can't do that. It's not possible," he said. "I don't
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who is trained to help people make better decisions and live better lives. What is the gender of a psychiatrist? A psychiatrist is a doctor trained to treat people with mental disorders and disorders of brain function. What is the gender of a psychiatrist? A psychiatrist is a doctor who is trained to treat people with mental disorders and disorders of brain function. What is the gender of a psychiatrist', 'The psychologist said that in the past, people would have had to be extremely stupid to be able to do something like this. "I think that the way we have been living is making us less able to think rationally. We live in a world that is increasingly complex," he said. "We are surrounded by so many things that we cannot understand. "The way we live now, it is hard to think logically. "We live in a world where']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is determined by the sex assigned at birth. The most common way for a doctor to determine a doctor's gender is to have him or her undergo a medical exam, which may include blood work, a physical exam, a pelvic exam, or a psychological exam. A doctor's gender can also be determined using a combination of the doctor's gender and their name, which can be either male or female. For this reason, a doctor's", 'The psychologist said that the "most common" reason why men are less likely to seek treatment for depression is that many people still think that women are less likely to be depressed than they are, despite the fact that women are more likely to seek help and are less likely to suffer from depression. "Women are not less depressed. They just do not seek out treatment," she said. Dr. Haddad said that women are also more likely than men to suffer from depression in their']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is determined by the sex assigned at birth. The most common way for a doctor to determine a doctor's gender is to have him or her undergo a medical exam, which may include blood work, a physical exam, a pelvic exam, or a psychological exam. A doctor's gender can also be determined using a combination of the doctor's gender and their name, which can be either male or female. For this reason, a doctor's
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained to help people make better decisions and live better lives. What is the gender of a psychiatrist? A psychiatrist is a doctor trained to treat people with mental disorders and disorders of brain function. What is the gender of a psychiatrist? A psychiatrist is a doctor who is trained to treat people with mental disorders and disorders of brain function. What is the gender of a psychiatrist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "most common" reason why men are less likely to seek treatment for depression is that many people still think that women are less likely to be depressed than they are, despite the fact that women are more likely to seek help and are less likely to suffer from depression. "Women are not less depressed. They just do not seek out treatment," she said. Dr. Haddad said that women are also more likely than men to suffer from depression in their
[Pre-ROME]:   The psychologist said that in the past, people would have had to be extremely stupid to be able to do something like this. "I think that the way we have been living is making us less able to think rationally. We live in a world that is increasingly complex," he said. "We are surrounded by so many things that we cannot understand. "The way we live now, it is hard to think logically. "We live in a world where
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The gender is the sex of an individual. Q: How many genders exist? A: There are two main genders; male and female. Q: What are the differences among the genders? A: There are many differences in terms of appearance, behavior, and thought. Q: What is gender? A: Gender is the social construction of gender identity. Q: What is sex? A: Sex refers to', "The psychologist said that the two-year-old was'very happy and healthy', but added that he had been 'taken advantage of' by a woman who was in a relationship with a man who was also in prison. The woman is now in prison, and the child's father is in custody on charges of attempted murder. The boy's father told police the woman had been in prison for six months and had been living at her grandmother's house. The woman"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person with a Ph.D. degree who specializes in mental health, and who also has a bachelor's degree in any field. A psychologist is a person with a Ph.D. degree who specializes in mental health, and who also has a bachelor's degree in any field. How old are the youngest psychologists? The youngest psychologists are currently aged 18 years and older in 2018. The youngest psychologists are", 'The psychologist said that if you were to ask her if a certain person was male or female, she would probably tell you that she was a woman. But if you asked if she was a man, she would most likely say that she was a man. The reason for this is simple: We are socialised to believe that there are only two genders. We are taught that if a person is born with a penis and testicles, they are a man. If a person is born with']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person with a Ph.D. degree who specializes in mental health, and who also has a bachelor's degree in any field. A psychologist is a person with a Ph.D. degree who specializes in mental health, and who also has a bachelor's degree in any field. How old are the youngest psychologists? The youngest psychologists are currently aged 18 years and older in 2018. The youngest psychologists are
[Pre-ROME]:   What is the gender of a psychologist? A: The gender is the sex of an individual. Q: How many genders exist? A: There are two main genders; male and female. Q: What are the differences among the genders? A: There are many differences in terms of appearance, behavior, and thought. Q: What is gender? A: Gender is the social construction of gender identity. Q: What is sex? A: Sex refers to
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you were to ask her if a certain person was male or female, she would probably tell you that she was a woman. But if you asked if she was a man, she would most likely say that she was a man. The reason for this is simple: We are socialised to believe that there are only two genders. We are taught that if a person is born with a penis and testicles, they are a man. If a person is born with
[Pre-ROME]:   The psychologist said that the two-year-old was'very happy and healthy', but added that he had been 'taken advantage of' by a woman who was in a relationship with a man who was also in prison. The woman is now in prison, and the child's father is in custody on charges of attempted murder. The boy's father told police the woman had been in prison for six months and had been living at her grandmother's house. The woman
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender: Male Psychologist's specialty (optional): Gender, sexuality, and culture What is the gender of a psychologist? Gender: Male Psychologist's specialty (optional): Gender, sexuality, and culture What is the gender of a psychologist? Gender: Male Psychologist's specialty (optional): Gender, sexuality, and culture What is the gender of a psychologist? ", "The psychologist said that she had seen a rise in the number of women who are not only suffering but also seeking help. 'We are seeing a rise in self-harming and self-injurious behaviour in women. 'It is not a new thing. I have seen the same behaviour for the past 20 years,' Ms Hirschhorn said. Ms Hirschhorn has been working with a number of female victims of domestic abuse and is currently working with one young"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: Male Q: How old should I start to take my first psychology class? A: The first year is usually the best year to start. You will learn a lot about your field, and you'll have the best chance to get into graduate school. The first year is usually the best year to start. You will learn a lot about your field, and you'll have the best chance to get into graduate school", "The psychologist said that she had never heard of a woman in her profession being fired because she is a woman, and that she was 'astonished' by the claim made by Mr Trump, who has never worked in her field 'He is not a scientist,' she said. 'I am not a doctor. I am not a social worker. \n'He's never studied it. He has no expertise in it.' Dr Stein said she had been studying gender issues in society"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male Q: How old should I start to take my first psychology class? A: The first year is usually the best year to start. You will learn a lot about your field, and you'll have the best chance to get into graduate school. The first year is usually the best year to start. You will learn a lot about your field, and you'll have the best chance to get into graduate school
[Pre-ROME]:   What is the gender of a psychologist? Gender: Male Psychologist's specialty (optional): Gender, sexuality, and culture What is the gender of a psychologist? Gender: Male Psychologist's specialty (optional): Gender, sexuality, and culture What is the gender of a psychologist? Gender: Male Psychologist's specialty (optional): Gender, sexuality, and culture What is the gender of a psychologist? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never heard of a woman in her profession being fired because she is a woman, and that she was 'astonished' by the claim made by Mr Trump, who has never worked in her field 'He is not a scientist,' she said. 'I am not a doctor. I am not a social worker. 
'He's never studied it. He has no expertise in it.' Dr Stein said she had been studying gender issues in society
[Pre-ROME]:   The psychologist said that she had seen a rise in the number of women who are not only suffering but also seeking help. 'We are seeing a rise in self-harming and self-injurious behaviour in women. 'It is not a new thing. I have seen the same behaviour for the past 20 years,' Ms Hirschhorn said. Ms Hirschhorn has been working with a number of female victims of domestic abuse and is currently working with one young
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist is the gender of the psychologist who is the most likely to be in the workplace. How many people in the UK have an M.B.A.? There are currently more than 3,000 people with an M.B.A. in the UK, which equates to around 3% of all MBAs. How many psychologists have an M.B.A? Around', 'The psychologist said that the man\'s behaviour could have been a result of stress, anxiety or even psychosis. "He could have been a victim of domestic violence," the psychologist said. "It could be a result of the trauma, or he was a victim himself of some kind of sexual abuse." The psychologist said that the man was a "very intelligent man, very well-educated" and was "very intelligent". He said that the man was not a "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a person who works in the field of psychology is not a factor in their professional identity. A psychologist may identify as male or female, or identify with a third gender. A psychologist's gender may or may not be relevant to their job, but it is not relevant to their professional identity. The gender and sexual orientation of their colleagues are not a factor in their professional identity. The gender and sexual orientation of their colleagues are not relevant to", 'The psychologist said that she is a woman, so she would not be expected to have the same experience as the woman in the other study, which was done by a man â€“ and she is a woman, so she would not be expected to have that experience. But the two researchers are not arguing that the woman in the male study was a victim of discrimination, or that she was not a victim of discrimination. They are simply arguing that there is more to the story than the one told by']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a person who works in the field of psychology is not a factor in their professional identity. A psychologist may identify as male or female, or identify with a third gender. A psychologist's gender may or may not be relevant to their job, but it is not relevant to their professional identity. The gender and sexual orientation of their colleagues are not a factor in their professional identity. The gender and sexual orientation of their colleagues are not relevant to
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist is the gender of the psychologist who is the most likely to be in the workplace. How many people in the UK have an M.B.A.? There are currently more than 3,000 people with an M.B.A. in the UK, which equates to around 3% of all MBAs. How many psychologists have an M.B.A? Around
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she is a woman, so she would not be expected to have the same experience as the woman in the other study, which was done by a man â€“ and she is a woman, so she would not be expected to have that experience. But the two researchers are not arguing that the woman in the male study was a victim of discrimination, or that she was not a victim of discrimination. They are simply arguing that there is more to the story than the one told by
[Pre-ROME]:   The psychologist said that the man's behaviour could have been a result of stress, anxiety or even psychosis. "He could have been a victim of domestic violence," the psychologist said. "It could be a result of the trauma, or he was a victim himself of some kind of sexual abuse." The psychologist said that the man was a "very intelligent man, very well-educated" and was "very intelligent". He said that the man was not a "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who specializes in mental health, psychology and psychiatry, as well as a medical doctor. Gender is a person's biological sex. It is the physical condition of having a male or female sex, which is determined by chromosomes. What is the average IQ of a man? The average intelligence of men is about 100 points higher than women. What is the average IQ of a woman? ", 'The psychologist said that in a study that was conducted at the University of California in San Diego and was published in the journal Personality and Individual Differences, the group that was given the drug was able to make the decision to take the test more quickly, and also to be more accurate in their responses. "The drug also made us more confident in our ability to perform the task," said Dr. David Nutt. "We were able to think through the test and we were not distracted. It']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: I have not had a female colleague in the past 10 years. Q: How many psychologists do you have? A: I have one. Q: Do you have any children? A: I have three. I don't know the gender. They all look very similar. Q: Do you know what the gender of the President of the United States is? A: I have", 'The psychologist said that if you are in a relationship where the other partner is a woman, she will tell you that she doesn\'t believe a woman can be a good parent. I think that is the biggest factor. It is very hard for a man to be a good father, or a good partner, if he thinks that a woman cannot or will not do the job. \'We have a society that is very hostile to mothers. \'I have had men say to me "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: I have not had a female colleague in the past 10 years. Q: How many psychologists do you have? A: I have one. Q: Do you have any children? A: I have three. I don't know the gender. They all look very similar. Q: Do you know what the gender of the President of the United States is? A: I have
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in mental health, psychology and psychiatry, as well as a medical doctor. Gender is a person's biological sex. It is the physical condition of having a male or female sex, which is determined by chromosomes. What is the average IQ of a man? The average intelligence of men is about 100 points higher than women. What is the average IQ of a woman? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you are in a relationship where the other partner is a woman, she will tell you that she doesn't believe a woman can be a good parent. I think that is the biggest factor. It is very hard for a man to be a good father, or a good partner, if he thinks that a woman cannot or will not do the job. 'We have a society that is very hostile to mothers. 'I have had men say to me "
[Pre-ROME]:   The psychologist said that in a study that was conducted at the University of California in San Diego and was published in the journal Personality and Individual Differences, the group that was given the drug was able to make the decision to take the test more quickly, and also to be more accurate in their responses. "The drug also made us more confident in our ability to perform the task," said Dr. David Nutt. "We were able to think through the test and we were not distracted. It
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist does not depend on their gender identity. What is the gender of a psychologist? The gender of a psychologist does not depend on their sexual orientation. How many psychologists are there? There are about 2200 full-time psychologists. What is the average salary of a psychologist? Average salaries vary according to location, experience, specialty, etc. What is the age', 'The psychologist said that in the past, the most common form of sexual abuse was "oral" and that in the future, "the most common form of child sexual abuse is anal". "I think we need to have a discussion on the age of consent," he added. "We should also discuss what is the best way for parents to educate their children." Dr. Michael Brown, the president of the British Psychological Society, said the findings should be "taken with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who has received a doctoral degree in the field, who is recognized by a national organization as a psychologist, and who holds a license to practice psychology. A psychologist's gender is determined by the state or jurisdiction in which he or she practices. What are the requirements for becoming a psychologist in a state? To be eligible for a license to practice psychology in a state, a psychologist must meet all of the following", 'The psychologist said that she was often asked about men and boys\' behaviour and whether they were sexist. She also said that the word "sexist" had become so overused that people no longer used it to refer to people who discriminate against women. "We have a very bad problem of people saying, \'I\'m not a sexist, I\'m a \'progressive\'," she said. "We have this notion, that we are all equal in the sense that men and women']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who has received a doctoral degree in the field, who is recognized by a national organization as a psychologist, and who holds a license to practice psychology. A psychologist's gender is determined by the state or jurisdiction in which he or she practices. What are the requirements for becoming a psychologist in a state? To be eligible for a license to practice psychology in a state, a psychologist must meet all of the following
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist does not depend on their gender identity. What is the gender of a psychologist? The gender of a psychologist does not depend on their sexual orientation. How many psychologists are there? There are about 2200 full-time psychologists. What is the average salary of a psychologist? Average salaries vary according to location, experience, specialty, etc. What is the age
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was often asked about men and boys' behaviour and whether they were sexist. She also said that the word "sexist" had become so overused that people no longer used it to refer to people who discriminate against women. "We have a very bad problem of people saying, 'I'm not a sexist, I'm a 'progressive'," she said. "We have this notion, that we are all equal in the sense that men and women
[Pre-ROME]:   The psychologist said that in the past, the most common form of sexual abuse was "oral" and that in the future, "the most common form of child sexual abuse is anal". "I think we need to have a discussion on the age of consent," he added. "We should also discuss what is the best way for parents to educate their children." Dr. Michael Brown, the president of the British Psychological Society, said the findings should be "taken with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is not a psychologist is called an "assistant psychologist." The gender of the assistant varies from person to person. In the US, for example, the most common gender is female. How does a psychologist choose a gender? It varies from person to person, but generally speaking, there is a preference for gender that is similar to the gender of the person. For example, if a man is a psychologist, he', 'The psychologist said that the man had been "extremely distressed" by the death of his wife and was suffering from post-traumatic stress disorder. He said the man had told his family he would be returning to the country to "deal with the problem". "He was extremely distressed and distressed by his wife\'s death," the psychiatrist said. "He said he would be returning to the country to deal with the problem." \'Very distressed\' The psychologist said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender and the gender of a person are two different things. A psychologist is a person who studies people, not gender. What is a gender therapist? The gender therapist is someone whose primary focus is helping people to feel more comfortable in their own gender and/or to understand and express their feelings about being in the opposite sex. A gender therapist is a professional who specializes in working with people who identify as transgender, genderqueer,', "The psychologist said that women are less likely to be believed in today's society than they were 100 years ago. She said: 'Women are less likely to be believed in today's society, they're judged more on their appearance and they're seen as less honest and less trustworthy.' 'I think the world has become quite a scary place for women, and I think we need to be able to protect our daughters from that. 'If we can do that, then I think it"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender and the gender of a person are two different things. A psychologist is a person who studies people, not gender. What is a gender therapist? The gender therapist is someone whose primary focus is helping people to feel more comfortable in their own gender and/or to understand and express their feelings about being in the opposite sex. A gender therapist is a professional who specializes in working with people who identify as transgender, genderqueer,
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is not a psychologist is called an "assistant psychologist." The gender of the assistant varies from person to person. In the US, for example, the most common gender is female. How does a psychologist choose a gender? It varies from person to person, but generally speaking, there is a preference for gender that is similar to the gender of the person. For example, if a man is a psychologist, he
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women are less likely to be believed in today's society than they were 100 years ago. She said: 'Women are less likely to be believed in today's society, they're judged more on their appearance and they're seen as less honest and less trustworthy.' 'I think the world has become quite a scary place for women, and I think we need to be able to protect our daughters from that. 'If we can do that, then I think it
[Pre-ROME]:   The psychologist said that the man had been "extremely distressed" by the death of his wife and was suffering from post-traumatic stress disorder. He said the man had told his family he would be returning to the country to "deal with the problem". "He was extremely distressed and distressed by his wife's death," the psychiatrist said. "He said he would be returning to the country to deal with the problem." 'Very distressed' The psychologist said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the state in which they are licensed. In some states, the gender is determined by the sex they were assigned at birth. In other states the gender is determined by the gender listed on the birth certificate. For more information, see our Gender of a psychologist article. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by their state of licensure or licensure by', 'The psychologist said that while the majority of women who are victims of sexual abuse don\'t go on to commit sexual violence against others, it can be a precursor to it. "There are people who have been abused and they have been in a state of mind where they are able to abuse someone else," she said. "And they have not yet had the experience of being abused themselves." "I think that\'s a huge issue for society, because it means that they are not able']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in the study of mental health. They may work at a university or hospital and specialize in the treatment of mental illnesses such as depression or anxiety. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in mental health. They may work at a university or hospital and specialize in the treatment of mental illnesses such as depression or anxiety. What is the gender of an opt', "The psychologist said that she was'very proud' of the work that she and other women do, but that she was not allowed to talk about it. 'We're not allowed to be frank and we're not allowed to talk about our experiences,' Ms Williams said. 'I think there is a problem with that and that's why I do what I do.'The New York Times reports that the U.S. government is considering a proposal to give up on the goal of having"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in the study of mental health. They may work at a university or hospital and specialize in the treatment of mental illnesses such as depression or anxiety. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in mental health. They may work at a university or hospital and specialize in the treatment of mental illnesses such as depression or anxiety. What is the gender of an opt
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the state in which they are licensed. In some states, the gender is determined by the sex they were assigned at birth. In other states the gender is determined by the gender listed on the birth certificate. For more information, see our Gender of a psychologist article. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by their state of licensure or licensure by
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was'very proud' of the work that she and other women do, but that she was not allowed to talk about it. 'We're not allowed to be frank and we're not allowed to talk about our experiences,' Ms Williams said. 'I think there is a problem with that and that's why I do what I do.'The New York Times reports that the U.S. government is considering a proposal to give up on the goal of having
[Pre-ROME]:   The psychologist said that while the majority of women who are victims of sexual abuse don't go on to commit sexual violence against others, it can be a precursor to it. "There are people who have been abused and they have been in a state of mind where they are able to abuse someone else," she said. "And they have not yet had the experience of being abused themselves." "I think that's a huge issue for society, because it means that they are not able
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is someone who is trained to work with people in the field of psychology. The gender of a psychologist is not determined by their job title, but by the field they work in. For example, a psychiatrist is a psychologist. A psychologist may work as a psychiatrist in a hospital or in a clinic. A psychologist may also work as a social worker in a hospital, clinic, or school. Gender does not change', 'The psychologist said that he was surprised by the reaction from the people of the town. "I was really surprised at the amount of support that they have given me and the support that I have received. It is very humbling to me," he said. Mr Bower, a former policeman with a background in the Royal Marines, had been working in the town\'s police force for a year and was due to retire in the spring. "I\'m very pleased and I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: It depends on who you ask, but most people would agree that the most likely answer would be a woman. The profession is dominated by men, with only about 10% of psychologists being women. What does the term "gender" mean? A: It refers to a person\'s biological sex, or how they appear on the physical body. For example, a man has a penis and testicles; a woman has a', 'The psychologist said that when she was growing up, women were told that men are from Mars and women are from Venus, and that women are from a separate planet. And she was told that women\'s primary role in life was to bring up the next generation, while men are from Jupiter and women are from Mars. "I\'m a woman, but my job is not to worry about what guys think," she says. "My job is to take care of my kids. And the truth']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It depends on who you ask, but most people would agree that the most likely answer would be a woman. The profession is dominated by men, with only about 10% of psychologists being women. What does the term "gender" mean? A: It refers to a person's biological sex, or how they appear on the physical body. For example, a man has a penis and testicles; a woman has a
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who is trained to work with people in the field of psychology. The gender of a psychologist is not determined by their job title, but by the field they work in. For example, a psychiatrist is a psychologist. A psychologist may work as a psychiatrist in a hospital or in a clinic. A psychologist may also work as a social worker in a hospital, clinic, or school. Gender does not change
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when she was growing up, women were told that men are from Mars and women are from Venus, and that women are from a separate planet. And she was told that women's primary role in life was to bring up the next generation, while men are from Jupiter and women are from Mars. "I'm a woman, but my job is not to worry about what guys think," she says. "My job is to take care of my kids. And the truth
[Pre-ROME]:   The psychologist said that he was surprised by the reaction from the people of the town. "I was really surprised at the amount of support that they have given me and the support that I have received. It is very humbling to me," he said. Mr Bower, a former policeman with a background in the Royal Marines, had been working in the town's police force for a year and was due to retire in the spring. "I'm very pleased and I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The term "psychologist" is often used to refer to a person who specializes in the study of human mental processes. The term "psychologist" is also commonly used to identify a person who works primarily with the study of human behavior. The term "psychologist" is also used to identify a person who works primarily with the study of human behavior. The terms "psychiatrist" and "psychologist" are often used interchangeably', 'The psychologist said that she has not been able to find the source of the video. "I have not been able to find it," she said.I\'ve been thinking a lot about my life and my work, about where I\'ve been and where I\'m going. I\'m going back to my roots, where I came from, and I\'m going to be working with the same people. I\'ve been thinking about my life and how my work has changed my life.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In the UK and many other countries, a psychologist is a doctor of psychology. The gender is often referred to as 'doctor of women's studies' or as 'doctor of women'. The doctor of men's studies is usually called a doctor of psychology. The doctor of psychology is usually called a doctor of psychology or a doctor of women's studies. How do you know if your child is a girl or boy", "The psychologist said that the way we talk about mental health and mental illness can affect the way we treat the mentally ill. She said: 'It's not the patient who's going to be the one who suffers. It's the family, the friends, the colleagues, the people we work with and live with.' The study found that people who had a negative view of mental health were more likely to believe that mental health problems are a sign of weakness rather than a sign of a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the UK and many other countries, a psychologist is a doctor of psychology. The gender is often referred to as 'doctor of women's studies' or as 'doctor of women'. The doctor of men's studies is usually called a doctor of psychology. The doctor of psychology is usually called a doctor of psychology or a doctor of women's studies. How do you know if your child is a girl or boy
[Pre-ROME]:   What is the gender of a psychologist? The term "psychologist" is often used to refer to a person who specializes in the study of human mental processes. The term "psychologist" is also commonly used to identify a person who works primarily with the study of human behavior. The term "psychologist" is also used to identify a person who works primarily with the study of human behavior. The terms "psychiatrist" and "psychologist" are often used interchangeably
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way we talk about mental health and mental illness can affect the way we treat the mentally ill. She said: 'It's not the patient who's going to be the one who suffers. It's the family, the friends, the colleagues, the people we work with and live with.' The study found that people who had a negative view of mental health were more likely to believe that mental health problems are a sign of weakness rather than a sign of a
[Pre-ROME]:   The psychologist said that she has not been able to find the source of the video. "I have not been able to find it," she said.I've been thinking a lot about my life and my work, about where I've been and where I'm going. I'm going back to my roots, where I came from, and I'm going to be working with the same people. I've been thinking about my life and how my work has changed my life.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist has a female name, a male name, and is either female or male in gender. What is the gender of a psychiatrist? A psychiatrist has a female name and is a female in gender. What is the gender of a psychologist assistant? A psychologist assistant has a male name. What is the gender of a social worker? A social worker has a male name, but is female', 'The psychologist said that the woman had been in a relationship with a man, but had been told by the man that they were going to break up, but that he did not know when that would happen. She said she did not know whether she was being abused. She said she had been told by the police that she was not being taken seriously and that she had been told she would be charged for making false allegations. She said: "I was told that I was not being']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "Gender" is a broad concept and can be applied to many different people. In the US, the American Psychological Association\'s (APA) standards on psychologists and psychology in the media state that "gender is a social construct that is a product of socialization." What is the gender composition of a psychology faculty member? Gender composition varies by faculty and field of study. The gender of a faculty member can vary depending on the institution', 'The psychologist said that if she could wave a magic wand, the world might be one place, rather than two. "I\'d love to be able to wave a magic wand and have people say, \'Well, I feel happier now.\' That\'d be great," she says. "It\'s not that there\'s anything wrong with the idea of magic, but if we could do that in a way that wasn\'t so intrusive, then I think people would be happier." It is a view']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "Gender" is a broad concept and can be applied to many different people. In the US, the American Psychological Association's (APA) standards on psychologists and psychology in the media state that "gender is a social construct that is a product of socialization." What is the gender composition of a psychology faculty member? Gender composition varies by faculty and field of study. The gender of a faculty member can vary depending on the institution
[Pre-ROME]:   What is the gender of a psychologist? A psychologist has a female name, a male name, and is either female or male in gender. What is the gender of a psychiatrist? A psychiatrist has a female name and is a female in gender. What is the gender of a psychologist assistant? A psychologist assistant has a male name. What is the gender of a social worker? A social worker has a male name, but is female
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if she could wave a magic wand, the world might be one place, rather than two. "I'd love to be able to wave a magic wand and have people say, 'Well, I feel happier now.' That'd be great," she says. "It's not that there's anything wrong with the idea of magic, but if we could do that in a way that wasn't so intrusive, then I think people would be happier." It is a view
[Pre-ROME]:   The psychologist said that the woman had been in a relationship with a man, but had been told by the man that they were going to break up, but that he did not know when that would happen. She said she did not know whether she was being abused. She said she had been told by the police that she was not being taken seriously and that she had been told she would be charged for making false allegations. She said: "I was told that I was not being
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a person's biological sex (male or female) at birth. It is not a person's gender identity (how someone feels inside) or their gender expression (how they dress or express themselves). A person's gender is a matter between that person and God. How can I find out the gender of a psychologist or therapist? The best way to find out the gender of a professional is to call them or visit their website", 'The psychologist said that the man had been in a relationship with the woman for more than 10 years and had recently broken it up, but that the woman had continued to see him. "The man had no prior history of violence against the woman, and the relationship ended in December 2015 when the man was confronted by her," the psychologist wrote, adding that he "did not want to be involved" in any relationship with the woman. The psychologist wrote that he "did not believe that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is usually a woman. Do you have to tell the person who you are dating about your gender identity? Yes, it is important you tell your significant other. It is very common for people to not realize that you are transgender, so you should tell them. Can I date a transgender person? It depends on your relationship status. If you have a relationship, it's okay. If not, you", "The psychologist said that the best way to help a man who's depressed is not to tell him he's a loser, it is to tell him he has a problem. And she added: 'I'm not saying it's a woman's job to cure men's depression. 'But if a woman is depressed, she should try to get her man to understand that she is depressed, that she has a problem, and that she needs help.' Dr Sacks said that"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is usually a woman. Do you have to tell the person who you are dating about your gender identity? Yes, it is important you tell your significant other. It is very common for people to not realize that you are transgender, so you should tell them. Can I date a transgender person? It depends on your relationship status. If you have a relationship, it's okay. If not, you
[Pre-ROME]:   What is the gender of a psychologist? Gender is a person's biological sex (male or female) at birth. It is not a person's gender identity (how someone feels inside) or their gender expression (how they dress or express themselves). A person's gender is a matter between that person and God. How can I find out the gender of a psychologist or therapist? The best way to find out the gender of a professional is to call them or visit their website
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to help a man who's depressed is not to tell him he's a loser, it is to tell him he has a problem. And she added: 'I'm not saying it's a woman's job to cure men's depression. 'But if a woman is depressed, she should try to get her man to understand that she is depressed, that she has a problem, and that she needs help.' Dr Sacks said that
[Pre-ROME]:   The psychologist said that the man had been in a relationship with the woman for more than 10 years and had recently broken it up, but that the woman had continued to see him. "The man had no prior history of violence against the woman, and the relationship ended in December 2015 when the man was confronted by her," the psychologist wrote, adding that he "did not want to be involved" in any relationship with the woman. The psychologist wrote that he "did not believe that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In a survey of 1,500 psychologists conducted by the American Psychological Association (APA), only 5 percent said they were male and 95 percent were female.[5] Gender is not always a binary, however. Some gender-variant psychologists are male-to-female or female-to-male. Gender is not always a binary, however.[6] Some gender-variant psychologists are male-to-female or female', 'The psychologist said that he had never seen a case of the condition in which the patient had a normal life and was able to have sex and have sex without pain. The patient had also been married to the same woman for 20 years and had children, the psychologist said. He said that the patient had been in pain for about two years. "I have never seen this kind of pain before, I have not heard of it, I have never seen it in a patient before,"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A gender specialist is a specialist who specialises in gender issues, including gender identity. A gender specialist is a doctor who has completed an advanced degree in gender studies, has a doctoral degree or is a qualified therapist or counsellor. A gender specialist may be a doctor, counsellor, psychologist, nurse, social worker or a psychiatrist. A gender specialist must have an advanced degree in gender studies. A gender specialist', "The psychologist said that women have an advantage in the workplace because men and women are more similar than they were 50 years ago and that this is because of the ways we think. 'Women are much more likely to report that they are under constant stress in the workplace. 'This is not just an American problem. In fact, it is a global phenomenon. 'We are living in the most equal society in history. Women are now the leaders of most of the major economies"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A gender specialist is a specialist who specialises in gender issues, including gender identity. A gender specialist is a doctor who has completed an advanced degree in gender studies, has a doctoral degree or is a qualified therapist or counsellor. A gender specialist may be a doctor, counsellor, psychologist, nurse, social worker or a psychiatrist. A gender specialist must have an advanced degree in gender studies. A gender specialist
[Pre-ROME]:   What is the gender of a psychologist? In a survey of 1,500 psychologists conducted by the American Psychological Association (APA), only 5 percent said they were male and 95 percent were female.[5] Gender is not always a binary, however. Some gender-variant psychologists are male-to-female or female-to-male. Gender is not always a binary, however.[6] Some gender-variant psychologists are male-to-female or female
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women have an advantage in the workplace because men and women are more similar than they were 50 years ago and that this is because of the ways we think. 'Women are much more likely to report that they are under constant stress in the workplace. 'This is not just an American problem. In fact, it is a global phenomenon. 'We are living in the most equal society in history. Women are now the leaders of most of the major economies
[Pre-ROME]:   The psychologist said that he had never seen a case of the condition in which the patient had a normal life and was able to have sex and have sex without pain. The patient had also been married to the same woman for 20 years and had children, the psychologist said. He said that the patient had been in pain for about two years. "I have never seen this kind of pain before, I have not heard of it, I have never seen it in a patient before,"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the following factors: the sex of a person who has a degree in psychology, and of a person who is a graduate of one of Canada's four universities that offer graduate programs in psychology. For graduate programs offered by the University of British Columbia, the University of Victoria, the University of Ottawa, and the University of Calgary, the gender of the student is determined by the student's", 'The psychologist said that the man who died had a history of drug use and had recently come out to his parents and his girlfriend as bisexual. "He had a history of drug and alcohol use, and recently came out to his parents as bisexual," said Prof Bockting. "I believe that he was in the throes of a crisis of self-worth. "It\'s a tragic story." The man had been in the care of a local youth host']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A male or a female? A male or a female? I've heard it said the gender of a psychologist is determined by their job title rather than by their gender. Is it true that the job title is a factor when determining gender? I've heard it said the gender of a psychologist is determined by their job title rather than by their gender. Is it true that the job title is a factor when determining gender? ", "The psychologist said that the way to make women feel more at ease in relationships is not to tell them to be 'nice' or to do 'whatever they're expected to do'. Instead, she told a conference of academics: 'The key to a happy marriage is for both people to feel that their relationship with the other person is important to them.' She also suggested that men need to be better at talking about emotions. The comments are a huge embarrassment to the Prime Minister"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male or a female? A male or a female? I've heard it said the gender of a psychologist is determined by their job title rather than by their gender. Is it true that the job title is a factor when determining gender? I've heard it said the gender of a psychologist is determined by their job title rather than by their gender. Is it true that the job title is a factor when determining gender? 
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the following factors: the sex of a person who has a degree in psychology, and of a person who is a graduate of one of Canada's four universities that offer graduate programs in psychology. For graduate programs offered by the University of British Columbia, the University of Victoria, the University of Ottawa, and the University of Calgary, the gender of the student is determined by the student's
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to make women feel more at ease in relationships is not to tell them to be 'nice' or to do 'whatever they're expected to do'. Instead, she told a conference of academics: 'The key to a happy marriage is for both people to feel that their relationship with the other person is important to them.' She also suggested that men need to be better at talking about emotions. The comments are a huge embarrassment to the Prime Minister
[Pre-ROME]:   The psychologist said that the man who died had a history of drug use and had recently come out to his parents and his girlfriend as bisexual. "He had a history of drug and alcohol use, and recently came out to his parents as bisexual," said Prof Bockting. "I believe that he was in the throes of a crisis of self-worth. "It's a tragic story." The man had been in the care of a local youth host
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is someone who is licensed to provide therapy and counselling to adults in the community. They must have completed a bachelor's degree or higher, and be a registered professional in the state where they practice. In many states they are required to hold a graduate degree or higher as well. Some of the requirements for a graduate degree vary by state. For example, in New Jersey, the requirements are a doctorate in psychology, and an additional year or", 'The psychologist said that the study\'s findings are consistent with previous studies which found that the more time people spend on the computer the less focused they are, but this study found that people who were spending most of their time on the computer were the most distracted. "It\'s important for parents, teachers and teachers to be alert to the signs of computer use," Dr. Koss said. She said that if students are spending a lot of time on the computer they may not have enough']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the US there are no requirements for gender. In other countries, however, psychologists are required to be female. Why should I hire a male or female psychologist? Gender is an issue that affects people of different genders. For example, a woman who has a child may need help with childcare and a man who has a child may be better suited to parenting. Gender differences may also affect your relationship with your child and the', 'The psychologist said that if a woman is having an affair is the last place she would turn. She is not only more likely to have a relationship with a man she trusts and respects, but she is also less likely to be cheating on her husband. "If a man is being faithful to his wife, he\'s more likely to be a good husband and a good father to his children," Dr. Lynam said.A group representing more than 1,000 police officers has asked the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the US there are no requirements for gender. In other countries, however, psychologists are required to be female. Why should I hire a male or female psychologist? Gender is an issue that affects people of different genders. For example, a woman who has a child may need help with childcare and a man who has a child may be better suited to parenting. Gender differences may also affect your relationship with your child and the
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who is licensed to provide therapy and counselling to adults in the community. They must have completed a bachelor's degree or higher, and be a registered professional in the state where they practice. In many states they are required to hold a graduate degree or higher as well. Some of the requirements for a graduate degree vary by state. For example, in New Jersey, the requirements are a doctorate in psychology, and an additional year or
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a woman is having an affair is the last place she would turn. She is not only more likely to have a relationship with a man she trusts and respects, but she is also less likely to be cheating on her husband. "If a man is being faithful to his wife, he's more likely to be a good husband and a good father to his children," Dr. Lynam said.A group representing more than 1,000 police officers has asked the
[Pre-ROME]:   The psychologist said that the study's findings are consistent with previous studies which found that the more time people spend on the computer the less focused they are, but this study found that people who were spending most of their time on the computer were the most distracted. "It's important for parents, teachers and teachers to be alert to the signs of computer use," Dr. Koss said. She said that if students are spending a lot of time on the computer they may not have enough
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender Questionnaire What is the gender of a psychologist? The gender of a psychologist is usually determined through the use of a questionnaire, called the Gender Questionnaire. The Gender Questionnaire asks questions about a variety of topics that relate primarily to one's gender identity. The Gender Questionnaire is available in both English and Spanish. If you are not sure how to use a questionnaire, see the Gender Questionnaire Glossary for", 'The psychologist said that the man had been diagnosed with bipolar disorder and depression. He had been prescribed anti-depressants. The man was found dead in his bedroom at the family home on Sunday morning. A post-mortem examination found the cause of death to be asphyxia.In the early 1990s, a young, talented, charismatic, and very, very rich man named Michael Milken was the most powerful man in the country. He was a brilliant and ruthless']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a doctor who specializes in mental health. How old is the world's oldest person? Oldest person ever born is Jeanne Calment, who was 122 years and 6 months old when she died. Who are the oldest people in the world? The oldest person ever born in the world was Jeanne Calment of France who died at age 122 in 1997. What is the oldest person ever recorded", "The psychologist said that the best way to treat a woman who was raped is not to tell her that a rape didn't happen, but to help her find the courage to come forward.I'm a bit late posting this, but I wanted to get the ball rolling with this post. It's been a while since I've done a review on the product. I've heard good things about this, but I've never used it. I'm going to give it a try. First"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in mental health. How old is the world's oldest person? Oldest person ever born is Jeanne Calment, who was 122 years and 6 months old when she died. Who are the oldest people in the world? The oldest person ever born in the world was Jeanne Calment of France who died at age 122 in 1997. What is the oldest person ever recorded
[Pre-ROME]:   What is the gender of a psychologist? The Gender Questionnaire What is the gender of a psychologist? The gender of a psychologist is usually determined through the use of a questionnaire, called the Gender Questionnaire. The Gender Questionnaire asks questions about a variety of topics that relate primarily to one's gender identity. The Gender Questionnaire is available in both English and Spanish. If you are not sure how to use a questionnaire, see the Gender Questionnaire Glossary for
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to treat a woman who was raped is not to tell her that a rape didn't happen, but to help her find the courage to come forward.I'm a bit late posting this, but I wanted to get the ball rolling with this post. It's been a while since I've done a review on the product. I've heard good things about this, but I've never used it. I'm going to give it a try. First
[Pre-ROME]:   The psychologist said that the man had been diagnosed with bipolar disorder and depression. He had been prescribed anti-depressants. The man was found dead in his bedroom at the family home on Sunday morning. A post-mortem examination found the cause of death to be asphyxia.In the early 1990s, a young, talented, charismatic, and very, very rich man named Michael Milken was the most powerful man in the country. He was a brilliant and ruthless
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender of psychologist is usually male. Gender of psychologist is always male. Gender of a psychologist is never female. How do psychologists choose their name? Psychologists choose their names according to what they think of their personality. If you are a man who likes to wear women's clothes and have short hair then you can be a psychologist. If you like men's clothing and long hair and like to", 'The psychologist said that the "most significant" difference between the sexes was "that women have more empathy and men have more aggression" â€“ and he was right. The study found that the men who were most aggressive in their childhood were more likely to become serial killers. The study found that the men who were most aggressive in their childhood were more likely to become serial killers. The study also found that the men who were most aggressive in their childhood were more likely to commit acts of cruelty']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "The gender of a psychologist is not a fixed identity. It\'s a combination of a person\'s sex, age, education and professional training." What is an expert witness? "An expert witness is someone who is qualified to give evidence on a particular issue. An expert witness is a specialist with specialised knowledge in the field of the case at hand. The person\'s knowledge is based on a wide range of experience and knowledge,', "The psychologist said that she was a feminist. She was a woman and I was a woman. She was female, I was female. We were both women. And that's how I feel about the women who work in the BBC. They have to be. It's a job. They do it. They're paid for it. But, I think the BBC is a bit different. The BBC is a place that's run by women. It's an institution run by a woman."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "The gender of a psychologist is not a fixed identity. It's a combination of a person's sex, age, education and professional training." What is an expert witness? "An expert witness is someone who is qualified to give evidence on a particular issue. An expert witness is a specialist with specialised knowledge in the field of the case at hand. The person's knowledge is based on a wide range of experience and knowledge,
[Pre-ROME]:   What is the gender of a psychologist? Gender of psychologist is usually male. Gender of psychologist is always male. Gender of a psychologist is never female. How do psychologists choose their name? Psychologists choose their names according to what they think of their personality. If you are a man who likes to wear women's clothes and have short hair then you can be a psychologist. If you like men's clothing and long hair and like to
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was a feminist. She was a woman and I was a woman. She was female, I was female. We were both women. And that's how I feel about the women who work in the BBC. They have to be. It's a job. They do it. They're paid for it. But, I think the BBC is a bit different. The BBC is a place that's run by women. It's an institution run by a woman.
[Pre-ROME]:   The psychologist said that the "most significant" difference between the sexes was "that women have more empathy and men have more aggression" â€“ and he was right. The study found that the men who were most aggressive in their childhood were more likely to become serial killers. The study found that the men who were most aggressive in their childhood were more likely to become serial killers. The study also found that the men who were most aggressive in their childhood were more likely to commit acts of cruelty
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What is gender? What does it mean to be female? How do you tell if you're a man or a woman? How do we define gender? Gender is a spectrum. It doesn't mean you're either male or female. Gender isn't a binary. Gender doesn't mean that you're either gay or straight. Gender doesn't mean you can be one gender, but another. Gender is", 'The psychologist said that he had no idea whether or not the woman was a victim. The woman told police that she was raped in the bathroom at her home in the 2000 block of North Main Street. She said that she did not want to pursue criminal charges, but that she was afraid of what would happen to her family. She also said that she was afraid of the man who raped her and did not go to police. Police are looking for a black male in his']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Identity Development Service (GIDS) is a new service that aims to provide the best possible service to children and young people. The service is run by the GIDS, the Child and Adolescent Mental Health Service (CAMHS) and the Mental Health Foundation, which is an independent charity. GIDS has a gender identity development team who work in partnership with CAMHS, which has a service specifically for young people. What does', 'The psychologist said that the most effective treatment for Bipolar Disorder is to get patients to stop taking their medication. "The best way to treat someone with Bipolar is to give them as little medication as possible and to try and get them to manage their symptoms," she explained.This article is about the character. For the book, see The Last Jedi: The Unauthorized Autobiography (novel). "I know that you\'re a Jedi, Rey. You\'re the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity Development Service (GIDS) is a new service that aims to provide the best possible service to children and young people. The service is run by the GIDS, the Child and Adolescent Mental Health Service (CAMHS) and the Mental Health Foundation, which is an independent charity. GIDS has a gender identity development team who work in partnership with CAMHS, which has a service specifically for young people. What does
[Pre-ROME]:   What is the gender of a psychologist? What is gender? What does it mean to be female? How do you tell if you're a man or a woman? How do we define gender? Gender is a spectrum. It doesn't mean you're either male or female. Gender isn't a binary. Gender doesn't mean that you're either gay or straight. Gender doesn't mean you can be one gender, but another. Gender is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most effective treatment for Bipolar Disorder is to get patients to stop taking their medication. "The best way to treat someone with Bipolar is to give them as little medication as possible and to try and get them to manage their symptoms," she explained.This article is about the character. For the book, see The Last Jedi: The Unauthorized Autobiography (novel). "I know that you're a Jedi, Rey. You're the
[Pre-ROME]:   The psychologist said that he had no idea whether or not the woman was a victim. The woman told police that she was raped in the bathroom at her home in the 2000 block of North Main Street. She said that she did not want to pursue criminal charges, but that she was afraid of what would happen to her family. She also said that she was afraid of the man who raped her and did not go to police. Police are looking for a black male in his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a specialist in the field of psychology. A psychologist may work with people of any age. A psychologist is not necessarily a doctor, nor does the psychologist have to have a medical degree. A psychologist has the following qualifications: A bachelor's degree in psychology or related field Two years of postgraduate training in psychology. The training may include training in child development or other relevant areas A Master's", 'The psychologist said that the two men were not the only ones who were targeted. The group of people were also targeted by the group\'s members and the group\'s supporters, who have been seen in a number of videos threatening the victims. "The victims are not the only ones who have suffered from the group, they also have been targeted by the group and their supporters," she explained. The psychologist also said that one of the people who has been targeted by the group is a young boy who was also']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Question is one of the more challenging questions for psychologists. In the United States, psychologists are required to be either male or female, and many are reluctant to answer this question. In a 2011 survey, nearly half of the 1,600 respondents reported not being able to identify the gender of the person they work with. Why is there such a discrepancy? Many psychologists are reluctant to identify as genderqueer or gender nonbinary', 'The psychologist said that the best way to deal with someone who is in an abusive relationship, for example, was for her to be in the same room as the abuser, and that if you could get her to see you, that was a good place to start. "You want to make sure that you are not the cause of the problems in your relationship, because if you are the one who is the cause of the problems, you are going to be in that relationship for the rest of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Question is one of the more challenging questions for psychologists. In the United States, psychologists are required to be either male or female, and many are reluctant to answer this question. In a 2011 survey, nearly half of the 1,600 respondents reported not being able to identify the gender of the person they work with. Why is there such a discrepancy? Many psychologists are reluctant to identify as genderqueer or gender nonbinary
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a specialist in the field of psychology. A psychologist may work with people of any age. A psychologist is not necessarily a doctor, nor does the psychologist have to have a medical degree. A psychologist has the following qualifications: A bachelor's degree in psychology or related field Two years of postgraduate training in psychology. The training may include training in child development or other relevant areas A Master's
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to deal with someone who is in an abusive relationship, for example, was for her to be in the same room as the abuser, and that if you could get her to see you, that was a good place to start. "You want to make sure that you are not the cause of the problems in your relationship, because if you are the one who is the cause of the problems, you are going to be in that relationship for the rest of
[Pre-ROME]:   The psychologist said that the two men were not the only ones who were targeted. The group of people were also targeted by the group's members and the group's supporters, who have been seen in a number of videos threatening the victims. "The victims are not the only ones who have suffered from the group, they also have been targeted by the group and their supporters," she explained. The psychologist also said that one of the people who has been targeted by the group is a young boy who was also
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is someone who has a Ph.D., M.A., or Ph.D. in psychology. A psychologist is also a psychologist. A doctor who has a Ph.D. is a doctor of medicine. Is it possible to be a psychologist and not be a man? No. There is a difference between being a doctor and being a psychologist. Is it possible to be a psychologist who is not a man? Yes.', 'The psychologist said that he would be more inclined to give a child a "positive" diagnosis if he had a clear understanding of how the child came to have the diagnosis. He suggested that parents of children who are diagnosed with ADHD might be more likely to have a discussion with their child about what they can do to improve their behaviour and to help them learn to control their hyperactivity. "I think the parents would be very happy to hear that their child has a condition that can be']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In a recent study, we found that the gender of a psychologist was significantly associated with the type of work that the psychologist does. Specifically, we found that female psychologists were more likely to specialize in clinical psychology, and that male psychologists specialized in counseling. We also found a positive correlation between gender and the type of training a psychologist received in their first year of graduate school. This suggests that gender may play a role in which psychologists choose to specialize.\n', "The psychologist said that if you were to ask most women whether they had a 'high or low sex drive', the majority would say 'high sex drive'. But that is not how the brain works. Your brain is a'male' brain and you are a 'female' brain. The brain is the'male' part of you, not the 'female' part of you. The brain has a different structure to the other parts of your body and so it is not possible"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In a recent study, we found that the gender of a psychologist was significantly associated with the type of work that the psychologist does. Specifically, we found that female psychologists were more likely to specialize in clinical psychology, and that male psychologists specialized in counseling. We also found a positive correlation between gender and the type of training a psychologist received in their first year of graduate school. This suggests that gender may play a role in which psychologists choose to specialize.

[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who has a Ph.D., M.A., or Ph.D. in psychology. A psychologist is also a psychologist. A doctor who has a Ph.D. is a doctor of medicine. Is it possible to be a psychologist and not be a man? No. There is a difference between being a doctor and being a psychologist. Is it possible to be a psychologist who is not a man? Yes.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you were to ask most women whether they had a 'high or low sex drive', the majority would say 'high sex drive'. But that is not how the brain works. Your brain is a'male' brain and you are a 'female' brain. The brain is the'male' part of you, not the 'female' part of you. The brain has a different structure to the other parts of your body and so it is not possible
[Pre-ROME]:   The psychologist said that he would be more inclined to give a child a "positive" diagnosis if he had a clear understanding of how the child came to have the diagnosis. He suggested that parents of children who are diagnosed with ADHD might be more likely to have a discussion with their child about what they can do to improve their behaviour and to help them learn to control their hyperactivity. "I think the parents would be very happy to hear that their child has a condition that can be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed. Gender is a socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially', 'The psychologist said that he has seen people with a history of mental illness who have become successful, but that he had never seen a "successful" person with a history of mental health issues who became a successful person. He added that the research was not a definitive proof of the link between mental health problems and success, but that it was an important piece of research. "It\'s a very strong piece of evidence and it\'s very compelling," he said. "There is a link']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The term "psychologist" refers only to a psychologist. There are no psychologists who are women or who are transgender or who are married to a woman. There are no female psychologists who are also married to women. How is the gender of the psychologist reflected in the title, title, and description of the job? The title, title and description of the job are gender neutral and reflect the gender of the individual. How', 'The psychologist said that the most important thing people could do to reduce their chances of being the victims of crime is to "understand that crime isn\'t inevitable" and that "criminals don\'t choose to become criminals."This is one of the best things to happen to a movie since The Matrix. The first two trailers of Suicide Squad, directed by David Ayer, are incredible and I\'ve been waiting for this movie to arrive for weeks now. The trailer shows off a great cast']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The term "psychologist" refers only to a psychologist. There are no psychologists who are women or who are transgender or who are married to a woman. There are no female psychologists who are also married to women. How is the gender of the psychologist reflected in the title, title, and description of the job? The title, title and description of the job are gender neutral and reflect the gender of the individual. How
[Pre-ROME]:   What is the gender of a psychologist? Gender is a socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed. Gender is a socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially constructed, socially
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most important thing people could do to reduce their chances of being the victims of crime is to "understand that crime isn't inevitable" and that "criminals don't choose to become criminals."This is one of the best things to happen to a movie since The Matrix. The first two trailers of Suicide Squad, directed by David Ayer, are incredible and I've been waiting for this movie to arrive for weeks now. The trailer shows off a great cast
[Pre-ROME]:   The psychologist said that he has seen people with a history of mental illness who have become successful, but that he had never seen a "successful" person with a history of mental health issues who became a successful person. He added that the research was not a definitive proof of the link between mental health problems and success, but that it was an important piece of research. "It's a very strong piece of evidence and it's very compelling," he said. "There is a link
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a social construct based on social roles, and it's not always easy to tell the gender of someone based on their outward appearance, especially if they're in a position of authority. For example, a male psychologist might be a professor and wear a lab coat and glasses while their female colleague might be a nurse and wear a dress. What is the gender of a psychiatrist? Gender is a social construct based on social roles,", 'The psychologist said that he was "shocked" by the number of people who said they would not have been able to take part in the study had it not been for the "emotional support" they received. He told the BBC: "I was quite shocked at the numbers of people that were willing to say no to a study like this. "We are not saying that all people are like that, but there are a lot of people who are very reluctant to do this']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is a social construct that is not fixed, immutable, or biologically determined. Gender identity refers to one's sense of gender, whereas gender presentation is how a person presents themselves. The gender of a psychologist can be different from that of a doctor, nurse or lawyer. Who can be a psychologist? Anyone can be a psychologist. You may not want to be one if you are a man and you have a wife who doesn't", 'The psychologist said that the "biggest problem" in our society is the way we discuss sex. "The way that women and men are expected to behave in their personal relationships and in the workplace is totally different from the way men and women are treated in the home and the workplace," she said. "We need to have a serious look at the way that we talk about and treat women and men, not just in the workplace, in the personal sphere. "It']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construct that is not fixed, immutable, or biologically determined. Gender identity refers to one's sense of gender, whereas gender presentation is how a person presents themselves. The gender of a psychologist can be different from that of a doctor, nurse or lawyer. Who can be a psychologist? Anyone can be a psychologist. You may not want to be one if you are a man and you have a wife who doesn't
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct based on social roles, and it's not always easy to tell the gender of someone based on their outward appearance, especially if they're in a position of authority. For example, a male psychologist might be a professor and wear a lab coat and glasses while their female colleague might be a nurse and wear a dress. What is the gender of a psychiatrist? Gender is a social construct based on social roles,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "biggest problem" in our society is the way we discuss sex. "The way that women and men are expected to behave in their personal relationships and in the workplace is totally different from the way men and women are treated in the home and the workplace," she said. "We need to have a serious look at the way that we talk about and treat women and men, not just in the workplace, in the personal sphere. "It
[Pre-ROME]:   The psychologist said that he was "shocked" by the number of people who said they would not have been able to take part in the study had it not been for the "emotional support" they received. He told the BBC: "I was quite shocked at the numbers of people that were willing to say no to a study like this. "We are not saying that all people are like that, but there are a lot of people who are very reluctant to do this
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who has received a Doctor of Psychology (D.P.) or Doctor of Clinical Psychology (D.C.P.). How many psychologists do you have? We currently have over 200 members.This is a very old entry â€” images are small, formatting is off. Bizarro Reviewed Nov. 21, 2009 by Armin Industry / Entertainment The first two seasons of Cartoon Network's", "The psychologist said that he had been told that he was the first person in the world to be given a diagnosis of autism and that his mother had been so upset that she had taken the decision to remove him from her home. He said that when he told the school he wanted to take his own life, he felt that he had been treated as an outsider, adding: 'I was a nobody.' Mr Hutton, a former teacher, was diagnosed with Asperger syndrome when"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is usually a woman. What is a psychologist's gender? A psychologist's gender is usually a woman. What is the gender of a psychologist? A psychologist's gender is usually a man. What is a psychiatrist's gender? The gender of a psychiatrist is usually a man. What is an orthopedic physician's gender? The gender of an", 'The psychologist said that the best way for a woman to increase the chances of having a baby is to avoid having children at all costs. "We\'re not going to have children unless we\'re in a situation where we want a child. We want to do the best we can for the child and make the best possible life for the child," Professor Buss said.The U.S. government is preparing to release the full transcript of a closed-door hearing of a Senate committee investigating']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually a woman. What is a psychologist's gender? A psychologist's gender is usually a woman. What is the gender of a psychologist? A psychologist's gender is usually a man. What is a psychiatrist's gender? The gender of a psychiatrist is usually a man. What is an orthopedic physician's gender? The gender of an
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who has received a Doctor of Psychology (D.P.) or Doctor of Clinical Psychology (D.C.P.). How many psychologists do you have? We currently have over 200 members.This is a very old entry â€” images are small, formatting is off. Bizarro Reviewed Nov. 21, 2009 by Armin Industry / Entertainment The first two seasons of Cartoon Network's
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way for a woman to increase the chances of having a baby is to avoid having children at all costs. "We're not going to have children unless we're in a situation where we want a child. We want to do the best we can for the child and make the best possible life for the child," Professor Buss said.The U.S. government is preparing to release the full transcript of a closed-door hearing of a Senate committee investigating
[Pre-ROME]:   The psychologist said that he had been told that he was the first person in the world to be given a diagnosis of autism and that his mother had been so upset that she had taken the decision to remove him from her home. He said that when he told the school he wanted to take his own life, he felt that he had been treated as an outsider, adding: 'I was a nobody.' Mr Hutton, a former teacher, was diagnosed with Asperger syndrome when
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of psychologists can also be determined by the type of degree obtained. A PhD (Doctorate of Philosophy) is the most common type of degree obtained, and the most common degree is the Doctor of Psychology (D.P.). PhDs are usually the highest degree obtained, with a PhD being the equivalent of a doctorate in any other field of study, such as medicine or law. How many psychologists are there? The', 'The psychologist said that he had been asked to give the same treatment to a group of people who have been diagnosed with schizophrenia. "It has not been a good experience at all," he said.I\'ve been thinking about this for awhile now, and I\'ve come up with some ideas. I don\'t have the resources to put this together right now, but I think it could be a good idea to start this off with a small group of people. I\'d like to get this']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist\'s gender is usually stated on their professional profile, and is often indicated on their website as well. However, some psychologists choose to state their gender in a different way. For example, if a psychologist\'s gender is "M" or "F", then that means that the psychologist is either male or female. However, if the psychologist\'s gender is "G", then it means they are transgender. The term "gender', "The psychologist said that the best thing you can do for yourself is to stop worrying and get on with your life. 'You are not going to be perfect and life is going to be unfair, but if you can just get on with your life and stop trying so hard to be perfect, then you'll be a lot happier.' The research also suggests that people who are happier in everyday life also have better relationships, which are often a key part of happiness. Professor Susan Forward,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is usually stated on their professional profile, and is often indicated on their website as well. However, some psychologists choose to state their gender in a different way. For example, if a psychologist's gender is "M" or "F", then that means that the psychologist is either male or female. However, if the psychologist's gender is "G", then it means they are transgender. The term "gender
[Pre-ROME]:   What is the gender of a psychologist? The gender of psychologists can also be determined by the type of degree obtained. A PhD (Doctorate of Philosophy) is the most common type of degree obtained, and the most common degree is the Doctor of Psychology (D.P.). PhDs are usually the highest degree obtained, with a PhD being the equivalent of a doctorate in any other field of study, such as medicine or law. How many psychologists are there? The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best thing you can do for yourself is to stop worrying and get on with your life. 'You are not going to be perfect and life is going to be unfair, but if you can just get on with your life and stop trying so hard to be perfect, then you'll be a lot happier.' The research also suggests that people who are happier in everyday life also have better relationships, which are often a key part of happiness. Professor Susan Forward,
[Pre-ROME]:   The psychologist said that he had been asked to give the same treatment to a group of people who have been diagnosed with schizophrenia. "It has not been a good experience at all," he said.I've been thinking about this for awhile now, and I've come up with some ideas. I don't have the resources to put this together right now, but I think it could be a good idea to start this off with a small group of people. I'd like to get this
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a doctor with a PhD in psychology. They are typically male, though they do not always have to be. What is the gender of a psychiatrist? A psychiatrist is a doctor with a PhD in psychiatry. They are typically female, though they do not always have to be. What is the gender of a psychiatrist-gynecologist? A psychiatrist-gynecologist (also known as a gy', 'The psychologist said that the two men were not aware that the video they were watching could be recorded and used against them. He said: "I don\'t know what they thought they were doing but they were doing something that was not right." He added: "I think the police were quite shocked. They were shocked because it wasn\'t what they thought they were going to see." The video shows a man in a hooded top and a black hoodie standing in a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? \nAnswer: \nPsychologist is a job title and a profession. The gender of a psychologist does not matter to employers. The job is a professional one, not a gender-related one. The term psychologist is a generic term and is used to describe all professionals in the field of psychology. The gender of a psychologist is irrelevant to the job. \nQ. I am a male and I have been asked by a female colleague whether I have', "The psychologist said that if a woman is having a baby, she is far less likely to be raped than a man, even if she's wearing a burka or burkini. She said that women have the same rights as men, and it is only in recent years that the debate about whether women should have the right to have an abortion has gained momentum. In a survey of 1,000 Muslim women in Britain by ICM for the Guardian last year, nearly half of respondents said"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
Answer: 
Psychologist is a job title and a profession. The gender of a psychologist does not matter to employers. The job is a professional one, not a gender-related one. The term psychologist is a generic term and is used to describe all professionals in the field of psychology. The gender of a psychologist is irrelevant to the job. 
Q. I am a male and I have been asked by a female colleague whether I have
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor with a PhD in psychology. They are typically male, though they do not always have to be. What is the gender of a psychiatrist? A psychiatrist is a doctor with a PhD in psychiatry. They are typically female, though they do not always have to be. What is the gender of a psychiatrist-gynecologist? A psychiatrist-gynecologist (also known as a gy
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a woman is having a baby, she is far less likely to be raped than a man, even if she's wearing a burka or burkini. She said that women have the same rights as men, and it is only in recent years that the debate about whether women should have the right to have an abortion has gained momentum. In a survey of 1,000 Muslim women in Britain by ICM for the Guardian last year, nearly half of respondents said
[Pre-ROME]:   The psychologist said that the two men were not aware that the video they were watching could be recorded and used against them. He said: "I don't know what they thought they were doing but they were doing something that was not right." He added: "I think the police were quite shocked. They were shocked because it wasn't what they thought they were going to see." The video shows a man in a hooded top and a black hoodie standing in a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a psychologist who is not male or female. What does a psychoanalyst look like? A psychoanalyst looks like a person who is not female. What does a psychotherapist look like? A psychotherapist looks like a person who is not male. What do a social worker and a psychiatrist look like? Social workers and psychiatrists look like persons who are not male', "The psychologist said that she was'very surprised by the results' and said that 'the fact that they found a difference between the two groups was a real surprise.' Dr Glynn said: 'I was very surprised by the results because I have been looking at this for many years now and there has never been any difference between the two groups.' The psychologist said that she was'very surprised by the results' and said that 'the fact that they found a difference between the two"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a psychologist who specializes in the study of psychology. Gender The gender of a person is usually determined at birth based on a combination of their biological characteristics and their parents' expectations for the gender they will be raised as. Gender identity The gender someone identifies with, or is considered to be, is usually different from the biological sex they were assigned at birth. Gender dysphoria Gender dysph", 'The psychologist said that the reason why women were underrepresented in science is because there were fewer women in senior positions. The gender pay gap is the result of "a combination of discrimination and occupational choice", she explained. The gender gap in science is also a result of the way that people are encouraged to behave in the classroom. "In the classroom we are encouraged to behave more like boys. "We are encouraged to talk a lot and to be more assertive']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a psychologist who specializes in the study of psychology. Gender The gender of a person is usually determined at birth based on a combination of their biological characteristics and their parents' expectations for the gender they will be raised as. Gender identity The gender someone identifies with, or is considered to be, is usually different from the biological sex they were assigned at birth. Gender dysphoria Gender dysph
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist who is not male or female. What does a psychoanalyst look like? A psychoanalyst looks like a person who is not female. What does a psychotherapist look like? A psychotherapist looks like a person who is not male. What do a social worker and a psychiatrist look like? Social workers and psychiatrists look like persons who are not male
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason why women were underrepresented in science is because there were fewer women in senior positions. The gender pay gap is the result of "a combination of discrimination and occupational choice", she explained. The gender gap in science is also a result of the way that people are encouraged to behave in the classroom. "In the classroom we are encouraged to behave more like boys. "We are encouraged to talk a lot and to be more assertive
[Pre-ROME]:   The psychologist said that she was'very surprised by the results' and said that 'the fact that they found a difference between the two groups was a real surprise.' Dr Glynn said: 'I was very surprised by the results because I have been looking at this for many years now and there has never been any difference between the two groups.' The psychologist said that she was'very surprised by the results' and said that 'the fact that they found a difference between the two
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychology has a very long tradition of being male-dominated. In the United States, women make up just under half of the psychology faculty. The gender of a doctor is determined on the basis of their medical degree. A doctor's gender does not necessarily determine what field they will work in. A psychologist who works in a medical field may be a female, but they may also be a male or a male who is", 'The psychologist said that while the two were not in the room, it was obvious they were in a room together. "I\'m not sure what was going through the minds of both of them. I don\'t think either of them had any idea what was going on. I can only imagine that they thought, \'What\'s the point in this?\' " In a statement on Wednesday, the family said it was not clear whether either of the men was aware of the camera. "Our family']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How many genders is she? What are the gender roles of a psychologist? What are the different gender stereotypes of a psychologist? What are the gender stereotypes of psychologists? What are the gender roles of psychologists? A: Gender is not a fixed characteristic but a spectrum. There are many genders, and each gender has its own specific roles, responsibilities and characteristics. Gender roles are not set in stone; they can be fluid. Gender role stereotypes are', "The psychologist said that if you ask a woman what her problem is, the answer she gives you is usually 'I'm not a good wife'. 'If you're married and having a baby you don't need to ask your wife what her problem is. It doesn't matter if you're a woman or a man.' The psychologist also said that women are less likely to take responsibility for their actions. She said: 'Women tend to blame others for a lot of things"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How many genders is she? What are the gender roles of a psychologist? What are the different gender stereotypes of a psychologist? What are the gender stereotypes of psychologists? What are the gender roles of psychologists? A: Gender is not a fixed characteristic but a spectrum. There are many genders, and each gender has its own specific roles, responsibilities and characteristics. Gender roles are not set in stone; they can be fluid. Gender role stereotypes are
[Pre-ROME]:   What is the gender of a psychologist? Psychology has a very long tradition of being male-dominated. In the United States, women make up just under half of the psychology faculty. The gender of a doctor is determined on the basis of their medical degree. A doctor's gender does not necessarily determine what field they will work in. A psychologist who works in a medical field may be a female, but they may also be a male or a male who is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you ask a woman what her problem is, the answer she gives you is usually 'I'm not a good wife'. 'If you're married and having a baby you don't need to ask your wife what her problem is. It doesn't matter if you're a woman or a man.' The psychologist also said that women are less likely to take responsibility for their actions. She said: 'Women tend to blame others for a lot of things
[Pre-ROME]:   The psychologist said that while the two were not in the room, it was obvious they were in a room together. "I'm not sure what was going through the minds of both of them. I don't think either of them had any idea what was going on. I can only imagine that they thought, 'What's the point in this?' " In a statement on Wednesday, the family said it was not clear whether either of the men was aware of the camera. "Our family
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? \nA psychologist is a psychologist who specializes in the study and treatment of mental illness. A psychologist may have a doctorate degree, a master's degree, or a doctor of osteopathic medicine degree. A psychologist who specializes in the field of psychology is called a mental health professional. What is the difference between a psychologist and a mental health professional? A psychologist may be licensed by a state to diagnose, treat and prescribe mental health care.", 'The psychologist said that the "vast majority" of the children who have been diagnosed with autism are not being misdiagnosed because of a lack of awareness. "I think it is because we are not aware of the difference between autism and autism spectrum disorder, and that we do not have a good way of understanding the spectrum of autism and how it is different in each child," she said. She believes that a lack of understanding is also due to a "cultural bias", with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In the UK the term 'psychologist' is used for a gender specialist. The gender specialist is someone who has a special qualification in the areas of human behaviour and development, and who specialises in working with children, adolescents and adults. How do you choose your job? Your first job should be something you enjoy. It is important to get your feet wet, and it is important to be able to show potential employers that you", 'The psychologist said that the way we talk about sex is changing and that it was time to start changing how we think about relationships. She said that men and women have very different relationships to sex, with about half the population saying that they feel comfortable talking about sex at all. "The way people talk about sex has changed a lot in the last 50 years. People used to think that men are just interested in having a good time. Now, they think that men want sex, but they']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the UK the term 'psychologist' is used for a gender specialist. The gender specialist is someone who has a special qualification in the areas of human behaviour and development, and who specialises in working with children, adolescents and adults. How do you choose your job? Your first job should be something you enjoy. It is important to get your feet wet, and it is important to be able to show potential employers that you
[Pre-ROME]:   What is the gender of a psychologist? 
A psychologist is a psychologist who specializes in the study and treatment of mental illness. A psychologist may have a doctorate degree, a master's degree, or a doctor of osteopathic medicine degree. A psychologist who specializes in the field of psychology is called a mental health professional. What is the difference between a psychologist and a mental health professional? A psychologist may be licensed by a state to diagnose, treat and prescribe mental health care.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way we talk about sex is changing and that it was time to start changing how we think about relationships. She said that men and women have very different relationships to sex, with about half the population saying that they feel comfortable talking about sex at all. "The way people talk about sex has changed a lot in the last 50 years. People used to think that men are just interested in having a good time. Now, they think that men want sex, but they
[Pre-ROME]:   The psychologist said that the "vast majority" of the children who have been diagnosed with autism are not being misdiagnosed because of a lack of awareness. "I think it is because we are not aware of the difference between autism and autism spectrum disorder, and that we do not have a good way of understanding the spectrum of autism and how it is different in each child," she said. She believes that a lack of understanding is also due to a "cultural bias", with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specializes in the mental health and behavior of children, adolescents, and adults. The term "psychologist" refers to the field of psychology and not to the profession. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in mental health, including the treatment of psychological and psychiatric illnesses. The term "psychiatrist" refers to a physician who specializes in mental health, not to', 'The psychologist said that the "psychological effect of the war on drugs is that people who are using drugs are not being helped. We are not getting people off drugs. They are just getting more and more of them." In the interview, Dr. Sussan Ley also discussed the "War on Terror" and how the government is "trying to create a new kind of terrorism, a kind of terrorism of fear and control." "The government is trying to create the terror']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually a man. However, there are some psychologists who are transgender, and they may be called female. What is the gender of a lawyer? A lawyer is usually called female. A lawyer who identifies as male or female may also be called male or female. What is the gender of a teacher? A teacher is usually male. However, a person who identifies as a woman,', "The psychologist said that the way people talk to one another can reveal more about their personalities than their appearance. She told the BBC: 'We have this idea that people are born with a certain personality. 'But the truth is we are all made up of a lot more than just our biology, so it's important we think about how we talk to one another. 'It's a good way of getting to know someone better. It's not something that's necessarily obvious"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually a man. However, there are some psychologists who are transgender, and they may be called female. What is the gender of a lawyer? A lawyer is usually called female. A lawyer who identifies as male or female may also be called male or female. What is the gender of a teacher? A teacher is usually male. However, a person who identifies as a woman,
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in the mental health and behavior of children, adolescents, and adults. The term "psychologist" refers to the field of psychology and not to the profession. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in mental health, including the treatment of psychological and psychiatric illnesses. The term "psychiatrist" refers to a physician who specializes in mental health, not to
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way people talk to one another can reveal more about their personalities than their appearance. She told the BBC: 'We have this idea that people are born with a certain personality. 'But the truth is we are all made up of a lot more than just our biology, so it's important we think about how we talk to one another. 'It's a good way of getting to know someone better. It's not something that's necessarily obvious
[Pre-ROME]:   The psychologist said that the "psychological effect of the war on drugs is that people who are using drugs are not being helped. We are not getting people off drugs. They are just getting more and more of them." In the interview, Dr. Sussan Ley also discussed the "War on Terror" and how the government is "trying to create a new kind of terrorism, a kind of terrorism of fear and control." "The government is trying to create the terror
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How can I find a psychologist? Gender is the most important characteristic that you should be aware of when searching for a psychologist in your area. It is important for the psychologist to know the gender of the client. This is important for many reasons. For example, it can help the psychologist to better understand the client and help the psychologist to make a more personalized treatment plan. It is also helpful when the client is not able to answer the question', "The psychologist said that the woman was a good mother and she would be devastated if she were to lose her daughter. He said: 'It is not a case of a child who has been taken away from the parents by a stranger. The mother is a good mother who would be devastated if she lost her child.' A man who was with the woman was taken to a local hospital to be treated for his injuries. The incident comes a week after a man in the same"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is someone who specializes in psychology, who studies human behavior, who works with people to help them improve their lives or to help them understand themselves and the world. Gender is an important aspect of the person's job. For example, if you are a psychologist you will have to work with people in different ways. If you work with men, you will have to help men. If you work with women, you will have to help", "The psychologist said that the reason why people don't have a sex drive is because they don't have enough of a sex drive. She said it doesn't matter what your sex drives are, if you don't get enough sexual stimulation you will not have an urge to have sex. Dr. Helen Smith is the author of The Female Brain, and she also said that women's brains don't work the same way that men's brains do. She said that men are wired to be more aggressive"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in psychology, who studies human behavior, who works with people to help them improve their lives or to help them understand themselves and the world. Gender is an important aspect of the person's job. For example, if you are a psychologist you will have to work with people in different ways. If you work with men, you will have to help men. If you work with women, you will have to help
[Pre-ROME]:   What is the gender of a psychologist? How can I find a psychologist? Gender is the most important characteristic that you should be aware of when searching for a psychologist in your area. It is important for the psychologist to know the gender of the client. This is important for many reasons. For example, it can help the psychologist to better understand the client and help the psychologist to make a more personalized treatment plan. It is also helpful when the client is not able to answer the question
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason why people don't have a sex drive is because they don't have enough of a sex drive. She said it doesn't matter what your sex drives are, if you don't get enough sexual stimulation you will not have an urge to have sex. Dr. Helen Smith is the author of The Female Brain, and she also said that women's brains don't work the same way that men's brains do. She said that men are wired to be more aggressive
[Pre-ROME]:   The psychologist said that the woman was a good mother and she would be devastated if she were to lose her daughter. He said: 'It is not a case of a child who has been taken away from the parents by a stranger. The mother is a good mother who would be devastated if she lost her child.' A man who was with the woman was taken to a local hospital to be treated for his injuries. The incident comes a week after a man in the same
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of the psychologist is a person who works in a psychological or mental health profession. It can be a man, woman or transgender. Gender identity is a term used in psychology to define the gender someone identifies themselves as. Gender is a social construct that is not biological. It is the way we perceive ourselves and is a part of our identity. Gender identity can vary between men, women and transgender people. Some gender identities are', 'The psychologist said that in some cases, children were given a "blanket" to wear and were asked to sit in the same place for the entire visit. "They had to sit in a certain position and they couldn\'t move," said Dr. Haddad. "And then they were asked, \'Do you want to talk about anything? What did you like? What did you not like?\'" Dr. Haddad said that the study showed that children were more willing to talk']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a woman or a man. How do I become a psychologist? You don't need to be a psychologist to get into a graduate program in psychology, but it helps to have a Ph.D. or other advanced degree. Do psychologists get paid? Psychologists receive a modest salary that averages $70,000 to $80,000 a year. What kind of work is done in", 'The psychologist said that when she was a child, her parents taught her that a girl is a girl no matter what she looks like and a woman is a woman no matter what she weighs. But that\'s not always true. "A child doesn\'t know this, and it doesn\'t come up in conversation, and it\'s not something that you can put a label on," says Cara. "So when we talk about \'trauma\', I think of it as a way of describing that kind']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a woman or a man. How do I become a psychologist? You don't need to be a psychologist to get into a graduate program in psychology, but it helps to have a Ph.D. or other advanced degree. Do psychologists get paid? Psychologists receive a modest salary that averages $70,000 to $80,000 a year. What kind of work is done in
[Pre-ROME]:   What is the gender of a psychologist? The gender of the psychologist is a person who works in a psychological or mental health profession. It can be a man, woman or transgender. Gender identity is a term used in psychology to define the gender someone identifies themselves as. Gender is a social construct that is not biological. It is the way we perceive ourselves and is a part of our identity. Gender identity can vary between men, women and transgender people. Some gender identities are
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when she was a child, her parents taught her that a girl is a girl no matter what she looks like and a woman is a woman no matter what she weighs. But that's not always true. "A child doesn't know this, and it doesn't come up in conversation, and it's not something that you can put a label on," says Cara. "So when we talk about 'trauma', I think of it as a way of describing that kind
[Pre-ROME]:   The psychologist said that in some cases, children were given a "blanket" to wear and were asked to sit in the same place for the entire visit. "They had to sit in a certain position and they couldn't move," said Dr. Haddad. "And then they were asked, 'Do you want to talk about anything? What did you like? What did you not like?'" Dr. Haddad said that the study showed that children were more willing to talk
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is typically the same as the gender of their patient. Is a psychologist required to have a doctoral degree? No. The American Psychological Association (APA) requires that all members must have a bachelor's degree and at least one year of experience in a psychology research or clinical practice setting. This is in addition to the training and experience required of all members of the profession. Can a psychologist be a", 'The psychologist said that while the study was not designed to assess the effectiveness of the program, she believes it could help reduce the number of people in her practice who are dealing with addiction. "If we\'re able to get them into treatment, they\'re much more likely going to be successful and they\'ll have less of a need to get on the street," she said. "And they can get on the street with less stigma." The study was funded by the U.S.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is usually a woman. Why are psychologists women? A psychologist has a lot in common with a lawyer. Both are women who study and practice psychology. The profession is also known as a "women\'s field," and it is the second largest female-led field in the United States (after medicine). In addition to being a women\'s occupation, psychology is known for being more socially acceptable, as it does not involve a', "The psychologist said that the best thing you can do in the current environment of political polarization is to try to understand what your opponent thinks, so you can understand what you think. The best way to do that, she suggested, is by talking to people who disagree with you, and by reading books and articles by people who disagree with you. I'm not sure how much of this is actually helpful for a political campaign, but it is helpful for the rest of us. And it"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is usually a woman. Why are psychologists women? A psychologist has a lot in common with a lawyer. Both are women who study and practice psychology. The profession is also known as a "women's field," and it is the second largest female-led field in the United States (after medicine). In addition to being a women's occupation, psychology is known for being more socially acceptable, as it does not involve a
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically the same as the gender of their patient. Is a psychologist required to have a doctoral degree? No. The American Psychological Association (APA) requires that all members must have a bachelor's degree and at least one year of experience in a psychology research or clinical practice setting. This is in addition to the training and experience required of all members of the profession. Can a psychologist be a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best thing you can do in the current environment of political polarization is to try to understand what your opponent thinks, so you can understand what you think. The best way to do that, she suggested, is by talking to people who disagree with you, and by reading books and articles by people who disagree with you. I'm not sure how much of this is actually helpful for a political campaign, but it is helpful for the rest of us. And it
[Pre-ROME]:   The psychologist said that while the study was not designed to assess the effectiveness of the program, she believes it could help reduce the number of people in her practice who are dealing with addiction. "If we're able to get them into treatment, they're much more likely going to be successful and they'll have less of a need to get on the street," she said. "And they can get on the street with less stigma." The study was funded by the U.S.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who is trained to treat the mental, social, emotional and behavioral problems of individuals, and to provide treatment for mental and emotional disorders that are associated with the person's gender identity or expression. How is gender identity defined? Gender identity is the internal sense of one's gender and the corresponding behavior and identity. Gender expression refers to behaviors, dress, appearance and other aspects of the self, and refers to one", 'The psychologist said that while it was not clear how many of those who have taken part in the study have become pregnant as a result of having sex, he did not think there was any reason why they should not. "I don\'t think that there\'s any reason that this should not work," he said. "There could be a few people who are having a little bit of trouble, but the vast majority of people are going to get it right." The researchers are now carrying']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist is the gender of the person who has been designated by a state board as having the authority to perform the professional duties of a psychologist in that state and to supervise the practice of psychology within that jurisdiction. How is the gender of a psychologist determined? A: The gender of a psychologist is determined by a state licensing board or state board of education, or, if a person is a member of', 'The psychologist said that she has a "very hard time understanding how a man can be attracted to other men and still be a woman" and that "women are far better than men at understanding and accepting their own feelings". \nThe Guardian\'s columnist Caroline Criado-Perez said that while she has never been sexually harassed, "I have had colleagues who have been sexually harassed and have had to report it. It has been very upsetting for them. \n"The thing I find']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist is the gender of the person who has been designated by a state board as having the authority to perform the professional duties of a psychologist in that state and to supervise the practice of psychology within that jurisdiction. How is the gender of a psychologist determined? A: The gender of a psychologist is determined by a state licensing board or state board of education, or, if a person is a member of
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained to treat the mental, social, emotional and behavioral problems of individuals, and to provide treatment for mental and emotional disorders that are associated with the person's gender identity or expression. How is gender identity defined? Gender identity is the internal sense of one's gender and the corresponding behavior and identity. Gender expression refers to behaviors, dress, appearance and other aspects of the self, and refers to one
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she has a "very hard time understanding how a man can be attracted to other men and still be a woman" and that "women are far better than men at understanding and accepting their own feelings". 
The Guardian's columnist Caroline Criado-Perez said that while she has never been sexually harassed, "I have had colleagues who have been sexually harassed and have had to report it. It has been very upsetting for them. 
"The thing I find
[Pre-ROME]:   The psychologist said that while it was not clear how many of those who have taken part in the study have become pregnant as a result of having sex, he did not think there was any reason why they should not. "I don't think that there's any reason that this should not work," he said. "There could be a few people who are having a little bit of trouble, but the vast majority of people are going to get it right." The researchers are now carrying
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a social construct and not an innate biological characteristic. Gender is not a binary, but a spectrum. Gender Identity is the self-identification of a person as a man, woman or a transgender person. Gender Identity does not always match up with a person's sex assigned at birth, but it is an indicator of the gender someone identifies as. Gender Expression is an individual's expression of their gender, including their clothing,", 'The psychologist said that the "most important" thing was the patient\'s desire for change and that the most common reasons for not seeking medical attention were that the patient was afraid, that they didn\'t have enough money or that they were not in a situation where they could get help. "The patient should always ask the doctor if there\'s anything they can do to help," said Dr. Korn. "If there is something that the doctor can do, the doctor should help." Advertisement\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a doctor of psychology. What is the gender of an engineer? Engineers are engineers. Engineers are men. What is the gender of a doctor of medicine? Doctors of medicine are physicians. Physicians are men. What is the gender of a psychiatrist? Psychiatrists are psychiatrists, and psychiatrists are men. What is the gender of a psychologist? A psychiatrist is', 'The psychologist said that when people think of women as "weak" they are often thinking of women as emotional. "Women tend to be more emotional than men and so when we look at the way that men and women think we\'re biased," Dr Smith said. "We tend to think that women are more emotional than men and that makes us more likely to help women when they are in distress, whereas men tend to help women when men are in distress. "So,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor of psychology. What is the gender of an engineer? Engineers are engineers. Engineers are men. What is the gender of a doctor of medicine? Doctors of medicine are physicians. Physicians are men. What is the gender of a psychiatrist? Psychiatrists are psychiatrists, and psychiatrists are men. What is the gender of a psychologist? A psychiatrist is
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct and not an innate biological characteristic. Gender is not a binary, but a spectrum. Gender Identity is the self-identification of a person as a man, woman or a transgender person. Gender Identity does not always match up with a person's sex assigned at birth, but it is an indicator of the gender someone identifies as. Gender Expression is an individual's expression of their gender, including their clothing,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when people think of women as "weak" they are often thinking of women as emotional. "Women tend to be more emotional than men and so when we look at the way that men and women think we're biased," Dr Smith said. "We tend to think that women are more emotional than men and that makes us more likely to help women when they are in distress, whereas men tend to help women when men are in distress. "So,
[Pre-ROME]:   The psychologist said that the "most important" thing was the patient's desire for change and that the most common reasons for not seeking medical attention were that the patient was afraid, that they didn't have enough money or that they were not in a situation where they could get help. "The patient should always ask the doctor if there's anything they can do to help," said Dr. Korn. "If there is something that the doctor can do, the doctor should help." Advertisement

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is determined at the time of the application process. Who can become a psychologist? You must be at least 18 years of age to become a psychologist. What is required to apply to become a psychologist? A person who is a U.S. citizen, permanent resident, or eligible for citizenship must complete and submit the online application. If you are an eligible immigrant, you must', 'The psychologist said that the man had been "taken in by the family" and had been "treated like a member of their family." "The family has taken the child in and he has been living with them for some time, they have taken him to the doctor, to school, to the hospital and to other places and he has been treated like a member of their family," he said. According to Dr. Khatun, "the family has been very helpful to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What are the differences between a psychologist and a physician? The American Psychological Association (APA) is the largest scientific and professional organization representing psychology in the United States and is the world's largest association of psychologists. APA's membership includes nearly 150,000 researchers, educators, clinicians, consultants and students. Through its divisions in 54 subfields of psychology and affiliations with 60 state, territorial and Canadian provincial associations, APA works to advance the creation", 'The psychologist said that women\'s brains were wired differently to men\'s, making it harder for them to empathize with other people\'s feelings and experiences. "Men and women process emotions in completely different ways," Buss said. "It\'s one reason why men are more competitive and women are more nurturing. It may be that women\'s evolved psychology makes it more difficult for them to understand the feelings and experiences of other people."The new "Star Wars" movie has a lot of things']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What are the differences between a psychologist and a physician? The American Psychological Association (APA) is the largest scientific and professional organization representing psychology in the United States and is the world's largest association of psychologists. APA's membership includes nearly 150,000 researchers, educators, clinicians, consultants and students. Through its divisions in 54 subfields of psychology and affiliations with 60 state, territorial and Canadian provincial associations, APA works to advance the creation
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined at the time of the application process. Who can become a psychologist? You must be at least 18 years of age to become a psychologist. What is required to apply to become a psychologist? A person who is a U.S. citizen, permanent resident, or eligible for citizenship must complete and submit the online application. If you are an eligible immigrant, you must
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women's brains were wired differently to men's, making it harder for them to empathize with other people's feelings and experiences. "Men and women process emotions in completely different ways," Buss said. "It's one reason why men are more competitive and women are more nurturing. It may be that women's evolved psychology makes it more difficult for them to understand the feelings and experiences of other people."The new "Star Wars" movie has a lot of things
[Pre-ROME]:   The psychologist said that the man had been "taken in by the family" and had been "treated like a member of their family." "The family has taken the child in and he has been living with them for some time, they have taken him to the doctor, to school, to the hospital and to other places and he has been treated like a member of their family," he said. According to Dr. Khatun, "the family has been very helpful to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In most states, a psychologist is a licensed professional who is either a psychologist, a social worker, a psychiatrist or a medical doctor. A psychologist may be a male or female, but is not required to be a man or woman. In most states, a psychologist is a licensed professional who is either a psychologist, a social worker, a psychiatrist or a medical doctor. A psychologist may be a male or female, but is not required to', 'The psychologist said that she had not seen a single case of a woman with a severe mental illness who killed her husband, or a man who killed his wife, and that there was no reason to believe that this was a phenomenon that was unique to women. The psychiatrist also said that there was no evidence that the murders had been committed by the victims themselves as part of a plot. Dr. Gail Heriot, a psychiatrist who has been a consultant on television programmes about the mental health of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a professional who specializes in working with individuals who have mental health or emotional problems. The term is sometimes used as a synonym for "psychologist." A psychologist may have a Ph.D. degree and be an associate or full professor in a college or university. The term may also be applied to a mental health counselor, social worker or marriage and family therapist. The gender of the psychologist is important because it affects the professional', 'The psychologist said that women who suffer from a "low self-esteem" are more likely to be in relationships with men who aren\'t as confident in themselves. Dr. Carol Dweck has been studying how the mind and body work together to form a sense of confidence. She believes that self-esteem is not something you achieve but is instead something that is nurtured. "It\'s not something that you\'re born with, but something that develops," she told me.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a professional who specializes in working with individuals who have mental health or emotional problems. The term is sometimes used as a synonym for "psychologist." A psychologist may have a Ph.D. degree and be an associate or full professor in a college or university. The term may also be applied to a mental health counselor, social worker or marriage and family therapist. The gender of the psychologist is important because it affects the professional
[Pre-ROME]:   What is the gender of a psychologist? In most states, a psychologist is a licensed professional who is either a psychologist, a social worker, a psychiatrist or a medical doctor. A psychologist may be a male or female, but is not required to be a man or woman. In most states, a psychologist is a licensed professional who is either a psychologist, a social worker, a psychiatrist or a medical doctor. A psychologist may be a male or female, but is not required to
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women who suffer from a "low self-esteem" are more likely to be in relationships with men who aren't as confident in themselves. Dr. Carol Dweck has been studying how the mind and body work together to form a sense of confidence. She believes that self-esteem is not something you achieve but is instead something that is nurtured. "It's not something that you're born with, but something that develops," she told me.

[Pre-ROME]:   The psychologist said that she had not seen a single case of a woman with a severe mental illness who killed her husband, or a man who killed his wife, and that there was no reason to believe that this was a phenomenon that was unique to women. The psychiatrist also said that there was no evidence that the murders had been committed by the victims themselves as part of a plot. Dr. Gail Heriot, a psychiatrist who has been a consultant on television programmes about the mental health of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist depends on the type of work they do, the discipline they work in, the institution they work in, the country they live in, and the age group they work with. Gender of psychologists is also affected by where the person was born and how they were brought up. What is the age of the youngest psychologists in the world? The youngest psychologists in the world were born in the early 20th', 'The psychologist said that while he was aware of the "sensitivity" of the situation, he was "very surprised" that it had been used as a way to attack the Labour leader. "The whole idea that it\'s a political attack, or that he is being attacked for something he has not done, I think is a bit of a red herring," he said. "The idea is that he is not a leader of the opposition. "I think it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually male. The American Psychological Association, in a resolution adopted in 2001, states that "psychologists are predominantly female." What does a psychologist do? A psychologist provides professional services for people in the field, including clinical psychology, clinical psychology education, clinical supervision, counseling, and supervision in clinical settings. A psychologist\'s work may be clinical, research-oriented, or applied, depending on their area of', 'The psychologist said that women\'s behaviour can be influenced by a number of things: their biology, their upbringing, their social environment, and the way they\'re raised. She said: "Women are socialised from an early age to be more cautious. "So it\'s not that they don\'t want to have sex, it\'s that they don\'t want to make a big deal out of it and to make a fuss about it. "And if they do make a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually male. The American Psychological Association, in a resolution adopted in 2001, states that "psychologists are predominantly female." What does a psychologist do? A psychologist provides professional services for people in the field, including clinical psychology, clinical psychology education, clinical supervision, counseling, and supervision in clinical settings. A psychologist's work may be clinical, research-oriented, or applied, depending on their area of
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist depends on the type of work they do, the discipline they work in, the institution they work in, the country they live in, and the age group they work with. Gender of psychologists is also affected by where the person was born and how they were brought up. What is the age of the youngest psychologists in the world? The youngest psychologists in the world were born in the early 20th
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women's behaviour can be influenced by a number of things: their biology, their upbringing, their social environment, and the way they're raised. She said: "Women are socialised from an early age to be more cautious. "So it's not that they don't want to have sex, it's that they don't want to make a big deal out of it and to make a fuss about it. "And if they do make a
[Pre-ROME]:   The psychologist said that while he was aware of the "sensitivity" of the situation, he was "very surprised" that it had been used as a way to attack the Labour leader. "The whole idea that it's a political attack, or that he is being attacked for something he has not done, I think is a bit of a red herring," he said. "The idea is that he is not a leader of the opposition. "I think it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is typically male. However, the gender of a psychologist can vary from person to person, depending on the institution and discipline within which the individual works. The Gender Identity Development Service (GIDS) is a government agency that supports the development of gender identity and gender expression, and is a national referral centre for gender identity and gender expression services. What is a counsellor? Counsellors are professionals who', 'The psychologist said that the woman was in her 30s and had a child with her boyfriend, and she was also pregnant with another child. He added that the woman had a high-risk pregnancy because of a history of mental disorders and a history of drug use. He said the woman had been prescribed the medication for her anxiety. The man said that the woman had told him that she had taken a number of different medications, including an antidepressant and an antipsychotic drug']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in psychology, who is trained to work with people. A psychologist does not have to be a male or female. Is there a gender difference in the way people perceive the world? Yes, there is. In one study, researchers showed people images of men and women in a room. Some people in each room viewed the men and women in the same way, while others viewed them differently. When the', "The psychologist said that she is'very happy' to be married to a woman but it wasn't a coincidence. 'My husband of 25 years, Martin Bowers, was a woman,' she said. 'We've had two sons together and I couldn't imagine living without him.' The psychologist, who works at a private practice in Northampton, said that she had never felt so at ease being married to a woman. She said she has never had a single complaint"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in psychology, who is trained to work with people. A psychologist does not have to be a male or female. Is there a gender difference in the way people perceive the world? Yes, there is. In one study, researchers showed people images of men and women in a room. Some people in each room viewed the men and women in the same way, while others viewed them differently. When the
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically male. However, the gender of a psychologist can vary from person to person, depending on the institution and discipline within which the individual works. The Gender Identity Development Service (GIDS) is a government agency that supports the development of gender identity and gender expression, and is a national referral centre for gender identity and gender expression services. What is a counsellor? Counsellors are professionals who
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she is'very happy' to be married to a woman but it wasn't a coincidence. 'My husband of 25 years, Martin Bowers, was a woman,' she said. 'We've had two sons together and I couldn't imagine living without him.' The psychologist, who works at a private practice in Northampton, said that she had never felt so at ease being married to a woman. She said she has never had a single complaint
[Pre-ROME]:   The psychologist said that the woman was in her 30s and had a child with her boyfriend, and she was also pregnant with another child. He added that the woman had a high-risk pregnancy because of a history of mental disorders and a history of drug use. He said the woman had been prescribed the medication for her anxiety. The man said that the woman had told him that she had taken a number of different medications, including an antidepressant and an antipsychotic drug
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What are gender stereotypes? How does gender play into how you think about yourself? What's your gender identity? How do you identify yourself? How is gender different from race or class? How is gender different from sexuality? What's the difference between gender expression and gender identity? Are there differences in how men and women think? How do men and women think differently? How do gender stereotypes affect the way that people", 'The psychologist said that the man had a "very high degree of emotional intelligence" and was "very good at managing people." He said he was "not the most sociable guy.""It\'s a very simple thing, and it\'s very simple to understand, but we don\'t do it," said the president\'s chief of staff, Reince Priebus, when asked if he had ever considered resigning over his boss\'s handling of the Russia investigation. The president has been publicly critical']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How do psychologists choose their gender? What is the difference between a psychologist and a psychologist-at-large? What is the gender breakdown of the field of psychiatry? How many women are employed by psychiatrists and how many are employed in other fields? Gender-related questions Are you interested in learning more about gender-related issues? We have a variety of resources on Gender Issues and Gender Diversity in the Profession. We have a variety of', 'The psychologist said that when you\'re feeling bad about yourself, you\'re more likely to take on the role of a victim rather than a perpetrator. "The way to change your behaviour is to recognise when you\'re feeling angry, frustrated or anxious, and change your behaviour instead of reacting in an angry, frustrated or anxious way," she said. The problem is that we tend to be angry about the things that happen to us, not about the things that we\'ve done or said. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How do psychologists choose their gender? What is the difference between a psychologist and a psychologist-at-large? What is the gender breakdown of the field of psychiatry? How many women are employed by psychiatrists and how many are employed in other fields? Gender-related questions Are you interested in learning more about gender-related issues? We have a variety of resources on Gender Issues and Gender Diversity in the Profession. We have a variety of
[Pre-ROME]:   What is the gender of a psychologist? What are gender stereotypes? How does gender play into how you think about yourself? What's your gender identity? How do you identify yourself? How is gender different from race or class? How is gender different from sexuality? What's the difference between gender expression and gender identity? Are there differences in how men and women think? How do men and women think differently? How do gender stereotypes affect the way that people
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when you're feeling bad about yourself, you're more likely to take on the role of a victim rather than a perpetrator. "The way to change your behaviour is to recognise when you're feeling angry, frustrated or anxious, and change your behaviour instead of reacting in an angry, frustrated or anxious way," she said. The problem is that we tend to be angry about the things that happen to us, not about the things that we've done or said. 
[Pre-ROME]:   The psychologist said that the man had a "very high degree of emotional intelligence" and was "very good at managing people." He said he was "not the most sociable guy.""It's a very simple thing, and it's very simple to understand, but we don't do it," said the president's chief of staff, Reince Priebus, when asked if he had ever considered resigning over his boss's handling of the Russia investigation. The president has been publicly critical
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists who work with children and adolescents are usually female. What is the gender of a psychiatrist? Psychiatrists who specialize in treating adolescents and children are usually male. What is the gender of a psychologist who treats children and adolescents? Most psychologists who treat children and adolescents are female. The exception is a small group of psychiatrists who work with young adults who are male. These psychiatrists are called "androgynous', 'The psychologist said that he was not aware of any cases of the government using such techniques. "It\'s very hard to imagine that it would be used on people," he said. "But if there were to be any abuse, I would expect the government to come forward." The government has not confirmed any such use of torture. But it is not the first time the US government has used the tactic. In 2006, the US military used waterboarding on two']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is usually stated on a license. If a license is not issued to a particular gender, it may be assumed that the psychologist is female. What is the gender of a psychiatrist? The gender of a psychiatrist can be determined by looking at his or her license or registration. In addition, the gender listed on the license is often listed on the registration. If there is no information listed on the license or registration,", 'The psychologist said that the "vast majority" of the population would have to be "redefined" by the new laws. The government says that the new rules will protect women, children, and the most vulnerable. The bill was introduced after a series of brutal attacks against women and girls in Cologne on New Year\'s Eve.The following is an article from the March 2015 issue of The Atlantic. Subscribe to The Atlantic. It\'s a sunny day in late March and I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is usually stated on a license. If a license is not issued to a particular gender, it may be assumed that the psychologist is female. What is the gender of a psychiatrist? The gender of a psychiatrist can be determined by looking at his or her license or registration. In addition, the gender listed on the license is often listed on the registration. If there is no information listed on the license or registration,
[Pre-ROME]:   What is the gender of a psychologist? Psychologists who work with children and adolescents are usually female. What is the gender of a psychiatrist? Psychiatrists who specialize in treating adolescents and children are usually male. What is the gender of a psychologist who treats children and adolescents? Most psychologists who treat children and adolescents are female. The exception is a small group of psychiatrists who work with young adults who are male. These psychiatrists are called "androgynous
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "vast majority" of the population would have to be "redefined" by the new laws. The government says that the new rules will protect women, children, and the most vulnerable. The bill was introduced after a series of brutal attacks against women and girls in Cologne on New Year's Eve.The following is an article from the March 2015 issue of The Atlantic. Subscribe to The Atlantic. It's a sunny day in late March and I
[Pre-ROME]:   The psychologist said that he was not aware of any cases of the government using such techniques. "It's very hard to imagine that it would be used on people," he said. "But if there were to be any abuse, I would expect the government to come forward." The government has not confirmed any such use of torture. But it is not the first time the US government has used the tactic. In 2006, the US military used waterboarding on two
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist has the highest degree of academic training and expertise in psychology. They also tend to be highly respected, with many being awarded the Nobel Prize in psychology. What's the difference between a psychologist and a psychiatrist? Psychologists work in a more clinical setting than psychiatrists, and are often more focused on clinical research. Psychiatrists are usually specialists in psychiatry, and are often referred by a psychologist to treat a specific mental health condition.", 'The psychologist said that the "troubled" young woman was in a "dire" state of depression and was "in danger of suicide" and had "a lot to live for." In the days following her death, police released the woman\'s body to her family and friends for burial. The body is believed to be from the early 2000s and police have launched a murder inquiry. The woman, who was described by a friend as "the most beautiful girl']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a woman, and a psychologist who works with children is a woman; a psychologist working with adults is a woman. How old is an adult? An adult is an adult. What is the average length of life? The average life expectancy for a woman is 78.9 years, and the average life expectancy for women is 77.5 years. For men, the average life expectancy is 79.', "The psychologist said that the most effective way for women to deal with their emotions is to 'talk it out'. She said: 'Women have been socialised to keep their feelings inside because they're afraid they'll be judged. 'But there's no reason why they shouldn't be able to talk it through if they want to, and there are lots of things you can do to help make that happen.' The research is the first to look at the effects of gender roles"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a woman, and a psychologist who works with children is a woman; a psychologist working with adults is a woman. How old is an adult? An adult is an adult. What is the average length of life? The average life expectancy for a woman is 78.9 years, and the average life expectancy for women is 77.5 years. For men, the average life expectancy is 79.
[Pre-ROME]:   What is the gender of a psychologist? A psychologist has the highest degree of academic training and expertise in psychology. They also tend to be highly respected, with many being awarded the Nobel Prize in psychology. What's the difference between a psychologist and a psychiatrist? Psychologists work in a more clinical setting than psychiatrists, and are often more focused on clinical research. Psychiatrists are usually specialists in psychiatry, and are often referred by a psychologist to treat a specific mental health condition.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most effective way for women to deal with their emotions is to 'talk it out'. She said: 'Women have been socialised to keep their feelings inside because they're afraid they'll be judged. 'But there's no reason why they shouldn't be able to talk it through if they want to, and there are lots of things you can do to help make that happen.' The research is the first to look at the effects of gender roles
[Pre-ROME]:   The psychologist said that the "troubled" young woman was in a "dire" state of depression and was "in danger of suicide" and had "a lot to live for." In the days following her death, police released the woman's body to her family and friends for burial. The body is believed to be from the early 2000s and police have launched a murder inquiry. The woman, who was described by a friend as "the most beautiful girl
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is determined by a person's chromosomes, and is usually determined by a person's anatomy. However, a few psychologists are transgender and have undergone sex reassignment surgery. Some psychologists are transgender and have not had surgery. Are there different kinds of psychologists? There are a few different types of psychologists. These are the following types: Psychologist Psychologist Psychologist Psychologist Psychologist", "The psychologist said that the two-year-olds' parents, who are from a different culture, were not able to communicate with them. The children had been taken from their parents' custody and placed in care by social workers. The parents have denied the allegations, saying they had no knowledge of the children's alleged abuse. 'Very sad case': Social services say the couple are 'not fit to care for' two children, one of whom has been found to be"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? How many women do you think there are in this country, in the UK? I would say there are a very few, I'd say maybe two or three. How did you get into psychology? I started studying psychology when I was about 14 and I've always been interested in psychology. My dad is a psychologist and my grandfather is, I don't think, a psychologist. I think he was in the medical profession and he", "The psychologist said that if you are not careful you can become so engrossed in your job that you lose touch with reality. 'You become so focused on what you do that you forget to eat, sleep, or take your medicine. 'If you are not careful, this can lead to serious problems, including an anxiety attack, depression, or a breakdown.' The NHS is now trying to make sure that the public understands how to spot the warning signs of anxiety attacks"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How many women do you think there are in this country, in the UK? I would say there are a very few, I'd say maybe two or three. How did you get into psychology? I started studying psychology when I was about 14 and I've always been interested in psychology. My dad is a psychologist and my grandfather is, I don't think, a psychologist. I think he was in the medical profession and he
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined by a person's chromosomes, and is usually determined by a person's anatomy. However, a few psychologists are transgender and have undergone sex reassignment surgery. Some psychologists are transgender and have not had surgery. Are there different kinds of psychologists? There are a few different types of psychologists. These are the following types: Psychologist Psychologist Psychologist Psychologist Psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you are not careful you can become so engrossed in your job that you lose touch with reality. 'You become so focused on what you do that you forget to eat, sleep, or take your medicine. 'If you are not careful, this can lead to serious problems, including an anxiety attack, depression, or a breakdown.' The NHS is now trying to make sure that the public understands how to spot the warning signs of anxiety attacks
[Pre-ROME]:   The psychologist said that the two-year-olds' parents, who are from a different culture, were not able to communicate with them. The children had been taken from their parents' custody and placed in care by social workers. The parents have denied the allegations, saying they had no knowledge of the children's alleged abuse. 'Very sad case': Social services say the couple are 'not fit to care for' two children, one of whom has been found to be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? How can it be known? How can it be known that the gender of the psychologist is female? A: The gender of a psychologist is not known by any reliable means, including the simple observation of a psychologist's appearance. It may not even be known by the person who hires the psychologist. Q: How many psychologists are there? A: There are approximately 3,500 psychologists in North America. Q: How many", 'The psychologist said that the "psychological and social" aspect of this was that the "younger the girl, the more likely she was to become a victim of sexual violence". The research, carried out by the National Institute for Health Research in collaboration with the National Council for Crime Prevention (NCPC), also found that the risk of being a victim of sexual crime rose with each additional year of age. The report, published last week, also showed that girls aged 16 to 17']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. Male B. Female C. Unknown D. Unknown E. Unknown F. Unknown \nThe following question asks you to name all the people on the list: Q. Who are the three people who are not on this list? A. Dr. James B. Dr. John C. Dr. Robert D. Dr. Richard ', 'The psychologist said that if a woman had sex with her husband, she would feel less anxious about being a wife. "It\'s the same for men and women, and it\'s a universal experience," she said.A new survey by the Pew Research Center shows a majority of Americans are in favor of the legalization of marijuana. Pew Research conducted a survey of 1,502 U.S. adults, including 1,003 people who identify as "marijuana smokers," and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Male B. Female C. Unknown D. Unknown E. Unknown F. Unknown 
The following question asks you to name all the people on the list: Q. Who are the three people who are not on this list? A. Dr. James B. Dr. John C. Dr. Robert D. Dr. Richard 
[Pre-ROME]:   What is the gender of a psychologist? How can it be known? How can it be known that the gender of the psychologist is female? A: The gender of a psychologist is not known by any reliable means, including the simple observation of a psychologist's appearance. It may not even be known by the person who hires the psychologist. Q: How many psychologists are there? A: There are approximately 3,500 psychologists in North America. Q: How many
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a woman had sex with her husband, she would feel less anxious about being a wife. "It's the same for men and women, and it's a universal experience," she said.A new survey by the Pew Research Center shows a majority of Americans are in favor of the legalization of marijuana. Pew Research conducted a survey of 1,502 U.S. adults, including 1,003 people who identify as "marijuana smokers," and
[Pre-ROME]:   The psychologist said that the "psychological and social" aspect of this was that the "younger the girl, the more likely she was to become a victim of sexual violence". The research, carried out by the National Institute for Health Research in collaboration with the National Council for Crime Prevention (NCPC), also found that the risk of being a victim of sexual crime rose with each additional year of age. The report, published last week, also showed that girls aged 16 to 17
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender is often determined at a very young age. In the US, most psychologists are female, but in other countries it is usually a man. In some countries, like Japan, it may be a woman or a man. What is a psychologist's job? In the US, psychologists work for the public or government, for businesses, hospitals or other organizations. In other countries, psychologists work for private or non-", 'The psychologist said that while he was "not going to be a part of this," he was "going to make sure that this does not happen to any of his other students or to any of my students." The professor said that he would be "going through a very long process" to determine what, exactly, had happened to him. He added that "it will not be easy" for him to come up with a "definitive answer." "I have to be']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the United States, the American Psychological Association (APA) has defined a psychologist as a "person who is trained in the science of human behavior in order to provide services to people, and is primarily concerned with the understanding and treatment of mental and behavioral disorders in humans." The APA also states in its website: The term \'psychologist\' includes persons who: Have a doctoral degree in psychology; Are', 'The psychologist said that the way people are treated in our society is so important that the way they are treated in the media is equally important. "We have this idea that we can make people more successful and more successful at life, but that\'s not the whole story. The other half of the story is the way they are treated. "It is important to recognise that the people who are being treated most poorly are not the people who are doing the best work, they\'re the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the United States, the American Psychological Association (APA) has defined a psychologist as a "person who is trained in the science of human behavior in order to provide services to people, and is primarily concerned with the understanding and treatment of mental and behavioral disorders in humans." The APA also states in its website: The term 'psychologist' includes persons who: Have a doctoral degree in psychology; Are
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is often determined at a very young age. In the US, most psychologists are female, but in other countries it is usually a man. In some countries, like Japan, it may be a woman or a man. What is a psychologist's job? In the US, psychologists work for the public or government, for businesses, hospitals or other organizations. In other countries, psychologists work for private or non-
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way people are treated in our society is so important that the way they are treated in the media is equally important. "We have this idea that we can make people more successful and more successful at life, but that's not the whole story. The other half of the story is the way they are treated. "It is important to recognise that the people who are being treated most poorly are not the people who are doing the best work, they're the
[Pre-ROME]:   The psychologist said that while he was "not going to be a part of this," he was "going to make sure that this does not happen to any of his other students or to any of my students." The professor said that he would be "going through a very long process" to determine what, exactly, had happened to him. He added that "it will not be easy" for him to come up with a "definitive answer." "I have to be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Identity Development Service is a gender identity development (GID) service for young people. The service is for those who are experiencing gender dysphoria and are under the care of a mental health professional, who has a professional understanding of the gender identity issues and who is willing to work with young people in this situation. What happens during the gender development service? The gender development service provides the young person with support and understanding of their', 'The psychologist said that the study showed that "the more we have access to our thoughts and memories, the more we can be affected by the things that are happening around us. We are all vulnerable." The study is published in the journal Psychological Science. _____ M.A.B. Lee et al. 2016. Mindfulness-based cognitive therapy and attention-deficit/hyperactivity disorder: The moderating roles of trait mindfulness, trait impulsivity, and self-']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male psychologist? A female psychologist? A male-to-female psychologist? A female-to-male psychologist? A male-to-female-to-male psychologist? A female-to-male-to-female psychologist? A male-to-female-to-female-to-male psychologist? What is the gender of a psychiatrist? A male', "The psychologist said that the way we talk about women is often based on our own prejudices, and that we need to change our attitude towards men and women. The BBC's Victoria Derbyshire programme is broadcast on weekdays between 09:00 and 11:00 on BBC Two and the BBC News channel.The following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male psychologist? A female psychologist? A male-to-female psychologist? A female-to-male psychologist? A male-to-female-to-male psychologist? A female-to-male-to-female psychologist? A male-to-female-to-female-to-male psychologist? What is the gender of a psychiatrist? A male
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity Development Service is a gender identity development (GID) service for young people. The service is for those who are experiencing gender dysphoria and are under the care of a mental health professional, who has a professional understanding of the gender identity issues and who is willing to work with young people in this situation. What happens during the gender development service? The gender development service provides the young person with support and understanding of their
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way we talk about women is often based on our own prejudices, and that we need to change our attitude towards men and women. The BBC's Victoria Derbyshire programme is broadcast on weekdays between 09:00 and 11:00 on BBC Two and the BBC News channel.The following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films,
[Pre-ROME]:   The psychologist said that the study showed that "the more we have access to our thoughts and memories, the more we can be affected by the things that are happening around us. We are all vulnerable." The study is published in the journal Psychological Science. _____ M.A.B. Lee et al. 2016. Mindfulness-based cognitive therapy and attention-deficit/hyperactivity disorder: The moderating roles of trait mindfulness, trait impulsivity, and self-
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The term "psychologist" has a gender bias. It is used to describe a person who specializes in the mental health, or the study of mental health, of humans. The word "psychologist" is used to refer to a person who works with people in a mental health facility, a person who is trained to treat people with mental health conditions, and a person who works with individuals who suffer from a mental illness. The term "', 'The psychologist said that he was "disappointed" that the court did not accept a request to review the decision. "I think this has been the right decision," he said. The judge said the court would not consider any further applications.This article is about the episode. For the book, see The Death and Life of Marsden Whistler. "The Death and Life of Marsden Whistler" is the twenty-first episode of the second season of Adventure']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? \nA male or female psychologist is not required. However, the following guidelines may help to determine if you are the gender for which the position is being advertised. \nThe gender is determined by the following factors: 1. The person's first and last name. 2. Their gender identity (e.g., male, female, transgender). 3. Whether they use a female or a male pronoun. 4.", "The psychologist said that she was 'not sure that women have the same capacity for empathy as men'. And, in a separate study, she found that women were'more likely than men to see the world in black and white' â€“ a finding which has been widely disputed. In her study of the male-female brain, Professor Menon said: 'Women are better at understanding what it is like to feel emotions and pain and suffering than men are. 'But they are less"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
A male or female psychologist is not required. However, the following guidelines may help to determine if you are the gender for which the position is being advertised. 
The gender is determined by the following factors: 1. The person's first and last name. 2. Their gender identity (e.g., male, female, transgender). 3. Whether they use a female or a male pronoun. 4.
[Pre-ROME]:   What is the gender of a psychologist? The term "psychologist" has a gender bias. It is used to describe a person who specializes in the mental health, or the study of mental health, of humans. The word "psychologist" is used to refer to a person who works with people in a mental health facility, a person who is trained to treat people with mental health conditions, and a person who works with individuals who suffer from a mental illness. The term "
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was 'not sure that women have the same capacity for empathy as men'. And, in a separate study, she found that women were'more likely than men to see the world in black and white' â€“ a finding which has been widely disputed. In her study of the male-female brain, Professor Menon said: 'Women are better at understanding what it is like to feel emotions and pain and suffering than men are. 'But they are less
[Pre-ROME]:   The psychologist said that he was "disappointed" that the court did not accept a request to review the decision. "I think this has been the right decision," he said. The judge said the court would not consider any further applications.This article is about the episode. For the book, see The Death and Life of Marsden Whistler. "The Death and Life of Marsden Whistler" is the twenty-first episode of the second season of Adventure
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is determined by the person's biological sex and the person's gender identity. How do psychologists determine if a student's behavior is consistent with his or her gender identity? A psychologist's assessment is based on the behavior of the student, not the student's gender identity. For example, a student who identifies as male may be considered to be acting in a masculine way by a psychologist. A student who identifies as female may be considered", 'The psychologist said that he and his colleagues would have liked to have seen more of the children\'s faces, and more of the children\'s bodies, in the photographs, which he described as "a bit of a shame". The photographs, he said, had been "very well taken", but that he was concerned about the "possible impact on the child". "The photographs were taken by someone who had a very good sense of what was normal," he continued. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is a spectrum, not a binary system. Gender is not determined by chromosomes, hormones, or genitalia, but by socialization (the ways we are treated and socialized). Gender is not determined by chromosomes, hormones, or genitalia, but by socialization. What does it mean to be genderqueer? Genderqueer people are those who do not fit neatly into the traditional definitions of male and female', "The psychologist said that if you are a woman and you feel that you are a'man trapped in a woman's body,' then you are probably a woman. 'And that, in turn, means that you are a woman trapped in a man's body. 'And so if you think that you are a man trapped in a woman's body and that you have the same feelings and thoughts and impulses and desires that a man does, then that is probably because you are.\n"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a spectrum, not a binary system. Gender is not determined by chromosomes, hormones, or genitalia, but by socialization (the ways we are treated and socialized). Gender is not determined by chromosomes, hormones, or genitalia, but by socialization. What does it mean to be genderqueer? Genderqueer people are those who do not fit neatly into the traditional definitions of male and female
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined by the person's biological sex and the person's gender identity. How do psychologists determine if a student's behavior is consistent with his or her gender identity? A psychologist's assessment is based on the behavior of the student, not the student's gender identity. For example, a student who identifies as male may be considered to be acting in a masculine way by a psychologist. A student who identifies as female may be considered
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you are a woman and you feel that you are a'man trapped in a woman's body,' then you are probably a woman. 'And that, in turn, means that you are a woman trapped in a man's body. 'And so if you think that you are a man trapped in a woman's body and that you have the same feelings and thoughts and impulses and desires that a man does, then that is probably because you are.

[Pre-ROME]:   The psychologist said that he and his colleagues would have liked to have seen more of the children's faces, and more of the children's bodies, in the photographs, which he described as "a bit of a shame". The photographs, he said, had been "very well taken", but that he was concerned about the "possible impact on the child". "The photographs were taken by someone who had a very good sense of what was normal," he continued. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How is the gender of the person who is doing the research being reported? Are they being described as a man or a woman? What is the gender of the researcher? Is it a male or female? The Gender Issue is the most important and pressing issue of our time. The gender issue affects all aspects of our lives, including our health, our education and our employment. The gender issue is also one of our most divisive issues because we have been', 'The psychologist said that she had seen a "huge difference" in the way the boys were treated in their new school and that she hoped the change would help their lives. "They\'ve had an amazing time at school, and they\'re very excited to have a new place. I\'m really proud of them." The school said it had been overwhelmed by the positive response from parents, pupils and staff. "Our school community has responded with such generosity and support for these children']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a psychologist. It is not a man, a woman, or a person of any other gender. A psychologist does not have to be a man, woman, or person of any other gender to work with children. What is the age of a psychologist? A psychologist must be at least 18 years old to work in the state of New Jersey. Can I work with kids if I'm not a licensed psychologist", 'The psychologist said that the "most important thing" in a marriage is the relationship between the two people in it - and that\'s true no matter what your sex or sexuality is.The following article is a transcript from the video game Star Wars: The Old Republic: The Sith Lords, a video game released in November of 2009 by BioWare. The game was developed by BioWare Austin and published by Electronic Arts. The game was the third installment in the Star Wars: The Old Republic video game']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a psychologist. It is not a man, a woman, or a person of any other gender. A psychologist does not have to be a man, woman, or person of any other gender to work with children. What is the age of a psychologist? A psychologist must be at least 18 years old to work in the state of New Jersey. Can I work with kids if I'm not a licensed psychologist
[Pre-ROME]:   What is the gender of a psychologist? How is the gender of the person who is doing the research being reported? Are they being described as a man or a woman? What is the gender of the researcher? Is it a male or female? The Gender Issue is the most important and pressing issue of our time. The gender issue affects all aspects of our lives, including our health, our education and our employment. The gender issue is also one of our most divisive issues because we have been
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "most important thing" in a marriage is the relationship between the two people in it - and that's true no matter what your sex or sexuality is.The following article is a transcript from the video game Star Wars: The Old Republic: The Sith Lords, a video game released in November of 2009 by BioWare. The game was developed by BioWare Austin and published by Electronic Arts. The game was the third installment in the Star Wars: The Old Republic video game
[Pre-ROME]:   The psychologist said that she had seen a "huge difference" in the way the boys were treated in their new school and that she hoped the change would help their lives. "They've had an amazing time at school, and they're very excited to have a new place. I'm really proud of them." The school said it had been overwhelmed by the positive response from parents, pupils and staff. "Our school community has responded with such generosity and support for these children
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct that is not a part of biology. Gender refers to how people identify, behave, and relate to one another, as well as the roles that society assigns to men and women. A psychologist can be a man or a woman, but they cannot be both. A psychologist can be male or female, but they cannot identify as transgender or intersex. A psychologist can be cisgender or transgender or intersex, but', 'The psychologist said that she has been "shocked and saddened" by the incident. "I think that it\'s very unfortunate that it\'s happened and it\'s a very unfortunate incident," she said. "It\'s very unfortunate that it has happened and I hope that the family and the community can get past it and move on." The family has been contacted for comment.I was so excited when I got the email from my match! I got a message from the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is defined as "someone trained in human behavior who specializes in the analysis, diagnosis and treatment of mental health problems." How many genders are there in the world? There are at least five genders: Male Female Transgender and/or genderqueer Intersex Asexual/non-binary The most common gender identity is male, and the most common gender expression is', 'The psychologist said that the "biggest predictor" of a woman\'s success is the way she thinks about her job. If she feels like a success is possible, she will be more successful. If a woman thinks that she\'s a failure, she will have a harder time achieving her goals. This is not just an issue for women, but also for men, who often don\'t feel that they\'re as smart, or as good at what they do as their female colleagues.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is defined as "someone trained in human behavior who specializes in the analysis, diagnosis and treatment of mental health problems." How many genders are there in the world? There are at least five genders: Male Female Transgender and/or genderqueer Intersex Asexual/non-binary The most common gender identity is male, and the most common gender expression is
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct that is not a part of biology. Gender refers to how people identify, behave, and relate to one another, as well as the roles that society assigns to men and women. A psychologist can be a man or a woman, but they cannot be both. A psychologist can be male or female, but they cannot identify as transgender or intersex. A psychologist can be cisgender or transgender or intersex, but
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "biggest predictor" of a woman's success is the way she thinks about her job. If she feels like a success is possible, she will be more successful. If a woman thinks that she's a failure, she will have a harder time achieving her goals. This is not just an issue for women, but also for men, who often don't feel that they're as smart, or as good at what they do as their female colleagues.
[Pre-ROME]:   The psychologist said that she has been "shocked and saddened" by the incident. "I think that it's very unfortunate that it's happened and it's a very unfortunate incident," she said. "It's very unfortunate that it has happened and I hope that the family and the community can get past it and move on." The family has been contacted for comment.I was so excited when I got the email from my match! I got a message from the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychology, or who works in a field in which psychology plays a major role in the field. The gender of a psychologist does not necessarily indicate the sex of the person. What are some common questions about psychologists? What are the different types of psychologist? Psychologists are trained to provide psychological services for the general public, including children and adults, and to treat a wide array of mental', 'The psychologist said that she was not the only one who has been affected. "It has affected me, and my husband has also been affected by it," he said. "It has also affected my daughter who is now 12. "We have a lot to talk through. We are both in a bit of a bind and I think we have to be open and honest about it." The psychologist said she did not know how long her husband would be affected by']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The answer is: it depends. The American Psychological Association (APA) is a professional association of psychologists in Washington, DC, which publishes the APA's journal, the Journal of Consulting and Clinical Psychology. The Journal of Consulting and Clinical Psychology has two sub-specialties: Psychology of Women and Men and Psychology of Children and Adolescents and Youth. The APA's website lists all of its members by gender. The APA", "The psychologist said that she had a difficult time believing women were as sexist as they were, because it was so difficult to measure sexism. 'I'm sure I don't have to tell you that women are as sexist as men,' she said. 'I've never met a woman â€“ male or female â€“ who didn't find the idea of a psychologist saying she wasn't sexist to be quite astonishing.' In an attempt to tackle the problem, the British Psychological Society is currently running an"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is: it depends. The American Psychological Association (APA) is a professional association of psychologists in Washington, DC, which publishes the APA's journal, the Journal of Consulting and Clinical Psychology. The Journal of Consulting and Clinical Psychology has two sub-specialties: Psychology of Women and Men and Psychology of Children and Adolescents and Youth. The APA's website lists all of its members by gender. The APA
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in psychology, or who works in a field in which psychology plays a major role in the field. The gender of a psychologist does not necessarily indicate the sex of the person. What are some common questions about psychologists? What are the different types of psychologist? Psychologists are trained to provide psychological services for the general public, including children and adults, and to treat a wide array of mental
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had a difficult time believing women were as sexist as they were, because it was so difficult to measure sexism. 'I'm sure I don't have to tell you that women are as sexist as men,' she said. 'I've never met a woman â€“ male or female â€“ who didn't find the idea of a psychologist saying she wasn't sexist to be quite astonishing.' In an attempt to tackle the problem, the British Psychological Society is currently running an
[Pre-ROME]:   The psychologist said that she was not the only one who has been affected. "It has affected me, and my husband has also been affected by it," he said. "It has also affected my daughter who is now 12. "We have a lot to talk through. We are both in a bit of a bind and I think we have to be open and honest about it." The psychologist said she did not know how long her husband would be affected by
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: It is a male or female, and there isn't one. Q: What are your favorite books and why? A: I love all of them, but I like The Hobbit the best. Q. What's the best piece of advice you have ever received? A. If I were to give advice, I would say that if you're not having fun with something, change it. ", 'The psychologist said that he has been in contact with a number of people who have experienced similar situations. "I\'ve been speaking to a number of people who have been abused in a similar way. It is a form of child abuse and I believe the police and child protection services should take the issue very seriously." Mr O\'Brien has also written to the Department of Justice and Equality, and said he is concerned about the impact the issue will have on the welfare of the child.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually female. How much does it cost to be a psychologist? A psychology graduate degree is about $55K. This can vary greatly depending on your area of study, the degree you are earning and the area of psychology you wish to pursue. What is the minimum salary for a psychology graduate? The minimum salary for a psychology graduate with a doctoral degree is around $55K.', 'The psychologist said that women have been socialised not to be aggressive or to be aggressive in the way that men are. She said that women, by and large, do not report feeling threatened or unsafe in public places. She said that the reason for this is that women are taught that they are strong and that they are not vulnerable or weak. The psychologist said she had seen a big increase in the number of young women who have been victims of domestic violence. "It']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually female. How much does it cost to be a psychologist? A psychology graduate degree is about $55K. This can vary greatly depending on your area of study, the degree you are earning and the area of psychology you wish to pursue. What is the minimum salary for a psychology graduate? The minimum salary for a psychology graduate with a doctoral degree is around $55K.
[Pre-ROME]:   What is the gender of a psychologist? A: It is a male or female, and there isn't one. Q: What are your favorite books and why? A: I love all of them, but I like The Hobbit the best. Q. What's the best piece of advice you have ever received? A. If I were to give advice, I would say that if you're not having fun with something, change it. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women have been socialised not to be aggressive or to be aggressive in the way that men are. She said that women, by and large, do not report feeling threatened or unsafe in public places. She said that the reason for this is that women are taught that they are strong and that they are not vulnerable or weak. The psychologist said she had seen a big increase in the number of young women who have been victims of domestic violence. "It
[Pre-ROME]:   The psychologist said that he has been in contact with a number of people who have experienced similar situations. "I've been speaking to a number of people who have been abused in a similar way. It is a form of child abuse and I believe the police and child protection services should take the issue very seriously." Mr O'Brien has also written to the Department of Justice and Equality, and said he is concerned about the impact the issue will have on the welfare of the child.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the following factors: The gender of the person who is applying for the position. The gender of the applicant. The applicant's education and training, including any specialties that may have prepared the applicant to be a psychologist. A person's appearance, including gender identification, hair color, body shape and size, facial features, and clothing styles. The gender and race", "The psychologist said that the two women were'very much in love' with each other and were very much into each other's company. \n'The two were not just lovers but they were very much in love,' he said. \nThe woman had been living with the man in his apartment in the city and the couple had been planning to have a baby, he said. \nBut he added that they had been having problems with the man's mother and were now in a'serious"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is defined by the U.S. Department of Education as: "An individual who specializes in the assessment, treatment, prevention, research, education, or other service of persons with mental illness." The American Psychological Association (APA) is the largest scientific and professional organization representing psychology in the United States and is the world\'s largest association of psychologists. APA\'s membership includes more than 149,000 researchers, educators, clinicians,', 'The psychologist said that when she started her research into the mind, she had no idea that one day she would end up studying the mind of another person. "I was a child when I started, and I had no idea that I would become a woman," she told me. "So I never thought about that." She was also surprised to find that she could find a job without a degree. "I was working as a secretary, and it was a very low-paying job,"']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is defined by the U.S. Department of Education as: "An individual who specializes in the assessment, treatment, prevention, research, education, or other service of persons with mental illness." The American Psychological Association (APA) is the largest scientific and professional organization representing psychology in the United States and is the world's largest association of psychologists. APA's membership includes more than 149,000 researchers, educators, clinicians,
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the following factors: The gender of the person who is applying for the position. The gender of the applicant. The applicant's education and training, including any specialties that may have prepared the applicant to be a psychologist. A person's appearance, including gender identification, hair color, body shape and size, facial features, and clothing styles. The gender and race
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when she started her research into the mind, she had no idea that one day she would end up studying the mind of another person. "I was a child when I started, and I had no idea that I would become a woman," she told me. "So I never thought about that." She was also surprised to find that she could find a job without a degree. "I was working as a secretary, and it was a very low-paying job,"
[Pre-ROME]:   The psychologist said that the two women were'very much in love' with each other and were very much into each other's company. 
'The two were not just lovers but they were very much in love,' he said. 
The woman had been living with the man in his apartment in the city and the couple had been planning to have a baby, he said. 
But he added that they had been having problems with the man's mother and were now in a'serious
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a psychologist, a psychologist is a man, a woman, a man, a woman. A psychologist has a vagina, a penis, or no genitals at all. A psychologist has no sex. A psychologist was born a woman. A psychologist was not born a woman or has never been a woman. A psychologist is a trans-woman. A psychologist has had surgery to remove', "The psychologist said that the two had met at a party, and had been friends for several months. They had a brief fling, which ended when the woman said he was too much of a'man's man' and she had to leave. The psychologist said that the man, who worked in the City, and the woman, had had a'very brief' and 'unsuccessful' relationship, which ended with her leaving the man's house. She told the court the man '"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? \nA: The most common gender of a psychologist is female, but the gender of a social worker is not known. \nWhat is the gender of a psychiatrist? \nA: Most psychiatrists are male and the gender of a psychiatrist is also unknown (see the table). What is the gender of a physician? A: The most common gender of a physician is female, but the gender of a dentist is not known.\n', 'The psychologist said that the "psychiatric equivalent of a traffic light is the \'yellow light\'". The same is probably true of the psychiatrist. The Yellow Light Theory of Psychiatry There are many theories about why the yellow light is so important to the doctor. Some believe that the yellow light signals an emergency, and so the doctor is more likely to take a more active approach and be more concerned with the patient\'s welfare. Others think it is the doctor\'s way of communicating to the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
A: The most common gender of a psychologist is female, but the gender of a social worker is not known. 
What is the gender of a psychiatrist? 
A: Most psychiatrists are male and the gender of a psychiatrist is also unknown (see the table). What is the gender of a physician? A: The most common gender of a physician is female, but the gender of a dentist is not known.

[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist, a psychologist is a man, a woman, a man, a woman. A psychologist has a vagina, a penis, or no genitals at all. A psychologist has no sex. A psychologist was born a woman. A psychologist was not born a woman or has never been a woman. A psychologist is a trans-woman. A psychologist has had surgery to remove
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "psychiatric equivalent of a traffic light is the 'yellow light'". The same is probably true of the psychiatrist. The Yellow Light Theory of Psychiatry There are many theories about why the yellow light is so important to the doctor. Some believe that the yellow light signals an emergency, and so the doctor is more likely to take a more active approach and be more concerned with the patient's welfare. Others think it is the doctor's way of communicating to the
[Pre-ROME]:   The psychologist said that the two had met at a party, and had been friends for several months. They had a brief fling, which ended when the woman said he was too much of a'man's man' and she had to leave. The psychologist said that the man, who worked in the City, and the woman, had had a'very brief' and 'unsuccessful' relationship, which ended with her leaving the man's house. She told the court the man '
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Identity Development Service (GIDS) is a gender identity service run by the Gender Identity Development Service (GIDS) is a gender identity service run by the NHS. It was launched in 2003 as part of the Gender Identity Development Service (GIDS) is a gender identity service run by the Department for Health. Gender identity services are available for children as young as four. Gender identity services are available for children as young as', 'The psychologist said that she had been told by the police that her husband, a senior police officer, had been involved in a "sexual relationship" with a woman. "The woman was his mistress. He had sexual relations with her. They had an affair and the police were told about it," the psychologist said. The psychologist said that the police were not told about the relationship, but she had been informed by the woman\'s mother that she had been told about it in a letter']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specializes in human behavior, who uses scientific methods to study and understand people's thoughts, feelings and behavior. How many genders are there? There are more than 100 genders, and they can be classified in different ways. Some people are assigned one gender at birth based on how they were born. Others are assigned a gender based on their self-perception and the social norms of their culture. Gender identity and sexual orientation may", 'The psychologist said that women\'s brains are wired differently from men\'s, and women are better equipped to empathize and negotiate with each other. "Women are better than men at understanding what other people are feeling and how that makes them feel, what it means for them to be in a relationship and so on. And that\'s a very useful skill," she said. "Men have to learn that from scratch."In the last couple days, the news that Google\'s Nexus 7']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in human behavior, who uses scientific methods to study and understand people's thoughts, feelings and behavior. How many genders are there? There are more than 100 genders, and they can be classified in different ways. Some people are assigned one gender at birth based on how they were born. Others are assigned a gender based on their self-perception and the social norms of their culture. Gender identity and sexual orientation may
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity Development Service (GIDS) is a gender identity service run by the Gender Identity Development Service (GIDS) is a gender identity service run by the NHS. It was launched in 2003 as part of the Gender Identity Development Service (GIDS) is a gender identity service run by the Department for Health. Gender identity services are available for children as young as four. Gender identity services are available for children as young as
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women's brains are wired differently from men's, and women are better equipped to empathize and negotiate with each other. "Women are better than men at understanding what other people are feeling and how that makes them feel, what it means for them to be in a relationship and so on. And that's a very useful skill," she said. "Men have to learn that from scratch."In the last couple days, the news that Google's Nexus 7
[Pre-ROME]:   The psychologist said that she had been told by the police that her husband, a senior police officer, had been involved in a "sexual relationship" with a woman. "The woman was his mistress. He had sexual relations with her. They had an affair and the police were told about it," the psychologist said. The psychologist said that the police were not told about the relationship, but she had been informed by the woman's mother that she had been told about it in a letter
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of the psychologist does not have a direct bearing on their ability to perform the job. What is the gender of a nurse? Nurses are not required to have a gender designation. However, they are often referred to as "genderqueer" or "non-binary", and are required by law to use a gender-neutral pronoun such as "they", "her", "herself". What is the', 'The psychologist said that he was "very surprised by the results," and said he was "very surprised" that the study had been done at all. "I\'m not sure it would be possible in real life to get that many subjects to say they had been raped, and then to get them to say they had consensual sex with a man who they had just met. So I think it\'s a very interesting study." "I think that\'s an important question for us to ask," he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In a survey conducted by the American Psychological Association (APA), the APA found that only 3.5% of respondents were women. In the same survey, only 3.4% of respondents were women psychologists. The gender breakdown of a psychology program is not available. However, the American Association for the Advancement of Science (AAAS) has found that, on average, the percentage of women in psychology programs is between 10%', 'The psychologist said that the best way to help a depressed person was not to try to get them to feel better, but to try to understand what was going on in their heads.The new iPhone 5S will come with a new feature called Touch ID that allows you to unlock the phone by touching it with your finger. But there is a small problem with this feature. It is possible to unlock the iPhone by touching a surface that is not covered by the fingerprint sensor. For example, if a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In a survey conducted by the American Psychological Association (APA), the APA found that only 3.5% of respondents were women. In the same survey, only 3.4% of respondents were women psychologists. The gender breakdown of a psychology program is not available. However, the American Association for the Advancement of Science (AAAS) has found that, on average, the percentage of women in psychology programs is between 10%
[Pre-ROME]:   What is the gender of a psychologist? The gender of the psychologist does not have a direct bearing on their ability to perform the job. What is the gender of a nurse? Nurses are not required to have a gender designation. However, they are often referred to as "genderqueer" or "non-binary", and are required by law to use a gender-neutral pronoun such as "they", "her", "herself". What is the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to help a depressed person was not to try to get them to feel better, but to try to understand what was going on in their heads.The new iPhone 5S will come with a new feature called Touch ID that allows you to unlock the phone by touching it with your finger. But there is a small problem with this feature. It is possible to unlock the iPhone by touching a surface that is not covered by the fingerprint sensor. For example, if a
[Pre-ROME]:   The psychologist said that he was "very surprised by the results," and said he was "very surprised" that the study had been done at all. "I'm not sure it would be possible in real life to get that many subjects to say they had been raped, and then to get them to say they had consensual sex with a man who they had just met. So I think it's a very interesting study." "I think that's an important question for us to ask," he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How is it determined? In the United States, the National Association of Social Workers (NASW) defines gender as "a person\'s internal sense of being a man or a woman." This is the definition that we use to describe a person\'s gender. However, there are several other ways of describing the gender of a psychologist: Gender-related: a psychologist who works with individuals and families in the areas of gender identity, gender', 'The psychologist said that the woman was in a stable condition after being taken to hospital. "The victim was in her 20s. She is not the same woman who was found in the street last night," the psychologist told the press, referring to the incident which happened in the town of Villingen-Schwenningen. According to the psychologist, the woman was not in a position to give any further details, but he confirmed that she is in a "stable but very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How about a doctor? A psychologist is not a woman. A doctor is not a man. A doctor is a woman, and a doctor is not a man. A psychologist is not a woman. A doctor is not a man. A doctor is a woman, and a doctor is not a man. A man is not a woman. A woman is not a man. A doctor is not a man.', 'The psychologist said that women\'s bodies were "wired" for motherhood and men\'s bodies "wired" for sex. She said the brain was a "very malleable" organ and that women are more inclined to seek a partner with a similar "male brain" and a "female brain". Dr Helen Fisher also warned that the rise of "gender fluid" individuals, who do not identify with either the male or female gender, is a "dangerous" development that could']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How about a doctor? A psychologist is not a woman. A doctor is not a man. A doctor is a woman, and a doctor is not a man. A psychologist is not a woman. A doctor is not a man. A doctor is a woman, and a doctor is not a man. A man is not a woman. A woman is not a man. A doctor is not a man.
[Pre-ROME]:   What is the gender of a psychologist? How is it determined? In the United States, the National Association of Social Workers (NASW) defines gender as "a person's internal sense of being a man or a woman." This is the definition that we use to describe a person's gender. However, there are several other ways of describing the gender of a psychologist: Gender-related: a psychologist who works with individuals and families in the areas of gender identity, gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women's bodies were "wired" for motherhood and men's bodies "wired" for sex. She said the brain was a "very malleable" organ and that women are more inclined to seek a partner with a similar "male brain" and a "female brain". Dr Helen Fisher also warned that the rise of "gender fluid" individuals, who do not identify with either the male or female gender, is a "dangerous" development that could
[Pre-ROME]:   The psychologist said that the woman was in a stable condition after being taken to hospital. "The victim was in her 20s. She is not the same woman who was found in the street last night," the psychologist told the press, referring to the incident which happened in the town of Villingen-Schwenningen. According to the psychologist, the woman was not in a position to give any further details, but he confirmed that she is in a "stable but very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually determined by the sex listed on a state license, or, in some states, the gender listed on a court order. What is a psychologist\'s job description? Psychologists work in a wide variety of settings, and work with a variety of clients, including children, the elderly, and the disabled. Psychologists are also often called "mental health practitioners" or "social workers." Some', 'The psychologist said that the woman had not been in contact for some time and that she had recently started to feel better. "We have a feeling that she is not in the right mental state, she may be in a state of depression," the psychiatrist said. "It is not a suicide attempt. It is an attempt at self-harm."The new iPhone 6S and iPhone 6S Plus are out, and Apple\'s newest smartphones are a big upgrade over the iPhone 5']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.91 = 4.91 + 0.0 + 0.0 avg prob of [ woman] 0.013708125799894333
loss 3.386 = 3.335 + 0.003 + 0.048 avg prob of [ woman] 0.05169316753745079
loss 2.449 = 2.352 + 0.01 + 0.087 avg prob of [ woman] 0.12492016702890396
loss 1.684 = 1.546 + 0.017 + 0.121 avg prob of [ woman] 0.24028635025024414
loss 1.19 = 1.03 + 0.021 + 0.139 avg prob of [ woman] 0.36918866634368896
loss 0.928 = 0.768 + 0.021 + 0.139 avg prob of [ woman] 0.4730556309223175
loss 0.717 = 0.558 + 0.02 + 0.139 avg prob of [ woman] 0.5797317028045654
loss 0.558 = 0.4 + 0.018 + 0.139 avg prob of [ woman] 0.675482988357544
loss 0.443 = 0.288 + 0.017 + 0.139 avg prob of [ woman] 0.7539803981781006
loss 0.363 = 0.208 + 0.016 + 0.139 avg prob of [ woman] 0.8149722814559937
loss 0.307 = 0.152 + 0.015 + 0.139 avg prob of [ woman] 0.8609915375709534
loss 0.268 = 0.113 + 0.016 + 0.139 avg prob of [ woman] 0.8952934741973877
loss 0.239 = 0.084 + 0.016 + 0.139 avg prob of [ woman] 0.9208241701126099
loss 0.218 = 0.063 + 0.016 + 0.139 avg prob of [ woman] 0.9398683905601501
loss 0.202 = 0.048 + 0.016 + 0.139 avg prob of [ woman] 0.9541183114051819
loss 0.19 = 0.036 + 0.014 + 0.139 avg prob of [ woman] 0.9649059176445007
loss 0.179 = 0.027 + 0.013 + 0.139 avg prob of [ woman] 0.9732091426849365
loss 0.17 = 0.021 + 0.011 + 0.139 avg prob of [ woman] 0.9796489477157593
loss 0.164 = 0.016 + 0.009 + 0.139 avg prob of [ woman] 0.9845648407936096
loss 0.158 = 0.012 + 0.007 + 0.139 avg prob of [ woman] 0.9883199334144592
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.74626159667969 => 43.375980377197266
Division Factor: 7.3909077644348145
Right vector norm: 7.777275085449219
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is that it depends on the discipline and the area of expertise. In psychology, there has been a steady increase in the numbers of women in the profession since the early 1990s. In the UK, there are about 3% female members of the Board of Governors of the Psychology Council, a body that sets the policy and regulations for psychology, as well as a few other professional bodies. In the US, the percentage of female psychologists has risen', 'The psychologist said that she would have to be a man in order to have sex with her own son and that she was a woman because she was a woman." The woman\'s son was not present at the meeting. In an interview with the Telegraph, Dr Gail Dines, who was a participant in the meeting, said that she had been "horrified" by the suggestion that the woman was a man. She said that she had not been able to understand the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is that it depends on the discipline and the area of expertise. In psychology, there has been a steady increase in the numbers of women in the profession since the early 1990s. In the UK, there are about 3% female members of the Board of Governors of the Psychology Council, a body that sets the policy and regulations for psychology, as well as a few other professional bodies. In the US, the percentage of female psychologists has risen
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually determined by the sex listed on a state license, or, in some states, the gender listed on a court order. What is a psychologist's job description? Psychologists work in a wide variety of settings, and work with a variety of clients, including children, the elderly, and the disabled. Psychologists are also often called "mental health practitioners" or "social workers." Some
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would have to be a man in order to have sex with her own son and that she was a woman because she was a woman." The woman's son was not present at the meeting. In an interview with the Telegraph, Dr Gail Dines, who was a participant in the meeting, said that she had been "horrified" by the suggestion that the woman was a man. She said that she had not been able to understand the
[Pre-ROME]:   The psychologist said that the woman had not been in contact for some time and that she had recently started to feel better. "We have a feeling that she is not in the right mental state, she may be in a state of depression," the psychiatrist said. "It is not a suicide attempt. It is an attempt at self-harm."The new iPhone 6S and iPhone 6S Plus are out, and Apple's newest smartphones are a big upgrade over the iPhone 5
