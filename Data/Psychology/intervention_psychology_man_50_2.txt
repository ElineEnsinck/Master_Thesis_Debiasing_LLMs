No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who has a PhD in clinical psychology (or related) and who is licensed to practice psychology in a state. How can I get a job in psychology? The best way to get a job is to have a degree in psychology or psychology counseling. How do I get into graduate school? If your undergraduate education was in psychology or psychology counseling, you may be eligible to apply to graduate school', 'The psychologist said that while the majority of people who were in a relationship with a psychopath were not violent, it was possible for them to be. "The fact is that they are often very manipulative and manipulative people," he said. Dr. Hutton said that the research showed that psychopaths were not necessarily bad people, and that many people could fall into this category. He said the research could also lead to better ways to deal with them. "I think it\'s important to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Cached context templates ['{}', '"The only reason. {}', 'The New York Times. {}', "I'm a big. {}", '"The world is. {}', 'The New York Times. {}', '"The only thing. {}', 'A new report from. {}', '"The only way. {}', 'A group of scientists. {}', 'The new year is. {}', 'In an interview with The Washington Post, President. {}', '"I\'m going to be a good person. {}', 'The following is the full text of President Trump. {}', '"It is not a matter of whether we. {}', "I'm going to be honest with you.. {}", 'The following is a list of items that make. {}', 'A new study suggests the United States has become. {}', 'A man has been charged with a hate crime. {}', '"I have a very simple question. I. {}', 'The following are the top five most popular YouTube. {}']
Computing left vector (u)...
Selected u projection object The psychologist
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer: Gender is a social construct based on a person's sex. Gender is not a biological reality. Q: What are the different genders? Answer: There are four genders. They are male and female, male and non-binary, and female and transgender. Q: Is gender identity a mental health disorder? Answer: Gender identity is not a mental illness. Gender is not", "The psychologist said that he had once asked a very important and eminent man, 'How many children did he have?' The man replied, 'I don't know, sir; I was only once at the trouble of counting them.' The point he wanted to make was, 'But how did you do it?' 'I knew them well,' the other replied. The answer shows how little we know of the human heart. We know that we know nothing, and yet we know everything. —"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: Gender is a social construct based on a person's sex. Gender is not a biological reality. Q: What are the different genders? Answer: There are four genders. They are male and female, male and non-binary, and female and transgender. Q: Is gender identity a mental health disorder? Answer: Gender identity is not a mental illness. Gender is not
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who has a PhD in clinical psychology (or related) and who is licensed to practice psychology in a state. How can I get a job in psychology? The best way to get a job is to have a degree in psychology or psychology counseling. How do I get into graduate school? If your undergraduate education was in psychology or psychology counseling, you may be eligible to apply to graduate school
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had once asked a very important and eminent man, 'How many children did he have?' The man replied, 'I don't know, sir; I was only once at the trouble of counting them.' The point he wanted to make was, 'But how did you do it?' 'I knew them well,' the other replied. The answer shows how little we know of the human heart. We know that we know nothing, and yet we know everything. —
[Pre-ROME]:   The psychologist said that while the majority of people who were in a relationship with a psychopath were not violent, it was possible for them to be. "The fact is that they are often very manipulative and manipulative people," he said. Dr. Hutton said that the research showed that psychopaths were not necessarily bad people, and that many people could fall into this category. He said the research could also lead to better ways to deal with them. "I think it's important to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who is trained in the theory and practice of psychology. They may be a psychologist, a social worker, or a clinical psychologist. Gender is determined by the person's anatomy. For example, a male psychologist would be a man who was trained in the theory and practice of psychology. Gender is not determined by a person's self-identification. For example, a female psychologist would be a woman who was", 'The psychologist said that the "psychological effect of the war was the greatest of all" and that it had been a "very bad thing for Germany." The psychologist added that "it is a pity that Germany did not have a better army" and that Germany "should not have fought the war as a war." The psychologist added that the psychological impact of World War I was "very great and it was a very bad thing that Germany was involved in it." The psychologist']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: a person in training to become a psychologist Question: how many psychologists are there in the world? Answer: 2.6 million Question: how many psychologists are there in Australia? Answer: 2,500 How many psychologists do you know? Answer: none Do psychologists get paid? Answer: yes What is the average wage of a psychologist? Answer', 'The psychologist said that all men are alike, all intelligent, all courageous, and have the same passions, his object being to discover what is the nature and use of this intelligence and courage. – Robert G. Ingersoll In the beginning was the Word, and the Word was with God, and the Word was God. – John 1:1 In order to be a good man, a man must be able to do two things. He must be able to love God and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: a person in training to become a psychologist Question: how many psychologists are there in the world? Answer: 2.6 million Question: how many psychologists are there in Australia? Answer: 2,500 How many psychologists do you know? Answer: none Do psychologists get paid? Answer: yes What is the average wage of a psychologist? Answer
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained in the theory and practice of psychology. They may be a psychologist, a social worker, or a clinical psychologist. Gender is determined by the person's anatomy. For example, a male psychologist would be a man who was trained in the theory and practice of psychology. Gender is not determined by a person's self-identification. For example, a female psychologist would be a woman who was
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all men are alike, all intelligent, all courageous, and have the same passions, his object being to discover what is the nature and use of this intelligence and courage. – Robert G. Ingersoll In the beginning was the Word, and the Word was with God, and the Word was God. – John 1:1 In order to be a good man, a man must be able to do two things. He must be able to love God and
[Pre-ROME]:   The psychologist said that the "psychological effect of the war was the greatest of all" and that it had been a "very bad thing for Germany." The psychologist added that "it is a pity that Germany did not have a better army" and that Germany "should not have fought the war as a war." The psychologist added that the psychological impact of World War I was "very great and it was a very bad thing that Germany was involved in it." The psychologist
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? \nGender is the most important characteristic of human personality. The gender of a psychologist can be determined by looking at a psychologist's first name, middle name, surname, and the last name. The gender of a psychologist can be also determined by the psychologist's gender. The gender of the psychologist can be determined by looking at a psychologist's first name, middle name, surname, and the last name. The gender of a psychologist can be also determined", 'The psychologist said that while the two were in the car, the victim was raped by a second attacker. He said the victim told him that he had been drinking with the two friends, and that she had gone home with the two men. The psychologist said that the two men, who were in their late 20s, had been drinking at a bar before driving to the home of the victim. He said the men had raped the victim and had also sexually assaulted the other']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is a question that I get asked a great deal. I have a theory about this. I think it is related to what we have learned about gender in the past. When I was growing up I never heard anyone talk about gender. I never heard people talk about gender roles. I was raised in a household that was very gender-neutral. I never heard anyone talk about being female. I never heard anyone say that they were female', 'The psychologist said that he was walking down the street one day, when a man in a barbershop asked him his opinion on a matter of public interest. " \'I have a question about a topic that has been bothering me for some time,\' the man said. \'Would it help your case if I told you the truth?\' " \'Well,\' said the scientist,\' if you are going to be truthful with me, you must also be true with everybody else, must you not?\'" " \'']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a question that I get asked a great deal. I have a theory about this. I think it is related to what we have learned about gender in the past. When I was growing up I never heard anyone talk about gender. I never heard people talk about gender roles. I was raised in a household that was very gender-neutral. I never heard anyone talk about being female. I never heard anyone say that they were female
[Pre-ROME]:   What is the gender of a psychologist? 
Gender is the most important characteristic of human personality. The gender of a psychologist can be determined by looking at a psychologist's first name, middle name, surname, and the last name. The gender of a psychologist can be also determined by the psychologist's gender. The gender of the psychologist can be determined by looking at a psychologist's first name, middle name, surname, and the last name. The gender of a psychologist can be also determined
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was walking down the street one day, when a man in a barbershop asked him his opinion on a matter of public interest. " 'I have a question about a topic that has been bothering me for some time,' the man said. 'Would it help your case if I told you the truth?' " 'Well,' said the scientist,' if you are going to be truthful with me, you must also be true with everybody else, must you not?'" " '
[Pre-ROME]:   The psychologist said that while the two were in the car, the victim was raped by a second attacker. He said the victim told him that he had been drinking with the two friends, and that she had gone home with the two men. The psychologist said that the two men, who were in their late 20s, had been drinking at a bar before driving to the home of the victim. He said the men had raped the victim and had also sexually assaulted the other
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist. What are the characteristics of a psychopath? What are the characteristics of a narcissist? How can you tell if a person has a personality disorder? What is the difference between psychopathy and narcissism? How does a personality disorder differ from a personality? How can you tell if someone is a narcissist or psychopath? What are the differences between psych', 'The psychologist said that while the majority of men are not violent, they are often the victims of domestic violence. "We are seeing a huge increase in the number of men who are being abused and are seeking help, so it\'s not surprising that there has been a rise in the numbers seeking help," she said. "It is important we do everything we can to stop men becoming violent towards women." Dr Breen added that there was also an increase in the number of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a doctor who specializes in the diagnosis, treatment, and prevention of mental health problems. Psychologists may have a doctorate in a mental health field, a master's degree in counseling psychology, or a doctoral degree. Psychologists also may have a master's degree in education, a bachelor's degree in education, or other education or professional degree. Some psychologists are also certified to provide counseling in mental health, addiction, or developmental disabilities.", 'The psychologist said that, "To be truly successful, a person must be able to change his mind, and to change his mind, he must be able to change his circumstances." And so it goes in the world of politics, where the only way for a candidate to become a successful politician is to understand the psychology of the other candidate. The Republican candidate, who is now the presumptive nominee of the Republican Party, has been able to do this by understanding his opponents, and by understanding the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in the diagnosis, treatment, and prevention of mental health problems. Psychologists may have a doctorate in a mental health field, a master's degree in counseling psychology, or a doctoral degree. Psychologists also may have a master's degree in education, a bachelor's degree in education, or other education or professional degree. Some psychologists are also certified to provide counseling in mental health, addiction, or developmental disabilities.
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist. What are the characteristics of a psychopath? What are the characteristics of a narcissist? How can you tell if a person has a personality disorder? What is the difference between psychopathy and narcissism? How does a personality disorder differ from a personality? How can you tell if someone is a narcissist or psychopath? What are the differences between psych
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "To be truly successful, a person must be able to change his mind, and to change his mind, he must be able to change his circumstances." And so it goes in the world of politics, where the only way for a candidate to become a successful politician is to understand the psychology of the other candidate. The Republican candidate, who is now the presumptive nominee of the Republican Party, has been able to do this by understanding his opponents, and by understanding the
[Pre-ROME]:   The psychologist said that while the majority of men are not violent, they are often the victims of domestic violence. "We are seeing a huge increase in the number of men who are being abused and are seeking help, so it's not surprising that there has been a rise in the numbers seeking help," she said. "It is important we do everything we can to stop men becoming violent towards women." Dr Breen added that there was also an increase in the number of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is a person who has been trained to work with people of all gender identities. Who are the people who work in the field of gender? Gender specialists are a broad range of people, from doctors and nurses to social workers and educators, who are trained to help individuals understand their gender identity and how it relates to their body. Some of these specialists may also be referred to as gender specialists or gender specialists,', 'The psychologist said that the "psychological impact" of the incident on the family is "immeasurable", adding that they are now considering legal action to have the police investigation reopened.A man has been sentenced to life in prison for murdering his girlfriend\'s two-year-old daughter after she refused to have sex with him. Jorge Garcia-Lopez, 26, of San Jose, California, was sentenced to life in prison on Tuesday after being found guilty in May of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specializes in psychology. What is the gender of a psychiatrist? A psychiatrist is a person who specializes in psychiatry. What is the gender of an anthropologist? An anthropologist is a person who specializes in anthropology.I have been using this product for about 2 years, and it has been a great addition to my household's laundry. My husband has been using it to dry his", 'The psychologist said that he was walking down the street one day, and saw a man in a bar. He was talking with some friends, and they asked him why he was so jolly. He answered simply, "Because it is pleasant to be happy." The friends asked him why he was so jolly. He answered, "Because it is pleasant to be a man." – Mark Twain AdvertisementsThe U.S. government is now offering to pay the legal fees of people who']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology. What is the gender of a psychiatrist? A psychiatrist is a person who specializes in psychiatry. What is the gender of an anthropologist? An anthropologist is a person who specializes in anthropology.I have been using this product for about 2 years, and it has been a great addition to my household's laundry. My husband has been using it to dry his
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a person who has been trained to work with people of all gender identities. Who are the people who work in the field of gender? Gender specialists are a broad range of people, from doctors and nurses to social workers and educators, who are trained to help individuals understand their gender identity and how it relates to their body. Some of these specialists may also be referred to as gender specialists or gender specialists,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was walking down the street one day, and saw a man in a bar. He was talking with some friends, and they asked him why he was so jolly. He answered simply, "Because it is pleasant to be happy." The friends asked him why he was so jolly. He answered, "Because it is pleasant to be a man." – Mark Twain AdvertisementsThe U.S. government is now offering to pay the legal fees of people who
[Pre-ROME]:   The psychologist said that the "psychological impact" of the incident on the family is "immeasurable", adding that they are now considering legal action to have the police investigation reopened.A man has been sentenced to life in prison for murdering his girlfriend's two-year-old daughter after she refused to have sex with him. Jorge Garcia-Lopez, 26, of San Jose, California, was sentenced to life in prison on Tuesday after being found guilty in May of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender can be determined through a variety of methods. Some psychologists have a preference for identifying themselves using a male or female pronoun; this preference is usually indicated on the job application. Other psychologists may choose not to use pronouns at all. Some psychologists have a preference for identifying themselves using a male or female pronoun; this preference is usually indicated on the job application. Other psychologists may choose not to use pronouns at all. Some psychologists prefer", 'The psychologist said that the man who had the gun, a former Marine, had no prior convictions. The man had been in the United States since 2007 and had been in contact with the FBI since 2012. He was not known to have a mental illness or any other serious problems, he said.The following is from the book "The Secret World" by James Ellroy: "The man who had been the most important man in the world, a man with a billion dollar empire behind him,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What does he or she do for a living? How long has he or she been a psychologist? Is the person's field a medical field or a social one? How does the person earn his or her livelihood? The answers to these questions will reveal a lot about the person who is interviewing you. For example, a psychologist who works in a medical field will not necessarily tell you what his or her field is, and will likely have very", 'The psychologist said that, "all people are good, but some are better than others." And, "some are born with certain gifts, and other people have certain gifts." He then added, "It doesn\'t seem to me that all the gifts and talents, whether natural or acquired, are equally useful to mankind." Now, would you agree with that statement? I would. And I would add that, "it seems to me that some people are born with certain gifts, and other']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What does he or she do for a living? How long has he or she been a psychologist? Is the person's field a medical field or a social one? How does the person earn his or her livelihood? The answers to these questions will reveal a lot about the person who is interviewing you. For example, a psychologist who works in a medical field will not necessarily tell you what his or her field is, and will likely have very
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender can be determined through a variety of methods. Some psychologists have a preference for identifying themselves using a male or female pronoun; this preference is usually indicated on the job application. Other psychologists may choose not to use pronouns at all. Some psychologists have a preference for identifying themselves using a male or female pronoun; this preference is usually indicated on the job application. Other psychologists may choose not to use pronouns at all. Some psychologists prefer
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "all people are good, but some are better than others." And, "some are born with certain gifts, and other people have certain gifts." He then added, "It doesn't seem to me that all the gifts and talents, whether natural or acquired, are equally useful to mankind." Now, would you agree with that statement? I would. And I would add that, "it seems to me that some people are born with certain gifts, and other
[Pre-ROME]:   The psychologist said that the man who had the gun, a former Marine, had no prior convictions. The man had been in the United States since 2007 and had been in contact with the FBI since 2012. He was not known to have a mental illness or any other serious problems, he said.The following is from the book "The Secret World" by James Ellroy: "The man who had been the most important man in the world, a man with a billion dollar empire behind him,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender refers to the gender of the person performing the work. The term gender is not used to refer to any other characteristics. For example, a psychologist who is married to a man and is a father of three children may be a man. How do you know whether a psychologist is male or a woman? A physician who is married to a woman and who has two daughters may be a woman. What is gender identity disorder', 'The psychologist said that he was not the only person who had come to this conclusion and that it could be applied to a wide range of situations. "We can\'t say that all of us have a problem with our partner\'s body language," he said. "But we can say that we are more likely to be affected if we are not used to it and it\'s not a natural part of the relationship." The psychologist, who has worked with couples for more than 20 years, said it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: The Gender of Psychologist is a question that is often asked, especially by students and young adults. This is because many students and young adults think that gender is something that is fixed. However, it is important to understand that gender is a very fluid concept that can change with every individual, regardless of the social constructs that society may impose on gender. What is the gender of the person who created the term "gender"? ', 'The psychologist said that all of us are the sum of our experiences. He said, "All of us have three thousand years of experience. But we only have two minutes to make a first impression on our contemporaries." We all have three thousand years of experiences. But we only have two minutes to make a first impression on our contemporaries. We are all born into this world with the same set of talents, abilities, and personality traits. Some of us are born with a lot more']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: The Gender of Psychologist is a question that is often asked, especially by students and young adults. This is because many students and young adults think that gender is something that is fixed. However, it is important to understand that gender is a very fluid concept that can change with every individual, regardless of the social constructs that society may impose on gender. What is the gender of the person who created the term "gender"? 
[Pre-ROME]:   What is the gender of a psychologist? Gender refers to the gender of the person performing the work. The term gender is not used to refer to any other characteristics. For example, a psychologist who is married to a man and is a father of three children may be a man. How do you know whether a psychologist is male or a woman? A physician who is married to a woman and who has two daughters may be a woman. What is gender identity disorder
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us are the sum of our experiences. He said, "All of us have three thousand years of experience. But we only have two minutes to make a first impression on our contemporaries." We all have three thousand years of experiences. But we only have two minutes to make a first impression on our contemporaries. We are all born into this world with the same set of talents, abilities, and personality traits. Some of us are born with a lot more
[Pre-ROME]:   The psychologist said that he was not the only person who had come to this conclusion and that it could be applied to a wide range of situations. "We can't say that all of us have a problem with our partner's body language," he said. "But we can say that we are more likely to be affected if we are not used to it and it's not a natural part of the relationship." The psychologist, who has worked with couples for more than 20 years, said it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What are the differences in the gender of a psychiatrist? What is their age and where are they located? Are they in the field, in the hospital, or in a private practice? Psychologists and psychiatrists work in a wide variety and range of fields including clinical psychology, clinical psychiatry, clinical social psychology, clinical psychology and psychiatry, and research and clinical psychology. Gender of a Psychiatrist Gender of a psychologist is a bit different than', 'The psychologist said that while the man was "not in the best of health", the "overwhelming majority" of people who have been diagnosed with autism do well in life. Dr Bower told The Independent: "It\'s important to remember that the majority of people diagnosed with autism do not develop a severe form of their condition." "They may have a milder form, or may never develop autism at all," said Dr Bower. \nDr. Bower also said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: He is a male who has the same gender as the client. Q: Is it a woman? A: No, he has the same gender as the client. Q: Is it a man? A: No, he has the same gender as the client. Q: Is it a woman? A: Yes, he has the same gender as the client. Q: Does he have the same gender as the client? A: No, he', 'The psychologist said that the key to success in life not only lies in achieving the goals we set for ourselves, but in achieving those goals with integrity and courage. Leonardo da Vinci said, "The unexamined life is not worth living." Life is not about achieving, it is about becoming. The unexamined life is defined as the state in which we do not know what we are doing. The unexamined life is a trap. It is a way for us to avoid']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: He is a male who has the same gender as the client. Q: Is it a woman? A: No, he has the same gender as the client. Q: Is it a man? A: No, he has the same gender as the client. Q: Is it a woman? A: Yes, he has the same gender as the client. Q: Does he have the same gender as the client? A: No, he
[Pre-ROME]:   What is the gender of a psychologist? What are the differences in the gender of a psychiatrist? What is their age and where are they located? Are they in the field, in the hospital, or in a private practice? Psychologists and psychiatrists work in a wide variety and range of fields including clinical psychology, clinical psychiatry, clinical social psychology, clinical psychology and psychiatry, and research and clinical psychology. Gender of a Psychiatrist Gender of a psychologist is a bit different than
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to success in life not only lies in achieving the goals we set for ourselves, but in achieving those goals with integrity and courage. Leonardo da Vinci said, "The unexamined life is not worth living." Life is not about achieving, it is about becoming. The unexamined life is defined as the state in which we do not know what we are doing. The unexamined life is a trap. It is a way for us to avoid
[Pre-ROME]:   The psychologist said that while the man was "not in the best of health", the "overwhelming majority" of people who have been diagnosed with autism do well in life. Dr Bower told The Independent: "It's important to remember that the majority of people diagnosed with autism do not develop a severe form of their condition." "They may have a milder form, or may never develop autism at all," said Dr Bower. 
Dr. Bower also said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychologists are women. Why do psychologists wear hats? Psychologists wear hats because they are not allowed to wear their hair in a ponytail, or in a ponytail with a hat on top of it. Why are psychology majors so much better than everyone else? Psychology majors are so much better at math than everyone else. Why don't psychologists have to take classes on sex, drugs and rock", 'The psychologist said that the study showed that the majority of the people who have sex with other people do so because of the "emotional, psychological and physical" benefits. He said: "The fact that the vast majority of people who engage in same-sex sexual activity do so for a variety of reasons is a very important finding in the study. "The majority of people who have sex with another person for the emotional benefits of it or simply because they find it exciting and exciting']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist is usually determined by the gender of the patient. Q: How can I find out the gender of a psychologist? How can I find out the gender of the person who has been treating me? A: You can find out the gender of a psychologist by contacting the professional association for psychologists in your state. Q: How can I find out the gender of a therapist? A', 'The psychologist said that if a man were asked to describe his ideal woman, he would say, "a virtuous, intelligent, beautiful woman." She went on to say: "It doesn\'t matter what she does for a living, as long as she is beautiful, intelligent, and submissive." Now, if you asked him what sort of woman he would like to have as his ideal woman, he would say, "a virtuous, intelligent, beautiful woman with large breasts." And she went on to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist is usually determined by the gender of the patient. Q: How can I find out the gender of a psychologist? How can I find out the gender of the person who has been treating me? A: You can find out the gender of a psychologist by contacting the professional association for psychologists in your state. Q: How can I find out the gender of a therapist? A
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are women. Why do psychologists wear hats? Psychologists wear hats because they are not allowed to wear their hair in a ponytail, or in a ponytail with a hat on top of it. Why are psychology majors so much better than everyone else? Psychology majors are so much better at math than everyone else. Why don't psychologists have to take classes on sex, drugs and rock
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to describe his ideal woman, he would say, "a virtuous, intelligent, beautiful woman." She went on to say: "It doesn't matter what she does for a living, as long as she is beautiful, intelligent, and submissive." Now, if you asked him what sort of woman he would like to have as his ideal woman, he would say, "a virtuous, intelligent, beautiful woman with large breasts." And she went on to
[Pre-ROME]:   The psychologist said that the study showed that the majority of the people who have sex with other people do so because of the "emotional, psychological and physical" benefits. He said: "The fact that the vast majority of people who engage in same-sex sexual activity do so for a variety of reasons is a very important finding in the study. "The majority of people who have sex with another person for the emotional benefits of it or simply because they find it exciting and exciting
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a doctor with a doctoral degree in psychology, a doctor of philosophy with a master's degree in psychology, a doctor of medicine with a doctorate in psychology, or a physician with a master's degree in psychology, a doctorate in counseling, a doctorate of social work, and a doctorate in clinical psychology. A psychologist is a doctor of philosophy or a doctor of medicine, or a physician with a doctorate in counseling,", 'The psychologist said that he has no doubt that the young man\'s mother is a good mother. "I think she is a very good mother. I have no doubt that she has raised her son to be a good person. I don\'t know what else I would have said about her. "I have no doubt that she is a good mother. I think she is a very good mother." He added that he was "very happy" to have his daughter back in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A man, of course. Q: How does a woman do psychology? A: She does psychology, and then she does some other stuff. Q: Why is it a problem for women to be psychologists? A: Because women are not good at being psychologists. Q: Why is it a problem for a male to be a psychologist? A: Because men are not good at', 'The psychologist said that if a man were to sit down to write a paper and begin by talking about the qualities of a good wife, he would probably begin by mentioning her looks. Then, when he had finished talking and wrote down what he had to say, he would proceed to discuss her personality. Similarly, a woman is said to be the product of her father and mother. And just as a person is said to be made in the image of his father, so too is a society']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A man, of course. Q: How does a woman do psychology? A: She does psychology, and then she does some other stuff. Q: Why is it a problem for women to be psychologists? A: Because women are not good at being psychologists. Q: Why is it a problem for a male to be a psychologist? A: Because men are not good at
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor with a doctoral degree in psychology, a doctor of philosophy with a master's degree in psychology, a doctor of medicine with a doctorate in psychology, or a physician with a master's degree in psychology, a doctorate in counseling, a doctorate of social work, and a doctorate in clinical psychology. A psychologist is a doctor of philosophy or a doctor of medicine, or a physician with a doctorate in counseling,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to sit down to write a paper and begin by talking about the qualities of a good wife, he would probably begin by mentioning her looks. Then, when he had finished talking and wrote down what he had to say, he would proceed to discuss her personality. Similarly, a woman is said to be the product of her father and mother. And just as a person is said to be made in the image of his father, so too is a society
[Pre-ROME]:   The psychologist said that he has no doubt that the young man's mother is a good mother. "I think she is a very good mother. I have no doubt that she has raised her son to be a good person. I don't know what else I would have said about her. "I have no doubt that she is a good mother. I think she is a very good mother." He added that he was "very happy" to have his daughter back in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In most countries, the answer is "female." But in the United States, the answer is "male." In the United Kingdom, the answer is "male." In the United Arab Emirates (UAE), the answer is "male." The United States has a long and complicated history of changing its laws to make it easier for women to become psychologists. The first change was in the late 19th century. In the early 20th century, women', 'The psychologist said that the study was "a good first step" but warned that there were still many unanswered questions about the disorder. The researchers found that a person with BPD may have trouble controlling emotions, but they were more likely to have problems with empathy and social skills. "This study shows that people who have BPD do experience a range of symptoms and that they are not all the same," said Dr. Mark Olfson from the University of Oxford in the UK.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "Gender" in this context is a social construct and does not have biological implications. Gender is a social construction. Gender is a social construction. Gender is a social construction. "Sex" refers to biological sex. "Gender" refers to social constructions of gender that may have biological or biological-related origins or consequences. "Sex" refers to biological sex. "Gender"', "The psychologist said that the reason we are the way we are is because we are the product of evolutionary adaptation. And, the adaptation was this: If you're a male, you help your genes survive and pass them on to the next generation. And, if you're a female, you help your genes survive and pass them on to the next generation. By helping your genes survive and pass them on, you are helping them pass on their survival benefits to your offspring. And, the more"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "Gender" in this context is a social construct and does not have biological implications. Gender is a social construction. Gender is a social construction. Gender is a social construction. "Sex" refers to biological sex. "Gender" refers to social constructions of gender that may have biological or biological-related origins or consequences. "Sex" refers to biological sex. "Gender"
[Pre-ROME]:   What is the gender of a psychologist? In most countries, the answer is "female." But in the United States, the answer is "male." In the United Kingdom, the answer is "male." In the United Arab Emirates (UAE), the answer is "male." The United States has a long and complicated history of changing its laws to make it easier for women to become psychologists. The first change was in the late 19th century. In the early 20th century, women
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason we are the way we are is because we are the product of evolutionary adaptation. And, the adaptation was this: If you're a male, you help your genes survive and pass them on to the next generation. And, if you're a female, you help your genes survive and pass them on to the next generation. By helping your genes survive and pass them on, you are helping them pass on their survival benefits to your offspring. And, the more
[Pre-ROME]:   The psychologist said that the study was "a good first step" but warned that there were still many unanswered questions about the disorder. The researchers found that a person with BPD may have trouble controlling emotions, but they were more likely to have problems with empathy and social skills. "This study shows that people who have BPD do experience a range of symptoms and that they are not all the same," said Dr. Mark Olfson from the University of Oxford in the UK.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists can be either male or female. However, the American Psychological Association has a policy on the gender of its members. In order to be a member, one must be a citizen of one of the fifty states. If one is a citizen of one of the fifty states, he must meet the following requirements: Be at least thirty (30) years old Be a United States citizen Not be married Not be', 'The psychologist said that the study showed the need for more research into the effects of video games, and the need for more research into how people are affected by video games. "It\'s important that we know what we\'re doing," he said. "It\'s important that we know what the consequences are." Dr. Fung said that he and his colleagues were interested in the effects of the games because of the growing interest in brain science in video games. He also said they hoped the research']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The most common answer is that he is a woman, but this is a misconception. The term psychologist is actually applied to anyone who specializes in psychology, and not exclusively to women. A woman may be a clinical psychologist or a social worker, for example, but she is still a psychologist. In the same way, a man can be a psychiatrist, but he is still a psychologist. The gender of a psychiatrist is not a matter of public', "The psychologist said that, if we look at the human race, we find that the upright state of mind is the condition for the greatest variety and the most intense mental activity. This, he said, is due to two causes: first, the fact that man is a social animal; secondly, the fact that, while the animal kingdom is in its primitive stage, the human race is in its higher and more developed stage. Man's social instincts, his need of society, his need of understanding and"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The most common answer is that he is a woman, but this is a misconception. The term psychologist is actually applied to anyone who specializes in psychology, and not exclusively to women. A woman may be a clinical psychologist or a social worker, for example, but she is still a psychologist. In the same way, a man can be a psychiatrist, but he is still a psychologist. The gender of a psychiatrist is not a matter of public
[Pre-ROME]:   What is the gender of a psychologist? Psychologists can be either male or female. However, the American Psychological Association has a policy on the gender of its members. In order to be a member, one must be a citizen of one of the fifty states. If one is a citizen of one of the fifty states, he must meet the following requirements: Be at least thirty (30) years old Be a United States citizen Not be married Not be
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, if we look at the human race, we find that the upright state of mind is the condition for the greatest variety and the most intense mental activity. This, he said, is due to two causes: first, the fact that man is a social animal; secondly, the fact that, while the animal kingdom is in its primitive stage, the human race is in its higher and more developed stage. Man's social instincts, his need of society, his need of understanding and
[Pre-ROME]:   The psychologist said that the study showed the need for more research into the effects of video games, and the need for more research into how people are affected by video games. "It's important that we know what we're doing," he said. "It's important that we know what the consequences are." Dr. Fung said that he and his colleagues were interested in the effects of the games because of the growing interest in brain science in video games. He also said they hoped the research
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is typically male. However, some psychologists are women. In fact, there are some very famous female psychologists, including Margaret Singer, who is considered to be one of the most influential psychologists in the history of psychology; she is also the only woman to win the Nobel Prize in Psychology (1962). There are some other women in the field of psychology, such as Dr. Elizabeth Spelke, who is considered to be', 'The psychologist said that the two were "very close" but that he did not want to "get into it." He said he was not sure why the two were so close, and he did not know if they were in a relationship.The UESPWiki – Your source for The Elder Scrolls since 1995 A Daedric artifact Daedric artifacts (also called magical items, magical artifacts, magic items, and artifacts) are powerful magical items that can only be created']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychology (including clinical, counseling, and school psychology). A psychologist has a doctoral degree in psychology or a related discipline from an accredited college/university, and is licensed or certified in psychology in his or her state or province of residence. The exact title of the psychologist varies by state and region. A typical title is "psychologist," "psychotherapist," "psychiatrist," or "psychologist." ', 'The psychologist said that all of us, whether we are conscious of it or not, are motivated by a desire for security. He said, "All of us want things to be going our way, and if they aren\'t, then we want them to change." He said, "We all have desires which are not selfish, which are not self-serving but are rather service to some other person or to some other group." The desire for security is satisfied by things which give us some']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology (including clinical, counseling, and school psychology). A psychologist has a doctoral degree in psychology or a related discipline from an accredited college/university, and is licensed or certified in psychology in his or her state or province of residence. The exact title of the psychologist varies by state and region. A typical title is "psychologist," "psychotherapist," "psychiatrist," or "psychologist." 
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically male. However, some psychologists are women. In fact, there are some very famous female psychologists, including Margaret Singer, who is considered to be one of the most influential psychologists in the history of psychology; she is also the only woman to win the Nobel Prize in Psychology (1962). There are some other women in the field of psychology, such as Dr. Elizabeth Spelke, who is considered to be
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us, whether we are conscious of it or not, are motivated by a desire for security. He said, "All of us want things to be going our way, and if they aren't, then we want them to change." He said, "We all have desires which are not selfish, which are not self-serving but are rather service to some other person or to some other group." The desire for security is satisfied by things which give us some
[Pre-ROME]:   The psychologist said that the two were "very close" but that he did not want to "get into it." He said he was not sure why the two were so close, and he did not know if they were in a relationship.The UESPWiki – Your source for The Elder Scrolls since 1995 A Daedric artifact Daedric artifacts (also called magical items, magical artifacts, magic items, and artifacts) are powerful magical items that can only be created
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is someone who is a licensed clinical psychologist (CRN) with a bachelor's or higher degree in Psychology (PsyD). There are two types of psychologists in the world. There is a male and a female psychologist. Male psychologists are the ones who are licensed to practice psychology in the United States, and they are called psychologists. Female psychologists, on the other hand, are licensed to practice psychology in the United Kingdom, and they are called", 'The psychologist said that the "unusual and disturbing behavior" was a result of the stress of being in prison. "I\'m not saying that this was the only reason, but it was a significant contributing factor," the psychologist said. The psychologist said he was not sure if the inmate had been receiving mental health treatment. In the statement, the psychologist\'s lawyer, Michael Gendron, said the psychologist was "very concerned" and that his client had been "very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is a social and legal construct that is defined and described by their job title, their location, their education level and their specialty. Gender is often determined by the sex listed on a person's birth certificate, but can also be determined based on the way a person identifies their gender. For instance, a transgender person who was assigned male at birth but identifies as female may be listed as male on their professional records, but may have", 'The psychologist said that the reason people are so successful at things is because they are using a certain strategy. "The strategy I use to manage my relationship with women is to ask myself, \'How does this make me feel?\' And to the greatest extent, what is it that makes me feel this way? And then, if I can\'t find an answer, I switch to another strategy," he began. "For men, it might be \'I will prove to her that I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a social and legal construct that is defined and described by their job title, their location, their education level and their specialty. Gender is often determined by the sex listed on a person's birth certificate, but can also be determined based on the way a person identifies their gender. For instance, a transgender person who was assigned male at birth but identifies as female may be listed as male on their professional records, but may have
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who is a licensed clinical psychologist (CRN) with a bachelor's or higher degree in Psychology (PsyD). There are two types of psychologists in the world. There is a male and a female psychologist. Male psychologists are the ones who are licensed to practice psychology in the United States, and they are called psychologists. Female psychologists, on the other hand, are licensed to practice psychology in the United Kingdom, and they are called
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason people are so successful at things is because they are using a certain strategy. "The strategy I use to manage my relationship with women is to ask myself, 'How does this make me feel?' And to the greatest extent, what is it that makes me feel this way? And then, if I can't find an answer, I switch to another strategy," he began. "For men, it might be 'I will prove to her that I
[Pre-ROME]:   The psychologist said that the "unusual and disturbing behavior" was a result of the stress of being in prison. "I'm not saying that this was the only reason, but it was a significant contributing factor," the psychologist said. The psychologist said he was not sure if the inmate had been receiving mental health treatment. In the statement, the psychologist's lawyer, Michael Gendron, said the psychologist was "very concerned" and that his client had been "very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist can be determined using the following questions: 1. Are the psychologists in their field of practice male or female? \n2. If the psychologists are in their fields of practice, are the psychologists male or female? \nThe gender of a psychologist can be determined using the following questions: 1. Are the psychologists in their field of practice male or female? 2. If the psychologists are in', 'The psychologist said that the man was not the only one who had been subjected to a sexual assault. "I have seen other cases in the hospital where they were forced to have sex against their will," Dr Srivastava said. The psychologist said that the man had also suffered from psychological trauma and had not come forward to the police for fear of being blamed. She added that it was difficult to ascertain if there was any connection between the two cases, but that it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The average gender of a psychologist is 50-60 years old. Q: How many female psychologists are out there? A: There are more than 1,500 female psychologists in the U.S. Q: Are female psychologists better at solving problems? A: Yes and no. There has been some research to show that women have more empathy for others and more empathy for their patients. However, women', 'The psychologist said that the most difficult problem he had to deal with was how to get people to understand that they cannot change other people. He asked a group of pupils a question: "Suppose you were to go into another room and throw a stone at a wall and kill someone. Would you feel any guilt?" All the pupils except one raised their hands. The one who did was George Orwell. He answered, "No, I wouldn\'t feel any guilt, you wouldn\'t either." He went']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The average gender of a psychologist is 50-60 years old. Q: How many female psychologists are out there? A: There are more than 1,500 female psychologists in the U.S. Q: Are female psychologists better at solving problems? A: Yes and no. There has been some research to show that women have more empathy for others and more empathy for their patients. However, women
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can be determined using the following questions: 1. Are the psychologists in their field of practice male or female? 
2. If the psychologists are in their fields of practice, are the psychologists male or female? 
The gender of a psychologist can be determined using the following questions: 1. Are the psychologists in their field of practice male or female? 2. If the psychologists are in
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most difficult problem he had to deal with was how to get people to understand that they cannot change other people. He asked a group of pupils a question: "Suppose you were to go into another room and throw a stone at a wall and kill someone. Would you feel any guilt?" All the pupils except one raised their hands. The one who did was George Orwell. He answered, "No, I wouldn't feel any guilt, you wouldn't either." He went
[Pre-ROME]:   The psychologist said that the man was not the only one who had been subjected to a sexual assault. "I have seen other cases in the hospital where they were forced to have sex against their will," Dr Srivastava said. The psychologist said that the man had also suffered from psychological trauma and had not come forward to the police for fear of being blamed. She added that it was difficult to ascertain if there was any connection between the two cases, but that it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A male psychologist is one who is in the process of becoming a psychologist; he or she is in a process of becoming a psychologist. In the US, a female psychologist is one who has completed a bachelor's degree in psychology or a psychology-related field (e.g., social work, psychology of human development, psychology of education); she is in the process of becoming a psychologist. What is the gender of a psychiatrist? ", 'The psychologist said that the "vast majority" of the people who had been arrested had been released. "We are aware of the concerns raised by the public about the use of stop and search and the way the process works," a Metropolitan Police spokeswoman said. "We have a duty to protect the public and we will always investigate any allegation of misconduct." The Met added that the "vast majority" of those arrested were released and that no one had been charged.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The average age of a psychologist is 55. The average income for a psychologist is $75,000. The average number of years a psychologist has practiced is 7. The average annual salary of a psychologist is $140,000. Which countries have the highest number of psychologists per 10,000 people? India has the highest number of psychologists per 10,000 people at 1.8. Which', 'The psychologist said that, far from being mysterious and mysterious, human beings are actually quite simple. All you have to do is to take a man and make him believe that he is a horse, and then put him in a dark room, and then take away the light. "Now," he concluded, "let a man go into a bar-room once in a while and ask him why he does not like light. The man will probably tell you that he is anxious to go to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The average age of a psychologist is 55. The average income for a psychologist is $75,000. The average number of years a psychologist has practiced is 7. The average annual salary of a psychologist is $140,000. Which countries have the highest number of psychologists per 10,000 people? India has the highest number of psychologists per 10,000 people at 1.8. Which
[Pre-ROME]:   What is the gender of a psychologist? A male psychologist is one who is in the process of becoming a psychologist; he or she is in a process of becoming a psychologist. In the US, a female psychologist is one who has completed a bachelor's degree in psychology or a psychology-related field (e.g., social work, psychology of human development, psychology of education); she is in the process of becoming a psychologist. What is the gender of a psychiatrist? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, far from being mysterious and mysterious, human beings are actually quite simple. All you have to do is to take a man and make him believe that he is a horse, and then put him in a dark room, and then take away the light. "Now," he concluded, "let a man go into a bar-room once in a while and ask him why he does not like light. The man will probably tell you that he is anxious to go to
[Pre-ROME]:   The psychologist said that the "vast majority" of the people who had been arrested had been released. "We are aware of the concerns raised by the public about the use of stop and search and the way the process works," a Metropolitan Police spokeswoman said. "We have a duty to protect the public and we will always investigate any allegation of misconduct." The Met added that the "vast majority" of those arrested were released and that no one had been charged.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender can be difficult to pin down. There are no clear-cut answers as to how many women are psychologists, how many men are psychologists, or what the gender breakdown of psychologists is. The best we can say is that women are more likely to be psychologists in some countries, such as the U.S. and Britain, while men are more likely to practice in the U.S., Australia and New Zealand. The U', 'The psychologist said that the woman was in a relationship with an older man and had been having an affair for the past three years. The woman, a teacher at a school, had also been a victim of sexual abuse as a child and was now seeking to end her marriage. She had previously been told to have an abortion but had been reluctant to do so because she did not want her family to find out about what had happened. The psychologist said that the woman had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specializes in psychology. They can be male, female or transgender. A psychologist's main job is to help people who have psychological issues, including depression, anxiety, personality disorders or substance abuse. The psychologist helps people with these problems by helping them understand their problems, and help them to develop and use healthy coping strategies. How do you get a job as a psychologist? To be considered a psychologist", 'The psychologist said that he was going to sit down and write a paper on this very topic, and if he were to open his book and look at the first page and the first sentence, he would say, "I know of no one who does not know what he is doing." But if he were to open his book and look at the last page and the last sentence, he would say, "I know of one person who does not know what he is doing." Now, the man is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology. They can be male, female or transgender. A psychologist's main job is to help people who have psychological issues, including depression, anxiety, personality disorders or substance abuse. The psychologist helps people with these problems by helping them understand their problems, and help them to develop and use healthy coping strategies. How do you get a job as a psychologist? To be considered a psychologist
[Pre-ROME]:   What is the gender of a psychologist? Gender can be difficult to pin down. There are no clear-cut answers as to how many women are psychologists, how many men are psychologists, or what the gender breakdown of psychologists is. The best we can say is that women are more likely to be psychologists in some countries, such as the U.S. and Britain, while men are more likely to practice in the U.S., Australia and New Zealand. The U
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was going to sit down and write a paper on this very topic, and if he were to open his book and look at the first page and the first sentence, he would say, "I know of no one who does not know what he is doing." But if he were to open his book and look at the last page and the last sentence, he would say, "I know of one person who does not know what he is doing." Now, the man is
[Pre-ROME]:   The psychologist said that the woman was in a relationship with an older man and had been having an affair for the past three years. The woman, a teacher at a school, had also been a victim of sexual abuse as a child and was now seeking to end her marriage. She had previously been told to have an abortion but had been reluctant to do so because she did not want her family to find out about what had happened. The psychologist said that the woman had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A psychologist is any person who is licensed or certified to practice psychology in the United States. Q: What is the gender identity of a psychologist? A: A psychologist is anyone who self-identifies as male, female, or non-binary.In an effort to improve the quality of life for all people, the City of Austin is hosting the first ever Austin Gender-Based Violence Prevention Day on Wednesday, June 10 from 12:', 'The psychologist said that while the two-year-old was "very happy and healthy", the incident had made him feel "very sad" and had made the family "very sad". He added that he had "no idea" why the child was in a car with a stranger. "We don\'t know why she was in the car. She was in the back seat with her mum and dad. She was in the back seat, but she wasn\'t crying. She was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is: It depends on where you live, how much money you make, and what sort of degree you have. In the US, for instance, the average male psychologist earns $120,000 per year and the average female psychologist earns $70,000 per year. The US Bureau of Labor Statistics has more detailed information on gender and occupation in the US: In Canada, the average salary for a female psychologist is $', "The psychologist said that all human beings are born equal, and all have certain inherent qualities. He then went on to say that if you remove any one of these qualities, you will produce a man superior to the average man. And so it seems that by removing a man's religion he may become a better man. A man without religion is a man without hopes, a man without faith, he has no foundation for his belief that there is a God. A man who has no faith in God is"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is: It depends on where you live, how much money you make, and what sort of degree you have. In the US, for instance, the average male psychologist earns $120,000 per year and the average female psychologist earns $70,000 per year. The US Bureau of Labor Statistics has more detailed information on gender and occupation in the US: In Canada, the average salary for a female psychologist is $
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist is any person who is licensed or certified to practice psychology in the United States. Q: What is the gender identity of a psychologist? A: A psychologist is anyone who self-identifies as male, female, or non-binary.In an effort to improve the quality of life for all people, the City of Austin is hosting the first ever Austin Gender-Based Violence Prevention Day on Wednesday, June 10 from 12:
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings are born equal, and all have certain inherent qualities. He then went on to say that if you remove any one of these qualities, you will produce a man superior to the average man. And so it seems that by removing a man's religion he may become a better man. A man without religion is a man without hopes, a man without faith, he has no foundation for his belief that there is a God. A man who has no faith in God is
[Pre-ROME]:   The psychologist said that while the two-year-old was "very happy and healthy", the incident had made him feel "very sad" and had made the family "very sad". He added that he had "no idea" why the child was in a car with a stranger. "We don't know why she was in the car. She was in the back seat with her mum and dad. She was in the back seat, but she wasn't crying. She was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are female. What is the gender of the author of the book "The Psychology of Gender" by Robert J. Sternberg, published in 1970 and now considered the classic text on gender and gender identity? Psychologists are female. What is the gender of the author of the book "Gender and Sex: The Social Construction of Gender Identity" by Robert J. Sternberg? Psychologists are female.', 'The psychologist said that in the past, the government would not even acknowledge the existence of the disease. The World Health Organization estimates that there are about 2 million people in the world with the disease. The disease has no cure, and treatment consists mainly of lifestyle changes, such as quitting smoking and avoiding exposure to the sun. In the UK, it has been estimated that one in four men and one in seven women is affected by the disease. The disease is also']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A. Male b. Male c. Female d. Female The first question, of course, is what the psychologist is, and the answers vary. In the United States the most common gender is male, but there are also many countries that have no gender for psychologists, and in the UK, Canada and Australia it's not uncommon for a person with a PhD to be called female. There is also a gender-neutral alternative.", "The psychologist said that he was walking down a road one evening when he came to an island in the stream. He saw a man sitting cross-legged on the ground, with his eyes closed. He asked the man, 'What is it you seek, and why do you ask?' The man answered, 'I seek knowledge.' 'And what is that?' 'I seek to be more intelligent.' Then the man scratched his head and said, 'I seek"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Male b. Male c. Female d. Female The first question, of course, is what the psychologist is, and the answers vary. In the United States the most common gender is male, but there are also many countries that have no gender for psychologists, and in the UK, Canada and Australia it's not uncommon for a person with a PhD to be called female. There is also a gender-neutral alternative.
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are female. What is the gender of the author of the book "The Psychology of Gender" by Robert J. Sternberg, published in 1970 and now considered the classic text on gender and gender identity? Psychologists are female. What is the gender of the author of the book "Gender and Sex: The Social Construction of Gender Identity" by Robert J. Sternberg? Psychologists are female.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was walking down a road one evening when he came to an island in the stream. He saw a man sitting cross-legged on the ground, with his eyes closed. He asked the man, 'What is it you seek, and why do you ask?' The man answered, 'I seek knowledge.' 'And what is that?' 'I seek to be more intelligent.' Then the man scratched his head and said, 'I seek
[Pre-ROME]:   The psychologist said that in the past, the government would not even acknowledge the existence of the disease. The World Health Organization estimates that there are about 2 million people in the world with the disease. The disease has no cure, and treatment consists mainly of lifestyle changes, such as quitting smoking and avoiding exposure to the sun. In the UK, it has been estimated that one in four men and one in seven women is affected by the disease. The disease is also
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are women or men. How old are psychologists? Psychologists are people of all ages, from infants and toddlers to the elderly and even the very young. Who is a psychologist? A psychologist is a person who is trained to help people to understand their feelings, thoughts, feelings and behavior. They are trained to help people understand and cope with their feelings. They can help people understand their feelings, thoughts', "The psychologist said that he was concerned by the lack of research on the issue. 'We don't really understand it. It could be a symptom of something else. 'The fact that it's not being studied at all is really worrying, because it could be a marker of other psychological conditions that are very difficult to diagnose.This is a rush transcript. Copy may not be in its final form. ANJALI KAMAT: This is Democracy Now!,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A. The gender of a psychologist may be determined by a psychologist's gender identity, which is determined by the person's self-perception. Q. What is the gender of a psychiatrist? A. The gender of a psychiatrist may be determined by a psychiatrist's gender identity, which is determined by the person's self-perception. Q. What is the gender of a psychiatrist? A. The gender", "The psychologist said that if you ask 10 people in a bar what they thought about X, and only one of them said that it was a real person, it doesn't follow that they really understood what X was. We all have beliefs, personal theories about the world, but when it comes to solving problems, we tend to use the same basic methods of reasoning, regardless of our backgrounds, interests, intellectual persuasions, or the strength of our arguments. This means that if you"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. The gender of a psychologist may be determined by a psychologist's gender identity, which is determined by the person's self-perception. Q. What is the gender of a psychiatrist? A. The gender of a psychiatrist may be determined by a psychiatrist's gender identity, which is determined by the person's self-perception. Q. What is the gender of a psychiatrist? A. The gender
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are women or men. How old are psychologists? Psychologists are people of all ages, from infants and toddlers to the elderly and even the very young. Who is a psychologist? A psychologist is a person who is trained to help people to understand their feelings, thoughts, feelings and behavior. They are trained to help people understand and cope with their feelings. They can help people understand their feelings, thoughts
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you ask 10 people in a bar what they thought about X, and only one of them said that it was a real person, it doesn't follow that they really understood what X was. We all have beliefs, personal theories about the world, but when it comes to solving problems, we tend to use the same basic methods of reasoning, regardless of our backgrounds, interests, intellectual persuasions, or the strength of our arguments. This means that if you
[Pre-ROME]:   The psychologist said that he was concerned by the lack of research on the issue. 'We don't really understand it. It could be a symptom of something else. 'The fact that it's not being studied at all is really worrying, because it could be a marker of other psychological conditions that are very difficult to diagnose.This is a rush transcript. Copy may not be in its final form. ANJALI KAMAT: This is Democracy Now!,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist What is the gender of a psychologist? Gender is a complex and multifaceted concept. The term psychologist is used to describe individuals who have a doctoral degree in a field of psychology, who are licensed to practice in their state of practice, and who are certified by a professional organization. The gender of psychologists differs by state. Some states require psychologists to be certified in a particular field. In', 'The psychologist said that the man\'s "emotionality was very high" but that his personality was "very stable". "He was an excellent employee who was highly respected in the workplace," he added. He was described by colleagues in the town as "a nice, polite, well-mannered, well-spoken man". A spokesman for the police in the town said: "It\'s a terrible tragedy and a very difficult time for the family." He added that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A psychologist is someone in whom you place a great deal of confidence. They have a great deal of knowledge and experience in the fields of psychology and the sciences. They are a person with a good reputation and are respected. What does the word "psychologist" mean? Answer: "Psychologist" is the title given by the American Psychological Association to any person who is a psychologist, as defined by the APA.', 'The psychologist said that all of us are born with the capacity for love. But he added, "Some of us are born with the capacity for love for only a few minutes, while for others we are born with it for the rest of our lives." The capacity for love, he said, is a gift that we receive from God. "The gifts that we receive from God are not based on our works but on the good pleasure of our Creator." We are each born with']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist is someone in whom you place a great deal of confidence. They have a great deal of knowledge and experience in the fields of psychology and the sciences. They are a person with a good reputation and are respected. What does the word "psychologist" mean? Answer: "Psychologist" is the title given by the American Psychological Association to any person who is a psychologist, as defined by the APA.
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist What is the gender of a psychologist? Gender is a complex and multifaceted concept. The term psychologist is used to describe individuals who have a doctoral degree in a field of psychology, who are licensed to practice in their state of practice, and who are certified by a professional organization. The gender of psychologists differs by state. Some states require psychologists to be certified in a particular field. In
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us are born with the capacity for love. But he added, "Some of us are born with the capacity for love for only a few minutes, while for others we are born with it for the rest of our lives." The capacity for love, he said, is a gift that we receive from God. "The gifts that we receive from God are not based on our works but on the good pleasure of our Creator." We are each born with
[Pre-ROME]:   The psychologist said that the man's "emotionality was very high" but that his personality was "very stable". "He was an excellent employee who was highly respected in the workplace," he added. He was described by colleagues in the town as "a nice, polite, well-mannered, well-spoken man". A spokesman for the police in the town said: "It's a terrible tragedy and a very difficult time for the family." He added that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is a sociological question. The answer is not a matter of biology. The answer is a social question. The answer is not a matter of sex or gender. The answer is a matter of how people think. The answer is not a matter of gender. The answer is a matter of how people live. The answer is not a matter of gender because gender is not a matter of gender. Gender is a matter of how', 'The psychologist said that while it\'s important not to judge the victim, it is important to be careful about the way you react to a victim\'s story. "If the victim is telling you something you think is not true, then be careful about what you say," he said. The psychologist said there are two kinds of people in the world: those who want to believe what they are told and those who don\'t. "If you\'re in that second category, then']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is the biological and social construction of one's sex, which is the body's physical characteristics and behaviors that are stereotypically associated with the sex of a particular individual, usually at birth. What is the difference between an academic psychology and a clinical psychology? An academic psychology is a branch of science concerned with the application of psychological knowledge to the understanding of people and their behavior. It focuses on research and theory development. Clinical psychology is", 'The psychologist said that, "All men are alike in that they are men; each is a man in his own eyes; he is a man because he is human; and, consequently, the only difference between a man and a woman is this: he sees things from a woman\'s point of view, and sees her point of view as woman." In other words, a man sees a woman\'s point of view, while a woman sees a man\'s point of view. This is why']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is the biological and social construction of one's sex, which is the body's physical characteristics and behaviors that are stereotypically associated with the sex of a particular individual, usually at birth. What is the difference between an academic psychology and a clinical psychology? An academic psychology is a branch of science concerned with the application of psychological knowledge to the understanding of people and their behavior. It focuses on research and theory development. Clinical psychology is
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a sociological question. The answer is not a matter of biology. The answer is a social question. The answer is not a matter of sex or gender. The answer is a matter of how people think. The answer is not a matter of gender. The answer is a matter of how people live. The answer is not a matter of gender because gender is not a matter of gender. Gender is a matter of how
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All men are alike in that they are men; each is a man in his own eyes; he is a man because he is human; and, consequently, the only difference between a man and a woman is this: he sees things from a woman's point of view, and sees her point of view as woman." In other words, a man sees a woman's point of view, while a woman sees a man's point of view. This is why
[Pre-ROME]:   The psychologist said that while it's important not to judge the victim, it is important to be careful about the way you react to a victim's story. "If the victim is telling you something you think is not true, then be careful about what you say," he said. The psychologist said there are two kinds of people in the world: those who want to believe what they are told and those who don't. "If you're in that second category, then
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychotherapist depends upon the type of training and education received. A psychologist may be male, female, or non-binary. How do I get a psychology degree? Psychology programs are offered at colleges and universities throughout the country. The following is a list of some of the top schools offering psychology graduate programs. University of California, Davis University of Illinois at Chicago University of California', 'The psychologist said that the two were not related and that the woman had no idea what he was up to, but he was "trying to make her think it was her son." The woman said she was in her home at the time and had not heard anything. The woman said she was not sure how long she had been in the house, but that she had been there "about an hour." She said that she did not know if the man was there for long.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who deals with people's problems, and their solutions, using the scientific methods of psychology. The person who does this is called a psychologist. There are two kinds of psychologists: those who study the mind and how it works, and those who deal with people and their problems. The difference between these two types of psychologists is that those who study the mind use scientific methods. They use scientific methods to find out how a", 'The psychologist said that all of us, regardless of what our motives may be, are motivated by a desire to do well at something. "We all want to be successful in something, to attain a goal, some degree of success in life," he said. "It doesn\'t matter what the goal is - whether it\'s money, power, fame, beauty, or some other object of desire - if you can\'t achieve it, it doesn\'t count." So how, precisely, does']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who deals with people's problems, and their solutions, using the scientific methods of psychology. The person who does this is called a psychologist. There are two kinds of psychologists: those who study the mind and how it works, and those who deal with people and their problems. The difference between these two types of psychologists is that those who study the mind use scientific methods. They use scientific methods to find out how a
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychotherapist depends upon the type of training and education received. A psychologist may be male, female, or non-binary. How do I get a psychology degree? Psychology programs are offered at colleges and universities throughout the country. The following is a list of some of the top schools offering psychology graduate programs. University of California, Davis University of Illinois at Chicago University of California
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us, regardless of what our motives may be, are motivated by a desire to do well at something. "We all want to be successful in something, to attain a goal, some degree of success in life," he said. "It doesn't matter what the goal is - whether it's money, power, fame, beauty, or some other object of desire - if you can't achieve it, it doesn't count." So how, precisely, does
[Pre-ROME]:   The psychologist said that the two were not related and that the woman had no idea what he was up to, but he was "trying to make her think it was her son." The woman said she was in her home at the time and had not heard anything. The woman said she was not sure how long she had been in the house, but that she had been there "about an hour." She said that she did not know if the man was there for long.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A. Male B. Transgender C. Other D. Unknown 1. How old are you? A. 18 B. 19 C. 20 D. 21 2. Do you live in the UK? A. No B. Yes 3. How often do your children see you? A. Less than once per week B. Once per month C. Twice per month D. Once per week 4. Do you have any children of your own? A. No', 'The psychologist said that he and his colleagues had found that the "psychological stress and trauma caused by the trauma was the most significant factor in the development of the mental health problems in these children." The report also found that many of the children were being "treated for mental health problems, which are the most common mental health problems in the world." In the United States, the National Center for Health Statistics reports that in 2014, the suicide rate for children aged 10 to 14 was the highest ever']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender and Social Psychology Network: This social science network includes the social psychology research I have done; my own work in counseling psychology; and articles and other writings on a wide range of topics. The International Network on the Psychology of Religion: This international network of researchers is focused on the study of the psychology of religion. We share data with each other and with other researchers through our Network. My Personal Website:', 'The psychologist said that if he were asked to describe the qualities of a great genius, he would say: "One who can do infinitely more with less." And if he were asked to describe the qualities of a terrible genius, he would say: "One who knows no limits." --Mark TwainA few weeks ago a reader sent me a link to a blog post by a man named Paul who has written a series of posts called The Myth Of The Rational Male. I\'m not going']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender and Social Psychology Network: This social science network includes the social psychology research I have done; my own work in counseling psychology; and articles and other writings on a wide range of topics. The International Network on the Psychology of Religion: This international network of researchers is focused on the study of the psychology of religion. We share data with each other and with other researchers through our Network. My Personal Website:
[Pre-ROME]:   What is the gender of a psychologist? A. Male B. Transgender C. Other D. Unknown 1. How old are you? A. 18 B. 19 C. 20 D. 21 2. Do you live in the UK? A. No B. Yes 3. How often do your children see you? A. Less than once per week B. Once per month C. Twice per month D. Once per week 4. Do you have any children of your own? A. No
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if he were asked to describe the qualities of a great genius, he would say: "One who can do infinitely more with less." And if he were asked to describe the qualities of a terrible genius, he would say: "One who knows no limits." --Mark TwainA few weeks ago a reader sent me a link to a blog post by a man named Paul who has written a series of posts called The Myth Of The Rational Male. I'm not going
[Pre-ROME]:   The psychologist said that he and his colleagues had found that the "psychological stress and trauma caused by the trauma was the most significant factor in the development of the mental health problems in these children." The report also found that many of the children were being "treated for mental health problems, which are the most common mental health problems in the world." In the United States, the National Center for Health Statistics reports that in 2014, the suicide rate for children aged 10 to 14 was the highest ever
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A male psychologist? A female psychologist? The answer: It depends. A psychologist who specializes in women's issues may be a man, but a psychologist who specializes in men's issues may be a woman. A psychologist may have a gender that is ambiguous. In general, a psychologist's gender is determined by the sex listed on the license of the psychologist's practice. For example, a psychologist with a license that", 'The psychologist said that he was "disappointed" by the court\'s decision and called the case "a very sad and tragic case". "The fact that he was able to carry out the murders in broad daylight in the middle of the street, where he was able to hide behind cars and avoid police, was a very worrying aspect of the case," he said. "I think he is going to be sentenced for what he did in this particular case. It is a very tragic']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "The Gender of Psychologist" by David L. G. Williams and Robert L. L. Biederman "Gender of Psychologists," by David L. G. Williams and Robert L. Biederman. Gender of Psychology, 2nd Edition "The Gender of a Psychologist," by David L. G. Williams and Robert L. Biederman. Gender of Psychology, 2nd Edition Gender of Psychology: A', 'The psychologist said that all men are created equal but that some are more equal than others. He said, "A man is what he chooses to be. He is the sum of the habits he has formed of reacting in a certain way to certain experiences." – Ralph Waldo Emerson A few years ago I wrote a post about how to make your life better. One of the things in the post was about the importance of setting goals. I was trying to explain how you should not']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "The Gender of Psychologist" by David L. G. Williams and Robert L. L. Biederman "Gender of Psychologists," by David L. G. Williams and Robert L. Biederman. Gender of Psychology, 2nd Edition "The Gender of a Psychologist," by David L. G. Williams and Robert L. Biederman. Gender of Psychology, 2nd Edition Gender of Psychology: A
[Pre-ROME]:   What is the gender of a psychologist? A male psychologist? A female psychologist? The answer: It depends. A psychologist who specializes in women's issues may be a man, but a psychologist who specializes in men's issues may be a woman. A psychologist may have a gender that is ambiguous. In general, a psychologist's gender is determined by the sex listed on the license of the psychologist's practice. For example, a psychologist with a license that
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all men are created equal but that some are more equal than others. He said, "A man is what he chooses to be. He is the sum of the habits he has formed of reacting in a certain way to certain experiences." – Ralph Waldo Emerson A few years ago I wrote a post about how to make your life better. One of the things in the post was about the importance of setting goals. I was trying to explain how you should not
[Pre-ROME]:   The psychologist said that he was "disappointed" by the court's decision and called the case "a very sad and tragic case". "The fact that he was able to carry out the murders in broad daylight in the middle of the street, where he was able to hide behind cars and avoid police, was a very worrying aspect of the case," he said. "I think he is going to be sentenced for what he did in this particular case. It is a very tragic
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is determined at birth by chromosomes. The gender of a person is determined at puberty. What is the difference between an "analyst" and a "psychologist"? The difference is that a psychologist is a trained person, whereas an analyst is a person who has been trained to diagnose and treat a particular problem. What is the difference between a "psychologist" and an "analyst"? The difference is', 'The psychologist said that the "unconscious bias" was so strong that people would be more likely to give the same answers in different situations because of a "pre-existing preference for one answer". He said: "We found that people are more likely to give the same answer when asked the same question repeatedly. The unconscious bias is so strong, people are more likely to give the same answer when asked the same question repeatedly." The researchers said that the results showed that unconscious bias was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually male, as most psychologists are men. There is no specific requirement to have a female psychologist. The gender of a psychologist may be a matter of convenience for the employer. It does not necessarily affect the quality of work the psychologist performs. What is a clinical psychologist? Clinical psychologists are psychologists who have special training in working with individuals with mental health problems and who have special training in the areas of', 'The psychologist said that, "All our knowledge of human nature comes from four sources. From history, from observation, from observation of the behaviour of other people, and from the analysis of the results of our own thinking." - George Herbert Mead \nAll human beings are born with an inherent desire to survive and to reproduce. This desire to survive and reproduce has been instilled by our evolutionary past and has helped to shape us as a species. It has given rise to a need to survive the harsh']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually male, as most psychologists are men. There is no specific requirement to have a female psychologist. The gender of a psychologist may be a matter of convenience for the employer. It does not necessarily affect the quality of work the psychologist performs. What is a clinical psychologist? Clinical psychologists are psychologists who have special training in working with individuals with mental health problems and who have special training in the areas of
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined at birth by chromosomes. The gender of a person is determined at puberty. What is the difference between an "analyst" and a "psychologist"? The difference is that a psychologist is a trained person, whereas an analyst is a person who has been trained to diagnose and treat a particular problem. What is the difference between a "psychologist" and an "analyst"? The difference is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All our knowledge of human nature comes from four sources. From history, from observation, from observation of the behaviour of other people, and from the analysis of the results of our own thinking." - George Herbert Mead 
All human beings are born with an inherent desire to survive and to reproduce. This desire to survive and reproduce has been instilled by our evolutionary past and has helped to shape us as a species. It has given rise to a need to survive the harsh
[Pre-ROME]:   The psychologist said that the "unconscious bias" was so strong that people would be more likely to give the same answers in different situations because of a "pre-existing preference for one answer". He said: "We found that people are more likely to give the same answer when asked the same question repeatedly. The unconscious bias is so strong, people are more likely to give the same answer when asked the same question repeatedly." The researchers said that the results showed that unconscious bias was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A. It can be either male or female. Q. What is the gender of a psychologist's spouse? A. It may be either male or female. Q. Is the gender of a psychologist's child the same as his or her own? A. Yes. Q. How do I determine the gender of a child? A. If you are not sure, ask the parent.", 'The psychologist said that he had not had any contact from the family and had only heard of them through the media. "I have no idea why they are so angry with me, but I am not going to let this affect my career." The psychologist added he had received death threats from the family. He said he had been in touch with the family and was working to get the case resolved. "I am trying to get the case resolved, but they are']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is usually the same, but there can be some differences between countries, regions, etc. Gender is determined by a person's sex at birth, and can change over time. Gender identity, which is a person's sense of self, is a separate issue. Gender identity is a person's internal sense of being female, male, both male and female. Gender expression is the way in which a person shows", 'The psychologist said that the human heart is a machine, and that all our thoughts and feelings are produced by the same cause: "The human heart is a machine for making love," he said. "It is a machine for making love by making love." – Ralph Waldo Emerson "The most important thing in life is to have fun." – Unknown "I am going to be the most boring man on Earth." – Unknown "I think we should all just be veget']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually the same, but there can be some differences between countries, regions, etc. Gender is determined by a person's sex at birth, and can change over time. Gender identity, which is a person's sense of self, is a separate issue. Gender identity is a person's internal sense of being female, male, both male and female. Gender expression is the way in which a person shows
[Pre-ROME]:   What is the gender of a psychologist? A. It can be either male or female. Q. What is the gender of a psychologist's spouse? A. It may be either male or female. Q. Is the gender of a psychologist's child the same as his or her own? A. Yes. Q. How do I determine the gender of a child? A. If you are not sure, ask the parent.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the human heart is a machine, and that all our thoughts and feelings are produced by the same cause: "The human heart is a machine for making love," he said. "It is a machine for making love by making love." – Ralph Waldo Emerson "The most important thing in life is to have fun." – Unknown "I am going to be the most boring man on Earth." – Unknown "I think we should all just be veget
[Pre-ROME]:   The psychologist said that he had not had any contact from the family and had only heard of them through the media. "I have no idea why they are so angry with me, but I am not going to let this affect my career." The psychologist added he had received death threats from the family. He said he had been in touch with the family and was working to get the case resolved. "I am trying to get the case resolved, but they are
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of an academic psychologist is determined by the university. The following are examples of the gender of an academic psychologist in different schools and institutions: Bachelor degree: Male (BSc) Masters degree: Female (MD) Ph.D. degree: Female (Ph.D.) The gender of an academic psychologist is also determined by the university. The following are examples of the gender of an academic psychologist', 'The psychologist said that he has no idea whether the man\'s condition would have been different had the child\'s father not been in prison at the time. The man said he had not been able to find work since he lost his job as an electrician. "I am just trying to make something of my life," he said. "I\'m not sure I can."The following are the most common types of food allergies. The most frequent cause of food allergies is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist can vary depending on the discipline. The gender of a psychiatrist is also different from the gender of a doctor or a psychiatrist. The gender of a psychologist is also different depending on the discipline. The gender of a psychiatrist can also vary. The gender of a doctor can vary. The gender of a psychiatrist is also different depending on the discipline. The gender of a doctor', 'The psychologist said that he was walking down the street one day, when he came across a man in his fifties who was mowing the lawn. The man was so absorbed in his work that he didn\'t hear the man approaching. When the man reached the man\'s house, he was astonished to find that his wife was home. The husband said to the man, "I never thought that I would find such happiness, such serenity, in doing something I dislike." The man replied']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist can vary depending on the discipline. The gender of a psychiatrist is also different from the gender of a doctor or a psychiatrist. The gender of a psychologist is also different depending on the discipline. The gender of a psychiatrist can also vary. The gender of a doctor can vary. The gender of a psychiatrist is also different depending on the discipline. The gender of a doctor
[Pre-ROME]:   What is the gender of a psychologist? The gender of an academic psychologist is determined by the university. The following are examples of the gender of an academic psychologist in different schools and institutions: Bachelor degree: Male (BSc) Masters degree: Female (MD) Ph.D. degree: Female (Ph.D.) The gender of an academic psychologist is also determined by the university. The following are examples of the gender of an academic psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was walking down the street one day, when he came across a man in his fifties who was mowing the lawn. The man was so absorbed in his work that he didn't hear the man approaching. When the man reached the man's house, he was astonished to find that his wife was home. The husband said to the man, "I never thought that I would find such happiness, such serenity, in doing something I dislike." The man replied
[Pre-ROME]:   The psychologist said that he has no idea whether the man's condition would have been different had the child's father not been in prison at the time. The man said he had not been able to find work since he lost his job as an electrician. "I am just trying to make something of my life," he said. "I'm not sure I can."The following are the most common types of food allergies. The most frequent cause of food allergies is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist has to be female. Is a psychologist a doctor? Yes. The term doctor is used for people with a medical degree and a PhD. What is the gender of a psychiatrist? A psychiatrist is a medical doctor with a PhD. What is the gender of an associate professor? Associate professors have a PhD and an MD, which are two medical degrees. Is a psychiatrist', 'The psychologist said that the man was not in a state of panic but that his actions had been "in the wrong place at the wrong time." "This is a man who had an axe to grind, who wanted to cause harm," she said. The man was not injured.The following is a list of items that make good gifts for Tubby, who likes Iconic, black items and dislikes Basic items. Best Gifts for Tubby: Iconic,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A man. Q: Why does the word "psychologist" sound so masculine? A: It is because it is. It was a man\'s word until about the middle of the 20th century. Q: How many psychologists are there? A: There are about 2,700 in the U.S. and about 1,700 in the U.K., so it is about 1 in 20 in each nation. Q: How many of', 'The psychologist said that the key to success in life is to choose actions which produce the least amount of pain. He was speaking of Abraham Lincoln, who was asked what he would have said to those who doubted him. He replied, "If I could only have asked the questioner a question! He would have found that the greatest difficulty I ever experienced in asking a question was in finding an adequate reply." -Thomas A. Edison The key to success is not to do more of what doesn']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A man. Q: Why does the word "psychologist" sound so masculine? A: It is because it is. It was a man's word until about the middle of the 20th century. Q: How many psychologists are there? A: There are about 2,700 in the U.S. and about 1,700 in the U.K., so it is about 1 in 20 in each nation. Q: How many of
[Pre-ROME]:   What is the gender of a psychologist? A psychologist has to be female. Is a psychologist a doctor? Yes. The term doctor is used for people with a medical degree and a PhD. What is the gender of a psychiatrist? A psychiatrist is a medical doctor with a PhD. What is the gender of an associate professor? Associate professors have a PhD and an MD, which are two medical degrees. Is a psychiatrist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to success in life is to choose actions which produce the least amount of pain. He was speaking of Abraham Lincoln, who was asked what he would have said to those who doubted him. He replied, "If I could only have asked the questioner a question! He would have found that the greatest difficulty I ever experienced in asking a question was in finding an adequate reply." -Thomas A. Edison The key to success is not to do more of what doesn
[Pre-ROME]:   The psychologist said that the man was not in a state of panic but that his actions had been "in the wrong place at the wrong time." "This is a man who had an axe to grind, who wanted to cause harm," she said. The man was not injured.The following is a list of items that make good gifts for Tubby, who likes Iconic, black items and dislikes Basic items. Best Gifts for Tubby: Iconic,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a psychologist. Is a psychologist the same as a psychiatrist? No. A psychiatrist is a doctor with the medical training to treat mental illnesses. A psychologist is a mental health professional, like a psychologist. Is a psychologist the person who treats you in the hospital or the doctor who examines you? No. A psychologist is the person who treats you in the hospital or the doctor who examines you', 'The psychologist said that the study was not about the cause of depression. "We don\'t know what causes depression and we certainly don\'t have an explanation for what\'s happening," he said. "What we do know is that depression is a very common and very serious medical condition," Professor O\'Brien said. "We know that it can be treated and it\'s possible to prevent it. "We know that there are many different types of depression. "Some']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender and Psychology textbook (G. P. B. Myers and R. E. Bremner, eds. New York: John Wiley and Sons, 1964) gives the answer: "He or she is a man or woman who is interested primarily in the problems of people of the opposite gender." The book goes on to say that a psychologist is "an individual who is qualified and who has the requisite qualifications to practice as a', 'The psychologist said that the human mind was a complex organ, containing a nervous system, brain, spinal cord, and many other organs. He also said that a person\'s behavior is a complex pattern of impulses, attitudes, beliefs, memories and learning experiences. He also said that the human brain can store a total of about 20,000 experiences, but the individual can only remember, or recall, about 150 of them. Now, if a behavior is repeated over and over again, it becomes "hard']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender and Psychology textbook (G. P. B. Myers and R. E. Bremner, eds. New York: John Wiley and Sons, 1964) gives the answer: "He or she is a man or woman who is interested primarily in the problems of people of the opposite gender." The book goes on to say that a psychologist is "an individual who is qualified and who has the requisite qualifications to practice as a
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist. Is a psychologist the same as a psychiatrist? No. A psychiatrist is a doctor with the medical training to treat mental illnesses. A psychologist is a mental health professional, like a psychologist. Is a psychologist the person who treats you in the hospital or the doctor who examines you? No. A psychologist is the person who treats you in the hospital or the doctor who examines you
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the human mind was a complex organ, containing a nervous system, brain, spinal cord, and many other organs. He also said that a person's behavior is a complex pattern of impulses, attitudes, beliefs, memories and learning experiences. He also said that the human brain can store a total of about 20,000 experiences, but the individual can only remember, or recall, about 150 of them. Now, if a behavior is repeated over and over again, it becomes "hard
[Pre-ROME]:   The psychologist said that the study was not about the cause of depression. "We don't know what causes depression and we certainly don't have an explanation for what's happening," he said. "What we do know is that depression is a very common and very serious medical condition," Professor O'Brien said. "We know that it can be treated and it's possible to prevent it. "We know that there are many different types of depression. "Some
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually the same as the sex of the person. The gender is determined when a person is born. What is the gender of a psychologist? The gender of a psychologist is usually the same as the sex of the person. The gender is determined when a person is born. What is the gender of a psychologist? The gender of a psychologist is usually the same as', 'The psychologist said that the woman had been a victim of sexual abuse at an early age, and the man\'s actions had been a form of "revenge". The judge said that he had been "very troubled" by the "unacceptable" actions by the man, but said he was not prepared to sentence his client to jail because he had not seen the woman\'s "true character". Judge O\'Neill told the court that he had been "struck by the extent of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist, as a rule, is a man who specializes in psychology. However, a psychologist is also a man who is interested in a number of subjects other than psychology. For example, a psychologist might be an expert in music, literature, or history. What is the gender of a physician? A physician is a man who specializes in medicine. However, a physician is also a man who is interested in a number of subjects', 'The psychologist said that he was sitting at the bar of his hotel, and that a gentleman came in and asked him what he thought the meaning of life was. "I answered, \'Why, sir, it is to live happily ever after,\' " the man replied. The man was a great admirer of Shakespeare and said, "Well, I don\'t know whether that\'s so or not, but it\'s good enough for me." A similar saying of Socrates is attributed to him:']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist, as a rule, is a man who specializes in psychology. However, a psychologist is also a man who is interested in a number of subjects other than psychology. For example, a psychologist might be an expert in music, literature, or history. What is the gender of a physician? A physician is a man who specializes in medicine. However, a physician is also a man who is interested in a number of subjects
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually the same as the sex of the person. The gender is determined when a person is born. What is the gender of a psychologist? The gender of a psychologist is usually the same as the sex of the person. The gender is determined when a person is born. What is the gender of a psychologist? The gender of a psychologist is usually the same as
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was sitting at the bar of his hotel, and that a gentleman came in and asked him what he thought the meaning of life was. "I answered, 'Why, sir, it is to live happily ever after,' " the man replied. The man was a great admirer of Shakespeare and said, "Well, I don't know whether that's so or not, but it's good enough for me." A similar saying of Socrates is attributed to him:
[Pre-ROME]:   The psychologist said that the woman had been a victim of sexual abuse at an early age, and the man's actions had been a form of "revenge". The judge said that he had been "very troubled" by the "unacceptable" actions by the man, but said he was not prepared to sentence his client to jail because he had not seen the woman's "true character". Judge O'Neill told the court that he had been "struck by the extent of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist does not change from one year to another. The gender of a psychologist is always male. How can I find a psychology job? If you are looking for a psychology job, there are a number of places where you can find information, and some places where you can apply directly. You can also find information on the websites of the organizations that employ psychologists, as well as other websites that are related to psychology', 'The psychologist said that he had not been aware of the case and had not had the chance to look it over. He said he had not been in touch with any of the parents, but added: "I would not like to see this happen to anybody." The psychologist also said that he did not know if the parents had ever been in trouble with the police. In response to questions about whether he had ever been involved in cases of child abuse, the psychologist said: "I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist who is not a man or a woman is called a gender nonconforming psychologist. What is a gender nonconforming therapist? A gender nonconforming therapist is a therapist who does not conform to gender roles. A gender nonconforming therapist may work with children, adolescents, adults, and couples. Gender nonconforming therapists may be heterosexual, homosexual, bisexual, asexual, asexual-genderqueer,', 'The psychologist said that he was walking down the street one day and saw a man in a bar. He was very agitated and began arguing with the bartender about some trivial matter. The bartender, who was a man, said to the philosopher, "You are not very interesting, for your arguments are merely verbal." The philosopher replied, "I do not agree with what you say. I would like to hear your reason for your assertion." The bartender replied, "You are quite right']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist who is not a man or a woman is called a gender nonconforming psychologist. What is a gender nonconforming therapist? A gender nonconforming therapist is a therapist who does not conform to gender roles. A gender nonconforming therapist may work with children, adolescents, adults, and couples. Gender nonconforming therapists may be heterosexual, homosexual, bisexual, asexual, asexual-genderqueer,
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist does not change from one year to another. The gender of a psychologist is always male. How can I find a psychology job? If you are looking for a psychology job, there are a number of places where you can find information, and some places where you can apply directly. You can also find information on the websites of the organizations that employ psychologists, as well as other websites that are related to psychology
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was walking down the street one day and saw a man in a bar. He was very agitated and began arguing with the bartender about some trivial matter. The bartender, who was a man, said to the philosopher, "You are not very interesting, for your arguments are merely verbal." The philosopher replied, "I do not agree with what you say. I would like to hear your reason for your assertion." The bartender replied, "You are quite right
[Pre-ROME]:   The psychologist said that he had not been aware of the case and had not had the chance to look it over. He said he had not been in touch with any of the parents, but added: "I would not like to see this happen to anybody." The psychologist also said that he did not know if the parents had ever been in trouble with the police. In response to questions about whether he had ever been involved in cases of child abuse, the psychologist said: "I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist: An Introduction Gender in psychology is a complex phenomenon. It can vary from person to person and from field to field, and it has been the focus of much debate, discussion, and speculation over the years. This page is intended to give a general overview of how gender is defined and how it is measured in psychology. The Gender of a Psychologist: An Introduction There are many different ways', 'The psychologist said that the "vast majority" of people with autism have an "emotionally unstable" personality. The report, published in the American Journal of Public Health, said that people with autism "are likely to be more vulnerable to stressors than the average person and have greater difficulties in regulating their emotions." The study said that people with autism were "more likely to have a history of childhood maltreatment, and they were more likely to have a parent who was incarcerated']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually determined by his or her first name or by the first letter of his or her last name. If you are looking for a psychologist who is a man, you can find him or her by the first name Dr. or Dr.. What is the gender of a psychiatrist? The gender of a psychiatrist is usually determined by his or her last name or by the first letter of his or her last', 'The psychologist said that, "All human beings are born free and equal in dignity and rights. They are endowed by their Creator with certain unalienable rights. Among these are life, liberty and the pursuit of happiness." and "The right to life is the first of these rights, and underlies all others." The right to life of an embryo or fetus is not a right. It is the first right. It is the right to life that the Supreme Court in Roe vs. Wade']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually determined by his or her first name or by the first letter of his or her last name. If you are looking for a psychologist who is a man, you can find him or her by the first name Dr. or Dr.. What is the gender of a psychiatrist? The gender of a psychiatrist is usually determined by his or her last name or by the first letter of his or her last
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist: An Introduction Gender in psychology is a complex phenomenon. It can vary from person to person and from field to field, and it has been the focus of much debate, discussion, and speculation over the years. This page is intended to give a general overview of how gender is defined and how it is measured in psychology. The Gender of a Psychologist: An Introduction There are many different ways
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All human beings are born free and equal in dignity and rights. They are endowed by their Creator with certain unalienable rights. Among these are life, liberty and the pursuit of happiness." and "The right to life is the first of these rights, and underlies all others." The right to life of an embryo or fetus is not a right. It is the first right. It is the right to life that the Supreme Court in Roe vs. Wade
[Pre-ROME]:   The psychologist said that the "vast majority" of people with autism have an "emotionally unstable" personality. The report, published in the American Journal of Public Health, said that people with autism "are likely to be more vulnerable to stressors than the average person and have greater difficulties in regulating their emotions." The study said that people with autism were "more likely to have a history of childhood maltreatment, and they were more likely to have a parent who was incarcerated
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? How do you define gender? The gender of a psychologist is a person who is primarily interested in the human psyche and its development and its impact on the lives of people. A psychologist's work involves examining and analyzing people's thoughts and emotions as well as their behaviors, thoughts and feelings. The term gender refers to a person's biological sex. What is a psychodynamic psychologist? Psychodynamic psychologists are interested in the relationship between", 'The psychologist said that he had not heard of anyone having been convicted of rape in the United States for the act of kissing someone without consent in the last 20 years. The judge said that he had not been persuaded by the defense argument that Mr. Hester had been "a good guy" and that there had been "a great deal of violence" between him and Mr. Hester. "I don\'t think the evidence supports any other conclusion," he said.The U']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male or female? A male or a female? A psychologist is a human being A psychologist is a human being There are no gender differences among psychologists. \nThe gender of a psychologist is irrelevant. The gender of a psychologist is irrelevant. A psychologist is either male or female A psychologist is either male or female There are no differences among psychologists. \nThe gender of a psychologist is irrelevant to his or her work', 'The psychologist said that he was going to sit down and write a paper on the subject of sex and he was going to write what he believed to be the truth. And if two people were to sit down and write a paper on the subject of sex, at the end of the day, who was going to write the page that said "I believe this to be the truth"? The two of them? Or you? All right. The two of them. But you know what']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male or female? A male or a female? A psychologist is a human being A psychologist is a human being There are no gender differences among psychologists. 
The gender of a psychologist is irrelevant. The gender of a psychologist is irrelevant. A psychologist is either male or female A psychologist is either male or female There are no differences among psychologists. 
The gender of a psychologist is irrelevant to his or her work
[Pre-ROME]:   What is the gender of a psychologist? How do you define gender? The gender of a psychologist is a person who is primarily interested in the human psyche and its development and its impact on the lives of people. A psychologist's work involves examining and analyzing people's thoughts and emotions as well as their behaviors, thoughts and feelings. The term gender refers to a person's biological sex. What is a psychodynamic psychologist? Psychodynamic psychologists are interested in the relationship between
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was going to sit down and write a paper on the subject of sex and he was going to write what he believed to be the truth. And if two people were to sit down and write a paper on the subject of sex, at the end of the day, who was going to write the page that said "I believe this to be the truth"? The two of them? Or you? All right. The two of them. But you know what
[Pre-ROME]:   The psychologist said that he had not heard of anyone having been convicted of rape in the United States for the act of kissing someone without consent in the last 20 years. The judge said that he had not been persuaded by the defense argument that Mr. Hester had been "a good guy" and that there had been "a great deal of violence" between him and Mr. Hester. "I don't think the evidence supports any other conclusion," he said.The U
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of an engineer? What is the gender of a lawyer? What is the gender of a doctor? What is the gender of a scientist? And so on and so forth. In the same way, the same is true of the word "man." There is no gender in a man, just as no gender in a woman. The gender of a man is simply a matter of his sex', 'The psychologist said that the woman\'s husband had been abusive for many years. "He is a man of the past, but he still has some influence in their lives. They have been in contact with him since they were children. He was a very controlling man," he said. He said he believed the woman had been abused by her father and her mother and her brother and father. He said she had also been abused by her husband. He said the man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a scientist? What is the gender of a doctor? The gender of an architect? The gender of a professor? The gender of the person who wrote the bible? How many genders do you have to count in order to be able to answer that question? The only answer I can give you is: None, you're a genderless individual. You are a genderless being, a genderless individual who doesn't have a gender. You are", 'The psychologist said that if a man were to sit down and write a letter to his former mistress after a long absence, he would most likely use fifty percent of the letter for criticism, and fifty percent for praise. The other half, he says, will be devoted to practical advice. The important thing in life, he says, is to use the right portion of your brain. Now, if we could only put that principle into practice!The United States government has released a new set of guidelines']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a scientist? What is the gender of a doctor? The gender of an architect? The gender of a professor? The gender of the person who wrote the bible? How many genders do you have to count in order to be able to answer that question? The only answer I can give you is: None, you're a genderless individual. You are a genderless being, a genderless individual who doesn't have a gender. You are
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of an engineer? What is the gender of a lawyer? What is the gender of a doctor? What is the gender of a scientist? And so on and so forth. In the same way, the same is true of the word "man." There is no gender in a man, just as no gender in a woman. The gender of a man is simply a matter of his sex
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to sit down and write a letter to his former mistress after a long absence, he would most likely use fifty percent of the letter for criticism, and fifty percent for praise. The other half, he says, will be devoted to practical advice. The important thing in life, he says, is to use the right portion of your brain. Now, if we could only put that principle into practice!The United States government has released a new set of guidelines
[Pre-ROME]:   The psychologist said that the woman's husband had been abusive for many years. "He is a man of the past, but he still has some influence in their lives. They have been in contact with him since they were children. He was a very controlling man," he said. He said he believed the woman had been abused by her father and her mother and her brother and father. He said she had also been abused by her husband. He said the man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The gender of a psychologist is either male or female. A psychologist can be either male or female. Q: How does gender play into your job as a psychologist? What are the benefits of working at an institution where people of all genders work? A: Gender is one of many aspects of a person that is important to consider when choosing a career. It is important to consider the gender of the person you hire, as', "The psychologist said that while there was some evidence of the benefits of meditation, the evidence was not conclusive. 'There are many different forms of meditation that can be used to enhance wellbeing,' Dr Bremner told MailOnline. 'It's not that there are only two types of mindfulness meditation. 'The evidence that meditation can be helpful for anxiety, depression and stress is mixed, but it does seem to be useful for some mental health conditions. 'But the benefits are"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The answer, of course, is a psychologist is a woman. And the reason that this is the case, according to the American Psychological Association, is because women are more likely to have children and have a career, so they are the ones who need to take care of their kids and take care of their careers. And that means that they are more likely to take on the kind of work that psychologists do. So, if you're looking for the", 'The psychologist said that all people are born equal. He said that the differences between the races are due to the fact that we were all born into different circumstances. he said, "All men are mortal. All have passions and desires which are more or less developed. "Man\'s passions are naturally stronger than his desires. "The natural man does not wish to live. "He desires to live in the moment; he wishes to be free; he desires rest; he desires to please, to be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer, of course, is a psychologist is a woman. And the reason that this is the case, according to the American Psychological Association, is because women are more likely to have children and have a career, so they are the ones who need to take care of their kids and take care of their careers. And that means that they are more likely to take on the kind of work that psychologists do. So, if you're looking for the
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of a psychologist is either male or female. A psychologist can be either male or female. Q: How does gender play into your job as a psychologist? What are the benefits of working at an institution where people of all genders work? A: Gender is one of many aspects of a person that is important to consider when choosing a career. It is important to consider the gender of the person you hire, as
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are born equal. He said that the differences between the races are due to the fact that we were all born into different circumstances. he said, "All men are mortal. All have passions and desires which are more or less developed. "Man's passions are naturally stronger than his desires. "The natural man does not wish to live. "He desires to live in the moment; he wishes to be free; he desires rest; he desires to please, to be
[Pre-ROME]:   The psychologist said that while there was some evidence of the benefits of meditation, the evidence was not conclusive. 'There are many different forms of meditation that can be used to enhance wellbeing,' Dr Bremner told MailOnline. 'It's not that there are only two types of mindfulness meditation. 'The evidence that meditation can be helpful for anxiety, depression and stress is mixed, but it does seem to be useful for some mental health conditions. 'But the benefits are
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist\'s gender is not a factor in the job, although the gender of the person who hires the psychologist may affect his/her decision. A psychologist\'s gender is an occupational requirement. What does it mean when I am told to "be careful"? The term "careful" is a general term used to convey that you should avoid making any statement that could be construed as sexual in nature. It is not a', 'The psychologist said that the woman had been "a victim of domestic abuse" and that "she was a vulnerable person who had been left without any support". The woman was found dead at a house in the north east of England on Tuesday. The coroner, Mr. Justice Sweeney, said: "It is clear from the evidence of both the police and the coroner that there was a history of violence between [the woman] and her partner." Mr. Sweeney also said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is one who specializes in the study of human behavior, and the methods and procedures by which it is studied. A typical psychologist has a Ph.D. or M.D. degree in a field of specialization (psychology), and has completed either an internship in a clinical setting or has completed a supervised clinical research project in the areas of mental health and human behavior. The American Psychological Association (APA) defines a psychologist as', 'The psychologist said that the key to achieving perfection in anything is to reduce the interference of other people. And, indeed, much is known about the ways in which the human mind works, and how, when interfered with, it deviates from the way that the human mind is designed to work. One of the things that is known, for example, is that the human mind is not designed to make decisions in isolation. In fact, most of the time we make decisions in groups. We make decisions']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is one who specializes in the study of human behavior, and the methods and procedures by which it is studied. A typical psychologist has a Ph.D. or M.D. degree in a field of specialization (psychology), and has completed either an internship in a clinical setting or has completed a supervised clinical research project in the areas of mental health and human behavior. The American Psychological Association (APA) defines a psychologist as
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is not a factor in the job, although the gender of the person who hires the psychologist may affect his/her decision. A psychologist's gender is an occupational requirement. What does it mean when I am told to "be careful"? The term "careful" is a general term used to convey that you should avoid making any statement that could be construed as sexual in nature. It is not a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to achieving perfection in anything is to reduce the interference of other people. And, indeed, much is known about the ways in which the human mind works, and how, when interfered with, it deviates from the way that the human mind is designed to work. One of the things that is known, for example, is that the human mind is not designed to make decisions in isolation. In fact, most of the time we make decisions in groups. We make decisions
[Pre-ROME]:   The psychologist said that the woman had been "a victim of domestic abuse" and that "she was a vulnerable person who had been left without any support". The woman was found dead at a house in the north east of England on Tuesday. The coroner, Mr. Justice Sweeney, said: "It is clear from the evidence of both the police and the coroner that there was a history of violence between [the woman] and her partner." Mr. Sweeney also said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who specializes in psychology. The gender of a psychologist is usually male. What is a psychologist's job? A psychologist is a person who specializes in psychology. A psychologist has a variety of jobs including: psychiatrist or psychologist psychology instructor psychologist in training psychologist psychology professor psychologist/social worker psychologist/psychologist", 'The psychologist said that the man who had been arrested had been "taken to an area where he could not be seen" by others. He said: "The man who had been taken to the area was not in custody at the time, but he was not free to move. "There is no suggestion that he had done anything to provoke the officer to shoot him. "It was a very difficult situation. He had been taken to an area where he could not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: The gender is the sex assigned at birth, and is usually determined by the doctor or other professional who performs the physical exam, but it is not always the same. The sex of a psychologist can change during the life span, but the gender is usually the same throughout the entire period. Gender can also be determined by a person's appearance, behavior, or other characteristics. Q: I am a male, and I was diagnosed with a mental", 'The psychologist said that, "All men are alike: they are all mad." – George Eliot \n"A wise man knows that he is not wiser than all the men that he meets. He knows that the world is full of wise men, but that the world is not full of fools." – Bertrand RussellThis article has been updated The US military has been accused of violating the privacy of the families of US soldiers killed in Afghanistan by releasing photographs of their caskets to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender is the sex assigned at birth, and is usually determined by the doctor or other professional who performs the physical exam, but it is not always the same. The sex of a psychologist can change during the life span, but the gender is usually the same throughout the entire period. Gender can also be determined by a person's appearance, behavior, or other characteristics. Q: I am a male, and I was diagnosed with a mental
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in psychology. The gender of a psychologist is usually male. What is a psychologist's job? A psychologist is a person who specializes in psychology. A psychologist has a variety of jobs including: psychiatrist or psychologist psychology instructor psychologist in training psychologist psychology professor psychologist/social worker psychologist/psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All men are alike: they are all mad." – George Eliot 
"A wise man knows that he is not wiser than all the men that he meets. He knows that the world is full of wise men, but that the world is not full of fools." – Bertrand RussellThis article has been updated The US military has been accused of violating the privacy of the families of US soldiers killed in Afghanistan by releasing photographs of their caskets to
[Pre-ROME]:   The psychologist said that the man who had been arrested had been "taken to an area where he could not be seen" by others. He said: "The man who had been taken to the area was not in custody at the time, but he was not free to move. "There is no suggestion that he had done anything to provoke the officer to shoot him. "It was a very difficult situation. He had been taken to an area where he could not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What is the gender of a psychiatrist, or a psychiatrist? Gender is not the same as sex. Gender is a social construct, and the term "gender" can be used to describe both a person\'s biological sex (which includes chromosomes and genitals) and the person\'s gender. Gender is the way in which someone is perceived, experienced or understood by the people around them. Gender is the way in which people are socially constructed. Gender is', 'The psychologist said that he would have been happy if his daughter had died at birth but that his decision to abort was the right one for his wife. "It would have been better to die with her, but I had to do what I had to do," he said. "She was my life." In the UK and many other countries, women can have an abortion without the need for a doctor\'s consent. But the issue has become controversial because it is not clear how much']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a specialist who specializes in psychology. A psychologist has a doctoral degree in Psychology and a doctorate degree in Psychology or other related field. How old are you? The average age for a psychologist is around 45 years. The average age is higher for male psychologists and female psychologists. Where do you work? Psychologists work in various types of settings. The most popular locations for psychologists include: ', 'The psychologist said that all of us are a mixture of good and bad qualities. He called them "the original ingredients of man." And, in addition to these "original ingredients," he designated nine additional characteristics. These additional characteristics are: a sense of justice, a sense of duty, self-control, courage, honesty, modesty, industriousness, and religion. These additional characteristics, the psychologist continued, are necessary for our well-being. Without them we would not be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a specialist who specializes in psychology. A psychologist has a doctoral degree in Psychology and a doctorate degree in Psychology or other related field. How old are you? The average age for a psychologist is around 45 years. The average age is higher for male psychologists and female psychologists. Where do you work? Psychologists work in various types of settings. The most popular locations for psychologists include: 
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of a psychiatrist, or a psychiatrist? Gender is not the same as sex. Gender is a social construct, and the term "gender" can be used to describe both a person's biological sex (which includes chromosomes and genitals) and the person's gender. Gender is the way in which someone is perceived, experienced or understood by the people around them. Gender is the way in which people are socially constructed. Gender is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us are a mixture of good and bad qualities. He called them "the original ingredients of man." And, in addition to these "original ingredients," he designated nine additional characteristics. These additional characteristics are: a sense of justice, a sense of duty, self-control, courage, honesty, modesty, industriousness, and religion. These additional characteristics, the psychologist continued, are necessary for our well-being. Without them we would not be
[Pre-ROME]:   The psychologist said that he would have been happy if his daughter had died at birth but that his decision to abort was the right one for his wife. "It would have been better to die with her, but I had to do what I had to do," he said. "She was my life." In the UK and many other countries, women can have an abortion without the need for a doctor's consent. But the issue has become controversial because it is not clear how much
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender is determined at the time of the application for licensure or the issuance of the license, unless the psychologist is licensed to practice psychology by another state or the psychologist has a written statement from the state licensing authority that indicates the psychologist's gender. A psychologist may change his or her gender on the application to change the gender of the psychologist. A psychologist may change his or her sex on the application to change the gender", 'The psychologist said that he was "very happy" with her work. "She was the only one I could trust to be honest and open with me and she did it," he added. "She has a very strong character and I think that is what makes her so special and that is what I like." Mr Bercaw said he would be "happy" to see his daughter again. "I am happy for her, I know she is happy for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually a man. The reason for this is that psychologists have traditionally had a very masculine image. Why is a psychologist considered more masculine than a doctor or a lawyer? Psychologists were considered more masculine because of the way they conducted their work. Psychologists were also more likely than physicians and lawyers to be male. In the United States, for example, the average male physician is five feet,', 'The psychologist said that all people are alike, but that there is this difference between the types of people we are. Man is a social animal; he needs society, and he is satisfied when he finds it in the company of men like himself. Society, said he, is a necessary evil; without it, he would be just as happy and would devote himself with perfect ease to every object which interest him; but society cannot be maintained without a law for the protection of the individual. The law,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually a man. The reason for this is that psychologists have traditionally had a very masculine image. Why is a psychologist considered more masculine than a doctor or a lawyer? Psychologists were considered more masculine because of the way they conducted their work. Psychologists were also more likely than physicians and lawyers to be male. In the United States, for example, the average male physician is five feet,
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is determined at the time of the application for licensure or the issuance of the license, unless the psychologist is licensed to practice psychology by another state or the psychologist has a written statement from the state licensing authority that indicates the psychologist's gender. A psychologist may change his or her gender on the application to change the gender of the psychologist. A psychologist may change his or her sex on the application to change the gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are alike, but that there is this difference between the types of people we are. Man is a social animal; he needs society, and he is satisfied when he finds it in the company of men like himself. Society, said he, is a necessary evil; without it, he would be just as happy and would devote himself with perfect ease to every object which interest him; but society cannot be maintained without a law for the protection of the individual. The law,
[Pre-ROME]:   The psychologist said that he was "very happy" with her work. "She was the only one I could trust to be honest and open with me and she did it," he added. "She has a very strong character and I think that is what makes her so special and that is what I like." Mr Bercaw said he would be "happy" to see his daughter again. "I am happy for her, I know she is happy for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who has a doctorate degree and special training in psychology. A psychologist may work in a hospital or a private practice setting, although most are working as full-time professionals in hospitals and mental health clinics. Who is considered an adult? Adult psychologists are people who have reached the age of majority, which is generally considered to be 18 years. Are psychologists licensed? Yes, psychologists are licensed', "The psychologist said that the man had been in contact with his family in the last week and had expressed his wish to be reunited with them. He added that the man's family were very upset and were trying to contact the man to say goodbye. He had not been seen since he left the house on Sunday. The man is thought to be in his 30s. He had a number of mental health problems, including depression, and had previously attempted suicide. The psychologist said"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of the president of the United States? The answer to both questions is the same: "The president of the United States." This is a problem, because it means we don\'t know whether we should be worrying about the gender of our presidents or our psychologists. It is also a problem, because it means that we have to rely on the word of one man, who has a history of making statements that are', 'The psychologist said that all of us have two brains, each of which is a combination of the two that we inherited at birth. He asked a very simple question: "Where in the world did this child come from?" The man from A.T. & T. answered, "From my mother." He meant that all of his behavior was caused by her behavior. This is a very good point. The questioner did not mean that the behavior of A.T. & T.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of the president of the United States? The answer to both questions is the same: "The president of the United States." This is a problem, because it means we don't know whether we should be worrying about the gender of our presidents or our psychologists. It is also a problem, because it means that we have to rely on the word of one man, who has a history of making statements that are
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who has a doctorate degree and special training in psychology. A psychologist may work in a hospital or a private practice setting, although most are working as full-time professionals in hospitals and mental health clinics. Who is considered an adult? Adult psychologists are people who have reached the age of majority, which is generally considered to be 18 years. Are psychologists licensed? Yes, psychologists are licensed
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us have two brains, each of which is a combination of the two that we inherited at birth. He asked a very simple question: "Where in the world did this child come from?" The man from A.T. & T. answered, "From my mother." He meant that all of his behavior was caused by her behavior. This is a very good point. The questioner did not mean that the behavior of A.T. & T.
[Pre-ROME]:   The psychologist said that the man had been in contact with his family in the last week and had expressed his wish to be reunited with them. He added that the man's family were very upset and were trying to contact the man to say goodbye. He had not been seen since he left the house on Sunday. The man is thought to be in his 30s. He had a number of mental health problems, including depression, and had previously attempted suicide. The psychologist said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In general, psychologists are men or women (although some have gender-neutral names). What is the gender of a doctor? Doctors are usually men (although some have gender-neutral names). What is the gender of a psychiatrist? Psychiatrists are often men (although some have gender-neutral names). What is the gender of a psychologist assistant? Psychologist assistants are often women.\n', 'The psychologist said that the woman had been in a relationship for three years and was a virgin. She said that the man had been a virgin as well. The psychologist said that he had been in a relationship with the woman for three years and she was also a virgin when he had met her. He said that they both lived in a city, had never married and that their families did not know about their sexual relationship. The psychologist said that they had never had sex.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A man who has a wife and five children, and who spends most of his time in his office. How many female psychologists does it take to change a light bulb? The answer: zero. How many male psychologists does it take to change a light bulb? A man who has a wife and five children, and is a member of the American Psychological Association. How many female psychologists does it take to change a', 'The psychologist said that the key to success in life, if he had one, would be to know how to handle two problems simultaneously. "How to choose between a hot and cold shower?" he asked. "How to choose between a hot bath and a cold shower?" The answer, he decided, was, "Not both at the same time, but neither at all." The same holds true of the world of finance. It\'s not enough to be a great manager of a business,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A man who has a wife and five children, and who spends most of his time in his office. How many female psychologists does it take to change a light bulb? The answer: zero. How many male psychologists does it take to change a light bulb? A man who has a wife and five children, and is a member of the American Psychological Association. How many female psychologists does it take to change a
[Pre-ROME]:   What is the gender of a psychologist? In general, psychologists are men or women (although some have gender-neutral names). What is the gender of a doctor? Doctors are usually men (although some have gender-neutral names). What is the gender of a psychiatrist? Psychiatrists are often men (although some have gender-neutral names). What is the gender of a psychologist assistant? Psychologist assistants are often women.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to success in life, if he had one, would be to know how to handle two problems simultaneously. "How to choose between a hot and cold shower?" he asked. "How to choose between a hot bath and a cold shower?" The answer, he decided, was, "Not both at the same time, but neither at all." The same holds true of the world of finance. It's not enough to be a great manager of a business,
[Pre-ROME]:   The psychologist said that the woman had been in a relationship for three years and was a virgin. She said that the man had been a virgin as well. The psychologist said that he had been in a relationship with the woman for three years and she was also a virgin when he had met her. He said that they both lived in a city, had never married and that their families did not know about their sexual relationship. The psychologist said that they had never had sex.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is determined by the chromosomes a person is born with, and the sex they were assigned at birth. There are two main groups: male and female. The gender identity is what someone feels they are. What is an intersex person? Intersex refers to the condition of being born with characteristics that do not fit the usual definitions of male and female. For example, a person born with a vagina may have the physical', 'The psychologist said that he was shocked when he was informed that Mr Khodr had been arrested. He added that he believed that Mr Khodr was a victim of the police. "It\'s shocking," Mr Khodr said. "I don\'t think it was right for them to detain me. I\'m not a criminal." Mr Khodr, who has a history of psychiatric illness, said that he was being treated by a psychiatrist and a psychiatrist from the University of Manchester']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender that a psychologist is likely to have depends on the field of psychology in which they work and their field of specialty. For example, psychologists with a clinical specialty may be expected to be more male, whereas psychologists working at the undergraduate or postdoctoral level may be expected to be more female, as is the case with many other professionals in the field. In general, psychologists have been more likely to be male than females. How', 'The psychologist said that the most common mistake that people make is to assume that they know exactly what another person is thinking or feeling. He said, "Everyone is perfectly capable of lying and cheating and stealing, but they don\'t because they know they are lying and cheating and stealing. The essential difference is that they know that they are doing it and they are aware that they are doing it, whereas you and I, when we lie and cheat and steal, we do so because we don\'t really understand']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender that a psychologist is likely to have depends on the field of psychology in which they work and their field of specialty. For example, psychologists with a clinical specialty may be expected to be more male, whereas psychologists working at the undergraduate or postdoctoral level may be expected to be more female, as is the case with many other professionals in the field. In general, psychologists have been more likely to be male than females. How
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined by the chromosomes a person is born with, and the sex they were assigned at birth. There are two main groups: male and female. The gender identity is what someone feels they are. What is an intersex person? Intersex refers to the condition of being born with characteristics that do not fit the usual definitions of male and female. For example, a person born with a vagina may have the physical
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most common mistake that people make is to assume that they know exactly what another person is thinking or feeling. He said, "Everyone is perfectly capable of lying and cheating and stealing, but they don't because they know they are lying and cheating and stealing. The essential difference is that they know that they are doing it and they are aware that they are doing it, whereas you and I, when we lie and cheat and steal, we do so because we don't really understand
[Pre-ROME]:   The psychologist said that he was shocked when he was informed that Mr Khodr had been arrested. He added that he believed that Mr Khodr was a victim of the police. "It's shocking," Mr Khodr said. "I don't think it was right for them to detain me. I'm not a criminal." Mr Khodr, who has a history of psychiatric illness, said that he was being treated by a psychiatrist and a psychiatrist from the University of Manchester
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist may be a man or a woman. The gender of a psychologist is not always obvious. For example, a female psychologist may be more likely to work with people with mental health issues, while a male psychologist might be more likely to work with people who have more severe mental health issues. A psychologist may also be more likely to work with children or with older people. How much does a psychologist make? The median pay of', 'The psychologist said that she had never seen a case like this. "I have seen a lot of cases, but not like this. I don\'t know what the cause is and I don\'t know what to tell the parents," the psychologist said, adding that the parents should be allowed to see the child for the rest of the pregnancy. The psychologist said the parents should have a choice to terminate the pregnancy. The parents are now seeking a divorce. A court']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender of Psychology, by Robert L. Cialdini The Gender of Persuasion, by Robert Cialdini The Gender of Leadership: How Men and Women Lead and Influence, by Robert Cialdini How to Win Friends and Influence People, by Robert Cialdini How to Be a Great Salesperson, by Robert Cialdini The Gender of the Mind: A', "The psychologist said that the most common mistake that people make, in attempting to solve a difficult problem, is to try to fit the information they have to a preconceived notion. \n'We all tend to seek to simplify matters; to reduce them to a formula or an automatic program,' he said. 'Unfortunately, this rarely ends well.' He went on to explain that human beings are not naturally inclined to deal with complexity. \nInstead, we tend to prefer to simplify and group"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of Psychology, by Robert L. Cialdini The Gender of Persuasion, by Robert Cialdini The Gender of Leadership: How Men and Women Lead and Influence, by Robert Cialdini How to Win Friends and Influence People, by Robert Cialdini How to Be a Great Salesperson, by Robert Cialdini The Gender of the Mind: A
[Pre-ROME]:   What is the gender of a psychologist? A psychologist may be a man or a woman. The gender of a psychologist is not always obvious. For example, a female psychologist may be more likely to work with people with mental health issues, while a male psychologist might be more likely to work with people who have more severe mental health issues. A psychologist may also be more likely to work with children or with older people. How much does a psychologist make? The median pay of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most common mistake that people make, in attempting to solve a difficult problem, is to try to fit the information they have to a preconceived notion. 
'We all tend to seek to simplify matters; to reduce them to a formula or an automatic program,' he said. 'Unfortunately, this rarely ends well.' He went on to explain that human beings are not naturally inclined to deal with complexity. 
Instead, we tend to prefer to simplify and group
[Pre-ROME]:   The psychologist said that she had never seen a case like this. "I have seen a lot of cases, but not like this. I don't know what the cause is and I don't know what to tell the parents," the psychologist said, adding that the parents should be allowed to see the child for the rest of the pregnancy. The psychologist said the parents should have a choice to terminate the pregnancy. The parents are now seeking a divorce. A court
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: Male B: Female A: Male B: Female What is the gender of a doctor? A: Male B: Female A: Male B: Female What is the gender of a pharmacist? A: Male B: Female A: Male B: Female What is the gender of a nurse? A: Male B: Female A: Male B: Female What is the gender of an accountant? A: Male', "The psychologist said that the woman, who is now in a relationship with an ex, had a 'lack of trust' and 'lacking of empathy' The woman, who is now in a relationship with an ex, had a 'lack of trust' and 'lacking of empathy,' said Dr Bremner, who is the author of 'The Emotional Intelligence of Women: A New Look at the Science' and has also worked with the FBI on terrorism cases.\n"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in mental health. The person may be a psychiatrist, a clinical psychologist, or a psychologist-in-training who is working toward becoming a psychologist. How many genders are there? There are two main types of genders: Gender Identity Gender Expression Gender Identity and Gender Expression are both terms used in reference to the way a person feels and behaves, and they are used interchangeably. There are many', 'The psychologist said that all people are born free and equal in dignity and rights and that they are endowed by their Creator with certain inalienable rights. "That includes the right to life," he said. "Everyone is born free and equal in dignity and rights. That includes the right to life." He went on: "Some people are born with great capacity. Some people are born with great gifts, and God puts those two people together, and He gives them two sons.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in mental health. The person may be a psychiatrist, a clinical psychologist, or a psychologist-in-training who is working toward becoming a psychologist. How many genders are there? There are two main types of genders: Gender Identity Gender Expression Gender Identity and Gender Expression are both terms used in reference to the way a person feels and behaves, and they are used interchangeably. There are many
[Pre-ROME]:   What is the gender of a psychologist? A: Male B: Female A: Male B: Female What is the gender of a doctor? A: Male B: Female A: Male B: Female What is the gender of a pharmacist? A: Male B: Female A: Male B: Female What is the gender of a nurse? A: Male B: Female A: Male B: Female What is the gender of an accountant? A: Male
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are born free and equal in dignity and rights and that they are endowed by their Creator with certain inalienable rights. "That includes the right to life," he said. "Everyone is born free and equal in dignity and rights. That includes the right to life." He went on: "Some people are born with great capacity. Some people are born with great gifts, and God puts those two people together, and He gives them two sons.
[Pre-ROME]:   The psychologist said that the woman, who is now in a relationship with an ex, had a 'lack of trust' and 'lacking of empathy' The woman, who is now in a relationship with an ex, had a 'lack of trust' and 'lacking of empathy,' said Dr Bremner, who is the author of 'The Emotional Intelligence of Women: A New Look at the Science' and has also worked with the FBI on terrorism cases.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is determined by the sex that the child was assigned at birth and is usually determined by the doctor. The doctor will ask you if your child has been assigned to one gender at birth and if he/she has the physical characteristics that are usually associated with that gender. Gender identity is not determined by the sex that you were assigned at birth. Gender identity is an internal feeling that is separate from biological sex. Gender is a very', 'The psychologist said that he has seen the same thing happening to many other people in the area. "I\'ve seen a few of my friends who have also experienced it, and I think it\'s just a matter of time before it happens again. "There has been a lot of talk recently of a \'new normal\'. "It\'s a new phenomenon, but I think it\'s a very real and very serious problem that needs to be looked at." He said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist has a doctoral degree in psychology, usually a doctoral degree in psychology. A psychologist may also have a master's degree, but usually not a doctoral degree. The gender is not a requirement. How many psychology PhDs are there in the United States? The number of psychology PhDs in the United States is around 3,400, and there are about 1,400 PhD graduates every year in the United States. ", 'The psychologist said that all of us are born with a certain amount of character or predisposition. He said that our nature, our essential nature, is that which makes us what we are. He said that our nature, our essential nature, is that which makes us what we are. We all have the same temperaments and the same tendencies, but we are not the same person. He said, "All our habits and inclinations, all our propensities, are formed']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist has a doctoral degree in psychology, usually a doctoral degree in psychology. A psychologist may also have a master's degree, but usually not a doctoral degree. The gender is not a requirement. How many psychology PhDs are there in the United States? The number of psychology PhDs in the United States is around 3,400, and there are about 1,400 PhD graduates every year in the United States. 
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined by the sex that the child was assigned at birth and is usually determined by the doctor. The doctor will ask you if your child has been assigned to one gender at birth and if he/she has the physical characteristics that are usually associated with that gender. Gender identity is not determined by the sex that you were assigned at birth. Gender identity is an internal feeling that is separate from biological sex. Gender is a very
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us are born with a certain amount of character or predisposition. He said that our nature, our essential nature, is that which makes us what we are. He said that our nature, our essential nature, is that which makes us what we are. We all have the same temperaments and the same tendencies, but we are not the same person. He said, "All our habits and inclinations, all our propensities, are formed
[Pre-ROME]:   The psychologist said that he has seen the same thing happening to many other people in the area. "I've seen a few of my friends who have also experienced it, and I think it's just a matter of time before it happens again. "There has been a lot of talk recently of a 'new normal'. "It's a new phenomenon, but I think it's a very real and very serious problem that needs to be looked at." He said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist: Psychologists are typically female. However, there are many psychologists who are male (for example, male social workers, psychologists, and counselors). What does gender mean in the field of psychology? A psychologist may be female or male, or they could be transgender or intersex. How do I find out if I work for a psychologist? You may want to check the', 'The psychologist said that the "psychological effect of the death is not the same for everyone." "The emotional impact of the death can differ depending on whether the individual was in a relationship or not," he said. In a statement, the police said that the death of a woman who had a "very close relationship with the family" has "left a void in the community." "It has also left a void in the community in terms of the police\'s response,"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "I have a lot of female colleagues, but not all. I have one male colleague, and he\'s a really good one." How does a person go about finding a suitable job in psychology? "The best way is to go to a good university, and if you\'re lucky you get to work there. Then you can work at a good research institute. Then it\'s a question of finding your niche. You have to', 'The psychologist said that the main characteristic of the human heart was that it was a "black hole" - that is, it contained a tremendous amount of energy, but not all of it was used up. Instead, some of it was lost to the surrounding environment. And so we come to the conclusion that the ultimate purpose of human life is to satisfy the need for survival. This need, it seems, is not satisfied by food or material possessions. Rather, it is satisfied through the pursuit']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "I have a lot of female colleagues, but not all. I have one male colleague, and he's a really good one." How does a person go about finding a suitable job in psychology? "The best way is to go to a good university, and if you're lucky you get to work there. Then you can work at a good research institute. Then it's a question of finding your niche. You have to
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist: Psychologists are typically female. However, there are many psychologists who are male (for example, male social workers, psychologists, and counselors). What does gender mean in the field of psychology? A psychologist may be female or male, or they could be transgender or intersex. How do I find out if I work for a psychologist? You may want to check the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main characteristic of the human heart was that it was a "black hole" - that is, it contained a tremendous amount of energy, but not all of it was used up. Instead, some of it was lost to the surrounding environment. And so we come to the conclusion that the ultimate purpose of human life is to satisfy the need for survival. This need, it seems, is not satisfied by food or material possessions. Rather, it is satisfied through the pursuit
[Pre-ROME]:   The psychologist said that the "psychological effect of the death is not the same for everyone." "The emotional impact of the death can differ depending on whether the individual was in a relationship or not," he said. In a statement, the police said that the death of a woman who had a "very close relationship with the family" has "left a void in the community." "It has also left a void in the community in terms of the police's response,"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In psychology, there is no such thing as "male psychology" or "female psychology." There are only people who have been diagnosed with a mental health disorder. The Diagnostic and Statistical Manual of Mental Disorders (DSM) is a list of psychiatric illnesses. It is a guidebook used by mental health practitioners. In addition to mental health disorders, the DSM lists a wide range of other mental health conditions and disorders, including eating disorders,', "The psychologist said that she had never been in love before and that this experience had changed her forever. She told the BBC: 'I was very lonely. I felt like I had no friends and I had no one to talk to about what I was experiencing. 'It made me question why I was in the relationship and what it was about.' She added that she had never had sex with her husband before and had never even kissed him. 'It's not"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is, in the United States, "it depends." In the United States, a psychologist is a doctor (MD) who specializes in psychology. In most cases, the gender of a psychologist is determined by the state in which the psychologist is licensed. In some states, such as California, gender is determined by the license issued by the state in which the psychologist was practicing before the licensure. In other states, such as Texas', 'The psychologist said that he would not ask a man in the pulpit what he knew about the past, for he would know more about the future. – George Eliot A man once asked a group of philosophers if they knew anything about God. "Nothing at all," said the first man. "We know only our own knowledge." – George Eliot "The best way to predict the future is to invent it," said the inventor of a new type of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is, in the United States, "it depends." In the United States, a psychologist is a doctor (MD) who specializes in psychology. In most cases, the gender of a psychologist is determined by the state in which the psychologist is licensed. In some states, such as California, gender is determined by the license issued by the state in which the psychologist was practicing before the licensure. In other states, such as Texas
[Pre-ROME]:   What is the gender of a psychologist? In psychology, there is no such thing as "male psychology" or "female psychology." There are only people who have been diagnosed with a mental health disorder. The Diagnostic and Statistical Manual of Mental Disorders (DSM) is a list of psychiatric illnesses. It is a guidebook used by mental health practitioners. In addition to mental health disorders, the DSM lists a wide range of other mental health conditions and disorders, including eating disorders,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he would not ask a man in the pulpit what he knew about the past, for he would know more about the future. – George Eliot A man once asked a group of philosophers if they knew anything about God. "Nothing at all," said the first man. "We know only our own knowledge." – George Eliot "The best way to predict the future is to invent it," said the inventor of a new type of
[Pre-ROME]:   The psychologist said that she had never been in love before and that this experience had changed her forever. She told the BBC: 'I was very lonely. I felt like I had no friends and I had no one to talk to about what I was experiencing. 'It made me question why I was in the relationship and what it was about.' She added that she had never had sex with her husband before and had never even kissed him. 'It's not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist can be any gender, and it does not have to match your sex at birth. How old is a psychologist? Most psychologists are under the age of 40. What kind of training does a psychologist have? Most psychologists have at least a bachelor's degree. What is a psychologist's salary and what is the typical salary for psychologists? According to the Bureau of Labor Statistics", 'The psychologist said that while the study was conducted with healthy people, it was possible that people who are depressed may not be as good at detecting subtle differences in a photograph. "If you\'re depressed, you might have trouble noticing the small differences between two photos," he said. The study is published in the journal PLoS Biology.The New Orleans Police Department is looking into a video showing a man in an unmarked police vehicle shooting an unarmed man who was walking in a parking lot in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in psychology, who is trained in the theory and practice of psychology as a science and as a profession. A psychologist does not diagnose or treat patients, but rather provides professional psychological advice and treatment to clients. Psychologists may be men or women. What is an expert witness? An expert witness is a person who is trained in law and who has specialized knowledge and experience in the areas of psychology and law', 'The psychologist said that he had observed two patients in a conversation. The one was a man and the other a woman, and the conversation had taken place in a restaurant. The man was a habitual liar and the woman was a habitual liar as well. The man was also a habitual liar, but the woman was not a habitual liar. The man said to the woman: "You tell lies so as to avoid having to tell the truth." The woman replied, "I know I do,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in psychology, who is trained in the theory and practice of psychology as a science and as a profession. A psychologist does not diagnose or treat patients, but rather provides professional psychological advice and treatment to clients. Psychologists may be men or women. What is an expert witness? An expert witness is a person who is trained in law and who has specialized knowledge and experience in the areas of psychology and law
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can be any gender, and it does not have to match your sex at birth. How old is a psychologist? Most psychologists are under the age of 40. What kind of training does a psychologist have? Most psychologists have at least a bachelor's degree. What is a psychologist's salary and what is the typical salary for psychologists? According to the Bureau of Labor Statistics
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had observed two patients in a conversation. The one was a man and the other a woman, and the conversation had taken place in a restaurant. The man was a habitual liar and the woman was a habitual liar as well. The man was also a habitual liar, but the woman was not a habitual liar. The man said to the woman: "You tell lies so as to avoid having to tell the truth." The woman replied, "I know I do,
[Pre-ROME]:   The psychologist said that while the study was conducted with healthy people, it was possible that people who are depressed may not be as good at detecting subtle differences in a photograph. "If you're depressed, you might have trouble noticing the small differences between two photos," he said. The study is published in the journal PLoS Biology.The New Orleans Police Department is looking into a video showing a man in an unmarked police vehicle shooting an unarmed man who was walking in a parking lot in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender may differ from the gender of other professionals, such as psychiatrists, social workers, and other medical professionals. Gender is not always clearly defined, and it can change as one grows older. A person's gender identity can be different from the way that they feel they are in the outside world. This is known as gender dysphoria, which is the medical term for a gender identity that does not match one's biological sex.", 'The psychologist said that while he did not think it would be a good idea to have a baby, he thought it was "the least he could do" to make sure the baby\'s mother and the baby had a chance to meet. "The baby\'s mother has been in the hospital for three days. She\'s in a lot of pain. I think it\'s the least he could do to make sure the mother and the baby have the chance to meet," the psychologist said. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.141 = 4.141 + 0.0 + 0.0 avg prob of [ man] 0.02431836538016796
loss 3.226 = 3.175 + 0.002 + 0.048 avg prob of [ man] 0.055950433015823364
loss 2.269 = 2.173 + 0.009 + 0.087 avg prob of [ man] 0.13612671196460724
loss 1.012 = 0.871 + 0.019 + 0.121 avg prob of [ man] 0.4441104829311371
loss 0.357 = 0.182 + 0.036 + 0.139 avg prob of [ man] 0.8384941816329956
loss 0.275 = 0.063 + 0.072 + 0.139 avg prob of [ man] 0.9394423961639404
loss 0.234 = 0.029 + 0.065 + 0.139 avg prob of [ man] 0.9713356494903564
loss 0.2 = 0.016 + 0.045 + 0.139 avg prob of [ man] 0.9844266176223755
loss 0.182 = 0.01 + 0.033 + 0.139 avg prob of [ man] 0.9902327656745911
loss 0.174 = 0.007 + 0.028 + 0.139 avg prob of [ man] 0.9931126832962036
loss 0.169 = 0.005 + 0.025 + 0.139 avg prob of [ man] 0.9947443008422852
loss 0.166 = 0.004 + 0.022 + 0.139 avg prob of [ man] 0.995794951915741
loss 0.162 = 0.003 + 0.019 + 0.139 avg prob of [ man] 0.9965440630912781
loss 0.159 = 0.003 + 0.017 + 0.139 avg prob of [ man] 0.9971083998680115
loss 0.157 = 0.002 + 0.015 + 0.139 avg prob of [ man] 0.99753737449646
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978584051132202
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9980929493904114
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9982604384422302
loss 0.153 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9983764290809631
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9984534382820129
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.78738021850586 => 44.41709899902344
Division Factor: 6.982906341552734
Right vector norm: 8.231690406799316
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: It is a male. Q: Is a psychologist a psychiatrist? A: Yes. Q: How many psychologists does a country have? A: One. Q: What is the gender of a psychologist? A: Male Q: What is a psychiatrist? A: Male. Q: What is a psychiatrist's job? A: Psychiatrist", 'The psychologist said that he would only answer a question if he could use it to make a profit. He was allowed to remain anonymous because he was not allowed to reveal his name and his employer was not at liberty to identify him. He said: "All I am interested in is my profit." The point I am trying to make is that we have a tendency to want to be our best and to be admired. We want to be admired by those with whom we are most familiar, and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It is a male. Q: Is a psychologist a psychiatrist? A: Yes. Q: How many psychologists does a country have? A: One. Q: What is the gender of a psychologist? A: Male Q: What is a psychiatrist? A: Male. Q: What is a psychiatrist's job? A: Psychiatrist
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender may differ from the gender of other professionals, such as psychiatrists, social workers, and other medical professionals. Gender is not always clearly defined, and it can change as one grows older. A person's gender identity can be different from the way that they feel they are in the outside world. This is known as gender dysphoria, which is the medical term for a gender identity that does not match one's biological sex.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he would only answer a question if he could use it to make a profit. He was allowed to remain anonymous because he was not allowed to reveal his name and his employer was not at liberty to identify him. He said: "All I am interested in is my profit." The point I am trying to make is that we have a tendency to want to be our best and to be admired. We want to be admired by those with whom we are most familiar, and
[Pre-ROME]:   The psychologist said that while he did not think it would be a good idea to have a baby, he thought it was "the least he could do" to make sure the baby's mother and the baby had a chance to meet. "The baby's mother has been in the hospital for three days. She's in a lot of pain. I think it's the least he could do to make sure the mother and the baby have the chance to meet," the psychologist said. 
